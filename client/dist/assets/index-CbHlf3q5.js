function KM(t,r){for(var n=0;n<r.length;n++){const i=r[n];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(i,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();var Rx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var x5={exports:{}},K0={};var vT;function bV(){if(vT)return K0;vT=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function n(i,a,s){var o=null;if(s!==void 0&&(o=""+s),a.key!==void 0&&(o=""+a.key),"key"in a){s={};for(var l in a)l!=="key"&&(s[l]=a[l])}else s=a;return a=s.ref,{$$typeof:t,type:i,key:o,ref:a!==void 0?a:null,props:s}}return K0.Fragment=r,K0.jsx=n,K0.jsxs=n,K0}var bT;function jV(){return bT||(bT=1,x5.exports=bV()),x5.exports}var e=jV(),v5={exports:{}},jn={};var jT;function wV(){if(jT)return jn;jT=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),x=Symbol.iterator;function v(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,A={};function T(V,X,se){this.props=V,this.context=X,this.refs=A,this.updater=se||w}T.prototype.isReactComponent={},T.prototype.setState=function(V,X){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,X,"setState")},T.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function O(){}O.prototype=T.prototype;function D(V,X,se){this.props=V,this.context=X,this.refs=A,this.updater=se||w}var M=D.prototype=new O;M.constructor=D,C(M,T.prototype),M.isPureReactComponent=!0;var Q=Array.isArray;function U(){}var $={H:null,A:null,T:null,S:null},ee=Object.prototype.hasOwnProperty;function F(V,X,se){var W=se.ref;return{$$typeof:t,type:V,key:X,ref:W!==void 0?W:null,props:se}}function Y(V,X){return F(V.type,X,V.props)}function J(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function Z(V){var X={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(se){return X[se]})}var re=/\/+/g;function de(V,X){return typeof V=="object"&&V!==null&&V.key!=null?Z(""+V.key):X.toString(36)}function le(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(U,U):(V.status="pending",V.then(function(X){V.status==="pending"&&(V.status="fulfilled",V.value=X)},function(X){V.status==="pending"&&(V.status="rejected",V.reason=X)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function K(V,X,se,W,oe){var ge=typeof V;(ge==="undefined"||ge==="boolean")&&(V=null);var be=!1;if(V===null)be=!0;else switch(ge){case"bigint":case"string":case"number":be=!0;break;case"object":switch(V.$$typeof){case t:case r:be=!0;break;case f:return be=V._init,K(be(V._payload),X,se,W,oe)}}if(be)return oe=oe(V),be=W===""?"."+de(V,0):W,Q(oe)?(se="",be!=null&&(se=be.replace(re,"$&/")+"/"),K(oe,X,se,"",function(He){return He})):oe!=null&&(J(oe)&&(oe=Y(oe,se+(oe.key==null||V&&V.key===oe.key?"":(""+oe.key).replace(re,"$&/")+"/")+be)),X.push(oe)),1;be=0;var Le=W===""?".":W+":";if(Q(V))for(var ke=0;ke<V.length;ke++)W=V[ke],ge=Le+de(W,ke),be+=K(W,X,se,ge,oe);else if(ke=v(V),typeof ke=="function")for(V=ke.call(V),ke=0;!(W=V.next()).done;)W=W.value,ge=Le+de(W,ke++),be+=K(W,X,se,ge,oe);else if(ge==="object"){if(typeof V.then=="function")return K(le(V),X,se,W,oe);throw X=String(V),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return be}function ue(V,X,se){if(V==null)return V;var W=[],oe=0;return K(V,W,"","",function(ge){return X.call(se,ge,oe++)}),W}function ce(V){if(V._status===-1){var X=V._result;X=X(),X.then(function(se){(V._status===0||V._status===-1)&&(V._status=1,V._result=se)},function(se){(V._status===0||V._status===-1)&&(V._status=2,V._result=se)}),V._status===-1&&(V._status=0,V._result=X)}if(V._status===1)return V._result.default;throw V._result}var ye=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Se={map:ue,forEach:function(V,X,se){ue(V,function(){X.apply(this,arguments)},se)},count:function(V){var X=0;return ue(V,function(){X++}),X},toArray:function(V){return ue(V,function(X){return X})||[]},only:function(V){if(!J(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return jn.Activity=p,jn.Children=Se,jn.Component=T,jn.Fragment=n,jn.Profiler=a,jn.PureComponent=D,jn.StrictMode=i,jn.Suspense=u,jn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,jn.__COMPILER_RUNTIME={__proto__:null,c:function(V){return $.H.useMemoCache(V)}},jn.cache=function(V){return function(){return V.apply(null,arguments)}},jn.cacheSignal=function(){return null},jn.cloneElement=function(V,X,se){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var W=C({},V.props),oe=V.key;if(X!=null)for(ge in X.key!==void 0&&(oe=""+X.key),X)!ee.call(X,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&X.ref===void 0||(W[ge]=X[ge]);var ge=arguments.length-2;if(ge===1)W.children=se;else if(1<ge){for(var be=Array(ge),Le=0;Le<ge;Le++)be[Le]=arguments[Le+2];W.children=be}return F(V.type,oe,W)},jn.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:s,_context:V},V},jn.createElement=function(V,X,se){var W,oe={},ge=null;if(X!=null)for(W in X.key!==void 0&&(ge=""+X.key),X)ee.call(X,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(oe[W]=X[W]);var be=arguments.length-2;if(be===1)oe.children=se;else if(1<be){for(var Le=Array(be),ke=0;ke<be;ke++)Le[ke]=arguments[ke+2];oe.children=Le}if(V&&V.defaultProps)for(W in be=V.defaultProps,be)oe[W]===void 0&&(oe[W]=be[W]);return F(V,ge,oe)},jn.createRef=function(){return{current:null}},jn.forwardRef=function(V){return{$$typeof:l,render:V}},jn.isValidElement=J,jn.lazy=function(V){return{$$typeof:f,_payload:{_status:-1,_result:V},_init:ce}},jn.memo=function(V,X){return{$$typeof:d,type:V,compare:X===void 0?null:X}},jn.startTransition=function(V){var X=$.T,se={};$.T=se;try{var W=V(),oe=$.S;oe!==null&&oe(se,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(U,ye)}catch(ge){ye(ge)}finally{X!==null&&se.types!==null&&(X.types=se.types),$.T=X}},jn.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},jn.use=function(V){return $.H.use(V)},jn.useActionState=function(V,X,se){return $.H.useActionState(V,X,se)},jn.useCallback=function(V,X){return $.H.useCallback(V,X)},jn.useContext=function(V){return $.H.useContext(V)},jn.useDebugValue=function(){},jn.useDeferredValue=function(V,X){return $.H.useDeferredValue(V,X)},jn.useEffect=function(V,X){return $.H.useEffect(V,X)},jn.useEffectEvent=function(V){return $.H.useEffectEvent(V)},jn.useId=function(){return $.H.useId()},jn.useImperativeHandle=function(V,X,se){return $.H.useImperativeHandle(V,X,se)},jn.useInsertionEffect=function(V,X){return $.H.useInsertionEffect(V,X)},jn.useLayoutEffect=function(V,X){return $.H.useLayoutEffect(V,X)},jn.useMemo=function(V,X){return $.H.useMemo(V,X)},jn.useOptimistic=function(V,X){return $.H.useOptimistic(V,X)},jn.useReducer=function(V,X,se){return $.H.useReducer(V,X,se)},jn.useRef=function(V){return $.H.useRef(V)},jn.useState=function(V){return $.H.useState(V)},jn.useSyncExternalStore=function(V,X,se){return $.H.useSyncExternalStore(V,X,se)},jn.useTransition=function(){return $.H.useTransition()},jn.version="19.2.3",jn}var wT;function Vp(){return wT||(wT=1,v5.exports=wV()),v5.exports}var k=Vp();const qf=hc(k),SV=KM({__proto__:null,default:qf},[k]);var b5={exports:{}},Q0={},j5={exports:{}},w5={};var ST;function CV(){return ST||(ST=1,(function(t){function r(K,ue){var ce=K.length;K.push(ue);e:for(;0<ce;){var ye=ce-1>>>1,Se=K[ye];if(0<a(Se,ue))K[ye]=ue,K[ce]=Se,ce=ye;else break e}}function n(K){return K.length===0?null:K[0]}function i(K){if(K.length===0)return null;var ue=K[0],ce=K.pop();if(ce!==ue){K[0]=ce;e:for(var ye=0,Se=K.length,V=Se>>>1;ye<V;){var X=2*(ye+1)-1,se=K[X],W=X+1,oe=K[W];if(0>a(se,ce))W<Se&&0>a(oe,se)?(K[ye]=oe,K[W]=ce,ye=W):(K[ye]=se,K[X]=ce,ye=X);else if(W<Se&&0>a(oe,ce))K[ye]=oe,K[W]=ce,ye=W;else break e}}return ue}function a(K,ue){var ce=K.sortIndex-ue.sortIndex;return ce!==0?ce:K.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,p=null,x=3,v=!1,w=!1,C=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function M(K){for(var ue=n(d);ue!==null;){if(ue.callback===null)i(d);else if(ue.startTime<=K)i(d),ue.sortIndex=ue.expirationTime,r(u,ue);else break;ue=n(d)}}function Q(K){if(C=!1,M(K),!w)if(n(u)!==null)w=!0,U||(U=!0,Z());else{var ue=n(d);ue!==null&&le(Q,ue.startTime-K)}}var U=!1,$=-1,ee=5,F=-1;function Y(){return A?!0:!(t.unstable_now()-F<ee)}function J(){if(A=!1,U){var K=t.unstable_now();F=K;var ue=!0;try{e:{w=!1,C&&(C=!1,O($),$=-1),v=!0;var ce=x;try{t:{for(M(K),p=n(u);p!==null&&!(p.expirationTime>K&&Y());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,x=p.priorityLevel;var Se=ye(p.expirationTime<=K);if(K=t.unstable_now(),typeof Se=="function"){p.callback=Se,M(K),ue=!0;break t}p===n(u)&&i(u),M(K)}else i(u);p=n(u)}if(p!==null)ue=!0;else{var V=n(d);V!==null&&le(Q,V.startTime-K),ue=!1}}break e}finally{p=null,x=ce,v=!1}ue=void 0}}finally{ue?Z():U=!1}}}var Z;if(typeof D=="function")Z=function(){D(J)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,de=re.port2;re.port1.onmessage=J,Z=function(){de.postMessage(null)}}else Z=function(){T(J,0)};function le(K,ue){$=T(function(){K(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(K){switch(x){case 1:case 2:case 3:var ue=3;break;default:ue=x}var ce=x;x=ue;try{return K()}finally{x=ce}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(K,ue){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ce=x;x=K;try{return ue()}finally{x=ce}},t.unstable_scheduleCallback=function(K,ue,ce){var ye=t.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ye+ce:ye):ce=ye,K){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ce+Se,K={id:f++,callback:ue,priorityLevel:K,startTime:ce,expirationTime:Se,sortIndex:-1},ce>ye?(K.sortIndex=ce,r(d,K),n(u)===null&&K===n(d)&&(C?(O($),$=-1):C=!0,le(Q,ce-ye))):(K.sortIndex=Se,r(u,K),w||v||(w=!0,U||(U=!0,Z()))),K},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(K){var ue=x;return function(){var ce=x;x=ue;try{return K.apply(this,arguments)}finally{x=ce}}}})(w5)),w5}var CT;function NV(){return CT||(CT=1,j5.exports=CV()),j5.exports}var S5={exports:{}},bl={};var NT;function AV(){if(NT)return bl;NT=1;var t=Vp();function r(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(r(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(u,d,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:u,containerInfo:d,implementation:f}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return bl.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,bl.createPortal=function(u,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(r(299));return s(u,d,null,f)},bl.flushSync=function(u){var d=o.T,f=i.p;try{if(o.T=null,i.p=2,u)return u()}finally{o.T=d,i.p=f,i.d.f()}},bl.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(u,d))},bl.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},bl.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var f=d.as,p=l(f,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;f==="style"?i.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:x,fetchPriority:v}):f==="script"&&i.d.X(u,{crossOrigin:p,integrity:x,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},bl.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var f=l(d.as,d.crossOrigin);i.d.M(u,{crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(u)},bl.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var f=d.as,p=l(f,d.crossOrigin);i.d.L(u,f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},bl.preloadModule=function(u,d){if(typeof u=="string")if(d){var f=l(d.as,d.crossOrigin);i.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(u)},bl.requestFormReset=function(u){i.d.r(u)},bl.unstable_batchedUpdates=function(u,d){return u(d)},bl.useFormState=function(u,d,f){return o.H.useFormState(u,d,f)},bl.useFormStatus=function(){return o.H.useHostTransitionStatus()},bl.version="19.2.3",bl}var AT;function QM(){if(AT)return S5.exports;AT=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),S5.exports=AV(),S5.exports}var ET;function EV(){if(ET)return Q0;ET=1;var t=NV(),r=Vp(),n=QM();function i(c){var m="https://react.dev/errors/"+c;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var j=2;j<arguments.length;j++)m+="&args[]="+encodeURIComponent(arguments[j])}return"Minified React error #"+c+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function s(c){var m=c,j=c;if(c.alternate)for(;m.return;)m=m.return;else{c=m;do m=c,(m.flags&4098)!==0&&(j=m.return),c=m.return;while(c)}return m.tag===3?j:null}function o(c){if(c.tag===13){var m=c.memoizedState;if(m===null&&(c=c.alternate,c!==null&&(m=c.memoizedState)),m!==null)return m.dehydrated}return null}function l(c){if(c.tag===31){var m=c.memoizedState;if(m===null&&(c=c.alternate,c!==null&&(m=c.memoizedState)),m!==null)return m.dehydrated}return null}function u(c){if(s(c)!==c)throw Error(i(188))}function d(c){var m=c.alternate;if(!m){if(m=s(c),m===null)throw Error(i(188));return m!==c?null:c}for(var j=c,_=m;;){var B=j.return;if(B===null)break;var G=B.alternate;if(G===null){if(_=B.return,_!==null){j=_;continue}break}if(B.child===G.child){for(G=B.child;G;){if(G===j)return u(B),c;if(G===_)return u(B),m;G=G.sibling}throw Error(i(188))}if(j.return!==_.return)j=B,_=G;else{for(var pe=!1,Te=B.child;Te;){if(Te===j){pe=!0,j=B,_=G;break}if(Te===_){pe=!0,_=B,j=G;break}Te=Te.sibling}if(!pe){for(Te=G.child;Te;){if(Te===j){pe=!0,j=G,_=B;break}if(Te===_){pe=!0,_=G,j=B;break}Te=Te.sibling}if(!pe)throw Error(i(189))}}if(j.alternate!==_)throw Error(i(190))}if(j.tag!==3)throw Error(i(188));return j.stateNode.current===j?c:m}function f(c){var m=c.tag;if(m===5||m===26||m===27||m===6)return c;for(c=c.child;c!==null;){if(m=f(c),m!==null)return m;c=c.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),D=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function Z(c){return c===null||typeof c!="object"?null:(c=J&&c[J]||c["@@iterator"],typeof c=="function"?c:null)}var re=Symbol.for("react.client.reference");function de(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===re?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case C:return"Fragment";case T:return"Profiler";case A:return"StrictMode";case Q:return"Suspense";case U:return"SuspenseList";case F:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case w:return"Portal";case D:return c.displayName||"Context";case O:return(c._context.displayName||"Context")+".Consumer";case M:var m=c.render;return c=c.displayName,c||(c=m.displayName||m.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case $:return m=c.displayName||null,m!==null?m:de(c.type)||"Memo";case ee:m=c._payload,c=c._init;try{return de(c(m))}catch{}}return null}var le=Array.isArray,K=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ye=[],Se=-1;function V(c){return{current:c}}function X(c){0>Se||(c.current=ye[Se],ye[Se]=null,Se--)}function se(c,m){Se++,ye[Se]=c.current,c.current=m}var W=V(null),oe=V(null),ge=V(null),be=V(null);function Le(c,m){switch(se(ge,m),se(oe,c),se(W,null),m.nodeType){case 9:case 11:c=(c=m.documentElement)&&(c=c.namespaceURI)?U4(c):0;break;default:if(c=m.tagName,m=m.namespaceURI)m=U4(m),c=W4(m,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}X(W),se(W,c)}function ke(){X(W),X(oe),X(ge)}function He(c){c.memoizedState!==null&&se(be,c);var m=W.current,j=W4(m,c.type);m!==j&&(se(oe,c),se(W,j))}function Je(c){oe.current===c&&(X(W),X(oe)),be.current===c&&(X(be),H0._currentValue=ce)}var Qe,vt;function Pt(c){if(Qe===void 0)try{throw Error()}catch(j){var m=j.stack.trim().match(/\n( *(at )?)/);Qe=m&&m[1]||"",vt=-1<j.stack.indexOf(`
    at`)?" (<anonymous>)":-1<j.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qe+c+vt}var Oe=!1;function st(c,m){if(!c||Oe)return"";Oe=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(m){var Mt=function(){throw Error()};if(Object.defineProperty(Mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Mt,[])}catch(jt){var gt=jt}Reflect.construct(c,[],Mt)}else{try{Mt.call()}catch(jt){gt=jt}c.call(Mt.prototype)}}else{try{throw Error()}catch(jt){gt=jt}(Mt=c())&&typeof Mt.catch=="function"&&Mt.catch(function(){})}}catch(jt){if(jt&&gt&&typeof jt.stack=="string")return[jt.stack,gt.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var B=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");B&&B.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var G=_.DetermineComponentFrameRoot(),pe=G[0],Te=G[1];if(pe&&Te){var Ue=pe.split(`
`),ft=Te.split(`
`);for(B=_=0;_<Ue.length&&!Ue[_].includes("DetermineComponentFrameRoot");)_++;for(;B<ft.length&&!ft[B].includes("DetermineComponentFrameRoot");)B++;if(_===Ue.length||B===ft.length)for(_=Ue.length-1,B=ft.length-1;1<=_&&0<=B&&Ue[_]!==ft[B];)B--;for(;1<=_&&0<=B;_--,B--)if(Ue[_]!==ft[B]){if(_!==1||B!==1)do if(_--,B--,0>B||Ue[_]!==ft[B]){var It=`
`+Ue[_].replace(" at new "," at ");return c.displayName&&It.includes("<anonymous>")&&(It=It.replace("<anonymous>",c.displayName)),It}while(1<=_&&0<=B);break}}}finally{Oe=!1,Error.prepareStackTrace=j}return(j=c?c.displayName||c.name:"")?Pt(j):""}function Wt(c,m){switch(c.tag){case 26:case 27:case 5:return Pt(c.type);case 16:return Pt("Lazy");case 13:return c.child!==m&&m!==null?Pt("Suspense Fallback"):Pt("Suspense");case 19:return Pt("SuspenseList");case 0:case 15:return st(c.type,!1);case 11:return st(c.type.render,!1);case 1:return st(c.type,!0);case 31:return Pt("Activity");default:return""}}function Bt(c){try{var m="",j=null;do m+=Wt(c,j),j=c,c=c.return;while(c);return m}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}var yt=Object.prototype.hasOwnProperty,rr=t.unstable_scheduleCallback,St=t.unstable_cancelCallback,xr=t.unstable_shouldYield,hr=t.unstable_requestPaint,zr=t.unstable_now,yn=t.unstable_getCurrentPriorityLevel,Or=t.unstable_ImmediatePriority,xn=t.unstable_UserBlockingPriority,Yr=t.unstable_NormalPriority,tr=t.unstable_LowPriority,tn=t.unstable_IdlePriority,fr=t.log,Yi=t.unstable_setDisableYieldValue,Er=null,wt=null;function sr(c){if(typeof fr=="function"&&Yi(c),wt&&typeof wt.setStrictMode=="function")try{wt.setStrictMode(Er,c)}catch{}}var ur=Math.clz32?Math.clz32:Fr,Yt=Math.log,Kn=Math.LN2;function Fr(c){return c>>>=0,c===0?32:31-(Yt(c)/Kn|0)|0}var Kr=256,Sr=262144,Qr=4194304;function _r(c){var m=c&42;if(m!==0)return m;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return c&261888;case 262144:case 524288:case 1048576:case 2097152:return c&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function On(c,m,j){var _=c.pendingLanes;if(_===0)return 0;var B=0,G=c.suspendedLanes,pe=c.pingedLanes;c=c.warmLanes;var Te=_&134217727;return Te!==0?(_=Te&~G,_!==0?B=_r(_):(pe&=Te,pe!==0?B=_r(pe):j||(j=Te&~c,j!==0&&(B=_r(j))))):(Te=_&~G,Te!==0?B=_r(Te):pe!==0?B=_r(pe):j||(j=_&~c,j!==0&&(B=_r(j)))),B===0?0:m!==0&&m!==B&&(m&G)===0&&(G=B&-B,j=m&-m,G>=j||G===32&&(j&4194048)!==0)?m:B}function Zi(c,m){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&m)===0}function Ia(c,m){switch(c){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vi(){var c=Qr;return Qr<<=1,(Qr&62914560)===0&&(Qr=4194304),c}function $a(c){for(var m=[],j=0;31>j;j++)m.push(c);return m}function vr(c,m){c.pendingLanes|=m,m!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function Oa(c,m,j,_,B,G){var pe=c.pendingLanes;c.pendingLanes=j,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=j,c.entangledLanes&=j,c.errorRecoveryDisabledLanes&=j,c.shellSuspendCounter=0;var Te=c.entanglements,Ue=c.expirationTimes,ft=c.hiddenUpdates;for(j=pe&~j;0<j;){var It=31-ur(j),Mt=1<<It;Te[It]=0,Ue[It]=-1;var gt=ft[It];if(gt!==null)for(ft[It]=null,It=0;It<gt.length;It++){var jt=gt[It];jt!==null&&(jt.lane&=-536870913)}j&=~Mt}_!==0&&ml(c,_,0),G!==0&&B===0&&c.tag!==0&&(c.suspendedLanes|=G&~(pe&~m))}function ml(c,m,j){c.pendingLanes|=m,c.suspendedLanes&=~m;var _=31-ur(m);c.entangledLanes|=m,c.entanglements[_]=c.entanglements[_]|1073741824|j&261930}function ga(c,m){var j=c.entangledLanes|=m;for(c=c.entanglements;j;){var _=31-ur(j),B=1<<_;B&m|c[_]&m&&(c[_]|=m),j&=~B}}function Ds(c,m){var j=m&-m;return j=(j&42)!==0?1:Xr(j),(j&(c.suspendedLanes|m))!==0?0:j}function Xr(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function $t(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function Qn(){var c=ue.p;return c!==0?c:(c=window.event,c===void 0?32:hT(c.type))}function er(c,m){var j=ue.p;try{return ue.p=c,m()}finally{ue.p=j}}var Xi=Math.random().toString(36).slice(2),Yn="__reactFiber$"+Xi,vn="__reactProps$"+Xi,Fi="__reactContainer$"+Xi,Ji="__reactEvents$"+Xi,cs="__reactListeners$"+Xi,ds="__reactHandles$"+Xi,$o="__reactResources$"+Xi,Go="__reactMarker$"+Xi;function Ga(c){delete c[Yn],delete c[vn],delete c[Ji],delete c[cs],delete c[ds]}function fi(c){var m=c[Yn];if(m)return m;for(var j=c.parentNode;j;){if(m=j[Fi]||j[Yn]){if(j=m.alternate,m.child!==null||j!==null&&j.child!==null)for(c=Y4(c);c!==null;){if(j=c[Yn])return j;c=Y4(c)}return m}c=j,j=c.parentNode}return null}function kn(c){if(c=c[Yn]||c[Fi]){var m=c.tag;if(m===5||m===6||m===13||m===31||m===26||m===27||m===3)return c}return null}function Ko(c){var m=c.tag;if(m===5||m===26||m===27||m===6)return c.stateNode;throw Error(i(33))}function Ka(c){var m=c[$o];return m||(m=c[$o]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Oi(c){c[Go]=!0}var Rt=new Set,io={};function zn(c,m){us(c,m),us(c+"Capture",m)}function us(c,m){for(io[c]=m,c=0;c<m.length;c++)Rt.add(m[c])}var kl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_n={},An={};function on(c){return yt.call(An,c)?!0:yt.call(_n,c)?!1:kl.test(c)?An[c]=!0:(_n[c]=!0,!1)}function Jr(c,m,j){if(on(m))if(j===null)c.removeAttribute(m);else{switch(typeof j){case"undefined":case"function":case"symbol":c.removeAttribute(m);return;case"boolean":var _=m.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){c.removeAttribute(m);return}}c.setAttribute(m,""+j)}}function Rn(c,m,j){if(j===null)c.removeAttribute(m);else{switch(typeof j){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(m);return}c.setAttribute(m,""+j)}}function hs(c,m,j,_){if(_===null)c.removeAttribute(j);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(j);return}c.setAttributeNS(m,j,""+_)}}function Mr(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Qa(c){var m=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function No(c,m,j){var _=Object.getOwnPropertyDescriptor(c.constructor.prototype,m);if(!c.hasOwnProperty(m)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var B=_.get,G=_.set;return Object.defineProperty(c,m,{configurable:!0,get:function(){return B.call(this)},set:function(pe){j=""+pe,G.call(this,pe)}}),Object.defineProperty(c,m,{enumerable:_.enumerable}),{getValue:function(){return j},setValue:function(pe){j=""+pe},stopTracking:function(){c._valueTracker=null,delete c[m]}}}}function ir(c){if(!c._valueTracker){var m=Qa(c)?"checked":"value";c._valueTracker=No(c,m,""+c[m])}}function Bn(c){if(!c)return!1;var m=c._valueTracker;if(!m)return!0;var j=m.getValue(),_="";return c&&(_=Qa(c)?c.checked?"true":"false":c.value),c=_,c!==j?(m.setValue(c),!0):!1}function Ya(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var di=/[\n"\\]/g;function kr(c){return c.replace(di,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function ea(c,m,j,_,B,G,pe,Te){c.name="",pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?c.type=pe:c.removeAttribute("type"),m!=null?pe==="number"?(m===0&&c.value===""||c.value!=m)&&(c.value=""+Mr(m)):c.value!==""+Mr(m)&&(c.value=""+Mr(m)):pe!=="submit"&&pe!=="reset"||c.removeAttribute("value"),m!=null?Pe(c,pe,Mr(m)):j!=null?Pe(c,pe,Mr(j)):_!=null&&c.removeAttribute("value"),B==null&&G!=null&&(c.defaultChecked=!!G),B!=null&&(c.checked=B&&typeof B!="function"&&typeof B!="symbol"),Te!=null&&typeof Te!="function"&&typeof Te!="symbol"&&typeof Te!="boolean"?c.name=""+Mr(Te):c.removeAttribute("name")}function it(c,m,j,_,B,G,pe,Te){if(G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(c.type=G),m!=null||j!=null){if(!(G!=="submit"&&G!=="reset"||m!=null)){ir(c);return}j=j!=null?""+Mr(j):"",m=m!=null?""+Mr(m):j,Te||m===c.value||(c.value=m),c.defaultValue=m}_=_??B,_=typeof _!="function"&&typeof _!="symbol"&&!!_,c.checked=Te?c.checked:!!_,c.defaultChecked=!!_,pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"&&(c.name=pe),ir(c)}function Pe(c,m,j){m==="number"&&Ya(c.ownerDocument)===c||c.defaultValue===""+j||(c.defaultValue=""+j)}function Ht(c,m,j,_){if(c=c.options,m){m={};for(var B=0;B<j.length;B++)m["$"+j[B]]=!0;for(j=0;j<c.length;j++)B=m.hasOwnProperty("$"+c[j].value),c[j].selected!==B&&(c[j].selected=B),B&&_&&(c[j].defaultSelected=!0)}else{for(j=""+Mr(j),m=null,B=0;B<c.length;B++){if(c[B].value===j){c[B].selected=!0,_&&(c[B].defaultSelected=!0);return}m!==null||c[B].disabled||(m=c[B])}m!==null&&(m.selected=!0)}}function ni(c,m,j){if(m!=null&&(m=""+Mr(m),m!==c.value&&(c.value=m),j==null)){c.defaultValue!==m&&(c.defaultValue=m);return}c.defaultValue=j!=null?""+Mr(j):""}function la(c,m,j,_){if(m==null){if(_!=null){if(j!=null)throw Error(i(92));if(le(_)){if(1<_.length)throw Error(i(93));_=_[0]}j=_}j==null&&(j=""),m=j}j=Mr(m),c.defaultValue=j,_=c.textContent,_===j&&_!==""&&_!==null&&(c.value=_),ir(c)}function Ps(c,m){if(m){var j=c.firstChild;if(j&&j===c.lastChild&&j.nodeType===3){j.nodeValue=m;return}}c.textContent=m}var Qo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ya(c,m,j){var _=m.indexOf("--")===0;j==null||typeof j=="boolean"||j===""?_?c.setProperty(m,""):m==="float"?c.cssFloat="":c[m]="":_?c.setProperty(m,j):typeof j!="number"||j===0||Qo.has(m)?m==="float"?c.cssFloat=j:c[m]=(""+j).trim():c[m]=j+"px"}function Cr(c,m,j){if(m!=null&&typeof m!="object")throw Error(i(62));if(c=c.style,j!=null){for(var _ in j)!j.hasOwnProperty(_)||m!=null&&m.hasOwnProperty(_)||(_.indexOf("--")===0?c.setProperty(_,""):_==="float"?c.cssFloat="":c[_]="");for(var B in m)_=m[B],m.hasOwnProperty(B)&&j[B]!==_&&ya(c,B,_)}else for(var G in m)m.hasOwnProperty(G)&&ya(c,G,m[G])}function Jn(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ka(c){return qc.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}function Za(){}var Ao=null;function Pl(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var bi=null,qt=null;function ca(c){var m=kn(c);if(m&&(c=m.stateNode)){var j=c[vn]||null;e:switch(c=m.stateNode,m.type){case"input":if(ea(c,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name),m=j.name,j.type==="radio"&&m!=null){for(j=c;j.parentNode;)j=j.parentNode;for(j=j.querySelectorAll('input[name="'+kr(""+m)+'"][type="radio"]'),m=0;m<j.length;m++){var _=j[m];if(_!==c&&_.form===c.form){var B=_[vn]||null;if(!B)throw Error(i(90));ea(_,B.value,B.defaultValue,B.defaultValue,B.checked,B.defaultChecked,B.type,B.name)}}for(m=0;m<j.length;m++)_=j[m],_.form===c.form&&Bn(_)}break e;case"textarea":ni(c,j.value,j.defaultValue);break e;case"select":m=j.value,m!=null&&Ht(c,!!j.multiple,m,!1)}}}var Zt=!1;function ud(c,m,j){if(Zt)return c(m,j);Zt=!0;try{var _=c(m);return _}finally{if(Zt=!1,(bi!==null||qt!==null)&&(fx(),bi&&(m=bi,c=qt,qt=bi=null,ca(m),c)))for(m=0;m<c.length;m++)ca(c[m])}}function Lr(c,m){var j=c.stateNode;if(j===null)return null;var _=j[vn]||null;if(_===null)return null;j=_[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(c=c.type,_=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!_;break e;default:c=!1}if(c)return null;if(j&&typeof j!="function")throw Error(i(231,m,typeof j));return j}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gc=!1;if(Tn)try{var Rs={};Object.defineProperty(Rs,"passive",{get:function(){gc=!0}}),window.addEventListener("test",Rs,Rs),window.removeEventListener("test",Rs,Rs)}catch{gc=!1}var fs=null,Xa=null,mi=null;function Ks(){if(mi)return mi;var c,m=Xa,j=m.length,_,B="value"in fs?fs.value:fs.textContent,G=B.length;for(c=0;c<j&&m[c]===B[c];c++);var pe=j-c;for(_=1;_<=pe&&m[j-_]===B[G-_];_++);return mi=B.slice(c,1<_?1-_:void 0)}function Ja(c){var m=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&m===13&&(c=13)):c=m,c===10&&(c=13),32<=c||c===13?c:0}function Yo(){return!0}function yc(){return!1}function ki(c){function m(j,_,B,G,pe){this._reactName=j,this._targetInst=B,this.type=_,this.nativeEvent=G,this.target=pe,this.currentTarget=null;for(var Te in c)c.hasOwnProperty(Te)&&(j=c[Te],this[Te]=j?j(G):G[Te]);return this.isDefaultPrevented=(G.defaultPrevented!=null?G.defaultPrevented:G.returnValue===!1)?Yo:yc,this.isPropagationStopped=yc,this}return p(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var j=this.nativeEvent;j&&(j.preventDefault?j.preventDefault():typeof j.returnValue!="unknown"&&(j.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var j=this.nativeEvent;j&&(j.stopPropagation?j.stopPropagation():typeof j.cancelBubble!="unknown"&&(j.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),m}var ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ji=ki(ms),Zo=p({},ms,{view:0,detail:0}),mn=ki(Zo),Gl,xa,ao,Kl=p({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ur,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==ao&&(ao&&c.type==="mousemove"?(Gl=c.screenX-ao.screenX,xa=c.screenY-ao.screenY):xa=Gl=0,ao=c),Gl)},movementY:function(c){return"movementY"in c?c.movementY:xa}}),Fn=ki(Kl),Eo=p({},Kl,{dataTransfer:0}),_o=ki(Eo),To=p({},Zo,{relatedTarget:0}),Rl=ki(To),pt=p({},ms,{animationName:0,elapsedTime:0,pseudoElement:0}),te=ki(pt),we=p({},ms,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),Re=ki(we),We=p({},ms,{data:0}),et=ki(We),Ct={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ar={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gt(c){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(c):(c=ar[c])?!!m[c]:!1}function Ur(){return Gt}var lr=p({},Zo,{key:function(c){if(c.key){var m=Ct[c.key]||c.key;if(m!=="Unidentified")return m}return c.type==="keypress"?(c=Ja(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Lt[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ur,charCode:function(c){return c.type==="keypress"?Ja(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Ja(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Sn=ki(lr),ei=p({},Kl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zr=ki(ei),Xt=p({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ur}),va=ki(Xt),rn=p({},ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ei=ki(rn),es=p({},Kl,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),ts=ki(es),Da=p({},ms,{newState:0,oldState:0}),Xo=ki(Da),Pa=[9,13,27,32],so=Tn&&"CompositionEvent"in window,oo=null;Tn&&"documentMode"in document&&(oo=document.documentMode);var Ql=Tn&&"TextEvent"in window&&!oo,Jo=Tn&&(!so||oo&&8<oo&&11>=oo),wi=" ",pl=!1;function Yl(c,m){switch(c){case"keyup":return Pa.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function el(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var gl=!1;function qn(c,m){switch(c){case"compositionend":return el(m);case"keypress":return m.which!==32?null:(pl=!0,wi);case"textInput":return c=m.data,c===wi&&pl?null:c;default:return null}}function rs(c,m){if(gl)return c==="compositionend"||!so&&Yl(c,m)?(c=Ks(),mi=Xa=fs=null,gl=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Jo&&m.locale!=="ko"?null:m.data;default:return null}}var ns={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qs(c){var m=c&&c.nodeName&&c.nodeName.toLowerCase();return m==="input"?!!ns[c.type]:m==="textarea"}function qi(c,m,j,_){bi?qt?qt.push(_):qt=[_]:bi=_,m=bx(m,"onChange"),0<m.length&&(j=new ji("onChange","change",null,j,_),c.push({event:j,listeners:m}))}var ps=null,tl=null;function Ml(c){M4(c,0)}function lo(c){var m=Ko(c);if(Bn(m))return c}function da(c,m){if(c==="change")return m}var Ys=!1;if(Tn){var _i;if(Tn){var is="oninput"in document;if(!is){var ln=document.createElement("div");ln.setAttribute("oninput","return;"),is=typeof ln.oninput=="function"}_i=is}else _i=!1;Ys=_i&&(!document.documentMode||9<document.documentMode)}function Zs(){ps&&(ps.detachEvent("onpropertychange",je),tl=ps=null)}function je(c){if(c.propertyName==="value"&&lo(tl)){var m=[];qi(m,tl,c,Pl(c)),ud(Ml,m)}}function h(c,m,j){c==="focusin"?(Zs(),ps=m,tl=j,ps.attachEvent("onpropertychange",je)):c==="focusout"&&Zs()}function g(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return lo(tl)}function b(c,m){if(c==="click")return lo(m)}function S(c,m){if(c==="input"||c==="change")return lo(m)}function N(c,m){return c===m&&(c!==0||1/c===1/m)||c!==c&&m!==m}var I=typeof Object.is=="function"?Object.is:N;function R(c,m){if(I(c,m))return!0;if(typeof c!="object"||c===null||typeof m!="object"||m===null)return!1;var j=Object.keys(c),_=Object.keys(m);if(j.length!==_.length)return!1;for(_=0;_<j.length;_++){var B=j[_];if(!yt.call(m,B)||!I(c[B],m[B]))return!1}return!0}function H(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function ne(c,m){var j=H(c);c=0;for(var _;j;){if(j.nodeType===3){if(_=c+j.textContent.length,c<=m&&_>=m)return{node:j,offset:m-c};c=_}e:{for(;j;){if(j.nextSibling){j=j.nextSibling;break e}j=j.parentNode}j=void 0}j=H(j)}}function he(c,m){return c&&m?c===m?!0:c&&c.nodeType===3?!1:m&&m.nodeType===3?he(c,m.parentNode):"contains"in c?c.contains(m):c.compareDocumentPosition?!!(c.compareDocumentPosition(m)&16):!1:!1}function ve(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var m=Ya(c.document);m instanceof c.HTMLIFrameElement;){try{var j=typeof m.contentWindow.location.href=="string"}catch{j=!1}if(j)c=m.contentWindow;else break;m=Ya(c.document)}return m}function Ne(c){var m=c&&c.nodeName&&c.nodeName.toLowerCase();return m&&(m==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||m==="textarea"||c.contentEditable==="true")}var Me=Tn&&"documentMode"in document&&11>=document.documentMode,qe=null,$e=null,Xe=null,ct=!1;function Tt(c,m,j){var _=j.window===j?j.document:j.nodeType===9?j:j.ownerDocument;ct||qe==null||qe!==Ya(_)||(_=qe,"selectionStart"in _&&Ne(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Xe&&R(Xe,_)||(Xe=_,_=bx($e,"onSelect"),0<_.length&&(m=new ji("onSelect","select",null,m,j),c.push({event:m,listeners:_}),m.target=qe)))}function _t(c,m){var j={};return j[c.toLowerCase()]=m.toLowerCase(),j["Webkit"+c]="webkit"+m,j["Moz"+c]="moz"+m,j}var At={animationend:_t("Animation","AnimationEnd"),animationiteration:_t("Animation","AnimationIteration"),animationstart:_t("Animation","AnimationStart"),transitionrun:_t("Transition","TransitionRun"),transitionstart:_t("Transition","TransitionStart"),transitioncancel:_t("Transition","TransitionCancel"),transitionend:_t("Transition","TransitionEnd")},Tr={},qr={};Tn&&(qr=document.createElement("div").style,"AnimationEvent"in window||(delete At.animationend.animation,delete At.animationiteration.animation,delete At.animationstart.animation),"TransitionEvent"in window||delete At.transitionend.transition);function Mn(c){if(Tr[c])return Tr[c];if(!At[c])return c;var m=At[c],j;for(j in m)if(m.hasOwnProperty(j)&&j in qr)return Tr[c]=m[j];return c}var ua=Mn("animationend"),Ra=Mn("animationiteration"),Un=Mn("animationstart"),Ma=Mn("transitionrun"),Ms=Mn("transitionstart"),xc=Mn("transitioncancel"),Io=Mn("transitionend"),ju=new Map,Oo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Oo.push("scrollEnd");function rl(c,m){ju.set(c,m),zn(m,[c])}var Pd=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)},nl=[],co=0,wu=0;function Rd(){for(var c=co,m=wu=co=0;m<c;){var j=nl[m];nl[m++]=null;var _=nl[m];nl[m++]=null;var B=nl[m];nl[m++]=null;var G=nl[m];if(nl[m++]=null,_!==null&&B!==null){var pe=_.pending;pe===null?B.next=B:(B.next=pe.next,pe.next=B),_.pending=B}G!==0&&bc(j,B,G)}}function vc(c,m,j,_){nl[co++]=c,nl[co++]=m,nl[co++]=j,nl[co++]=_,wu|=_,c.lanes|=_,c=c.alternate,c!==null&&(c.lanes|=_)}function Sh(c,m,j,_){return vc(c,m,j,_),Ls(c)}function yl(c,m){return vc(c,null,null,m),Ls(c)}function bc(c,m,j){c.lanes|=j;var _=c.alternate;_!==null&&(_.lanes|=j);for(var B=!1,G=c.return;G!==null;)G.childLanes|=j,_=G.alternate,_!==null&&(_.childLanes|=j),G.tag===22&&(c=G.stateNode,c===null||c._visibility&1||(B=!0)),c=G,G=G.return;return c.tag===3?(G=c.stateNode,B&&m!==null&&(B=31-ur(j),c=G.hiddenUpdates,_=c[B],_===null?c[B]=[m]:_.push(m),m.lane=j|536870912),G):null}function Ls(c){if(50<L0)throw L0=0,Uj=null,Error(i(185));for(var m=c.return;m!==null;)c=m,m=c.return;return c.tag===3?c.stateNode:null}var gs={};function Ch(c,m,j,_){this.tag=c,this.key=j,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zs(c,m,j,_){return new Ch(c,m,j,_)}function Su(c){return c=c.prototype,!(!c||!c.isReactComponent)}function il(c,m){var j=c.alternate;return j===null?(j=zs(c.tag,m,c.key,c.mode),j.elementType=c.elementType,j.type=c.type,j.stateNode=c.stateNode,j.alternate=c,c.alternate=j):(j.pendingProps=m,j.type=c.type,j.flags=0,j.subtreeFlags=0,j.deletions=null),j.flags=c.flags&65011712,j.childLanes=c.childLanes,j.lanes=c.lanes,j.child=c.child,j.memoizedProps=c.memoizedProps,j.memoizedState=c.memoizedState,j.updateQueue=c.updateQueue,m=c.dependencies,j.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},j.sibling=c.sibling,j.index=c.index,j.ref=c.ref,j.refCleanup=c.refCleanup,j}function Md(c,m){c.flags&=65011714;var j=c.alternate;return j===null?(c.childLanes=0,c.lanes=m,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=j.childLanes,c.lanes=j.lanes,c.child=j.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=j.memoizedProps,c.memoizedState=j.memoizedState,c.updateQueue=j.updateQueue,c.type=j.type,m=j.dependencies,c.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),c}function hd(c,m,j,_,B,G){var pe=0;if(_=c,typeof c=="function")Su(c)&&(pe=1);else if(typeof c=="string")pe=lV(c,j,W.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case F:return c=zs(31,j,m,B),c.elementType=F,c.lanes=G,c;case C:return Uc(j.children,B,G,m);case A:pe=8,B|=24;break;case T:return c=zs(12,j,m,B|2),c.elementType=T,c.lanes=G,c;case Q:return c=zs(13,j,m,B),c.elementType=Q,c.lanes=G,c;case U:return c=zs(19,j,m,B),c.elementType=U,c.lanes=G,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case D:pe=10;break e;case O:pe=9;break e;case M:pe=11;break e;case $:pe=14;break e;case ee:pe=16,_=null;break e}pe=29,j=Error(i(130,c===null?"null":typeof c,"")),_=null}return m=zs(pe,j,m,B),m.elementType=c,m.type=_,m.lanes=G,m}function Uc(c,m,j,_){return c=zs(7,c,_,m),c.lanes=j,c}function Ld(c,m,j){return c=zs(6,c,null,m),c.lanes=j,c}function Cu(c){var m=zs(18,null,null,0);return m.stateNode=c,m}function zd(c,m,j){return m=zs(4,c.children!==null?c.children:[],c.key,m),m.lanes=j,m.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},m}var y=new WeakMap;function E(c,m){if(typeof c=="object"&&c!==null){var j=y.get(c);return j!==void 0?j:(m={value:c,source:m,stack:Bt(m)},y.set(c,m),m)}return{value:c,source:m,stack:Bt(m)}}var z=[],ie=0,me=null,Ee=0,Fe=[],tt=0,mt=null,kt=1,Kt="";function br(c,m){z[ie++]=Ee,z[ie++]=me,me=c,Ee=m}function Cn(c,m,j){Fe[tt++]=kt,Fe[tt++]=Kt,Fe[tt++]=mt,mt=c;var _=kt;c=Kt;var B=32-ur(_)-1;_&=~(1<<B),j+=1;var G=32-ur(m)+B;if(30<G){var pe=B-B%5;G=(_&(1<<pe)-1).toString(32),_>>=pe,B-=pe,kt=1<<32-ur(m)+B|j<<B|_,Kt=G+c}else kt=1<<G|j<<B|_,Kt=c}function Bs(c){c.return!==null&&(br(c,1),Cn(c,1,0))}function ba(c){for(;c===me;)me=z[--ie],z[ie]=null,Ee=z[--ie],z[ie]=null;for(;c===mt;)mt=Fe[--tt],Fe[tt]=null,Kt=Fe[--tt],Fe[tt]=null,kt=Fe[--tt],Fe[tt]=null}function al(c,m){Fe[tt++]=kt,Fe[tt++]=Kt,Fe[tt++]=mt,kt=m.id,Kt=m.overflow,mt=c}var ii=null,ai=null,Ln=!1,uo=null,ha=!1,xl=Error(i(519));function Wc(c){var m=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bd(E(m,c)),xl}function Nh(c){var m=c.stateNode,j=c.type,_=c.memoizedProps;switch(m[Yn]=c,m[vn]=_,j){case"dialog":Vn("cancel",m),Vn("close",m);break;case"iframe":case"object":case"embed":Vn("load",m);break;case"video":case"audio":for(j=0;j<B0.length;j++)Vn(B0[j],m);break;case"source":Vn("error",m);break;case"img":case"image":case"link":Vn("error",m),Vn("load",m);break;case"details":Vn("toggle",m);break;case"input":Vn("invalid",m),it(m,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0);break;case"select":Vn("invalid",m);break;case"textarea":Vn("invalid",m),la(m,_.value,_.defaultValue,_.children)}j=_.children,typeof j!="string"&&typeof j!="number"&&typeof j!="bigint"||m.textContent===""+j||_.suppressHydrationWarning===!0||F4(m.textContent,j)?(_.popover!=null&&(Vn("beforetoggle",m),Vn("toggle",m)),_.onScroll!=null&&Vn("scroll",m),_.onScrollEnd!=null&&Vn("scrollend",m),_.onClick!=null&&(m.onclick=Za),m=!0):m=!1,m||Wc(c,!0)}function pi(c){for(ii=c.return;ii;)switch(ii.tag){case 5:case 31:case 13:ha=!1;return;case 27:case 3:ha=!0;return;default:ii=ii.return}}function La(c){if(c!==ii)return!1;if(!Ln)return pi(c),Ln=!0,!1;var m=c.tag,j;if((j=m!==3&&m!==27)&&((j=m===5)&&(j=c.type,j=!(j!=="form"&&j!=="button")||n5(c.type,c.memoizedProps)),j=!j),j&&ai&&Wc(c),pi(c),m===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));ai=Q4(c)}else if(m===31){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));ai=Q4(c)}else m===27?(m=ai,Bh(c.type)?(c=l5,l5=null,ai=c):ai=m):ai=ii?$c(c.stateNode.nextSibling):null;return!0}function fd(){ai=ii=null,Ln=!1}function bf(){var c=uo;return c!==null&&(nc===null?nc=c:nc.push.apply(nc,c),uo=null),c}function Bd(c){uo===null?uo=[c]:uo.push(c)}var Fd=V(null),jc=null,Zl=null;function qd(c,m,j){se(Fd,m._currentValue),m._currentValue=j}function Xl(c){c._currentValue=Fd.current,X(Fd)}function Ah(c,m,j){for(;c!==null;){var _=c.alternate;if((c.childLanes&m)!==m?(c.childLanes|=m,_!==null&&(_.childLanes|=m)):_!==null&&(_.childLanes&m)!==m&&(_.childLanes|=m),c===j)break;c=c.return}}function Nu(c,m,j,_){var B=c.child;for(B!==null&&(B.return=c);B!==null;){var G=B.dependencies;if(G!==null){var pe=B.child;G=G.firstContext;e:for(;G!==null;){var Te=G;G=B;for(var Ue=0;Ue<m.length;Ue++)if(Te.context===m[Ue]){G.lanes|=j,Te=G.alternate,Te!==null&&(Te.lanes|=j),Ah(G.return,j,c),_||(pe=null);break e}G=Te.next}}else if(B.tag===18){if(pe=B.return,pe===null)throw Error(i(341));pe.lanes|=j,G=pe.alternate,G!==null&&(G.lanes|=j),Ah(pe,j,c),pe=null}else pe=B.child;if(pe!==null)pe.return=B;else for(pe=B;pe!==null;){if(pe===c){pe=null;break}if(B=pe.sibling,B!==null){B.return=pe.return,pe=B;break}pe=pe.return}B=pe}}function Ud(c,m,j,_){c=null;for(var B=m,G=!1;B!==null;){if(!G){if((B.flags&524288)!==0)G=!0;else if((B.flags&262144)!==0)break}if(B.tag===10){var pe=B.alternate;if(pe===null)throw Error(i(387));if(pe=pe.memoizedProps,pe!==null){var Te=B.type;I(B.pendingProps.value,pe.value)||(c!==null?c.push(Te):c=[Te])}}else if(B===be.current){if(pe=B.alternate,pe===null)throw Error(i(387));pe.memoizedState.memoizedState!==B.memoizedState.memoizedState&&(c!==null?c.push(H0):c=[H0])}B=B.return}c!==null&&Nu(m,c,j,_),m.flags|=262144}function Im(c){for(c=c.firstContext;c!==null;){if(!I(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function Wd(c){jc=c,Zl=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function ho(c){return Ky(jc,c)}function Om(c,m){return jc===null&&Wd(c),Ky(c,m)}function Ky(c,m){var j=m._currentValue;if(m={context:m,memoizedValue:j,next:null},Zl===null){if(c===null)throw Error(i(308));Zl=m,c.dependencies={lanes:0,firstContext:m},c.flags|=524288}else Zl=Zl.next=m;return j}var oj=typeof AbortController<"u"?AbortController:function(){var c=[],m=this.signal={aborted:!1,addEventListener:function(j,_){c.push(_)}};this.abort=function(){m.aborted=!0,c.forEach(function(j){return j()})}},lj=t.unstable_scheduleCallback,cj=t.unstable_NormalPriority,as={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Eh(){return{controller:new oj,data:new Map,refCount:0}}function jf(c){c.refCount--,c.refCount===0&&lj(cj,function(){c.controller.abort()})}var wf=null,km=0,P=0,q=null;function ae(c,m){if(wf===null){var j=wf=[];km=0,P=Kj(),q={status:"pending",value:void 0,then:function(_){j.push(_)}}}return km++,m.then(fe,fe),m}function fe(){if(--km===0&&wf!==null){q!==null&&(q.status="fulfilled");var c=wf;wf=null,P=0,q=null;for(var m=0;m<c.length;m++)(0,c[m])()}}function Ce(c,m){var j=[],_={status:"pending",value:null,reason:null,then:function(B){j.push(B)}};return c.then(function(){_.status="fulfilled",_.value=m;for(var B=0;B<j.length;B++)(0,j[B])(m)},function(B){for(_.status="rejected",_.reason=B,B=0;B<j.length;B++)(0,j[B])(void 0)}),_}var Ae=K.S;K.S=function(c,m){d4=zr(),typeof m=="object"&&m!==null&&typeof m.then=="function"&&ae(c,m),Ae!==null&&Ae(c,m)};var _e=V(null);function Ie(){var c=_e.current;return c!==null?c:ra.pooledCache}function De(c,m){m===null?se(_e,_e.current):se(_e,m.pool)}function Be(){var c=Ie();return c===null?null:{parent:as._currentValue,pool:c}}var Ge=Error(i(460)),dt=Error(i(474)),ze=Error(i(542)),Ye={then:function(){}};function at(c){return c=c.status,c==="fulfilled"||c==="rejected"}function Et(c,m,j){switch(j=c[j],j===void 0?c.push(m):j!==m&&(m.then(Za,Za),m=j),m.status){case"fulfilled":return m.value;case"rejected":throw c=m.reason,Ut(c),c;default:if(typeof m.status=="string")m.then(Za,Za);else{if(c=ra,c!==null&&100<c.shellSuspendCounter)throw Error(i(482));c=m,c.status="pending",c.then(function(_){if(m.status==="pending"){var B=m;B.status="fulfilled",B.value=_}},function(_){if(m.status==="pending"){var B=m;B.status="rejected",B.reason=_}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw c=m.reason,Ut(c),c}throw Nt=m,Ge}}function lt(c){try{var m=c._init;return m(c._payload)}catch(j){throw j!==null&&typeof j=="object"&&typeof j.then=="function"?(Nt=j,Ge):j}}var Nt=null;function Ot(){if(Nt===null)throw Error(i(459));var c=Nt;return Nt=null,c}function Ut(c){if(c===Ge||c===ze)throw Error(i(483))}var zt=null,Nr=0;function cr(c){var m=Nr;return Nr+=1,zt===null&&(zt=[]),Et(zt,c,m)}function un(c,m){m=m.props.ref,c.ref=m!==void 0?m:null}function gr(c,m){throw m.$$typeof===x?Error(i(525)):(c=Object.prototype.toString.call(m),Error(i(31,c==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":c)))}function Wn(c){function m(rt,Ke){if(c){var ht=rt.deletions;ht===null?(rt.deletions=[Ke],rt.flags|=16):ht.push(Ke)}}function j(rt,Ke){if(!c)return null;for(;Ke!==null;)m(rt,Ke),Ke=Ke.sibling;return null}function _(rt){for(var Ke=new Map;rt!==null;)rt.key!==null?Ke.set(rt.key,rt):Ke.set(rt.index,rt),rt=rt.sibling;return Ke}function B(rt,Ke){return rt=il(rt,Ke),rt.index=0,rt.sibling=null,rt}function G(rt,Ke,ht){return rt.index=ht,c?(ht=rt.alternate,ht!==null?(ht=ht.index,ht<Ke?(rt.flags|=67108866,Ke):ht):(rt.flags|=67108866,Ke)):(rt.flags|=1048576,Ke)}function pe(rt){return c&&rt.alternate===null&&(rt.flags|=67108866),rt}function Te(rt,Ke,ht,Dt){return Ke===null||Ke.tag!==6?(Ke=Ld(ht,rt.mode,Dt),Ke.return=rt,Ke):(Ke=B(Ke,ht),Ke.return=rt,Ke)}function Ue(rt,Ke,ht,Dt){var $r=ht.type;return $r===C?It(rt,Ke,ht.props.children,Dt,ht.key):Ke!==null&&(Ke.elementType===$r||typeof $r=="object"&&$r!==null&&$r.$$typeof===ee&&lt($r)===Ke.type)?(Ke=B(Ke,ht.props),un(Ke,ht),Ke.return=rt,Ke):(Ke=hd(ht.type,ht.key,ht.props,null,rt.mode,Dt),un(Ke,ht),Ke.return=rt,Ke)}function ft(rt,Ke,ht,Dt){return Ke===null||Ke.tag!==4||Ke.stateNode.containerInfo!==ht.containerInfo||Ke.stateNode.implementation!==ht.implementation?(Ke=zd(ht,rt.mode,Dt),Ke.return=rt,Ke):(Ke=B(Ke,ht.children||[]),Ke.return=rt,Ke)}function It(rt,Ke,ht,Dt,$r){return Ke===null||Ke.tag!==7?(Ke=Uc(ht,rt.mode,Dt,$r),Ke.return=rt,Ke):(Ke=B(Ke,ht),Ke.return=rt,Ke)}function Mt(rt,Ke,ht){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return Ke=Ld(""+Ke,rt.mode,ht),Ke.return=rt,Ke;if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case v:return ht=hd(Ke.type,Ke.key,Ke.props,null,rt.mode,ht),un(ht,Ke),ht.return=rt,ht;case w:return Ke=zd(Ke,rt.mode,ht),Ke.return=rt,Ke;case ee:return Ke=lt(Ke),Mt(rt,Ke,ht)}if(le(Ke)||Z(Ke))return Ke=Uc(Ke,rt.mode,ht,null),Ke.return=rt,Ke;if(typeof Ke.then=="function")return Mt(rt,cr(Ke),ht);if(Ke.$$typeof===D)return Mt(rt,Om(rt,Ke),ht);gr(rt,Ke)}return null}function gt(rt,Ke,ht,Dt){var $r=Ke!==null?Ke.key:null;if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return $r!==null?null:Te(rt,Ke,""+ht,Dt);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case v:return ht.key===$r?Ue(rt,Ke,ht,Dt):null;case w:return ht.key===$r?ft(rt,Ke,ht,Dt):null;case ee:return ht=lt(ht),gt(rt,Ke,ht,Dt)}if(le(ht)||Z(ht))return $r!==null?null:It(rt,Ke,ht,Dt,null);if(typeof ht.then=="function")return gt(rt,Ke,cr(ht),Dt);if(ht.$$typeof===D)return gt(rt,Ke,Om(rt,ht),Dt);gr(rt,ht)}return null}function jt(rt,Ke,ht,Dt,$r){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return rt=rt.get(ht)||null,Te(Ke,rt,""+Dt,$r);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case v:return rt=rt.get(Dt.key===null?ht:Dt.key)||null,Ue(Ke,rt,Dt,$r);case w:return rt=rt.get(Dt.key===null?ht:Dt.key)||null,ft(Ke,rt,Dt,$r);case ee:return Dt=lt(Dt),jt(rt,Ke,ht,Dt,$r)}if(le(Dt)||Z(Dt))return rt=rt.get(ht)||null,It(Ke,rt,Dt,$r,null);if(typeof Dt.then=="function")return jt(rt,Ke,ht,cr(Dt),$r);if(Dt.$$typeof===D)return jt(rt,Ke,ht,Om(Ke,Dt),$r);gr(Ke,Dt)}return null}function jr(rt,Ke,ht,Dt){for(var $r=null,gi=null,Pr=Ke,In=Ke=0,Xn=null;Pr!==null&&In<ht.length;In++){Pr.index>In?(Xn=Pr,Pr=null):Xn=Pr.sibling;var yi=gt(rt,Pr,ht[In],Dt);if(yi===null){Pr===null&&(Pr=Xn);break}c&&Pr&&yi.alternate===null&&m(rt,Pr),Ke=G(yi,Ke,In),gi===null?$r=yi:gi.sibling=yi,gi=yi,Pr=Xn}if(In===ht.length)return j(rt,Pr),Ln&&br(rt,In),$r;if(Pr===null){for(;In<ht.length;In++)Pr=Mt(rt,ht[In],Dt),Pr!==null&&(Ke=G(Pr,Ke,In),gi===null?$r=Pr:gi.sibling=Pr,gi=Pr);return Ln&&br(rt,In),$r}for(Pr=_(Pr);In<ht.length;In++)Xn=jt(Pr,rt,In,ht[In],Dt),Xn!==null&&(c&&Xn.alternate!==null&&Pr.delete(Xn.key===null?In:Xn.key),Ke=G(Xn,Ke,In),gi===null?$r=Xn:gi.sibling=Xn,gi=Xn);return c&&Pr.forEach(function(Hh){return m(rt,Hh)}),Ln&&br(rt,In),$r}function nn(rt,Ke,ht,Dt){if(ht==null)throw Error(i(151));for(var $r=null,gi=null,Pr=Ke,In=Ke=0,Xn=null,yi=ht.next();Pr!==null&&!yi.done;In++,yi=ht.next()){Pr.index>In?(Xn=Pr,Pr=null):Xn=Pr.sibling;var Hh=gt(rt,Pr,yi.value,Dt);if(Hh===null){Pr===null&&(Pr=Xn);break}c&&Pr&&Hh.alternate===null&&m(rt,Pr),Ke=G(Hh,Ke,In),gi===null?$r=Hh:gi.sibling=Hh,gi=Hh,Pr=Xn}if(yi.done)return j(rt,Pr),Ln&&br(rt,In),$r;if(Pr===null){for(;!yi.done;In++,yi=ht.next())yi=Mt(rt,yi.value,Dt),yi!==null&&(Ke=G(yi,Ke,In),gi===null?$r=yi:gi.sibling=yi,gi=yi);return Ln&&br(rt,In),$r}for(Pr=_(Pr);!yi.done;In++,yi=ht.next())yi=jt(Pr,rt,In,yi.value,Dt),yi!==null&&(c&&yi.alternate!==null&&Pr.delete(yi.key===null?In:yi.key),Ke=G(yi,Ke,In),gi===null?$r=yi:gi.sibling=yi,gi=yi);return c&&Pr.forEach(function(vV){return m(rt,vV)}),Ln&&br(rt,In),$r}function Vi(rt,Ke,ht,Dt){if(typeof ht=="object"&&ht!==null&&ht.type===C&&ht.key===null&&(ht=ht.props.children),typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case v:e:{for(var $r=ht.key;Ke!==null;){if(Ke.key===$r){if($r=ht.type,$r===C){if(Ke.tag===7){j(rt,Ke.sibling),Dt=B(Ke,ht.props.children),Dt.return=rt,rt=Dt;break e}}else if(Ke.elementType===$r||typeof $r=="object"&&$r!==null&&$r.$$typeof===ee&&lt($r)===Ke.type){j(rt,Ke.sibling),Dt=B(Ke,ht.props),un(Dt,ht),Dt.return=rt,rt=Dt;break e}j(rt,Ke);break}else m(rt,Ke);Ke=Ke.sibling}ht.type===C?(Dt=Uc(ht.props.children,rt.mode,Dt,ht.key),Dt.return=rt,rt=Dt):(Dt=hd(ht.type,ht.key,ht.props,null,rt.mode,Dt),un(Dt,ht),Dt.return=rt,rt=Dt)}return pe(rt);case w:e:{for($r=ht.key;Ke!==null;){if(Ke.key===$r)if(Ke.tag===4&&Ke.stateNode.containerInfo===ht.containerInfo&&Ke.stateNode.implementation===ht.implementation){j(rt,Ke.sibling),Dt=B(Ke,ht.children||[]),Dt.return=rt,rt=Dt;break e}else{j(rt,Ke);break}else m(rt,Ke);Ke=Ke.sibling}Dt=zd(ht,rt.mode,Dt),Dt.return=rt,rt=Dt}return pe(rt);case ee:return ht=lt(ht),Vi(rt,Ke,ht,Dt)}if(le(ht))return jr(rt,Ke,ht,Dt);if(Z(ht)){if($r=Z(ht),typeof $r!="function")throw Error(i(150));return ht=$r.call(ht),nn(rt,Ke,ht,Dt)}if(typeof ht.then=="function")return Vi(rt,Ke,cr(ht),Dt);if(ht.$$typeof===D)return Vi(rt,Ke,Om(rt,ht),Dt);gr(rt,ht)}return typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint"?(ht=""+ht,Ke!==null&&Ke.tag===6?(j(rt,Ke.sibling),Dt=B(Ke,ht),Dt.return=rt,rt=Dt):(j(rt,Ke),Dt=Ld(ht,rt.mode,Dt),Dt.return=rt,rt=Dt),pe(rt)):j(rt,Ke)}return function(rt,Ke,ht,Dt){try{Nr=0;var $r=Vi(rt,Ke,ht,Dt);return zt=null,$r}catch(Pr){if(Pr===Ge||Pr===ze)throw Pr;var gi=zs(29,Pr,null,rt.mode);return gi.lanes=Dt,gi.return=rt,gi}}}var ta=Wn(!0),bn=Wn(!1),dr=!1;function Jt(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ja(c,m){c=c.updateQueue,m.updateQueue===c&&(m.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function en(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Nn(c,m,j){var _=c.updateQueue;if(_===null)return null;if(_=_.shared,(Ni&2)!==0){var B=_.pending;return B===null?m.next=m:(m.next=B.next,B.next=m),_.pending=m,m=Ls(c),bc(c,null,j),m}return vc(c,_,m,j),Ls(c)}function Si(c,m,j){if(m=m.updateQueue,m!==null&&(m=m.shared,(j&4194048)!==0)){var _=m.lanes;_&=c.pendingLanes,j|=_,m.lanes=j,ga(c,j)}}function Fs(c,m){var j=c.updateQueue,_=c.alternate;if(_!==null&&(_=_.updateQueue,j===_)){var B=null,G=null;if(j=j.firstBaseUpdate,j!==null){do{var pe={lane:j.lane,tag:j.tag,payload:j.payload,callback:null,next:null};G===null?B=G=pe:G=G.next=pe,j=j.next}while(j!==null);G===null?B=G=m:G=G.next=m}else B=G=m;j={baseState:_.baseState,firstBaseUpdate:B,lastBaseUpdate:G,shared:_.shared,callbacks:_.callbacks},c.updateQueue=j;return}c=j.lastBaseUpdate,c===null?j.firstBaseUpdate=m:c.next=m,j.lastBaseUpdate=m}var fo=!1;function Ui(){if(fo){var c=q;if(c!==null)throw c}}function ys(c,m,j,_){fo=!1;var B=c.updateQueue;dr=!1;var G=B.firstBaseUpdate,pe=B.lastBaseUpdate,Te=B.shared.pending;if(Te!==null){B.shared.pending=null;var Ue=Te,ft=Ue.next;Ue.next=null,pe===null?G=ft:pe.next=ft,pe=Ue;var It=c.alternate;It!==null&&(It=It.updateQueue,Te=It.lastBaseUpdate,Te!==pe&&(Te===null?It.firstBaseUpdate=ft:Te.next=ft,It.lastBaseUpdate=Ue))}if(G!==null){var Mt=B.baseState;pe=0,It=ft=Ue=null,Te=G;do{var gt=Te.lane&-536870913,jt=gt!==Te.lane;if(jt?(Zn&gt)===gt:(_&gt)===gt){gt!==0&&gt===P&&(fo=!0),It!==null&&(It=It.next={lane:0,tag:Te.tag,payload:Te.payload,callback:null,next:null});e:{var jr=c,nn=Te;gt=m;var Vi=j;switch(nn.tag){case 1:if(jr=nn.payload,typeof jr=="function"){Mt=jr.call(Vi,Mt,gt);break e}Mt=jr;break e;case 3:jr.flags=jr.flags&-65537|128;case 0:if(jr=nn.payload,gt=typeof jr=="function"?jr.call(Vi,Mt,gt):jr,gt==null)break e;Mt=p({},Mt,gt);break e;case 2:dr=!0}}gt=Te.callback,gt!==null&&(c.flags|=64,jt&&(c.flags|=8192),jt=B.callbacks,jt===null?B.callbacks=[gt]:jt.push(gt))}else jt={lane:gt,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null},It===null?(ft=It=jt,Ue=Mt):It=It.next=jt,pe|=gt;if(Te=Te.next,Te===null){if(Te=B.shared.pending,Te===null)break;jt=Te,Te=jt.next,jt.next=null,B.lastBaseUpdate=jt,B.shared.pending=null}}while(!0);It===null&&(Ue=Mt),B.baseState=Ue,B.firstBaseUpdate=ft,B.lastBaseUpdate=It,G===null&&(B.shared.lanes=0),Ph|=pe,c.lanes=pe,c.memoizedState=Mt}}function ko(c,m){if(typeof c!="function")throw Error(i(191,c));c.call(m)}function xs(c,m){var j=c.callbacks;if(j!==null)for(c.callbacks=null,c=0;c<j.length;c++)ko(j[c],m)}var Dn=V(null),si=V(0);function wa(c,m){c=Ru,se(si,c),se(Dn,m),Ru=c|m.baseLanes}function ui(){se(si,Ru),se(Dn,Dn.current)}function qs(){Ru=si.current,X(Dn),X(si)}var Sa=V(null),oi=null;function ss(c){var m=c.alternate;se(ti,ti.current&1),se(Sa,c),oi===null&&(m===null||Dn.current!==null||m.memoizedState!==null)&&(oi=c)}function Ci(c){se(ti,ti.current),se(Sa,c),oi===null&&(oi=c)}function vs(c){c.tag===22?(se(ti,ti.current),se(Sa,c),oi===null&&(oi=c)):bs()}function bs(){se(ti,ti.current),se(Sa,Sa.current)}function Di(c){X(Sa),oi===c&&(oi=null),X(ti)}var ti=V(0);function Do(c){for(var m=c;m!==null;){if(m.tag===13){var j=m.memoizedState;if(j!==null&&(j=j.dehydrated,j===null||s5(j)||o5(j)))return m}else if(m.tag===19&&(m.memoizedProps.revealOrder==="forwards"||m.memoizedProps.revealOrder==="backwards"||m.memoizedProps.revealOrder==="unstable_legacy-backwards"||m.memoizedProps.revealOrder==="together")){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var za=0,Wr=null,Vr=null,li=null,vl=!1,Jl=!1,sl=!1,js=0,Hd=0,Vd=null,Dm=0;function Wi(){throw Error(i(321))}function v0(c,m){if(m===null)return!1;for(var j=0;j<m.length&&j<c.length;j++)if(!I(c[j],m[j]))return!1;return!0}function b0(c,m,j,_,B,G){return za=G,Wr=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,K.H=c===null||c.memoizedState===null?j3:yj,sl=!1,G=j(_,B),sl=!1,Jl&&(G=md(m,j,_,B)),Pm(c),G}function Pm(c){K.H=_0;var m=Vr!==null&&Vr.next!==null;if(za=0,li=Vr=Wr=null,vl=!1,Hd=0,Vd=null,m)throw Error(i(300));c===null||Js||(c=c.dependencies,c!==null&&Im(c)&&(Js=!0))}function md(c,m,j,_){Wr=c;var B=0;do{if(Jl&&(Vd=null),Hd=0,Jl=!1,25<=B)throw Error(i(301));if(B+=1,li=Vr=null,c.updateQueue!=null){var G=c.updateQueue;G.lastEffect=null,G.events=null,G.stores=null,G.memoCache!=null&&(G.memoCache.index=0)}K.H=w3,G=m(j,_)}while(Jl);return G}function dj(){var c=K.H,m=c.useState()[0];return m=typeof m.then=="function"?$d(m):m,c=c.useState()[0],(Vr!==null?Vr.memoizedState:null)!==c&&(Wr.flags|=1024),m}function j0(){var c=js!==0;return js=0,c}function w0(c,m,j){m.updateQueue=c.updateQueue,m.flags&=-2053,c.lanes&=~j}function Rm(c){if(vl){for(c=c.memoizedState;c!==null;){var m=c.queue;m!==null&&(m.pending=null),c=c.next}vl=!1}za=0,li=Vr=Wr=null,Jl=!1,Hd=js=0,Vd=null}function Xs(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return li===null?Wr.memoizedState=li=c:li=li.next=c,li}function Ba(){if(Vr===null){var c=Wr.alternate;c=c!==null?c.memoizedState:null}else c=Vr.next;var m=li===null?Wr.memoizedState:li.next;if(m!==null)li=m,Vr=c;else{if(c===null)throw Wr.alternate===null?Error(i(467)):Error(i(310));Vr=c,c={memoizedState:Vr.memoizedState,baseState:Vr.baseState,baseQueue:Vr.baseQueue,queue:Vr.queue,next:null},li===null?Wr.memoizedState=li=c:li=li.next=c}return li}function Sf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $d(c){var m=Hd;return Hd+=1,Vd===null&&(Vd=[]),c=Et(Vd,c,m),m=Wr,(li===null?m.memoizedState:li.next)===null&&(m=m.alternate,K.H=m===null||m.memoizedState===null?j3:yj),c}function _h(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return $d(c);if(c.$$typeof===D)return ho(c)}throw Error(i(438,String(c)))}function Au(c){var m=null,j=Wr.updateQueue;if(j!==null&&(m=j.memoCache),m==null){var _=Wr.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(m={data:_.data.map(function(B){return B.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),j===null&&(j=Sf(),Wr.updateQueue=j),j.memoCache=m,j=m.data[m.index],j===void 0)for(j=m.data[m.index]=Array(c),_=0;_<c;_++)j[_]=Y;return m.index++,j}function Hc(c,m){return typeof m=="function"?m(c):m}function Mm(c){var m=Ba();return Th(m,Vr,c)}function Th(c,m,j){var _=c.queue;if(_===null)throw Error(i(311));_.lastRenderedReducer=j;var B=c.baseQueue,G=_.pending;if(G!==null){if(B!==null){var pe=B.next;B.next=G.next,G.next=pe}m.baseQueue=B=G,_.pending=null}if(G=c.baseState,B===null)c.memoizedState=G;else{m=B.next;var Te=pe=null,Ue=null,ft=m,It=!1;do{var Mt=ft.lane&-536870913;if(Mt!==ft.lane?(Zn&Mt)===Mt:(za&Mt)===Mt){var gt=ft.revertLane;if(gt===0)Ue!==null&&(Ue=Ue.next={lane:0,revertLane:0,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),Mt===P&&(It=!0);else if((za&gt)===gt){ft=ft.next,gt===P&&(It=!0);continue}else Mt={lane:0,revertLane:ft.revertLane,gesture:null,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},Ue===null?(Te=Ue=Mt,pe=G):Ue=Ue.next=Mt,Wr.lanes|=gt,Ph|=gt;Mt=ft.action,sl&&j(G,Mt),G=ft.hasEagerState?ft.eagerState:j(G,Mt)}else gt={lane:Mt,revertLane:ft.revertLane,gesture:ft.gesture,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},Ue===null?(Te=Ue=gt,pe=G):Ue=Ue.next=gt,Wr.lanes|=Mt,Ph|=Mt;ft=ft.next}while(ft!==null&&ft!==m);if(Ue===null?pe=G:Ue.next=Te,!I(G,c.memoizedState)&&(Js=!0,It&&(j=q,j!==null)))throw j;c.memoizedState=G,c.baseState=pe,c.baseQueue=Ue,_.lastRenderedState=G}return B===null&&(_.lanes=0),[c.memoizedState,_.dispatch]}function Lm(c){var m=Ba(),j=m.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=c;var _=j.dispatch,B=j.pending,G=m.memoizedState;if(B!==null){j.pending=null;var pe=B=B.next;do G=c(G,pe.action),pe=pe.next;while(pe!==B);I(G,m.memoizedState)||(Js=!0),m.memoizedState=G,m.baseQueue===null&&(m.baseState=G),j.lastRenderedState=G}return[G,_]}function zm(c,m,j){var _=Wr,B=Ba(),G=Ln;if(G){if(j===void 0)throw Error(i(407));j=j()}else j=m();var pe=!I((Vr||B).memoizedState,j);if(pe&&(B.memoizedState=j,Js=!0),B=B.queue,uj(C0.bind(null,_,B,c),[c]),B.getSnapshot!==m||pe||li!==null&&li.memoizedState.tag&1){if(_.flags|=2048,_u(9,{destroy:void 0},S0.bind(null,_,B,j,m),null),ra===null)throw Error(i(349));G||(za&127)!==0||pd(_,m,j)}return j}function pd(c,m,j){c.flags|=16384,c={getSnapshot:m,value:j},m=Wr.updateQueue,m===null?(m=Sf(),Wr.updateQueue=m,m.stores=[c]):(j=m.stores,j===null?m.stores=[c]:j.push(c))}function S0(c,m,j,_){m.value=j,m.getSnapshot=_,Qy(m)&&N0(c)}function C0(c,m,j){return j(function(){Qy(m)&&N0(c)})}function Qy(c){var m=c.getSnapshot;c=c.value;try{var j=m();return!I(c,j)}catch{return!0}}function N0(c){var m=yl(c,2);m!==null&&ic(m,c,2)}function Gd(c){var m=Xs();if(typeof c=="function"){var j=c;if(c=j(),sl){sr(!0);try{j()}finally{sr(!1)}}}return m.memoizedState=m.baseState=c,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hc,lastRenderedState:c},m}function Yy(c,m,j,_){return c.baseState=j,Th(c,Vr,typeof _=="function"?_:Hc)}function Zy(c,m,j,_,B){if(tx(c))throw Error(i(485));if(c=m.action,c!==null){var G={payload:B,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(pe){G.listeners.push(pe)}};K.T!==null?j(!0):G.isTransition=!1,_(G),j=m.pending,j===null?(G.next=m.pending=G,Xy(m,G)):(G.next=j.next,m.pending=j.next=G)}}function Xy(c,m){var j=m.action,_=m.payload,B=c.state;if(m.isTransition){var G=K.T,pe={};K.T=pe;try{var Te=j(B,_),Ue=K.S;Ue!==null&&Ue(pe,Te),A0(c,m,Te)}catch(ft){Eu(c,m,ft)}finally{G!==null&&pe.types!==null&&(G.types=pe.types),K.T=G}}else try{G=j(B,_),A0(c,m,G)}catch(ft){Eu(c,m,ft)}}function A0(c,m,j){j!==null&&typeof j=="object"&&typeof j.then=="function"?j.then(function(_){Jy(c,m,_)},function(_){return Eu(c,m,_)}):Jy(c,m,j)}function Jy(c,m,j){m.status="fulfilled",m.value=j,Bm(m),c.state=j,m=c.pending,m!==null&&(j=m.next,j===m?c.pending=null:(j=j.next,m.next=j,Xy(c,j)))}function Eu(c,m,j){var _=c.pending;if(c.pending=null,_!==null){_=_.next;do m.status="rejected",m.reason=j,Bm(m),m=m.next;while(m!==_)}c.action=null}function Bm(c){c=c.listeners;for(var m=0;m<c.length;m++)(0,c[m])()}function Cf(c,m){return m}function Vc(c,m){if(Ln){var j=ra.formState;if(j!==null){e:{var _=Wr;if(Ln){if(ai){t:{for(var B=ai,G=ha;B.nodeType!==8;){if(!G){B=null;break t}if(B=$c(B.nextSibling),B===null){B=null;break t}}G=B.data,B=G==="F!"||G==="F"?B:null}if(B){ai=$c(B.nextSibling),_=B.data==="F!";break e}}Wc(_)}_=!1}_&&(m=j[0])}}return j=Xs(),j.memoizedState=j.baseState=m,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cf,lastRenderedState:m},j.queue=_,j=x3.bind(null,Wr,_),_.dispatch=j,_=Gd(!1),G=gj.bind(null,Wr,!1,_.queue),_=Xs(),B={state:m,dispatch:null,action:c,pending:null},_.queue=B,j=Zy.bind(null,Wr,B,G,j),B.dispatch=j,_.memoizedState=c,[m,j,!1]}function gd(c){var m=Ba();return yd(m,Vr,c)}function yd(c,m,j){if(m=Th(c,m,Cf)[0],c=Mm(Hc)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var _=$d(m)}catch(pe){throw pe===Ge?ze:pe}else _=m;m=Ba();var B=m.queue,G=B.dispatch;return j!==m.memoizedState&&(Wr.flags|=2048,_u(9,{destroy:void 0},Fm.bind(null,B,j),null)),[_,G,c]}function Fm(c,m){c.action=m}function qm(c){var m=Ba(),j=Vr;if(j!==null)return yd(m,j,c);Ba(),m=m.memoizedState,j=Ba();var _=j.queue.dispatch;return j.memoizedState=c,[m,_,!1]}function _u(c,m,j,_){return c={tag:c,create:j,deps:_,inst:m,next:null},m=Wr.updateQueue,m===null&&(m=Sf(),Wr.updateQueue=m),j=m.lastEffect,j===null?m.lastEffect=c.next=c:(_=j.next,j.next=c,c.next=_,m.lastEffect=c),c}function ex(){return Ba().memoizedState}function Ih(c,m,j,_){var B=Xs();Wr.flags|=c,B.memoizedState=_u(1|m,{destroy:void 0},j,_===void 0?null:_)}function Oh(c,m,j,_){var B=Ba();_=_===void 0?null:_;var G=B.memoizedState.inst;Vr!==null&&_!==null&&v0(_,Vr.memoizedState.deps)?B.memoizedState=_u(m,G,j,_):(Wr.flags|=c,B.memoizedState=_u(1|m,G,j,_))}function i3(c,m){Ih(8390656,8,c,m)}function uj(c,m){Oh(2048,8,c,m)}function fH(c){Wr.flags|=4;var m=Wr.updateQueue;if(m===null)m=Sf(),Wr.updateQueue=m,m.events=[c];else{var j=m.events;j===null?m.events=[c]:j.push(c)}}function a3(c){var m=Ba().memoizedState;return fH({ref:m,nextImpl:c}),function(){if((Ni&2)!==0)throw Error(i(440));return m.impl.apply(void 0,arguments)}}function s3(c,m){return Oh(4,2,c,m)}function o3(c,m){return Oh(4,4,c,m)}function l3(c,m){if(typeof m=="function"){c=c();var j=m(c);return function(){typeof j=="function"?j():m(null)}}if(m!=null)return c=c(),m.current=c,function(){m.current=null}}function c3(c,m,j){j=j!=null?j.concat([c]):null,Oh(4,4,l3.bind(null,m,c),j)}function hj(){}function d3(c,m){var j=Ba();m=m===void 0?null:m;var _=j.memoizedState;return m!==null&&v0(m,_[1])?_[0]:(j.memoizedState=[c,m],c)}function u3(c,m){var j=Ba();m=m===void 0?null:m;var _=j.memoizedState;if(m!==null&&v0(m,_[1]))return _[0];if(_=c(),sl){sr(!0);try{c()}finally{sr(!1)}}return j.memoizedState=[_,m],_}function fj(c,m,j){return j===void 0||(za&1073741824)!==0&&(Zn&261930)===0?c.memoizedState=m:(c.memoizedState=j,c=h4(),Wr.lanes|=c,Ph|=c,j)}function h3(c,m,j,_){return I(j,m)?j:Dn.current!==null?(c=fj(c,j,_),I(c,m)||(Js=!0),c):(za&42)===0||(za&1073741824)!==0&&(Zn&261930)===0?(Js=!0,c.memoizedState=j):(c=h4(),Wr.lanes|=c,Ph|=c,m)}function f3(c,m,j,_,B){var G=ue.p;ue.p=G!==0&&8>G?G:8;var pe=K.T,Te={};K.T=Te,gj(c,!1,m,j);try{var Ue=B(),ft=K.S;if(ft!==null&&ft(Te,Ue),Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"){var It=Ce(Ue,_);E0(c,m,It,Cc(c))}else E0(c,m,_,Cc(c))}catch(Mt){E0(c,m,{then:function(){},status:"rejected",reason:Mt},Cc())}finally{ue.p=G,pe!==null&&Te.types!==null&&(pe.types=Te.types),K.T=pe}}function mH(){}function mj(c,m,j,_){if(c.tag!==5)throw Error(i(476));var B=m3(c).queue;f3(c,B,m,ce,j===null?mH:function(){return p3(c),j(_)})}function m3(c){var m=c.memoizedState;if(m!==null)return m;m={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hc,lastRenderedState:ce},next:null};var j={};return m.next={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hc,lastRenderedState:j},next:null},c.memoizedState=m,c=c.alternate,c!==null&&(c.memoizedState=m),m}function p3(c){var m=m3(c);m.next===null&&(m=c.alternate.memoizedState),E0(c,m.next.queue,{},Cc())}function pj(){return ho(H0)}function g3(){return Ba().memoizedState}function y3(){return Ba().memoizedState}function pH(c){for(var m=c.return;m!==null;){switch(m.tag){case 24:case 3:var j=Cc();c=en(j);var _=Nn(m,c,j);_!==null&&(ic(_,m,j),Si(_,m,j)),m={cache:Eh()},c.payload=m;return}m=m.return}}function gH(c,m,j){var _=Cc();j={lane:_,revertLane:0,gesture:null,action:j,hasEagerState:!1,eagerState:null,next:null},tx(c)?v3(m,j):(j=Sh(c,m,j,_),j!==null&&(ic(j,c,_),b3(j,m,_)))}function x3(c,m,j){var _=Cc();E0(c,m,j,_)}function E0(c,m,j,_){var B={lane:_,revertLane:0,gesture:null,action:j,hasEagerState:!1,eagerState:null,next:null};if(tx(c))v3(m,B);else{var G=c.alternate;if(c.lanes===0&&(G===null||G.lanes===0)&&(G=m.lastRenderedReducer,G!==null))try{var pe=m.lastRenderedState,Te=G(pe,j);if(B.hasEagerState=!0,B.eagerState=Te,I(Te,pe))return vc(c,m,B,0),ra===null&&Rd(),!1}catch{}if(j=Sh(c,m,B,_),j!==null)return ic(j,c,_),b3(j,m,_),!0}return!1}function gj(c,m,j,_){if(_={lane:2,revertLane:Kj(),gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},tx(c)){if(m)throw Error(i(479))}else m=Sh(c,j,_,2),m!==null&&ic(m,c,2)}function tx(c){var m=c.alternate;return c===Wr||m!==null&&m===Wr}function v3(c,m){Jl=vl=!0;var j=c.pending;j===null?m.next=m:(m.next=j.next,j.next=m),c.pending=m}function b3(c,m,j){if((j&4194048)!==0){var _=m.lanes;_&=c.pendingLanes,j|=_,m.lanes=j,ga(c,j)}}var _0={readContext:ho,use:_h,useCallback:Wi,useContext:Wi,useEffect:Wi,useImperativeHandle:Wi,useLayoutEffect:Wi,useInsertionEffect:Wi,useMemo:Wi,useReducer:Wi,useRef:Wi,useState:Wi,useDebugValue:Wi,useDeferredValue:Wi,useTransition:Wi,useSyncExternalStore:Wi,useId:Wi,useHostTransitionStatus:Wi,useFormState:Wi,useActionState:Wi,useOptimistic:Wi,useMemoCache:Wi,useCacheRefresh:Wi};_0.useEffectEvent=Wi;var j3={readContext:ho,use:_h,useCallback:function(c,m){return Xs().memoizedState=[c,m===void 0?null:m],c},useContext:ho,useEffect:i3,useImperativeHandle:function(c,m,j){j=j!=null?j.concat([c]):null,Ih(4194308,4,l3.bind(null,m,c),j)},useLayoutEffect:function(c,m){return Ih(4194308,4,c,m)},useInsertionEffect:function(c,m){Ih(4,2,c,m)},useMemo:function(c,m){var j=Xs();m=m===void 0?null:m;var _=c();if(sl){sr(!0);try{c()}finally{sr(!1)}}return j.memoizedState=[_,m],_},useReducer:function(c,m,j){var _=Xs();if(j!==void 0){var B=j(m);if(sl){sr(!0);try{j(m)}finally{sr(!1)}}}else B=m;return _.memoizedState=_.baseState=B,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:B},_.queue=c,c=c.dispatch=gH.bind(null,Wr,c),[_.memoizedState,c]},useRef:function(c){var m=Xs();return c={current:c},m.memoizedState=c},useState:function(c){c=Gd(c);var m=c.queue,j=x3.bind(null,Wr,m);return m.dispatch=j,[c.memoizedState,j]},useDebugValue:hj,useDeferredValue:function(c,m){var j=Xs();return fj(j,c,m)},useTransition:function(){var c=Gd(!1);return c=f3.bind(null,Wr,c.queue,!0,!1),Xs().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,m,j){var _=Wr,B=Xs();if(Ln){if(j===void 0)throw Error(i(407));j=j()}else{if(j=m(),ra===null)throw Error(i(349));(Zn&127)!==0||pd(_,m,j)}B.memoizedState=j;var G={value:j,getSnapshot:m};return B.queue=G,i3(C0.bind(null,_,G,c),[c]),_.flags|=2048,_u(9,{destroy:void 0},S0.bind(null,_,G,j,m),null),j},useId:function(){var c=Xs(),m=ra.identifierPrefix;if(Ln){var j=Kt,_=kt;j=(_&~(1<<32-ur(_)-1)).toString(32)+j,m="_"+m+"R_"+j,j=js++,0<j&&(m+="H"+j.toString(32)),m+="_"}else j=Dm++,m="_"+m+"r_"+j.toString(32)+"_";return c.memoizedState=m},useHostTransitionStatus:pj,useFormState:Vc,useActionState:Vc,useOptimistic:function(c){var m=Xs();m.memoizedState=m.baseState=c;var j={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=j,m=gj.bind(null,Wr,!0,j),j.dispatch=m,[c,m]},useMemoCache:Au,useCacheRefresh:function(){return Xs().memoizedState=pH.bind(null,Wr)},useEffectEvent:function(c){var m=Xs(),j={impl:c};return m.memoizedState=j,function(){if((Ni&2)!==0)throw Error(i(440));return j.impl.apply(void 0,arguments)}}},yj={readContext:ho,use:_h,useCallback:d3,useContext:ho,useEffect:uj,useImperativeHandle:c3,useInsertionEffect:s3,useLayoutEffect:o3,useMemo:u3,useReducer:Mm,useRef:ex,useState:function(){return Mm(Hc)},useDebugValue:hj,useDeferredValue:function(c,m){var j=Ba();return h3(j,Vr.memoizedState,c,m)},useTransition:function(){var c=Mm(Hc)[0],m=Ba().memoizedState;return[typeof c=="boolean"?c:$d(c),m]},useSyncExternalStore:zm,useId:g3,useHostTransitionStatus:pj,useFormState:gd,useActionState:gd,useOptimistic:function(c,m){var j=Ba();return Yy(j,Vr,c,m)},useMemoCache:Au,useCacheRefresh:y3};yj.useEffectEvent=a3;var w3={readContext:ho,use:_h,useCallback:d3,useContext:ho,useEffect:uj,useImperativeHandle:c3,useInsertionEffect:s3,useLayoutEffect:o3,useMemo:u3,useReducer:Lm,useRef:ex,useState:function(){return Lm(Hc)},useDebugValue:hj,useDeferredValue:function(c,m){var j=Ba();return Vr===null?fj(j,c,m):h3(j,Vr.memoizedState,c,m)},useTransition:function(){var c=Lm(Hc)[0],m=Ba().memoizedState;return[typeof c=="boolean"?c:$d(c),m]},useSyncExternalStore:zm,useId:g3,useHostTransitionStatus:pj,useFormState:qm,useActionState:qm,useOptimistic:function(c,m){var j=Ba();return Vr!==null?Yy(j,Vr,c,m):(j.baseState=c,[c,j.queue.dispatch])},useMemoCache:Au,useCacheRefresh:y3};w3.useEffectEvent=a3;function xj(c,m,j,_){m=c.memoizedState,j=j(_,m),j=j==null?m:p({},m,j),c.memoizedState=j,c.lanes===0&&(c.updateQueue.baseState=j)}var vj={enqueueSetState:function(c,m,j){c=c._reactInternals;var _=Cc(),B=en(_);B.payload=m,j!=null&&(B.callback=j),m=Nn(c,B,_),m!==null&&(ic(m,c,_),Si(m,c,_))},enqueueReplaceState:function(c,m,j){c=c._reactInternals;var _=Cc(),B=en(_);B.tag=1,B.payload=m,j!=null&&(B.callback=j),m=Nn(c,B,_),m!==null&&(ic(m,c,_),Si(m,c,_))},enqueueForceUpdate:function(c,m){c=c._reactInternals;var j=Cc(),_=en(j);_.tag=2,m!=null&&(_.callback=m),m=Nn(c,_,j),m!==null&&(ic(m,c,j),Si(m,c,j))}};function S3(c,m,j,_,B,G,pe){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(_,G,pe):m.prototype&&m.prototype.isPureReactComponent?!R(j,_)||!R(B,G):!0}function C3(c,m,j,_){c=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(j,_),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(j,_),m.state!==c&&vj.enqueueReplaceState(m,m.state,null)}function Nf(c,m){var j=m;if("ref"in m){j={};for(var _ in m)_!=="ref"&&(j[_]=m[_])}if(c=c.defaultProps){j===m&&(j=p({},j));for(var B in c)j[B]===void 0&&(j[B]=c[B])}return j}function N3(c){Pd(c)}function A3(c){console.error(c)}function E3(c){Pd(c)}function rx(c,m){try{var j=c.onUncaughtError;j(m.value,{componentStack:m.stack})}catch(_){setTimeout(function(){throw _})}}function _3(c,m,j){try{var _=c.onCaughtError;_(j.value,{componentStack:j.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(B){setTimeout(function(){throw B})}}function bj(c,m,j){return j=en(j),j.tag=3,j.payload={element:null},j.callback=function(){rx(c,m)},j}function T3(c){return c=en(c),c.tag=3,c}function I3(c,m,j,_){var B=j.type.getDerivedStateFromError;if(typeof B=="function"){var G=_.value;c.payload=function(){return B(G)},c.callback=function(){_3(m,j,_)}}var pe=j.stateNode;pe!==null&&typeof pe.componentDidCatch=="function"&&(c.callback=function(){_3(m,j,_),typeof B!="function"&&(Rh===null?Rh=new Set([this]):Rh.add(this));var Te=_.stack;this.componentDidCatch(_.value,{componentStack:Te!==null?Te:""})})}function yH(c,m,j,_,B){if(j.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(m=j.alternate,m!==null&&Ud(m,j,B,!0),j=Sa.current,j!==null){switch(j.tag){case 31:case 13:return oi===null?mx():j.alternate===null&&ws===0&&(ws=3),j.flags&=-257,j.flags|=65536,j.lanes=B,_===Ye?j.flags|=16384:(m=j.updateQueue,m===null?j.updateQueue=new Set([_]):m.add(_),Vj(c,_,B)),!1;case 22:return j.flags|=65536,_===Ye?j.flags|=16384:(m=j.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([_])},j.updateQueue=m):(j=m.retryQueue,j===null?m.retryQueue=new Set([_]):j.add(_)),Vj(c,_,B)),!1}throw Error(i(435,j.tag))}return Vj(c,_,B),mx(),!1}if(Ln)return m=Sa.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=B,_!==xl&&(c=Error(i(422),{cause:_}),Bd(E(c,j)))):(_!==xl&&(m=Error(i(423),{cause:_}),Bd(E(m,j))),c=c.current.alternate,c.flags|=65536,B&=-B,c.lanes|=B,_=E(_,j),B=bj(c.stateNode,_,B),Fs(c,B),ws!==4&&(ws=2)),!1;var G=Error(i(520),{cause:_});if(G=E(G,j),M0===null?M0=[G]:M0.push(G),ws!==4&&(ws=2),m===null)return!0;_=E(_,j),j=m;do{switch(j.tag){case 3:return j.flags|=65536,c=B&-B,j.lanes|=c,c=bj(j.stateNode,_,c),Fs(j,c),!1;case 1:if(m=j.type,G=j.stateNode,(j.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(Rh===null||!Rh.has(G))))return j.flags|=65536,B&=-B,j.lanes|=B,B=T3(B),I3(B,c,j,_),Fs(j,B),!1}j=j.return}while(j!==null);return!1}var jj=Error(i(461)),Js=!1;function ol(c,m,j,_){m.child=c===null?bn(m,null,j,_):ta(m,c.child,j,_)}function O3(c,m,j,_,B){j=j.render;var G=m.ref;if("ref"in _){var pe={};for(var Te in _)Te!=="ref"&&(pe[Te]=_[Te])}else pe=_;return Wd(m),_=b0(c,m,j,pe,G,B),Te=j0(),c!==null&&!Js?(w0(c,m,B),Tu(c,m,B)):(Ln&&Te&&Bs(m),m.flags|=1,ol(c,m,_,B),m.child)}function k3(c,m,j,_,B){if(c===null){var G=j.type;return typeof G=="function"&&!Su(G)&&G.defaultProps===void 0&&j.compare===null?(m.tag=15,m.type=G,D3(c,m,G,_,B)):(c=hd(j.type,null,_,m,m.mode,B),c.ref=m.ref,c.return=m,m.child=c)}if(G=c.child,!Tj(c,B)){var pe=G.memoizedProps;if(j=j.compare,j=j!==null?j:R,j(pe,_)&&c.ref===m.ref)return Tu(c,m,B)}return m.flags|=1,c=il(G,_),c.ref=m.ref,c.return=m,m.child=c}function D3(c,m,j,_,B){if(c!==null){var G=c.memoizedProps;if(R(G,_)&&c.ref===m.ref)if(Js=!1,m.pendingProps=_=G,Tj(c,B))(c.flags&131072)!==0&&(Js=!0);else return m.lanes=c.lanes,Tu(c,m,B)}return wj(c,m,j,_,B)}function P3(c,m,j,_){var B=_.children,G=c!==null?c.memoizedState:null;if(c===null&&m.stateNode===null&&(m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),_.mode==="hidden"){if((m.flags&128)!==0){if(G=G!==null?G.baseLanes|j:j,c!==null){for(_=m.child=c.child,B=0;_!==null;)B=B|_.lanes|_.childLanes,_=_.sibling;_=B&~G}else _=0,m.child=null;return R3(c,m,G,j,_)}if((j&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},c!==null&&De(m,G!==null?G.cachePool:null),G!==null?wa(m,G):ui(),vs(m);else return _=m.lanes=536870912,R3(c,m,G!==null?G.baseLanes|j:j,j,_)}else G!==null?(De(m,G.cachePool),wa(m,G),bs(),m.memoizedState=null):(c!==null&&De(m,null),ui(),bs());return ol(c,m,B,j),m.child}function T0(c,m){return c!==null&&c.tag===22||m.stateNode!==null||(m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.sibling}function R3(c,m,j,_,B){var G=Ie();return G=G===null?null:{parent:as._currentValue,pool:G},m.memoizedState={baseLanes:j,cachePool:G},c!==null&&De(m,null),ui(),vs(m),c!==null&&Ud(c,m,_,!0),m.childLanes=B,null}function nx(c,m){return m=ax({mode:m.mode,children:m.children},c.mode),m.ref=c.ref,c.child=m,m.return=c,m}function M3(c,m,j){return ta(m,c.child,null,j),c=nx(m,m.pendingProps),c.flags|=2,Di(m),m.memoizedState=null,c}function xH(c,m,j){var _=m.pendingProps,B=(m.flags&128)!==0;if(m.flags&=-129,c===null){if(Ln){if(_.mode==="hidden")return c=nx(m,_),m.lanes=536870912,T0(null,c);if(Ci(m),(c=ai)?(c=K4(c,ha),c=c!==null&&c.data==="&"?c:null,c!==null&&(m.memoizedState={dehydrated:c,treeContext:mt!==null?{id:kt,overflow:Kt}:null,retryLane:536870912,hydrationErrors:null},j=Cu(c),j.return=m,m.child=j,ii=m,ai=null)):c=null,c===null)throw Wc(m);return m.lanes=536870912,null}return nx(m,_)}var G=c.memoizedState;if(G!==null){var pe=G.dehydrated;if(Ci(m),B)if(m.flags&256)m.flags&=-257,m=M3(c,m,j);else if(m.memoizedState!==null)m.child=c.child,m.flags|=128,m=null;else throw Error(i(558));else if(Js||Ud(c,m,j,!1),B=(j&c.childLanes)!==0,Js||B){if(_=ra,_!==null&&(pe=Ds(_,j),pe!==0&&pe!==G.retryLane))throw G.retryLane=pe,yl(c,pe),ic(_,c,pe),jj;mx(),m=M3(c,m,j)}else c=G.treeContext,ai=$c(pe.nextSibling),ii=m,Ln=!0,uo=null,ha=!1,c!==null&&al(m,c),m=nx(m,_),m.flags|=4096;return m}return c=il(c.child,{mode:_.mode,children:_.children}),c.ref=m.ref,m.child=c,c.return=m,c}function ix(c,m){var j=m.ref;if(j===null)c!==null&&c.ref!==null&&(m.flags|=4194816);else{if(typeof j!="function"&&typeof j!="object")throw Error(i(284));(c===null||c.ref!==j)&&(m.flags|=4194816)}}function wj(c,m,j,_,B){return Wd(m),j=b0(c,m,j,_,void 0,B),_=j0(),c!==null&&!Js?(w0(c,m,B),Tu(c,m,B)):(Ln&&_&&Bs(m),m.flags|=1,ol(c,m,j,B),m.child)}function L3(c,m,j,_,B,G){return Wd(m),m.updateQueue=null,j=md(m,_,j,B),Pm(c),_=j0(),c!==null&&!Js?(w0(c,m,G),Tu(c,m,G)):(Ln&&_&&Bs(m),m.flags|=1,ol(c,m,j,G),m.child)}function z3(c,m,j,_,B){if(Wd(m),m.stateNode===null){var G=gs,pe=j.contextType;typeof pe=="object"&&pe!==null&&(G=ho(pe)),G=new j(_,G),m.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,G.updater=vj,m.stateNode=G,G._reactInternals=m,G=m.stateNode,G.props=_,G.state=m.memoizedState,G.refs={},Jt(m),pe=j.contextType,G.context=typeof pe=="object"&&pe!==null?ho(pe):gs,G.state=m.memoizedState,pe=j.getDerivedStateFromProps,typeof pe=="function"&&(xj(m,j,pe,_),G.state=m.memoizedState),typeof j.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(pe=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),pe!==G.state&&vj.enqueueReplaceState(G,G.state,null),ys(m,_,G,B),Ui(),G.state=m.memoizedState),typeof G.componentDidMount=="function"&&(m.flags|=4194308),_=!0}else if(c===null){G=m.stateNode;var Te=m.memoizedProps,Ue=Nf(j,Te);G.props=Ue;var ft=G.context,It=j.contextType;pe=gs,typeof It=="object"&&It!==null&&(pe=ho(It));var Mt=j.getDerivedStateFromProps;It=typeof Mt=="function"||typeof G.getSnapshotBeforeUpdate=="function",Te=m.pendingProps!==Te,It||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(Te||ft!==pe)&&C3(m,G,_,pe),dr=!1;var gt=m.memoizedState;G.state=gt,ys(m,_,G,B),Ui(),ft=m.memoizedState,Te||gt!==ft||dr?(typeof Mt=="function"&&(xj(m,j,Mt,_),ft=m.memoizedState),(Ue=dr||S3(m,j,Ue,_,gt,ft,pe))?(It||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(m.flags|=4194308)):(typeof G.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=_,m.memoizedState=ft),G.props=_,G.state=ft,G.context=pe,_=Ue):(typeof G.componentDidMount=="function"&&(m.flags|=4194308),_=!1)}else{G=m.stateNode,ja(c,m),pe=m.memoizedProps,It=Nf(j,pe),G.props=It,Mt=m.pendingProps,gt=G.context,ft=j.contextType,Ue=gs,typeof ft=="object"&&ft!==null&&(Ue=ho(ft)),Te=j.getDerivedStateFromProps,(ft=typeof Te=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(pe!==Mt||gt!==Ue)&&C3(m,G,_,Ue),dr=!1,gt=m.memoizedState,G.state=gt,ys(m,_,G,B),Ui();var jt=m.memoizedState;pe!==Mt||gt!==jt||dr||c!==null&&c.dependencies!==null&&Im(c.dependencies)?(typeof Te=="function"&&(xj(m,j,Te,_),jt=m.memoizedState),(It=dr||S3(m,j,It,_,gt,jt,Ue)||c!==null&&c.dependencies!==null&&Im(c.dependencies))?(ft||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(_,jt,Ue),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(_,jt,Ue)),typeof G.componentDidUpdate=="function"&&(m.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof G.componentDidUpdate!="function"||pe===c.memoizedProps&&gt===c.memoizedState||(m.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||pe===c.memoizedProps&&gt===c.memoizedState||(m.flags|=1024),m.memoizedProps=_,m.memoizedState=jt),G.props=_,G.state=jt,G.context=Ue,_=It):(typeof G.componentDidUpdate!="function"||pe===c.memoizedProps&&gt===c.memoizedState||(m.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||pe===c.memoizedProps&&gt===c.memoizedState||(m.flags|=1024),_=!1)}return G=_,ix(c,m),_=(m.flags&128)!==0,G||_?(G=m.stateNode,j=_&&typeof j.getDerivedStateFromError!="function"?null:G.render(),m.flags|=1,c!==null&&_?(m.child=ta(m,c.child,null,B),m.child=ta(m,null,j,B)):ol(c,m,j,B),m.memoizedState=G.state,c=m.child):c=Tu(c,m,B),c}function B3(c,m,j,_){return fd(),m.flags|=256,ol(c,m,j,_),m.child}var Sj={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cj(c){return{baseLanes:c,cachePool:Be()}}function Nj(c,m,j){return c=c!==null?c.childLanes&~j:0,m&&(c|=Sc),c}function F3(c,m,j){var _=m.pendingProps,B=!1,G=(m.flags&128)!==0,pe;if((pe=G)||(pe=c!==null&&c.memoizedState===null?!1:(ti.current&2)!==0),pe&&(B=!0,m.flags&=-129),pe=(m.flags&32)!==0,m.flags&=-33,c===null){if(Ln){if(B?ss(m):bs(),(c=ai)?(c=K4(c,ha),c=c!==null&&c.data!=="&"?c:null,c!==null&&(m.memoizedState={dehydrated:c,treeContext:mt!==null?{id:kt,overflow:Kt}:null,retryLane:536870912,hydrationErrors:null},j=Cu(c),j.return=m,m.child=j,ii=m,ai=null)):c=null,c===null)throw Wc(m);return o5(c)?m.lanes=32:m.lanes=536870912,null}var Te=_.children;return _=_.fallback,B?(bs(),B=m.mode,Te=ax({mode:"hidden",children:Te},B),_=Uc(_,B,j,null),Te.return=m,_.return=m,Te.sibling=_,m.child=Te,_=m.child,_.memoizedState=Cj(j),_.childLanes=Nj(c,pe,j),m.memoizedState=Sj,T0(null,_)):(ss(m),Aj(m,Te))}var Ue=c.memoizedState;if(Ue!==null&&(Te=Ue.dehydrated,Te!==null)){if(G)m.flags&256?(ss(m),m.flags&=-257,m=Ej(c,m,j)):m.memoizedState!==null?(bs(),m.child=c.child,m.flags|=128,m=null):(bs(),Te=_.fallback,B=m.mode,_=ax({mode:"visible",children:_.children},B),Te=Uc(Te,B,j,null),Te.flags|=2,_.return=m,Te.return=m,_.sibling=Te,m.child=_,ta(m,c.child,null,j),_=m.child,_.memoizedState=Cj(j),_.childLanes=Nj(c,pe,j),m.memoizedState=Sj,m=T0(null,_));else if(ss(m),o5(Te)){if(pe=Te.nextSibling&&Te.nextSibling.dataset,pe)var ft=pe.dgst;pe=ft,_=Error(i(419)),_.stack="",_.digest=pe,Bd({value:_,source:null,stack:null}),m=Ej(c,m,j)}else if(Js||Ud(c,m,j,!1),pe=(j&c.childLanes)!==0,Js||pe){if(pe=ra,pe!==null&&(_=Ds(pe,j),_!==0&&_!==Ue.retryLane))throw Ue.retryLane=_,yl(c,_),ic(pe,c,_),jj;s5(Te)||mx(),m=Ej(c,m,j)}else s5(Te)?(m.flags|=192,m.child=c.child,m=null):(c=Ue.treeContext,ai=$c(Te.nextSibling),ii=m,Ln=!0,uo=null,ha=!1,c!==null&&al(m,c),m=Aj(m,_.children),m.flags|=4096);return m}return B?(bs(),Te=_.fallback,B=m.mode,Ue=c.child,ft=Ue.sibling,_=il(Ue,{mode:"hidden",children:_.children}),_.subtreeFlags=Ue.subtreeFlags&65011712,ft!==null?Te=il(ft,Te):(Te=Uc(Te,B,j,null),Te.flags|=2),Te.return=m,_.return=m,_.sibling=Te,m.child=_,T0(null,_),_=m.child,Te=c.child.memoizedState,Te===null?Te=Cj(j):(B=Te.cachePool,B!==null?(Ue=as._currentValue,B=B.parent!==Ue?{parent:Ue,pool:Ue}:B):B=Be(),Te={baseLanes:Te.baseLanes|j,cachePool:B}),_.memoizedState=Te,_.childLanes=Nj(c,pe,j),m.memoizedState=Sj,T0(c.child,_)):(ss(m),j=c.child,c=j.sibling,j=il(j,{mode:"visible",children:_.children}),j.return=m,j.sibling=null,c!==null&&(pe=m.deletions,pe===null?(m.deletions=[c],m.flags|=16):pe.push(c)),m.child=j,m.memoizedState=null,j)}function Aj(c,m){return m=ax({mode:"visible",children:m},c.mode),m.return=c,c.child=m}function ax(c,m){return c=zs(22,c,null,m),c.lanes=0,c}function Ej(c,m,j){return ta(m,c.child,null,j),c=Aj(m,m.pendingProps.children),c.flags|=2,m.memoizedState=null,c}function q3(c,m,j){c.lanes|=m;var _=c.alternate;_!==null&&(_.lanes|=m),Ah(c.return,m,j)}function _j(c,m,j,_,B,G){var pe=c.memoizedState;pe===null?c.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:_,tail:j,tailMode:B,treeForkCount:G}:(pe.isBackwards=m,pe.rendering=null,pe.renderingStartTime=0,pe.last=_,pe.tail=j,pe.tailMode=B,pe.treeForkCount=G)}function U3(c,m,j){var _=m.pendingProps,B=_.revealOrder,G=_.tail;_=_.children;var pe=ti.current,Te=(pe&2)!==0;if(Te?(pe=pe&1|2,m.flags|=128):pe&=1,se(ti,pe),ol(c,m,_,j),_=Ln?Ee:0,!Te&&c!==null&&(c.flags&128)!==0)e:for(c=m.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&q3(c,j,m);else if(c.tag===19)q3(c,j,m);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===m)break e;for(;c.sibling===null;){if(c.return===null||c.return===m)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}switch(B){case"forwards":for(j=m.child,B=null;j!==null;)c=j.alternate,c!==null&&Do(c)===null&&(B=j),j=j.sibling;j=B,j===null?(B=m.child,m.child=null):(B=j.sibling,j.sibling=null),_j(m,!1,B,j,G,_);break;case"backwards":case"unstable_legacy-backwards":for(j=null,B=m.child,m.child=null;B!==null;){if(c=B.alternate,c!==null&&Do(c)===null){m.child=B;break}c=B.sibling,B.sibling=j,j=B,B=c}_j(m,!0,j,null,G,_);break;case"together":_j(m,!1,null,null,void 0,_);break;default:m.memoizedState=null}return m.child}function Tu(c,m,j){if(c!==null&&(m.dependencies=c.dependencies),Ph|=m.lanes,(j&m.childLanes)===0)if(c!==null){if(Ud(c,m,j,!1),(j&m.childLanes)===0)return null}else return null;if(c!==null&&m.child!==c.child)throw Error(i(153));if(m.child!==null){for(c=m.child,j=il(c,c.pendingProps),m.child=j,j.return=m;c.sibling!==null;)c=c.sibling,j=j.sibling=il(c,c.pendingProps),j.return=m;j.sibling=null}return m.child}function Tj(c,m){return(c.lanes&m)!==0?!0:(c=c.dependencies,!!(c!==null&&Im(c)))}function vH(c,m,j){switch(m.tag){case 3:Le(m,m.stateNode.containerInfo),qd(m,as,c.memoizedState.cache),fd();break;case 27:case 5:He(m);break;case 4:Le(m,m.stateNode.containerInfo);break;case 10:qd(m,m.type,m.memoizedProps.value);break;case 31:if(m.memoizedState!==null)return m.flags|=128,Ci(m),null;break;case 13:var _=m.memoizedState;if(_!==null)return _.dehydrated!==null?(ss(m),m.flags|=128,null):(j&m.child.childLanes)!==0?F3(c,m,j):(ss(m),c=Tu(c,m,j),c!==null?c.sibling:null);ss(m);break;case 19:var B=(c.flags&128)!==0;if(_=(j&m.childLanes)!==0,_||(Ud(c,m,j,!1),_=(j&m.childLanes)!==0),B){if(_)return U3(c,m,j);m.flags|=128}if(B=m.memoizedState,B!==null&&(B.rendering=null,B.tail=null,B.lastEffect=null),se(ti,ti.current),_)break;return null;case 22:return m.lanes=0,P3(c,m,j,m.pendingProps);case 24:qd(m,as,c.memoizedState.cache)}return Tu(c,m,j)}function W3(c,m,j){if(c!==null)if(c.memoizedProps!==m.pendingProps)Js=!0;else{if(!Tj(c,j)&&(m.flags&128)===0)return Js=!1,vH(c,m,j);Js=(c.flags&131072)!==0}else Js=!1,Ln&&(m.flags&1048576)!==0&&Cn(m,Ee,m.index);switch(m.lanes=0,m.tag){case 16:e:{var _=m.pendingProps;if(c=lt(m.elementType),m.type=c,typeof c=="function")Su(c)?(_=Nf(c,_),m.tag=1,m=z3(null,m,c,_,j)):(m.tag=0,m=wj(null,m,c,_,j));else{if(c!=null){var B=c.$$typeof;if(B===M){m.tag=11,m=O3(null,m,c,_,j);break e}else if(B===$){m.tag=14,m=k3(null,m,c,_,j);break e}}throw m=de(c)||c,Error(i(306,m,""))}}return m;case 0:return wj(c,m,m.type,m.pendingProps,j);case 1:return _=m.type,B=Nf(_,m.pendingProps),z3(c,m,_,B,j);case 3:e:{if(Le(m,m.stateNode.containerInfo),c===null)throw Error(i(387));_=m.pendingProps;var G=m.memoizedState;B=G.element,ja(c,m),ys(m,_,null,j);var pe=m.memoizedState;if(_=pe.cache,qd(m,as,_),_!==G.cache&&Nu(m,[as],j,!0),Ui(),_=pe.element,G.isDehydrated)if(G={element:_,isDehydrated:!1,cache:pe.cache},m.updateQueue.baseState=G,m.memoizedState=G,m.flags&256){m=B3(c,m,_,j);break e}else if(_!==B){B=E(Error(i(424)),m),Bd(B),m=B3(c,m,_,j);break e}else for(c=m.stateNode.containerInfo,c.nodeType===9?c=c.body:c=c.nodeName==="HTML"?c.ownerDocument.body:c,ai=$c(c.firstChild),ii=m,Ln=!0,uo=null,ha=!0,j=bn(m,null,_,j),m.child=j;j;)j.flags=j.flags&-3|4096,j=j.sibling;else{if(fd(),_===B){m=Tu(c,m,j);break e}ol(c,m,_,j)}m=m.child}return m;case 26:return ix(c,m),c===null?(j=eT(m.type,null,m.pendingProps,null))?m.memoizedState=j:Ln||(j=m.type,c=m.pendingProps,_=jx(ge.current).createElement(j),_[Yn]=m,_[vn]=c,ll(_,j,c),Oi(_),m.stateNode=_):m.memoizedState=eT(m.type,c.memoizedProps,m.pendingProps,c.memoizedState),null;case 27:return He(m),c===null&&Ln&&(_=m.stateNode=Z4(m.type,m.pendingProps,ge.current),ii=m,ha=!0,B=ai,Bh(m.type)?(l5=B,ai=$c(_.firstChild)):ai=B),ol(c,m,m.pendingProps.children,j),ix(c,m),c===null&&(m.flags|=4194304),m.child;case 5:return c===null&&Ln&&((B=_=ai)&&(_=QH(_,m.type,m.pendingProps,ha),_!==null?(m.stateNode=_,ii=m,ai=$c(_.firstChild),ha=!1,B=!0):B=!1),B||Wc(m)),He(m),B=m.type,G=m.pendingProps,pe=c!==null?c.memoizedProps:null,_=G.children,n5(B,G)?_=null:pe!==null&&n5(B,pe)&&(m.flags|=32),m.memoizedState!==null&&(B=b0(c,m,dj,null,null,j),H0._currentValue=B),ix(c,m),ol(c,m,_,j),m.child;case 6:return c===null&&Ln&&((c=j=ai)&&(j=YH(j,m.pendingProps,ha),j!==null?(m.stateNode=j,ii=m,ai=null,c=!0):c=!1),c||Wc(m)),null;case 13:return F3(c,m,j);case 4:return Le(m,m.stateNode.containerInfo),_=m.pendingProps,c===null?m.child=ta(m,null,_,j):ol(c,m,_,j),m.child;case 11:return O3(c,m,m.type,m.pendingProps,j);case 7:return ol(c,m,m.pendingProps,j),m.child;case 8:return ol(c,m,m.pendingProps.children,j),m.child;case 12:return ol(c,m,m.pendingProps.children,j),m.child;case 10:return _=m.pendingProps,qd(m,m.type,_.value),ol(c,m,_.children,j),m.child;case 9:return B=m.type._context,_=m.pendingProps.children,Wd(m),B=ho(B),_=_(B),m.flags|=1,ol(c,m,_,j),m.child;case 14:return k3(c,m,m.type,m.pendingProps,j);case 15:return D3(c,m,m.type,m.pendingProps,j);case 19:return U3(c,m,j);case 31:return xH(c,m,j);case 22:return P3(c,m,j,m.pendingProps);case 24:return Wd(m),_=ho(as),c===null?(B=Ie(),B===null&&(B=ra,G=Eh(),B.pooledCache=G,G.refCount++,G!==null&&(B.pooledCacheLanes|=j),B=G),m.memoizedState={parent:_,cache:B},Jt(m),qd(m,as,B)):((c.lanes&j)!==0&&(ja(c,m),ys(m,null,null,j),Ui()),B=c.memoizedState,G=m.memoizedState,B.parent!==_?(B={parent:_,cache:_},m.memoizedState=B,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=B),qd(m,as,_)):(_=G.cache,qd(m,as,_),_!==B.cache&&Nu(m,[as],j,!0))),ol(c,m,m.pendingProps.children,j),m.child;case 29:throw m.pendingProps}throw Error(i(156,m.tag))}function Iu(c){c.flags|=4}function Ij(c,m,j,_,B){if((m=(c.mode&32)!==0)&&(m=!1),m){if(c.flags|=16777216,(B&335544128)===B)if(c.stateNode.complete)c.flags|=8192;else if(g4())c.flags|=8192;else throw Nt=Ye,dt}else c.flags&=-16777217}function H3(c,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!aT(m))if(g4())c.flags|=8192;else throw Nt=Ye,dt}function sx(c,m){m!==null&&(c.flags|=4),c.flags&16384&&(m=c.tag!==22?vi():536870912,c.lanes|=m,Vm|=m)}function I0(c,m){if(!Ln)switch(c.tailMode){case"hidden":m=c.tail;for(var j=null;m!==null;)m.alternate!==null&&(j=m),m=m.sibling;j===null?c.tail=null:j.sibling=null;break;case"collapsed":j=c.tail;for(var _=null;j!==null;)j.alternate!==null&&(_=j),j=j.sibling;_===null?m||c.tail===null?c.tail=null:c.tail.sibling=null:_.sibling=null}}function Ca(c){var m=c.alternate!==null&&c.alternate.child===c.child,j=0,_=0;if(m)for(var B=c.child;B!==null;)j|=B.lanes|B.childLanes,_|=B.subtreeFlags&65011712,_|=B.flags&65011712,B.return=c,B=B.sibling;else for(B=c.child;B!==null;)j|=B.lanes|B.childLanes,_|=B.subtreeFlags,_|=B.flags,B.return=c,B=B.sibling;return c.subtreeFlags|=_,c.childLanes=j,m}function bH(c,m,j){var _=m.pendingProps;switch(ba(m),m.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ca(m),null;case 1:return Ca(m),null;case 3:return j=m.stateNode,_=null,c!==null&&(_=c.memoizedState.cache),m.memoizedState.cache!==_&&(m.flags|=2048),Xl(as),ke(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(c===null||c.child===null)&&(La(m)?Iu(m):c===null||c.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,bf())),Ca(m),null;case 26:var B=m.type,G=m.memoizedState;return c===null?(Iu(m),G!==null?(Ca(m),H3(m,G)):(Ca(m),Ij(m,B,null,_,j))):G?G!==c.memoizedState?(Iu(m),Ca(m),H3(m,G)):(Ca(m),m.flags&=-16777217):(c=c.memoizedProps,c!==_&&Iu(m),Ca(m),Ij(m,B,c,_,j)),null;case 27:if(Je(m),j=ge.current,B=m.type,c!==null&&m.stateNode!=null)c.memoizedProps!==_&&Iu(m);else{if(!_){if(m.stateNode===null)throw Error(i(166));return Ca(m),null}c=W.current,La(m)?Nh(m):(c=Z4(B,_,j),m.stateNode=c,Iu(m))}return Ca(m),null;case 5:if(Je(m),B=m.type,c!==null&&m.stateNode!=null)c.memoizedProps!==_&&Iu(m);else{if(!_){if(m.stateNode===null)throw Error(i(166));return Ca(m),null}if(G=W.current,La(m))Nh(m);else{var pe=jx(ge.current);switch(G){case 1:G=pe.createElementNS("http://www.w3.org/2000/svg",B);break;case 2:G=pe.createElementNS("http://www.w3.org/1998/Math/MathML",B);break;default:switch(B){case"svg":G=pe.createElementNS("http://www.w3.org/2000/svg",B);break;case"math":G=pe.createElementNS("http://www.w3.org/1998/Math/MathML",B);break;case"script":G=pe.createElement("div"),G.innerHTML="<script><\/script>",G=G.removeChild(G.firstChild);break;case"select":G=typeof _.is=="string"?pe.createElement("select",{is:_.is}):pe.createElement("select"),_.multiple?G.multiple=!0:_.size&&(G.size=_.size);break;default:G=typeof _.is=="string"?pe.createElement(B,{is:_.is}):pe.createElement(B)}}G[Yn]=m,G[vn]=_;e:for(pe=m.child;pe!==null;){if(pe.tag===5||pe.tag===6)G.appendChild(pe.stateNode);else if(pe.tag!==4&&pe.tag!==27&&pe.child!==null){pe.child.return=pe,pe=pe.child;continue}if(pe===m)break e;for(;pe.sibling===null;){if(pe.return===null||pe.return===m)break e;pe=pe.return}pe.sibling.return=pe.return,pe=pe.sibling}m.stateNode=G;e:switch(ll(G,B,_),B){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}_&&Iu(m)}}return Ca(m),Ij(m,m.type,c===null?null:c.memoizedProps,m.pendingProps,j),null;case 6:if(c&&m.stateNode!=null)c.memoizedProps!==_&&Iu(m);else{if(typeof _!="string"&&m.stateNode===null)throw Error(i(166));if(c=ge.current,La(m)){if(c=m.stateNode,j=m.memoizedProps,_=null,B=ii,B!==null)switch(B.tag){case 27:case 5:_=B.memoizedProps}c[Yn]=m,c=!!(c.nodeValue===j||_!==null&&_.suppressHydrationWarning===!0||F4(c.nodeValue,j)),c||Wc(m,!0)}else c=jx(c).createTextNode(_),c[Yn]=m,m.stateNode=c}return Ca(m),null;case 31:if(j=m.memoizedState,c===null||c.memoizedState!==null){if(_=La(m),j!==null){if(c===null){if(!_)throw Error(i(318));if(c=m.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(557));c[Yn]=m}else fd(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ca(m),c=!1}else j=bf(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=j),c=!0;if(!c)return m.flags&256?(Di(m),m):(Di(m),null);if((m.flags&128)!==0)throw Error(i(558))}return Ca(m),null;case 13:if(_=m.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(B=La(m),_!==null&&_.dehydrated!==null){if(c===null){if(!B)throw Error(i(318));if(B=m.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(i(317));B[Yn]=m}else fd(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ca(m),B=!1}else B=bf(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=B),B=!0;if(!B)return m.flags&256?(Di(m),m):(Di(m),null)}return Di(m),(m.flags&128)!==0?(m.lanes=j,m):(j=_!==null,c=c!==null&&c.memoizedState!==null,j&&(_=m.child,B=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(B=_.alternate.memoizedState.cachePool.pool),G=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(G=_.memoizedState.cachePool.pool),G!==B&&(_.flags|=2048)),j!==c&&j&&(m.child.flags|=8192),sx(m,m.updateQueue),Ca(m),null);case 4:return ke(),c===null&&Xj(m.stateNode.containerInfo),Ca(m),null;case 10:return Xl(m.type),Ca(m),null;case 19:if(X(ti),_=m.memoizedState,_===null)return Ca(m),null;if(B=(m.flags&128)!==0,G=_.rendering,G===null)if(B)I0(_,!1);else{if(ws!==0||c!==null&&(c.flags&128)!==0)for(c=m.child;c!==null;){if(G=Do(c),G!==null){for(m.flags|=128,I0(_,!1),c=G.updateQueue,m.updateQueue=c,sx(m,c),m.subtreeFlags=0,c=j,j=m.child;j!==null;)Md(j,c),j=j.sibling;return se(ti,ti.current&1|2),Ln&&br(m,_.treeForkCount),m.child}c=c.sibling}_.tail!==null&&zr()>ux&&(m.flags|=128,B=!0,I0(_,!1),m.lanes=4194304)}else{if(!B)if(c=Do(G),c!==null){if(m.flags|=128,B=!0,c=c.updateQueue,m.updateQueue=c,sx(m,c),I0(_,!0),_.tail===null&&_.tailMode==="hidden"&&!G.alternate&&!Ln)return Ca(m),null}else 2*zr()-_.renderingStartTime>ux&&j!==536870912&&(m.flags|=128,B=!0,I0(_,!1),m.lanes=4194304);_.isBackwards?(G.sibling=m.child,m.child=G):(c=_.last,c!==null?c.sibling=G:m.child=G,_.last=G)}return _.tail!==null?(c=_.tail,_.rendering=c,_.tail=c.sibling,_.renderingStartTime=zr(),c.sibling=null,j=ti.current,se(ti,B?j&1|2:j&1),Ln&&br(m,_.treeForkCount),c):(Ca(m),null);case 22:case 23:return Di(m),qs(),_=m.memoizedState!==null,c!==null?c.memoizedState!==null!==_&&(m.flags|=8192):_&&(m.flags|=8192),_?(j&536870912)!==0&&(m.flags&128)===0&&(Ca(m),m.subtreeFlags&6&&(m.flags|=8192)):Ca(m),j=m.updateQueue,j!==null&&sx(m,j.retryQueue),j=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(j=c.memoizedState.cachePool.pool),_=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(_=m.memoizedState.cachePool.pool),_!==j&&(m.flags|=2048),c!==null&&X(_e),null;case 24:return j=null,c!==null&&(j=c.memoizedState.cache),m.memoizedState.cache!==j&&(m.flags|=2048),Xl(as),Ca(m),null;case 25:return null;case 30:return null}throw Error(i(156,m.tag))}function jH(c,m){switch(ba(m),m.tag){case 1:return c=m.flags,c&65536?(m.flags=c&-65537|128,m):null;case 3:return Xl(as),ke(),c=m.flags,(c&65536)!==0&&(c&128)===0?(m.flags=c&-65537|128,m):null;case 26:case 27:case 5:return Je(m),null;case 31:if(m.memoizedState!==null){if(Di(m),m.alternate===null)throw Error(i(340));fd()}return c=m.flags,c&65536?(m.flags=c&-65537|128,m):null;case 13:if(Di(m),c=m.memoizedState,c!==null&&c.dehydrated!==null){if(m.alternate===null)throw Error(i(340));fd()}return c=m.flags,c&65536?(m.flags=c&-65537|128,m):null;case 19:return X(ti),null;case 4:return ke(),null;case 10:return Xl(m.type),null;case 22:case 23:return Di(m),qs(),c!==null&&X(_e),c=m.flags,c&65536?(m.flags=c&-65537|128,m):null;case 24:return Xl(as),null;case 25:return null;default:return null}}function V3(c,m){switch(ba(m),m.tag){case 3:Xl(as),ke();break;case 26:case 27:case 5:Je(m);break;case 4:ke();break;case 31:m.memoizedState!==null&&Di(m);break;case 13:Di(m);break;case 19:X(ti);break;case 10:Xl(m.type);break;case 22:case 23:Di(m),qs(),c!==null&&X(_e);break;case 24:Xl(as)}}function O0(c,m){try{var j=m.updateQueue,_=j!==null?j.lastEffect:null;if(_!==null){var B=_.next;j=B;do{if((j.tag&c)===c){_=void 0;var G=j.create,pe=j.inst;_=G(),pe.destroy=_}j=j.next}while(j!==B)}}catch(Te){Ri(m,m.return,Te)}}function kh(c,m,j){try{var _=m.updateQueue,B=_!==null?_.lastEffect:null;if(B!==null){var G=B.next;_=G;do{if((_.tag&c)===c){var pe=_.inst,Te=pe.destroy;if(Te!==void 0){pe.destroy=void 0,B=m;var Ue=j,ft=Te;try{ft()}catch(It){Ri(B,Ue,It)}}}_=_.next}while(_!==G)}}catch(It){Ri(m,m.return,It)}}function $3(c){var m=c.updateQueue;if(m!==null){var j=c.stateNode;try{xs(m,j)}catch(_){Ri(c,c.return,_)}}}function G3(c,m,j){j.props=Nf(c.type,c.memoizedProps),j.state=c.memoizedState;try{j.componentWillUnmount()}catch(_){Ri(c,m,_)}}function k0(c,m){try{var j=c.ref;if(j!==null){switch(c.tag){case 26:case 27:case 5:var _=c.stateNode;break;case 30:_=c.stateNode;break;default:_=c.stateNode}typeof j=="function"?c.refCleanup=j(_):j.current=_}}catch(B){Ri(c,m,B)}}function Kd(c,m){var j=c.ref,_=c.refCleanup;if(j!==null)if(typeof _=="function")try{_()}catch(B){Ri(c,m,B)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof j=="function")try{j(null)}catch(B){Ri(c,m,B)}else j.current=null}function K3(c){var m=c.type,j=c.memoizedProps,_=c.stateNode;try{e:switch(m){case"button":case"input":case"select":case"textarea":j.autoFocus&&_.focus();break e;case"img":j.src?_.src=j.src:j.srcSet&&(_.srcset=j.srcSet)}}catch(B){Ri(c,c.return,B)}}function Oj(c,m,j){try{var _=c.stateNode;WH(_,c.type,j,m),_[vn]=m}catch(B){Ri(c,c.return,B)}}function Q3(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&Bh(c.type)||c.tag===4}function kj(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||Q3(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&Bh(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Dj(c,m,j){var _=c.tag;if(_===5||_===6)c=c.stateNode,m?(j.nodeType===9?j.body:j.nodeName==="HTML"?j.ownerDocument.body:j).insertBefore(c,m):(m=j.nodeType===9?j.body:j.nodeName==="HTML"?j.ownerDocument.body:j,m.appendChild(c),j=j._reactRootContainer,j!=null||m.onclick!==null||(m.onclick=Za));else if(_!==4&&(_===27&&Bh(c.type)&&(j=c.stateNode,m=null),c=c.child,c!==null))for(Dj(c,m,j),c=c.sibling;c!==null;)Dj(c,m,j),c=c.sibling}function ox(c,m,j){var _=c.tag;if(_===5||_===6)c=c.stateNode,m?j.insertBefore(c,m):j.appendChild(c);else if(_!==4&&(_===27&&Bh(c.type)&&(j=c.stateNode),c=c.child,c!==null))for(ox(c,m,j),c=c.sibling;c!==null;)ox(c,m,j),c=c.sibling}function Y3(c){var m=c.stateNode,j=c.memoizedProps;try{for(var _=c.type,B=m.attributes;B.length;)m.removeAttributeNode(B[0]);ll(m,_,j),m[Yn]=c,m[vn]=j}catch(G){Ri(c,c.return,G)}}var Ou=!1,eo=!1,Pj=!1,Z3=typeof WeakSet=="function"?WeakSet:Set,Po=null;function wH(c,m){if(c=c.containerInfo,t5=_x,c=ve(c),Ne(c)){if("selectionStart"in c)var j={start:c.selectionStart,end:c.selectionEnd};else e:{j=(j=c.ownerDocument)&&j.defaultView||window;var _=j.getSelection&&j.getSelection();if(_&&_.rangeCount!==0){j=_.anchorNode;var B=_.anchorOffset,G=_.focusNode;_=_.focusOffset;try{j.nodeType,G.nodeType}catch{j=null;break e}var pe=0,Te=-1,Ue=-1,ft=0,It=0,Mt=c,gt=null;t:for(;;){for(var jt;Mt!==j||B!==0&&Mt.nodeType!==3||(Te=pe+B),Mt!==G||_!==0&&Mt.nodeType!==3||(Ue=pe+_),Mt.nodeType===3&&(pe+=Mt.nodeValue.length),(jt=Mt.firstChild)!==null;)gt=Mt,Mt=jt;for(;;){if(Mt===c)break t;if(gt===j&&++ft===B&&(Te=pe),gt===G&&++It===_&&(Ue=pe),(jt=Mt.nextSibling)!==null)break;Mt=gt,gt=Mt.parentNode}Mt=jt}j=Te===-1||Ue===-1?null:{start:Te,end:Ue}}else j=null}j=j||{start:0,end:0}}else j=null;for(r5={focusedElem:c,selectionRange:j},_x=!1,Po=m;Po!==null;)if(m=Po,c=m.child,(m.subtreeFlags&1028)!==0&&c!==null)c.return=m,Po=c;else for(;Po!==null;){switch(m=Po,G=m.alternate,c=m.flags,m.tag){case 0:if((c&4)!==0&&(c=m.updateQueue,c=c!==null?c.events:null,c!==null))for(j=0;j<c.length;j++)B=c[j],B.ref.impl=B.nextImpl;break;case 11:case 15:break;case 1:if((c&1024)!==0&&G!==null){c=void 0,j=m,B=G.memoizedProps,G=G.memoizedState,_=j.stateNode;try{var jr=Nf(j.type,B);c=_.getSnapshotBeforeUpdate(jr,G),_.__reactInternalSnapshotBeforeUpdate=c}catch(nn){Ri(j,j.return,nn)}}break;case 3:if((c&1024)!==0){if(c=m.stateNode.containerInfo,j=c.nodeType,j===9)a5(c);else if(j===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":a5(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(i(163))}if(c=m.sibling,c!==null){c.return=m.return,Po=c;break}Po=m.return}}function X3(c,m,j){var _=j.flags;switch(j.tag){case 0:case 11:case 15:Du(c,j),_&4&&O0(5,j);break;case 1:if(Du(c,j),_&4)if(c=j.stateNode,m===null)try{c.componentDidMount()}catch(pe){Ri(j,j.return,pe)}else{var B=Nf(j.type,m.memoizedProps);m=m.memoizedState;try{c.componentDidUpdate(B,m,c.__reactInternalSnapshotBeforeUpdate)}catch(pe){Ri(j,j.return,pe)}}_&64&&$3(j),_&512&&k0(j,j.return);break;case 3:if(Du(c,j),_&64&&(c=j.updateQueue,c!==null)){if(m=null,j.child!==null)switch(j.child.tag){case 27:case 5:m=j.child.stateNode;break;case 1:m=j.child.stateNode}try{xs(c,m)}catch(pe){Ri(j,j.return,pe)}}break;case 27:m===null&&_&4&&Y3(j);case 26:case 5:Du(c,j),m===null&&_&4&&K3(j),_&512&&k0(j,j.return);break;case 12:Du(c,j);break;case 31:Du(c,j),_&4&&t4(c,j);break;case 13:Du(c,j),_&4&&r4(c,j),_&64&&(c=j.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(j=OH.bind(null,j),ZH(c,j))));break;case 22:if(_=j.memoizedState!==null||Ou,!_){m=m!==null&&m.memoizedState!==null||eo,B=Ou;var G=eo;Ou=_,(eo=m)&&!G?Pu(c,j,(j.subtreeFlags&8772)!==0):Du(c,j),Ou=B,eo=G}break;case 30:break;default:Du(c,j)}}function J3(c){var m=c.alternate;m!==null&&(c.alternate=null,J3(m)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(m=c.stateNode,m!==null&&Ga(m)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var Fa=null,ec=!1;function ku(c,m,j){for(j=j.child;j!==null;)e4(c,m,j),j=j.sibling}function e4(c,m,j){if(wt&&typeof wt.onCommitFiberUnmount=="function")try{wt.onCommitFiberUnmount(Er,j)}catch{}switch(j.tag){case 26:eo||Kd(j,m),ku(c,m,j),j.memoizedState?j.memoizedState.count--:j.stateNode&&(j=j.stateNode,j.parentNode.removeChild(j));break;case 27:eo||Kd(j,m);var _=Fa,B=ec;Bh(j.type)&&(Fa=j.stateNode,ec=!1),ku(c,m,j),q0(j.stateNode),Fa=_,ec=B;break;case 5:eo||Kd(j,m);case 6:if(_=Fa,B=ec,Fa=null,ku(c,m,j),Fa=_,ec=B,Fa!==null)if(ec)try{(Fa.nodeType===9?Fa.body:Fa.nodeName==="HTML"?Fa.ownerDocument.body:Fa).removeChild(j.stateNode)}catch(G){Ri(j,m,G)}else try{Fa.removeChild(j.stateNode)}catch(G){Ri(j,m,G)}break;case 18:Fa!==null&&(ec?(c=Fa,$4(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,j.stateNode),Jm(c)):$4(Fa,j.stateNode));break;case 4:_=Fa,B=ec,Fa=j.stateNode.containerInfo,ec=!0,ku(c,m,j),Fa=_,ec=B;break;case 0:case 11:case 14:case 15:kh(2,j,m),eo||kh(4,j,m),ku(c,m,j);break;case 1:eo||(Kd(j,m),_=j.stateNode,typeof _.componentWillUnmount=="function"&&G3(j,m,_)),ku(c,m,j);break;case 21:ku(c,m,j);break;case 22:eo=(_=eo)||j.memoizedState!==null,ku(c,m,j),eo=_;break;default:ku(c,m,j)}}function t4(c,m){if(m.memoizedState===null&&(c=m.alternate,c!==null&&(c=c.memoizedState,c!==null))){c=c.dehydrated;try{Jm(c)}catch(j){Ri(m,m.return,j)}}}function r4(c,m){if(m.memoizedState===null&&(c=m.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{Jm(c)}catch(j){Ri(m,m.return,j)}}function SH(c){switch(c.tag){case 31:case 13:case 19:var m=c.stateNode;return m===null&&(m=c.stateNode=new Z3),m;case 22:return c=c.stateNode,m=c._retryCache,m===null&&(m=c._retryCache=new Z3),m;default:throw Error(i(435,c.tag))}}function lx(c,m){var j=SH(c);m.forEach(function(_){if(!j.has(_)){j.add(_);var B=kH.bind(null,c,_);_.then(B,B)}})}function tc(c,m){var j=m.deletions;if(j!==null)for(var _=0;_<j.length;_++){var B=j[_],G=c,pe=m,Te=pe;e:for(;Te!==null;){switch(Te.tag){case 27:if(Bh(Te.type)){Fa=Te.stateNode,ec=!1;break e}break;case 5:Fa=Te.stateNode,ec=!1;break e;case 3:case 4:Fa=Te.stateNode.containerInfo,ec=!0;break e}Te=Te.return}if(Fa===null)throw Error(i(160));e4(G,pe,B),Fa=null,ec=!1,G=B.alternate,G!==null&&(G.return=null),B.return=null}if(m.subtreeFlags&13886)for(m=m.child;m!==null;)n4(m,c),m=m.sibling}var xd=null;function n4(c,m){var j=c.alternate,_=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:tc(m,c),rc(c),_&4&&(kh(3,c,c.return),O0(3,c),kh(5,c,c.return));break;case 1:tc(m,c),rc(c),_&512&&(eo||j===null||Kd(j,j.return)),_&64&&Ou&&(c=c.updateQueue,c!==null&&(_=c.callbacks,_!==null&&(j=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=j===null?_:j.concat(_))));break;case 26:var B=xd;if(tc(m,c),rc(c),_&512&&(eo||j===null||Kd(j,j.return)),_&4){var G=j!==null?j.memoizedState:null;if(_=c.memoizedState,j===null)if(_===null)if(c.stateNode===null){e:{_=c.type,j=c.memoizedProps,B=B.ownerDocument||B;t:switch(_){case"title":G=B.getElementsByTagName("title")[0],(!G||G[Go]||G[Yn]||G.namespaceURI==="http://www.w3.org/2000/svg"||G.hasAttribute("itemprop"))&&(G=B.createElement(_),B.head.insertBefore(G,B.querySelector("head > title"))),ll(G,_,j),G[Yn]=c,Oi(G),_=G;break e;case"link":var pe=nT("link","href",B).get(_+(j.href||""));if(pe){for(var Te=0;Te<pe.length;Te++)if(G=pe[Te],G.getAttribute("href")===(j.href==null||j.href===""?null:j.href)&&G.getAttribute("rel")===(j.rel==null?null:j.rel)&&G.getAttribute("title")===(j.title==null?null:j.title)&&G.getAttribute("crossorigin")===(j.crossOrigin==null?null:j.crossOrigin)){pe.splice(Te,1);break t}}G=B.createElement(_),ll(G,_,j),B.head.appendChild(G);break;case"meta":if(pe=nT("meta","content",B).get(_+(j.content||""))){for(Te=0;Te<pe.length;Te++)if(G=pe[Te],G.getAttribute("content")===(j.content==null?null:""+j.content)&&G.getAttribute("name")===(j.name==null?null:j.name)&&G.getAttribute("property")===(j.property==null?null:j.property)&&G.getAttribute("http-equiv")===(j.httpEquiv==null?null:j.httpEquiv)&&G.getAttribute("charset")===(j.charSet==null?null:j.charSet)){pe.splice(Te,1);break t}}G=B.createElement(_),ll(G,_,j),B.head.appendChild(G);break;default:throw Error(i(468,_))}G[Yn]=c,Oi(G),_=G}c.stateNode=_}else iT(B,c.type,c.stateNode);else c.stateNode=rT(B,_,c.memoizedProps);else G!==_?(G===null?j.stateNode!==null&&(j=j.stateNode,j.parentNode.removeChild(j)):G.count--,_===null?iT(B,c.type,c.stateNode):rT(B,_,c.memoizedProps)):_===null&&c.stateNode!==null&&Oj(c,c.memoizedProps,j.memoizedProps)}break;case 27:tc(m,c),rc(c),_&512&&(eo||j===null||Kd(j,j.return)),j!==null&&_&4&&Oj(c,c.memoizedProps,j.memoizedProps);break;case 5:if(tc(m,c),rc(c),_&512&&(eo||j===null||Kd(j,j.return)),c.flags&32){B=c.stateNode;try{Ps(B,"")}catch(jr){Ri(c,c.return,jr)}}_&4&&c.stateNode!=null&&(B=c.memoizedProps,Oj(c,B,j!==null?j.memoizedProps:B)),_&1024&&(Pj=!0);break;case 6:if(tc(m,c),rc(c),_&4){if(c.stateNode===null)throw Error(i(162));_=c.memoizedProps,j=c.stateNode;try{j.nodeValue=_}catch(jr){Ri(c,c.return,jr)}}break;case 3:if(Cx=null,B=xd,xd=wx(m.containerInfo),tc(m,c),xd=B,rc(c),_&4&&j!==null&&j.memoizedState.isDehydrated)try{Jm(m.containerInfo)}catch(jr){Ri(c,c.return,jr)}Pj&&(Pj=!1,i4(c));break;case 4:_=xd,xd=wx(c.stateNode.containerInfo),tc(m,c),rc(c),xd=_;break;case 12:tc(m,c),rc(c);break;case 31:tc(m,c),rc(c),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,lx(c,_)));break;case 13:tc(m,c),rc(c),c.child.flags&8192&&c.memoizedState!==null!=(j!==null&&j.memoizedState!==null)&&(dx=zr()),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,lx(c,_)));break;case 22:B=c.memoizedState!==null;var Ue=j!==null&&j.memoizedState!==null,ft=Ou,It=eo;if(Ou=ft||B,eo=It||Ue,tc(m,c),eo=It,Ou=ft,rc(c),_&8192)e:for(m=c.stateNode,m._visibility=B?m._visibility&-2:m._visibility|1,B&&(j===null||Ue||Ou||eo||Af(c)),j=null,m=c;;){if(m.tag===5||m.tag===26){if(j===null){Ue=j=m;try{if(G=Ue.stateNode,B)pe=G.style,typeof pe.setProperty=="function"?pe.setProperty("display","none","important"):pe.display="none";else{Te=Ue.stateNode;var Mt=Ue.memoizedProps.style,gt=Mt!=null&&Mt.hasOwnProperty("display")?Mt.display:null;Te.style.display=gt==null||typeof gt=="boolean"?"":(""+gt).trim()}}catch(jr){Ri(Ue,Ue.return,jr)}}}else if(m.tag===6){if(j===null){Ue=m;try{Ue.stateNode.nodeValue=B?"":Ue.memoizedProps}catch(jr){Ri(Ue,Ue.return,jr)}}}else if(m.tag===18){if(j===null){Ue=m;try{var jt=Ue.stateNode;B?G4(jt,!0):G4(Ue.stateNode,!1)}catch(jr){Ri(Ue,Ue.return,jr)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===c)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break e;for(;m.sibling===null;){if(m.return===null||m.return===c)break e;j===m&&(j=null),m=m.return}j===m&&(j=null),m.sibling.return=m.return,m=m.sibling}_&4&&(_=c.updateQueue,_!==null&&(j=_.retryQueue,j!==null&&(_.retryQueue=null,lx(c,j))));break;case 19:tc(m,c),rc(c),_&4&&(_=c.updateQueue,_!==null&&(c.updateQueue=null,lx(c,_)));break;case 30:break;case 21:break;default:tc(m,c),rc(c)}}function rc(c){var m=c.flags;if(m&2){try{for(var j,_=c.return;_!==null;){if(Q3(_)){j=_;break}_=_.return}if(j==null)throw Error(i(160));switch(j.tag){case 27:var B=j.stateNode,G=kj(c);ox(c,G,B);break;case 5:var pe=j.stateNode;j.flags&32&&(Ps(pe,""),j.flags&=-33);var Te=kj(c);ox(c,Te,pe);break;case 3:case 4:var Ue=j.stateNode.containerInfo,ft=kj(c);Dj(c,ft,Ue);break;default:throw Error(i(161))}}catch(It){Ri(c,c.return,It)}c.flags&=-3}m&4096&&(c.flags&=-4097)}function i4(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var m=c;i4(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),c=c.sibling}}function Du(c,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)X3(c,m.alternate,m),m=m.sibling}function Af(c){for(c=c.child;c!==null;){var m=c;switch(m.tag){case 0:case 11:case 14:case 15:kh(4,m,m.return),Af(m);break;case 1:Kd(m,m.return);var j=m.stateNode;typeof j.componentWillUnmount=="function"&&G3(m,m.return,j),Af(m);break;case 27:q0(m.stateNode);case 26:case 5:Kd(m,m.return),Af(m);break;case 22:m.memoizedState===null&&Af(m);break;case 30:Af(m);break;default:Af(m)}c=c.sibling}}function Pu(c,m,j){for(j=j&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var _=m.alternate,B=c,G=m,pe=G.flags;switch(G.tag){case 0:case 11:case 15:Pu(B,G,j),O0(4,G);break;case 1:if(Pu(B,G,j),_=G,B=_.stateNode,typeof B.componentDidMount=="function")try{B.componentDidMount()}catch(ft){Ri(_,_.return,ft)}if(_=G,B=_.updateQueue,B!==null){var Te=_.stateNode;try{var Ue=B.shared.hiddenCallbacks;if(Ue!==null)for(B.shared.hiddenCallbacks=null,B=0;B<Ue.length;B++)ko(Ue[B],Te)}catch(ft){Ri(_,_.return,ft)}}j&&pe&64&&$3(G),k0(G,G.return);break;case 27:Y3(G);case 26:case 5:Pu(B,G,j),j&&_===null&&pe&4&&K3(G),k0(G,G.return);break;case 12:Pu(B,G,j);break;case 31:Pu(B,G,j),j&&pe&4&&t4(B,G);break;case 13:Pu(B,G,j),j&&pe&4&&r4(B,G);break;case 22:G.memoizedState===null&&Pu(B,G,j),k0(G,G.return);break;case 30:break;default:Pu(B,G,j)}m=m.sibling}}function Rj(c,m){var j=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(j=c.memoizedState.cachePool.pool),c=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(c=m.memoizedState.cachePool.pool),c!==j&&(c!=null&&c.refCount++,j!=null&&jf(j))}function Mj(c,m){c=null,m.alternate!==null&&(c=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==c&&(m.refCount++,c!=null&&jf(c))}function vd(c,m,j,_){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)a4(c,m,j,_),m=m.sibling}function a4(c,m,j,_){var B=m.flags;switch(m.tag){case 0:case 11:case 15:vd(c,m,j,_),B&2048&&O0(9,m);break;case 1:vd(c,m,j,_);break;case 3:vd(c,m,j,_),B&2048&&(c=null,m.alternate!==null&&(c=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==c&&(m.refCount++,c!=null&&jf(c)));break;case 12:if(B&2048){vd(c,m,j,_),c=m.stateNode;try{var G=m.memoizedProps,pe=G.id,Te=G.onPostCommit;typeof Te=="function"&&Te(pe,m.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(Ue){Ri(m,m.return,Ue)}}else vd(c,m,j,_);break;case 31:vd(c,m,j,_);break;case 13:vd(c,m,j,_);break;case 23:break;case 22:G=m.stateNode,pe=m.alternate,m.memoizedState!==null?G._visibility&2?vd(c,m,j,_):D0(c,m):G._visibility&2?vd(c,m,j,_):(G._visibility|=2,Um(c,m,j,_,(m.subtreeFlags&10256)!==0||!1)),B&2048&&Rj(pe,m);break;case 24:vd(c,m,j,_),B&2048&&Mj(m.alternate,m);break;default:vd(c,m,j,_)}}function Um(c,m,j,_,B){for(B=B&&((m.subtreeFlags&10256)!==0||!1),m=m.child;m!==null;){var G=c,pe=m,Te=j,Ue=_,ft=pe.flags;switch(pe.tag){case 0:case 11:case 15:Um(G,pe,Te,Ue,B),O0(8,pe);break;case 23:break;case 22:var It=pe.stateNode;pe.memoizedState!==null?It._visibility&2?Um(G,pe,Te,Ue,B):D0(G,pe):(It._visibility|=2,Um(G,pe,Te,Ue,B)),B&&ft&2048&&Rj(pe.alternate,pe);break;case 24:Um(G,pe,Te,Ue,B),B&&ft&2048&&Mj(pe.alternate,pe);break;default:Um(G,pe,Te,Ue,B)}m=m.sibling}}function D0(c,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var j=c,_=m,B=_.flags;switch(_.tag){case 22:D0(j,_),B&2048&&Rj(_.alternate,_);break;case 24:D0(j,_),B&2048&&Mj(_.alternate,_);break;default:D0(j,_)}m=m.sibling}}var P0=8192;function Wm(c,m,j){if(c.subtreeFlags&P0)for(c=c.child;c!==null;)s4(c,m,j),c=c.sibling}function s4(c,m,j){switch(c.tag){case 26:Wm(c,m,j),c.flags&P0&&c.memoizedState!==null&&cV(j,xd,c.memoizedState,c.memoizedProps);break;case 5:Wm(c,m,j);break;case 3:case 4:var _=xd;xd=wx(c.stateNode.containerInfo),Wm(c,m,j),xd=_;break;case 22:c.memoizedState===null&&(_=c.alternate,_!==null&&_.memoizedState!==null?(_=P0,P0=16777216,Wm(c,m,j),P0=_):Wm(c,m,j));break;default:Wm(c,m,j)}}function o4(c){var m=c.alternate;if(m!==null&&(c=m.child,c!==null)){m.child=null;do m=c.sibling,c.sibling=null,c=m;while(c!==null)}}function R0(c){var m=c.deletions;if((c.flags&16)!==0){if(m!==null)for(var j=0;j<m.length;j++){var _=m[j];Po=_,c4(_,c)}o4(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)l4(c),c=c.sibling}function l4(c){switch(c.tag){case 0:case 11:case 15:R0(c),c.flags&2048&&kh(9,c,c.return);break;case 3:R0(c);break;case 12:R0(c);break;case 22:var m=c.stateNode;c.memoizedState!==null&&m._visibility&2&&(c.return===null||c.return.tag!==13)?(m._visibility&=-3,cx(c)):R0(c);break;default:R0(c)}}function cx(c){var m=c.deletions;if((c.flags&16)!==0){if(m!==null)for(var j=0;j<m.length;j++){var _=m[j];Po=_,c4(_,c)}o4(c)}for(c=c.child;c!==null;){switch(m=c,m.tag){case 0:case 11:case 15:kh(8,m,m.return),cx(m);break;case 22:j=m.stateNode,j._visibility&2&&(j._visibility&=-3,cx(m));break;default:cx(m)}c=c.sibling}}function c4(c,m){for(;Po!==null;){var j=Po;switch(j.tag){case 0:case 11:case 15:kh(8,j,m);break;case 23:case 22:if(j.memoizedState!==null&&j.memoizedState.cachePool!==null){var _=j.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:jf(j.memoizedState.cache)}if(_=j.child,_!==null)_.return=j,Po=_;else e:for(j=c;Po!==null;){_=Po;var B=_.sibling,G=_.return;if(J3(_),_===j){Po=null;break e}if(B!==null){B.return=G,Po=B;break e}Po=G}}}var CH={getCacheForType:function(c){var m=ho(as),j=m.data.get(c);return j===void 0&&(j=c(),m.data.set(c,j)),j},cacheSignal:function(){return ho(as).controller.signal}},NH=typeof WeakMap=="function"?WeakMap:Map,Ni=0,ra=null,Hn=null,Zn=0,Pi=0,wc=null,Dh=!1,Hm=!1,Lj=!1,Ru=0,ws=0,Ph=0,Ef=0,zj=0,Sc=0,Vm=0,M0=null,nc=null,Bj=!1,dx=0,d4=0,ux=1/0,hx=null,Rh=null,mo=0,Mh=null,$m=null,Mu=0,Fj=0,qj=null,u4=null,L0=0,Uj=null;function Cc(){return(Ni&2)!==0&&Zn!==0?Zn&-Zn:K.T!==null?Kj():Qn()}function h4(){if(Sc===0)if((Zn&536870912)===0||Ln){var c=Sr;Sr<<=1,(Sr&3932160)===0&&(Sr=262144),Sc=c}else Sc=536870912;return c=Sa.current,c!==null&&(c.flags|=32),Sc}function ic(c,m,j){(c===ra&&(Pi===2||Pi===9)||c.cancelPendingCommit!==null)&&(Gm(c,0),Lh(c,Zn,Sc,!1)),vr(c,j),((Ni&2)===0||c!==ra)&&(c===ra&&((Ni&2)===0&&(Ef|=j),ws===4&&Lh(c,Zn,Sc,!1)),Qd(c))}function f4(c,m,j){if((Ni&6)!==0)throw Error(i(327));var _=!j&&(m&127)===0&&(m&c.expiredLanes)===0||Zi(c,m),B=_?_H(c,m):Hj(c,m,!0),G=_;do{if(B===0){Hm&&!_&&Lh(c,m,0,!1);break}else{if(j=c.current.alternate,G&&!AH(j)){B=Hj(c,m,!1),G=!1;continue}if(B===2){if(G=m,c.errorRecoveryDisabledLanes&G)var pe=0;else pe=c.pendingLanes&-536870913,pe=pe!==0?pe:pe&536870912?536870912:0;if(pe!==0){m=pe;e:{var Te=c;B=M0;var Ue=Te.current.memoizedState.isDehydrated;if(Ue&&(Gm(Te,pe).flags|=256),pe=Hj(Te,pe,!1),pe!==2){if(Lj&&!Ue){Te.errorRecoveryDisabledLanes|=G,Ef|=G,B=4;break e}G=nc,nc=B,G!==null&&(nc===null?nc=G:nc.push.apply(nc,G))}B=pe}if(G=!1,B!==2)continue}}if(B===1){Gm(c,0),Lh(c,m,0,!0);break}e:{switch(_=c,G=B,G){case 0:case 1:throw Error(i(345));case 4:if((m&4194048)!==m)break;case 6:Lh(_,m,Sc,!Dh);break e;case 2:nc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((m&62914560)===m&&(B=dx+300-zr(),10<B)){if(Lh(_,m,Sc,!Dh),On(_,0,!0)!==0)break e;Mu=m,_.timeoutHandle=H4(m4.bind(null,_,j,nc,hx,Bj,m,Sc,Ef,Vm,Dh,G,"Throttled",-0,0),B);break e}m4(_,j,nc,hx,Bj,m,Sc,Ef,Vm,Dh,G,null,-0,0)}}break}while(!0);Qd(c)}function m4(c,m,j,_,B,G,pe,Te,Ue,ft,It,Mt,gt,jt){if(c.timeoutHandle=-1,Mt=m.subtreeFlags,Mt&8192||(Mt&16785408)===16785408){Mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Za},s4(m,G,Mt);var jr=(G&62914560)===G?dx-zr():(G&4194048)===G?d4-zr():0;if(jr=dV(Mt,jr),jr!==null){Mu=G,c.cancelPendingCommit=jr(w4.bind(null,c,m,G,j,_,B,pe,Te,Ue,It,Mt,null,gt,jt)),Lh(c,G,pe,!ft);return}}w4(c,m,G,j,_,B,pe,Te,Ue)}function AH(c){for(var m=c;;){var j=m.tag;if((j===0||j===11||j===15)&&m.flags&16384&&(j=m.updateQueue,j!==null&&(j=j.stores,j!==null)))for(var _=0;_<j.length;_++){var B=j[_],G=B.getSnapshot;B=B.value;try{if(!I(G(),B))return!1}catch{return!1}}if(j=m.child,m.subtreeFlags&16384&&j!==null)j.return=m,m=j;else{if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Lh(c,m,j,_){m&=~zj,m&=~Ef,c.suspendedLanes|=m,c.pingedLanes&=~m,_&&(c.warmLanes|=m),_=c.expirationTimes;for(var B=m;0<B;){var G=31-ur(B),pe=1<<G;_[G]=-1,B&=~pe}j!==0&&ml(c,j,m)}function fx(){return(Ni&6)===0?(z0(0),!1):!0}function Wj(){if(Hn!==null){if(Pi===0)var c=Hn.return;else c=Hn,Zl=jc=null,Rm(c),zt=null,Nr=0,c=Hn;for(;c!==null;)V3(c.alternate,c),c=c.return;Hn=null}}function Gm(c,m){var j=c.timeoutHandle;j!==-1&&(c.timeoutHandle=-1,$H(j)),j=c.cancelPendingCommit,j!==null&&(c.cancelPendingCommit=null,j()),Mu=0,Wj(),ra=c,Hn=j=il(c.current,null),Zn=m,Pi=0,wc=null,Dh=!1,Hm=Zi(c,m),Lj=!1,Vm=Sc=zj=Ef=Ph=ws=0,nc=M0=null,Bj=!1,(m&8)!==0&&(m|=m&32);var _=c.entangledLanes;if(_!==0)for(c=c.entanglements,_&=m;0<_;){var B=31-ur(_),G=1<<B;m|=c[B],_&=~G}return Ru=m,Rd(),j}function p4(c,m){Wr=null,K.H=_0,m===Ge||m===ze?(m=Ot(),Pi=3):m===dt?(m=Ot(),Pi=4):Pi=m===jj?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,wc=m,Hn===null&&(ws=1,rx(c,E(m,c.current)))}function g4(){var c=Sa.current;return c===null?!0:(Zn&4194048)===Zn?oi===null:(Zn&62914560)===Zn||(Zn&536870912)!==0?c===oi:!1}function y4(){var c=K.H;return K.H=_0,c===null?_0:c}function x4(){var c=K.A;return K.A=CH,c}function mx(){ws=4,Dh||(Zn&4194048)!==Zn&&Sa.current!==null||(Hm=!0),(Ph&134217727)===0&&(Ef&134217727)===0||ra===null||Lh(ra,Zn,Sc,!1)}function Hj(c,m,j){var _=Ni;Ni|=2;var B=y4(),G=x4();(ra!==c||Zn!==m)&&(hx=null,Gm(c,m)),m=!1;var pe=ws;e:do try{if(Pi!==0&&Hn!==null){var Te=Hn,Ue=wc;switch(Pi){case 8:Wj(),pe=6;break e;case 3:case 2:case 9:case 6:Sa.current===null&&(m=!0);var ft=Pi;if(Pi=0,wc=null,Km(c,Te,Ue,ft),j&&Hm){pe=0;break e}break;default:ft=Pi,Pi=0,wc=null,Km(c,Te,Ue,ft)}}EH(),pe=ws;break}catch(It){p4(c,It)}while(!0);return m&&c.shellSuspendCounter++,Zl=jc=null,Ni=_,K.H=B,K.A=G,Hn===null&&(ra=null,Zn=0,Rd()),pe}function EH(){for(;Hn!==null;)v4(Hn)}function _H(c,m){var j=Ni;Ni|=2;var _=y4(),B=x4();ra!==c||Zn!==m?(hx=null,ux=zr()+500,Gm(c,m)):Hm=Zi(c,m);e:do try{if(Pi!==0&&Hn!==null){m=Hn;var G=wc;t:switch(Pi){case 1:Pi=0,wc=null,Km(c,m,G,1);break;case 2:case 9:if(at(G)){Pi=0,wc=null,b4(m);break}m=function(){Pi!==2&&Pi!==9||ra!==c||(Pi=7),Qd(c)},G.then(m,m);break e;case 3:Pi=7;break e;case 4:Pi=5;break e;case 7:at(G)?(Pi=0,wc=null,b4(m)):(Pi=0,wc=null,Km(c,m,G,7));break;case 5:var pe=null;switch(Hn.tag){case 26:pe=Hn.memoizedState;case 5:case 27:var Te=Hn;if(pe?aT(pe):Te.stateNode.complete){Pi=0,wc=null;var Ue=Te.sibling;if(Ue!==null)Hn=Ue;else{var ft=Te.return;ft!==null?(Hn=ft,px(ft)):Hn=null}break t}}Pi=0,wc=null,Km(c,m,G,5);break;case 6:Pi=0,wc=null,Km(c,m,G,6);break;case 8:Wj(),ws=6;break e;default:throw Error(i(462))}}TH();break}catch(It){p4(c,It)}while(!0);return Zl=jc=null,K.H=_,K.A=B,Ni=j,Hn!==null?0:(ra=null,Zn=0,Rd(),ws)}function TH(){for(;Hn!==null&&!xr();)v4(Hn)}function v4(c){var m=W3(c.alternate,c,Ru);c.memoizedProps=c.pendingProps,m===null?px(c):Hn=m}function b4(c){var m=c,j=m.alternate;switch(m.tag){case 15:case 0:m=L3(j,m,m.pendingProps,m.type,void 0,Zn);break;case 11:m=L3(j,m,m.pendingProps,m.type.render,m.ref,Zn);break;case 5:Rm(m);default:V3(j,m),m=Hn=Md(m,Ru),m=W3(j,m,Ru)}c.memoizedProps=c.pendingProps,m===null?px(c):Hn=m}function Km(c,m,j,_){Zl=jc=null,Rm(m),zt=null,Nr=0;var B=m.return;try{if(yH(c,B,m,j,Zn)){ws=1,rx(c,E(j,c.current)),Hn=null;return}}catch(G){if(B!==null)throw Hn=B,G;ws=1,rx(c,E(j,c.current)),Hn=null;return}m.flags&32768?(Ln||_===1?c=!0:Hm||(Zn&536870912)!==0?c=!1:(Dh=c=!0,(_===2||_===9||_===3||_===6)&&(_=Sa.current,_!==null&&_.tag===13&&(_.flags|=16384))),j4(m,c)):px(m)}function px(c){var m=c;do{if((m.flags&32768)!==0){j4(m,Dh);return}c=m.return;var j=bH(m.alternate,m,Ru);if(j!==null){Hn=j;return}if(m=m.sibling,m!==null){Hn=m;return}Hn=m=c}while(m!==null);ws===0&&(ws=5)}function j4(c,m){do{var j=jH(c.alternate,c);if(j!==null){j.flags&=32767,Hn=j;return}if(j=c.return,j!==null&&(j.flags|=32768,j.subtreeFlags=0,j.deletions=null),!m&&(c=c.sibling,c!==null)){Hn=c;return}Hn=c=j}while(c!==null);ws=6,Hn=null}function w4(c,m,j,_,B,G,pe,Te,Ue){c.cancelPendingCommit=null;do gx();while(mo!==0);if((Ni&6)!==0)throw Error(i(327));if(m!==null){if(m===c.current)throw Error(i(177));if(G=m.lanes|m.childLanes,G|=wu,Oa(c,j,G,pe,Te,Ue),c===ra&&(Hn=ra=null,Zn=0),$m=m,Mh=c,Mu=j,Fj=G,qj=B,u4=_,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,DH(Yr,function(){return E4(),null})):(c.callbackNode=null,c.callbackPriority=0),_=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||_){_=K.T,K.T=null,B=ue.p,ue.p=2,pe=Ni,Ni|=4;try{wH(c,m,j)}finally{Ni=pe,ue.p=B,K.T=_}}mo=1,S4(),C4(),N4()}}function S4(){if(mo===1){mo=0;var c=Mh,m=$m,j=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||j){j=K.T,K.T=null;var _=ue.p;ue.p=2;var B=Ni;Ni|=4;try{n4(m,c);var G=r5,pe=ve(c.containerInfo),Te=G.focusedElem,Ue=G.selectionRange;if(pe!==Te&&Te&&Te.ownerDocument&&he(Te.ownerDocument.documentElement,Te)){if(Ue!==null&&Ne(Te)){var ft=Ue.start,It=Ue.end;if(It===void 0&&(It=ft),"selectionStart"in Te)Te.selectionStart=ft,Te.selectionEnd=Math.min(It,Te.value.length);else{var Mt=Te.ownerDocument||document,gt=Mt&&Mt.defaultView||window;if(gt.getSelection){var jt=gt.getSelection(),jr=Te.textContent.length,nn=Math.min(Ue.start,jr),Vi=Ue.end===void 0?nn:Math.min(Ue.end,jr);!jt.extend&&nn>Vi&&(pe=Vi,Vi=nn,nn=pe);var rt=ne(Te,nn),Ke=ne(Te,Vi);if(rt&&Ke&&(jt.rangeCount!==1||jt.anchorNode!==rt.node||jt.anchorOffset!==rt.offset||jt.focusNode!==Ke.node||jt.focusOffset!==Ke.offset)){var ht=Mt.createRange();ht.setStart(rt.node,rt.offset),jt.removeAllRanges(),nn>Vi?(jt.addRange(ht),jt.extend(Ke.node,Ke.offset)):(ht.setEnd(Ke.node,Ke.offset),jt.addRange(ht))}}}}for(Mt=[],jt=Te;jt=jt.parentNode;)jt.nodeType===1&&Mt.push({element:jt,left:jt.scrollLeft,top:jt.scrollTop});for(typeof Te.focus=="function"&&Te.focus(),Te=0;Te<Mt.length;Te++){var Dt=Mt[Te];Dt.element.scrollLeft=Dt.left,Dt.element.scrollTop=Dt.top}}_x=!!t5,r5=t5=null}finally{Ni=B,ue.p=_,K.T=j}}c.current=m,mo=2}}function C4(){if(mo===2){mo=0;var c=Mh,m=$m,j=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||j){j=K.T,K.T=null;var _=ue.p;ue.p=2;var B=Ni;Ni|=4;try{X3(c,m.alternate,m)}finally{Ni=B,ue.p=_,K.T=j}}mo=3}}function N4(){if(mo===4||mo===3){mo=0,hr();var c=Mh,m=$m,j=Mu,_=u4;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?mo=5:(mo=0,$m=Mh=null,A4(c,c.pendingLanes));var B=c.pendingLanes;if(B===0&&(Rh=null),$t(j),m=m.stateNode,wt&&typeof wt.onCommitFiberRoot=="function")try{wt.onCommitFiberRoot(Er,m,void 0,(m.current.flags&128)===128)}catch{}if(_!==null){m=K.T,B=ue.p,ue.p=2,K.T=null;try{for(var G=c.onRecoverableError,pe=0;pe<_.length;pe++){var Te=_[pe];G(Te.value,{componentStack:Te.stack})}}finally{K.T=m,ue.p=B}}(Mu&3)!==0&&gx(),Qd(c),B=c.pendingLanes,(j&261930)!==0&&(B&42)!==0?c===Uj?L0++:(L0=0,Uj=c):L0=0,z0(0)}}function A4(c,m){(c.pooledCacheLanes&=m)===0&&(m=c.pooledCache,m!=null&&(c.pooledCache=null,jf(m)))}function gx(){return S4(),C4(),N4(),E4()}function E4(){if(mo!==5)return!1;var c=Mh,m=Fj;Fj=0;var j=$t(Mu),_=K.T,B=ue.p;try{ue.p=32>j?32:j,K.T=null,j=qj,qj=null;var G=Mh,pe=Mu;if(mo=0,$m=Mh=null,Mu=0,(Ni&6)!==0)throw Error(i(331));var Te=Ni;if(Ni|=4,l4(G.current),a4(G,G.current,pe,j),Ni=Te,z0(0,!1),wt&&typeof wt.onPostCommitFiberRoot=="function")try{wt.onPostCommitFiberRoot(Er,G)}catch{}return!0}finally{ue.p=B,K.T=_,A4(c,m)}}function _4(c,m,j){m=E(j,m),m=bj(c.stateNode,m,2),c=Nn(c,m,2),c!==null&&(vr(c,2),Qd(c))}function Ri(c,m,j){if(c.tag===3)_4(c,c,j);else for(;m!==null;){if(m.tag===3){_4(m,c,j);break}else if(m.tag===1){var _=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Rh===null||!Rh.has(_))){c=E(j,c),j=T3(2),_=Nn(m,j,2),_!==null&&(I3(j,_,m,c),vr(_,2),Qd(_));break}}m=m.return}}function Vj(c,m,j){var _=c.pingCache;if(_===null){_=c.pingCache=new NH;var B=new Set;_.set(m,B)}else B=_.get(m),B===void 0&&(B=new Set,_.set(m,B));B.has(j)||(Lj=!0,B.add(j),c=IH.bind(null,c,m,j),m.then(c,c))}function IH(c,m,j){var _=c.pingCache;_!==null&&_.delete(m),c.pingedLanes|=c.suspendedLanes&j,c.warmLanes&=~j,ra===c&&(Zn&j)===j&&(ws===4||ws===3&&(Zn&62914560)===Zn&&300>zr()-dx?(Ni&2)===0&&Gm(c,0):zj|=j,Vm===Zn&&(Vm=0)),Qd(c)}function T4(c,m){m===0&&(m=vi()),c=yl(c,m),c!==null&&(vr(c,m),Qd(c))}function OH(c){var m=c.memoizedState,j=0;m!==null&&(j=m.retryLane),T4(c,j)}function kH(c,m){var j=0;switch(c.tag){case 31:case 13:var _=c.stateNode,B=c.memoizedState;B!==null&&(j=B.retryLane);break;case 19:_=c.stateNode;break;case 22:_=c.stateNode._retryCache;break;default:throw Error(i(314))}_!==null&&_.delete(m),T4(c,j)}function DH(c,m){return rr(c,m)}var yx=null,Qm=null,$j=!1,xx=!1,Gj=!1,zh=0;function Qd(c){c!==Qm&&c.next===null&&(Qm===null?yx=Qm=c:Qm=Qm.next=c),xx=!0,$j||($j=!0,RH())}function z0(c,m){if(!Gj&&xx){Gj=!0;do for(var j=!1,_=yx;_!==null;){if(c!==0){var B=_.pendingLanes;if(B===0)var G=0;else{var pe=_.suspendedLanes,Te=_.pingedLanes;G=(1<<31-ur(42|c)+1)-1,G&=B&~(pe&~Te),G=G&201326741?G&201326741|1:G?G|2:0}G!==0&&(j=!0,D4(_,G))}else G=Zn,G=On(_,_===ra?G:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(G&3)===0||Zi(_,G)||(j=!0,D4(_,G));_=_.next}while(j);Gj=!1}}function PH(){I4()}function I4(){xx=$j=!1;var c=0;zh!==0&&VH()&&(c=zh);for(var m=zr(),j=null,_=yx;_!==null;){var B=_.next,G=O4(_,m);G===0?(_.next=null,j===null?yx=B:j.next=B,B===null&&(Qm=j)):(j=_,(c!==0||(G&3)!==0)&&(xx=!0)),_=B}mo!==0&&mo!==5||z0(c),zh!==0&&(zh=0)}function O4(c,m){for(var j=c.suspendedLanes,_=c.pingedLanes,B=c.expirationTimes,G=c.pendingLanes&-62914561;0<G;){var pe=31-ur(G),Te=1<<pe,Ue=B[pe];Ue===-1?((Te&j)===0||(Te&_)!==0)&&(B[pe]=Ia(Te,m)):Ue<=m&&(c.expiredLanes|=Te),G&=~Te}if(m=ra,j=Zn,j=On(c,c===m?j:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),_=c.callbackNode,j===0||c===m&&(Pi===2||Pi===9)||c.cancelPendingCommit!==null)return _!==null&&_!==null&&St(_),c.callbackNode=null,c.callbackPriority=0;if((j&3)===0||Zi(c,j)){if(m=j&-j,m===c.callbackPriority)return m;switch(_!==null&&St(_),$t(j)){case 2:case 8:j=xn;break;case 32:j=Yr;break;case 268435456:j=tn;break;default:j=Yr}return _=k4.bind(null,c),j=rr(j,_),c.callbackPriority=m,c.callbackNode=j,m}return _!==null&&_!==null&&St(_),c.callbackPriority=2,c.callbackNode=null,2}function k4(c,m){if(mo!==0&&mo!==5)return c.callbackNode=null,c.callbackPriority=0,null;var j=c.callbackNode;if(gx()&&c.callbackNode!==j)return null;var _=Zn;return _=On(c,c===ra?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),_===0?null:(f4(c,_,m),O4(c,zr()),c.callbackNode!=null&&c.callbackNode===j?k4.bind(null,c):null)}function D4(c,m){if(gx())return null;f4(c,m,!0)}function RH(){GH(function(){(Ni&6)!==0?rr(Or,PH):I4()})}function Kj(){if(zh===0){var c=P;c===0&&(c=Kr,Kr<<=1,(Kr&261888)===0&&(Kr=256)),zh=c}return zh}function P4(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:ka(""+c)}function R4(c,m){var j=m.ownerDocument.createElement("input");return j.name=m.name,j.value=m.value,c.id&&j.setAttribute("form",c.id),m.parentNode.insertBefore(j,m),c=new FormData(c),j.parentNode.removeChild(j),c}function MH(c,m,j,_,B){if(m==="submit"&&j&&j.stateNode===B){var G=P4((B[vn]||null).action),pe=_.submitter;pe&&(m=(m=pe[vn]||null)?P4(m.formAction):pe.getAttribute("formAction"),m!==null&&(G=m,pe=null));var Te=new ji("action","action",null,_,B);c.push({event:Te,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(zh!==0){var Ue=pe?R4(B,pe):new FormData(B);mj(j,{pending:!0,data:Ue,method:B.method,action:G},null,Ue)}}else typeof G=="function"&&(Te.preventDefault(),Ue=pe?R4(B,pe):new FormData(B),mj(j,{pending:!0,data:Ue,method:B.method,action:G},G,Ue))},currentTarget:B}]})}}for(var Qj=0;Qj<Oo.length;Qj++){var Yj=Oo[Qj],LH=Yj.toLowerCase(),zH=Yj[0].toUpperCase()+Yj.slice(1);rl(LH,"on"+zH)}rl(ua,"onAnimationEnd"),rl(Ra,"onAnimationIteration"),rl(Un,"onAnimationStart"),rl("dblclick","onDoubleClick"),rl("focusin","onFocus"),rl("focusout","onBlur"),rl(Ma,"onTransitionRun"),rl(Ms,"onTransitionStart"),rl(xc,"onTransitionCancel"),rl(Io,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),zn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),zn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),zn("onBeforeInput",["compositionend","keypress","textInput","paste"]),zn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),zn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),zn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var B0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BH=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(B0));function M4(c,m){m=(m&4)!==0;for(var j=0;j<c.length;j++){var _=c[j],B=_.event;_=_.listeners;e:{var G=void 0;if(m)for(var pe=_.length-1;0<=pe;pe--){var Te=_[pe],Ue=Te.instance,ft=Te.currentTarget;if(Te=Te.listener,Ue!==G&&B.isPropagationStopped())break e;G=Te,B.currentTarget=ft;try{G(B)}catch(It){Pd(It)}B.currentTarget=null,G=Ue}else for(pe=0;pe<_.length;pe++){if(Te=_[pe],Ue=Te.instance,ft=Te.currentTarget,Te=Te.listener,Ue!==G&&B.isPropagationStopped())break e;G=Te,B.currentTarget=ft;try{G(B)}catch(It){Pd(It)}B.currentTarget=null,G=Ue}}}}function Vn(c,m){var j=m[Ji];j===void 0&&(j=m[Ji]=new Set);var _=c+"__bubble";j.has(_)||(L4(m,c,2,!1),j.add(_))}function Zj(c,m,j){var _=0;m&&(_|=4),L4(j,c,_,m)}var vx="_reactListening"+Math.random().toString(36).slice(2);function Xj(c){if(!c[vx]){c[vx]=!0,Rt.forEach(function(j){j!=="selectionchange"&&(BH.has(j)||Zj(j,!1,c),Zj(j,!0,c))});var m=c.nodeType===9?c:c.ownerDocument;m===null||m[vx]||(m[vx]=!0,Zj("selectionchange",!1,m))}}function L4(c,m,j,_){switch(hT(m)){case 2:var B=fV;break;case 8:B=mV;break;default:B=f5}j=B.bind(null,m,j,c),B=void 0,!gc||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(B=!0),_?B!==void 0?c.addEventListener(m,j,{capture:!0,passive:B}):c.addEventListener(m,j,!0):B!==void 0?c.addEventListener(m,j,{passive:B}):c.addEventListener(m,j,!1)}function Jj(c,m,j,_,B){var G=_;if((m&1)===0&&(m&2)===0&&_!==null)e:for(;;){if(_===null)return;var pe=_.tag;if(pe===3||pe===4){var Te=_.stateNode.containerInfo;if(Te===B)break;if(pe===4)for(pe=_.return;pe!==null;){var Ue=pe.tag;if((Ue===3||Ue===4)&&pe.stateNode.containerInfo===B)return;pe=pe.return}for(;Te!==null;){if(pe=fi(Te),pe===null)return;if(Ue=pe.tag,Ue===5||Ue===6||Ue===26||Ue===27){_=G=pe;continue e}Te=Te.parentNode}}_=_.return}ud(function(){var ft=G,It=Pl(j),Mt=[];e:{var gt=ju.get(c);if(gt!==void 0){var jt=ji,jr=c;switch(c){case"keypress":if(Ja(j)===0)break e;case"keydown":case"keyup":jt=Sn;break;case"focusin":jr="focus",jt=Rl;break;case"focusout":jr="blur",jt=Rl;break;case"beforeblur":case"afterblur":jt=Rl;break;case"click":if(j.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jt=Fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jt=_o;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jt=va;break;case ua:case Ra:case Un:jt=te;break;case Io:jt=Ei;break;case"scroll":case"scrollend":jt=mn;break;case"wheel":jt=ts;break;case"copy":case"cut":case"paste":jt=Re;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jt=Zr;break;case"toggle":case"beforetoggle":jt=Xo}var nn=(m&4)!==0,Vi=!nn&&(c==="scroll"||c==="scrollend"),rt=nn?gt!==null?gt+"Capture":null:gt;nn=[];for(var Ke=ft,ht;Ke!==null;){var Dt=Ke;if(ht=Dt.stateNode,Dt=Dt.tag,Dt!==5&&Dt!==26&&Dt!==27||ht===null||rt===null||(Dt=Lr(Ke,rt),Dt!=null&&nn.push(F0(Ke,Dt,ht))),Vi)break;Ke=Ke.return}0<nn.length&&(gt=new jt(gt,jr,null,j,It),Mt.push({event:gt,listeners:nn}))}}if((m&7)===0){e:{if(gt=c==="mouseover"||c==="pointerover",jt=c==="mouseout"||c==="pointerout",gt&&j!==Ao&&(jr=j.relatedTarget||j.fromElement)&&(fi(jr)||jr[Fi]))break e;if((jt||gt)&&(gt=It.window===It?It:(gt=It.ownerDocument)?gt.defaultView||gt.parentWindow:window,jt?(jr=j.relatedTarget||j.toElement,jt=ft,jr=jr?fi(jr):null,jr!==null&&(Vi=s(jr),nn=jr.tag,jr!==Vi||nn!==5&&nn!==27&&nn!==6)&&(jr=null)):(jt=null,jr=ft),jt!==jr)){if(nn=Fn,Dt="onMouseLeave",rt="onMouseEnter",Ke="mouse",(c==="pointerout"||c==="pointerover")&&(nn=Zr,Dt="onPointerLeave",rt="onPointerEnter",Ke="pointer"),Vi=jt==null?gt:Ko(jt),ht=jr==null?gt:Ko(jr),gt=new nn(Dt,Ke+"leave",jt,j,It),gt.target=Vi,gt.relatedTarget=ht,Dt=null,fi(It)===ft&&(nn=new nn(rt,Ke+"enter",jr,j,It),nn.target=ht,nn.relatedTarget=Vi,Dt=nn),Vi=Dt,jt&&jr)t:{for(nn=FH,rt=jt,Ke=jr,ht=0,Dt=rt;Dt;Dt=nn(Dt))ht++;Dt=0;for(var $r=Ke;$r;$r=nn($r))Dt++;for(;0<ht-Dt;)rt=nn(rt),ht--;for(;0<Dt-ht;)Ke=nn(Ke),Dt--;for(;ht--;){if(rt===Ke||Ke!==null&&rt===Ke.alternate){nn=rt;break t}rt=nn(rt),Ke=nn(Ke)}nn=null}else nn=null;jt!==null&&z4(Mt,gt,jt,nn,!1),jr!==null&&Vi!==null&&z4(Mt,Vi,jr,nn,!0)}}e:{if(gt=ft?Ko(ft):window,jt=gt.nodeName&&gt.nodeName.toLowerCase(),jt==="select"||jt==="input"&&gt.type==="file")var gi=da;else if(Qs(gt))if(Ys)gi=S;else{gi=g;var Pr=h}else jt=gt.nodeName,!jt||jt.toLowerCase()!=="input"||gt.type!=="checkbox"&&gt.type!=="radio"?ft&&Jn(ft.elementType)&&(gi=da):gi=b;if(gi&&(gi=gi(c,ft))){qi(Mt,gi,j,It);break e}Pr&&Pr(c,gt,ft),c==="focusout"&&ft&&gt.type==="number"&&ft.memoizedProps.value!=null&&Pe(gt,"number",gt.value)}switch(Pr=ft?Ko(ft):window,c){case"focusin":(Qs(Pr)||Pr.contentEditable==="true")&&(qe=Pr,$e=ft,Xe=null);break;case"focusout":Xe=$e=qe=null;break;case"mousedown":ct=!0;break;case"contextmenu":case"mouseup":case"dragend":ct=!1,Tt(Mt,j,It);break;case"selectionchange":if(Me)break;case"keydown":case"keyup":Tt(Mt,j,It)}var In;if(so)e:{switch(c){case"compositionstart":var Xn="onCompositionStart";break e;case"compositionend":Xn="onCompositionEnd";break e;case"compositionupdate":Xn="onCompositionUpdate";break e}Xn=void 0}else gl?Yl(c,j)&&(Xn="onCompositionEnd"):c==="keydown"&&j.keyCode===229&&(Xn="onCompositionStart");Xn&&(Jo&&j.locale!=="ko"&&(gl||Xn!=="onCompositionStart"?Xn==="onCompositionEnd"&&gl&&(In=Ks()):(fs=It,Xa="value"in fs?fs.value:fs.textContent,gl=!0)),Pr=bx(ft,Xn),0<Pr.length&&(Xn=new et(Xn,c,null,j,It),Mt.push({event:Xn,listeners:Pr}),In?Xn.data=In:(In=el(j),In!==null&&(Xn.data=In)))),(In=Ql?qn(c,j):rs(c,j))&&(Xn=bx(ft,"onBeforeInput"),0<Xn.length&&(Pr=new et("onBeforeInput","beforeinput",null,j,It),Mt.push({event:Pr,listeners:Xn}),Pr.data=In)),MH(Mt,c,ft,j,It)}M4(Mt,m)})}function F0(c,m,j){return{instance:c,listener:m,currentTarget:j}}function bx(c,m){for(var j=m+"Capture",_=[];c!==null;){var B=c,G=B.stateNode;if(B=B.tag,B!==5&&B!==26&&B!==27||G===null||(B=Lr(c,j),B!=null&&_.unshift(F0(c,B,G)),B=Lr(c,m),B!=null&&_.push(F0(c,B,G))),c.tag===3)return _;c=c.return}return[]}function FH(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function z4(c,m,j,_,B){for(var G=m._reactName,pe=[];j!==null&&j!==_;){var Te=j,Ue=Te.alternate,ft=Te.stateNode;if(Te=Te.tag,Ue!==null&&Ue===_)break;Te!==5&&Te!==26&&Te!==27||ft===null||(Ue=ft,B?(ft=Lr(j,G),ft!=null&&pe.unshift(F0(j,ft,Ue))):B||(ft=Lr(j,G),ft!=null&&pe.push(F0(j,ft,Ue)))),j=j.return}pe.length!==0&&c.push({event:m,listeners:pe})}var qH=/\r\n?/g,UH=/\u0000|\uFFFD/g;function B4(c){return(typeof c=="string"?c:""+c).replace(qH,`
`).replace(UH,"")}function F4(c,m){return m=B4(m),B4(c)===m}function Hi(c,m,j,_,B,G){switch(j){case"children":typeof _=="string"?m==="body"||m==="textarea"&&_===""||Ps(c,_):(typeof _=="number"||typeof _=="bigint")&&m!=="body"&&Ps(c,""+_);break;case"className":Rn(c,"class",_);break;case"tabIndex":Rn(c,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":Rn(c,j,_);break;case"style":Cr(c,_,G);break;case"data":if(m!=="object"){Rn(c,"data",_);break}case"src":case"href":if(_===""&&(m!=="a"||j!=="href")){c.removeAttribute(j);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){c.removeAttribute(j);break}_=ka(""+_),c.setAttribute(j,_);break;case"action":case"formAction":if(typeof _=="function"){c.setAttribute(j,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof G=="function"&&(j==="formAction"?(m!=="input"&&Hi(c,m,"name",B.name,B,null),Hi(c,m,"formEncType",B.formEncType,B,null),Hi(c,m,"formMethod",B.formMethod,B,null),Hi(c,m,"formTarget",B.formTarget,B,null)):(Hi(c,m,"encType",B.encType,B,null),Hi(c,m,"method",B.method,B,null),Hi(c,m,"target",B.target,B,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){c.removeAttribute(j);break}_=ka(""+_),c.setAttribute(j,_);break;case"onClick":_!=null&&(c.onclick=Za);break;case"onScroll":_!=null&&Vn("scroll",c);break;case"onScrollEnd":_!=null&&Vn("scrollend",c);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(i(61));if(j=_.__html,j!=null){if(B.children!=null)throw Error(i(60));c.innerHTML=j}}break;case"multiple":c.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":c.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){c.removeAttribute("xlink:href");break}j=ka(""+_),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",j);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?c.setAttribute(j,""+_):c.removeAttribute(j);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?c.setAttribute(j,""):c.removeAttribute(j);break;case"capture":case"download":_===!0?c.setAttribute(j,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?c.setAttribute(j,_):c.removeAttribute(j);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?c.setAttribute(j,_):c.removeAttribute(j);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?c.removeAttribute(j):c.setAttribute(j,_);break;case"popover":Vn("beforetoggle",c),Vn("toggle",c),Jr(c,"popover",_);break;case"xlinkActuate":hs(c,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":hs(c,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":hs(c,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":hs(c,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":hs(c,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":hs(c,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":hs(c,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":hs(c,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":hs(c,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":Jr(c,"is",_);break;case"innerText":case"textContent":break;default:(!(2<j.length)||j[0]!=="o"&&j[0]!=="O"||j[1]!=="n"&&j[1]!=="N")&&(j=Dl.get(j)||j,Jr(c,j,_))}}function e5(c,m,j,_,B,G){switch(j){case"style":Cr(c,_,G);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(i(61));if(j=_.__html,j!=null){if(B.children!=null)throw Error(i(60));c.innerHTML=j}}break;case"children":typeof _=="string"?Ps(c,_):(typeof _=="number"||typeof _=="bigint")&&Ps(c,""+_);break;case"onScroll":_!=null&&Vn("scroll",c);break;case"onScrollEnd":_!=null&&Vn("scrollend",c);break;case"onClick":_!=null&&(c.onclick=Za);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!io.hasOwnProperty(j))e:{if(j[0]==="o"&&j[1]==="n"&&(B=j.endsWith("Capture"),m=j.slice(2,B?j.length-7:void 0),G=c[vn]||null,G=G!=null?G[j]:null,typeof G=="function"&&c.removeEventListener(m,G,B),typeof _=="function")){typeof G!="function"&&G!==null&&(j in c?c[j]=null:c.hasAttribute(j)&&c.removeAttribute(j)),c.addEventListener(m,_,B);break e}j in c?c[j]=_:_===!0?c.setAttribute(j,""):Jr(c,j,_)}}}function ll(c,m,j){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Vn("error",c),Vn("load",c);var _=!1,B=!1,G;for(G in j)if(j.hasOwnProperty(G)){var pe=j[G];if(pe!=null)switch(G){case"src":_=!0;break;case"srcSet":B=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,m));default:Hi(c,m,G,pe,j,null)}}B&&Hi(c,m,"srcSet",j.srcSet,j,null),_&&Hi(c,m,"src",j.src,j,null);return;case"input":Vn("invalid",c);var Te=G=pe=B=null,Ue=null,ft=null;for(_ in j)if(j.hasOwnProperty(_)){var It=j[_];if(It!=null)switch(_){case"name":B=It;break;case"type":pe=It;break;case"checked":Ue=It;break;case"defaultChecked":ft=It;break;case"value":G=It;break;case"defaultValue":Te=It;break;case"children":case"dangerouslySetInnerHTML":if(It!=null)throw Error(i(137,m));break;default:Hi(c,m,_,It,j,null)}}it(c,G,Te,Ue,ft,pe,B,!1);return;case"select":Vn("invalid",c),_=pe=G=null;for(B in j)if(j.hasOwnProperty(B)&&(Te=j[B],Te!=null))switch(B){case"value":G=Te;break;case"defaultValue":pe=Te;break;case"multiple":_=Te;default:Hi(c,m,B,Te,j,null)}m=G,j=pe,c.multiple=!!_,m!=null?Ht(c,!!_,m,!1):j!=null&&Ht(c,!!_,j,!0);return;case"textarea":Vn("invalid",c),G=B=_=null;for(pe in j)if(j.hasOwnProperty(pe)&&(Te=j[pe],Te!=null))switch(pe){case"value":_=Te;break;case"defaultValue":B=Te;break;case"children":G=Te;break;case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(91));break;default:Hi(c,m,pe,Te,j,null)}la(c,_,B,G);return;case"option":for(Ue in j)j.hasOwnProperty(Ue)&&(_=j[Ue],_!=null)&&(Ue==="selected"?c.selected=_&&typeof _!="function"&&typeof _!="symbol":Hi(c,m,Ue,_,j,null));return;case"dialog":Vn("beforetoggle",c),Vn("toggle",c),Vn("cancel",c),Vn("close",c);break;case"iframe":case"object":Vn("load",c);break;case"video":case"audio":for(_=0;_<B0.length;_++)Vn(B0[_],c);break;case"image":Vn("error",c),Vn("load",c);break;case"details":Vn("toggle",c);break;case"embed":case"source":case"link":Vn("error",c),Vn("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ft in j)if(j.hasOwnProperty(ft)&&(_=j[ft],_!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,m));default:Hi(c,m,ft,_,j,null)}return;default:if(Jn(m)){for(It in j)j.hasOwnProperty(It)&&(_=j[It],_!==void 0&&e5(c,m,It,_,j,void 0));return}}for(Te in j)j.hasOwnProperty(Te)&&(_=j[Te],_!=null&&Hi(c,m,Te,_,j,null))}function WH(c,m,j,_){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var B=null,G=null,pe=null,Te=null,Ue=null,ft=null,It=null;for(jt in j){var Mt=j[jt];if(j.hasOwnProperty(jt)&&Mt!=null)switch(jt){case"checked":break;case"value":break;case"defaultValue":Ue=Mt;default:_.hasOwnProperty(jt)||Hi(c,m,jt,null,_,Mt)}}for(var gt in _){var jt=_[gt];if(Mt=j[gt],_.hasOwnProperty(gt)&&(jt!=null||Mt!=null))switch(gt){case"type":G=jt;break;case"name":B=jt;break;case"checked":ft=jt;break;case"defaultChecked":It=jt;break;case"value":pe=jt;break;case"defaultValue":Te=jt;break;case"children":case"dangerouslySetInnerHTML":if(jt!=null)throw Error(i(137,m));break;default:jt!==Mt&&Hi(c,m,gt,jt,_,Mt)}}ea(c,pe,Te,Ue,ft,It,G,B);return;case"select":jt=pe=Te=gt=null;for(G in j)if(Ue=j[G],j.hasOwnProperty(G)&&Ue!=null)switch(G){case"value":break;case"multiple":jt=Ue;default:_.hasOwnProperty(G)||Hi(c,m,G,null,_,Ue)}for(B in _)if(G=_[B],Ue=j[B],_.hasOwnProperty(B)&&(G!=null||Ue!=null))switch(B){case"value":gt=G;break;case"defaultValue":Te=G;break;case"multiple":pe=G;default:G!==Ue&&Hi(c,m,B,G,_,Ue)}m=Te,j=pe,_=jt,gt!=null?Ht(c,!!j,gt,!1):!!_!=!!j&&(m!=null?Ht(c,!!j,m,!0):Ht(c,!!j,j?[]:"",!1));return;case"textarea":jt=gt=null;for(Te in j)if(B=j[Te],j.hasOwnProperty(Te)&&B!=null&&!_.hasOwnProperty(Te))switch(Te){case"value":break;case"children":break;default:Hi(c,m,Te,null,_,B)}for(pe in _)if(B=_[pe],G=j[pe],_.hasOwnProperty(pe)&&(B!=null||G!=null))switch(pe){case"value":gt=B;break;case"defaultValue":jt=B;break;case"children":break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(i(91));break;default:B!==G&&Hi(c,m,pe,B,_,G)}ni(c,gt,jt);return;case"option":for(var jr in j)gt=j[jr],j.hasOwnProperty(jr)&&gt!=null&&!_.hasOwnProperty(jr)&&(jr==="selected"?c.selected=!1:Hi(c,m,jr,null,_,gt));for(Ue in _)gt=_[Ue],jt=j[Ue],_.hasOwnProperty(Ue)&&gt!==jt&&(gt!=null||jt!=null)&&(Ue==="selected"?c.selected=gt&&typeof gt!="function"&&typeof gt!="symbol":Hi(c,m,Ue,gt,_,jt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nn in j)gt=j[nn],j.hasOwnProperty(nn)&&gt!=null&&!_.hasOwnProperty(nn)&&Hi(c,m,nn,null,_,gt);for(ft in _)if(gt=_[ft],jt=j[ft],_.hasOwnProperty(ft)&&gt!==jt&&(gt!=null||jt!=null))switch(ft){case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(i(137,m));break;default:Hi(c,m,ft,gt,_,jt)}return;default:if(Jn(m)){for(var Vi in j)gt=j[Vi],j.hasOwnProperty(Vi)&&gt!==void 0&&!_.hasOwnProperty(Vi)&&e5(c,m,Vi,void 0,_,gt);for(It in _)gt=_[It],jt=j[It],!_.hasOwnProperty(It)||gt===jt||gt===void 0&&jt===void 0||e5(c,m,It,gt,_,jt);return}}for(var rt in j)gt=j[rt],j.hasOwnProperty(rt)&&gt!=null&&!_.hasOwnProperty(rt)&&Hi(c,m,rt,null,_,gt);for(Mt in _)gt=_[Mt],jt=j[Mt],!_.hasOwnProperty(Mt)||gt===jt||gt==null&&jt==null||Hi(c,m,Mt,gt,_,jt)}function q4(c){switch(c){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function HH(){if(typeof performance.getEntriesByType=="function"){for(var c=0,m=0,j=performance.getEntriesByType("resource"),_=0;_<j.length;_++){var B=j[_],G=B.transferSize,pe=B.initiatorType,Te=B.duration;if(G&&Te&&q4(pe)){for(pe=0,Te=B.responseEnd,_+=1;_<j.length;_++){var Ue=j[_],ft=Ue.startTime;if(ft>Te)break;var It=Ue.transferSize,Mt=Ue.initiatorType;It&&q4(Mt)&&(Ue=Ue.responseEnd,pe+=It*(Ue<Te?1:(Te-ft)/(Ue-ft)))}if(--_,m+=8*(G+pe)/(B.duration/1e3),c++,10<c)break}}if(0<c)return m/c/1e6}return navigator.connection&&(c=navigator.connection.downlink,typeof c=="number")?c:5}var t5=null,r5=null;function jx(c){return c.nodeType===9?c:c.ownerDocument}function U4(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function W4(c,m){if(c===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&m==="foreignObject"?0:c}function n5(c,m){return c==="textarea"||c==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var i5=null;function VH(){var c=window.event;return c&&c.type==="popstate"?c===i5?!1:(i5=c,!0):(i5=null,!1)}var H4=typeof setTimeout=="function"?setTimeout:void 0,$H=typeof clearTimeout=="function"?clearTimeout:void 0,V4=typeof Promise=="function"?Promise:void 0,GH=typeof queueMicrotask=="function"?queueMicrotask:typeof V4<"u"?function(c){return V4.resolve(null).then(c).catch(KH)}:H4;function KH(c){setTimeout(function(){throw c})}function Bh(c){return c==="head"}function $4(c,m){var j=m,_=0;do{var B=j.nextSibling;if(c.removeChild(j),B&&B.nodeType===8)if(j=B.data,j==="/$"||j==="/&"){if(_===0){c.removeChild(B),Jm(m);return}_--}else if(j==="$"||j==="$?"||j==="$~"||j==="$!"||j==="&")_++;else if(j==="html")q0(c.ownerDocument.documentElement);else if(j==="head"){j=c.ownerDocument.head,q0(j);for(var G=j.firstChild;G;){var pe=G.nextSibling,Te=G.nodeName;G[Go]||Te==="SCRIPT"||Te==="STYLE"||Te==="LINK"&&G.rel.toLowerCase()==="stylesheet"||j.removeChild(G),G=pe}}else j==="body"&&q0(c.ownerDocument.body);j=B}while(j);Jm(m)}function G4(c,m){var j=c;c=0;do{var _=j.nextSibling;if(j.nodeType===1?m?(j._stashedDisplay=j.style.display,j.style.display="none"):(j.style.display=j._stashedDisplay||"",j.getAttribute("style")===""&&j.removeAttribute("style")):j.nodeType===3&&(m?(j._stashedText=j.nodeValue,j.nodeValue=""):j.nodeValue=j._stashedText||""),_&&_.nodeType===8)if(j=_.data,j==="/$"){if(c===0)break;c--}else j!=="$"&&j!=="$?"&&j!=="$~"&&j!=="$!"||c++;j=_}while(j)}function a5(c){var m=c.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var j=m;switch(m=m.nextSibling,j.nodeName){case"HTML":case"HEAD":case"BODY":a5(j),Ga(j);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(j.rel.toLowerCase()==="stylesheet")continue}c.removeChild(j)}}function QH(c,m,j,_){for(;c.nodeType===1;){var B=j;if(c.nodeName.toLowerCase()!==m.toLowerCase()){if(!_&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(_){if(!c[Go])switch(m){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(G=c.getAttribute("rel"),G==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(G!==B.rel||c.getAttribute("href")!==(B.href==null||B.href===""?null:B.href)||c.getAttribute("crossorigin")!==(B.crossOrigin==null?null:B.crossOrigin)||c.getAttribute("title")!==(B.title==null?null:B.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(G=c.getAttribute("src"),(G!==(B.src==null?null:B.src)||c.getAttribute("type")!==(B.type==null?null:B.type)||c.getAttribute("crossorigin")!==(B.crossOrigin==null?null:B.crossOrigin))&&G&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(m==="input"&&c.type==="hidden"){var G=B.name==null?null:""+B.name;if(B.type==="hidden"&&c.getAttribute("name")===G)return c}else return c;if(c=$c(c.nextSibling),c===null)break}return null}function YH(c,m,j){if(m==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!j||(c=$c(c.nextSibling),c===null))return null;return c}function K4(c,m){for(;c.nodeType!==8;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!m||(c=$c(c.nextSibling),c===null))return null;return c}function s5(c){return c.data==="$?"||c.data==="$~"}function o5(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState!=="loading"}function ZH(c,m){var j=c.ownerDocument;if(c.data==="$~")c._reactRetry=m;else if(c.data!=="$?"||j.readyState!=="loading")m();else{var _=function(){m(),j.removeEventListener("DOMContentLoaded",_)};j.addEventListener("DOMContentLoaded",_),c._reactRetry=_}}function $c(c){for(;c!=null;c=c.nextSibling){var m=c.nodeType;if(m===1||m===3)break;if(m===8){if(m=c.data,m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"||m==="F!"||m==="F")break;if(m==="/$"||m==="/&")return null}}return c}var l5=null;function Q4(c){c=c.nextSibling;for(var m=0;c;){if(c.nodeType===8){var j=c.data;if(j==="/$"||j==="/&"){if(m===0)return $c(c.nextSibling);m--}else j!=="$"&&j!=="$!"&&j!=="$?"&&j!=="$~"&&j!=="&"||m++}c=c.nextSibling}return null}function Y4(c){c=c.previousSibling;for(var m=0;c;){if(c.nodeType===8){var j=c.data;if(j==="$"||j==="$!"||j==="$?"||j==="$~"||j==="&"){if(m===0)return c;m--}else j!=="/$"&&j!=="/&"||m++}c=c.previousSibling}return null}function Z4(c,m,j){switch(m=jx(j),c){case"html":if(c=m.documentElement,!c)throw Error(i(452));return c;case"head":if(c=m.head,!c)throw Error(i(453));return c;case"body":if(c=m.body,!c)throw Error(i(454));return c;default:throw Error(i(451))}}function q0(c){for(var m=c.attributes;m.length;)c.removeAttributeNode(m[0]);Ga(c)}var Gc=new Map,X4=new Set;function wx(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var Lu=ue.d;ue.d={f:XH,r:JH,D:eV,C:tV,L:rV,m:nV,X:aV,S:iV,M:sV};function XH(){var c=Lu.f(),m=fx();return c||m}function JH(c){var m=kn(c);m!==null&&m.tag===5&&m.type==="form"?p3(m):Lu.r(c)}var Ym=typeof document>"u"?null:document;function J4(c,m,j){var _=Ym;if(_&&typeof m=="string"&&m){var B=kr(m);B='link[rel="'+c+'"][href="'+B+'"]',typeof j=="string"&&(B+='[crossorigin="'+j+'"]'),X4.has(B)||(X4.add(B),c={rel:c,crossOrigin:j,href:m},_.querySelector(B)===null&&(m=_.createElement("link"),ll(m,"link",c),Oi(m),_.head.appendChild(m)))}}function eV(c){Lu.D(c),J4("dns-prefetch",c,null)}function tV(c,m){Lu.C(c,m),J4("preconnect",c,m)}function rV(c,m,j){Lu.L(c,m,j);var _=Ym;if(_&&c&&m){var B='link[rel="preload"][as="'+kr(m)+'"]';m==="image"&&j&&j.imageSrcSet?(B+='[imagesrcset="'+kr(j.imageSrcSet)+'"]',typeof j.imageSizes=="string"&&(B+='[imagesizes="'+kr(j.imageSizes)+'"]')):B+='[href="'+kr(c)+'"]';var G=B;switch(m){case"style":G=Zm(c);break;case"script":G=Xm(c)}Gc.has(G)||(c=p({rel:"preload",href:m==="image"&&j&&j.imageSrcSet?void 0:c,as:m},j),Gc.set(G,c),_.querySelector(B)!==null||m==="style"&&_.querySelector(U0(G))||m==="script"&&_.querySelector(W0(G))||(m=_.createElement("link"),ll(m,"link",c),Oi(m),_.head.appendChild(m)))}}function nV(c,m){Lu.m(c,m);var j=Ym;if(j&&c){var _=m&&typeof m.as=="string"?m.as:"script",B='link[rel="modulepreload"][as="'+kr(_)+'"][href="'+kr(c)+'"]',G=B;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":G=Xm(c)}if(!Gc.has(G)&&(c=p({rel:"modulepreload",href:c},m),Gc.set(G,c),j.querySelector(B)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(j.querySelector(W0(G)))return}_=j.createElement("link"),ll(_,"link",c),Oi(_),j.head.appendChild(_)}}}function iV(c,m,j){Lu.S(c,m,j);var _=Ym;if(_&&c){var B=Ka(_).hoistableStyles,G=Zm(c);m=m||"default";var pe=B.get(G);if(!pe){var Te={loading:0,preload:null};if(pe=_.querySelector(U0(G)))Te.loading=5;else{c=p({rel:"stylesheet",href:c,"data-precedence":m},j),(j=Gc.get(G))&&c5(c,j);var Ue=pe=_.createElement("link");Oi(Ue),ll(Ue,"link",c),Ue._p=new Promise(function(ft,It){Ue.onload=ft,Ue.onerror=It}),Ue.addEventListener("load",function(){Te.loading|=1}),Ue.addEventListener("error",function(){Te.loading|=2}),Te.loading|=4,Sx(pe,m,_)}pe={type:"stylesheet",instance:pe,count:1,state:Te},B.set(G,pe)}}}function aV(c,m){Lu.X(c,m);var j=Ym;if(j&&c){var _=Ka(j).hoistableScripts,B=Xm(c),G=_.get(B);G||(G=j.querySelector(W0(B)),G||(c=p({src:c,async:!0},m),(m=Gc.get(B))&&d5(c,m),G=j.createElement("script"),Oi(G),ll(G,"link",c),j.head.appendChild(G)),G={type:"script",instance:G,count:1,state:null},_.set(B,G))}}function sV(c,m){Lu.M(c,m);var j=Ym;if(j&&c){var _=Ka(j).hoistableScripts,B=Xm(c),G=_.get(B);G||(G=j.querySelector(W0(B)),G||(c=p({src:c,async:!0,type:"module"},m),(m=Gc.get(B))&&d5(c,m),G=j.createElement("script"),Oi(G),ll(G,"link",c),j.head.appendChild(G)),G={type:"script",instance:G,count:1,state:null},_.set(B,G))}}function eT(c,m,j,_){var B=(B=ge.current)?wx(B):null;if(!B)throw Error(i(446));switch(c){case"meta":case"title":return null;case"style":return typeof j.precedence=="string"&&typeof j.href=="string"?(m=Zm(j.href),j=Ka(B).hoistableStyles,_=j.get(m),_||(_={type:"style",instance:null,count:0,state:null},j.set(m,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(j.rel==="stylesheet"&&typeof j.href=="string"&&typeof j.precedence=="string"){c=Zm(j.href);var G=Ka(B).hoistableStyles,pe=G.get(c);if(pe||(B=B.ownerDocument||B,pe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},G.set(c,pe),(G=B.querySelector(U0(c)))&&!G._p&&(pe.instance=G,pe.state.loading=5),Gc.has(c)||(j={rel:"preload",as:"style",href:j.href,crossOrigin:j.crossOrigin,integrity:j.integrity,media:j.media,hrefLang:j.hrefLang,referrerPolicy:j.referrerPolicy},Gc.set(c,j),G||oV(B,c,j,pe.state))),m&&_===null)throw Error(i(528,""));return pe}if(m&&_!==null)throw Error(i(529,""));return null;case"script":return m=j.async,j=j.src,typeof j=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=Xm(j),j=Ka(B).hoistableScripts,_=j.get(m),_||(_={type:"script",instance:null,count:0,state:null},j.set(m,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,c))}}function Zm(c){return'href="'+kr(c)+'"'}function U0(c){return'link[rel="stylesheet"]['+c+"]"}function tT(c){return p({},c,{"data-precedence":c.precedence,precedence:null})}function oV(c,m,j,_){c.querySelector('link[rel="preload"][as="style"]['+m+"]")?_.loading=1:(m=c.createElement("link"),_.preload=m,m.addEventListener("load",function(){return _.loading|=1}),m.addEventListener("error",function(){return _.loading|=2}),ll(m,"link",j),Oi(m),c.head.appendChild(m))}function Xm(c){return'[src="'+kr(c)+'"]'}function W0(c){return"script[async]"+c}function rT(c,m,j){if(m.count++,m.instance===null)switch(m.type){case"style":var _=c.querySelector('style[data-href~="'+kr(j.href)+'"]');if(_)return m.instance=_,Oi(_),_;var B=p({},j,{"data-href":j.href,"data-precedence":j.precedence,href:null,precedence:null});return _=(c.ownerDocument||c).createElement("style"),Oi(_),ll(_,"style",B),Sx(_,j.precedence,c),m.instance=_;case"stylesheet":B=Zm(j.href);var G=c.querySelector(U0(B));if(G)return m.state.loading|=4,m.instance=G,Oi(G),G;_=tT(j),(B=Gc.get(B))&&c5(_,B),G=(c.ownerDocument||c).createElement("link"),Oi(G);var pe=G;return pe._p=new Promise(function(Te,Ue){pe.onload=Te,pe.onerror=Ue}),ll(G,"link",_),m.state.loading|=4,Sx(G,j.precedence,c),m.instance=G;case"script":return G=Xm(j.src),(B=c.querySelector(W0(G)))?(m.instance=B,Oi(B),B):(_=j,(B=Gc.get(G))&&(_=p({},j),d5(_,B)),c=c.ownerDocument||c,B=c.createElement("script"),Oi(B),ll(B,"link",_),c.head.appendChild(B),m.instance=B);case"void":return null;default:throw Error(i(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(_=m.instance,m.state.loading|=4,Sx(_,j.precedence,c));return m.instance}function Sx(c,m,j){for(var _=j.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),B=_.length?_[_.length-1]:null,G=B,pe=0;pe<_.length;pe++){var Te=_[pe];if(Te.dataset.precedence===m)G=Te;else if(G!==B)break}G?G.parentNode.insertBefore(c,G.nextSibling):(m=j.nodeType===9?j.head:j,m.insertBefore(c,m.firstChild))}function c5(c,m){c.crossOrigin==null&&(c.crossOrigin=m.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=m.referrerPolicy),c.title==null&&(c.title=m.title)}function d5(c,m){c.crossOrigin==null&&(c.crossOrigin=m.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=m.referrerPolicy),c.integrity==null&&(c.integrity=m.integrity)}var Cx=null;function nT(c,m,j){if(Cx===null){var _=new Map,B=Cx=new Map;B.set(j,_)}else B=Cx,_=B.get(j),_||(_=new Map,B.set(j,_));if(_.has(c))return _;for(_.set(c,null),j=j.getElementsByTagName(c),B=0;B<j.length;B++){var G=j[B];if(!(G[Go]||G[Yn]||c==="link"&&G.getAttribute("rel")==="stylesheet")&&G.namespaceURI!=="http://www.w3.org/2000/svg"){var pe=G.getAttribute(m)||"";pe=c+pe;var Te=_.get(pe);Te?Te.push(G):_.set(pe,[G])}}return _}function iT(c,m,j){c=c.ownerDocument||c,c.head.insertBefore(j,m==="title"?c.querySelector("head > title"):null)}function lV(c,m,j){if(j===1||m.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;return m.rel==="stylesheet"?(c=m.disabled,typeof m.precedence=="string"&&c==null):!0;case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function aT(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}function cV(c,m,j,_){if(j.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(j.state.loading&4)===0){if(j.instance===null){var B=Zm(_.href),G=m.querySelector(U0(B));if(G){m=G._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(c.count++,c=Nx.bind(c),m.then(c,c)),j.state.loading|=4,j.instance=G,Oi(G);return}G=m.ownerDocument||m,_=tT(_),(B=Gc.get(B))&&c5(_,B),G=G.createElement("link"),Oi(G);var pe=G;pe._p=new Promise(function(Te,Ue){pe.onload=Te,pe.onerror=Ue}),ll(G,"link",_),j.instance=G}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(j,m),(m=j.state.preload)&&(j.state.loading&3)===0&&(c.count++,j=Nx.bind(c),m.addEventListener("load",j),m.addEventListener("error",j))}}var u5=0;function dV(c,m){return c.stylesheets&&c.count===0&&Ex(c,c.stylesheets),0<c.count||0<c.imgCount?function(j){var _=setTimeout(function(){if(c.stylesheets&&Ex(c,c.stylesheets),c.unsuspend){var G=c.unsuspend;c.unsuspend=null,G()}},6e4+m);0<c.imgBytes&&u5===0&&(u5=62500*HH());var B=setTimeout(function(){if(c.waitingForImages=!1,c.count===0&&(c.stylesheets&&Ex(c,c.stylesheets),c.unsuspend)){var G=c.unsuspend;c.unsuspend=null,G()}},(c.imgBytes>u5?50:800)+m);return c.unsuspend=j,function(){c.unsuspend=null,clearTimeout(_),clearTimeout(B)}}:null}function Nx(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ex(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var Ax=null;function Ex(c,m){c.stylesheets=null,c.unsuspend!==null&&(c.count++,Ax=new Map,m.forEach(uV,c),Ax=null,Nx.call(c))}function uV(c,m){if(!(m.state.loading&4)){var j=Ax.get(c);if(j)var _=j.get(null);else{j=new Map,Ax.set(c,j);for(var B=c.querySelectorAll("link[data-precedence],style[data-precedence]"),G=0;G<B.length;G++){var pe=B[G];(pe.nodeName==="LINK"||pe.getAttribute("media")!=="not all")&&(j.set(pe.dataset.precedence,pe),_=pe)}_&&j.set(null,_)}B=m.instance,pe=B.getAttribute("data-precedence"),G=j.get(pe)||_,G===_&&j.set(null,B),j.set(pe,B),this.count++,_=Nx.bind(this),B.addEventListener("load",_),B.addEventListener("error",_),G?G.parentNode.insertBefore(B,G.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(B,c.firstChild)),m.state.loading|=4}}var H0={$$typeof:D,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function hV(c,m,j,_,B,G,pe,Te,Ue){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$a(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$a(0),this.hiddenUpdates=$a(null),this.identifierPrefix=_,this.onUncaughtError=B,this.onCaughtError=G,this.onRecoverableError=pe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ue,this.incompleteTransitions=new Map}function sT(c,m,j,_,B,G,pe,Te,Ue,ft,It,Mt){return c=new hV(c,m,j,pe,Ue,ft,It,Mt,Te),m=1,G===!0&&(m|=24),G=zs(3,null,null,m),c.current=G,G.stateNode=c,m=Eh(),m.refCount++,c.pooledCache=m,m.refCount++,G.memoizedState={element:_,isDehydrated:j,cache:m},Jt(G),c}function oT(c){return c?(c=gs,c):gs}function lT(c,m,j,_,B,G){B=oT(B),_.context===null?_.context=B:_.pendingContext=B,_=en(m),_.payload={element:j},G=G===void 0?null:G,G!==null&&(_.callback=G),j=Nn(c,_,m),j!==null&&(ic(j,c,m),Si(j,c,m))}function cT(c,m){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var j=c.retryLane;c.retryLane=j!==0&&j<m?j:m}}function h5(c,m){cT(c,m),(c=c.alternate)&&cT(c,m)}function dT(c){if(c.tag===13||c.tag===31){var m=yl(c,67108864);m!==null&&ic(m,c,67108864),h5(c,67108864)}}function uT(c){if(c.tag===13||c.tag===31){var m=Cc();m=Xr(m);var j=yl(c,m);j!==null&&ic(j,c,m),h5(c,m)}}var _x=!0;function fV(c,m,j,_){var B=K.T;K.T=null;var G=ue.p;try{ue.p=2,f5(c,m,j,_)}finally{ue.p=G,K.T=B}}function mV(c,m,j,_){var B=K.T;K.T=null;var G=ue.p;try{ue.p=8,f5(c,m,j,_)}finally{ue.p=G,K.T=B}}function f5(c,m,j,_){if(_x){var B=m5(_);if(B===null)Jj(c,m,_,Tx,j),fT(c,_);else if(gV(B,c,m,j,_))_.stopPropagation();else if(fT(c,_),m&4&&-1<pV.indexOf(c)){for(;B!==null;){var G=kn(B);if(G!==null)switch(G.tag){case 3:if(G=G.stateNode,G.current.memoizedState.isDehydrated){var pe=_r(G.pendingLanes);if(pe!==0){var Te=G;for(Te.pendingLanes|=2,Te.entangledLanes|=2;pe;){var Ue=1<<31-ur(pe);Te.entanglements[1]|=Ue,pe&=~Ue}Qd(G),(Ni&6)===0&&(ux=zr()+500,z0(0))}}break;case 31:case 13:Te=yl(G,2),Te!==null&&ic(Te,G,2),fx(),h5(G,2)}if(G=m5(_),G===null&&Jj(c,m,_,Tx,j),G===B)break;B=G}B!==null&&_.stopPropagation()}else Jj(c,m,_,null,j)}}function m5(c){return c=Pl(c),p5(c)}var Tx=null;function p5(c){if(Tx=null,c=fi(c),c!==null){var m=s(c);if(m===null)c=null;else{var j=m.tag;if(j===13){if(c=o(m),c!==null)return c;c=null}else if(j===31){if(c=l(m),c!==null)return c;c=null}else if(j===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;c=null}else m!==c&&(c=null)}}return Tx=c,null}function hT(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(yn()){case Or:return 2;case xn:return 8;case Yr:case tr:return 32;case tn:return 268435456;default:return 32}default:return 32}}var g5=!1,Fh=null,qh=null,Uh=null,V0=new Map,$0=new Map,Wh=[],pV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fT(c,m){switch(c){case"focusin":case"focusout":Fh=null;break;case"dragenter":case"dragleave":qh=null;break;case"mouseover":case"mouseout":Uh=null;break;case"pointerover":case"pointerout":V0.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":$0.delete(m.pointerId)}}function G0(c,m,j,_,B,G){return c===null||c.nativeEvent!==G?(c={blockedOn:m,domEventName:j,eventSystemFlags:_,nativeEvent:G,targetContainers:[B]},m!==null&&(m=kn(m),m!==null&&dT(m)),c):(c.eventSystemFlags|=_,m=c.targetContainers,B!==null&&m.indexOf(B)===-1&&m.push(B),c)}function gV(c,m,j,_,B){switch(m){case"focusin":return Fh=G0(Fh,c,m,j,_,B),!0;case"dragenter":return qh=G0(qh,c,m,j,_,B),!0;case"mouseover":return Uh=G0(Uh,c,m,j,_,B),!0;case"pointerover":var G=B.pointerId;return V0.set(G,G0(V0.get(G)||null,c,m,j,_,B)),!0;case"gotpointercapture":return G=B.pointerId,$0.set(G,G0($0.get(G)||null,c,m,j,_,B)),!0}return!1}function mT(c){var m=fi(c.target);if(m!==null){var j=s(m);if(j!==null){if(m=j.tag,m===13){if(m=o(j),m!==null){c.blockedOn=m,er(c.priority,function(){uT(j)});return}}else if(m===31){if(m=l(j),m!==null){c.blockedOn=m,er(c.priority,function(){uT(j)});return}}else if(m===3&&j.stateNode.current.memoizedState.isDehydrated){c.blockedOn=j.tag===3?j.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Ix(c){if(c.blockedOn!==null)return!1;for(var m=c.targetContainers;0<m.length;){var j=m5(c.nativeEvent);if(j===null){j=c.nativeEvent;var _=new j.constructor(j.type,j);Ao=_,j.target.dispatchEvent(_),Ao=null}else return m=kn(j),m!==null&&dT(m),c.blockedOn=j,!1;m.shift()}return!0}function pT(c,m,j){Ix(c)&&j.delete(m)}function yV(){g5=!1,Fh!==null&&Ix(Fh)&&(Fh=null),qh!==null&&Ix(qh)&&(qh=null),Uh!==null&&Ix(Uh)&&(Uh=null),V0.forEach(pT),$0.forEach(pT)}function Ox(c,m){c.blockedOn===m&&(c.blockedOn=null,g5||(g5=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,yV)))}var kx=null;function gT(c){kx!==c&&(kx=c,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){kx===c&&(kx=null);for(var m=0;m<c.length;m+=3){var j=c[m],_=c[m+1],B=c[m+2];if(typeof _!="function"){if(p5(_||j)===null)continue;break}var G=kn(j);G!==null&&(c.splice(m,3),m-=3,mj(G,{pending:!0,data:B,method:j.method,action:_},_,B))}}))}function Jm(c){function m(Ue){return Ox(Ue,c)}Fh!==null&&Ox(Fh,c),qh!==null&&Ox(qh,c),Uh!==null&&Ox(Uh,c),V0.forEach(m),$0.forEach(m);for(var j=0;j<Wh.length;j++){var _=Wh[j];_.blockedOn===c&&(_.blockedOn=null)}for(;0<Wh.length&&(j=Wh[0],j.blockedOn===null);)mT(j),j.blockedOn===null&&Wh.shift();if(j=(c.ownerDocument||c).$$reactFormReplay,j!=null)for(_=0;_<j.length;_+=3){var B=j[_],G=j[_+1],pe=B[vn]||null;if(typeof G=="function")pe||gT(j);else if(pe){var Te=null;if(G&&G.hasAttribute("formAction")){if(B=G,pe=G[vn]||null)Te=pe.formAction;else if(p5(B)!==null)continue}else Te=pe.action;typeof Te=="function"?j[_+1]=Te:(j.splice(_,3),_-=3),gT(j)}}}function yT(){function c(G){G.canIntercept&&G.info==="react-transition"&&G.intercept({handler:function(){return new Promise(function(pe){return B=pe})},focusReset:"manual",scroll:"manual"})}function m(){B!==null&&(B(),B=null),_||setTimeout(j,20)}function j(){if(!_&&!navigation.transition){var G=navigation.currentEntry;G&&G.url!=null&&navigation.navigate(G.url,{state:G.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var _=!1,B=null;return navigation.addEventListener("navigate",c),navigation.addEventListener("navigatesuccess",m),navigation.addEventListener("navigateerror",m),setTimeout(j,100),function(){_=!0,navigation.removeEventListener("navigate",c),navigation.removeEventListener("navigatesuccess",m),navigation.removeEventListener("navigateerror",m),B!==null&&(B(),B=null)}}}function y5(c){this._internalRoot=c}Dx.prototype.render=y5.prototype.render=function(c){var m=this._internalRoot;if(m===null)throw Error(i(409));var j=m.current,_=Cc();lT(j,_,c,m,null,null)},Dx.prototype.unmount=y5.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var m=c.containerInfo;lT(c.current,2,null,c,null,null),fx(),m[Fi]=null}};function Dx(c){this._internalRoot=c}Dx.prototype.unstable_scheduleHydration=function(c){if(c){var m=Qn();c={blockedOn:null,target:c,priority:m};for(var j=0;j<Wh.length&&m!==0&&m<Wh[j].priority;j++);Wh.splice(j,0,c),j===0&&mT(c)}};var xT=r.version;if(xT!=="19.2.3")throw Error(i(527,xT,"19.2.3"));ue.findDOMNode=function(c){var m=c._reactInternals;if(m===void 0)throw typeof c.render=="function"?Error(i(188)):(c=Object.keys(c).join(","),Error(i(268,c)));return c=d(m),c=c!==null?f(c):null,c=c===null?null:c.stateNode,c};var xV={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Px=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Px.isDisabled&&Px.supportsFiber)try{Er=Px.inject(xV),wt=Px}catch{}}return Q0.createRoot=function(c,m){if(!a(c))throw Error(i(299));var j=!1,_="",B=N3,G=A3,pe=E3;return m!=null&&(m.unstable_strictMode===!0&&(j=!0),m.identifierPrefix!==void 0&&(_=m.identifierPrefix),m.onUncaughtError!==void 0&&(B=m.onUncaughtError),m.onCaughtError!==void 0&&(G=m.onCaughtError),m.onRecoverableError!==void 0&&(pe=m.onRecoverableError)),m=sT(c,1,!1,null,null,j,_,null,B,G,pe,yT),c[Fi]=m.current,Xj(c),new y5(m)},Q0.hydrateRoot=function(c,m,j){if(!a(c))throw Error(i(299));var _=!1,B="",G=N3,pe=A3,Te=E3,Ue=null;return j!=null&&(j.unstable_strictMode===!0&&(_=!0),j.identifierPrefix!==void 0&&(B=j.identifierPrefix),j.onUncaughtError!==void 0&&(G=j.onUncaughtError),j.onCaughtError!==void 0&&(pe=j.onCaughtError),j.onRecoverableError!==void 0&&(Te=j.onRecoverableError),j.formState!==void 0&&(Ue=j.formState)),m=sT(c,1,!0,m,j??null,_,B,Ue,G,pe,Te,yT),m.context=oT(null),j=m.current,_=Cc(),_=Xr(_),B=en(_),B.callback=null,Nn(j,B,_),j=_,m.current.lanes=j,vr(m,j),Qd(m),c[Fi]=m.current,Xj(c),new Dx(m)},Q0.version="19.2.3",Q0}var _T;function _V(){if(_T)return b5.exports;_T=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),b5.exports=EV(),b5.exports}var TV=_V();const IV=hc(TV);var TT="popstate";function OV(t={}){function r(i,a){let{pathname:s,search:o,hash:l}=i.location;return AC("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Lg(a)}return DV(r,n,null,t)}function Ha(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function rd(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function kV(){return Math.random().toString(36).substring(2,10)}function IT(t,r){return{usr:t.state,key:t.key,idx:r}}function AC(t,r,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof r=="string"?$p(r):r,state:n,key:r&&r.key||i||kV()}}function Lg({pathname:t="/",search:r="",hash:n=""}){return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function $p(t){let r={};if(t){let n=t.indexOf("#");n>=0&&(r.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(r.search=t.substring(i),t=t.substring(0,i)),t&&(r.pathname=t)}return r}function DV(t,r,n,i={}){let{window:a=document.defaultView,v5Compat:s=!1}=i,o=a.history,l="POP",u=null,d=f();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function f(){return(o.state||{idx:null}).idx}function p(){l="POP";let A=f(),T=A==null?null:A-d;d=A,u&&u({action:l,location:C.location,delta:T})}function x(A,T){l="PUSH";let O=AC(C.location,A,T);d=f()+1;let D=IT(O,d),M=C.createHref(O);try{o.pushState(D,"",M)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;a.location.assign(M)}s&&u&&u({action:l,location:C.location,delta:1})}function v(A,T){l="REPLACE";let O=AC(C.location,A,T);d=f();let D=IT(O,d),M=C.createHref(O);o.replaceState(D,"",M),s&&u&&u({action:l,location:C.location,delta:0})}function w(A){return PV(A)}let C={get action(){return l},get location(){return t(a,o)},listen(A){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(TT,p),u=A,()=>{a.removeEventListener(TT,p),u=null}},createHref(A){return r(a,A)},createURL:w,encodeLocation(A){let T=w(A);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:x,replace:v,go(A){return o.go(A)}};return C}function PV(t,r=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ha(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Lg(t);return i=i.replace(/ $/,"%20"),!r&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function YM(t,r,n="/"){return RV(t,r,n,!1)}function RV(t,r,n,i){let a=typeof r=="string"?$p(r):r,s=th(a.pathname||"/",n);if(s==null)return null;let o=ZM(t);MV(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=GV(s);l=VV(o[u],d,i)}return l}function ZM(t,r=[],n=[],i="",a=!1){let s=(o,l,u=a,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(i)&&u)return;Ha(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length)}let p=Zu([i,f.relativePath]),x=n.concat(f);o.children&&o.children.length>0&&(Ha(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),ZM(o.children,r,x,p,u)),!(o.path==null&&!o.index)&&r.push({path:p,score:WV(p,o.index),routesMeta:x})};return t.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))s(o,l);else for(let u of XM(o.path))s(o,l,!0,u)}),r}function XM(t){let r=t.split("/");if(r.length===0)return[];let[n,...i]=r,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return a?[s,""]:[s];let o=XM(i.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),a&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function MV(t){t.sort((r,n)=>r.score!==n.score?n.score-r.score:HV(r.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var LV=/^:[\w-]+$/,zV=3,BV=2,FV=1,qV=10,UV=-2,OT=t=>t==="*";function WV(t,r){let n=t.split("/"),i=n.length;return n.some(OT)&&(i+=UV),r&&(i+=BV),n.filter(a=>!OT(a)).reduce((a,s)=>a+(LV.test(s)?zV:s===""?FV:qV),i)}function HV(t,r){return t.length===r.length&&t.slice(0,-1).every((i,a)=>i===r[a])?t[t.length-1]-r[r.length-1]:0}function VV(t,r,n=!1){let{routesMeta:i}=t,a={},s="/",o=[];for(let l=0;l<i.length;++l){let u=i[l],d=l===i.length-1,f=s==="/"?r:r.slice(s.length)||"/",p=Tv({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),x=u.route;if(!p&&d&&n&&!i[i.length-1].route.index&&(p=Tv({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!p)return null;Object.assign(a,p.params),o.push({params:a,pathname:Zu([s,p.pathname]),pathnameBase:ZV(Zu([s,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(s=Zu([s,p.pathnameBase]))}return o}function Tv(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=$V(t.path,t.caseSensitive,t.end),a=r.match(n);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:i.reduce((d,{paramName:f,isOptional:p},x)=>{if(f==="*"){let w=l[x]||"";o=s.slice(0,s.length-w.length).replace(/(.)\/+$/,"$1")}const v=l[x];return p&&!v?d[f]=void 0:d[f]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function $V(t,r=!1,n=!0){rd(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(i.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),i]}function GV(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return rd(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),t}}function th(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let n=r.endsWith("/")?r.length-1:r.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var JM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KV=t=>JM.test(t);function QV(t,r="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?$p(t):t,s;if(n)if(KV(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),rd(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?s=kT(n.substring(1),"/"):s=kT(n,r)}else s=r;return{pathname:s,search:XV(i),hash:JV(a)}}function kT(t,r){let n=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function C5(t,r,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${r}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YV(t){return t.filter((r,n)=>n===0||r.route.path&&r.route.path.length>0)}function yA(t){let r=YV(t);return r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase)}function xA(t,r,n,i=!1){let a;typeof t=="string"?a=$p(t):(a={...t},Ha(!a.pathname||!a.pathname.includes("?"),C5("?","pathname","search",a)),Ha(!a.pathname||!a.pathname.includes("#"),C5("#","pathname","hash",a)),Ha(!a.search||!a.search.includes("#"),C5("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=n;else{let p=r.length-1;if(!i&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;a.pathname=x.join("/")}l=p>=0?r[p]:"/"}let u=QV(a,l),d=o&&o!=="/"&&o.endsWith("/"),f=(s||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}var Zu=t=>t.join("/").replace(/\/\/+/g,"/"),ZV=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),XV=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,JV=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,e$=class{constructor(t,r,n,i=!1){this.status=t,this.statusText=r||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function t$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function r$(t){return t.map(r=>r.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var eL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function tL(t,r){let n=t;if(typeof n!="string"||!JM.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(eL)try{let s=new URL(window.location.href),o=n.startsWith("//")?new URL(s.protocol+n):new URL(n),l=th(o.pathname,r);o.origin===s.origin&&l!=null?n=l+o.search+o.hash:a=!0}catch{rd(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rL=["POST","PUT","PATCH","DELETE"];new Set(rL);var n$=["GET",...rL];new Set(n$);var Gp=k.createContext(null);Gp.displayName="DataRouter";var Gb=k.createContext(null);Gb.displayName="DataRouterState";var i$=k.createContext(!1),nL=k.createContext({isTransitioning:!1});nL.displayName="ViewTransition";var a$=k.createContext(new Map);a$.displayName="Fetchers";var s$=k.createContext(null);s$.displayName="Await";var Bc=k.createContext(null);Bc.displayName="Navigation";var ly=k.createContext(null);ly.displayName="Location";var Td=k.createContext({outlet:null,matches:[],isDataRoute:!1});Td.displayName="Route";var vA=k.createContext(null);vA.displayName="RouteError";var iL="REACT_ROUTER_ERROR",o$="REDIRECT",l$="ROUTE_ERROR_RESPONSE";function c$(t){if(t.startsWith(`${iL}:${o$}:{`))try{let r=JSON.parse(t.slice(28));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.location=="string"&&typeof r.reloadDocument=="boolean"&&typeof r.replace=="boolean")return r}catch{}}function d$(t){if(t.startsWith(`${iL}:${l$}:{`))try{let r=JSON.parse(t.slice(40));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string")return new e$(r.status,r.statusText,r.data)}catch{}}function u$(t,{relative:r}={}){Ha(Kp(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=k.useContext(Bc),{hash:a,pathname:s,search:o}=cy(t,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:Zu([n,s])),i.createHref({pathname:l,search:o,hash:a})}function Kp(){return k.useContext(ly)!=null}function ld(){return Ha(Kp(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(ly).location}var aL="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sL(t){k.useContext(Bc).static||k.useLayoutEffect(t)}function Gr(){let{isDataRoute:t}=k.useContext(Td);return t?C$():h$()}function h$(){Ha(Kp(),"useNavigate() may be used only in the context of a <Router> component.");let t=k.useContext(Gp),{basename:r,navigator:n}=k.useContext(Bc),{matches:i}=k.useContext(Td),{pathname:a}=ld(),s=JSON.stringify(yA(i)),o=k.useRef(!1);return sL(()=>{o.current=!0}),k.useCallback((u,d={})=>{if(rd(o.current,aL),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=xA(u,JSON.parse(s),a,d.relative==="path");t==null&&r!=="/"&&(f.pathname=f.pathname==="/"?r:Zu([r,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[r,n,s,a,t])}k.createContext(null);function fl(){let{matches:t}=k.useContext(Td),r=t[t.length-1];return r?r.params:{}}function cy(t,{relative:r}={}){let{matches:n}=k.useContext(Td),{pathname:i}=ld(),a=JSON.stringify(yA(n));return k.useMemo(()=>xA(t,JSON.parse(a),i,r==="path"),[t,a,i,r])}function f$(t,r){return oL(t,r)}function oL(t,r,n,i,a){Ha(Kp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=k.useContext(Bc),{matches:o}=k.useContext(Td),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",p=l&&l.route;{let O=p&&p.path||"";cL(d,!p||O.endsWith("*")||O.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${O}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${O}"> to <Route path="${O==="/"?"*":`${O}/*`}">.`)}let x=ld(),v;if(r){let O=typeof r=="string"?$p(r):r;Ha(f==="/"||O.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${O.pathname}" was given in the \`location\` prop.`),v=O}else v=x;let w=v.pathname||"/",C=w;if(f!=="/"){let O=f.replace(/^\//,"").split("/");C="/"+w.replace(/^\//,"").split("/").slice(O.length).join("/")}let A=YM(t,{pathname:C});rd(p||A!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),rd(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=x$(A&&A.map(O=>Object.assign({},O,{params:Object.assign({},u,O.params),pathname:Zu([f,s.encodeLocation?s.encodeLocation(O.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?f:Zu([f,s.encodeLocation?s.encodeLocation(O.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:O.pathnameBase])})),o,n,i,a);return r&&T?k.createElement(ly.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},T):T}function m$(){let t=S$(),r=t$(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:s},"ErrorBoundary")," or"," ",k.createElement("code",{style:s},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},r),n?k.createElement("pre",{style:a},n):null,o)}var p$=k.createElement(m$,null),lL=class extends k.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){this.props.onError?this.props.onError(t,r):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=d$(t.digest);n&&(t=n)}let r=t!==void 0?k.createElement(Td.Provider,{value:this.props.routeContext},k.createElement(vA.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?k.createElement(g$,{error:t},r):r}};lL.contextType=i$;var N5=new WeakMap;function g$({children:t,error:r}){let{basename:n}=k.useContext(Bc);if(typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){let i=c$(r.digest);if(i){let a=N5.get(r);if(a)throw a;let s=tL(i.location,n);if(eL&&!N5.get(r))if(s.isExternal||i.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:i.replace}));throw N5.set(r,o),o}return k.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return t}function y$({routeContext:t,match:r,children:n}){let i=k.useContext(Gp);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),k.createElement(Td.Provider,{value:t},n)}function x$(t,r=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(r.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,o=n?.errors;if(o!=null){let f=s.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Ha(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,f+1))}let l=!1,u=-1;if(n)for(let f=0;f<s.length;f++){let p=s[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=f),p.route.id){let{loaderData:x,errors:v}=n,w=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||w){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}let d=n&&i?(f,p)=>{i(f,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:r$(n.matches),errorInfo:p})}:void 0;return s.reduceRight((f,p,x)=>{let v,w=!1,C=null,A=null;n&&(v=o&&p.route.id?o[p.route.id]:void 0,C=p.route.errorElement||p$,l&&(u<0&&x===0?(cL("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,A=null):u===x&&(w=!0,A=p.route.hydrateFallbackElement||null)));let T=r.concat(s.slice(0,x+1)),O=()=>{let D;return v?D=C:w?D=A:p.route.Component?D=k.createElement(p.route.Component,null):p.route.element?D=p.route.element:D=f,k.createElement(y$,{match:p,routeContext:{outlet:f,matches:T,isDataRoute:n!=null},children:D})};return n&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?k.createElement(lL,{location:n.location,revalidation:n.revalidation,component:C,error:v,children:O(),routeContext:{outlet:null,matches:T,isDataRoute:!0},onError:d}):O()},null)}function bA(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function v$(t){let r=k.useContext(Gp);return Ha(r,bA(t)),r}function b$(t){let r=k.useContext(Gb);return Ha(r,bA(t)),r}function j$(t){let r=k.useContext(Td);return Ha(r,bA(t)),r}function jA(t){let r=j$(t),n=r.matches[r.matches.length-1];return Ha(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function w$(){return jA("useRouteId")}function S$(){let t=k.useContext(vA),r=b$("useRouteError"),n=jA("useRouteError");return t!==void 0?t:r.errors?.[n]}function C$(){let{router:t}=v$("useNavigate"),r=jA("useNavigate"),n=k.useRef(!1);return sL(()=>{n.current=!0}),k.useCallback(async(a,s={})=>{rd(n.current,aL),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:r,...s}))},[t,r])}var DT={};function cL(t,r,n){!r&&!DT[t]&&(DT[t]=!0,rd(!1,n))}k.memo(N$);function N$({routes:t,future:r,state:n,onError:i}){return oL(t,void 0,n,i,r)}function Kf({to:t,replace:r,state:n,relative:i}){Ha(Kp(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=k.useContext(Bc);rd(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=k.useContext(Td),{pathname:o}=ld(),l=Gr(),u=xA(t,yA(s),o,i==="path"),d=JSON.stringify(u);return k.useEffect(()=>{l(JSON.parse(d),{replace:r,state:n,relative:i})},[l,d,i,r,n]),null}function Vt(t){Ha(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function A$({basename:t="/",children:r=null,location:n,navigationType:i="POP",navigator:a,static:s=!1,unstable_useTransitions:o}){Ha(!Kp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),u=k.useMemo(()=>({basename:l,navigator:a,static:s,unstable_useTransitions:o,future:{}}),[l,a,s,o]);typeof n=="string"&&(n=$p(n));let{pathname:d="/",search:f="",hash:p="",state:x=null,key:v="default"}=n,w=k.useMemo(()=>{let C=th(d,l);return C==null?null:{location:{pathname:C,search:f,hash:p,state:x,key:v},navigationType:i}},[l,d,f,p,x,v,i]);return rd(w!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:k.createElement(Bc.Provider,{value:u},k.createElement(ly.Provider,{children:r,value:w}))}function Mx({children:t,location:r}){return f$(EC(t),r)}function EC(t,r=[]){let n=[];return k.Children.forEach(t,(i,a)=>{if(!k.isValidElement(i))return;let s=[...r,a];if(i.type===k.Fragment){n.push.apply(n,EC(i.props.children,s));return}Ha(i.type===Vt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ha(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=EC(i.props.children,s)),n.push(o)}),n}var lv="get",cv="application/x-www-form-urlencoded";function Kb(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function E$(t){return Kb(t)&&t.tagName.toLowerCase()==="button"}function _$(t){return Kb(t)&&t.tagName.toLowerCase()==="form"}function T$(t){return Kb(t)&&t.tagName.toLowerCase()==="input"}function I$(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function O$(t,r){return t.button===0&&(!r||r==="_self")&&!I$(t)}var Lx=null;function k$(){if(Lx===null)try{new FormData(document.createElement("form"),0),Lx=!1}catch{Lx=!0}return Lx}var D$=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function A5(t){return t!=null&&!D$.has(t)?(rd(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cv}"`),null):t}function P$(t,r){let n,i,a,s,o;if(_$(t)){let l=t.getAttribute("action");i=l?th(l,r):null,n=t.getAttribute("method")||lv,a=A5(t.getAttribute("enctype"))||cv,s=new FormData(t)}else if(E$(t)||T$(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||l.getAttribute("action");if(i=u?th(u,r):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||lv,a=A5(t.getAttribute("formenctype"))||A5(l.getAttribute("enctype"))||cv,s=new FormData(l,t),!k$()){let{name:d,type:f,value:p}=t;if(f==="image"){let x=d?`${d}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else d&&s.append(d,p)}}else{if(Kb(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=lv,i=null,a=cv,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wA(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function R$(t,r,n,i){let a=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:r&&th(a.pathname,r)==="/"?a.pathname=`${r.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function M$(t,r){if(t.id in r)return r[t.id];try{let n=await import(t.module);return r[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function L$(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function z$(t,r,n){let i=await Promise.all(t.map(async a=>{let s=r.routes[a.route.id];if(s){let o=await M$(s,n);return o.links?o.links():[]}return[]}));return U$(i.flat(1).filter(L$).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function PT(t,r,n,i,a,s){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,l=(u,d)=>n[d].pathname!==u.pathname||n[d].route.path?.endsWith("*")&&n[d].params["*"]!==u.params["*"];return s==="assets"?r.filter((u,d)=>o(u,d)||l(u,d)):s==="data"?r.filter((u,d)=>{let f=i.routes[u.route.id];if(!f||!f.hasLoader)return!1;if(o(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function B$(t,r,{includeHydrateFallback:n}={}){return F$(t.map(i=>{let a=r.routes[i.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function F$(t){return[...new Set(t)]}function q$(t){let r={},n=Object.keys(t).sort();for(let i of n)r[i]=t[i];return r}function U$(t,r){let n=new Set;return new Set(r),t.reduce((i,a)=>{let s=JSON.stringify(q$(a));return n.has(s)||(n.add(s),i.push({key:s,link:a})),i},[])}function dL(){let t=k.useContext(Gp);return wA(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function W$(){let t=k.useContext(Gb);return wA(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var SA=k.createContext(void 0);SA.displayName="FrameworkContext";function uL(){let t=k.useContext(SA);return wA(t,"You must render this element inside a <HydratedRouter> element"),t}function H$(t,r){let n=k.useContext(SA),[i,a]=k.useState(!1),[s,o]=k.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:f,onTouchStart:p}=r,x=k.useRef(null);k.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let C=T=>{T.forEach(O=>{o(O.isIntersecting)})},A=new IntersectionObserver(C,{threshold:.5});return x.current&&A.observe(x.current),()=>{A.disconnect()}}},[t]),k.useEffect(()=>{if(i){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[i]);let v=()=>{a(!0)},w=()=>{a(!1),o(!1)};return n?t!=="intent"?[s,x,{}]:[s,x,{onFocus:Y0(l,v),onBlur:Y0(u,w),onMouseEnter:Y0(d,v),onMouseLeave:Y0(f,w),onTouchStart:Y0(p,v)}]:[!1,x,{}]}function Y0(t,r){return n=>{t&&t(n),n.defaultPrevented||r(n)}}function V$({page:t,...r}){let{router:n}=dL(),i=k.useMemo(()=>YM(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?k.createElement(G$,{page:t,matches:i,...r}):null}function $$(t){let{manifest:r,routeModules:n}=uL(),[i,a]=k.useState([]);return k.useEffect(()=>{let s=!1;return z$(t,r,n).then(o=>{s||a(o)}),()=>{s=!0}},[t,r,n]),i}function G$({page:t,matches:r,...n}){let i=ld(),{future:a,manifest:s,routeModules:o}=uL(),{basename:l}=dL(),{loaderData:u,matches:d}=W$(),f=k.useMemo(()=>PT(t,r,d,s,i,"data"),[t,r,d,s,i]),p=k.useMemo(()=>PT(t,r,d,s,i,"assets"),[t,r,d,s,i]),x=k.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let C=new Set,A=!1;if(r.forEach(O=>{let D=s.routes[O.route.id];!D||!D.hasLoader||(!f.some(M=>M.route.id===O.route.id)&&O.route.id in u&&o[O.route.id]?.shouldRevalidate||D.hasClientLoader?A=!0:C.add(O.route.id))}),C.size===0)return[];let T=R$(t,l,a.unstable_trailingSlashAwareDataRequests,"data");return A&&C.size>0&&T.searchParams.set("_routes",r.filter(O=>C.has(O.route.id)).map(O=>O.route.id).join(",")),[T.pathname+T.search]},[l,a.unstable_trailingSlashAwareDataRequests,u,i,s,f,r,t,o]),v=k.useMemo(()=>B$(p,s),[p,s]),w=$$(p);return k.createElement(k.Fragment,null,x.map(C=>k.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),v.map(C=>k.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),w.map(({key:C,link:A})=>k.createElement("link",{key:C,nonce:n.nonce,...A})))}function K$(...t){return r=>{t.forEach(n=>{typeof n=="function"?n(r):n!=null&&(n.current=r)})}}var Q$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Q$&&(window.__reactRouterVersion="7.12.0")}catch{}function Y$({basename:t,children:r,unstable_useTransitions:n,window:i}){let a=k.useRef();a.current==null&&(a.current=OV({window:i,v5Compat:!0}));let s=a.current,[o,l]=k.useState({action:s.action,location:s.location}),u=k.useCallback(d=>{n===!1?l(d):k.startTransition(()=>l(d))},[n]);return k.useLayoutEffect(()=>s.listen(u),[s,u]),k.createElement(A$,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:s,unstable_useTransitions:n})}var hL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nr=k.forwardRef(function({onClick:r,discover:n="render",prefetch:i="none",relative:a,reloadDocument:s,replace:o,state:l,target:u,to:d,preventScrollReset:f,viewTransition:p,unstable_defaultShouldRevalidate:x,...v},w){let{basename:C,unstable_useTransitions:A}=k.useContext(Bc),T=typeof d=="string"&&hL.test(d),O=tL(d,C);d=O.to;let D=u$(d,{relative:a}),[M,Q,U]=H$(i,v),$=eG(d,{replace:o,state:l,target:u,preventScrollReset:f,relative:a,viewTransition:p,unstable_defaultShouldRevalidate:x,unstable_useTransitions:A});function ee(Y){r&&r(Y),Y.defaultPrevented||$(Y)}let F=k.createElement("a",{...v,...U,href:O.absoluteURL||D,onClick:O.isExternal||s?r:ee,ref:K$(w,Q),target:u,"data-discover":!T&&n==="render"?"true":void 0});return M&&!T?k.createElement(k.Fragment,null,F,k.createElement(V$,{page:D})):F});nr.displayName="Link";var Z$=k.forwardRef(function({"aria-current":r="page",caseSensitive:n=!1,className:i="",end:a=!1,style:s,to:o,viewTransition:l,children:u,...d},f){let p=cy(o,{relative:d.relative}),x=ld(),v=k.useContext(Gb),{navigator:w,basename:C}=k.useContext(Bc),A=v!=null&&aG(p)&&l===!0,T=w.encodeLocation?w.encodeLocation(p).pathname:p.pathname,O=x.pathname,D=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(O=O.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&C&&(D=th(D,C)||D);const M=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let Q=O===T||!a&&O.startsWith(T)&&O.charAt(M)==="/",U=D!=null&&(D===T||!a&&D.startsWith(T)&&D.charAt(T.length)==="/"),$={isActive:Q,isPending:U,isTransitioning:A},ee=Q?r:void 0,F;typeof i=="function"?F=i($):F=[i,Q?"active":null,U?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let Y=typeof s=="function"?s($):s;return k.createElement(nr,{...d,"aria-current":ee,className:F,ref:f,style:Y,to:o,viewTransition:l},typeof u=="function"?u($):u)});Z$.displayName="NavLink";var X$=k.forwardRef(({discover:t="render",fetcherKey:r,navigate:n,reloadDocument:i,replace:a,state:s,method:o=lv,action:l,onSubmit:u,relative:d,preventScrollReset:f,viewTransition:p,unstable_defaultShouldRevalidate:x,...v},w)=>{let{unstable_useTransitions:C}=k.useContext(Bc),A=nG(),T=iG(l,{relative:d}),O=o.toLowerCase()==="get"?"get":"post",D=typeof l=="string"&&hL.test(l),M=Q=>{if(u&&u(Q),Q.defaultPrevented)return;Q.preventDefault();let U=Q.nativeEvent.submitter,$=U?.getAttribute("formmethod")||o,ee=()=>A(U||Q.currentTarget,{fetcherKey:r,method:$,navigate:n,replace:a,state:s,relative:d,preventScrollReset:f,viewTransition:p,unstable_defaultShouldRevalidate:x});C&&n!==!1?k.startTransition(()=>ee()):ee()};return k.createElement("form",{ref:w,method:O,action:T,onSubmit:i?u:M,...v,"data-discover":!D&&t==="render"?"true":void 0})});X$.displayName="Form";function J$(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fL(t){let r=k.useContext(Gp);return Ha(r,J$(t)),r}function eG(t,{target:r,replace:n,state:i,preventScrollReset:a,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:u}={}){let d=Gr(),f=ld(),p=cy(t,{relative:s});return k.useCallback(x=>{if(O$(x,r)){x.preventDefault();let v=n!==void 0?n:Lg(f)===Lg(p),w=()=>d(t,{replace:v,state:i,preventScrollReset:a,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:l});u?k.startTransition(()=>w()):w()}},[f,d,p,n,i,r,t,a,s,o,l,u])}var tG=0,rG=()=>`__${String(++tG)}__`;function nG(){let{router:t}=fL("useSubmit"),{basename:r}=k.useContext(Bc),n=w$(),i=t.fetch,a=t.navigate;return k.useCallback(async(s,o={})=>{let{action:l,method:u,encType:d,formData:f,body:p}=P$(s,r);if(o.navigate===!1){let x=o.fetcherKey||rG();await i(x,n,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await a(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[i,a,r,n])}function iG(t,{relative:r}={}){let{basename:n}=k.useContext(Bc),i=k.useContext(Td);Ha(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),s={...cy(t||".",{relative:r})},o=ld();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),u=l.getAll("index");if(u.some(f=>f==="")){l.delete("index"),u.filter(p=>p).forEach(p=>l.append("index",p));let f=l.toString();s.search=f?`?${f}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:Zu([n,s.pathname])),Lg(s)}function aG(t,{relative:r}={}){let n=k.useContext(nL);Ha(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=fL("useViewTransitionState"),a=cy(t,{relative:r});if(!n.isTransitioning)return!1;let s=th(n.currentLocation.pathname,i)||n.currentLocation.pathname,o=th(n.nextLocation.pathname,i)||n.nextLocation.pathname;return Tv(a.pathname,o)!=null||Tv(a.pathname,s)!=null}var CA=QM(),Qp=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},sG={setTimeout:(t,r)=>setTimeout(t,r),clearTimeout:t=>clearTimeout(t),setInterval:(t,r)=>setInterval(t,r),clearInterval:t=>clearInterval(t)},oG=class{#e=sG;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,r){return this.#e.setTimeout(t,r)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,r){return this.#e.setInterval(t,r)}clearInterval(t){this.#e.clearInterval(t)}},Uf=new oG;function lG(t){setTimeout(t,0)}var rm=typeof window>"u"||"Deno"in globalThis;function zl(){}function cG(t,r){return typeof t=="function"?t(r):t}function _C(t){return typeof t=="number"&&t>=0&&t!==1/0}function mL(t,r){return Math.max(t+(r||0)-Date.now(),0)}function nf(t,r){return typeof t=="function"?t(r):t}function Jc(t,r){return typeof t=="function"?t(r):t}function RT(t,r){const{type:n="all",exact:i,fetchStatus:a,predicate:s,queryKey:o,stale:l}=t;if(o){if(i){if(r.queryHash!==NA(o,r.options))return!1}else if(!zg(r.queryKey,o))return!1}if(n!=="all"){const u=r.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof l=="boolean"&&r.isStale()!==l||a&&a!==r.state.fetchStatus||s&&!s(r))}function MT(t,r){const{exact:n,status:i,predicate:a,mutationKey:s}=t;if(s){if(!r.options.mutationKey)return!1;if(n){if(nm(r.options.mutationKey)!==nm(s))return!1}else if(!zg(r.options.mutationKey,s))return!1}return!(i&&r.state.status!==i||a&&!a(r))}function NA(t,r){return(r?.queryKeyHashFn||nm)(t)}function nm(t){return JSON.stringify(t,(r,n)=>TC(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function zg(t,r){return t===r?!0:typeof t!=typeof r?!1:t&&r&&typeof t=="object"&&typeof r=="object"?Object.keys(r).every(n=>zg(t[n],r[n])):!1}var dG=Object.prototype.hasOwnProperty;function pL(t,r,n=0){if(t===r)return t;if(n>500)return r;const i=LT(t)&&LT(r);if(!i&&!(TC(t)&&TC(r)))return r;const s=(i?t:Object.keys(t)).length,o=i?r:Object.keys(r),l=o.length,u=i?new Array(l):{};let d=0;for(let f=0;f<l;f++){const p=i?f:o[f],x=t[p],v=r[p];if(x===v){u[p]=x,(i?f<s:dG.call(t,p))&&d++;continue}if(x===null||v===null||typeof x!="object"||typeof v!="object"){u[p]=v;continue}const w=pL(x,v,n+1);u[p]=w,w===x&&d++}return s===l&&d===s?t:u}function Iv(t,r){if(!r||Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}function LT(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function TC(t){if(!zT(t))return!1;const r=t.constructor;if(r===void 0)return!0;const n=r.prototype;return!(!zT(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function zT(t){return Object.prototype.toString.call(t)==="[object Object]"}function uG(t){return new Promise(r=>{Uf.setTimeout(r,t)})}function IC(t,r,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,r):n.structuralSharing!==!1?pL(t,r):r}function hG(t,r,n=0){const i=[...t,r];return n&&i.length>n?i.slice(1):i}function fG(t,r,n=0){const i=[r,...t];return n&&i.length>n?i.slice(0,-1):i}var AA=Symbol();function gL(t,r){return!t.queryFn&&r?.initialPromise?()=>r.initialPromise:!t.queryFn||t.queryFn===AA?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function EA(t,r){return typeof t=="function"?t(...r):!!t}function mG(t,r,n){let i=!1,a;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(a??=r(),i||(i=!0,a.aborted?n():a.addEventListener("abort",n,{once:!0})),a)}),t}var pG=class extends Qp{#e;#t;#r;constructor(){super(),this.#r=t=>{if(!rm&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},_A=new pG;function OC(){let t,r;const n=new Promise((a,s)=>{t=a,r=s});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),r(a)},n}var gG=lG;function yG(){let t=[],r=0,n=l=>{l()},i=l=>{l()},a=gG;const s=l=>{r?t.push(l):a(()=>{n(l)})},o=()=>{const l=t;t=[],l.length&&a(()=>{i(()=>{l.forEach(u=>{n(u)})})})};return{batch:l=>{let u;r++;try{u=l()}finally{r--,r||o()}return u},batchCalls:l=>(...u)=>{s(()=>{l(...u)})},schedule:s,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{i=l},setScheduler:l=>{a=l}}}var go=yG(),xG=class extends Qp{#e=!0;#t;#r;constructor(){super(),this.#r=t=>{if(!rm&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},Ov=new xG;function vG(t){return Math.min(1e3*2**t,3e4)}function yL(t){return(t??"online")==="online"?Ov.isOnline():!0}var kC=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function xL(t){let r=!1,n=0,i;const a=OC(),s=()=>a.status!=="pending",o=C=>{if(!s()){const A=new kC(C);x(A),t.onCancel?.(A)}},l=()=>{r=!0},u=()=>{r=!1},d=()=>_A.isFocused()&&(t.networkMode==="always"||Ov.isOnline())&&t.canRun(),f=()=>yL(t.networkMode)&&t.canRun(),p=C=>{s()||(i?.(),a.resolve(C))},x=C=>{s()||(i?.(),a.reject(C))},v=()=>new Promise(C=>{i=A=>{(s()||d())&&C(A)},t.onPause?.()}).then(()=>{i=void 0,s()||t.onContinue?.()}),w=()=>{if(s())return;let C;const A=n===0?t.initialPromise:void 0;try{C=A??t.fn()}catch(T){C=Promise.reject(T)}Promise.resolve(C).then(p).catch(T=>{if(s())return;const O=t.retry??(rm?0:3),D=t.retryDelay??vG,M=typeof D=="function"?D(n,T):D,Q=O===!0||typeof O=="number"&&n<O||typeof O=="function"&&O(n,T);if(r||!Q){x(T);return}n++,t.onFail?.(n,T),uG(M).then(()=>d()?void 0:v()).then(()=>{r?x(T):w()})})};return{promise:a,status:()=>a.status,cancel:o,continue:()=>(i?.(),a),cancelRetry:l,continueRetry:u,canStart:f,start:()=>(f()?w():v().then(w),a)}}var vL=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_C(this.gcTime)&&(this.#e=Uf.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(rm?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Uf.clearTimeout(this.#e),this.#e=void 0)}},bG=class extends vL{#e;#t;#r;#i;#n;#s;#o;constructor(t){super(),this.#o=!1,this.#s=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#i=t.client,this.#r=this.#i.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=FT(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(t){if(this.options={...this.#s,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=FT(this.options);r.data!==void 0&&(this.setState(BT(r.data,r.dataUpdatedAt)),this.#e=r)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(t,r){const n=IC(this.state.data,t,this.options);return this.#a({data:n,type:"success",dataUpdatedAt:r?.updatedAt,manual:r?.manual}),n}setState(t,r){this.#a({type:"setState",state:t,setStateOptions:r})}cancel(t){const r=this.#n?.promise;return this.#n?.cancel(t),r?r.then(zl).catch(zl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>Jc(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===AA||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>nf(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!mL(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(r=>r.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(r=>r.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(this.#n&&(this.#o?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(t,r){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&r?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(t&&this.setOptions(t),!this.options.queryFn){const l=this.observers.find(u=>u.options.queryFn);l&&this.setOptions(l.options)}const n=new AbortController,i=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},a=()=>{const l=gL(this.options,r),d=(()=>{const f={client:this.#i,queryKey:this.queryKey,meta:this.meta};return i(f),f})();return this.#o=!1,this.options.persister?this.options.persister(l,d,this):l(d)},o=(()=>{const l={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:a};return i(l),l})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#a({type:"fetch",meta:o.fetchOptions?.meta}),this.#n=xL({initialPromise:r?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof kC&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(l,u)=>{this.#a({type:"failed",failureCount:l,error:u})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#n.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#r.config.onSuccess?.(l,this),this.#r.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof kC){if(l.silent)return this.#n.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#a({type:"error",error:l}),this.#r.config.onError?.(l,this),this.#r.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#a(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...bL(n.data,this.options),fetchMeta:t.meta??null};case"success":const i={...n,...BT(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?i:void 0,i;case"error":const a=t.error;return{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),go.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:t})})}};function bL(t,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yL(r.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function BT(t,r){return{data:t,dataUpdatedAt:r??Date.now(),error:null,isInvalidated:!1,status:"success"}}function FT(t){const r=typeof t.initialData=="function"?t.initialData():t.initialData,n=r!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var jG=class extends Qp{constructor(t,r){super(),this.options=r,this.#e=t,this.#a=null,this.#o=OC(),this.bindMethods(),this.setOptions(r)}#e;#t=void 0;#r=void 0;#i=void 0;#n;#s;#o;#a;#p;#h;#f;#c;#d;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),qT(this.#t,this.options)?this.#u():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return DC(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return DC(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#j(),this.#t.removeObserver(this)}setOptions(t){const r=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Jc(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#t.setOptions(this.options),r._defaulted&&!Iv(this.options,r)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&UT(this.#t,n,this.options,r)&&this.#u(),this.updateResult(),i&&(this.#t!==n||Jc(this.options.enabled,this.#t)!==Jc(r.enabled,this.#t)||nf(this.options.staleTime,this.#t)!==nf(r.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||Jc(this.options.enabled,this.#t)!==Jc(r.enabled,this.#t)||a!==this.#l)&&this.#x(a)}getOptimisticResult(t){const r=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(r,t);return SG(this,n)&&(this.#i=n,this.#s=this.options,this.#n=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,r){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),r?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return this.#u({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#u(t){this.#w();let r=this.#t.fetch(this.options,t);return t?.throwOnError||(r=r.catch(zl)),r}#g(){this.#b();const t=nf(this.options.staleTime,this.#t);if(rm||this.#i.isStale||!_C(t))return;const n=mL(this.#i.dataUpdatedAt,t)+1;this.#c=Uf.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#x(t){this.#j(),this.#l=t,!(rm||Jc(this.options.enabled,this.#t)===!1||!_C(this.#l)||this.#l===0)&&(this.#d=Uf.setInterval(()=>{(this.options.refetchIntervalInBackground||_A.isFocused())&&this.#u()},this.#l))}#v(){this.#g(),this.#x(this.#y())}#b(){this.#c&&(Uf.clearTimeout(this.#c),this.#c=void 0)}#j(){this.#d&&(Uf.clearInterval(this.#d),this.#d=void 0)}createResult(t,r){const n=this.#t,i=this.options,a=this.#i,s=this.#n,o=this.#s,u=t!==n?t.state:this.#r,{state:d}=t;let f={...d},p=!1,x;if(r._optimisticResults){const ee=this.hasListeners(),F=!ee&&qT(t,r),Y=ee&&UT(t,n,r,i);(F||Y)&&(f={...f,...bL(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:v,errorUpdatedAt:w,status:C}=f;x=f.data;let A=!1;if(r.placeholderData!==void 0&&x===void 0&&C==="pending"){let ee;a?.isPlaceholderData&&r.placeholderData===o?.placeholderData?(ee=a.data,A=!0):ee=typeof r.placeholderData=="function"?r.placeholderData(this.#f?.state.data,this.#f):r.placeholderData,ee!==void 0&&(C="success",x=IC(a?.data,ee,r),p=!0)}if(r.select&&x!==void 0&&!A)if(a&&x===s?.data&&r.select===this.#p)x=this.#h;else try{this.#p=r.select,x=r.select(x),x=IC(a?.data,x,r),this.#h=x,this.#a=null}catch(ee){this.#a=ee}this.#a&&(v=this.#a,x=this.#h,w=Date.now(),C="error");const T=f.fetchStatus==="fetching",O=C==="pending",D=C==="error",M=O&&T,Q=x!==void 0,$={status:C,fetchStatus:f.fetchStatus,isPending:O,isSuccess:C==="success",isError:D,isInitialLoading:M,isLoading:M,data:x,dataUpdatedAt:f.dataUpdatedAt,error:v,errorUpdatedAt:w,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:T,isRefetching:T&&!O,isLoadingError:D&&!Q,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:D&&Q,isStale:TA(t,r),refetch:this.refetch,promise:this.#o,isEnabled:Jc(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const ee=$.data!==void 0,F=$.status==="error"&&!ee,Y=re=>{F?re.reject($.error):ee&&re.resolve($.data)},J=()=>{const re=this.#o=$.promise=OC();Y(re)},Z=this.#o;switch(Z.status){case"pending":t.queryHash===n.queryHash&&Y(Z);break;case"fulfilled":(F||$.data!==Z.value)&&J();break;case"rejected":(!F||$.error!==Z.reason)&&J();break}}return $}updateResult(){const t=this.#i,r=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#s=this.options,this.#n.data!==void 0&&(this.#f=this.#t),Iv(r,t))return;this.#i=r;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const s=new Set(a??this.#m);return this.options.throwOnError&&s.add("error"),Object.keys(this.#i).some(o=>{const l=o;return this.#i[l]!==t[l]&&s.has(l)})};this.#S({listeners:n()})}#w(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const r=this.#t;this.#t=t,this.#r=t.state,this.hasListeners()&&(r?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){go.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function wG(t,r){return Jc(r.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&r.retryOnMount===!1)}function qT(t,r){return wG(t,r)||t.state.data!==void 0&&DC(t,r,r.refetchOnMount)}function DC(t,r,n){if(Jc(r.enabled,t)!==!1&&nf(r.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&TA(t,r)}return!1}function UT(t,r,n,i){return(t!==r||Jc(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&TA(t,n)}function TA(t,r){return Jc(r.enabled,t)!==!1&&t.isStaleByTime(nf(r.staleTime,t))}function SG(t,r){return!Iv(t.getCurrentResult(),r)}function WT(t){return{onFetch:(r,n)=>{const i=r.options,a=r.fetchOptions?.meta?.fetchMore?.direction,s=r.state.data?.pages||[],o=r.state.data?.pageParams||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let f=!1;const p=w=>{mG(w,()=>r.signal,()=>f=!0)},x=gL(r.options,r.fetchOptions),v=async(w,C,A)=>{if(f)return Promise.reject();if(C==null&&w.pages.length)return Promise.resolve(w);const O=(()=>{const U={client:r.client,queryKey:r.queryKey,pageParam:C,direction:A?"backward":"forward",meta:r.options.meta};return p(U),U})(),D=await x(O),{maxPages:M}=r.options,Q=A?fG:hG;return{pages:Q(w.pages,D,M),pageParams:Q(w.pageParams,C,M)}};if(a&&s.length){const w=a==="backward",C=w?CG:HT,A={pages:s,pageParams:o},T=C(i,A);l=await v(A,T,w)}else{const w=t??s.length;do{const C=u===0?o[0]??i.initialPageParam:HT(i,l);if(u>0&&C==null)break;l=await v(l,C),u++}while(u<w)}return l};r.options.persister?r.fetchFn=()=>r.options.persister?.(d,{client:r.client,queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},n):r.fetchFn=d}}}function HT(t,{pages:r,pageParams:n}){const i=r.length-1;return r.length>0?t.getNextPageParam(r[i],r,n[i],n):void 0}function CG(t,{pages:r,pageParams:n}){return r.length>0?t.getPreviousPageParam?.(r[0],r,n[0],n):void 0}var NG=class extends vL{#e;#t;#r;#i;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#r=t.mutationCache,this.#t=[],this.state=t.state||jL(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(r=>r!==t),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(t){const r=()=>{this.#n({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=xL({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(s,o)=>{this.#n({type:"failed",failureCount:s,error:o})},onPause:()=>{this.#n({type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const i=this.state.status==="pending",a=!this.#i.canStart();try{if(i)r();else{this.#n({type:"pending",variables:t,isPaused:a}),await this.#r.config.onMutate?.(t,this,n);const o=await this.options.onMutate?.(t,n);o!==this.state.context&&this.#n({type:"pending",context:o,variables:t,isPaused:a})}const s=await this.#i.start();return await this.#r.config.onSuccess?.(s,t,this.state.context,this,n),await this.options.onSuccess?.(s,t,this.state.context,n),await this.#r.config.onSettled?.(s,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(s,null,t,this.state.context,n),this.#n({type:"success",data:s}),s}catch(s){try{await this.#r.config.onError?.(s,t,this.state.context,this,n)}catch(o){Promise.reject(o)}try{await this.options.onError?.(s,t,this.state.context,n)}catch(o){Promise.reject(o)}try{await this.#r.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this,n)}catch(o){Promise.reject(o)}try{await this.options.onSettled?.(void 0,s,t,this.state.context,n)}catch(o){Promise.reject(o)}throw this.#n({type:"error",error:s}),s}finally{this.#r.runNext(this)}}#n(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),go.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(t)}),this.#r.notify({mutation:this,type:"updated",action:t})})}};function jL(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var AG=class extends Qp{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(t,r,n){const i=new NG({client:t,mutationCache:this,mutationId:++this.#r,options:t.defaultMutationOptions(r),state:n});return this.add(i),i}add(t){this.#e.add(t);const r=zx(t);if(typeof r=="string"){const n=this.#t.get(r);n?n.push(t):this.#t.set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const r=zx(t);if(typeof r=="string"){const n=this.#t.get(r);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=zx(t);if(typeof r=="string"){const i=this.#t.get(r)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const r=zx(t);return typeof r=="string"?this.#t.get(r)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){go.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const r={exact:!0,...t};return this.getAll().find(n=>MT(r,n))}findAll(t={}){return this.getAll().filter(r=>MT(t,r))}notify(t){go.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return go.batch(()=>Promise.all(t.map(r=>r.continue().catch(zl))))}};function zx(t){return t.options.scope?.id}var EG=class extends Qp{#e;#t=void 0;#r;#i;constructor(r,n){super(),this.#e=r,this.setOptions(n),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){const n=this.options;this.options=this.#e.defaultMutationOptions(r),Iv(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),n?.mutationKey&&this.options.mutationKey&&nm(n.mutationKey)!==nm(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(r){this.#n(),this.#s(r)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#s()}mutate(r,n){return this.#i=n,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(r)}#n(){const r=this.#r?.state??jL();this.#t={...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset}}#s(r){go.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(r?.type==="success"){try{this.#i.onSuccess?.(r.data,n,i,a)}catch(s){Promise.reject(s)}try{this.#i.onSettled?.(r.data,null,n,i,a)}catch(s){Promise.reject(s)}}else if(r?.type==="error"){try{this.#i.onError?.(r.error,n,i,a)}catch(s){Promise.reject(s)}try{this.#i.onSettled?.(void 0,r.error,n,i,a)}catch(s){Promise.reject(s)}}}this.listeners.forEach(n=>{n(this.#t)})})}},_G=class extends Qp{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,r,n){const i=r.queryKey,a=r.queryHash??NA(i,r);let s=this.get(a);return s||(s=new bG({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(s)),s}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=this.#e.get(t.queryHash);r&&(t.destroy(),r===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){go.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>RT(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>RT(t,n)):r}notify(t){go.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){go.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){go.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},TG=class{#e;#t;#r;#i;#n;#s;#o;#a;constructor(t={}){this.#e=t.queryCache||new _G,this.#t=t.mutationCache||new AG,this.#r=t.defaultOptions||{},this.#i=new Map,this.#n=new Map,this.#s=0}mount(){this.#s++,this.#s===1&&(this.#o=_A.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=Ov.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#s--,this.#s===0&&(this.#o?.(),this.#o=void 0,this.#a?.(),this.#a=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const r=this.defaultQueryOptions({queryKey:t});return this.#e.get(r.queryHash)?.state.data}ensureQueryData(t){const r=this.defaultQueryOptions(t),n=this.#e.build(this,r),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(nf(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:r,state:n})=>{const i=n.data;return[r,i]})}setQueryData(t,r,n){const i=this.defaultQueryOptions({queryKey:t}),s=this.#e.get(i.queryHash)?.state.data,o=cG(r,s);if(o!==void 0)return this.#e.build(this,i).setData(o,{...n,manual:!0})}setQueriesData(t,r,n){return go.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,r,n)]))}getQueryState(t){const r=this.defaultQueryOptions({queryKey:t});return this.#e.get(r.queryHash)?.state}removeQueries(t){const r=this.#e;go.batch(()=>{r.findAll(t).forEach(n=>{r.remove(n)})})}resetQueries(t,r){const n=this.#e;return go.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},r)))}cancelQueries(t,r={}){const n={revert:!0,...r},i=go.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(zl).catch(zl)}invalidateQueries(t,r={}){return go.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},r)))}refetchQueries(t,r={}){const n={...r,cancelRefetch:r.cancelRefetch??!0},i=go.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,n);return n.throwOnError||(s=s.catch(zl)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(i).then(zl)}fetchQuery(t){const r=this.defaultQueryOptions(t);r.retry===void 0&&(r.retry=!1);const n=this.#e.build(this,r);return n.isStaleByTime(nf(r.staleTime,n))?n.fetch(r):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(zl).catch(zl)}fetchInfiniteQuery(t){return t.behavior=WT(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(zl).catch(zl)}ensureInfiniteQueryData(t){return t.behavior=WT(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ov.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(t){this.#r=t}setQueryDefaults(t,r){this.#i.set(nm(t),{queryKey:t,defaultOptions:r})}getQueryDefaults(t){const r=[...this.#i.values()],n={};return r.forEach(i=>{zg(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,r){this.#n.set(nm(t),{mutationKey:t,defaultOptions:r})}getMutationDefaults(t){const r=[...this.#n.values()],n={};return r.forEach(i=>{zg(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const r={...this.#r.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return r.queryHash||(r.queryHash=NA(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.queryFn===AA&&(r.enabled=!1),r}defaultMutationOptions(t){return t?._defaulted?t:{...this.#r.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},wL=k.createContext(void 0),pr=t=>{const r=k.useContext(wL);if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},IG=({client:t,children:r})=>(k.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(wL.Provider,{value:t,children:r})),SL=k.createContext(!1),OG=()=>k.useContext(SL);SL.Provider;function kG(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var DG=k.createContext(kG()),PG=()=>k.useContext(DG),RG=(t,r,n)=>{const i=n?.state.error&&typeof t.throwOnError=="function"?EA(t.throwOnError,[n.state.error,n]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||i)&&(r.isReset()||(t.retryOnMount=!1))},MG=t=>{k.useEffect(()=>{t.clearReset()},[t])},LG=({result:t,errorResetBoundary:r,throwOnError:n,query:i,suspense:a})=>t.isError&&!r.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||EA(n,[t.error,i])),zG=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},BG=(t,r)=>t.isLoading&&t.isFetching&&!r,FG=(t,r)=>t?.suspense&&r.isPending,VT=(t,r,n)=>r.fetchOptimistic(t).catch(()=>{n.clearReset()});function qG(t,r,n){const i=OG(),a=PG(),s=pr(),o=s.defaultQueryOptions(t);s.getDefaultOptions().queries?._experimental_beforeQuery?.(o);const l=s.getQueryCache().get(o.queryHash);o._optimisticResults=i?"isRestoring":"optimistic",zG(o),RG(o,a,l),MG(a);const u=!s.getQueryCache().get(o.queryHash),[d]=k.useState(()=>new r(s,o)),f=d.getOptimisticResult(o),p=!i&&t.subscribed!==!1;if(k.useSyncExternalStore(k.useCallback(x=>{const v=p?d.subscribe(go.batchCalls(x)):zl;return d.updateResult(),v},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),k.useEffect(()=>{d.setOptions(o)},[o,d]),FG(o,f))throw VT(o,d,a);if(LG({result:f,errorResetBoundary:a,throwOnError:o.throwOnError,query:l,suspense:o.suspense}))throw f.error;return s.getDefaultOptions().queries?._experimental_afterQuery?.(o,f),o.experimental_prefetchInRender&&!rm&&BG(f,i)&&(u?VT(o,d,a):l?.promise)?.catch(zl).finally(()=>{d.updateResult()}),o.notifyOnChangeProps?f:d.trackResult(f)}function Ve(t,r){return qG(t,jG)}function ot(t,r){const n=pr(),[i]=k.useState(()=>new EG(n,t));k.useEffect(()=>{i.setOptions(t)},[i,t]);const a=k.useSyncExternalStore(k.useCallback(o=>i.subscribe(go.batchCalls(o)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),s=k.useCallback((o,l)=>{i.mutate(o,l).catch(zl)},[i]);if(a.error&&EA(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:s,mutateAsync:a.mutate}}const $T=t=>{let r;const n=new Set,i=(d,f)=>{const p=typeof d=="function"?d(r):d;if(!Object.is(p,r)){const x=r;r=f??(typeof p!="object"||p===null)?p:Object.assign({},r,p),n.forEach(v=>v(r,x))}},a=()=>r,l={setState:i,getState:a,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=r=t(i,a,l);return l},UG=(t=>t?$T(t):$T),WG=t=>t;function HG(t,r=WG){const n=qf.useSyncExternalStore(t.subscribe,qf.useCallback(()=>r(t.getState()),[t,r]),qf.useCallback(()=>r(t.getInitialState()),[t,r]));return qf.useDebugValue(n),n}const GT=t=>{const r=UG(t),n=i=>HG(r,i);return Object.assign(n,r),n},dy=(t=>t?GT(t):GT);function CL(t,r){return function(){return t.apply(r,arguments)}}const{toString:VG}=Object.prototype,{getPrototypeOf:IA}=Object,{iterator:Qb,toStringTag:NL}=Symbol,Yb=(t=>r=>{const n=VG.call(r);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Id=t=>(t=t.toLowerCase(),r=>Yb(r)===t),Zb=t=>r=>typeof r===t,{isArray:Yp}=Array,Rp=Zb("undefined");function uy(t){return t!==null&&!Rp(t)&&t.constructor!==null&&!Rp(t.constructor)&&sc(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const AL=Id("ArrayBuffer");function $G(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&AL(t.buffer),r}const GG=Zb("string"),sc=Zb("function"),EL=Zb("number"),hy=t=>t!==null&&typeof t=="object",KG=t=>t===!0||t===!1,dv=t=>{if(Yb(t)!=="object")return!1;const r=IA(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(NL in t)&&!(Qb in t)},QG=t=>{if(!hy(t)||uy(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},YG=Id("Date"),ZG=Id("File"),XG=Id("Blob"),JG=Id("FileList"),eK=t=>hy(t)&&sc(t.pipe),tK=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||sc(t.append)&&((r=Yb(t))==="formdata"||r==="object"&&sc(t.toString)&&t.toString()==="[object FormData]"))},rK=Id("URLSearchParams"),[nK,iK,aK,sK]=["ReadableStream","Request","Response","Headers"].map(Id),oK=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fy(t,r,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let i,a;if(typeof t!="object"&&(t=[t]),Yp(t))for(i=0,a=t.length;i<a;i++)r.call(null,t[i],i,t);else{if(uy(t))return;const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let l;for(i=0;i<o;i++)l=s[i],r.call(null,t[l],l,t)}}function _L(t,r){if(uy(t))return null;r=r.toLowerCase();const n=Object.keys(t);let i=n.length,a;for(;i-- >0;)if(a=n[i],r===a.toLowerCase())return a;return null}const Wf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,TL=t=>!Rp(t)&&t!==Wf;function PC(){const{caseless:t,skipUndefined:r}=TL(this)&&this||{},n={},i=(a,s)=>{const o=t&&_L(n,s)||s;dv(n[o])&&dv(a)?n[o]=PC(n[o],a):dv(a)?n[o]=PC({},a):Yp(a)?n[o]=a.slice():(!r||!Rp(a))&&(n[o]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&fy(arguments[a],i);return n}const lK=(t,r,n,{allOwnKeys:i}={})=>(fy(r,(a,s)=>{n&&sc(a)?t[s]=CL(a,n):t[s]=a},{allOwnKeys:i}),t),cK=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),dK=(t,r,n,i)=>{t.prototype=Object.create(r.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),n&&Object.assign(t.prototype,n)},uK=(t,r,n,i)=>{let a,s,o;const l={};if(r=r||{},t==null)return r;do{for(a=Object.getOwnPropertyNames(t),s=a.length;s-- >0;)o=a[s],(!i||i(o,t,r))&&!l[o]&&(r[o]=t[o],l[o]=!0);t=n!==!1&&IA(t)}while(t&&(!n||n(t,r))&&t!==Object.prototype);return r},hK=(t,r,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=r.length;const i=t.indexOf(r,n);return i!==-1&&i===n},fK=t=>{if(!t)return null;if(Yp(t))return t;let r=t.length;if(!EL(r))return null;const n=new Array(r);for(;r-- >0;)n[r]=t[r];return n},mK=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&IA(Uint8Array)),pK=(t,r)=>{const i=(t&&t[Qb]).call(t);let a;for(;(a=i.next())&&!a.done;){const s=a.value;r.call(t,s[0],s[1])}},gK=(t,r)=>{let n;const i=[];for(;(n=t.exec(r))!==null;)i.push(n);return i},yK=Id("HTMLFormElement"),xK=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,a){return i.toUpperCase()+a}),KT=(({hasOwnProperty:t})=>(r,n)=>t.call(r,n))(Object.prototype),vK=Id("RegExp"),IL=(t,r)=>{const n=Object.getOwnPropertyDescriptors(t),i={};fy(n,(a,s)=>{let o;(o=r(a,s,t))!==!1&&(i[s]=o||a)}),Object.defineProperties(t,i)},bK=t=>{IL(t,(r,n)=>{if(sc(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=t[n];if(sc(i)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},jK=(t,r)=>{const n={},i=a=>{a.forEach(s=>{n[s]=!0})};return Yp(t)?i(t):i(String(t).split(r)),n},wK=()=>{},SK=(t,r)=>t!=null&&Number.isFinite(t=+t)?t:r;function CK(t){return!!(t&&sc(t.append)&&t[NL]==="FormData"&&t[Qb])}const NK=t=>{const r=new Array(10),n=(i,a)=>{if(hy(i)){if(r.indexOf(i)>=0)return;if(uy(i))return i;if(!("toJSON"in i)){r[a]=i;const s=Yp(i)?[]:{};return fy(i,(o,l)=>{const u=n(o,a+1);!Rp(u)&&(s[l]=u)}),r[a]=void 0,s}}return i};return n(t,0)},AK=Id("AsyncFunction"),EK=t=>t&&(hy(t)||sc(t))&&sc(t.then)&&sc(t.catch),OL=((t,r)=>t?setImmediate:r?((n,i)=>(Wf.addEventListener("message",({source:a,data:s})=>{a===Wf&&s===n&&i.length&&i.shift()()},!1),a=>{i.push(a),Wf.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",sc(Wf.postMessage)),_K=typeof queueMicrotask<"u"?queueMicrotask.bind(Wf):typeof process<"u"&&process.nextTick||OL,TK=t=>t!=null&&sc(t[Qb]),bt={isArray:Yp,isArrayBuffer:AL,isBuffer:uy,isFormData:tK,isArrayBufferView:$G,isString:GG,isNumber:EL,isBoolean:KG,isObject:hy,isPlainObject:dv,isEmptyObject:QG,isReadableStream:nK,isRequest:iK,isResponse:aK,isHeaders:sK,isUndefined:Rp,isDate:YG,isFile:ZG,isBlob:XG,isRegExp:vK,isFunction:sc,isStream:eK,isURLSearchParams:rK,isTypedArray:mK,isFileList:JG,forEach:fy,merge:PC,extend:lK,trim:oK,stripBOM:cK,inherits:dK,toFlatObject:uK,kindOf:Yb,kindOfTest:Id,endsWith:hK,toArray:fK,forEachEntry:pK,matchAll:gK,isHTMLForm:yK,hasOwnProperty:KT,hasOwnProp:KT,reduceDescriptors:IL,freezeMethods:bK,toObjectSet:jK,toCamelCase:xK,noop:wK,toFiniteNumber:SK,findKey:_L,global:Wf,isContextDefined:TL,isSpecCompliantForm:CK,toJSONObject:NK,isAsyncFn:AK,isThenable:EK,setImmediate:OL,asap:_K,isIterable:TK};function En(t,r,n,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),n&&(this.config=n),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}bt.inherits(En,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:bt.toJSONObject(this.config),code:this.code,status:this.status}}});const kL=En.prototype,DL={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{DL[t]={value:t}});Object.defineProperties(En,DL);Object.defineProperty(kL,"isAxiosError",{value:!0});En.from=(t,r,n,i,a,s)=>{const o=Object.create(kL);bt.toFlatObject(t,o,function(f){return f!==Error.prototype},d=>d!=="isAxiosError");const l=t&&t.message?t.message:"Error",u=r==null&&t?t.code:r;return En.call(o,l,u,n,i,a),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",s&&Object.assign(o,s),o};const IK=null;function RC(t){return bt.isPlainObject(t)||bt.isArray(t)}function PL(t){return bt.endsWith(t,"[]")?t.slice(0,-2):t}function QT(t,r,n){return t?t.concat(r).map(function(a,s){return a=PL(a),!n&&s?"["+a+"]":a}).join(n?".":""):r}function OK(t){return bt.isArray(t)&&!t.some(RC)}const kK=bt.toFlatObject(bt,{},null,function(r){return/^is[A-Z]/.test(r)});function Xb(t,r,n){if(!bt.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,n=bt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,A){return!bt.isUndefined(A[C])});const i=n.metaTokens,a=n.visitor||f,s=n.dots,o=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&bt.isSpecCompliantForm(r);if(!bt.isFunction(a))throw new TypeError("visitor must be a function");function d(w){if(w===null)return"";if(bt.isDate(w))return w.toISOString();if(bt.isBoolean(w))return w.toString();if(!u&&bt.isBlob(w))throw new En("Blob is not supported. Use a Buffer instead.");return bt.isArrayBuffer(w)||bt.isTypedArray(w)?u&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function f(w,C,A){let T=w;if(w&&!A&&typeof w=="object"){if(bt.endsWith(C,"{}"))C=i?C:C.slice(0,-2),w=JSON.stringify(w);else if(bt.isArray(w)&&OK(w)||(bt.isFileList(w)||bt.endsWith(C,"[]"))&&(T=bt.toArray(w)))return C=PL(C),T.forEach(function(D,M){!(bt.isUndefined(D)||D===null)&&r.append(o===!0?QT([C],M,s):o===null?C:C+"[]",d(D))}),!1}return RC(w)?!0:(r.append(QT(A,C,s),d(w)),!1)}const p=[],x=Object.assign(kK,{defaultVisitor:f,convertValue:d,isVisitable:RC});function v(w,C){if(!bt.isUndefined(w)){if(p.indexOf(w)!==-1)throw Error("Circular reference detected in "+C.join("."));p.push(w),bt.forEach(w,function(T,O){(!(bt.isUndefined(T)||T===null)&&a.call(r,T,bt.isString(O)?O.trim():O,C,x))===!0&&v(T,C?C.concat(O):[O])}),p.pop()}}if(!bt.isObject(t))throw new TypeError("data must be an object");return v(t),r}function YT(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return r[i]})}function OA(t,r){this._pairs=[],t&&Xb(t,this,r)}const RL=OA.prototype;RL.append=function(r,n){this._pairs.push([r,n])};RL.toString=function(r){const n=r?function(i){return r.call(this,i,YT)}:YT;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function DK(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ML(t,r,n){if(!r)return t;const i=n&&n.encode||DK;bt.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let s;if(a?s=a(r,n):s=bt.isURLSearchParams(r)?r.toString():new OA(r,n).toString(i),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class ZT{constructor(){this.handlers=[]}use(r,n,i){return this.handlers.push({fulfilled:r,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){bt.forEach(this.handlers,function(i){i!==null&&r(i)})}}const LL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PK=typeof URLSearchParams<"u"?URLSearchParams:OA,RK=typeof FormData<"u"?FormData:null,MK=typeof Blob<"u"?Blob:null,LK={isBrowser:!0,classes:{URLSearchParams:PK,FormData:RK,Blob:MK},protocols:["http","https","file","blob","url","data"]},kA=typeof window<"u"&&typeof document<"u",MC=typeof navigator=="object"&&navigator||void 0,zK=kA&&(!MC||["ReactNative","NativeScript","NS"].indexOf(MC.product)<0),BK=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",FK=kA&&window.location.href||"http://localhost",qK=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:kA,hasStandardBrowserEnv:zK,hasStandardBrowserWebWorkerEnv:BK,navigator:MC,origin:FK},Symbol.toStringTag,{value:"Module"})),El={...qK,...LK};function UK(t,r){return Xb(t,new El.classes.URLSearchParams,{visitor:function(n,i,a,s){return El.isNode&&bt.isBuffer(n)?(this.append(i,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...r})}function WK(t){return bt.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function HK(t){const r={},n=Object.keys(t);let i;const a=n.length;let s;for(i=0;i<a;i++)s=n[i],r[s]=t[s];return r}function zL(t){function r(n,i,a,s){let o=n[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=s>=n.length;return o=!o&&bt.isArray(a)?a.length:o,u?(bt.hasOwnProp(a,o)?a[o]=[a[o],i]:a[o]=i,!l):((!a[o]||!bt.isObject(a[o]))&&(a[o]=[]),r(n,i,a[o],s)&&bt.isArray(a[o])&&(a[o]=HK(a[o])),!l)}if(bt.isFormData(t)&&bt.isFunction(t.entries)){const n={};return bt.forEachEntry(t,(i,a)=>{r(WK(i),a,n,0)}),n}return null}function VK(t,r,n){if(bt.isString(t))try{return(r||JSON.parse)(t),bt.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(t)}const my={transitional:LL,adapter:["xhr","http","fetch"],transformRequest:[function(r,n){const i=n.getContentType()||"",a=i.indexOf("application/json")>-1,s=bt.isObject(r);if(s&&bt.isHTMLForm(r)&&(r=new FormData(r)),bt.isFormData(r))return a?JSON.stringify(zL(r)):r;if(bt.isArrayBuffer(r)||bt.isBuffer(r)||bt.isStream(r)||bt.isFile(r)||bt.isBlob(r)||bt.isReadableStream(r))return r;if(bt.isArrayBufferView(r))return r.buffer;if(bt.isURLSearchParams(r))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let l;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return UK(r,this.formSerializer).toString();if((l=bt.isFileList(r))||i.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Xb(l?{"files[]":r}:r,u&&new u,this.formSerializer)}}return s||a?(n.setContentType("application/json",!1),VK(r)):r}],transformResponse:[function(r){const n=this.transitional||my.transitional,i=n&&n.forcedJSONParsing,a=this.responseType==="json";if(bt.isResponse(r)||bt.isReadableStream(r))return r;if(r&&bt.isString(r)&&(i&&!this.responseType||a)){const o=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(r,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?En.from(l,En.ERR_BAD_RESPONSE,this,null,this.response):l}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:El.classes.FormData,Blob:El.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};bt.forEach(["delete","get","head","post","put","patch"],t=>{my.headers[t]={}});const $K=bt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),GK=t=>{const r={};let n,i,a;return t&&t.split(`
`).forEach(function(o){a=o.indexOf(":"),n=o.substring(0,a).trim().toLowerCase(),i=o.substring(a+1).trim(),!(!n||r[n]&&$K[n])&&(n==="set-cookie"?r[n]?r[n].push(i):r[n]=[i]:r[n]=r[n]?r[n]+", "+i:i)}),r},XT=Symbol("internals");function Z0(t){return t&&String(t).trim().toLowerCase()}function uv(t){return t===!1||t==null?t:bt.isArray(t)?t.map(uv):String(t)}function KK(t){const r=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)r[i[1]]=i[2];return r}const QK=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function E5(t,r,n,i,a){if(bt.isFunction(i))return i.call(this,r,n);if(a&&(r=n),!!bt.isString(r)){if(bt.isString(i))return r.indexOf(i)!==-1;if(bt.isRegExp(i))return i.test(r)}}function YK(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,n,i)=>n.toUpperCase()+i)}function ZK(t,r){const n=bt.toCamelCase(" "+r);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(a,s,o){return this[i].call(this,r,a,s,o)},configurable:!0})})}let oc=class{constructor(r){r&&this.set(r)}set(r,n,i){const a=this;function s(l,u,d){const f=Z0(u);if(!f)throw new Error("header name must be a non-empty string");const p=bt.findKey(a,f);(!p||a[p]===void 0||d===!0||d===void 0&&a[p]!==!1)&&(a[p||u]=uv(l))}const o=(l,u)=>bt.forEach(l,(d,f)=>s(d,f,u));if(bt.isPlainObject(r)||r instanceof this.constructor)o(r,n);else if(bt.isString(r)&&(r=r.trim())&&!QK(r))o(GK(r),n);else if(bt.isObject(r)&&bt.isIterable(r)){let l={},u,d;for(const f of r){if(!bt.isArray(f))throw TypeError("Object iterator must return a key-value pair");l[d=f[0]]=(u=l[d])?bt.isArray(u)?[...u,f[1]]:[u,f[1]]:f[1]}o(l,n)}else r!=null&&s(n,r,i);return this}get(r,n){if(r=Z0(r),r){const i=bt.findKey(this,r);if(i){const a=this[i];if(!n)return a;if(n===!0)return KK(a);if(bt.isFunction(n))return n.call(this,a,i);if(bt.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,n){if(r=Z0(r),r){const i=bt.findKey(this,r);return!!(i&&this[i]!==void 0&&(!n||E5(this,this[i],i,n)))}return!1}delete(r,n){const i=this;let a=!1;function s(o){if(o=Z0(o),o){const l=bt.findKey(i,o);l&&(!n||E5(i,i[l],l,n))&&(delete i[l],a=!0)}}return bt.isArray(r)?r.forEach(s):s(r),a}clear(r){const n=Object.keys(this);let i=n.length,a=!1;for(;i--;){const s=n[i];(!r||E5(this,this[s],s,r,!0))&&(delete this[s],a=!0)}return a}normalize(r){const n=this,i={};return bt.forEach(this,(a,s)=>{const o=bt.findKey(i,s);if(o){n[o]=uv(a),delete n[s];return}const l=r?YK(s):String(s).trim();l!==s&&delete n[s],n[l]=uv(a),i[l]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const n=Object.create(null);return bt.forEach(this,(i,a)=>{i!=null&&i!==!1&&(n[a]=r&&bt.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,n])=>r+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...n){const i=new this(r);return n.forEach(a=>i.set(a)),i}static accessor(r){const i=(this[XT]=this[XT]={accessors:{}}).accessors,a=this.prototype;function s(o){const l=Z0(o);i[l]||(ZK(a,o),i[l]=!0)}return bt.isArray(r)?r.forEach(s):s(r),this}};oc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);bt.reduceDescriptors(oc.prototype,({value:t},r)=>{let n=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(i){this[n]=i}}});bt.freezeMethods(oc);function _5(t,r){const n=this||my,i=r||n,a=oc.from(i.headers);let s=i.data;return bt.forEach(t,function(l){s=l.call(n,s,a.normalize(),r?r.status:void 0)}),a.normalize(),s}function BL(t){return!!(t&&t.__CANCEL__)}function Zp(t,r,n){En.call(this,t??"canceled",En.ERR_CANCELED,r,n),this.name="CanceledError"}bt.inherits(Zp,En,{__CANCEL__:!0});function FL(t,r,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):r(new En("Request failed with status code "+n.status,[En.ERR_BAD_REQUEST,En.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function XK(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function JK(t,r){t=t||10;const n=new Array(t),i=new Array(t);let a=0,s=0,o;return r=r!==void 0?r:1e3,function(u){const d=Date.now(),f=i[s];o||(o=d),n[a]=u,i[a]=d;let p=s,x=0;for(;p!==a;)x+=n[p++],p=p%t;if(a=(a+1)%t,a===s&&(s=(s+1)%t),d-o<r)return;const v=f&&d-f;return v?Math.round(x*1e3/v):void 0}}function eQ(t,r){let n=0,i=1e3/r,a,s;const o=(d,f=Date.now())=>{n=f,a=null,s&&(clearTimeout(s),s=null),t(...d)};return[(...d)=>{const f=Date.now(),p=f-n;p>=i?o(d,f):(a=d,s||(s=setTimeout(()=>{s=null,o(a)},i-p)))},()=>a&&o(a)]}const kv=(t,r,n=3)=>{let i=0;const a=JK(50,250);return eQ(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,u=o-i,d=a(u),f=o<=l;i=o;const p={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:d||void 0,estimated:d&&l&&f?(l-o)/d:void 0,event:s,lengthComputable:l!=null,[r?"download":"upload"]:!0};t(p)},n)},JT=(t,r)=>{const n=t!=null;return[i=>r[0]({lengthComputable:n,total:t,loaded:i}),r[1]]},e8=t=>(...r)=>bt.asap(()=>t(...r)),tQ=El.hasStandardBrowserEnv?((t,r)=>n=>(n=new URL(n,El.origin),t.protocol===n.protocol&&t.host===n.host&&(r||t.port===n.port)))(new URL(El.origin),El.navigator&&/(msie|trident)/i.test(El.navigator.userAgent)):()=>!0,rQ=El.hasStandardBrowserEnv?{write(t,r,n,i,a,s,o){if(typeof document>"u")return;const l=[`${t}=${encodeURIComponent(r)}`];bt.isNumber(n)&&l.push(`expires=${new Date(n).toUTCString()}`),bt.isString(i)&&l.push(`path=${i}`),bt.isString(a)&&l.push(`domain=${a}`),s===!0&&l.push("secure"),bt.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(t){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function nQ(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function iQ(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function qL(t,r,n){let i=!nQ(r);return t&&(i||n==!1)?iQ(t,r):r}const t8=t=>t instanceof oc?{...t}:t;function im(t,r){r=r||{};const n={};function i(d,f,p,x){return bt.isPlainObject(d)&&bt.isPlainObject(f)?bt.merge.call({caseless:x},d,f):bt.isPlainObject(f)?bt.merge({},f):bt.isArray(f)?f.slice():f}function a(d,f,p,x){if(bt.isUndefined(f)){if(!bt.isUndefined(d))return i(void 0,d,p,x)}else return i(d,f,p,x)}function s(d,f){if(!bt.isUndefined(f))return i(void 0,f)}function o(d,f){if(bt.isUndefined(f)){if(!bt.isUndefined(d))return i(void 0,d)}else return i(void 0,f)}function l(d,f,p){if(p in r)return i(d,f);if(p in t)return i(void 0,d)}const u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,f,p)=>a(t8(d),t8(f),p,!0)};return bt.forEach(Object.keys({...t,...r}),function(f){const p=u[f]||a,x=p(t[f],r[f],f);bt.isUndefined(x)&&p!==l||(n[f]=x)}),n}const UL=t=>{const r=im({},t);let{data:n,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:s,headers:o,auth:l}=r;if(r.headers=o=oc.from(o),r.url=ML(qL(r.baseURL,r.url,r.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),bt.isFormData(n)){if(El.hasStandardBrowserEnv||El.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(bt.isFunction(n.getHeaders)){const u=n.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([f,p])=>{d.includes(f.toLowerCase())&&o.set(f,p)})}}if(El.hasStandardBrowserEnv&&(i&&bt.isFunction(i)&&(i=i(r)),i||i!==!1&&tQ(r.url))){const u=a&&s&&rQ.read(s);u&&o.set(a,u)}return r},aQ=typeof XMLHttpRequest<"u",sQ=aQ&&function(t){return new Promise(function(n,i){const a=UL(t);let s=a.data;const o=oc.from(a.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:d}=a,f,p,x,v,w;function C(){v&&v(),w&&w(),a.cancelToken&&a.cancelToken.unsubscribe(f),a.signal&&a.signal.removeEventListener("abort",f)}let A=new XMLHttpRequest;A.open(a.method.toUpperCase(),a.url,!0),A.timeout=a.timeout;function T(){if(!A)return;const D=oc.from("getAllResponseHeaders"in A&&A.getAllResponseHeaders()),Q={data:!l||l==="text"||l==="json"?A.responseText:A.response,status:A.status,statusText:A.statusText,headers:D,config:t,request:A};FL(function($){n($),C()},function($){i($),C()},Q),A=null}"onloadend"in A?A.onloadend=T:A.onreadystatechange=function(){!A||A.readyState!==4||A.status===0&&!(A.responseURL&&A.responseURL.indexOf("file:")===0)||setTimeout(T)},A.onabort=function(){A&&(i(new En("Request aborted",En.ECONNABORTED,t,A)),A=null)},A.onerror=function(M){const Q=M&&M.message?M.message:"Network Error",U=new En(Q,En.ERR_NETWORK,t,A);U.event=M||null,i(U),A=null},A.ontimeout=function(){let M=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const Q=a.transitional||LL;a.timeoutErrorMessage&&(M=a.timeoutErrorMessage),i(new En(M,Q.clarifyTimeoutError?En.ETIMEDOUT:En.ECONNABORTED,t,A)),A=null},s===void 0&&o.setContentType(null),"setRequestHeader"in A&&bt.forEach(o.toJSON(),function(M,Q){A.setRequestHeader(Q,M)}),bt.isUndefined(a.withCredentials)||(A.withCredentials=!!a.withCredentials),l&&l!=="json"&&(A.responseType=a.responseType),d&&([x,w]=kv(d,!0),A.addEventListener("progress",x)),u&&A.upload&&([p,v]=kv(u),A.upload.addEventListener("progress",p),A.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(f=D=>{A&&(i(!D||D.type?new Zp(null,t,A):D),A.abort(),A=null)},a.cancelToken&&a.cancelToken.subscribe(f),a.signal&&(a.signal.aborted?f():a.signal.addEventListener("abort",f)));const O=XK(a.url);if(O&&El.protocols.indexOf(O)===-1){i(new En("Unsupported protocol "+O+":",En.ERR_BAD_REQUEST,t));return}A.send(s||null)})},oQ=(t,r)=>{const{length:n}=t=t?t.filter(Boolean):[];if(r||n){let i=new AbortController,a;const s=function(d){if(!a){a=!0,l();const f=d instanceof Error?d:this.reason;i.abort(f instanceof En?f:new Zp(f instanceof Error?f.message:f))}};let o=r&&setTimeout(()=>{o=null,s(new En(`timeout ${r} of ms exceeded`,En.ETIMEDOUT))},r);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),t=null)};t.forEach(d=>d.addEventListener("abort",s));const{signal:u}=i;return u.unsubscribe=()=>bt.asap(l),u}},lQ=function*(t,r){let n=t.byteLength;if(n<r){yield t;return}let i=0,a;for(;i<n;)a=i+r,yield t.slice(i,a),i=a},cQ=async function*(t,r){for await(const n of dQ(t))yield*lQ(n,r)},dQ=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const r=t.getReader();try{for(;;){const{done:n,value:i}=await r.read();if(n)break;yield i}}finally{await r.cancel()}},r8=(t,r,n,i)=>{const a=cQ(t,r);let s=0,o,l=u=>{o||(o=!0,i&&i(u))};return new ReadableStream({async pull(u){try{const{done:d,value:f}=await a.next();if(d){l(),u.close();return}let p=f.byteLength;if(n){let x=s+=p;n(x)}u.enqueue(new Uint8Array(f))}catch(d){throw l(d),d}},cancel(u){return l(u),a.return()}},{highWaterMark:2})},n8=64*1024,{isFunction:Bx}=bt,uQ=(({Request:t,Response:r})=>({Request:t,Response:r}))(bt.global),{ReadableStream:i8,TextEncoder:a8}=bt.global,s8=(t,...r)=>{try{return!!t(...r)}catch{return!1}},hQ=t=>{t=bt.merge.call({skipUndefined:!0},uQ,t);const{fetch:r,Request:n,Response:i}=t,a=r?Bx(r):typeof fetch=="function",s=Bx(n),o=Bx(i);if(!a)return!1;const l=a&&Bx(i8),u=a&&(typeof a8=="function"?(w=>C=>w.encode(C))(new a8):async w=>new Uint8Array(await new n(w).arrayBuffer())),d=s&&l&&s8(()=>{let w=!1;const C=new n(El.origin,{body:new i8,method:"POST",get duplex(){return w=!0,"half"}}).headers.has("Content-Type");return w&&!C}),f=o&&l&&s8(()=>bt.isReadableStream(new i("").body)),p={stream:f&&(w=>w.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(w=>{!p[w]&&(p[w]=(C,A)=>{let T=C&&C[w];if(T)return T.call(C);throw new En(`Response type '${w}' is not supported`,En.ERR_NOT_SUPPORT,A)})});const x=async w=>{if(w==null)return 0;if(bt.isBlob(w))return w.size;if(bt.isSpecCompliantForm(w))return(await new n(El.origin,{method:"POST",body:w}).arrayBuffer()).byteLength;if(bt.isArrayBufferView(w)||bt.isArrayBuffer(w))return w.byteLength;if(bt.isURLSearchParams(w)&&(w=w+""),bt.isString(w))return(await u(w)).byteLength},v=async(w,C)=>{const A=bt.toFiniteNumber(w.getContentLength());return A??x(C)};return async w=>{let{url:C,method:A,data:T,signal:O,cancelToken:D,timeout:M,onDownloadProgress:Q,onUploadProgress:U,responseType:$,headers:ee,withCredentials:F="same-origin",fetchOptions:Y}=UL(w),J=r||fetch;$=$?($+"").toLowerCase():"text";let Z=oQ([O,D&&D.toAbortSignal()],M),re=null;const de=Z&&Z.unsubscribe&&(()=>{Z.unsubscribe()});let le;try{if(U&&d&&A!=="get"&&A!=="head"&&(le=await v(ee,T))!==0){let V=new n(C,{method:"POST",body:T,duplex:"half"}),X;if(bt.isFormData(T)&&(X=V.headers.get("content-type"))&&ee.setContentType(X),V.body){const[se,W]=JT(le,kv(e8(U)));T=r8(V.body,n8,se,W)}}bt.isString(F)||(F=F?"include":"omit");const K=s&&"credentials"in n.prototype,ue={...Y,signal:Z,method:A.toUpperCase(),headers:ee.normalize().toJSON(),body:T,duplex:"half",credentials:K?F:void 0};re=s&&new n(C,ue);let ce=await(s?J(re,Y):J(C,ue));const ye=f&&($==="stream"||$==="response");if(f&&(Q||ye&&de)){const V={};["status","statusText","headers"].forEach(oe=>{V[oe]=ce[oe]});const X=bt.toFiniteNumber(ce.headers.get("content-length")),[se,W]=Q&&JT(X,kv(e8(Q),!0))||[];ce=new i(r8(ce.body,n8,se,()=>{W&&W(),de&&de()}),V)}$=$||"text";let Se=await p[bt.findKey(p,$)||"text"](ce,w);return!ye&&de&&de(),await new Promise((V,X)=>{FL(V,X,{data:Se,headers:oc.from(ce.headers),status:ce.status,statusText:ce.statusText,config:w,request:re})})}catch(K){throw de&&de(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new En("Network Error",En.ERR_NETWORK,w,re),{cause:K.cause||K}):En.from(K,K&&K.code,w,re)}}},fQ=new Map,WL=t=>{let r=t&&t.env||{};const{fetch:n,Request:i,Response:a}=r,s=[i,a,n];let o=s.length,l=o,u,d,f=fQ;for(;l--;)u=s[l],d=f.get(u),d===void 0&&f.set(u,d=l?new Map:hQ(r)),f=d;return d};WL();const DA={http:IK,xhr:sQ,fetch:{get:WL}};bt.forEach(DA,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const o8=t=>`- ${t}`,mQ=t=>bt.isFunction(t)||t===null||t===!1;function pQ(t,r){t=bt.isArray(t)?t:[t];const{length:n}=t;let i,a;const s={};for(let o=0;o<n;o++){i=t[o];let l;if(a=i,!mQ(i)&&(a=DA[(l=String(i)).toLowerCase()],a===void 0))throw new En(`Unknown adapter '${l}'`);if(a&&(bt.isFunction(a)||(a=a.get(r))))break;s[l||"#"+o]=a}if(!a){const o=Object.entries(s).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(o8).join(`
`):" "+o8(o[0]):"as no adapter specified";throw new En("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a}const HL={getAdapter:pQ,adapters:DA};function T5(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Zp(null,t)}function l8(t){return T5(t),t.headers=oc.from(t.headers),t.data=_5.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),HL.getAdapter(t.adapter||my.adapter,t)(t).then(function(i){return T5(t),i.data=_5.call(t,t.transformResponse,i),i.headers=oc.from(i.headers),i},function(i){return BL(i)||(T5(t),i&&i.response&&(i.response.data=_5.call(t,t.transformResponse,i.response),i.response.headers=oc.from(i.response.headers))),Promise.reject(i)})}const VL="1.13.2",Jb={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{Jb[t]=function(i){return typeof i===t||"a"+(r<1?"n ":" ")+t}});const c8={};Jb.transitional=function(r,n,i){function a(s,o){return"[Axios v"+VL+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,l)=>{if(r===!1)throw new En(a(o," has been removed"+(n?" in "+n:"")),En.ERR_DEPRECATED);return n&&!c8[o]&&(c8[o]=!0,console.warn(a(o," has been deprecated since v"+n+" and will be removed in the near future"))),r?r(s,o,l):!0}};Jb.spelling=function(r){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${r}`),!0)};function gQ(t,r,n){if(typeof t!="object")throw new En("options must be an object",En.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let a=i.length;for(;a-- >0;){const s=i[a],o=r[s];if(o){const l=t[s],u=l===void 0||o(l,s,t);if(u!==!0)throw new En("option "+s+" must be "+u,En.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new En("Unknown option "+s,En.ERR_BAD_OPTION)}}const hv={assertOptions:gQ,validators:Jb},Yd=hv.validators;let Qf=class{constructor(r){this.defaults=r||{},this.interceptors={request:new ZT,response:new ZT}}async request(r,n){try{return await this._request(r,n)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(r,n){typeof r=="string"?(n=n||{},n.url=r):n=r||{},n=im(this.defaults,n);const{transitional:i,paramsSerializer:a,headers:s}=n;i!==void 0&&hv.assertOptions(i,{silentJSONParsing:Yd.transitional(Yd.boolean),forcedJSONParsing:Yd.transitional(Yd.boolean),clarifyTimeoutError:Yd.transitional(Yd.boolean)},!1),a!=null&&(bt.isFunction(a)?n.paramsSerializer={serialize:a}:hv.assertOptions(a,{encode:Yd.function,serialize:Yd.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),hv.assertOptions(n,{baseUrl:Yd.spelling("baseURL"),withXsrfToken:Yd.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&bt.merge(s.common,s[n.method]);s&&bt.forEach(["delete","get","head","post","put","patch","common"],w=>{delete s[w]}),n.headers=oc.concat(o,s);const l=[];let u=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(n)===!1||(u=u&&C.synchronous,l.unshift(C.fulfilled,C.rejected))});const d=[];this.interceptors.response.forEach(function(C){d.push(C.fulfilled,C.rejected)});let f,p=0,x;if(!u){const w=[l8.bind(this),void 0];for(w.unshift(...l),w.push(...d),x=w.length,f=Promise.resolve(n);p<x;)f=f.then(w[p++],w[p++]);return f}x=l.length;let v=n;for(;p<x;){const w=l[p++],C=l[p++];try{v=w(v)}catch(A){C.call(this,A);break}}try{f=l8.call(this,v)}catch(w){return Promise.reject(w)}for(p=0,x=d.length;p<x;)f=f.then(d[p++],d[p++]);return f}getUri(r){r=im(this.defaults,r);const n=qL(r.baseURL,r.url,r.allowAbsoluteUrls);return ML(n,r.params,r.paramsSerializer)}};bt.forEach(["delete","get","head","options"],function(r){Qf.prototype[r]=function(n,i){return this.request(im(i||{},{method:r,url:n,data:(i||{}).data}))}});bt.forEach(["post","put","patch"],function(r){function n(i){return function(s,o,l){return this.request(im(l||{},{method:r,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Qf.prototype[r]=n(),Qf.prototype[r+"Form"]=n(!0)});let yQ=class $L{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const i=this;this.promise.then(a=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](a);i._listeners=null}),this.promise.then=a=>{let s;const o=new Promise(l=>{i.subscribe(l),s=l}).then(a);return o.cancel=function(){i.unsubscribe(s)},o},r(function(s,o,l){i.reason||(i.reason=new Zp(s,o,l),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const n=this._listeners.indexOf(r);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const r=new AbortController,n=i=>{r.abort(i)};return this.subscribe(n),r.signal.unsubscribe=()=>this.unsubscribe(n),r.signal}static source(){let r;return{token:new $L(function(a){r=a}),cancel:r}}};function xQ(t){return function(n){return t.apply(null,n)}}function vQ(t){return bt.isObject(t)&&t.isAxiosError===!0}const LC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(LC).forEach(([t,r])=>{LC[r]=t});function GL(t){const r=new Qf(t),n=CL(Qf.prototype.request,r);return bt.extend(n,Qf.prototype,r,{allOwnKeys:!0}),bt.extend(n,r,null,{allOwnKeys:!0}),n.create=function(a){return GL(im(t,a))},n}const _s=GL(my);_s.Axios=Qf;_s.CanceledError=Zp;_s.CancelToken=yQ;_s.isCancel=BL;_s.VERSION=VL;_s.toFormData=Xb;_s.AxiosError=En;_s.Cancel=_s.CanceledError;_s.all=function(r){return Promise.all(r)};_s.spread=xQ;_s.isAxiosError=vQ;_s.mergeConfig=im;_s.AxiosHeaders=oc;_s.formToJSON=t=>zL(bt.isHTMLForm(t)?new FormData(t):t);_s.getAdapter=HL.getAdapter;_s.HttpStatusCode=LC;_s.default=_s;const{Axios:MEe,AxiosError:LEe,CanceledError:zEe,isCancel:BEe,CancelToken:FEe,VERSION:qEe,all:UEe,Cancel:WEe,isAxiosError:HEe,spread:VEe,toFormData:$Ee,AxiosHeaders:GEe,HttpStatusCode:KEe,formToJSON:QEe,getAdapter:YEe,mergeConfig:ZEe}=_s,xe=_s.create({baseURL:"/api"});xe.interceptors.request.use(t=>{const r=localStorage.getItem("accessToken");return r&&(t.headers.Authorization=`Bearer ${r}`),t.data instanceof FormData||(t.headers["Content-Type"]="application/json"),t});xe.interceptors.response.use(t=>t,async t=>{const r=t.config;if(t.response?.status===401&&!r._retry){r._retry=!0;const n=localStorage.getItem("refreshToken");if(n)try{const{data:i}=await _s.post("/api/auth/refresh",{refreshToken:n});return localStorage.setItem("accessToken",i.accessToken),r.headers.Authorization=`Bearer ${i.accessToken}`,xe(r)}catch{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login"}else window.location.href="/login"}return Promise.reject(t)});const Il=dy((t,r)=>({user:null,isAuthenticated:!1,isLoading:!0,login:async(n,i)=>{const{data:a}=await xe.post("/auth/login",{email:n,password:i});localStorage.setItem("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken);const s=await xe.get("/auth/me");t({user:s.data,isAuthenticated:!0})},logout:async()=>{const n=localStorage.getItem("refreshToken");try{await xe.post("/auth/logout",{refreshToken:n})}catch{}localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),t({user:null,isAuthenticated:!1})},checkAuth:async()=>{if(!localStorage.getItem("accessToken")){t({isLoading:!1,isAuthenticated:!1});return}try{const{data:i}=await xe.get("/auth/me");t({user:i,isAuthenticated:!0,isLoading:!1})}catch{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),t({user:null,isAuthenticated:!1,isLoading:!1})}},hasPermission:n=>{const{user:i}=r();return i?i.role==="Admin"?!0:i.permissions.includes(n):!1},setUser:n=>{t({user:n})}}));const bQ=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jQ=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,n,i)=>i?i.toUpperCase():n.toLowerCase()),d8=t=>{const r=jQ(t);return r.charAt(0).toUpperCase()+r.slice(1)},KL=(...t)=>t.filter((r,n,i)=>!!r&&r.trim()!==""&&i.indexOf(r)===n).join(" ").trim(),wQ=t=>{for(const r in t)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};var SQ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const CQ=k.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:a="",children:s,iconNode:o,...l},u)=>k.createElement("svg",{ref:u,...SQ,width:r,height:r,stroke:t,strokeWidth:i?Number(n)*24/Number(r):n,className:KL("lucide",a),...!s&&!wQ(l)&&{"aria-hidden":"true"},...l},[...o.map(([d,f])=>k.createElement(d,f)),...Array.isArray(s)?s:[s]]));const xt=(t,r)=>{const n=k.forwardRef(({className:i,...a},s)=>k.createElement(CQ,{ref:s,iconNode:r,className:KL(`lucide-${bQ(d8(t))}`,`lucide-${t}`,i),...a}));return n.displayName=d8(t),n};const NQ=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Mc=xt("activity",NQ);const AQ=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Mp=xt("archive",AQ);const EQ=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],u8=xt("arrow-left-right",EQ);const _Q=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],sa=xt("arrow-left",_Q);const TQ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],lc=xt("arrow-right",TQ);const IQ=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z",key:"1l2ple"}],["path",{d:"M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z",key:"1wam0m"}]],ou=xt("atom",IQ);const OQ=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],kQ=xt("award",OQ);const DQ=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],QL=xt("ban",DQ);const PQ=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],Wl=xt("beaker",PQ);const RQ=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],xo=xt("bell",RQ);const MQ=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],rh=xt("box",MQ);const LQ=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],YL=xt("boxes",LQ);const zQ=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Ts=xt("building-2",zQ);const BQ=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Lp=xt("building",BQ);const FQ=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],qQ=xt("calculator",FQ);const UQ=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],WQ=xt("calendar-clock",UQ);const HQ=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],zC=xt("calendar-check",HQ);const VQ=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],h8=xt("calendar-days",VQ);const $Q=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],$n=xt("calendar",$Q);const GQ=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Dv=xt("camera",GQ);const KQ=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],ZL=xt("car",KQ);const QQ=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],e2=xt("chart-column",QQ);const YQ=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],ZQ=xt("chart-pie",YQ);const XQ=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],XL=xt("check-check",XQ);const JQ=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ai=xt("check",JQ);const eY=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],qo=xt("chevron-down",eY);const tY=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Xp=xt("chevron-left",tY);const rY=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],bo=xt("chevron-right",rY);const nY=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],nh=xt("chevron-up",nY);const iY=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],aY=xt("chevrons-left",iY);const sY=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],oY=xt("chevrons-right",sY);const lY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],sn=xt("circle-alert",lY);const cY=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ft=xt("circle-check-big",cY);const dY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],uY=xt("circle-check",dY);const hY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],am=xt("circle-question-mark",hY);const fY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ri=xt("circle-x",fY);const mY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],I5=xt("circle",mY);const pY=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],sf=xt("clipboard-check",pY);const gY=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],JL=xt("clipboard-list",gY);const yY=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Pv=xt("clipboard",yY);const xY=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Qt=xt("clock",xY);const vY=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],f8=xt("cloud",vY);const bY=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],PA=xt("coins",bY);const jY=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]],wY=xt("command",jY);const SY=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],RA=xt("copy",SY);const CY=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Ul=xt("credit-card",CY);const NY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],AY=xt("crosshair",NY);const EY=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],m8=xt("database",EY);const _Y=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],of=xt("dollar-sign",_Y);const TY=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Jp=xt("download",TY);const IY=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],OY=xt("droplets",IY);const kY=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ez=xt("ellipsis-vertical",kY);const DY=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ih=xt("external-link",DY);const PY=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Eg=xt("eye-off",PY);const RY=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],os=xt("eye",RY);const MY=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],lu=xt("factory",MY);const LY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],gu=xt("file-check",LY);const zY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],BY=xt("file-down",zY);const FY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fv=xt("file-exclamation-point",FY);const qY=[["path",{d:"m18.226 5.226-2.52-2.52A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-.351",key:"1k2beg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]],tz=xt("file-pen-line",qY);const UY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],WY=xt("file-question-mark",UY);const HY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],VY=xt("file-spreadsheet",HY);const $Y=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ir=xt("file-text",$Y);const GY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]],KY=xt("file-type",GY);const QY=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],rz=xt("file",QY);const YY=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],ZY=xt("flag",YY);const XY=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Bi=xt("flask-conical",XY);const JY=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],nz=xt("folder-open",JY);const eZ=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Wo=xt("funnel",eZ);const tZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],sm=xt("globe",tZ);const rZ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],mv=xt("grid-3x3",rZ);const nZ=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],MA=xt("hash",nZ);const iZ=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],jm=xt("history",iZ);const aZ=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],iz=xt("house",aZ);const sZ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Rv=xt("image",sZ);const oZ=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],lZ=xt("inbox",oZ);const cZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],lf=xt("info",cZ);const dZ=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Bg=xt("key",dZ);const uZ=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],hZ=xt("keyboard",uZ);const fZ=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],py=xt("languages",fZ);const mZ=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],LA=xt("layers",mZ);const pZ=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],zA=xt("layout-dashboard",pZ);const gZ=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],p8=xt("link-2",gZ);const yZ=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],xZ=xt("list-ordered",yZ);const vZ=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]],Fg=xt("list-todo",vZ);const bZ=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],jZ=xt("list",bZ);const wZ=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],_g=xt("loader-circle",wZ);const SZ=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],BC=xt("lock",SZ);const CZ=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],BA=xt("log-out",CZ);const NZ=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],uc=xt("mail",NZ);const AZ=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],_a=xt("map-pin",AZ);const EZ=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],_Z=xt("map",EZ);const TZ=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],az=xt("megaphone",TZ);const IZ=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],FC=xt("menu",IZ);const OZ=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],t2=xt("message-circle",OZ);const kZ=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],e0=xt("message-square",kZ);const DZ=[["path",{d:"M5 12h14",key:"1ays0h"}]],sz=xt("minus",DZ);const PZ=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],RZ=xt("monitor",PZ);const MZ=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],oz=xt("moon",MZ);const LZ=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],zZ=xt("navigation",LZ);const BZ=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]],lz=xt("octagon-alert",BZ);const FZ=[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],qZ=xt("package-check",FZ);const UZ=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Rr=xt("package",UZ);const WZ=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],ah=xt("paperclip",WZ);const HZ=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],qC=xt("pause",HZ);const VZ=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],qg=xt("pen-tool",VZ);const $Z=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ma=xt("pen",$Z);const GZ=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Qh=xt("pencil",GZ);const KZ=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],g8=xt("percent",KZ);const QZ=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],vo=xt("phone",QZ);const YZ=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],Tg=xt("pill",YZ);const ZZ=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],yo=xt("play",ZZ);const XZ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],cn=xt("plus",XZ);const JZ=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],wm=xt("printer",JZ);const eX=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],td=xt("receipt",eX);const tX=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],cu=xt("refresh-cw",tX);const rX=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],y8=xt("rotate-ccw",rX);const nX=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],cz=xt("route",nX);const iX=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],cc=xt("save",iX);const aX=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],dz=xt("scan-line",aX);const sX=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Gs=xt("search",sX);const oX=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Qi=xt("send",oX);const lX=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],sh=xt("settings",lX);const cX=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],dX=xt("shield-check",cX);const uX=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],aa=xt("shield",uX);const hX=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],Fo=xt("shopping-cart",hX);const fX=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],t0=xt("square-pen",fX);const mX=[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]],pX=xt("star-off",mX);const gX=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],x8=xt("star",gX);const yX=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],uz=xt("sun",yX);const xX=[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]],Bf=xt("syringe",xX);const vX=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],r2=xt("tag",vX);const bX=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],UC=xt("thermometer",bX);const jX=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],Sm=xt("ticket",jX);const wX=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],vp=xt("timer",wX);const SX=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Gi=xt("trash-2",SX);const CX=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],hz=xt("trending-down",CX);const NX=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],r0=xt("trending-up",NX);const AX=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Hr=xt("triangle-alert",AX);const EX=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],dn=xt("truck",EX);const _X=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],om=xt("upload",_X);const TX=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],WC=xt("user-check",TX);const IX=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Np=xt("user-plus",IX);const OX=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],v8=xt("user-x",OX);const kX=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Uo=xt("user",kX);const DX=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],dc=xt("users",DX);const PX=[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]],lm=xt("warehouse",PX);const RX=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],fz=xt("wrench",RX);const MX=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Dr=xt("x",MX);const LX=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],zp=xt("zap",LX),mz=k.createContext(null);function gn(){const t=k.useContext(mz);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function zX({children:t}){const[r,n]=k.useState([]),i=k.useCallback(d=>{n(f=>f.filter(p=>p.id!==d))},[]),a=k.useCallback(d=>{const f=`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,p={...d,id:f};n(v=>[...v,p]);const x=d.duration??(d.type==="error"?8e3:5e3);x>0&&setTimeout(()=>i(f),x)},[i]),s=k.useCallback((d,f)=>{a({type:"success",title:d,message:f})},[a]),o=k.useCallback((d,f)=>{a({type:"error",title:d,message:f,duration:8e3})},[a]),l=k.useCallback((d,f)=>{a({type:"warning",title:d,message:f})},[a]),u=k.useCallback((d,f)=>{a({type:"info",title:d,message:f})},[a]);return e.jsxs(mz.Provider,{value:{toasts:r,addToast:a,removeToast:i,success:s,error:o,warning:l,info:u},children:[t,e.jsx(BX,{toasts:r,removeToast:i})]})}function BX({toasts:t,removeToast:r}){return t.length===0?null:e.jsx("div",{style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",zIndex:9999,display:"flex",flexDirection:"column",gap:"0.75rem",maxWidth:"400px"},children:t.map(n=>e.jsx(FX,{toast:n,onClose:()=>r(n.id)},n.id))})}function FX({toast:t,onClose:r}){const[n,i]=k.useState(!1),a=()=>{i(!0),setTimeout(r,200)},s={success:e.jsx(Ft,{size:20}),error:e.jsx(sn,{size:20}),warning:e.jsx(Hr,{size:20}),info:e.jsx(lf,{size:20})},l={success:{bg:"#dcfce7",border:"#22c55e",icon:"#16a34a",text:"#166534"},error:{bg:"#fee2e2",border:"#ef4444",icon:"#dc2626",text:"#991b1b"},warning:{bg:"#fef3c7",border:"#f59e0b",icon:"#d97706",text:"#92400e"},info:{bg:"#dbeafe",border:"#3b82f6",icon:"#2563eb",text:"#1e40af"}}[t.type];return e.jsxs("div",{style:{backgroundColor:l.bg,border:`1px solid ${l.border}`,borderRadius:"var(--radius)",padding:"1rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",display:"flex",gap:"0.75rem",alignItems:"flex-start",animation:n?"slideOut 0.2s ease-out":"slideIn 0.3s ease-out"},children:[e.jsx("div",{style:{color:l.icon,flexShrink:0,marginTop:"2px"},children:s[t.type]}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:600,color:l.text,marginBottom:t.message?"0.25rem":0},children:t.title}),t.message&&e.jsx("div",{style:{fontSize:"0.875rem",color:l.text,opacity:.9},children:t.message}),t.action&&e.jsx("button",{onClick:t.action.onClick,style:{marginTop:"0.5rem",padding:"0.25rem 0.75rem",fontSize:"0.8125rem",fontWeight:500,background:l.icon,color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:t.action.label})]}),e.jsx("button",{onClick:a,style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:l.text,opacity:.6,borderRadius:"4px"},children:e.jsx(Dr,{size:16})})]})}const pn=t=>typeof t=="string",X0=()=>{let t,r;const n=new Promise((i,a)=>{t=i,r=a});return n.resolve=t,n.reject=r,n},b8=t=>t==null?"":""+t,qX=(t,r,n)=>{t.forEach(i=>{r[i]&&(n[i]=r[i])})},UX=/###/g,j8=t=>t&&t.indexOf("###")>-1?t.replace(UX,"."):t,w8=t=>!t||pn(t),Ig=(t,r,n)=>{const i=pn(r)?r.split("."):r;let a=0;for(;a<i.length-1;){if(w8(t))return{};const s=j8(i[a]);!t[s]&&n&&(t[s]=new n),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++a}return w8(t)?{}:{obj:t,k:j8(i[a])}},S8=(t,r,n)=>{const{obj:i,k:a}=Ig(t,r,Object);if(i!==void 0||r.length===1){i[a]=n;return}let s=r[r.length-1],o=r.slice(0,r.length-1),l=Ig(t,o,Object);for(;l.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),l=Ig(t,o,Object),l?.obj&&typeof l.obj[`${l.k}.${s}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${s}`]=n},WX=(t,r,n,i)=>{const{obj:a,k:s}=Ig(t,r,Object);a[s]=a[s]||[],a[s].push(n)},Mv=(t,r)=>{const{obj:n,k:i}=Ig(t,r);if(n&&Object.prototype.hasOwnProperty.call(n,i))return n[i]},HX=(t,r,n)=>{const i=Mv(t,n);return i!==void 0?i:Mv(r,n)},pz=(t,r,n)=>{for(const i in r)i!=="__proto__"&&i!=="constructor"&&(i in t?pn(t[i])||t[i]instanceof String||pn(r[i])||r[i]instanceof String?n&&(t[i]=r[i]):pz(t[i],r[i],n):t[i]=r[i]);return t},ep=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var VX={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const $X=t=>pn(t)?t.replace(/[&<>"'\/]/g,r=>VX[r]):t;class GX{constructor(r){this.capacity=r,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(r){const n=this.regExpMap.get(r);if(n!==void 0)return n;const i=new RegExp(r);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(r,i),this.regExpQueue.push(r),i}}const KX=[" ",",","?","!",";"],QX=new GX(20),YX=(t,r,n)=>{r=r||"",n=n||"";const i=KX.filter(o=>r.indexOf(o)<0&&n.indexOf(o)<0);if(i.length===0)return!0;const a=QX.getRegExp(`(${i.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!a.test(t);if(!s){const o=t.indexOf(n);o>0&&!a.test(t.substring(0,o))&&(s=!0)}return s},HC=(t,r,n=".")=>{if(!t)return;if(t[r])return Object.prototype.hasOwnProperty.call(t,r)?t[r]:void 0;const i=r.split(n);let a=t;for(let s=0;s<i.length;){if(!a||typeof a!="object")return;let o,l="";for(let u=s;u<i.length;++u)if(u!==s&&(l+=n),l+=i[u],o=a[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&u<i.length-1)continue;s+=u-s+1;break}a=o}return a},Ug=t=>t?.replace("_","-"),ZX={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,r){console?.[t]?.apply?.(console,r)}};class Lv{constructor(r,n={}){this.init(r,n)}init(r,n={}){this.prefix=n.prefix||"i18next:",this.logger=r||ZX,this.options=n,this.debug=n.debug}log(...r){return this.forward(r,"log","",!0)}warn(...r){return this.forward(r,"warn","",!0)}error(...r){return this.forward(r,"error","")}deprecate(...r){return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(r,n,i,a){return a&&!this.debug?null:(pn(r[0])&&(r[0]=`${i}${this.prefix} ${r[0]}`),this.logger[n](r))}create(r){return new Lv(this.logger,{prefix:`${this.prefix}:${r}:`,...this.options})}clone(r){return r=r||this.options,r.prefix=r.prefix||this.prefix,new Lv(this.logger,r)}}var iu=new Lv;let n2=class{constructor(){this.observers={}}on(r,n){return r.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const a=this.observers[i].get(n)||0;this.observers[i].set(n,a+1)}),this}off(r,n){if(this.observers[r]){if(!n){delete this.observers[r];return}this.observers[r].delete(n)}}emit(r,...n){this.observers[r]&&Array.from(this.observers[r].entries()).forEach(([a,s])=>{for(let o=0;o<s;o++)a(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,s])=>{for(let o=0;o<s;o++)a.apply(a,[r,...n])})}};class C8 extends n2{constructor(r,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=r||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(r){this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}removeNamespaces(r){const n=this.options.ns.indexOf(r);n>-1&&this.options.ns.splice(n,1)}getResource(r,n,i,a={}){const s=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,o=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;r.indexOf(".")>-1?l=r.split("."):(l=[r,n],i&&(Array.isArray(i)?l.push(...i):pn(i)&&s?l.push(...i.split(s)):l.push(i)));const u=Mv(this.data,l);return!u&&!n&&!i&&r.indexOf(".")>-1&&(r=l[0],n=l[1],i=l.slice(2).join(".")),u||!o||!pn(i)?u:HC(this.data?.[r]?.[n],i,s)}addResource(r,n,i,a,s={silent:!1}){const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let l=[r,n];i&&(l=l.concat(o?i.split(o):i)),r.indexOf(".")>-1&&(l=r.split("."),a=n,n=l[1]),this.addNamespaces(n),S8(this.data,l,a),s.silent||this.emit("added",r,n,i,a)}addResources(r,n,i,a={silent:!1}){for(const s in i)(pn(i[s])||Array.isArray(i[s]))&&this.addResource(r,n,s,i[s],{silent:!0});a.silent||this.emit("added",r,n,i)}addResourceBundle(r,n,i,a,s,o={silent:!1,skipCopy:!1}){let l=[r,n];r.indexOf(".")>-1&&(l=r.split("."),a=i,i=n,n=l[1]),this.addNamespaces(n);let u=Mv(this.data,l)||{};o.skipCopy||(i=JSON.parse(JSON.stringify(i))),a?pz(u,i,s):u={...u,...i},S8(this.data,l,u),o.silent||this.emit("added",r,n,i)}removeResourceBundle(r,n){this.hasResourceBundle(r,n)&&delete this.data[r][n],this.removeNamespaces(n),this.emit("removed",r,n)}hasResourceBundle(r,n){return this.getResource(r,n)!==void 0}getResourceBundle(r,n){return n||(n=this.options.defaultNS),this.getResource(r,n)}getDataByLanguage(r){return this.data[r]}hasLanguageSomeTranslations(r){const n=this.getDataByLanguage(r);return!!(n&&Object.keys(n)||[]).find(a=>n[a]&&Object.keys(n[a]).length>0)}toJSON(){return this.data}}var gz={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,r,n,i,a){return t.forEach(s=>{r=this.processors[s]?.process(r,n,i,a)??r}),r}};const yz=Symbol("i18next/PATH_KEY");function XX(){const t=[],r=Object.create(null);let n;return r.get=(i,a)=>(n?.revoke?.(),a===yz?t:(t.push(a),n=Proxy.revocable(i,r),n.proxy)),Proxy.revocable(Object.create(null),r).proxy}function VC(t,r){const{[yz]:n}=t(XX());return n.join(r?.keySeparator??".")}const N8={},O5=t=>!pn(t)&&typeof t!="boolean"&&typeof t!="number";class zv extends n2{constructor(r,n={}){super(),qX(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],r,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=iu.create("translator")}changeLanguage(r){r&&(this.language=r)}exists(r,n={interpolation:{}}){const i={...n};if(r==null)return!1;const a=this.resolve(r,i);if(a?.res===void 0)return!1;const s=O5(a.res);return!(i.returnObjects===!1&&s)}extractFromKey(r,n){let i=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let s=n.ns||this.options.defaultNS||[];const o=i&&r.indexOf(i)>-1,l=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!YX(r,i,a);if(o&&!l){const u=r.match(this.interpolator.nestingRegexp);if(u&&u.length>0)return{key:r,namespaces:pn(s)?[s]:s};const d=r.split(i);(i!==a||i===a&&this.options.ns.indexOf(d[0])>-1)&&(s=d.shift()),r=d.join(a)}return{key:r,namespaces:pn(s)?[s]:s}}translate(r,n,i){let a=typeof n=="object"?{...n}:n;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),r==null)return"";typeof r=="function"&&(r=VC(r,{...this.options,...a})),Array.isArray(r)||(r=[String(r)]);const s=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:l,namespaces:u}=this.extractFromKey(r[r.length-1],a),d=u[u.length-1];let f=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;f===void 0&&(f=":");const p=a.lng||this.language,x=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(p?.toLowerCase()==="cimode")return x?s?{res:`${d}${f}${l}`,usedKey:l,exactUsedKey:l,usedLng:p,usedNS:d,usedParams:this.getUsedParamsDetails(a)}:`${d}${f}${l}`:s?{res:l,usedKey:l,exactUsedKey:l,usedLng:p,usedNS:d,usedParams:this.getUsedParamsDetails(a)}:l;const v=this.resolve(r,a);let w=v?.res;const C=v?.usedKey||l,A=v?.exactUsedKey||l,T=["[object Number]","[object Function]","[object RegExp]"],O=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,D=!this.i18nFormat||this.i18nFormat.handleAsObject,M=a.count!==void 0&&!pn(a.count),Q=zv.hasDefaultValue(a),U=M?this.pluralResolver.getSuffix(p,a.count,a):"",$=a.ordinal&&M?this.pluralResolver.getSuffix(p,a.count,{ordinal:!1}):"",ee=M&&!a.ordinal&&a.count===0,F=ee&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${U}`]||a[`defaultValue${$}`]||a.defaultValue;let Y=w;D&&!w&&Q&&(Y=F);const J=O5(Y),Z=Object.prototype.toString.apply(Y);if(D&&Y&&J&&T.indexOf(Z)<0&&!(pn(O)&&Array.isArray(Y))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const re=this.options.returnedObjectHandler?this.options.returnedObjectHandler(C,Y,{...a,ns:u}):`key '${l} (${this.language})' returned an object instead of string.`;return s?(v.res=re,v.usedParams=this.getUsedParamsDetails(a),v):re}if(o){const re=Array.isArray(Y),de=re?[]:{},le=re?A:C;for(const K in Y)if(Object.prototype.hasOwnProperty.call(Y,K)){const ue=`${le}${o}${K}`;Q&&!w?de[K]=this.translate(ue,{...a,defaultValue:O5(F)?F[K]:void 0,joinArrays:!1,ns:u}):de[K]=this.translate(ue,{...a,joinArrays:!1,ns:u}),de[K]===ue&&(de[K]=Y[K])}w=de}}else if(D&&pn(O)&&Array.isArray(w))w=w.join(O),w&&(w=this.extendTranslation(w,r,a,i));else{let re=!1,de=!1;!this.isValidLookup(w)&&Q&&(re=!0,w=F),this.isValidLookup(w)||(de=!0,w=l);const K=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&de?void 0:w,ue=Q&&F!==w&&this.options.updateMissing;if(de||re||ue){if(this.logger.log(ue?"updateKey":"missingKey",p,d,l,ue?F:w),o){const V=this.resolve(l,{...a,keySeparator:!1});V&&V.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ce=[];const ye=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ye&&ye[0])for(let V=0;V<ye.length;V++)ce.push(ye[V]);else this.options.saveMissingTo==="all"?ce=this.languageUtils.toResolveHierarchy(a.lng||this.language):ce.push(a.lng||this.language);const Se=(V,X,se)=>{const W=Q&&se!==w?se:K;this.options.missingKeyHandler?this.options.missingKeyHandler(V,d,X,W,ue,a):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(V,d,X,W,ue,a),this.emit("missingKey",V,d,X,w)};this.options.saveMissing&&(this.options.saveMissingPlurals&&M?ce.forEach(V=>{const X=this.pluralResolver.getSuffixes(V,a);ee&&a[`defaultValue${this.options.pluralSeparator}zero`]&&X.indexOf(`${this.options.pluralSeparator}zero`)<0&&X.push(`${this.options.pluralSeparator}zero`),X.forEach(se=>{Se([V],l+se,a[`defaultValue${se}`]||F)})}):Se(ce,l,F))}w=this.extendTranslation(w,r,a,v,i),de&&w===l&&this.options.appendNamespaceToMissingKey&&(w=`${d}${f}${l}`),(de||re)&&this.options.parseMissingKeyHandler&&(w=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${d}${f}${l}`:l,re?w:void 0,a))}return s?(v.res=w,v.usedParams=this.getUsedParamsDetails(a),v):w}extendTranslation(r,n,i,a,s){if(this.i18nFormat?.parse)r=this.i18nFormat.parse(r,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const u=pn(r)&&(i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const p=r.match(this.interpolator.nestingRegexp);d=p&&p.length}let f=i.replace&&!pn(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),r=this.interpolator.interpolate(r,f,i.lng||this.language||a.usedLng,i),u){const p=r.match(this.interpolator.nestingRegexp),x=p&&p.length;d<x&&(i.nest=!1)}!i.lng&&a&&a.res&&(i.lng=this.language||a.usedLng),i.nest!==!1&&(r=this.interpolator.nest(r,(...p)=>s?.[0]===p[0]&&!i.context?(this.logger.warn(`It seems you are nesting recursively key: ${p[0]} in key: ${n[0]}`),null):this.translate(...p,n),i)),i.interpolation&&this.interpolator.reset()}const o=i.postProcess||this.options.postProcess,l=pn(o)?[o]:o;return r!=null&&l?.length&&i.applyPostProcessor!==!1&&(r=gz.handle(l,r,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),r}resolve(r,n={}){let i,a,s,o,l;return pn(r)&&(r=[r]),r.forEach(u=>{if(this.isValidLookup(i))return;const d=this.extractFromKey(u,n),f=d.key;a=f;let p=d.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));const x=n.count!==void 0&&!pn(n.count),v=x&&!n.ordinal&&n.count===0,w=n.context!==void 0&&(pn(n.context)||typeof n.context=="number")&&n.context!=="",C=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);p.forEach(A=>{this.isValidLookup(i)||(l=A,!N8[`${C[0]}-${A}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(N8[`${C[0]}-${A}`]=!0,this.logger.warn(`key "${a}" for languages "${C.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),C.forEach(T=>{if(this.isValidLookup(i))return;o=T;const O=[f];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(O,f,T,A,n);else{let M;x&&(M=this.pluralResolver.getSuffix(T,n.count,n));const Q=`${this.options.pluralSeparator}zero`,U=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(x&&(n.ordinal&&M.indexOf(U)===0&&O.push(f+M.replace(U,this.options.pluralSeparator)),O.push(f+M),v&&O.push(f+Q)),w){const $=`${f}${this.options.contextSeparator||"_"}${n.context}`;O.push($),x&&(n.ordinal&&M.indexOf(U)===0&&O.push($+M.replace(U,this.options.pluralSeparator)),O.push($+M),v&&O.push($+Q))}}let D;for(;D=O.pop();)this.isValidLookup(i)||(s=D,i=this.getResource(T,A,D,n))}))})}),{res:i,usedKey:a,exactUsedKey:s,usedLng:o,usedNS:l}}isValidLookup(r){return r!==void 0&&!(!this.options.returnNull&&r===null)&&!(!this.options.returnEmptyString&&r==="")}getResource(r,n,i,a={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(r,n,i,a):this.resourceStore.getResource(r,n,i,a)}getUsedParamsDetails(r={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=r.replace&&!pn(r.replace);let a=i?r.replace:r;if(i&&typeof r.count<"u"&&(a.count=r.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!i){a={...a};for(const s of n)delete a[s]}return a}static hasDefaultValue(r){const n="defaultValue";for(const i in r)if(Object.prototype.hasOwnProperty.call(r,i)&&n===i.substring(0,n.length)&&r[i]!==void 0)return!0;return!1}}class A8{constructor(r){this.options=r,this.supportedLngs=this.options.supportedLngs||!1,this.logger=iu.create("languageUtils")}getScriptPartFromCode(r){if(r=Ug(r),!r||r.indexOf("-")<0)return null;const n=r.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(r){if(r=Ug(r),!r||r.indexOf("-")<0)return r;const n=r.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(r){if(pn(r)&&r.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(r)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?r.toLowerCase():r)}return this.options.cleanCode||this.options.lowerCaseLng?r.toLowerCase():r}isSupportedCode(r){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(r=this.getLanguagePartFromCode(r)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(r)>-1}getBestMatchFromCodes(r){if(!r)return null;let n;return r.forEach(i=>{if(n)return;const a=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(a))&&(n=a)}),!n&&this.options.supportedLngs&&r.forEach(i=>{if(n)return;const a=this.getScriptPartFromCode(i);if(this.isSupportedCode(a))return n=a;const s=this.getLanguagePartFromCode(i);if(this.isSupportedCode(s))return n=s;n=this.options.supportedLngs.find(o=>{if(o===s)return o;if(!(o.indexOf("-")<0&&s.indexOf("-")<0)&&(o.indexOf("-")>0&&s.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===s||o.indexOf(s)===0&&s.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(r,n){if(!r)return[];if(typeof r=="function"&&(r=r(n)),pn(r)&&(r=[r]),Array.isArray(r))return r;if(!n)return r.default||[];let i=r[n];return i||(i=r[this.getScriptPartFromCode(n)]),i||(i=r[this.formatLanguageCode(n)]),i||(i=r[this.getLanguagePartFromCode(n)]),i||(i=r.default),i||[]}toResolveHierarchy(r,n){const i=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],r),a=[],s=o=>{o&&(this.isSupportedCode(o)?a.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return pn(r)&&(r.indexOf("-")>-1||r.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(r)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(r)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(r))):pn(r)&&s(this.formatLanguageCode(r)),i.forEach(o=>{a.indexOf(o)<0&&s(this.formatLanguageCode(o))}),a}}const E8={zero:0,one:1,two:2,few:3,many:4,other:5},_8={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class JX{constructor(r,n={}){this.languageUtils=r,this.options=n,this.logger=iu.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(r,n={}){const i=Ug(r==="dev"?"en":r),a=n.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:a});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(i,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),_8;if(!r.match(/-|_/))return _8;const u=this.languageUtils.getLanguagePartFromCode(r);o=this.getRule(u,n)}return this.pluralRulesCache[s]=o,o}needsPlural(r,n={}){let i=this.getRule(r,n);return i||(i=this.getRule("dev",n)),i?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(r,n,i={}){return this.getSuffixes(r,i).map(a=>`${n}${a}`)}getSuffixes(r,n={}){let i=this.getRule(r,n);return i||(i=this.getRule("dev",n)),i?i.resolvedOptions().pluralCategories.sort((a,s)=>E8[a]-E8[s]).map(a=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(r,n,i={}){const a=this.getRule(r,i);return a?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${a.select(n)}`:(this.logger.warn(`no plural rule found for: ${r}`),this.getSuffix("dev",n,i))}}const T8=(t,r,n,i=".",a=!0)=>{let s=HX(t,r,n);return!s&&a&&pn(n)&&(s=HC(t,n,i),s===void 0&&(s=HC(r,n,i))),s},k5=t=>t.replace(/\$/g,"$$$$");class I8{constructor(r={}){this.logger=iu.create("interpolator"),this.options=r,this.format=r?.interpolation?.format||(n=>n),this.init(r)}init(r={}){r.interpolation||(r.interpolation={escapeValue:!0});const{escape:n,escapeValue:i,useRawValueToEscape:a,prefix:s,prefixEscaped:o,suffix:l,suffixEscaped:u,formatSeparator:d,unescapeSuffix:f,unescapePrefix:p,nestingPrefix:x,nestingPrefixEscaped:v,nestingSuffix:w,nestingSuffixEscaped:C,nestingOptionsSeparator:A,maxReplaces:T,alwaysFormat:O}=r.interpolation;this.escape=n!==void 0?n:$X,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=s?ep(s):o||"{{",this.suffix=l?ep(l):u||"}}",this.formatSeparator=d||",",this.unescapePrefix=f?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":f||"",this.nestingPrefix=x?ep(x):v||ep("$t("),this.nestingSuffix=w?ep(w):C||ep(")"),this.nestingOptionsSeparator=A||",",this.maxReplaces=T||1e3,this.alwaysFormat=O!==void 0?O:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const r=(n,i)=>n?.source===i?(n.lastIndex=0,n):new RegExp(i,"g");this.regexp=r(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=r(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=r(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(r,n,i,a){let s,o,l;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=v=>{if(v.indexOf(this.formatSeparator)<0){const T=T8(n,u,v,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(T,void 0,i,{...a,...n,interpolationkey:v}):T}const w=v.split(this.formatSeparator),C=w.shift().trim(),A=w.join(this.formatSeparator).trim();return this.format(T8(n,u,C,this.options.keySeparator,this.options.ignoreJSONStructure),A,i,{...a,...n,interpolationkey:C})};this.resetRegExp();const f=a?.missingInterpolationHandler||this.options.missingInterpolationHandler,p=a?.interpolation?.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:v=>k5(v)},{regex:this.regexp,safeValue:v=>this.escapeValue?k5(this.escape(v)):k5(v)}].forEach(v=>{for(l=0;s=v.regex.exec(r);){const w=s[1].trim();if(o=d(w),o===void 0)if(typeof f=="function"){const A=f(r,s,a);o=pn(A)?A:""}else if(a&&Object.prototype.hasOwnProperty.call(a,w))o="";else if(p){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${r}`),o="";else!pn(o)&&!this.useRawValueToEscape&&(o=b8(o));const C=v.safeValue(o);if(r=r.replace(s[0],C),p?(v.regex.lastIndex+=o.length,v.regex.lastIndex-=s[0].length):v.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),r}nest(r,n,i={}){let a,s,o;const l=(u,d)=>{const f=this.nestingOptionsSeparator;if(u.indexOf(f)<0)return u;const p=u.split(new RegExp(`${f}[ ]*{`));let x=`{${p[1]}`;u=p[0],x=this.interpolate(x,o);const v=x.match(/'/g),w=x.match(/"/g);((v?.length??0)%2===0&&!w||w.length%2!==0)&&(x=x.replace(/'/g,'"'));try{o=JSON.parse(x),d&&(o={...d,...o})}catch(C){return this.logger.warn(`failed parsing options string in nesting for key ${u}`,C),`${u}${f}${x}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,u};for(;a=this.nestingRegexp.exec(r);){let u=[];o={...i},o=o.replace&&!pn(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const d=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(d!==-1&&(u=a[1].slice(d).split(this.formatSeparator).map(f=>f.trim()).filter(Boolean),a[1]=a[1].slice(0,d)),s=n(l.call(this,a[1].trim(),o),o),s&&a[0]===r&&!pn(s))return s;pn(s)||(s=b8(s)),s||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${r}`),s=""),u.length&&(s=u.reduce((f,p)=>this.format(f,p,i.lng,{...i,interpolationkey:a[1].trim()}),s.trim())),r=r.replace(a[0],s),this.regexp.lastIndex=0}return r}}const eJ=t=>{let r=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const i=t.split("(");r=i[0].toLowerCase().trim();const a=i[1].substring(0,i[1].length-1);r==="currency"&&a.indexOf(":")<0?n.currency||(n.currency=a.trim()):r==="relativetime"&&a.indexOf(":")<0?n.range||(n.range=a.trim()):a.split(";").forEach(o=>{if(o){const[l,...u]=o.split(":"),d=u.join(":").trim().replace(/^'+|'+$/g,""),f=l.trim();n[f]||(n[f]=d),d==="false"&&(n[f]=!1),d==="true"&&(n[f]=!0),isNaN(d)||(n[f]=parseInt(d,10))}})}return{formatName:r,formatOptions:n}},O8=t=>{const r={};return(n,i,a)=>{let s=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(s={...s,[a.interpolationkey]:void 0});const o=i+JSON.stringify(s);let l=r[o];return l||(l=t(Ug(i),a),r[o]=l),l(n)}},tJ=t=>(r,n,i)=>t(Ug(n),i)(r);class rJ{constructor(r={}){this.logger=iu.create("formatter"),this.options=r,this.init(r)}init(r,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const i=n.cacheInBuiltFormats?O8:tJ;this.formats={number:i((a,s)=>{const o=new Intl.NumberFormat(a,{...s});return l=>o.format(l)}),currency:i((a,s)=>{const o=new Intl.NumberFormat(a,{...s,style:"currency"});return l=>o.format(l)}),datetime:i((a,s)=>{const o=new Intl.DateTimeFormat(a,{...s});return l=>o.format(l)}),relativetime:i((a,s)=>{const o=new Intl.RelativeTimeFormat(a,{...s});return l=>o.format(l,s.range||"day")}),list:i((a,s)=>{const o=new Intl.ListFormat(a,{...s});return l=>o.format(l)})}}add(r,n){this.formats[r.toLowerCase().trim()]=n}addCached(r,n){this.formats[r.toLowerCase().trim()]=O8(n)}format(r,n,i,a={}){const s=n.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(l=>l.indexOf(")")>-1)){const l=s.findIndex(u=>u.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,l)].join(this.formatSeparator)}return s.reduce((l,u)=>{const{formatName:d,formatOptions:f}=eJ(u);if(this.formats[d]){let p=l;try{const x=a?.formatParams?.[a.interpolationkey]||{},v=x.locale||x.lng||a.locale||a.lng||i;p=this.formats[d](l,v,{...f,...a,...x})}catch(x){this.logger.warn(x)}return p}else this.logger.warn(`there was no format function for ${d}`);return l},r)}}const nJ=(t,r)=>{t.pending[r]!==void 0&&(delete t.pending[r],t.pendingCount--)};class iJ extends n2{constructor(r,n,i,a={}){super(),this.backend=r,this.store=n,this.services=i,this.languageUtils=i.languageUtils,this.options=a,this.logger=iu.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(i,a.backend,a)}queueLoad(r,n,i,a){const s={},o={},l={},u={};return r.forEach(d=>{let f=!0;n.forEach(p=>{const x=`${d}|${p}`;!i.reload&&this.store.hasResourceBundle(d,p)?this.state[x]=2:this.state[x]<0||(this.state[x]===1?o[x]===void 0&&(o[x]=!0):(this.state[x]=1,f=!1,o[x]===void 0&&(o[x]=!0),s[x]===void 0&&(s[x]=!0),u[p]===void 0&&(u[p]=!0)))}),f||(l[d]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(u)}}loaded(r,n,i){const a=r.split("|"),s=a[0],o=a[1];n&&this.emit("failedLoading",s,o,n),!n&&i&&this.store.addResourceBundle(s,o,i,void 0,void 0,{skipCopy:!0}),this.state[r]=n?-1:2,n&&i&&(this.state[r]=0);const l={};this.queue.forEach(u=>{WX(u.loaded,[s],o),nJ(u,r),n&&u.errors.push(n),u.pendingCount===0&&!u.done&&(Object.keys(u.loaded).forEach(d=>{l[d]||(l[d]={});const f=u.loaded[d];f.length&&f.forEach(p=>{l[d][p]===void 0&&(l[d][p]=!0)})}),u.done=!0,u.errors.length?u.callback(u.errors):u.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(u=>!u.done)}read(r,n,i,a=0,s=this.retryTimeout,o){if(!r.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:r,ns:n,fcName:i,tried:a,wait:s,callback:o});return}this.readingCalls++;const l=(d,f)=>{if(this.readingCalls--,this.waitingReads.length>0){const p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(d&&f&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,r,n,i,a+1,s*2,o)},s);return}o(d,f)},u=this.backend[i].bind(this.backend);if(u.length===2){try{const d=u(r,n);d&&typeof d.then=="function"?d.then(f=>l(null,f)).catch(l):l(null,d)}catch(d){l(d)}return}return u(r,n,l)}prepareLoading(r,n,i={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();pn(r)&&(r=this.languageUtils.toResolveHierarchy(r)),pn(n)&&(n=[n]);const s=this.queueLoad(r,n,i,a);if(!s.toLoad.length)return s.pending.length||a(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(r,n,i){this.prepareLoading(r,n,{},i)}reload(r,n,i){this.prepareLoading(r,n,{reload:!0},i)}loadOne(r,n=""){const i=r.split("|"),a=i[0],s=i[1];this.read(a,s,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${n}loading namespace ${s} for language ${a} failed`,o),!o&&l&&this.logger.log(`${n}loaded namespace ${s} for language ${a}`,l),this.loaded(r,o,l)})}saveMissing(r,n,i,a,s,o={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${i}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend?.create){const u={...o,isUpdate:s},d=this.backend.create.bind(this.backend);if(d.length<6)try{let f;d.length===5?f=d(r,n,i,a,u):f=d(r,n,i,a),f&&typeof f.then=="function"?f.then(p=>l(null,p)).catch(l):l(null,f)}catch(f){l(f)}else d(r,n,i,a,l,u)}!r||!r[0]||this.store.addResource(r[0],n,i,a)}}}const D5=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let r={};if(typeof t[1]=="object"&&(r=t[1]),pn(t[1])&&(r.defaultValue=t[1]),pn(t[2])&&(r.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(i=>{r[i]=n[i]})}return r},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),k8=t=>(pn(t.ns)&&(t.ns=[t.ns]),pn(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),pn(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t),Fx=()=>{},aJ=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class Og extends n2{constructor(r={},n){if(super(),this.options=k8(r),this.services={},this.logger=iu,this.modules={external:[]},aJ(this),n&&!this.isInitialized&&!r.isClone){if(!this.options.initAsync)return this.init(r,n),this;setTimeout(()=>{this.init(r,n)},0)}}init(r={},n){this.isInitializing=!0,typeof r=="function"&&(n=r,r={}),r.defaultNS==null&&r.ns&&(pn(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const i=D5();this.options={...i,...this.options,...k8(r)},this.options.interpolation={...i.interpolation,...this.options.interpolation},r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=i.overloadTranslationOptionHandler),this.options.debug===!0&&typeof console<"u"&&console.warn("i18next is maintained with support from locize.com  consider powering your project with managed localization (AI, CDN, integrations): https://locize.com");const a=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?iu.init(a(this.modules.logger),this.options):iu.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:d=rJ;const f=new A8(this.options);this.store=new C8(this.options.resources,this.options);const p=this.services;p.logger=iu,p.resourceStore=this.store,p.languageUtils=f,p.pluralResolver=new JX(f,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),d&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(p.formatter=a(d),p.formatter.init&&p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new I8(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new iJ(a(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",(v,...w)=>{this.emit(v,...w)}),this.modules.languageDetector&&(p.languageDetector=a(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=a(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new zv(this.services,this.options),this.translator.on("*",(v,...w)=>{this.emit(v,...w)}),this.modules.external.forEach(v=>{v.init&&v.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Fx),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=(...f)=>this.store[d](...f)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=(...f)=>(this.store[d](...f),this)});const l=X0(),u=()=>{const d=(f,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(p),n(f,p)};if(this.languages&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),l}loadResources(r,n=Fx){let i=n;const a=pn(r)?r:this.language;if(typeof r=="function"&&(i=r),!this.options.resources||this.options.partialBundledLanguages){if(a?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const s=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(d=>{d!=="cimode"&&s.indexOf(d)<0&&s.push(d)})};a?o(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>o(u)),this.options.preload?.forEach?.(l=>o(l)),this.services.backendConnector.load(s,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(l)})}else i(null)}reloadResources(r,n,i){const a=X0();return typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=void 0),r||(r=this.languages),n||(n=this.options.ns),i||(i=Fx),this.services.backendConnector.reload(r,n,s=>{a.resolve(),i(s)}),a}use(r){if(!r)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!r.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return r.type==="backend"&&(this.modules.backend=r),(r.type==="logger"||r.log&&r.warn&&r.error)&&(this.modules.logger=r),r.type==="languageDetector"&&(this.modules.languageDetector=r),r.type==="i18nFormat"&&(this.modules.i18nFormat=r),r.type==="postProcessor"&&gz.addPostProcessor(r),r.type==="formatter"&&(this.modules.formatter=r),r.type==="3rdParty"&&this.modules.external.push(r),this}setResolvedLanguage(r){if(!(!r||!this.languages)&&!(["cimode","dev"].indexOf(r)>-1)){for(let n=0;n<this.languages.length;n++){const i=this.languages[n];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}!this.resolvedLanguage&&this.languages.indexOf(r)<0&&this.store.hasLanguageSomeTranslations(r)&&(this.resolvedLanguage=r,this.languages.unshift(r))}}changeLanguage(r,n){this.isLanguageChangingTo=r;const i=X0();this.emit("languageChanging",r);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},s=(l,u)=>{u?this.isLanguageChangingTo===r&&(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,i.resolve((...d)=>this.t(...d)),n&&n(l,(...d)=>this.t(...d))},o=l=>{!r&&!l&&this.services.languageDetector&&(l=[]);const u=pn(l)?l:l&&l[0],d=this.store.hasLanguageSomeTranslations(u)?u:this.services.languageUtils.getBestMatchFromCodes(pn(l)?[l]:l);d&&(this.language||a(d),this.translator.language||this.translator.changeLanguage(d),this.services.languageDetector?.cacheUserLanguage?.(d)),this.loadResources(d,f=>{s(f,d)})};return!r&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!r&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(r),i}getFixedT(r,n,i){const a=(s,o,...l)=>{let u;typeof o!="object"?u=this.options.overloadTranslationOptionHandler([s,o].concat(l)):u={...o},u.lng=u.lng||a.lng,u.lngs=u.lngs||a.lngs,u.ns=u.ns||a.ns,u.keyPrefix!==""&&(u.keyPrefix=u.keyPrefix||i||a.keyPrefix);const d=this.options.keySeparator||".";let f;return u.keyPrefix&&Array.isArray(s)?f=s.map(p=>(typeof p=="function"&&(p=VC(p,{...this.options,...o})),`${u.keyPrefix}${d}${p}`)):(typeof s=="function"&&(s=VC(s,{...this.options,...o})),f=u.keyPrefix?`${u.keyPrefix}${d}${s}`:s),this.t(f,u)};return pn(r)?a.lng=r:a.lngs=r,a.ns=n,a.keyPrefix=i,a}t(...r){return this.translator?.translate(...r)}exists(...r){return this.translator?.exists(...r)}setDefaultNamespace(r){this.options.defaultNS=r}hasLoadedNamespace(r,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=n.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const o=(l,u)=>{const d=this.services.backendConnector.state[`${l}|${u}`];return d===-1||d===0||d===2};if(n.precheck){const l=n.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(i,r)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(i,r)&&(!a||o(s,r)))}loadNamespaces(r,n){const i=X0();return this.options.ns?(pn(r)&&(r=[r]),r.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{i.resolve(),n&&n(a)}),i):(n&&n(),Promise.resolve())}loadLanguages(r,n){const i=X0();pn(r)&&(r=[r]);const a=this.options.preload||[],s=r.filter(o=>a.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=a.concat(s),this.loadResources(o=>{i.resolve(),n&&n(o)}),i):(n&&n(),Promise.resolve())}dir(r){if(r||(r=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!r)return"rtl";try{const a=new Intl.Locale(r);if(a&&a.getTextInfo){const s=a.getTextInfo();if(s&&s.direction)return s.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services?.languageUtils||new A8(D5());return r.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(i.getLanguagePartFromCode(r))>-1||r.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(r={},n){const i=new Og(r,n);return i.createInstance=Og.createInstance,i}cloneInstance(r={},n=Fx){const i=r.forkResourceStore;i&&delete r.forkResourceStore;const a={...this.options,...r,isClone:!0},s=new Og(a);if((r.debug!==void 0||r.prefix!==void 0)&&(s.logger=s.logger.clone(r)),["store","services","language"].forEach(l=>{s[l]=this[l]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i){const l=Object.keys(this.store.data).reduce((u,d)=>(u[d]={...this.store.data[d]},u[d]=Object.keys(u[d]).reduce((f,p)=>(f[p]={...u[d][p]},f),u[d]),u),{});s.store=new C8(l,a),s.services.resourceStore=s.store}if(r.interpolation){const u={...D5().interpolation,...this.options.interpolation,...r.interpolation},d={...a,interpolation:u};s.services.interpolator=new I8(d)}return s.translator=new zv(s.services,a),s.translator.on("*",(l,...u)=>{s.emit(l,...u)}),s.init(a,n),s.translator.options=a,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Ol=Og.createInstance();Ol.createInstance;Ol.dir;Ol.init;Ol.loadResources;Ol.reloadResources;Ol.use;Ol.changeLanguage;Ol.getFixedT;Ol.t;Ol.exists;Ol.setDefaultNamespace;Ol.hasLoadedNamespace;Ol.loadNamespaces;Ol.loadLanguages;const sJ=(t,r,n,i)=>{const a=[n,{code:r,...i||{}}];if(t?.services?.logger?.forward)return t.services.logger.forward(a,"warn","react-i18next::",!0);cm(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),t?.services?.logger?.warn?t.services.logger.warn(...a):console?.warn&&console.warn(...a)},D8={},xz=(t,r,n,i)=>{cm(n)&&D8[n]||(cm(n)&&(D8[n]=new Date),sJ(t,r,n,i))},vz=(t,r)=>()=>{if(t.isInitialized)r();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),r()};t.on("initialized",n)}},$C=(t,r,n)=>{t.loadNamespaces(r,vz(t,n))},P8=(t,r,n,i)=>{if(cm(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(r)>-1)return $C(t,n,i);n.forEach(a=>{t.options.ns.indexOf(a)<0&&t.options.ns.push(a)}),t.loadLanguages(r,vz(t,i))},oJ=(t,r,n={})=>!r.languages||!r.languages.length?(xz(r,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:r.languages}),!0):r.hasLoadedNamespace(t,{lng:n.lng,precheck:(i,a)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!a(i.isLanguageChangingTo,t))return!1}}),cm=t=>typeof t=="string",lJ=t=>typeof t=="object"&&t!==null,cJ=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,dJ={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},uJ=t=>dJ[t],hJ=t=>t.replace(cJ,uJ);let GC={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:hJ,transDefaultProps:void 0};const fJ=(t={})=>{GC={...GC,...t}},mJ=()=>GC;let bz;const pJ=t=>{bz=t},gJ=()=>bz,yJ={type:"3rdParty",init(t){fJ(t.options.react),pJ(t)}},xJ=k.createContext();class vJ{constructor(){this.usedNamespaces={}}addUsedNamespaces(r){r.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var P5={exports:{}},R5={};var R8;function bJ(){if(R8)return R5;R8=1;var t=Vp();function r(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var n=typeof Object.is=="function"?Object.is:r,i=t.useState,a=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function l(p,x){var v=x(),w=i({inst:{value:v,getSnapshot:x}}),C=w[0].inst,A=w[1];return s(function(){C.value=v,C.getSnapshot=x,u(C)&&A({inst:C})},[p,v,x]),a(function(){return u(C)&&A({inst:C}),p(function(){u(C)&&A({inst:C})})},[p]),o(v),v}function u(p){var x=p.getSnapshot;p=p.value;try{var v=x();return!n(p,v)}catch{return!0}}function d(p,x){return x()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return R5.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:f,R5}var M8;function jz(){return M8||(M8=1,P5.exports=bJ()),P5.exports}var jJ=jz();const wJ=(t,r)=>cm(r)?r:lJ(r)&&cm(r.defaultValue)?r.defaultValue:Array.isArray(t)?t[t.length-1]:t,SJ={t:wJ,ready:!1},CJ=()=>()=>{},FA=(t,r={})=>{const{i18n:n}=r,{i18n:i,defaultNS:a}=k.useContext(xJ)||{},s=n||i||gJ();s&&!s.reportNamespaces&&(s.reportNamespaces=new vJ),s||xz(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=k.useMemo(()=>({...mJ(),...s?.options?.react,...r}),[s,r]),{useSuspense:l,keyPrefix:u}=o,d=a||s?.options?.defaultNS,f=cm(d)?[d]:d||["translation"],p=k.useMemo(()=>f,f);s?.reportNamespaces?.addUsedNamespaces?.(p);const x=k.useRef(0),v=k.useCallback(F=>{if(!s)return CJ;const{bindI18n:Y,bindI18nStore:J}=o,Z=()=>{x.current+=1,F()};return Y&&s.on(Y,Z),J&&s.store.on(J,Z),()=>{Y&&Y.split(" ").forEach(re=>s.off(re,Z)),J&&J.split(" ").forEach(re=>s.store.off(re,Z))}},[s,o]),w=k.useRef(),C=k.useCallback(()=>{if(!s)return SJ;const F=!!(s.isInitialized||s.initializedStoreOnce)&&p.every(le=>oJ(le,s,o)),Y=r.lng||s.language,J=x.current,Z=w.current;if(Z&&Z.ready===F&&Z.lng===Y&&Z.keyPrefix===u&&Z.revision===J)return Z;const de={t:s.getFixedT(Y,o.nsMode==="fallback"?p:p[0],u),ready:F,lng:Y,keyPrefix:u,revision:J};return w.current=de,de},[s,p,u,o,r.lng]),[A,T]=k.useState(0),{t:O,ready:D}=jJ.useSyncExternalStore(v,C,C);k.useEffect(()=>{if(s&&!D&&!l){const F=()=>T(Y=>Y+1);r.lng?P8(s,r.lng,p,F):$C(s,p,F)}},[s,r.lng,p,D,l,A]);const M=s||{},Q=k.useRef(null),U=k.useRef(),$=F=>{const Y=Object.getOwnPropertyDescriptors(F);Y.__original&&delete Y.__original;const J=Object.create(Object.getPrototypeOf(F),Y);if(!Object.prototype.hasOwnProperty.call(J,"__original"))try{Object.defineProperty(J,"__original",{value:F,writable:!1,enumerable:!1,configurable:!1})}catch{}return J},ee=k.useMemo(()=>{const F=M,Y=F?.language;let J=F;F&&(Q.current&&Q.current.__original===F?U.current!==Y?(J=$(F),Q.current=J,U.current=Y):J=Q.current:(J=$(F),Q.current=J,U.current=Y));const Z=[O,J,D];return Z.t=O,Z.i18n=J,Z.ready=D,Z},[O,M,D,M.resolvedLanguage,M.language,M.languages]);if(s&&l&&!D)throw new Promise(F=>{const Y=()=>F();r.lng?P8(s,r.lng,p,Y):$C(s,p,Y)});return ee},{slice:NJ,forEach:AJ}=[];function EJ(t){return AJ.call(NJ.call(arguments,1),r=>{if(r)for(const n in r)t[n]===void 0&&(t[n]=r[n])}),t}function _J(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(t))}const L8=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,TJ=function(t,r){const i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},a=encodeURIComponent(r);let s=`${t}=${a}`;if(i.maxAge>0){const o=i.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(o)}`}if(i.domain){if(!L8.test(i.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${i.domain}`}if(i.path){if(!L8.test(i.path))throw new TypeError("option path is invalid");s+=`; Path=${i.path}`}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${i.expires.toUTCString()}`}if(i.httpOnly&&(s+="; HttpOnly"),i.secure&&(s+="; Secure"),i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i.partitioned&&(s+="; Partitioned"),s},z8={create(t,r,n,i){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(a.expires=new Date,a.expires.setTime(a.expires.getTime()+n*60*1e3)),i&&(a.domain=i),document.cookie=TJ(t,r,a)},read(t){const r=`${t}=`,n=document.cookie.split(";");for(let i=0;i<n.length;i++){let a=n[i];for(;a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(r)===0)return a.substring(r.length,a.length)}return null},remove(t,r){this.create(t,"",-1,r)}};var IJ={name:"cookie",lookup(t){let{lookupCookie:r}=t;if(r&&typeof document<"u")return z8.read(r)||void 0},cacheUserLanguage(t,r){let{lookupCookie:n,cookieMinutes:i,cookieDomain:a,cookieOptions:s}=r;n&&typeof document<"u"&&z8.create(n,t,i,a,s)}},OJ={name:"querystring",lookup(t){let{lookupQuerystring:r}=t,n;if(typeof window<"u"){let{search:i}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));const s=i.substring(1).split("&");for(let o=0;o<s.length;o++){const l=s[o].indexOf("=");l>0&&s[o].substring(0,l)===r&&(n=s[o].substring(l+1))}}return n}},kJ={name:"hash",lookup(t){let{lookupHash:r,lookupFromHashIndex:n}=t,i;if(typeof window<"u"){const{hash:a}=window.location;if(a&&a.length>2){const s=a.substring(1);if(r){const o=s.split("&");for(let l=0;l<o.length;l++){const u=o[l].indexOf("=");u>0&&o[l].substring(0,u)===r&&(i=o[l].substring(u+1))}}if(i)return i;if(!i&&n>-1){const o=a.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof n=="number"?n:0]?.replace("/",""):void 0}}}return i}};let tp=null;const B8=()=>{if(tp!==null)return tp;try{if(tp=typeof window<"u"&&window.localStorage!==null,!tp)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{tp=!1}return tp};var DJ={name:"localStorage",lookup(t){let{lookupLocalStorage:r}=t;if(r&&B8())return window.localStorage.getItem(r)||void 0},cacheUserLanguage(t,r){let{lookupLocalStorage:n}=r;n&&B8()&&window.localStorage.setItem(n,t)}};let rp=null;const F8=()=>{if(rp!==null)return rp;try{if(rp=typeof window<"u"&&window.sessionStorage!==null,!rp)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{rp=!1}return rp};var PJ={name:"sessionStorage",lookup(t){let{lookupSessionStorage:r}=t;if(r&&F8())return window.sessionStorage.getItem(r)||void 0},cacheUserLanguage(t,r){let{lookupSessionStorage:n}=r;n&&F8()&&window.sessionStorage.setItem(n,t)}},RJ={name:"navigator",lookup(t){const r=[];if(typeof navigator<"u"){const{languages:n,userLanguage:i,language:a}=navigator;if(n)for(let s=0;s<n.length;s++)r.push(n[s]);i&&r.push(i),a&&r.push(a)}return r.length>0?r:void 0}},MJ={name:"htmlTag",lookup(t){let{htmlTag:r}=t,n;const i=r||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(n=i.getAttribute("lang")),n}},LJ={name:"path",lookup(t){let{lookupFromPathIndex:r}=t;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?n[typeof r=="number"?r:0]?.replace("/",""):void 0}},zJ={name:"subdomain",lookup(t){let{lookupFromSubdomainIndex:r}=t;const n=typeof r=="number"?r+1:1,i=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(i)return i[n]}};let wz=!1;try{document.cookie,wz=!0}catch{}const Sz=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];wz||Sz.splice(1,1);const BJ=()=>({order:Sz,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class Cz{constructor(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(r,n)}init(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=r,this.options=EJ(n,this.options||{},BJ()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=a=>a.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(IJ),this.addDetector(OJ),this.addDetector(DJ),this.addDetector(PJ),this.addDetector(RJ),this.addDetector(MJ),this.addDetector(LJ),this.addDetector(zJ),this.addDetector(kJ)}addDetector(r){return this.detectors[r.name]=r,this}detect(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return r.forEach(i=>{if(this.detectors[i]){let a=this.detectors[i].lookup(this.options);a&&typeof a=="string"&&(a=[a]),a&&(n=n.concat(a))}}),n=n.filter(i=>i!=null&&!_J(i)).map(i=>this.options.convertDetectedLanguage(i)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(r){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(r)>-1||n.forEach(i=>{this.detectors[i]&&this.detectors[i].cacheUserLanguage(r,this.options)}))}}Cz.type="languageDetector";const FJ={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",create:"Create",update:"Update",search:"Search",filter:"Filter",clear:"Clear",close:"Close",confirm:"Confirm",submit:"Submit",reset:"Reset",back:"Back",next:"Next",previous:"Previous",loading:"Loading...",noData:"No data available",actions:"Actions",status:"Status",date:"Date",time:"Time",name:"Name",code:"Code",description:"Description",notes:"Notes",active:"Active",inactive:"Inactive",yes:"Yes",no:"No",all:"All",total:"Total",quantity:"Quantity",amount:"Amount",price:"Price",view:"View",details:"Details",export:"Export",import:"Import",download:"Download",upload:"Upload",approve:"Approve",reject:"Reject",pending:"Pending",completed:"Completed",viewAll:"View All",showMore:"Show More",showLess:"Show Less"},qJ={login:"Login",logout:"Logout",email:"Email",password:"Password",rememberMe:"Remember me",forgotPassword:"Forgot password?",signIn:"Sign In",signOut:"Sign Out",welcomeBack:"Welcome back",loginSuccess:"Login successful",loginFailed:"Login failed",invalidCredentials:"Invalid email or password"},UJ={dashboard:"Dashboard",customers:"Customers",products:"Products",orders:"Orders",planner:"Planner",productionSchedule:"Production Schedule",batches:"Batches",qc:"QC Tests",release:"QP Release",qcTestDefinitions:"QC Test Definitions",dispensing:"Dispensing",shipments:"Shipments",drivers:"Drivers",availability:"Availability",reservations:"Reservations",contracts:"Contracts",invoices:"Invoices",payments:"Payments",users:"Users",approvals:"Approvals",reports:"Reports",settings:"Settings",auditLog:"Audit Log",roles:"Roles",notifications:"Notifications",materials:"Materials",recipes:"Recipes",suppliers:"Suppliers",purchaseOrders:"Purchase Orders",warehouses:"Warehouses",goodsReceiving:"Goods Receiving",inventory:"Inventory",manufacturing:"Manufacturing",oosInvestigations:"OOS/OOT Investigations",profile:"Profile"},WJ={title:"Operations Command Center",subtitle:"Real-time overview of production, quality, logistics, and procurement operations",ordersProduction:"Orders & Production",logistics:"Logistics",procurementInventory:"Procurement & Inventory",todaysOrders:"Today's Orders",batchesInProgress:"Batches in Progress",pendingQC:"Pending QC",pendingRelease:"Pending Release",shipmentsToday:"Shipments Today",deliveriesCompleted:"Deliveries Completed",onTimeDelivery:"On-Time Delivery",driversActive:"Drivers Active",posPendingApproval:"POs Pending Approval",grnPendingQC:"GRN Pending QC",lowStockItems:"Low Stock Items",batchesInProduction:"Batches in Production",recentOrders:"Recent Orders",orderQueue:"Order Queue",batchQueue:"Batch Queue",qcQueue:"QC Queue",shipmentQueue:"Shipment Queue",poApprovalQueue:"PO Approval Queue",grnQcQueue:"GRN QC Queue",manufacturingQueue:"Manufacturing Queue"},HJ={title:"Orders",newOrder:"New Order",orderNumber:"Order Number",customer:"Customer",product:"Product",deliveryDate:"Delivery Date",requestedActivity:"Requested Activity",status:"Status",createdAt:"Created At",totalOrders:"Total Orders",pendingOrders:"Pending Orders",confirmedOrders:"Confirmed Orders",deliveredOrders:"Delivered Orders"},VJ={title:"Customers",newCustomer:"New Customer",customerName:"Customer Name",email:"Email",phone:"Phone",address:"Address",city:"City",country:"Country",status:"Status",totalCustomers:"Total Customers",activeCustomers:"Active Customers"},$J={title:"Products",newProduct:"New Product",productName:"Product Name",productCode:"Product Code",category:"Category",halfLife:"Half Life",defaultActivity:"Default Activity",status:"Status"},GJ={title:"Batches",batchNumber:"Batch Number",product:"Product",plannedQty:"Planned Qty",actualQty:"Actual Qty",status:"Status",scheduledDate:"Scheduled Date",journey:"Journey"},KJ={title:"Quality Control",tests:"QC Tests",testName:"Test Name",testType:"Test Type",result:"Result",specification:"Specification",passed:"Passed",failed:"Failed",pending:"Pending",inProgress:"In Progress"},QJ={title:"QP Release",batchRelease:"Batch Release",releasedBy:"Released By",releaseDate:"Release Date",signature:"Signature",comments:"Comments"},YJ={title:"Dispensing",doseNumber:"Dose Number",patient:"Patient",activity:"Activity",dispensedAt:"Dispensed At",dispensedBy:"Dispensed By"},ZJ={title:"Shipments",newShipment:"New Shipment",shipmentNumber:"Shipment Number",driver:"Driver",vehicle:"Vehicle",departureTime:"Departure Time",arrivalTime:"Arrival Time",status:"Status",tracking:"Tracking"},XJ={title:"Invoices",newInvoice:"New Invoice",invoiceNumber:"Invoice Number",customer:"Customer",amount:"Amount",dueDate:"Due Date",status:"Status",paid:"Paid",unpaid:"Unpaid",overdue:"Overdue"},JJ={title:"Purchase Orders",newPO:"New Purchase Order",poNumber:"PO Number",supplier:"Supplier",expectedDate:"Expected Date",totalAmount:"Total Amount",status:"Status",items:"Items",approve:"Approve",reject:"Reject",send:"Send to Supplier"},eee={title:"Goods Receiving",newGRN:"New GRN",grnNumber:"GRN Number",purchaseOrder:"Purchase Order",receivedDate:"Received Date",receivedBy:"Received By",status:"Status",items:"Items"},tee={title:"Materials",newMaterial:"New Material",materialCode:"Material Code",materialName:"Material Name",category:"Category",unit:"Unit",currentStock:"Current Stock",reorderLevel:"Reorder Level"},ree={title:"Suppliers",newSupplier:"New Supplier",supplierName:"Supplier Name",contactPerson:"Contact Person",email:"Email",phone:"Phone",address:"Address"},nee={title:"Warehouses",newWarehouse:"New Warehouse",warehouseName:"Warehouse Name",warehouseCode:"Warehouse Code",type:"Type",location:"Location",capacity:"Capacity"},iee={title:"Inventory",material:"Material",warehouse:"Warehouse",location:"Location",quantity:"Quantity",status:"Status",lastMovement:"Last Movement"},aee={title:"Manufacturing Execution",batchRecord:"Batch Record",recipe:"Recipe",startTime:"Start Time",endTime:"End Time",operator:"Operator",steps:"Steps",progress:"Progress"},see={title:"Users",newUser:"New User",firstName:"First Name",lastName:"Last Name",email:"Email",role:"Role",status:"Status",lastLogin:"Last Login"},oee={title:"Settings",general:"General",system:"System Settings",countries:"Countries",cities:"Cities",regions:"Regions",categories:"Categories",couriers:"Couriers",vehicles:"Vehicles",doseUnits:"Dose Units",productTypes:"Product Types",productionMethods:"Production Methods",currencies:"Currencies",attachments:"Attachment Types",notifications:"Notifications",timezone:"Timezone",language:"Language",currency:"Currency"},lee={title:"My Profile",subtitle:"Manage your account settings and preferences",editProfile:"Edit Profile",firstName:"First Name",lastName:"Last Name",email:"Email",phone:"Phone",security:"Security",changePassword:"Change Password",currentPassword:"Current Password",newPassword:"New Password",confirmPassword:"Confirm New Password",updatePassword:"Update Password",passwordChanged:"Password changed successfully",profileUpdated:"Profile updated successfully"},cee={title:"Notifications",markAllRead:"Mark all as read",noNotifications:"No notifications",unread:"Unread",all:"All"},dee={title:"Approvals",pendingApprovals:"Pending Approvals",approved:"Approved",rejected:"Rejected",approvedBy:"Approved By",rejectedBy:"Rejected By"},uee={title:"Reports",generate:"Generate Report",exportPDF:"Export PDF",exportExcel:"Export Excel",dateRange:"Date Range",fromDate:"From Date",toDate:"To Date"},hee={title:"Audit Log",action:"Action",entity:"Entity",user:"User",timestamp:"Timestamp",changes:"Changes",before:"Before",after:"After"},fee={draft:"Draft",pending:"Pending",pendingApproval:"Pending Approval",approved:"Approved",rejected:"Rejected",confirmed:"Confirmed",inProgress:"In Progress",completed:"Completed",cancelled:"Cancelled",delivered:"Delivered",shipped:"Shipped",received:"Received",partiallyReceived:"Partially Received",closed:"Closed",active:"Active",inactive:"Inactive",sent:"Sent",acknowledged:"Acknowledged"},mee={required:"This field is required",invalidEmail:"Invalid email address",minLength:"Minimum {{count}} characters required",maxLength:"Maximum {{count}} characters allowed",passwordMismatch:"Passwords do not match",invalidPhone:"Invalid phone number"},pee={saveSuccess:"Saved successfully",saveFailed:"Failed to save",deleteSuccess:"Deleted successfully",deleteFailed:"Failed to delete",updateSuccess:"Updated successfully",updateFailed:"Failed to update",confirmDelete:"Are you sure you want to delete this item?",noResults:"No results found",loadingError:"Error loading data"},gee={common:FJ,auth:qJ,nav:UJ,dashboard:WJ,orders:HJ,customers:VJ,products:$J,batches:GJ,qc:KJ,release:QJ,dispensing:YJ,shipments:ZJ,invoices:XJ,purchaseOrders:JJ,grn:eee,materials:tee,suppliers:ree,warehouses:nee,inventory:iee,manufacturing:aee,users:see,settings:oee,profile:lee,notifications:cee,approvals:dee,reports:uee,audit:hee,statuses:fee,validation:mee,messages:pee},yee={save:"",cancel:"",delete:"",edit:"",add:"",create:"",update:"",search:"",filter:"",clear:"",close:"",confirm:"",submit:"",reset:" ",back:"",next:"",previous:"",loading:" ...",noData:"  ",actions:"",status:"",date:"",time:"",name:"",code:"",description:"",notes:"",active:"",inactive:" ",yes:"",no:"",all:"",total:"",quantity:"",amount:"",price:"",view:"",details:"",export:"",import:"",download:"",upload:"",approve:"",reject:"",pending:" ",completed:"",viewAll:" ",showMore:" ",showLess:" "},xee={login:" ",logout:" ",email:" ",password:" ",rememberMe:"",forgotPassword:"  ",signIn:"",signOut:"",welcomeBack:" ",loginSuccess:"   ",loginFailed:"  ",invalidCredentials:"      "},vee={dashboard:" ",customers:"",products:"",orders:"",planner:"",batches:"",qc:" ",release:" ",qcTestDefinitions:"  ",dispensing:"",shipments:"",drivers:"",availability:"",reservations:"",contracts:"",invoices:"",payments:"",users:"",approvals:"",reports:"",settings:"",auditLog:" ",roles:"",notifications:"",materials:"",recipes:"",suppliers:"",purchaseOrders:" ",warehouses:"",goodsReceiving:" ",inventory:"",manufacturing:"",oosInvestigations:" ",profile:" "},bee={title:"  ",subtitle:"          ",ordersProduction:" ",logistics:"",procurementInventory:" ",todaysOrders:" ",batchesInProgress:"  ",pendingQC:" ",pendingRelease:" ",shipmentsToday:" ",deliveriesCompleted:" ",onTimeDelivery:"  ",driversActive:" ",posPendingApproval:"   ",grnPendingQC:"  ",lowStockItems:"  ",batchesInProduction:"  ",recentOrders:" ",orderQueue:" ",batchQueue:" ",qcQueue:" ",shipmentQueue:" ",poApprovalQueue:"  ",grnQcQueue:"  ",manufacturingQueue:" "},jee={title:"",newOrder:" ",orderNumber:" ",customer:"",product:"",deliveryDate:" ",requestedActivity:" ",status:"",createdAt:" ",totalOrders:" ",pendingOrders:"  ",confirmedOrders:" ",deliveredOrders:"  "},wee={title:"",newCustomer:" ",customerName:" ",email:" ",phone:"",address:"",city:"",country:"",status:"",totalCustomers:" ",activeCustomers:" "},See={title:"",newProduct:" ",productName:" ",productCode:" ",category:"",halfLife:" ",defaultActivity:" ",status:""},Cee={title:"",batchNumber:" ",product:"",plannedQty:" ",actualQty:" ",status:"",scheduledDate:" ",journey:""},Nee={title:" ",tests:" ",testName:" ",testType:" ",result:"",specification:"",passed:"",failed:"",pending:" ",inProgress:" "},Aee={title:" ",batchRelease:" ",releasedBy:" ",releaseDate:" ",signature:"",comments:""},Eee={title:"",doseNumber:" ",patient:"",activity:"",dispensedAt:" ",dispensedBy:" "},_ee={title:"",newShipment:" ",shipmentNumber:" ",driver:"",vehicle:"",departureTime:" ",arrivalTime:" ",status:"",tracking:""},Tee={title:"",newInvoice:" ",invoiceNumber:" ",customer:"",amount:"",dueDate:" ",status:"",paid:"",unpaid:" ",overdue:""},Iee={title:" ",newPO:"  ",poNumber:"  ",supplier:"",expectedDate:" ",totalAmount:" ",status:"",items:"",approve:"",reject:"",send:" "},Oee={title:" ",newGRN:" ",grnNumber:" ",purchaseOrder:" ",receivedDate:" ",receivedBy:" ",status:"",items:""},kee={title:"",newMaterial:" ",materialCode:" ",materialName:" ",category:"",unit:"",currentStock:" ",reorderLevel:"  "},Dee={title:"",newSupplier:" ",supplierName:" ",contactPerson:" ",email:" ",phone:"",address:""},Pee={title:"",newWarehouse:" ",warehouseName:" ",warehouseCode:" ",type:"",location:"",capacity:""},Ree={title:"",material:"",warehouse:"",location:"",quantity:"",status:"",lastMovement:" "},Mee={title:" ",batchRecord:" ",recipe:"",startTime:" ",endTime:" ",operator:"",steps:"",progress:""},Lee={title:"",newUser:" ",firstName:" ",lastName:" ",email:" ",role:"",status:"",lastLogin:"  "},zee={title:"",general:"",system:" ",countries:"",cities:"",regions:"",categories:"",couriers:" ",vehicles:"",doseUnits:" ",productTypes:" ",productionMethods:" ",currencies:"",attachments:" ",notifications:"",timezone:" ",language:"",currency:""},Bee={title:" ",subtitle:"   ",editProfile:" ",firstName:" ",lastName:" ",email:" ",phone:"",security:"",changePassword:"  ",currentPassword:"  ",newPassword:"  ",confirmPassword:"   ",updatePassword:"  ",passwordChanged:"    ",profileUpdated:"    "},Fee={title:"",markAllRead:"  ",noNotifications:"  ",unread:" ",all:""},qee={title:"",pendingApprovals:"  ",approved:" ",rejected:"",approvedBy:" ",rejectedBy:" "},Uee={title:"",generate:" ",exportPDF:" PDF",exportExcel:" Excel",dateRange:" ",fromDate:" ",toDate:" "},Wee={title:" ",action:"",entity:"",user:"",timestamp:"",changes:"",before:"",after:""},Hee={draft:"",pending:" ",pendingApproval:" ",approved:" ",rejected:"",confirmed:"",inProgress:" ",completed:"",cancelled:"",delivered:" ",shipped:" ",received:"",partiallyReceived:" ",closed:"",active:"",inactive:" ",sent:"",acknowledged:" "},Vee={required:"  ",invalidEmail:"    ",minLength:"  {{count}}  ",maxLength:"  {{count}}  ",passwordMismatch:"   ",invalidPhone:"   "},$ee={saveSuccess:"  ",saveFailed:"  ",deleteSuccess:"  ",deleteFailed:"  ",updateSuccess:"  ",updateFailed:"  ",confirmDelete:"       ",noResults:"    ",loadingError:"   "},Gee={common:yee,auth:xee,nav:vee,dashboard:bee,orders:jee,customers:wee,products:See,batches:Cee,qc:Nee,release:Aee,dispensing:Eee,shipments:_ee,invoices:Tee,purchaseOrders:Iee,grn:Oee,materials:kee,suppliers:Dee,warehouses:Pee,inventory:Ree,manufacturing:Mee,users:Lee,settings:zee,profile:Bee,notifications:Fee,approvals:qee,reports:Uee,audit:Wee,statuses:Hee,validation:Vee,messages:$ee},Kee={en:{translation:gee},ar:{translation:Gee}};Ol.use(Cz).use(yJ).init({resources:Kee,fallbackLng:"en",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});const i2=dy(t=>({language:localStorage.getItem("i18nextLng")||"en",direction:(localStorage.getItem("i18nextLng")||"en")==="ar"?"rtl":"ltr",setLanguage:r=>{Ol.changeLanguage(r),localStorage.setItem("i18nextLng",r);const n=r==="ar"?"rtl":"ltr";document.documentElement.dir=n,document.documentElement.lang=r,t({language:r,direction:n})}})),Qee=()=>{const t=localStorage.getItem("i18nextLng")||"en",r=t==="ar"?"rtl":"ltr";document.documentElement.dir=r,document.documentElement.lang=t};function Yee(t,r){let n;try{n=t()}catch{return}return{getItem:a=>{var s;const o=u=>u===null?null:JSON.parse(u,void 0),l=(s=n.getItem(a))!=null?s:null;return l instanceof Promise?l.then(o):o(l)},setItem:(a,s)=>n.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>n.removeItem(a)}}const KC=t=>r=>{try{const n=t(r);return n instanceof Promise?n:{then(i){return KC(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return KC(i)(n)}}}},Zee=(t,r)=>(n,i,a)=>{let s={storage:Yee(()=>localStorage),partialize:A=>A,version:0,merge:(A,T)=>({...T,...A}),...r},o=!1,l=0;const u=new Set,d=new Set;let f=s.storage;if(!f)return t((...A)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...A)},i,a);const p=()=>{const A=s.partialize({...i()});return f.setItem(s.name,{state:A,version:s.version})},x=a.setState;a.setState=(A,T)=>(x(A,T),p());const v=t((...A)=>(n(...A),p()),i,a);a.getInitialState=()=>v;let w;const C=()=>{var A,T;if(!f)return;const O=++l;o=!1,u.forEach(M=>{var Q;return M((Q=i())!=null?Q:v)});const D=((T=s.onRehydrateStorage)==null?void 0:T.call(s,(A=i())!=null?A:v))||void 0;return KC(f.getItem.bind(f))(s.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==s.version){if(s.migrate){const Q=s.migrate(M.state,M.version);return Q instanceof Promise?Q.then(U=>[!0,U]):[!0,Q]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var Q;if(O!==l)return;const[U,$]=M;if(w=s.merge($,(Q=i())!=null?Q:v),n(w,!0),U)return p()}).then(()=>{O===l&&(D?.(w,void 0),w=i(),o=!0,d.forEach(M=>M(w)))}).catch(M=>{O===l&&D?.(void 0,M)})};return a.persist={setOptions:A=>{s={...s,...A},A.storage&&(f=A.storage)},clearStorage:()=>{f?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:A=>(u.add(A),()=>{u.delete(A)}),onFinishHydration:A=>(d.add(A),()=>{d.delete(A)})},s.skipHydration||C(),w||v},qA=Zee,Xee=dy()(qA((t,r)=>({favorites:[],addFavorite:n=>{t(i=>({favorites:i.favorites.includes(n)?i.favorites:[...i.favorites,n]}))},removeFavorite:n=>{t(i=>({favorites:i.favorites.filter(a=>a!==n)}))},toggleFavorite:n=>{const{favorites:i}=r();i.includes(n)?t({favorites:i.filter(a=>a!==n)}):t({favorites:[...i,n]})},isFavorite:n=>r().favorites.includes(n)}),{name:"radiopharma-favorites"})),UA=dy()(qA(t=>({currency:"SAR",setCurrency:r=>t({currency:r})}),{name:"currency-preference"})),Nz=6048e5,Jee=864e5,WA=6e4,Az=36e5,qx=43200,q8=1440,U8=Symbol.for("constructDateFrom");function nd(t,r){return typeof t=="function"?t(r):t&&typeof t=="object"&&U8 in t?t[U8](r):t instanceof Date?new t.constructor(r):new Date(r)}function Is(t,r){return nd(r||t,t)}function hl(t,r,n){const i=Is(t,n?.in);return isNaN(r)?nd(t,NaN):(r&&i.setDate(i.getDate()+r),i)}let ete={};function n0(){return ete}function cf(t,r){const n=n0(),i=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Is(t,r?.in),s=a.getDay(),o=(s<i?7:0)+s-i;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Bv(t,r){return cf(t,{...r,weekStartsOn:1})}function Ez(t,r){const n=Is(t,r?.in),i=n.getFullYear(),a=nd(n,0);a.setFullYear(i+1,0,4),a.setHours(0,0,0,0);const s=Bv(a),o=nd(n,0);o.setFullYear(i,0,4),o.setHours(0,0,0,0);const l=Bv(o);return n.getTime()>=s.getTime()?i+1:n.getTime()>=l.getTime()?i:i-1}function Fv(t){const r=Is(t),n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return n.setUTCFullYear(r.getFullYear()),+t-+n}function i0(t,...r){const n=nd.bind(null,t||r.find(i=>typeof i=="object"));return r.map(n)}function Yf(t,r){const n=Is(t,r?.in);return n.setHours(0,0,0,0),n}function _z(t,r,n){const[i,a]=i0(n?.in,t,r),s=Yf(i),o=Yf(a),l=+s-Fv(s),u=+o-Fv(o);return Math.round((l-u)/Jee)}function tte(t,r){const n=Ez(t,r),i=nd(t,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),Bv(i)}function Tz(t,r,n){return hl(t,r*7,n)}function pv(t,r){const n=+Is(t)-+Is(r);return n<0?-1:n>0?1:n}function rte(t){return nd(t,Date.now())}function nte(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function ite(t){return!(!nte(t)&&typeof t!="number"||isNaN(+Is(t)))}function ate(t,r,n){const[i,a]=i0(n?.in,t,r),s=i.getFullYear()-a.getFullYear(),o=i.getMonth()-a.getMonth();return s*12+o}function ste(t,r,n){const[i,a]=i0(n?.in,t,r),s=W8(i,a),o=Math.abs(_z(i,a));i.setDate(i.getDate()-s*o);const l=+(W8(i,a)===-s),u=s*(o-l);return u===0?0:u}function W8(t,r){const n=t.getFullYear()-r.getFullYear()||t.getMonth()-r.getMonth()||t.getDate()-r.getDate()||t.getHours()-r.getHours()||t.getMinutes()-r.getMinutes()||t.getSeconds()-r.getSeconds()||t.getMilliseconds()-r.getMilliseconds();return n<0?-1:n>0?1:n}function Iz(t){return r=>{const n=Math.trunc,i=n(r);return i===0?0:i}}function Oz(t,r){return+Is(t)-+Is(r)}function Ux(t,r,n){const i=Oz(t,r)/WA;return Iz()(i)}function ote(t,r){const n=Is(t,r?.in);return n.setHours(23,59,59,999),n}function lte(t,r){const n=Is(t,r?.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}function cte(t,r){const n=Is(t,r?.in);return+ote(n,r)==+lte(n,r)}function dte(t,r,n){const[i,a,s]=i0(n?.in,t,t,r),o=pv(a,s),l=Math.abs(ate(a,s));if(l<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-o*l);let u=pv(a,s)===-o;cte(i)&&l===1&&pv(i,s)===1&&(u=!1);const d=o*(l-+u);return d===0?0:d}function ute(t,r,n){const i=Oz(t,r)/1e3;return Iz()(i)}function hte(t,r){const[n,i]=i0(t,r.start,r.end);return{start:n,end:i}}function fte(t,r){const{start:n,end:i}=hte(r?.in,t);let a=+n>+i;const s=a?+n:+i,o=a?i:n;o.setHours(0,0,0,0);let l=1;const u=[];for(;+o<=s;)u.push(nd(n,o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return a?u.reverse():u}function mte(t,r){const n=Is(t,r?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function pte(t,r){const n=r?.weekStartsOn,i=Is(t,r?.in),a=i.getDay(),s=(a<n?-7:0)+6-(a-n);return i.setDate(i.getDate()+s),i.setHours(23,59,59,999),i}const gte={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yte=(t,r,n)=>{let i;const a=gte[t];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function M5(t){return(r={})=>{const n=r.width?String(r.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const xte={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},vte={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},bte={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jte={date:M5({formats:xte,defaultWidth:"full"}),time:M5({formats:vte,defaultWidth:"full"}),dateTime:M5({formats:bte,defaultWidth:"full"})},wte={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Ste=(t,r,n,i)=>wte[t];function J0(t){return(r,n)=>{const i=n?.context?String(n.context):"standalone";let a;if(i==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=n?.width?String(n.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=n?.width?String(n.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(r):r;return a[s]}}const Cte={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Nte={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ate={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ete={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_te={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Tte={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Ite=(t,r)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Ote={ordinalNumber:Ite,era:J0({values:Cte,defaultWidth:"wide"}),quarter:J0({values:Nte,defaultWidth:"wide",argumentCallback:t=>t-1}),month:J0({values:Ate,defaultWidth:"wide"}),day:J0({values:Ete,defaultWidth:"wide"}),dayPeriod:J0({values:_te,defaultWidth:"wide",formattingValues:Tte,defaultFormattingWidth:"wide"})};function eg(t){return(r,n={})=>{const i=n.width,a=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],s=r.match(a);if(!s)return null;const o=s[0],l=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(l)?Dte(l,p=>p.test(o)):kte(l,p=>p.test(o));let d;d=t.valueCallback?t.valueCallback(u):u,d=n.valueCallback?n.valueCallback(d):d;const f=r.slice(o.length);return{value:d,rest:f}}}function kte(t,r){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r(t[n]))return n}function Dte(t,r){for(let n=0;n<t.length;n++)if(r(t[n]))return n}function Pte(t){return(r,n={})=>{const i=r.match(t.matchPattern);if(!i)return null;const a=i[0],s=r.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=n.valueCallback?n.valueCallback(o):o;const l=r.slice(a.length);return{value:o,rest:l}}}const Rte=/^(\d+)(th|st|nd|rd)?/i,Mte=/\d+/i,Lte={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},zte={any:[/^b/i,/^(a|c)/i]},Bte={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Fte={any:[/1/i,/2/i,/3/i,/4/i]},qte={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ute={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Wte={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Hte={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Vte={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$te={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Gte={ordinalNumber:Pte({matchPattern:Rte,parsePattern:Mte,valueCallback:t=>parseInt(t,10)}),era:eg({matchPatterns:Lte,defaultMatchWidth:"wide",parsePatterns:zte,defaultParseWidth:"any"}),quarter:eg({matchPatterns:Bte,defaultMatchWidth:"wide",parsePatterns:Fte,defaultParseWidth:"any",valueCallback:t=>t+1}),month:eg({matchPatterns:qte,defaultMatchWidth:"wide",parsePatterns:Ute,defaultParseWidth:"any"}),day:eg({matchPatterns:Wte,defaultMatchWidth:"wide",parsePatterns:Hte,defaultParseWidth:"any"}),dayPeriod:eg({matchPatterns:Vte,defaultMatchWidth:"any",parsePatterns:$te,defaultParseWidth:"any"})},kz={code:"en-US",formatDistance:yte,formatLong:jte,formatRelative:Ste,localize:Ote,match:Gte,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Kte(t,r){const n=Is(t,r?.in);return _z(n,mte(n))+1}function Qte(t,r){const n=Is(t,r?.in),i=+Bv(n)-+tte(n);return Math.round(i/Nz)+1}function Dz(t,r){const n=Is(t,r?.in),i=n.getFullYear(),a=n0(),s=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,o=nd(r?.in||t,0);o.setFullYear(i+1,0,s),o.setHours(0,0,0,0);const l=cf(o,r),u=nd(r?.in||t,0);u.setFullYear(i,0,s),u.setHours(0,0,0,0);const d=cf(u,r);return+n>=+l?i+1:+n>=+d?i:i-1}function Yte(t,r){const n=n0(),i=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=Dz(t,r),s=nd(r?.in||t,0);return s.setFullYear(a,0,i),s.setHours(0,0,0,0),cf(s,r)}function Zte(t,r){const n=Is(t,r?.in),i=+cf(n,r)-+Yte(n,r);return Math.round(i/Nz)+1}function Mi(t,r){const n=t<0?"-":"",i=Math.abs(t).toString().padStart(r,"0");return n+i}const Vh={y(t,r){const n=t.getFullYear(),i=n>0?n:1-n;return Mi(r==="yy"?i%100:i,r.length)},M(t,r){const n=t.getMonth();return r==="M"?String(n+1):Mi(n+1,2)},d(t,r){return Mi(t.getDate(),r.length)},a(t,r){const n=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return n==="am"?"a.m.":"p.m."}},h(t,r){return Mi(t.getHours()%12||12,r.length)},H(t,r){return Mi(t.getHours(),r.length)},m(t,r){return Mi(t.getMinutes(),r.length)},s(t,r){return Mi(t.getSeconds(),r.length)},S(t,r){const n=r.length,i=t.getMilliseconds(),a=Math.trunc(i*Math.pow(10,n-3));return Mi(a,r.length)}},np={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},H8={G:function(t,r,n){const i=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){const i=t.getFullYear(),a=i>0?i:1-i;return n.ordinalNumber(a,{unit:"year"})}return Vh.y(t,r)},Y:function(t,r,n,i){const a=Dz(t,i),s=a>0?a:1-a;if(r==="YY"){const o=s%100;return Mi(o,2)}return r==="Yo"?n.ordinalNumber(s,{unit:"year"}):Mi(s,r.length)},R:function(t,r){const n=Ez(t);return Mi(n,r.length)},u:function(t,r){const n=t.getFullYear();return Mi(n,r.length)},Q:function(t,r,n){const i=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(i);case"QQ":return Mi(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,r,n){const i=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(i);case"qq":return Mi(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,r,n){const i=t.getMonth();switch(r){case"M":case"MM":return Vh.M(t,r);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,r,n){const i=t.getMonth();switch(r){case"L":return String(i+1);case"LL":return Mi(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,r,n,i){const a=Zte(t,i);return r==="wo"?n.ordinalNumber(a,{unit:"week"}):Mi(a,r.length)},I:function(t,r,n){const i=Qte(t);return r==="Io"?n.ordinalNumber(i,{unit:"week"}):Mi(i,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Vh.d(t,r)},D:function(t,r,n){const i=Kte(t);return r==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Mi(i,r.length)},E:function(t,r,n){const i=t.getDay();switch(r){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,r,n,i){const a=t.getDay(),s=(a-i.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return Mi(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,n,i){const a=t.getDay(),s=(a-i.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return Mi(s,r.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,n){const i=t.getDay(),a=i===0?7:i;switch(r){case"i":return String(a);case"ii":return Mi(a,r.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,r,n){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,n){const i=t.getHours();let a;switch(i===12?a=np.noon:i===0?a=np.midnight:a=i/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,n){const i=t.getHours();let a;switch(i>=17?a=np.evening:i>=12?a=np.afternoon:i>=4?a=np.morning:a=np.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){let i=t.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Vh.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Vh.H(t,r)},K:function(t,r,n){const i=t.getHours()%12;return r==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Mi(i,r.length)},k:function(t,r,n){let i=t.getHours();return i===0&&(i=24),r==="ko"?n.ordinalNumber(i,{unit:"hour"}):Mi(i,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Vh.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Vh.s(t,r)},S:function(t,r){return Vh.S(t,r)},X:function(t,r,n){const i=t.getTimezoneOffset();if(i===0)return"Z";switch(r){case"X":return $8(i);case"XXXX":case"XX":return kf(i);default:return kf(i,":")}},x:function(t,r,n){const i=t.getTimezoneOffset();switch(r){case"x":return $8(i);case"xxxx":case"xx":return kf(i);default:return kf(i,":")}},O:function(t,r,n){const i=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+V8(i,":");default:return"GMT"+kf(i,":")}},z:function(t,r,n){const i=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+V8(i,":");default:return"GMT"+kf(i,":")}},t:function(t,r,n){const i=Math.trunc(+t/1e3);return Mi(i,r.length)},T:function(t,r,n){return Mi(+t,r.length)}};function V8(t,r=""){const n=t>0?"-":"+",i=Math.abs(t),a=Math.trunc(i/60),s=i%60;return s===0?n+String(a):n+String(a)+r+Mi(s,2)}function $8(t,r){return t%60===0?(t>0?"-":"+")+Mi(Math.abs(t)/60,2):kf(t,r)}function kf(t,r=""){const n=t>0?"-":"+",i=Math.abs(t),a=Mi(Math.trunc(i/60),2),s=Mi(i%60,2);return n+a+r+s}const G8=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});default:return r.date({width:"full"})}},Pz=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});default:return r.time({width:"full"})}},Xte=(t,r)=>{const n=t.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return G8(t,r);let s;switch(i){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",G8(i,r)).replace("{{time}}",Pz(a,r))},Jte={p:Pz,P:Xte},ere=/^D+$/,tre=/^Y+$/,rre=["D","DD","YY","YYYY"];function nre(t){return ere.test(t)}function ire(t){return tre.test(t)}function are(t,r,n){const i=sre(t,r,n);if(console.warn(i),rre.includes(t))throw new RangeError(i)}function sre(t,r,n){const i=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ore=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lre=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cre=/^'([^]*?)'?$/,dre=/''/g,ure=/[a-zA-Z]/;function Ze(t,r,n){const i=n0(),a=n?.locale??i.locale??kz,s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,l=Is(t,n?.in);if(!ite(l))throw new RangeError("Invalid time value");let u=r.match(lre).map(f=>{const p=f[0];if(p==="p"||p==="P"){const x=Jte[p];return x(f,a.formatLong)}return f}).join("").match(ore).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const p=f[0];if(p==="'")return{isToken:!1,value:hre(f)};if(H8[p])return{isToken:!0,value:f};if(p.match(ure))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:f}});a.localize.preprocessor&&(u=a.localize.preprocessor(l,u));const d={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return u.map(f=>{if(!f.isToken)return f.value;const p=f.value;(!n?.useAdditionalWeekYearTokens&&ire(p)||!n?.useAdditionalDayOfYearTokens&&nre(p))&&are(p,r,String(t));const x=H8[p[0]];return x(l,p,a.localize,d)}).join("")}function hre(t){const r=t.match(cre);return r?r[1].replace(dre,"'"):t}function fre(t,r,n){const i=n0(),a=n?.locale??i.locale??kz,s=2520,o=pv(t,r);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:o}),[u,d]=i0(n?.in,...o>0?[r,t]:[t,r]),f=ute(d,u),p=(Fv(d)-Fv(u))/1e3,x=Math.round((f-p)/60);let v;if(x<2)return n?.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,l):f<10?a.formatDistance("lessThanXSeconds",10,l):f<20?a.formatDistance("lessThanXSeconds",20,l):f<40?a.formatDistance("halfAMinute",0,l):f<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):x===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",x,l);if(x<45)return a.formatDistance("xMinutes",x,l);if(x<90)return a.formatDistance("aboutXHours",1,l);if(x<q8){const w=Math.round(x/60);return a.formatDistance("aboutXHours",w,l)}else{if(x<s)return a.formatDistance("xDays",1,l);if(x<qx){const w=Math.round(x/q8);return a.formatDistance("xDays",w,l)}else if(x<qx*2)return v=Math.round(x/qx),a.formatDistance("aboutXMonths",v,l)}if(v=dte(d,u),v<12){const w=Math.round(x/qx);return a.formatDistance("xMonths",w,l)}else{const w=v%12,C=Math.trunc(v/12);return w<3?a.formatDistance("aboutXYears",C,l):w<9?a.formatDistance("overXYears",C,l):a.formatDistance("almostXYears",C+1,l)}}function mre(t,r){return fre(t,rte(t),r)}function pre(){return Object.assign({},n0())}function HA(t,r,n){return hl(t,-r,n)}function K8(t,r){const n=()=>nd(r?.in,NaN),a=vre(t);let s;if(a.date){const d=bre(a.date,2);s=jre(d.restDateString,d.year)}if(!s||isNaN(+s))return n();const o=+s;let l=0,u;if(a.time&&(l=wre(a.time),isNaN(l)))return n();if(a.timezone){if(u=Sre(a.timezone),isNaN(u))return n()}else{const d=new Date(o+l),f=Is(0,r?.in);return f.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),f.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),f}return Is(o+l+u,r?.in)}const Wx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},gre=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,yre=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,xre=/^([+-])(\d{2})(?::?(\d{2}))?$/;function vre(t){const r={},n=t.split(Wx.dateTimeDelimiter);let i;if(n.length>2)return r;if(/:/.test(n[0])?i=n[0]:(r.date=n[0],i=n[1],Wx.timeZoneDelimiter.test(r.date)&&(r.date=t.split(Wx.timeZoneDelimiter)[0],i=t.substr(r.date.length,t.length))),i){const a=Wx.timezone.exec(i);a?(r.time=i.replace(a[1],""),r.timezone=a[1]):r.time=i}return r}function bre(t,r){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),i=t.match(n);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?a:s*100,restDateString:t.slice((i[1]||i[2]).length)}}function jre(t,r){if(r===null)return new Date(NaN);const n=t.match(gre);if(!n)return new Date(NaN);const i=!!n[4],a=tg(n[1]),s=tg(n[2])-1,o=tg(n[3]),l=tg(n[4]),u=tg(n[5])-1;if(i)return _re(r,l,u)?Cre(r,l,u):new Date(NaN);{const d=new Date(0);return!Are(r,s,o)||!Ere(r,a)?new Date(NaN):(d.setUTCFullYear(r,s,Math.max(a,o)),d)}}function tg(t){return t?parseInt(t):1}function wre(t){const r=t.match(yre);if(!r)return NaN;const n=L5(r[1]),i=L5(r[2]),a=L5(r[3]);return Tre(n,i,a)?n*Az+i*WA+a*1e3:NaN}function L5(t){return t&&parseFloat(t.replace(",","."))||0}function Sre(t){if(t==="Z")return 0;const r=t.match(xre);if(!r)return 0;const n=r[1]==="+"?-1:1,i=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return Ire(i,a)?n*(i*Az+a*WA):NaN}function Cre(t,r,n){const i=new Date(0);i.setUTCFullYear(t,0,4);const a=i.getUTCDay()||7,s=(r-1)*7+n+1-a;return i.setUTCDate(i.getUTCDate()+s),i}const Nre=[31,null,31,30,31,30,31,31,30,31,30,31];function Rz(t){return t%400===0||t%4===0&&t%100!==0}function Are(t,r,n){return r>=0&&r<=11&&n>=1&&n<=(Nre[r]||(Rz(t)?29:28))}function Ere(t,r){return r>=1&&r<=(Rz(t)?366:365)}function _re(t,r,n){return r>=1&&r<=53&&n>=0&&n<=6}function Tre(t,r,n){return t===24?r===0&&n===0:n>=0&&n<60&&r>=0&&r<60&&t>=0&&t<25}function Ire(t,r){return r>=0&&r<=59}function Ore(t,r,n){return Tz(t,-1,n)}function Q8(t,r,n){const i=pre(),a=Pre(t,n.timeZone,n.locale??i.locale);return"formatToParts"in a?kre(a,r):Dre(a,r)}function kre(t,r){const n=t.formatToParts(r);for(let i=n.length-1;i>=0;--i)if(n[i].type==="timeZoneName")return n[i].value}function Dre(t,r){const n=t.format(r).replace(/\u200E/g,""),i=/ [\w-+ ]+$/.exec(n);return i?i[0].substr(1):""}function Pre(t,r,n){return new Intl.DateTimeFormat(n?[n.code,"en-US"]:void 0,{timeZone:r,timeZoneName:t})}function Rre(t,r){const n=Fre(r);return"formatToParts"in n?Lre(n,t):zre(n,t)}const Mre={year:0,month:1,day:2,hour:3,minute:4,second:5};function Lre(t,r){try{const n=t.formatToParts(r),i=[];for(let a=0;a<n.length;a++){const s=Mre[n[a].type];s!==void 0&&(i[s]=parseInt(n[a].value,10))}return i}catch(n){if(n instanceof RangeError)return[NaN];throw n}}function zre(t,r){const n=t.format(r),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n);return[parseInt(i[3],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[4],10),parseInt(i[5],10),parseInt(i[6],10)]}const z5={},Y8=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),Bre=Y8==="06/25/2014, 00:00:00"||Y8==="06/25/2014 00:00:00";function Fre(t){return z5[t]||(z5[t]=Bre?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),z5[t]}function Mz(t,r,n,i,a,s,o){const l=new Date(0);return l.setUTCFullYear(t,r,n),l.setUTCHours(i,a,s,o),l}const Z8=36e5,qre=6e4,B5={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function VA(t,r,n){if(!t)return 0;let i=B5.timezoneZ.exec(t);if(i)return 0;let a,s;if(i=B5.timezoneHH.exec(t),i)return a=parseInt(i[1],10),X8(a)?-(a*Z8):NaN;if(i=B5.timezoneHHMM.exec(t),i){a=parseInt(i[2],10);const o=parseInt(i[3],10);return X8(a,o)?(s=Math.abs(a)*Z8+o*qre,i[1]==="+"?-s:s):NaN}if(Hre(t)){r=new Date(r||Date.now());const o=n?r:Ure(r),l=QC(o,t);return-(n?l:Wre(r,l,t))}return NaN}function Ure(t){return Mz(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}function QC(t,r){const n=Rre(t,r),i=Mz(n[0],n[1]-1,n[2],n[3]%24,n[4],n[5],0).getTime();let a=t.getTime();const s=a%1e3;return a-=s>=0?s:1e3+s,i-a}function Wre(t,r,n){let a=t.getTime()-r;const s=QC(new Date(a),n);if(r===s)return r;a-=s-r;const o=QC(new Date(a),n);return s===o?s:Math.max(s,o)}function X8(t,r){return-23<=t&&t<=23&&(r==null||0<=r&&r<=59)}const J8={};function Hre(t){if(J8[t])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:t}),J8[t]=!0,!0}catch{return!1}}const Vre=60*1e3,$re={X:function(t,r,n){const i=F5(n.timeZone,t);if(i===0)return"Z";switch(r){case"X":return e6(i);case"XXXX":case"XX":return pp(i);default:return pp(i,":")}},x:function(t,r,n){const i=F5(n.timeZone,t);switch(r){case"x":return e6(i);case"xxxx":case"xx":return pp(i);default:return pp(i,":")}},O:function(t,r,n){const i=F5(n.timeZone,t);switch(r){case"O":case"OO":case"OOO":return"GMT"+Gre(i,":");default:return"GMT"+pp(i,":")}},z:function(t,r,n){switch(r){case"z":case"zz":case"zzz":return Q8("short",t,n);default:return Q8("long",t,n)}}};function F5(t,r){const n=t?VA(t,r,!0)/Vre:r?.getTimezoneOffset()??0;if(Number.isNaN(n))throw new RangeError("Invalid time zone specified: "+t);return n}function qv(t,r){const n=t<0?"-":"";let i=Math.abs(t).toString();for(;i.length<r;)i="0"+i;return n+i}function pp(t,r=""){const n=t>0?"-":"+",i=Math.abs(t),a=qv(Math.floor(i/60),2),s=qv(Math.floor(i%60),2);return n+a+r+s}function e6(t,r){return t%60===0?(t>0?"-":"+")+qv(Math.abs(t)/60,2):pp(t,r)}function Gre(t,r=""){const n=t>0?"-":"+",i=Math.abs(t),a=Math.floor(i/60),s=i%60;return s===0?n+String(a):n+String(a)+r+qv(s,2)}function t6(t){const r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+t-+r}const Kre=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,q5=36e5,r6=6e4,Qre=2,Fl={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Kre};function Lz(t,r={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(t===null)return new Date(NaN);const n=r.additionalDigits==null?Qre:Number(r.additionalDigits);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]")return new Date(t.getTime());if(typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]")return new Date(t);if(Object.prototype.toString.call(t)!=="[object String]")return new Date(NaN);const i=Yre(t),{year:a,restDateString:s}=Zre(i.date,n),o=Xre(s,a);if(o===null||isNaN(o.getTime()))return new Date(NaN);if(o){const l=o.getTime();let u=0,d;if(i.time&&(u=Jre(i.time),u===null||isNaN(u)))return new Date(NaN);if(i.timeZone||r.timeZone){if(d=VA(i.timeZone||r.timeZone,new Date(l+u)),isNaN(d))return new Date(NaN)}else d=t6(new Date(l+u)),d=t6(new Date(l+u+d));return new Date(l+u+d)}else return new Date(NaN)}function Yre(t){const r={};let n=Fl.dateTimePattern.exec(t),i;if(n?(r.date=n[1],i=n[3]):(n=Fl.datePattern.exec(t),n?(r.date=n[1],i=n[2]):(r.date=null,i=t)),i){const a=Fl.timeZone.exec(i);a?(r.time=i.replace(a[1],""),r.timeZone=a[1].trim()):r.time=i}return r}function Zre(t,r){if(t){const n=Fl.YYY[r],i=Fl.YYYYY[r];let a=Fl.YYYY.exec(t)||i.exec(t);if(a){const s=a[1];return{year:parseInt(s,10),restDateString:t.slice(s.length)}}if(a=Fl.YY.exec(t)||n.exec(t),a){const s=a[1];return{year:parseInt(s,10)*100,restDateString:t.slice(s.length)}}}return{year:null}}function Xre(t,r){if(r===null)return null;let n,i,a;if(!t||!t.length)return n=new Date(0),n.setUTCFullYear(r),n;let s=Fl.MM.exec(t);if(s)return n=new Date(0),i=parseInt(s[1],10)-1,i6(r,i)?(n.setUTCFullYear(r,i),n):new Date(NaN);if(s=Fl.DDD.exec(t),s){n=new Date(0);const o=parseInt(s[1],10);return rne(r,o)?(n.setUTCFullYear(r,0,o),n):new Date(NaN)}if(s=Fl.MMDD.exec(t),s){n=new Date(0),i=parseInt(s[1],10)-1;const o=parseInt(s[2],10);return i6(r,i,o)?(n.setUTCFullYear(r,i,o),n):new Date(NaN)}if(s=Fl.Www.exec(t),s)return a=parseInt(s[1],10)-1,a6(a)?n6(r,a):new Date(NaN);if(s=Fl.WwwD.exec(t),s){a=parseInt(s[1],10)-1;const o=parseInt(s[2],10)-1;return a6(a,o)?n6(r,a,o):new Date(NaN)}return null}function Jre(t){let r,n,i=Fl.HH.exec(t);if(i)return r=parseFloat(i[1].replace(",",".")),U5(r)?r%24*q5:NaN;if(i=Fl.HHMM.exec(t),i)return r=parseInt(i[1],10),n=parseFloat(i[2].replace(",",".")),U5(r,n)?r%24*q5+n*r6:NaN;if(i=Fl.HHMMSS.exec(t),i){r=parseInt(i[1],10),n=parseInt(i[2],10);const a=parseFloat(i[3].replace(",","."));return U5(r,n,a)?r%24*q5+n*r6+a*1e3:NaN}return null}function n6(t,r,n){r=r||0,n=n||0;const i=new Date(0);i.setUTCFullYear(t,0,4);const a=i.getUTCDay()||7,s=r*7+n+1-a;return i.setUTCDate(i.getUTCDate()+s),i}const ene=[31,28,31,30,31,30,31,31,30,31,30,31],tne=[31,29,31,30,31,30,31,31,30,31,30,31];function zz(t){return t%400===0||t%4===0&&t%100!==0}function i6(t,r,n){if(r<0||r>11)return!1;if(n!=null){if(n<1)return!1;const i=zz(t);if(i&&n>tne[r]||!i&&n>ene[r])return!1}return!0}function rne(t,r){if(r<1)return!1;const n=zz(t);return!(n&&r>366||!n&&r>365)}function a6(t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function U5(t,r,n){return!(t<0||t>=25||r!=null&&(r<0||r>=60)||n!=null&&(n<0||n>=60))}const nne=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function ine(t,r,n={}){r=String(r);const i=r.match(nne);if(i){const a=Lz(n.originalDate||t,n);r=i.reduce(function(s,o){if(o[0]==="'")return s;const l=s.indexOf(o),u=s[l-1]==="'",d=s.replace(o,"'"+$re[o[0]](a,o,n)+"'");return u?d.substring(0,l-1)+d.substring(l+1):d},r)}return Ze(t,r,n)}function s6(t,r,n){t=Lz(t,n);const i=VA(r,t,!0),a=new Date(t.getTime()-i),s=new Date(0);return s.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),s.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),s}function ph(){const{language:t,direction:r}=i2(),{currency:n}=UA(),{data:i}=Ve({queryKey:["localization-settings"],queryFn:async()=>{try{const{data:M}=await xe.get("/localization/settings");return M}catch{return{defaultLanguageCode:"en",defaultTimezone:"Asia/Riyadh",baseCurrencyCode:"SAR",enableMultiCurrencyDisplay:!0,enableUserLanguageOverride:!0,enableUserTimezoneOverride:!0,enableUserCurrencyOverride:!0,dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm",numberFormat:"en-US"}}},staleTime:300*1e3}),{data:a}=Ve({queryKey:["user-preferences"],queryFn:async()=>{try{const{data:M}=await xe.get("/localization/user-preferences");return M}catch{return{preferredCurrencyCode:"SAR",preferredLanguageCode:"en",preferredTimezone:"Asia/Riyadh"}}},staleTime:300*1e3}),{data:s=[]}=Ve({queryKey:["exchange-rates-latest"],queryFn:async()=>{try{const{data:M}=await xe.get("/localization/exchange-rates/latest");return M}catch{return[]}},staleTime:300*1e3}),o=i?.enableUserTimezoneOverride?a?.preferredTimezone||i?.defaultTimezone||"Asia/Riyadh":i?.defaultTimezone||"Asia/Riyadh",l=n||i?.enableUserCurrencyOverride&&a?.preferredCurrencyCode||"SAR",u=i?.dateFormat||"yyyy-MM-dd",d=i?.timeFormat||"HH:mm",f=i?.numberFormat||"en-US",p=(M,Q,U)=>{if(M==null)return"-";const $=typeof M=="string"?parseFloat(M):M;if(isNaN($))return"-";const ee=Q||l,F=U?.decimals??2,Y=U?.showCurrency??!0;let J=$;if(ee!=="SAR"&&i?.enableMultiCurrencyDisplay){const re=s.find(de=>de.fromCurrency===ee);re&&re.rate>0&&(J=$/re.rate)}const Z=new Intl.NumberFormat(f,{minimumFractionDigits:F,maximumFractionDigits:F}).format(J);return Y?`${ee} ${Z}`:Z},x=(M,Q)=>{if(!M)return"-";try{const U=typeof M=="string"?K8(M):M,$=s6(U,o);if(Q?.format)return ine($,Q.format,{timeZone:o});const ee=Ze($,u);if(Q?.includeTime!==!1){const F=Ze($,d);return`${ee} ${F}`}return ee}catch{return String(M)}},v=M=>x(M,{includeTime:!1}),w=M=>{if(!M)return"-";try{const Q=typeof M=="string"?K8(M):M,U=s6(Q,o);return Ze(U,d)}catch{return String(M)}},C=(M,Q)=>{if(M==null)return"-";const U=typeof M=="string"?parseFloat(M):M;return isNaN(U)?"-":new Intl.NumberFormat(f,{minimumFractionDigits:Q?.decimals??0,maximumFractionDigits:Q?.decimals??2,useGrouping:Q?.useGrouping??!0}).format(U)},A=(M,Q=1)=>{if(M==null)return"-";const U=typeof M=="string"?parseFloat(M):M;return isNaN(U)?"-":new Intl.NumberFormat(f,{style:"percent",minimumFractionDigits:Q,maximumFractionDigits:Q}).format(U/100)},T=M=>M==="SAR"?1:s.find(U=>U.fromCurrency===M)?.rate||null;return{language:t,direction:r,timezone:o,displayCurrency:l,baseCurrency:"SAR",dateFormat:u,timeFormat:d,numberLocale:f,settings:i,userPrefs:a,exchangeRates:s,formatMoney:p,formatDateTime:x,formatDateOnly:v,formatTimeOnly:w,formatNumber:C,formatPercent:A,getExchangeRate:T,convertToSar:(M,Q)=>{if(Q==="SAR")return M;const U=T(Q);return U?M*U:null},convertFromSar:(M,Q)=>{if(Q==="SAR")return M;const U=T(Q);return U&&U>0?M/U:null}}}function $A(){const{data:t,isLoading:r}=Ve({queryKey:["branding"],queryFn:async()=>(await xe.get("/api/config/branding")).data,staleTime:36e5,gcTime:864e5});return{siteLogo:t?.siteLogo||null,siteName:t?.siteName||"RadioPharma",companyName:t?.companyName||"RadioPharma",companyNameAr:t?.companyNameAr||" ",isLoading:r}}const ane=()=>typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",o6=t=>t==="system"?ane():t,YC=t=>{document.documentElement.setAttribute("data-theme",t)},ZC=dy()(qA((t,r)=>({theme:"light",resolvedTheme:"light",setTheme:n=>{const i=o6(n);YC(i),t({theme:n,resolvedTheme:i})}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{if(t){const r=o6(t.theme);YC(r),t.resolvedTheme=r}}}));typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{if(ZC.getState().theme==="system"){const n=t.matches?"dark":"light";YC(n),ZC.setState({resolvedTheme:n})}});const sne=[{value:"light",label:"Light",icon:uz},{value:"dark",label:"Dark",icon:oz},{value:"system",label:"System",icon:RZ}];function Bz(){const{theme:t,resolvedTheme:r,setTheme:n}=ZC(),[i,a]=k.useState(!1),s=k.useRef(null);k.useEffect(()=>{const l=u=>{s.current&&!s.current.contains(u.target)&&a(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const o=r==="dark"?oz:uz;return e.jsxs("div",{ref:s,style:{position:"relative"},children:[e.jsx("button",{onClick:()=>a(!i),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px",borderRadius:"var(--radius)",background:"transparent",border:"1px solid var(--border)",color:"var(--text-secondary)",cursor:"pointer",transition:"all 0.15s ease"},title:`Theme: ${t}`,children:e.jsx(o,{size:18})}),i&&e.jsx("div",{style:{position:"absolute",right:0,top:"100%",marginTop:"0.5rem",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",minWidth:"140px",zIndex:1e3,overflow:"hidden"},children:sne.map(l=>{const u=l.icon,d=t===l.value;return e.jsxs("button",{onClick:()=>{n(l.value),a(!1)},style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",padding:"0.625rem 1rem",border:"none",background:d?"var(--primary)":"transparent",color:d?"white":"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem",textAlign:"left",transition:"background 0.15s ease"},onMouseEnter:f=>{d||(f.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:f=>{d||(f.currentTarget.style.background="transparent")},children:[e.jsx(u,{size:16}),l.label]},l.value)})})]})}function GA(){const t=pr(),[r,n]=k.useState(0),[i,a]=k.useState(!1),[s,o]=k.useState(()=>sessionStorage.getItem("announcementBarHidden")==="true"),{data:l=[]}=Ve({queryKey:["active-announcements"],queryFn:async()=>{const{data:T}=await xe.get("/announcements/active");return T},refetchInterval:6e4});ot({mutationFn:async T=>xe.post(`/announcements/${T}/dismiss`),onSuccess:()=>{t.invalidateQueries({queryKey:["active-announcements"]})}});const u=ot({mutationFn:async T=>xe.post(`/announcements/${T}/read`),onSuccess:()=>{t.invalidateQueries({queryKey:["active-announcements"]})}}),d=[...l].sort((T,O)=>{const D={CRITICAL:0,WARNING:1,INFO:2},M=D[T.severity]-D[O.severity];return M!==0?M:new Date(O.createdAt).getTime()-new Date(T.createdAt).getTime()}),f=k.useCallback(()=>{d.length>1&&n(T=>(T+1)%d.length)},[d.length]),p=k.useCallback(()=>{d.length>1&&n(T=>(T-1+d.length)%d.length)},[d.length]);if(k.useEffect(()=>{if(d.length<=1||i)return;const T=setInterval(()=>{f()},1e4);return()=>clearInterval(T)},[d.length,i,f]),k.useEffect(()=>{r>=d.length&&d.length>0&&n(0)},[d.length,r]),d.length===0)return null;const x=d[r]||d[0];if(!x)return null;const v=T=>{switch(T){case"CRITICAL":return{background:"var(--danger)",color:"white"};case"WARNING":return{background:"var(--warning)",color:"white"};default:return{background:"var(--info)",color:"white"}}},w=T=>{switch(T){case"CRITICAL":return e.jsx(sn,{size:16});case"WARNING":return e.jsx(Hr,{size:16});default:return e.jsx(lf,{size:16})}},C=()=>{x.isRead||u.mutate(x.id)},A=T=>{T.stopPropagation(),o(!0),sessionStorage.setItem("announcementBarHidden","true")};return s?null:e.jsxs("div",{style:{...v(x.severity),padding:"0.5rem 1rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",position:"relative",zIndex:100},onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[d.length>1&&e.jsx("button",{onClick:p,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"4px",padding:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit"},title:"Previous",children:e.jsx(Xp,{size:16})}),e.jsxs("div",{onClick:C,style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",flex:1,justifyContent:"center",maxWidth:"800px"},children:[w(x.severity),e.jsx("span",{style:{fontWeight:600},children:x.title}),e.jsx("span",{style:{opacity:.9,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:x.body.length>100?x.body.substring(0,100)+"...":x.body})]}),d.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8},children:[r+1," / ",d.length]}),e.jsx("button",{onClick:f,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"4px",padding:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit"},title:"Next",children:e.jsx(bo,{size:16})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(nr,{to:"/notifications?type=announcements",style:{fontSize:"0.75rem",color:"inherit",opacity:.9,textDecoration:"underline"},children:"View all"}),e.jsx("button",{onClick:A,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"4px",padding:"0.25rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"inherit"},title:"Close announcement bar",children:e.jsx(Dr,{size:16})})]})]})}const one={order:Fo,batch:Bi,customer:Ts,material:Rr,shipment:dn,invoice:td,user:dc,product:Rr},lne={order:"Order",batch:"Batch",customer:"Customer",material:"Material",shipment:"Shipment",invoice:"Invoice",user:"User",product:"Product"};function Fz(){const[t,r]=k.useState(!1),[n,i]=k.useState(""),[a,s]=k.useState(0),o=k.useRef(null),l=Gr(),{t:u}=FA(),{data:d=[],isLoading:f}=Ve({queryKey:["global-search",n],queryFn:async()=>{if(n.length<2)return[];try{const{data:w}=await xe.get(`/search/global?q=${encodeURIComponent(n)}`);return w.results||[]}catch{return p(n)}},enabled:n.length>=2,staleTime:1e3});function p(w){const C=[{id:"1",type:"order",title:"O-2024-001",subtitle:"Al Noor Hospital - FDG-18",path:"/orders/1"},{id:"2",type:"order",title:"O-2024-002",subtitle:"King Faisal Hospital - Ga-68",path:"/orders/2"},{id:"3",type:"batch",title:"B-2024-001",subtitle:"FDG-18 Production",path:"/batches/1"},{id:"4",type:"customer",title:"Al Noor Hospital",subtitle:"Riyadh, Saudi Arabia",path:"/customers/1"},{id:"5",type:"material",title:"FDG-18",subtitle:"Radiopharmaceutical",path:"/materials/1"},{id:"6",type:"shipment",title:"S-2024-001",subtitle:"En Route to Al Noor",path:"/shipments/1"},{id:"7",type:"invoice",title:"INV-2024-001",subtitle:"SAR 15,000",path:"/invoices/1"}],A=w.toLowerCase();return C.filter(T=>T.title.toLowerCase().includes(A)||T.subtitle?.toLowerCase().includes(A))}k.useEffect(()=>{const w=C=>{(C.metaKey||C.ctrlKey)&&C.key==="k"&&(C.preventDefault(),r(!0)),C.key==="Escape"&&r(!1)};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[]),k.useEffect(()=>{t&&o.current&&o.current.focus()},[t]),k.useEffect(()=>{s(0)},[d]);const x=w=>{w.key==="ArrowDown"?(w.preventDefault(),s(C=>Math.min(C+1,d.length-1))):w.key==="ArrowUp"?(w.preventDefault(),s(C=>Math.max(C-1,0))):w.key==="Enter"&&d[a]&&(l(d[a].path),r(!1),i(""))},v=w=>{l(w.path),r(!1),i("")};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>r(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"8px",cursor:"pointer",color:"var(--text-muted)",fontSize:"0.875rem",minWidth:"280px"},children:[e.jsx(Gs,{size:16}),e.jsx("span",{children:"Search..."}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"2px",opacity:.6},children:[e.jsx(wY,{size:12}),e.jsx("span",{style:{fontSize:"0.75rem"},children:"K"})]})]}),t&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:"10vh"},onClick:()=>r(!1),children:e.jsxs("div",{style:{width:"100%",maxWidth:"600px",background:"var(--bg-primary)",borderRadius:"12px",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.25)",overflow:"hidden"},onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem",borderBottom:"1px solid var(--border)"},children:[e.jsx(Gs,{size:20,style:{color:"var(--text-muted)"}}),e.jsx("input",{ref:o,type:"text",value:n,onChange:w=>i(w.target.value),onKeyDown:x,placeholder:"Search orders, batches, customers, materials...",style:{flex:1,border:"none",outline:"none",background:"transparent",fontSize:"1rem",color:"var(--text-primary)"}}),n&&e.jsx("button",{onClick:()=>i(""),style:{background:"none",border:"none",padding:"0.25rem",cursor:"pointer",color:"var(--text-muted)"},children:e.jsx(Dr,{size:16})})]}),e.jsx("div",{style:{maxHeight:"400px",overflow:"auto"},children:n.length<2?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(Gs,{size:32,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsx("div",{children:"Type at least 2 characters to search"})]}):f?e.jsx("div",{style:{padding:"1.5rem",textAlign:"center",color:"var(--text-muted)"},children:"Searching..."}):d.length===0?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(Ir,{size:32,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsxs("div",{children:['No results found for "',n,'"']})]}):d.map((w,C)=>{const A=one[w.type]||Ir;return e.jsxs("div",{onClick:()=>v(w),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.875rem 1rem",cursor:"pointer",background:C===a?"var(--bg-secondary)":"transparent",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(A,{size:18,style:{color:"var(--primary)"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:w.title}),w.subtitle&&e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:w.subtitle})]}),e.jsx("span",{style:{fontSize:"0.6875rem",padding:"0.25rem 0.5rem",borderRadius:"4px",background:"var(--bg-secondary)",color:"var(--text-muted)",textTransform:"uppercase"},children:lne[w.type]})]},`${w.type}-${w.id}`)})}),e.jsxs("div",{style:{padding:"0.75rem 1rem",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"space-between",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("span",{children:" Navigate"}),e.jsx("span",{children:" Select"})]}),e.jsx("span",{children:"ESC Close"})]})]})})]})}const cne={"":{labelKey:"nav.dashboard",fallback:"Dashboard"},orders:{labelKey:"nav.orders",fallback:"Orders"},customers:{labelKey:"nav.customers",fallback:"Customers"},products:{labelKey:"nav.products",fallback:"Products"},materials:{labelKey:"nav.materials",fallback:"Materials"},recipes:{labelKey:"nav.recipes",fallback:"Recipes"},suppliers:{labelKey:"nav.suppliers",fallback:"Suppliers"},"purchase-orders":{labelKey:"nav.purchaseOrders",fallback:"Purchase Orders"},warehouses:{labelKey:"nav.warehouses",fallback:"Warehouses"},grn:{labelKey:"nav.goodsReceiving",fallback:"Goods Receiving"},inventory:{labelKey:"nav.inventory",fallback:"Inventory"},manufacturing:{labelKey:"nav.manufacturing",fallback:"Manufacturing"},availability:{labelKey:"nav.availability",fallback:"Availability"},reservations:{labelKey:"nav.reservations",fallback:"Reservations"},planner:{labelKey:"nav.planner",fallback:"Planner"},"production-schedule":{labelKey:"nav.productionSchedule",fallback:"Production Schedule"},batches:{labelKey:"nav.batches",fallback:"Batches"},qc:{labelKey:"nav.qc",fallback:"Quality Control"},"oos-investigations":{labelKey:"nav.oosInvestigations",fallback:"OOS Investigations"},release:{labelKey:"nav.release",fallback:"QP Release"},dispensing:{labelKey:"nav.dispensing",fallback:"Dispensing"},shipments:{labelKey:"nav.shipments",fallback:"Shipments"},contracts:{labelKey:"nav.contracts",fallback:"Contracts"},invoices:{labelKey:"nav.invoices",fallback:"Invoices"},payments:{labelKey:"nav.payments",fallback:"Payments"},"enterprise-reports":{labelKey:"nav.reports",fallback:"Reports"},users:{labelKey:"nav.users",fallback:"Users"},roles:{labelKey:"nav.roles",fallback:"Roles"},settings:{labelKey:"nav.settings",fallback:"Settings"},audit:{labelKey:"nav.auditLog",fallback:"Audit Log"},approvals:{labelKey:"nav.approvals",fallback:"Approvals"},new:{labelKey:"common.new",fallback:"New"},edit:{labelKey:"common.edit",fallback:"Edit"},details:{labelKey:"common.details",fallback:"Details"}};function dne(){const t=ld(),{t:r}=FA(),n=t.pathname.split("/").filter(Boolean);if(n.length===0)return null;const i=[{label:r("nav.dashboard"),labelKey:"nav.dashboard",path:"/"}];let a="";return n.forEach((s,o)=>{a+=`/${s}`;const l=/^[0-9a-f-]{36}$/i.test(s),u=/^\d+$/.test(s);if(l||u)i.push({label:`#${s.slice(0,8)}...`,path:o===n.length-1?void 0:a});else{const d=cne[s],f=d?r(d.labelKey,d.fallback):s.charAt(0).toUpperCase()+s.slice(1);i.push({label:f,labelKey:d?.labelKey,path:o===n.length-1?void 0:a})}}),i.length<=1?null:e.jsx("nav",{"aria-label":"Breadcrumb",style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 0",fontSize:"0.875rem"},children:i.map((s,o)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o>0&&e.jsx(bo,{size:14,style:{color:"var(--text-muted)"}}),s.path?e.jsxs(nr,{to:s.path,style:{color:"var(--text-muted)",textDecoration:"none",display:"flex",alignItems:"center",gap:"0.25rem"},children:[o===0&&e.jsx(iz,{size:14}),e.jsx("span",{children:s.label})]}):e.jsx("span",{style:{color:"var(--text-primary)",fontWeight:500},children:s.label})]},o))})}const XC=[{id:"orders",label:"Orders & Customers",icon:Fo,items:[{path:"/orders",labelKey:"nav.orders",icon:Fo},{path:"/customers",labelKey:"nav.customers",icon:Ts},{path:"/contracts",labelKey:"nav.contracts",icon:tz},{path:"/availability",labelKey:"nav.availability",icon:WQ},{path:"/reservations",labelKey:"nav.reservations",icon:zC}]},{id:"production",label:"Production",icon:lu,items:[{path:"/planner",labelKey:"nav.planner",icon:$n},{path:"/production-schedule",labelKey:"nav.productionSchedule",icon:e2},{path:"/batches",labelKey:"nav.batches",icon:Bi},{path:"/manufacturing",labelKey:"nav.manufacturing",icon:lu},{path:"/dispensing",labelKey:"nav.dispensing",icon:Bf}]},{id:"quality",label:"Quality",icon:sf,items:[{path:"/qc",labelKey:"nav.qc",icon:sf},{path:"/oos-investigations",labelKey:"nav.oosInvestigations",icon:Hr},{path:"/release",labelKey:"nav.release",icon:Ft},{path:"/admin/qc/test-definitions",labelKey:"nav.qcTestDefinitions",icon:Ir}]},{id:"logistics",label:"Logistics",icon:dn,items:[{path:"/shipments",labelKey:"nav.shipments",icon:dn}]},{id:"inventory",label:"Inventory & Supply",icon:lm,items:[{path:"/products",labelKey:"nav.products",icon:Rr},{path:"/materials",labelKey:"nav.materials",icon:Bi},{path:"/recipes",labelKey:"nav.recipes",icon:Ir},{path:"/suppliers",labelKey:"nav.suppliers",icon:Ts},{path:"/purchase-orders",labelKey:"nav.purchaseOrders",icon:Fo},{path:"/warehouses",labelKey:"nav.warehouses",icon:lm},{path:"/grn",labelKey:"nav.goodsReceiving",icon:qZ},{path:"/inventory",labelKey:"nav.inventory",icon:YL}]},{id:"finance",label:"Finance",icon:Ul,items:[{path:"/invoices",labelKey:"nav.invoices",icon:td},{path:"/payments",labelKey:"nav.payments",icon:Ul}]},{id:"admin",label:"Administration",icon:sh,items:[{path:"/approvals",labelKey:"nav.approvals",icon:gu},{path:"/admin/helpdesk",labelKey:"Support Tickets",icon:Sm},{path:"/users",labelKey:"nav.users",icon:dc},{path:"/roles",labelKey:"nav.roles",icon:aa},{path:"/enterprise-reports",labelKey:"Enterprise Reports",icon:Ir},{path:"/settings",labelKey:"nav.settings",icon:sh},{path:"/audit",labelKey:"nav.auditLog",icon:Ir}]}],l6=[{path:"/",labelKey:"nav.dashboard",icon:zA},...XC.flatMap(t=>t.items)],une={"Asia/Riyadh":"AST","Asia/Dubai":"GST","Asia/Kuwait":"AST","Asia/Bahrain":"AST","Asia/Qatar":"AST","Europe/London":"GMT","Europe/Paris":"CET","America/New_York":"EST","America/Los_Angeles":"PST",UTC:"UTC"},hne={en:"EN",ar:"AR",fr:"FR",es:"ES"};function fne({children:t}){const[r,n]=k.useState(window.innerWidth>768),[i,a]=k.useState(!1),[s,o]=k.useState(!1),[l,u]=k.useState(!1),[d,f]=k.useState(!1),[p,x]=k.useState(new Date),[v,w]=k.useState(window.innerWidth<=768),C=()=>{const st=localStorage.getItem("radiopharma-expanded-sections");if(st)try{return JSON.parse(st)}catch{return["orders","production"]}return["orders","production"]},[A,T]=k.useState(C),O=k.useRef(null),D=k.useRef(null),M=k.useRef(null),Q=ld(),{favorites:U,toggleFavorite:$}=Xee();k.useEffect(()=>{const st=()=>{const Wt=window.innerWidth<=768;w(Wt),Wt||a(!1)};return window.addEventListener("resize",st),()=>window.removeEventListener("resize",st)},[]),k.useEffect(()=>{v&&a(!1)},[Q.pathname]);const ee=Gr(),F=pr(),{user:Y,logout:J}=Il(),{t:Z}=FA(),{language:re,setLanguage:de}=i2(),{currency:le,setCurrency:K}=UA(),ue=re==="ar",{formatTimeOnly:ce,formatDateOnly:ye,formatDateTime:Se,exchangeRates:V}=ph(),{siteLogo:X,siteName:se}=$A(),{data:W}=Ve({queryKey:["system-settings"],queryFn:async()=>{const{data:st}=await xe.get("/settings/system");return st},staleTime:300*1e3});k.useEffect(()=>{const st=setInterval(()=>{x(new Date)},6e4);return()=>clearInterval(st)},[]);const oe=()=>ce(p),ge=()=>ye(p),be=W?.timezone?une[W.timezone]||W.timezone.split("/").pop():"AST";hne[W?.language||"en"],W?.currency?.code||W?.currencyCode;const{data:Le}=Ve({queryKey:["notifications"],queryFn:async()=>{const{data:st}=await xe.get("/notifications?limit=10");return st},refetchInterval:3e4}),ke=ot({mutationFn:async st=>{await xe.patch(`/notifications/${st}/read`)},onSuccess:()=>{F.invalidateQueries({queryKey:["notifications"]})}}),He=ot({mutationFn:async()=>{await xe.patch("/notifications/read-all")},onSuccess:()=>{F.invalidateQueries({queryKey:["notifications"]})}});k.useEffect(()=>{const st=Wt=>{O.current&&!O.current.contains(Wt.target)&&o(!1),D.current&&!D.current.contains(Wt.target)&&u(!1),M.current&&!M.current.contains(Wt.target)&&f(!1)};return document.addEventListener("mousedown",st),()=>document.removeEventListener("mousedown",st)},[]);const Je=async()=>{await J(),ee("/login")},Qe=st=>{T(Wt=>{const Bt=Wt.includes(st)?Wt.filter(yt=>yt!==st):[...Wt,st];return localStorage.setItem("radiopharma-expanded-sections",JSON.stringify(Bt)),Bt})};k.useEffect(()=>{const st=XC.find(Wt=>Wt.items.some(Bt=>Q.pathname===Bt.path||Q.pathname.startsWith(Bt.path+"/")));st&&!A.includes(st.id)&&T(Wt=>{const Bt=[...Wt,st.id];return localStorage.setItem("radiopharma-expanded-sections",JSON.stringify(Bt)),Bt})},[Q.pathname]);const vt=Le?.unreadCount||0,Pt=Le?.notifications||[],Oe=v||r?"16rem":"4rem";return e.jsxs("div",{style:{display:"flex",minHeight:"100vh"},children:[v&&i&&e.jsx("div",{onClick:()=>a(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:35}}),e.jsxs("aside",{style:{width:Oe,background:"linear-gradient(180deg, #1e3a5f 0%, #0f172a 100%)",color:"white",transition:"all 0.2s ease",display:"flex",flexDirection:"column",position:"fixed",height:"100vh",zIndex:40,left:ue?"auto":0,right:ue?0:"auto",transform:v&&!i?ue?"translateX(100%)":"translateX(-100%)":"translateX(0)"},children:[e.jsxs("div",{style:{padding:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[X?e.jsx("img",{src:X,alt:se,style:{width:"36px",height:"36px",objectFit:"contain",borderRadius:"6px"}}):null,e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.125rem",fontWeight:700},children:se}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.7},children:"OMS v1.0.0"})]})]}),v?e.jsx("button",{onClick:()=>a(!1),style:{background:"none",border:"none",color:"white",padding:"0.5rem"},children:e.jsx(Dr,{size:20})}):e.jsx("button",{onClick:()=>n(!r),style:{background:"none",border:"none",color:"white",padding:"0.5rem"},children:r?e.jsx(Dr,{size:20}):e.jsx(FC,{size:20})})]}),e.jsxs("nav",{style:{flex:1,padding:"0.5rem",overflowY:"auto"},children:[e.jsxs(nr,{to:"/",onClick:()=>v&&a(!1),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",borderRadius:"8px",textDecoration:"none",color:Q.pathname==="/"?"white":"rgba(255,255,255,0.7)",background:Q.pathname==="/"?"rgba(255,255,255,0.1)":"transparent",marginBottom:"0.25rem"},children:[e.jsx(zA,{size:20}),(v||r)&&e.jsx("span",{style:{fontSize:"0.875rem"},children:Z("nav.dashboard")})]}),U.length>0&&(v||r)&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{fontSize:"0.6875rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"rgba(255,255,255,0.5)",padding:"0.5rem 0.75rem 0.25rem",display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(x8,{size:12}),"Favorites"]}),U.map(st=>{const Wt=l6.find(rr=>rr.path===st);if(!Wt)return null;const Bt=Wt.icon,yt=Q.pathname===Wt.path;return e.jsxs(nr,{to:Wt.path,onClick:()=>v&&a(!1),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.5rem 0.75rem",borderRadius:"8px",textDecoration:"none",color:yt?"white":"rgba(255,255,255,0.7)",background:yt?"rgba(255,255,255,0.1)":"transparent",marginBottom:"0.125rem",fontSize:"0.8125rem"},children:[e.jsx(Bt,{size:16}),e.jsx("span",{children:Z(Wt.labelKey)})]},`fav-${Wt.path}`)})]}),XC.map(st=>{const Wt=st.icon,Bt=A.includes(st.id),yt=st.items.some(rr=>Q.pathname===rr.path||Q.pathname.startsWith(rr.path+"/"));return e.jsxs("div",{style:{marginBottom:"0.25rem"},children:[e.jsxs("button",{onClick:()=>Qe(st.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",borderRadius:"8px",background:yt&&!Bt?"rgba(255,255,255,0.05)":"transparent",border:"none",color:yt?"white":"rgba(255,255,255,0.7)",cursor:"pointer",textAlign:"left"},children:[e.jsx(Wt,{size:20}),(v||r)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{flex:1,fontSize:"0.875rem",fontWeight:yt?500:400},children:st.label}),Bt?e.jsx(qo,{size:16}):e.jsx(bo,{size:16})]})]}),Bt&&(v||r)&&e.jsx("div",{style:{paddingLeft:"1rem",marginTop:"0.125rem"},children:st.items.map(rr=>{const St=rr.icon,xr=Q.pathname===rr.path||Q.pathname.startsWith(rr.path+"/"),hr=U.includes(rr.path);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsxs(nr,{to:rr.path,onClick:()=>v&&a(!1),style:{flex:1,display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.5rem 0.75rem",borderRadius:"6px",textDecoration:"none",color:xr?"white":"rgba(255,255,255,0.65)",background:xr?"rgba(255,255,255,0.1)":"transparent",marginBottom:"0.125rem",fontSize:"0.8125rem"},children:[e.jsx(St,{size:16}),e.jsx("span",{children:Z(rr.labelKey)})]}),e.jsx("button",{onClick:zr=>{zr.stopPropagation(),$(rr.path)},style:{background:"none",border:"none",padding:"0.375rem",cursor:"pointer",color:hr?"#fbbf24":"rgba(255,255,255,0.3)",opacity:hr?1:.5},title:hr?"Remove from favorites":"Add to favorites",children:hr?e.jsx(x8,{size:14,fill:"#fbbf24"}):e.jsx(pX,{size:14})})]},rr.path)})})]},st.id)})]}),e.jsx("div",{style:{padding:"1rem",borderTop:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs("button",{onClick:Je,style:{display:"flex",alignItems:"center",gap:"0.75rem",width:"100%",padding:"0.75rem",borderRadius:"8px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:[e.jsx(BA,{size:20}),(v||r)&&e.jsx("span",{style:{fontSize:"0.875rem"},children:"Logout"})]})})]}),e.jsxs("div",{style:{flex:1,marginLeft:v||ue?0:r?"16rem":"4rem",marginRight:v?0:ue?r?"16rem":"4rem":0,transition:"margin 0.2s ease"},children:[e.jsxs("header",{style:{background:"var(--bg-primary)",borderBottom:"1px solid var(--border)",padding:v?"0.75rem 1rem":"0.75rem 1.5rem",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:30,gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[v&&e.jsx("button",{onClick:()=>a(!0),style:{background:"none",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},children:e.jsx(FC,{size:24})}),e.jsx("h2",{style:{fontSize:v?"1rem":"1.125rem",fontWeight:600,margin:0},children:v?"RadioPharma":Z(l6.find(st=>st.path===Q.pathname)?.labelKey||"RadioPharma OMS")})]}),!v&&e.jsx(Fz,{}),!v&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",background:"var(--bg-secondary)",borderRadius:"8px",padding:"0.375rem 0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",borderRight:"1px solid var(--border)"},children:[e.jsx($n,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:ge()})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",borderRight:"1px solid var(--border)"},children:[e.jsx(Qt,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:oe()}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:be})]}),e.jsxs("div",{ref:D,style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>u(!l),style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",borderRight:"1px solid var(--border)",background:l?"var(--bg-secondary)":"none",border:"none",cursor:"pointer",borderRadius:"4px"},children:[e.jsx(py,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:re==="ar"?"AR":"EN"})]}),l&&e.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"var(--shadow-lg)",minWidth:"140px",zIndex:1e3,overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>{de("en"),u(!1)},style:{width:"100%",padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem",border:"none",background:re==="en"?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem",textAlign:"left"},children:[e.jsx("span",{style:{fontWeight:re==="en"?600:400},children:"English"}),re==="en"&&e.jsx(Ai,{size:14,style:{marginLeft:"auto",color:"var(--primary)"}})]}),e.jsxs("button",{onClick:()=>{de("ar"),u(!1)},style:{width:"100%",padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem",border:"none",background:re==="ar"?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem",textAlign:"left",fontFamily:"'Cairo', sans-serif"},children:[e.jsx("span",{style:{fontWeight:re==="ar"?600:400},children:""}),re==="ar"&&e.jsx(Ai,{size:14,style:{marginLeft:"auto",color:"var(--primary)"}})]})]})]}),e.jsxs("div",{ref:M,style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>f(!d),style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",background:d?"var(--bg-secondary)":"none",border:"none",cursor:"pointer",borderRadius:"4px"},children:[e.jsx(of,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:le}),e.jsx(qo,{size:12,style:{color:"var(--text-muted)"}})]}),d&&e.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"var(--shadow-lg)",minWidth:"120px",zIndex:1e3,overflow:"hidden",maxHeight:"240px",overflowY:"auto"},children:[e.jsxs("button",{onClick:()=>{K("SAR"),f(!1)},style:{width:"100%",padding:"0.625rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",border:"none",background:le==="SAR"?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("span",{style:{fontWeight:le==="SAR"?600:400},children:"SAR"}),le==="SAR"&&e.jsx(Ai,{size:14,style:{color:"var(--primary)"}})]}),V.filter(st=>st.fromCurrency!=="SAR").map(st=>e.jsxs("button",{onClick:()=>{K(st.fromCurrency),f(!1)},style:{width:"100%",padding:"0.625rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",border:"none",background:le===st.fromCurrency?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("span",{style:{fontWeight:le===st.fromCurrency?600:400},children:st.fromCurrency}),le===st.fromCurrency&&e.jsx(Ai,{size:14,style:{color:"var(--primary)"}})]},st.fromCurrency))]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Bz,{}),e.jsxs("div",{ref:O,style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>o(!s),style:{background:s?"var(--bg-secondary)":"none",border:"none",padding:"0.5rem",borderRadius:"8px",cursor:"pointer",position:"relative"},children:[e.jsx(xo,{size:20}),vt>0&&e.jsx("span",{style:{position:"absolute",top:"2px",right:"2px",width:"18px",height:"18px",borderRadius:"50%",background:"#ef4444",color:"white",fontSize:"0.65rem",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center"},children:vt>9?"9+":vt})]}),s&&e.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",width:"360px",maxHeight:"480px",background:"var(--bg-primary)",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0,0,0,0.15)",border:"1px solid var(--border)",overflow:"hidden",zIndex:100},children:[e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h4",{style:{margin:0,fontWeight:600},children:"Notifications"}),vt>0&&e.jsxs("button",{onClick:()=>He.mutate(),style:{background:"none",border:"none",color:"var(--primary)",fontSize:"0.75rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ai,{size:12}),"Mark all read"]})]}),e.jsx("div",{style:{maxHeight:"360px",overflow:"auto"},children:Pt.length===0?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(xo,{size:32,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsx("div",{children:"No notifications"})]}):Pt.slice(0,5).map(st=>e.jsx("div",{onClick:()=>{st.isRead||ke.mutate(st.id)},style:{padding:"0.875rem 1rem",borderBottom:"1px solid var(--border)",background:st.isRead?"transparent":"rgba(59, 130, 246, 0.05)",cursor:st.isRead?"default":"pointer"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[!st.isRead&&e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--primary)",marginTop:"6px",flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:st.isRead?400:600,fontSize:"0.875rem",marginBottom:"0.25rem"},children:st.title}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",lineHeight:1.4,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:st.message}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.375rem"},children:Se(st.createdAt)})]})]})},st.id))}),e.jsx("div",{style:{padding:"0.75rem 1rem",borderTop:"1px solid var(--border)",textAlign:"center"},children:e.jsx(nr,{to:"/notifications",onClick:()=>o(!1),style:{color:"var(--primary)",fontSize:"0.875rem",fontWeight:500,textDecoration:"none"},children:"View All Notifications"})})]})]}),e.jsxs("div",{onClick:()=>{const st=Y?.role==="Admin"||Y?.role==="ADMIN"||Y?.role?.toLowerCase()==="admin";ee(st?"/settings":"/profile")},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"var(--bg-secondary)",borderRadius:"9999px",cursor:"pointer",transition:"background 0.15s ease"},onMouseEnter:st=>st.currentTarget.style.background="var(--border)",onMouseLeave:st=>st.currentTarget.style.background="var(--bg-secondary)",title:Y?.role==="Admin"||Y?.role==="ADMIN"?"Go to Settings":"Go to Profile",children:[e.jsxs("div",{style:{width:"2rem",height:"2rem",borderRadius:"50%",background:"var(--primary)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.875rem"},children:[Y?.firstName?.[0],Y?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:500},children:[Y?.firstName," ",Y?.lastName]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Y?.role})]})]})]})]}),e.jsx(GA,{}),e.jsxs("main",{style:{padding:"1.5rem"},children:[e.jsx(dne,{}),t]})]})]})}function qz({showSearch:t=!0,notificationCenterPath:r="/notifications",accentColor:n="var(--primary)"}){const i=Gr(),a=pr(),{language:s,setLanguage:o}=i2(),{currency:l,setCurrency:u}=UA(),{exchangeRates:d}=ph(),[f,p]=k.useState(new Date),[x,v]=k.useState(!1),[w,C]=k.useState(!1),[A,T]=k.useState(!1),O=k.useRef(null),D=k.useRef(null),M=k.useRef(null);k.useEffect(()=>{const re=setInterval(()=>p(new Date),6e4);return()=>clearInterval(re)},[]),k.useEffect(()=>{const re=de=>{O.current&&!O.current.contains(de.target)&&v(!1),D.current&&!D.current.contains(de.target)&&C(!1),M.current&&!M.current.contains(de.target)&&T(!1)};return document.addEventListener("mousedown",re),()=>document.removeEventListener("mousedown",re)},[]);const{data:Q}=Ve({queryKey:["notifications","unread"],queryFn:async()=>(await xe.get("/api/notifications?limit=5&unreadOnly=true")).data,refetchInterval:3e4}),U=ot({mutationFn:re=>xe.patch(`/api/notifications/${re}/read`),onSuccess:()=>a.invalidateQueries({queryKey:["notifications"]})}),$="AST",ee=()=>f.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/(\d+)\/(\d+)\/(\d+)/,"$3-$1-$2"),F=()=>f.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),Y=Q?.unreadCount||0,J=Q?.notifications||[],Z=re=>{if(re.isRead||U.mutate(re.id),re.relatedType&&re.relatedId){const de={ORDER:`/orders/${re.relatedId}`,BATCH:`/batches/${re.relatedId}`,SHIPMENT:`/shipments/${re.relatedId}`,INVOICE:`/invoices/${re.relatedId}`};de[re.relatedType]&&i(de[re.relatedType])}T(!1)};return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flex:1,justifyContent:"flex-end"},children:[t&&e.jsx(Fz,{}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",background:"var(--bg-secondary)",borderRadius:"8px",padding:"0.375rem 0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",borderRight:"1px solid var(--border)"},children:[e.jsx($n,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:ee()})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",borderRight:"1px solid var(--border)"},children:[e.jsx(Qt,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:F()}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:$})]}),e.jsxs("div",{ref:O,style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>v(!x),style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",borderRight:"1px solid var(--border)",background:x?"var(--bg-secondary)":"none",border:"none",cursor:"pointer",borderRadius:"4px"},children:[e.jsx(py,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:s==="ar"?"AR":"EN"})]}),x&&e.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"var(--shadow-lg)",minWidth:"140px",zIndex:1e3,overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>{o("en"),v(!1)},style:{width:"100%",padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem",border:"none",background:s==="en"?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem",textAlign:"left"},children:[e.jsx("span",{style:{fontWeight:s==="en"?600:400},children:"English"}),s==="en"&&e.jsx(Ai,{size:14,style:{marginLeft:"auto",color:n}})]}),e.jsxs("button",{onClick:()=>{o("ar"),v(!1)},style:{width:"100%",padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"0.5rem",border:"none",background:s==="ar"?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem",textAlign:"left",fontFamily:"'Cairo', sans-serif"},children:[e.jsx("span",{style:{fontWeight:s==="ar"?600:400},children:""}),s==="ar"&&e.jsx(Ai,{size:14,style:{marginLeft:"auto",color:n}})]})]})]}),e.jsxs("div",{ref:D,style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>C(!w),style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.25rem 0.625rem",background:w?"var(--bg-secondary)":"none",border:"none",cursor:"pointer",borderRadius:"4px"},children:[e.jsx(of,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:l}),e.jsx(qo,{size:12,style:{color:"var(--text-muted)"}})]}),w&&e.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"var(--shadow-lg)",minWidth:"120px",zIndex:1e3,overflow:"hidden",maxHeight:"240px",overflowY:"auto"},children:[e.jsxs("button",{onClick:()=>{u("SAR"),C(!1)},style:{width:"100%",padding:"0.625rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",border:"none",background:l==="SAR"?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("span",{style:{fontWeight:l==="SAR"?600:400},children:"SAR"}),l==="SAR"&&e.jsx(Ai,{size:14,style:{color:n}})]}),d.filter(re=>re.fromCurrency!=="SAR").map(re=>e.jsxs("button",{onClick:()=>{u(re.fromCurrency),C(!1)},style:{width:"100%",padding:"0.625rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",border:"none",background:l===re.fromCurrency?"var(--bg-secondary)":"var(--bg-primary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("span",{style:{fontWeight:l===re.fromCurrency?600:400},children:re.fromCurrency}),l===re.fromCurrency&&e.jsx(Ai,{size:14,style:{color:n}})]},re.fromCurrency))]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Bz,{}),e.jsxs("div",{ref:M,style:{position:"relative"},children:[e.jsxs("button",{onClick:()=>T(!A),style:{background:A?"var(--bg-secondary)":"none",border:"none",padding:"0.5rem",borderRadius:"8px",cursor:"pointer",position:"relative"},children:[e.jsx(xo,{size:20}),Y>0&&e.jsx("span",{style:{position:"absolute",top:"2px",right:"2px",width:"18px",height:"18px",borderRadius:"50%",background:"#ef4444",color:"white",fontSize:"0.65rem",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center"},children:Y>9?"9+":Y})]}),A&&e.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",width:"360px",maxHeight:"480px",background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"12px",boxShadow:"var(--shadow-lg)",overflow:"hidden",zIndex:1e3},children:[e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{fontSize:"0.9375rem",fontWeight:600,margin:0},children:"Notifications"}),Y>0&&e.jsxs("span",{style:{background:"#fef2f2",color:"#ef4444",padding:"0.25rem 0.5rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:500},children:[Y," new"]})]}),e.jsx("div",{style:{maxHeight:"320px",overflowY:"auto"},children:J.length===0?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(xo,{size:32,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem"},children:"No new notifications"})]}):J.map(re=>e.jsxs("button",{onClick:()=>Z(re),style:{width:"100%",padding:"0.875rem 1rem",display:"flex",gap:"0.75rem",alignItems:"flex-start",border:"none",background:re.isRead?"var(--bg-primary)":"var(--bg-secondary)",cursor:"pointer",textAlign:"left",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:re.isRead?"transparent":n,marginTop:"6px",flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:"0.875rem",fontWeight:re.isRead?400:600,marginBottom:"0.25rem"},children:re.title}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:re.message}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:new Date(re.createdAt).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})})]})]},re.id))}),e.jsx(nr,{to:r,onClick:()=>T(!1),style:{display:"block",padding:"0.875rem",textAlign:"center",borderTop:"1px solid var(--border)",color:n,textDecoration:"none",fontSize:"0.875rem",fontWeight:500},children:"View all notifications"})]})]})]})]})}const c6=[{path:"/portal",label:"Dashboard",icon:zA},{path:"/portal/book-capacity",label:"Book Capacity",icon:$n},{path:"/portal/orders",label:"My Orders",icon:Fo},{path:"/portal/orders/new",label:"Place Order",icon:cn},{path:"/portal/invoices",label:"Invoices",icon:td},{path:"/portal/helpdesk",label:"Support",icon:Sm},{path:"/portal/profile",label:"My Profile",icon:Ts}];function mne({children:t}){const[r,n]=k.useState(!0),i=ld(),a=Gr(),{user:s,logout:o}=Il(),{language:l}=i2(),{siteLogo:u,siteName:d}=$A(),f=l==="ar",p=async()=>{await o(),a("/login")};return e.jsxs("div",{style:{display:"flex",minHeight:"100vh"},children:[e.jsxs("aside",{style:{width:r?"16rem":"4rem",background:"linear-gradient(180deg, #0d9488 0%, #115e59 100%)",color:"white",transition:"width 0.2s ease",display:"flex",flexDirection:"column",position:"fixed",height:"100vh",zIndex:40,left:f?"auto":0,right:f?0:"auto"},children:[e.jsxs("div",{style:{padding:"1rem",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[r&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u?e.jsx("img",{src:u,alt:d,style:{width:"32px",height:"32px",objectFit:"contain",borderRadius:"6px"}}):null,e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.125rem",fontWeight:700},children:d}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.7},children:"Client Portal"})]})]}),e.jsx("button",{onClick:()=>n(!r),style:{background:"none",border:"none",color:"white",padding:"0.5rem",cursor:"pointer"},children:r?e.jsx(Dr,{size:20}):e.jsx(FC,{size:20})})]}),e.jsx("nav",{style:{flex:1,padding:"0.5rem",overflowY:"auto"},children:c6.map(x=>{const v=x.icon,w=i.pathname===x.path;return e.jsxs(nr,{to:x.path,style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",borderRadius:"8px",textDecoration:"none",color:w?"white":"rgba(255,255,255,0.7)",background:w?"rgba(255,255,255,0.15)":"transparent",marginBottom:"0.25rem",transition:"all 0.15s ease"},children:[e.jsx(v,{size:20}),r&&e.jsx("span",{style:{fontSize:"0.875rem"},children:x.label})]},x.path)})}),e.jsx("div",{style:{padding:"1rem",borderTop:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs("button",{onClick:p,style:{display:"flex",alignItems:"center",gap:"0.75rem",width:"100%",padding:"0.75rem",borderRadius:"8px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:[e.jsx(BA,{size:20}),r&&e.jsx("span",{style:{fontSize:"0.875rem"},children:"Logout"})]})})]}),e.jsxs("div",{style:{flex:1,marginLeft:f?0:r?"16rem":"4rem",marginRight:f?r?"16rem":"4rem":0,transition:"margin 0.2s ease"},children:[e.jsxs("header",{style:{background:"var(--bg-primary)",borderBottom:"1px solid var(--border)",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:30,gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[s?.customerLogoUrl?e.jsx("img",{src:s.customerLogoUrl,alt:s.customerName||"Customer",style:{width:"40px",height:"40px",objectFit:"contain",borderRadius:"8px",border:"1px solid var(--border)"}}):e.jsx(Ts,{size:20,style:{color:"#0d9488"}}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.125rem",fontWeight:600,margin:0},children:c6.find(x=>x.path===i.pathname)?.label||"Client Portal"}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:s?.customerName||"Customer Portal"})]})]}),e.jsx(qz,{showSearch:!0,notificationCenterPath:"/portal/notifications",accentColor:"#0d9488"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"var(--bg-secondary)",borderRadius:"9999px"},children:[e.jsxs("div",{style:{width:"2rem",height:"2rem",borderRadius:"50%",background:"#0d9488",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.875rem"},children:[s?.firstName?.[0],s?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:500},children:[s?.firstName," ",s?.lastName]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Customer"})]})]})]}),e.jsx(GA,{}),e.jsx("main",{style:{padding:"1.5rem",background:"#f8fafc",minHeight:"calc(100vh - 73px)"},children:t})]})]})}function pne({children:t}){const r=ld(),n=Gr(),{user:i,logout:a}=Il(),{siteLogo:s,siteName:o}=$A(),l=()=>{a(),n("/login")},u=[{path:"/driver",icon:iz,label:"Dashboard"},{path:"/driver/shipments",icon:dn,label:"Shipments"}];return e.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-secondary)"},children:[e.jsxs("header",{style:{backgroundColor:"var(--bg-primary)",borderBottom:"1px solid var(--border)",padding:"0.75rem 1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,zIndex:100},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[s?e.jsx("img",{src:s,alt:o,style:{width:"36px",height:"36px",objectFit:"contain",borderRadius:"8px"}}):e.jsx("div",{style:{width:"36px",height:"36px",backgroundColor:"var(--primary)",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:e.jsx(dn,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"Driver Portal"}),e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:[o," OMS"]})]})]}),e.jsx("nav",{style:{display:"flex",gap:"0.5rem"},children:u.map(d=>{const f=d.icon,p=r.pathname===d.path||d.path!=="/driver"&&r.pathname.startsWith(d.path);return e.jsxs(nr,{to:d.path,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",borderRadius:"var(--radius)",backgroundColor:p?"var(--primary-light)":"transparent",color:p?"var(--primary)":"var(--text-primary)",textDecoration:"none",fontWeight:p?600:400,fontSize:"0.875rem"},children:[e.jsx(f,{size:16}),d.label]},d.path)})})]}),e.jsx(qz,{showSearch:!1,notificationCenterPath:"/driver/notifications",accentColor:"var(--primary)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)"},children:e.jsx(Uo,{size:16})}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[i?.firstName," ",i?.lastName]})]}),e.jsxs("button",{onClick:l,className:"btn btn-secondary btn-sm",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(BA,{size:14}),"Logout"]})]})]}),e.jsx(GA,{}),e.jsx("main",{style:{padding:"1.5rem",maxWidth:"1200px",margin:"0 auto"},children:t})]})}function gne(){const[t,r]=k.useState("admin@radiopharma.com"),[n,i]=k.useState("admin123"),[a,s]=k.useState(""),[o,l]=k.useState(!1),u=Gr(),{login:d}=Il(),f=async p=>{p.preventDefault(),s(""),l(!0);try{await d(t,n),u("/")}catch(x){const v=x.response?.data?.error;v==="Invalid credentials"?s("The email or password you entered is incorrect. Please try again."):x.response?.status===401?s("Invalid email or password. Please check your credentials and try again."):x.response?.status===403?s("Your account has been disabled. Please contact support."):x.response?s(v||"Login failed. Please try again later."):s("Unable to connect to the server. Please check your internet connection.")}finally{l(!1)}};return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%)",padding:"1rem"},children:e.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:"16px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:"24rem",padding:"2rem"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[e.jsx("div",{style:{width:"4rem",height:"4rem",background:"linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:e.jsx(ou,{size:32,color:"white"})}),e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--text-primary)"},children:"RadioPharma OMS"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Order Management System"})]}),a&&e.jsxs("div",{"data-testid":"error-message",style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",padding:"1rem",background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",borderRadius:"8px",marginBottom:"1.25rem",fontSize:"0.875rem",lineHeight:"1.5"},children:[e.jsx(sn,{size:20,style:{flexShrink:0,marginTop:"1px"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Login Failed"}),e.jsx("div",{style:{color:"#b91c1c"},children:a})]})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-input","data-testid":"email-input",value:t,onChange:p=>r(p.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-input","data-testid":"password-input",value:n,onChange:p=>i(p.target.value),required:!0})]}),e.jsx("button",{type:"submit",disabled:o,className:"btn btn-primary","data-testid":"login-button",style:{width:"100%",marginTop:"1rem",padding:"0.75rem"},children:o?"Signing in...":"Sign In"})]}),e.jsx("p",{style:{textAlign:"center",marginTop:"1.5rem",fontSize:"0.75rem",color:"#94a3b8"},children:"Demo: admin@radiopharma.com / admin123"})]})})}const yne={default:{bg:"var(--bg-secondary)",text:"var(--text-primary)",accent:"var(--text-muted)"},primary:{bg:"#eff6ff",text:"#1d4ed8",accent:"#3b82f6"},success:{bg:"#f0fdf4",text:"#166534",accent:"#22c55e"},warning:{bg:"#fffbeb",text:"#92400e",accent:"#f59e0b"},danger:{bg:"#fef2f2",text:"#991b1b",accent:"#ef4444"},info:{bg:"#f0f9ff",text:"#0369a1",accent:"#0ea5e9"}};function nt({title:t,value:r,subtext:n,icon:i,trend:a,trendValue:s,color:o="default",onClick:l,loading:u=!1,active:d=!1,selected:f=!1,linkTo:p}){const x=Gr(),v=yne[o],w=l||p,C=d||f,A=()=>{l?l():p&&x(p)};return e.jsxs("div",{className:"card",style:{backgroundColor:v.bg,cursor:w?"pointer":"default",transition:"transform 0.2s, box-shadow 0.2s",minWidth:"180px",minHeight:"100px",padding:"1.25rem 1.5rem",border:C?`2px solid ${v.accent}`:"1px solid var(--border)",boxShadow:C?`0 0 0 3px ${v.accent}20`:"0 1px 3px rgba(0,0,0,0.05)",borderRadius:"12px"},onClick:A,onMouseEnter:T=>w&&(T.currentTarget.style.transform="translateY(-2px)"),onMouseLeave:T=>w&&(T.currentTarget.style.transform="translateY(0)"),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",height:"100%"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",fontWeight:500,marginBottom:"0.75rem"},children:t}),u?e.jsx("div",{className:"skeleton",style:{width:"60px",height:"2.5rem",borderRadius:"4px"}}):e.jsx("div",{style:{fontSize:"2.25rem",fontWeight:700,color:v.text,lineHeight:1.1},children:r}),n&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:n})]}),i&&e.jsx("div",{style:{padding:"0.625rem",borderRadius:"10px",backgroundColor:`${v.accent}15`,color:v.accent},children:i})]}),a&&s&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.5rem",fontSize:"0.75rem"},children:[a==="up"&&e.jsx(r0,{size:14,style:{color:"#22c55e"}}),a==="down"&&e.jsx(hz,{size:14,style:{color:"#ef4444"}}),a==="neutral"&&e.jsx(sz,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{color:a==="up"?"#22c55e":a==="down"?"#ef4444":"var(--text-muted)"},children:s})]})]})}const xne={DRAFT:{bg:"#f1f5f9",text:"#475569",border:"#e2e8f0"},PENDING:{bg:"#f1f5f9",text:"#475569",border:"#e2e8f0"},PENDING_APPROVAL:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},APPROVED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},ACTIVE:{bg:"#dcfce7",text:"#166534",border:"#86efac"},COMPLETED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},CLOSED:{bg:"#e0e7ff",text:"#3730a3",border:"#a5b4fc"},CANCELLED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},REJECTED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},FAILED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},ON_HOLD:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},BLOCKED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},INACTIVE:{bg:"#f1f5f9",text:"#64748b",border:"#e2e8f0"},EXPIRED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},SUBMITTED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},VALIDATED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},SCHEDULED:{bg:"#e0e7ff",text:"#4338ca",border:"#a5b4fc"},IN_PRODUCTION:{bg:"#cffafe",text:"#0e7490",border:"#67e8f9"},QC_PENDING:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},QC_IN_PROGRESS:{bg:"#fef3c7",text:"#b45309",border:"#fcd34d"},QC_PASSED:{bg:"#d1fae5",text:"#047857",border:"#6ee7b7"},FAILED_QC:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},QP_REVIEW:{bg:"#ede9fe",text:"#6d28d9",border:"#c4b5fd"},RELEASED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},DISPATCHED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},DELIVERED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},REWORK:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},PLANNED:{bg:"#f1f5f9",text:"#475569",border:"#e2e8f0"},PRODUCTION_COMPLETE:{bg:"#cffafe",text:"#0e7490",border:"#67e8f9"},DISPENSING_IN_PROGRESS:{bg:"#ccfbf1",text:"#0d9488",border:"#5eead4"},DISPENSED:{bg:"#ccfbf1",text:"#0d9488",border:"#5eead4"},PACKED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},DEVIATION_OPEN:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},READY_TO_PACK:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},PACKING:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},READY_TO_DISPATCH:{bg:"#e0e7ff",text:"#4338ca",border:"#a5b4fc"},IN_TRANSIT:{bg:"#ede9fe",text:"#6d28d9",border:"#c4b5fd"},DELAYED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},RETURNED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},DAMAGED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},CREATED:{bg:"#f1f5f9",text:"#475569",border:"#e2e8f0"},ASSIGNED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},SHIPPED:{bg:"#ede9fe",text:"#6d28d9",border:"#c4b5fd"},ADMINISTERED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},WASTED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},SENT:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},ACKNOWLEDGED:{bg:"#cffafe",text:"#0e7490",border:"#67e8f9"},PARTIALLY_RECEIVED:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},RECEIVED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},PENDING_ACTIVATION:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},SUPERSEDED:{bg:"#e0e7ff",text:"#4338ca",border:"#a5b4fc"},OPEN:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},UNDER_INVESTIGATION:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},CAPA_PROPOSED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},CAPA_APPROVED:{bg:"#d1fae5",text:"#047857",border:"#6ee7b7"},IMPLEMENTING:{bg:"#cffafe",text:"#0e7490",border:"#67e8f9"},CLOSED_CONFIRMED:{bg:"#dcfce7",text:"#166534",border:"#86efac"},CLOSED_INVALIDATED:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},CLOSED_INCONCLUSIVE:{bg:"#e0e7ff",text:"#4338ca",border:"#a5b4fc"},SUBMITTED_FOR_PAYMENT:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"},PAID:{bg:"#dcfce7",text:"#166534",border:"#86efac"},PARTIALLY_PAID:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},OVERDUE:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"},AVAILABLE:{bg:"#dcfce7",text:"#166534",border:"#86efac"},QUARANTINE:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},RESERVED:{bg:"#dbeafe",text:"#1d4ed8",border:"#93c5fd"}};function vne(t){return xne[t]||{bg:"#f1f5f9",text:"#475569",border:"#e2e8f0"}}const bne={sm:{padding:"0.125rem 0.5rem",fontSize:"0.625rem",gap:"0.25rem"},md:{padding:"0.25rem 0.75rem",fontSize:"0.75rem",gap:"0.375rem"},lg:{padding:"0.375rem 1rem",fontSize:"0.875rem",gap:"0.5rem"}};function Pn({status:t,size:r="md",showDot:n=!1,label:i}){const a=vne(t),s=i||t.replace(/_/g," "),o=bne[r];return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:o.gap,padding:o.padding,fontSize:o.fontSize,fontWeight:500,borderRadius:"9999px",backgroundColor:a.bg,color:a.text,border:a.border?`1px solid ${a.border}`:void 0,whiteSpace:"nowrap",textTransform:"capitalize"},children:[n&&e.jsx("span",{style:{width:r==="sm"?"5px":r==="md"?"6px":"7px",height:r==="sm"?"5px":r==="md"?"6px":"7px",borderRadius:"50%",backgroundColor:a.text,flexShrink:0}}),s]})}function Uz({steps:t,currentStep:r,completedSteps:n=[],skippedSteps:i=[],exceptionStep:a,orientation:s="horizontal",size:o="md"}){const l=t.findIndex(x=>x.key===r),u=(x,v)=>x.key===a?"exception":n.includes(x.key)?"completed":i.includes(x.key)?"skipped":x.key===r?"current":l>=0&&v<l?"completed":"pending",d={completed:{bg:"#22c55e",border:"#22c55e",text:"#fff",line:"#22c55e"},current:{bg:"#3b82f6",border:"#3b82f6",text:"#fff",line:"var(--border)"},pending:{bg:"var(--bg-primary)",border:"var(--border)",text:"var(--text-muted)",line:"var(--border)"},skipped:{bg:"var(--bg-tertiary)",border:"var(--border)",text:"var(--text-muted)",line:"var(--border)"},exception:{bg:"#ef4444",border:"#ef4444",text:"#fff",line:"#ef4444"}},p={sm:{iconSize:24,fontSize:"0.625rem",gap:"0.5rem"},md:{iconSize:32,fontSize:"0.75rem",gap:"0.75rem"},lg:{iconSize:40,fontSize:"0.875rem",gap:"1rem"}}[o];return s==="vertical"?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0"},children:t.map((x,v)=>{const w=u(x,v),C=d[w],A=x.icon,T=v===t.length-1;return e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("div",{style:{width:p.iconSize,height:p.iconSize,borderRadius:"50%",backgroundColor:C.bg,border:`2px solid ${C.border}`,display:"flex",alignItems:"center",justifyContent:"center",color:C.text,flexShrink:0},children:[w==="completed"&&e.jsx(Ai,{size:p.iconSize*.5}),w==="exception"&&e.jsx(sn,{size:p.iconSize*.5}),w==="current"&&(A?e.jsx(A,{size:p.iconSize*.5}):e.jsx(I5,{size:p.iconSize*.4,fill:"currentColor"})),(w==="pending"||w==="skipped")&&(A?e.jsx(A,{size:p.iconSize*.5}):e.jsx(I5,{size:p.iconSize*.3}))]}),!T&&e.jsx("div",{style:{width:"2px",flex:1,minHeight:"2rem",backgroundColor:w==="completed"?C.line:"var(--border)"}})]}),e.jsxs("div",{style:{paddingBottom:T?0:"1.5rem",paddingTop:"0.25rem"},children:[e.jsx("div",{style:{fontSize:p.fontSize,fontWeight:600,color:w==="pending"?"var(--text-muted)":"var(--text-primary)"},children:x.label}),x.description&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.125rem"},children:x.description}),x.timestamp&&e.jsxs("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginTop:"0.25rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Qt,{size:10})," ",x.timestamp,x.actor&&e.jsxs("span",{children:[" by ",x.actor]})]})]})]},x.key)})}):e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",top:p.iconSize/2,left:p.iconSize,right:p.iconSize,height:"2px",backgroundColor:"var(--border)",zIndex:0}}),t.map((x,v)=>{const w=u(x,v),C=d[w],A=x.icon;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",zIndex:1,flex:1},children:[e.jsxs("div",{style:{width:p.iconSize,height:p.iconSize,borderRadius:"50%",backgroundColor:C.bg,border:`2px solid ${C.border}`,display:"flex",alignItems:"center",justifyContent:"center",color:C.text},children:[w==="completed"&&e.jsx(Ai,{size:p.iconSize*.5}),w==="exception"&&e.jsx(sn,{size:p.iconSize*.5}),w==="current"&&(A?e.jsx(A,{size:p.iconSize*.5}):e.jsx(I5,{size:p.iconSize*.4,fill:"currentColor"})),(w==="pending"||w==="skipped")&&(A?e.jsx(A,{size:p.iconSize*.5}):e.jsx("span",{style:{fontSize:p.fontSize},children:v+1}))]}),e.jsxs("div",{style:{marginTop:p.gap,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:p.fontSize,fontWeight:w==="current"?600:500,color:w==="pending"||w==="skipped"?"var(--text-muted)":"var(--text-primary)"},children:x.label}),x.timestamp&&e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginTop:"0.125rem"},children:x.timestamp})]})]},x.key)})]})}const jne={info:e.jsx(Qt,{size:14}),success:e.jsx(Ft,{size:14}),warning:e.jsx(Hr,{size:14}),error:e.jsx(ri,{size:14})},wne={info:"#3b82f6",success:"#22c55e",warning:"#f59e0b",error:"#ef4444"};function Wz({events:t,maxVisible:r=5,showMetadata:n=!1,emptyMessage:i="No events yet"}){const[a,s]=k.useState(!1),[o,l]=k.useState(new Set),{formatDateTime:u}=ph(),d=a?t:t.slice(0,r),f=t.length>r,p=x=>{l(v=>{const w=new Set(v);return w.has(x)?w.delete(x):w.add(x),w})};return t.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:[e.jsx(Qt,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:i})]}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0"},children:d.map((x,v)=>{const w=x.severity||"info",C=wne[w],A=v===d.length-1,T=x.metadata&&Object.keys(x.metadata).length>0,O=o.has(x.id);return e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:`${C}20`,border:`2px solid ${C}`,display:"flex",alignItems:"center",justifyContent:"center",color:C,flexShrink:0},children:jne[w]}),!A&&e.jsx("div",{style:{width:"2px",flex:1,minHeight:"1rem",backgroundColor:"var(--border)"}})]}),e.jsxs("div",{style:{flex:1,paddingBottom:A?0:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-primary)"},children:x.title}),x.fromStatus&&x.toStatus&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.125rem"},children:[e.jsx("span",{className:"badge badge-sm",children:x.fromStatus.replace(/_/g," ")}),e.jsx(lc,{size:12}),e.jsx("span",{className:"badge badge-sm",children:x.toStatus.replace(/_/g," ")})]}),x.description&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:x.description}),x.note&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginTop:"0.25rem",fontStyle:"italic",display:"flex",alignItems:"flex-start",gap:"0.25rem"},children:[e.jsx(Ir,{size:12,style:{flexShrink:0,marginTop:"2px"}}),'"',x.note,'"']})]}),e.jsxs("div",{style:{textAlign:"right",flexShrink:0},children:[e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)"},children:u(x.timestamp)}),x.actor&&e.jsxs("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"0.25rem",justifyContent:"flex-end",marginTop:"0.125rem"},children:[e.jsx(Uo,{size:10}),x.actor,x.actorRole&&e.jsxs("span",{children:["(",x.actorRole,")"]})]})]})]}),n&&T&&e.jsxs("div",{style:{marginTop:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>p(x.id),style:{fontSize:"0.625rem",padding:"0.125rem 0.5rem"},children:[O?e.jsx(nh,{size:12}):e.jsx(qo,{size:12}),"Metadata"]}),O&&e.jsx("pre",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",fontSize:"0.625rem",overflow:"auto",maxHeight:"150px"},children:JSON.stringify(x.metadata,null,2)})]})]})]},x.id)})}),f&&e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>s(!a),style:{marginTop:"1rem",width:"100%"},children:[a?e.jsx(nh,{size:14}):e.jsx(qo,{size:14}),a?"Show Less":`Show All (${t.length})`]})]})}function cd({widgets:t,values:r,onChange:n,onReset:i,lastRefresh:a,onRefresh:s,quickFilters:o,activeQuickFilter:l,onQuickFilterClick:u}){const[d,f]=k.useState(null),p=Object.entries(r).filter(([x,v])=>Array.isArray(v)?v.length>0:typeof v=="boolean"?v:v&&v!=="").length;return e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",alignItems:"flex-end"},children:[t.map(x=>{if(x.type==="search")return e.jsxs("div",{style:{flex:"1 1 200px",maxWidth:"300px"},children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.375rem",display:"block",fontWeight:500},children:x.label}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.875rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:x.placeholder||`Search ${x.label.toLowerCase()}...`,value:r[x.key]||"",onChange:v=>n(x.key,v.target.value),style:{paddingLeft:"2.5rem",height:"40px"}}),r[x.key]&&e.jsx("button",{onClick:()=>n(x.key,""),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:e.jsx(Dr,{size:14})})]})]},x.key);if(x.type==="select")return e.jsxs("div",{style:{flex:"0 0 auto",minWidth:"160px"},children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.375rem",display:"block",fontWeight:500},children:x.label}),e.jsxs("select",{className:"form-select",value:r[x.key]||"",onChange:v=>n(x.key,v.target.value),style:{height:"40px",minWidth:"140px"},children:[e.jsx("option",{value:"",children:"All"}),x.options?.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))]})]},x.key);if(x.type==="multiselect"){const v=r[x.key]||[];return e.jsxs("div",{style:{flex:"0 0 auto",minWidth:"160px",position:"relative"},children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.375rem",display:"block",fontWeight:500},children:x.label}),e.jsxs("button",{className:"form-select",onClick:()=>f(d===x.key?null:x.key),style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",textAlign:"left",height:"40px",backgroundImage:"none"},children:[e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:v.length===0?"All":`${v.length} selected`}),e.jsx(qo,{size:16,style:{color:"var(--text-muted)"}})]}),d===x.key&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:100,maxHeight:"200px",overflow:"auto"},children:x.options?.map(w=>e.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"0.5rem 0.75rem",cursor:"pointer",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:v.includes(w.value),onChange:C=>{C.target.checked?n(x.key,[...v,w.value]):n(x.key,v.filter(A=>A!==w.value))}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:w.label})]},w.value))})]},x.key)}return x.type==="daterange"?e.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.375rem",display:"block",fontWeight:500},children:"From"}),e.jsx("input",{type:"date",className:"form-input",value:r[`${x.key}From`]||"",onChange:v=>n(`${x.key}From`,v.target.value),style:{width:"150px",height:"40px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.375rem",display:"block",fontWeight:500},children:"To"}),e.jsx("input",{type:"date",className:"form-input",value:r[`${x.key}To`]||"",onChange:v=>n(`${x.key}To`,v.target.value),style:{width:"150px",height:"40px"}})]})]},x.key):x.type==="toggle"?e.jsx("div",{style:{flex:"0 0 auto",display:"flex",alignItems:"center",gap:"0.5rem",paddingBottom:"0.5rem"},children:e.jsxs("label",{className:"toggle-switch",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:r[x.key]||!1,onChange:v=>n(x.key,v.target.checked),style:{width:"16px",height:"16px"}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:x.label})]})},x.key):null}),e.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:"0.5rem",alignItems:"flex-end",paddingBottom:"0"},children:[i&&p>0&&e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:i,children:[e.jsx(y8,{size:14})," Reset"]}),s&&e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:s,children:e.jsx(y8,{size:14})})]})]}),o&&o.length>0&&e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem",flexWrap:"wrap"},children:o.map(x=>e.jsx("button",{className:`btn btn-sm ${l===x.key?"btn-primary":"btn-secondary"}`,onClick:()=>u?.(x.key),style:{borderRadius:"999px"},children:x.label},x.key))}),a&&e.jsxs("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:["Last updated: ",Ze(a,"HH:mm:ss"),p>0&&`  ${p} filter${p>1?"s":""} applied`]})]})}const Sne={order:Ir,batch:Bi,shipment:dn,doseUnit:Tg,qcTest:Rr,invoice:Ir,supplier:Uo,material:Wl,recipe:JL,warehouse:lm,purchaseOrder:Fo,grn:rh,customer:Ts},Cne={order:"Order",batch:"Batch",shipment:"Shipment",doseUnit:"Dose Unit",qcTest:"QC Test",invoice:"Invoice",supplier:"Supplier",material:"Material",recipe:"Recipe",warehouse:"Warehouse",purchaseOrder:"Purchase Order",grn:"GRN",customer:"Customer"},Nne={DRAFT:"default",SUBMITTED:"info",VALIDATED:"info",SCHEDULED:"secondary",IN_PRODUCTION:"info",QC_PENDING:"warning",RELEASED:"released",DISPATCHED:"info",DELIVERED:"success",CLOSED:"closed",CANCELLED:"danger",PACKED:"info",IN_TRANSIT:"purple",DISPENSED:"teal"};function Ane({records:t,title:r="Linked Records",collapsed:n=!1,onToggle:i}){const a=t.reduce((s,o)=>(s[o.type]||(s[o.type]=[]),s[o.type].push(o),s),{});return t.length===0?e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border)"},children:[e.jsx("h4",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.5rem"},children:r}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"No linked records"})]}):e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:i?"pointer":"default"},onClick:i,children:[e.jsxs("h4",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",margin:0},children:[r," (",t.length,")"]}),i&&e.jsx(bo,{size:16,style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(90deg)",transition:"transform 0.2s"}})]}),!n&&e.jsx("div",{style:{padding:"0.5rem"},children:Object.entries(a).map(([s,o])=>{const l=Sne[s]||Ir;return e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",textTransform:"uppercase",padding:"0.25rem 0.5rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(l,{size:10}),Cne[s],"s (",o.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:o.map(u=>e.jsxs(nr,{to:u.link,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.5rem",backgroundColor:"var(--bg-primary)",borderRadius:"4px",textDecoration:"none",color:"var(--text-primary)",fontSize:"0.875rem",transition:"background-color 0.2s"},onMouseEnter:d=>d.currentTarget.style.backgroundColor="var(--bg-tertiary)",onMouseLeave:d=>d.currentTarget.style.backgroundColor="var(--bg-primary)",children:[e.jsx("span",{style:{fontWeight:500},children:u.label}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.status&&e.jsx("span",{className:`badge badge-${Nne[u.status]||"default"}`,style:{fontSize:"0.625rem"},children:u.status.replace(/_/g," ")}),e.jsx(ih,{size:12,style:{color:"var(--text-muted)"}})]})]},u.id))})]},s)})})]})}const Ene={search:Gs,package:Rr,alert:sn,success:Ft,question:WY,beaker:Wl,clock:Qt,file:Ir,truck:dn,user:Uo,box:rh};function fn({title:t,message:r,icon:n="question",ctaLabel:i,onCta:a,variant:s="default"}){const o=Ene[n],l=s==="compact";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:l?"2rem":"4rem 2rem",textAlign:"center"},children:[e.jsx("div",{style:{width:l?"48px":"64px",height:l?"48px":"64px",borderRadius:"50%",backgroundColor:"var(--bg-tertiary)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"1rem"},children:e.jsx(o,{size:l?24:32,style:{color:"var(--text-muted)"}})}),e.jsx("h3",{style:{fontSize:l?"1rem":"1.25rem",fontWeight:600,color:"var(--text-primary)",marginBottom:"0.5rem"},children:t}),e.jsx("p",{style:{fontSize:l?"0.875rem":"1rem",color:"var(--text-muted)",maxWidth:"400px",marginBottom:i?"1.5rem":0},children:r}),i&&a&&e.jsxs("button",{className:"btn btn-primary",onClick:a,children:[e.jsx(cn,{size:16})," ",i]})]})}function gy({title:t,subtitle:r,code:n,status:i,metadata:a=[],kpis:s=[],tabs:o,defaultTab:l,actions:u=[],linkedRecords:d=[],timeline:f=[],showTimeline:p=!0,showLinkedRecords:x=!0,backUrl:v,backLabel:w="Back",loading:C=!1}){const A=Gr(),[T,O]=k.useState(l||o[0]?.key||""),[D,M]=k.useState(!1);if(C)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const Q=o.find(U=>U.key===T)?.content;return e.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{position:"sticky",top:0,zIndex:10,background:"var(--bg-secondary)",paddingBottom:"1rem",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[v&&e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>A(v),style:{marginTop:"0.25rem"},children:[e.jsx(sa,{size:16}),w]}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.25rem"},children:[e.jsxs("h1",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:[n&&e.jsxs("span",{style:{color:"var(--text-muted)"},children:[n," - "]}),t]}),i&&e.jsx(Pn,{status:i.value})]}),r&&e.jsx("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"0.875rem"},children:r}),a.length>0&&e.jsx("div",{style:{display:"flex",gap:"1.5rem",marginTop:"0.5rem",flexWrap:"wrap"},children:a.map((U,$)=>e.jsxs("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:[e.jsxs("strong",{children:[U.label,":"]})," ",U.value]},$))})]})]}),u.length>0&&e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:u.map((U,$)=>e.jsxs("button",{className:`btn btn-${U.variant||"secondary"}`,onClick:U.onClick,disabled:U.disabled,title:U.tooltip,children:[U.icon,U.label]},$))})]})}),s.length>0&&e.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(auto-fit, minmax(${s.length<=4?"180px":"150px"}, 1fr))`,gap:"1rem",marginBottom:"1.5rem"},children:s.map((U,$)=>e.jsx(nt,{title:U.title,value:U.value,icon:U.icon,color:U.color,onClick:U.onClick},$))}),o.length>0&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",borderBottom:"1px solid var(--border)",overflowX:"auto",gap:"0"},children:o.map(U=>e.jsxs("button",{onClick:()=>O(U.key),style:{padding:"0.875rem 1.25rem",border:"none",background:T===U.key?"var(--bg-primary)":"transparent",borderBottom:T===U.key?"2px solid var(--primary)":"2px solid transparent",color:T===U.key?"var(--primary)":"var(--text-secondary)",fontWeight:T===U.key?600:400,cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",whiteSpace:"nowrap",fontSize:"0.875rem",transition:"all 0.15s ease"},children:[U.icon,U.label,U.badge!==void 0&&U.badge>0&&e.jsx("span",{className:"badge badge-primary",style:{fontSize:"0.75rem"},children:U.badge})]},U.key))}),e.jsx("div",{style:{padding:"1.5rem"},children:Q})]}),p&&f.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:D?"1px solid var(--border)":"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>M(!D),children:[e.jsxs("h3",{style:{margin:0,fontSize:"1rem",fontWeight:600},children:["Activity Timeline (",f.length,")"]}),D?e.jsx(nh,{size:20}):e.jsx(qo,{size:20})]}),D&&e.jsx("div",{style:{padding:"1.5rem"},children:e.jsx(Wz,{events:f})})]})]}),x&&d.length>0&&e.jsx("div",{style:{width:"280px",flexShrink:0},children:e.jsx("div",{style:{position:"sticky",top:"1rem"},children:e.jsx(Ane,{records:d})})})]})}function Ad({title:t,subtitle:r,status:n,statusLabel:i,breadcrumbs:a,actions:s,sticky:o=!1}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem",gap:"1rem",flexWrap:"wrap",...o&&{position:"sticky",top:0,backgroundColor:"var(--bg-secondary)",paddingTop:"1rem",paddingBottom:"1rem",marginTop:"-1rem",marginBottom:"1rem",zIndex:100,borderBottom:"1px solid var(--border)"}},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[a&&a.length>0&&e.jsx("nav",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem",fontSize:"0.8125rem",color:"var(--text-muted)"},children:a.map((l,u)=>e.jsxs(qf.Fragment,{children:[u>0&&e.jsx(bo,{size:14,style:{color:"var(--text-muted)"}}),l.href?e.jsx(nr,{to:l.href,style:{color:"var(--text-muted)",textDecoration:"none"},children:l.label}):e.jsx("span",{style:{color:"var(--text-primary)",fontWeight:500},children:l.label})]},u))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[e.jsx("h1",{style:{fontSize:"1.25rem",fontWeight:600,margin:0,color:"var(--text-primary)"},children:t}),n&&e.jsx(Pn,{status:n,label:i,size:"md"})]}),r&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:"0.25rem 0 0 0"},children:r})]}),s&&e.jsx("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",alignItems:"center"},children:s})]})}function a0({page:t,pageSize:r,totalCount:n,onPageChange:i,showRecordRange:a=!0,compact:s=!1}){const o=Math.ceil(n/r)||1,l=n>0?(t-1)*r+1:0,u=Math.min(t*r,n);return n<=r?e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:s?"0.75rem 1rem":"1rem 1.25rem",borderTop:"1px solid var(--border)",fontSize:"0.8125rem",color:"var(--text-muted)",background:"var(--bg-secondary)"},children:e.jsxs("span",{children:[n," ",n===1?"record":"records"]})}):e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:s?"0.75rem 1rem":"1rem 1.25rem",borderTop:"1px solid var(--border)",fontSize:"0.8125rem",color:"var(--text-muted)",background:"var(--bg-secondary)",flexWrap:"wrap",gap:"0.75rem"},children:[a&&e.jsxs("span",{children:["Showing ",e.jsx("strong",{style:{color:"var(--text-primary)"},children:l})," - ",e.jsx("strong",{style:{color:"var(--text-primary)"},children:u})," of ",e.jsx("strong",{style:{color:"var(--text-primary)"},children:n.toLocaleString()})," records"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsxs("button",{className:"btn btn-secondary",style:{padding:"0.375rem 0.5rem",display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},onClick:()=>i(1),disabled:t<=1,title:"First page",children:[e.jsx(aY,{size:14}),!s&&e.jsx("span",{children:"First"})]}),e.jsxs("button",{className:"btn btn-secondary",style:{padding:"0.375rem 0.5rem",display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},onClick:()=>i(t-1),disabled:t<=1,title:"Previous page",children:[e.jsx(Xp,{size:14}),!s&&e.jsx("span",{children:"Previous"})]}),e.jsxs("span",{style:{padding:"0.375rem 0.75rem",display:"flex",alignItems:"center",background:"var(--bg-primary)",borderRadius:"6px",border:"1px solid var(--border)",fontSize:"0.8125rem",fontWeight:500,color:"var(--text-primary)"},children:[t," / ",o]}),e.jsxs("button",{className:"btn btn-secondary",style:{padding:"0.375rem 0.5rem",display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},onClick:()=>i(t+1),disabled:t>=o,title:"Next page",children:[!s&&e.jsx("span",{children:"Next"}),e.jsx(bo,{size:14})]}),e.jsxs("button",{className:"btn btn-secondary",style:{padding:"0.375rem 0.5rem",display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},onClick:()=>i(o),disabled:t>=o,title:"Last page",children:[!s&&e.jsx("span",{children:"Last"}),e.jsx(oY,{size:14})]})]})]})}function s0({title:t,subtitle:r,lastRefreshed:n,onRefresh:i,isRefreshing:a,actions:s}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:700,marginBottom:"0.25rem",color:"var(--text-primary)"},children:t}),r&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:r})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[n&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx(Qt,{size:14}),"Last updated: ",Ze(n,"HH:mm:ss")]}),i&&e.jsxs("button",{className:"btn btn-secondary",onClick:i,disabled:a,style:{minWidth:"100px"},children:[e.jsx(cu,{size:16,className:a?"spin":""}),a?"Refreshing...":"Refresh"]}),s]})]})}const _ne={default:{bg:"#f1f5f9",border:"#e2e8f0",text:"#64748b"},blue:{bg:"#eff6ff",border:"#bfdbfe",text:"#2563eb"},yellow:{bg:"#fefce8",border:"#fef08a",text:"#ca8a04"},green:{bg:"#f0fdf4",border:"#bbf7d0",text:"#16a34a"},teal:{bg:"#f0fdfa",border:"#99f6e4",text:"#0d9488"},purple:{bg:"#faf5ff",border:"#e9d5ff",text:"#9333ea"}};function Hz({stages:t,title:r}){const n=Gr();return e.jsxs("div",{className:"card",style:{padding:"1.25rem 1.5rem",marginBottom:"1.5rem"},children:[r&&e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"1rem",color:"var(--text-secondary)"},children:r}),e.jsx("div",{style:{display:"flex",alignItems:"stretch",gap:"0.25rem",overflowX:"auto",paddingBottom:"0.5rem"},children:t.map((i,a)=>{const s=_ne[i.color||"default"],o=a===t.length-1;return e.jsxs("div",{style:{display:"flex",alignItems:"center",flex:"1 1 0"},children:[e.jsxs("div",{onClick:()=>n(i.linkTo),style:{flex:1,padding:"0.875rem 1rem",backgroundColor:s.bg,border:`1px solid ${s.border}`,borderRadius:"10px",cursor:"pointer",transition:"all 0.2s",minWidth:"110px",position:"relative"},onMouseEnter:l=>{l.currentTarget.style.transform="translateY(-2px)",l.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"},onMouseLeave:l=>{l.currentTarget.style.transform="translateY(0)",l.currentTarget.style.boxShadow="none"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",fontWeight:500,marginBottom:"0.25rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:i.label}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem",fontWeight:700,color:s.text},children:i.count}),i.lateCount&&i.lateCount>0&&e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.125rem 0.375rem",backgroundColor:"#fef2f2",color:"#dc2626",borderRadius:"999px",fontSize:"0.6875rem",fontWeight:600},children:[e.jsx(Hr,{size:10}),i.lateCount]})]})]}),!o&&e.jsx(bo,{size:18,style:{color:"var(--text-muted)",flexShrink:0,margin:"0 0.125rem"}})]},i.id)})})]})}function Tc({title:t,items:r,viewAllLink:n,maxItems:i=6,emptyMessage:a="No items in queue",icon:s,accentColor:o="var(--primary)"}){const l=Gr(),u=r.slice(0,i),d=r.length>i;return e.jsxs("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center",borderLeft:`3px solid ${o}`,borderTopLeftRadius:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s,e.jsx("h3",{style:{fontWeight:600,fontSize:"0.9375rem",margin:0},children:t}),e.jsx("span",{style:{backgroundColor:"var(--bg-tertiary)",padding:"0.125rem 0.5rem",borderRadius:"999px",fontSize:"0.75rem",fontWeight:600,color:"var(--text-secondary)"},children:r.length})]}),n&&r.length>0&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>l(n),style:{fontSize:"0.75rem"},children:["View all ",e.jsx(bo,{size:14})]})]}),e.jsx("div",{style:{flex:1,overflow:"auto"},children:u.length>0?u.map((f,p)=>e.jsxs("div",{onClick:()=>l(f.linkTo),style:{padding:"0.875rem 1.25rem",borderBottom:p<u.length-1?"1px solid var(--border)":"none",cursor:"pointer",transition:"background 0.15s",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem"},onMouseEnter:x=>x.currentTarget.style.backgroundColor="var(--bg-secondary)",onMouseLeave:x=>x.currentTarget.style.backgroundColor="transparent",children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:"0.8125rem",fontFamily:"monospace"},children:f.identifier}),f.isLate&&e.jsx(Hr,{size:14,style:{color:"var(--danger)"}})]}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:f.title}),f.subtitle&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:f.subtitle})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.25rem"},children:[e.jsx(Pn,{status:f.status,size:"sm"}),f.eta&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.6875rem",color:"var(--text-muted)"},children:[e.jsx(Qt,{size:10}),typeof f.eta=="string"?f.eta:Ze(f.eta,"HH:mm")]}),f.nextAction&&e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--primary)",fontWeight:500},children:f.nextAction})]})]},f.id)):e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:a})}),d&&n&&e.jsx("div",{style:{padding:"0.75rem",borderTop:"1px solid var(--border)",textAlign:"center"},children:e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>l(n),style:{width:"100%"},children:["+",r.length-i," more"]})})]})}const Tne={qc_failed:ri,on_hold:sn,expired:Qt,capacity:$n,delay:Hr,alert:Hr},Ine={error:{bg:"#fef2f2",border:"#fecaca",text:"#dc2626",icon:"#dc2626"},warning:{bg:"#fffbeb",border:"#fde68a",text:"#d97706",icon:"#d97706"},info:{bg:"#eff6ff",border:"#bfdbfe",text:"#2563eb",icon:"#2563eb"}};function yy({title:t="Exceptions & Alerts",items:r}){const n=Gr(),i=r.filter(a=>a.count>0);return i.length===0?e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"1rem",color:"var(--text-secondary)"},children:t}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1.5rem",backgroundColor:"#f0fdf4",borderRadius:"8px",color:"#16a34a",fontSize:"0.875rem",fontWeight:500},children:[e.jsx("span",{style:{marginRight:"0.5rem"},children:""}),"No active exceptions"]})]}):e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"1rem",color:"var(--text-secondary)"},children:t}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:i.map(a=>{const s=Ine[a.type],o=Tne[a.icon||"alert"];return e.jsxs("div",{onClick:()=>n(a.linkTo),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",backgroundColor:s.bg,border:`1px solid ${s.border}`,borderRadius:"8px",cursor:"pointer",transition:"all 0.15s"},onMouseEnter:l=>{l.currentTarget.style.transform="translateX(4px)"},onMouseLeave:l=>{l.currentTarget.style.transform="translateX(0)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(o,{size:18,style:{color:s.icon}}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:s.text},children:a.title})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{backgroundColor:s.icon,color:"white",padding:"0.125rem 0.5rem",borderRadius:"999px",fontSize:"0.75rem",fontWeight:600},children:a.count}),e.jsx(bo,{size:16,style:{color:s.icon}})]})]},a.id)})})]})}const d6={order_created:{icon:Rr,color:"#2563eb",bg:"#eff6ff"},order_validated:{icon:Ft,color:"#16a34a",bg:"#f0fdf4"},order_scheduled:{icon:Qt,color:"#0891b2",bg:"#ecfeff"},batch_started:{icon:Bi,color:"#d97706",bg:"#fffbeb"},batch_completed:{icon:Bi,color:"#16a34a",bg:"#f0fdf4"},qc_passed:{icon:gu,color:"#16a34a",bg:"#f0fdf4"},qc_failed:{icon:Hr,color:"#dc2626",bg:"#fef2f2"},batch_released:{icon:aa,color:"#7c3aed",bg:"#f5f3ff"},shipment_dispatched:{icon:Qi,color:"#0891b2",bg:"#ecfeff"},shipment_delivered:{icon:dn,color:"#16a34a",bg:"#f0fdf4"},default:{icon:Qt,color:"#64748b",bg:"#f1f5f9"}};function One({events:t,title:r="Recent Activity",maxEvents:n=15}){const i=Gr(),a=t.slice(0,n);return e.jsxs("div",{className:"card",style:{height:"100%"},children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"0.9375rem",margin:0},children:r}),e.jsxs("span",{style:{backgroundColor:"var(--bg-tertiary)",padding:"0.125rem 0.5rem",borderRadius:"999px",fontSize:"0.75rem",color:"var(--text-muted)"},children:["Last ",a.length," events"]})]}),e.jsx("div",{style:{maxHeight:"400px",overflow:"auto"},children:a.length>0?e.jsx("div",{style:{padding:"0.5rem 0"},children:a.map((s,o)=>{const l=d6[s.type]||d6.default,u=l.icon,d=typeof s.timestamp=="string"?new Date(s.timestamp):s.timestamp;return e.jsxs("div",{onClick:()=>s.linkTo&&i(s.linkTo),style:{display:"flex",gap:"0.75rem",padding:"0.75rem 1.25rem",cursor:s.linkTo?"pointer":"default",transition:"background 0.15s"},onMouseEnter:f=>s.linkTo&&(f.currentTarget.style.backgroundColor="var(--bg-secondary)"),onMouseLeave:f=>f.currentTarget.style.backgroundColor="transparent",children:[e.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",backgroundColor:l.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(u,{size:16,style:{color:l.color}})}),o<a.length-1&&e.jsx("div",{style:{width:"2px",flex:1,backgroundColor:"var(--border)",marginTop:"0.25rem",minHeight:"20px"}})]}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-primary)",marginBottom:"0.125rem"},children:s.title}),s.description&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:s.description}),e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("span",{children:mre(d,{addSuffix:!0})}),s.user&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{children:s.user})]})]})]})]},s.id)})}):e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No recent activity"})})]})}function kne({days:t,title:r="Capacity Overview (7 Days)"}){const n=Gr();return e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx($n,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,margin:0,color:"var(--text-secondary)"},children:r})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0.5rem"},children:t.map((i,a)=>{const s=typeof i.date=="string"?new Date(i.date):i.date,o=i.totalCapacity>0?Math.round((i.reservedMinutes+i.committedMinutes)/i.totalCapacity*100):0,l=a===0;let u="#22c55e";return o>=90?u="#ef4444":o>=70&&(u="#f59e0b"),e.jsxs("div",{onClick:()=>n(`/planner?date=${Ze(s,"yyyy-MM-dd")}`),style:{padding:"0.75rem 0.5rem",backgroundColor:l?"#eff6ff":"var(--bg-secondary)",borderRadius:"8px",cursor:"pointer",textAlign:"center",transition:"all 0.15s",border:l?"2px solid var(--primary)":"1px solid var(--border)"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-2px)",d.currentTarget.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="none"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:Ze(s,"EEE")}),e.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.5rem"},children:Ze(s,"d")}),e.jsx("div",{style:{width:"100%",height:"4px",backgroundColor:"#e2e8f0",borderRadius:"2px",marginBottom:"0.375rem",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Math.min(o,100)}%`,height:"100%",backgroundColor:u,borderRadius:"2px"}})}),e.jsxs("div",{style:{fontSize:"0.6875rem",fontWeight:500,color:o>=90?"#dc2626":"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:[i.isFull&&e.jsx(Hr,{size:10}),o,"%"]})]},a)})}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"1rem",marginTop:"1rem",fontSize:"0.6875rem",color:"var(--text-muted)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"2px",backgroundColor:"#22c55e"}}),"Low"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"2px",backgroundColor:"#f59e0b"}}),"Medium"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"2px",backgroundColor:"#ef4444"}}),"High"]})]})]})}function Dne({permissions:t=[]}){const r=Gr(),n=[{id:"create-order",label:"New Order",description:"Create customer order",icon:e.jsx(cn,{size:20}),color:"#2563eb",bgColor:"rgba(37, 99, 235, 0.1)",onClick:()=>r("/orders?action=create")},{id:"start-batch",label:"Start Batch",description:"Begin production",icon:e.jsx(yo,{size:20}),color:"#059669",bgColor:"rgba(5, 150, 105, 0.1)",onClick:()=>r("/batches?status=PLANNED")},{id:"record-qc",label:"Record QC",description:"Enter QC results",icon:e.jsx(Bi,{size:20}),color:"#d97706",bgColor:"rgba(217, 119, 6, 0.1)",onClick:()=>r("/qc?status=QC_PENDING")},{id:"qp-release",label:"QP Release",description:"Release batch",icon:e.jsx(aa,{size:20}),color:"#7c3aed",bgColor:"rgba(124, 58, 237, 0.1)",onClick:()=>r("/release?status=QC_PASSED")},{id:"dispense",label:"Dispense",description:"Dispense doses",icon:e.jsx(Rr,{size:20}),color:"#0891b2",bgColor:"rgba(8, 145, 178, 0.1)",onClick:()=>r("/dispensing?ready=true")},{id:"dispatch",label:"Dispatch",description:"Send shipment",icon:e.jsx(dn,{size:20}),color:"#dc2626",bgColor:"rgba(220, 38, 38, 0.1)",onClick:()=>r("/shipments?status=ASSIGNED")},{id:"approve-po",label:"Approve PO",description:"Approve purchase",icon:e.jsx(Ir,{size:20}),color:"#ea580c",bgColor:"rgba(234, 88, 12, 0.1)",onClick:()=>r("/purchase-orders?status=PENDING_APPROVAL")},{id:"validate-order",label:"Validate Order",description:"Confirm order",icon:e.jsx(sf,{size:20}),color:"#0284c7",bgColor:"rgba(2, 132, 199, 0.1)",onClick:()=>r("/orders?status=SUBMITTED")}];return e.jsxs("div",{className:"card",style:{padding:"1.25rem",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)",margin:0},children:"Quick Actions"})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"0.75rem"},children:n.map(i=>e.jsxs("button",{onClick:i.onClick,style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"1rem",border:"1px solid var(--border)",borderRadius:"12px",background:"var(--bg-primary)",cursor:"pointer",transition:"all 0.2s",gap:"0.5rem"},onMouseEnter:a=>{a.currentTarget.style.borderColor=i.color,a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow=`0 4px 12px ${i.bgColor}`},onMouseLeave:a=>{a.currentTarget.style.borderColor="var(--border)",a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="none"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:i.bgColor,color:i.color},children:i.icon}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:600,color:"var(--text-primary)"},children:i.label}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:i.description})]},i.id))})]})}const Pne={expiring:Qt,overdue:$n,approval:aa,qc_failed:ri,inventory:Rr,delivery:dn},Rne={critical:{bg:"#fef2f2",border:"#fecaca",text:"#dc2626",icon:"#dc2626",pulse:!0},high:{bg:"#fff7ed",border:"#fed7aa",text:"#ea580c",icon:"#ea580c",pulse:!1},medium:{bg:"#fffbeb",border:"#fde68a",text:"#d97706",icon:"#d97706",pulse:!1}};function Mne({alerts:t,title:r="Critical Alerts",maxAlerts:n=6}){const i=Gr(),a=t.filter(l=>l.count>0).sort((l,u)=>{const d={critical:0,high:1,medium:2};return d[l.severity]-d[u.severity]}).slice(0,n),s=a.filter(l=>l.severity==="critical").length,o=a.reduce((l,u)=>l+u.count,0);return a.length===0?e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(xo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)",margin:0},children:r})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem 1rem",backgroundColor:"#f0fdf4",borderRadius:"12px",color:"#16a34a"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",backgroundColor:"rgba(22, 163, 74, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"0.75rem"},children:e.jsx("span",{style:{fontSize:"1.5rem"},children:""})}),e.jsx("span",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"All Clear"}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#22c55e",marginTop:"0.25rem"},children:"No critical alerts at this time"})]})]}):e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s>0?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#dc2626",animation:"pulse 2s infinite"},children:e.jsx(zp,{size:14,style:{color:"white"}})}):e.jsx(Hr,{size:18,style:{color:"#ea580c"}}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)",margin:0},children:r})]}),e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:600,padding:"0.25rem 0.5rem",borderRadius:"9999px",backgroundColor:s>0?"#fef2f2":"#fff7ed",color:s>0?"#dc2626":"#ea580c"},children:[o," items"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:a.map(l=>{const u=Rne[l.severity],d=Pne[l.category]||Hr;return e.jsxs("div",{onClick:()=>i(l.linkTo),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",backgroundColor:u.bg,border:`1px solid ${u.border}`,borderRadius:"10px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:f=>{f.currentTarget.style.transform="translateX(4px)"},onMouseLeave:f=>{f.currentTarget.style.transform="translateX(0)"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",borderRadius:"8px",backgroundColor:"rgba(255, 255, 255, 0.8)",color:u.icon,flexShrink:0},children:e.jsx(d,{size:18})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.125rem"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:"0.8125rem",color:u.text},children:l.title}),e.jsx("span",{style:{fontSize:"0.6875rem",fontWeight:700,padding:"0.125rem 0.375rem",borderRadius:"9999px",backgroundColor:"rgba(255, 255, 255, 0.6)",color:u.text},children:l.count})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"rgba(0, 0, 0, 0.6)"},children:l.description})]}),e.jsx(bo,{size:16,style:{color:u.icon,flexShrink:0}})]},l.id)})}),e.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
      `})]})}function Vz(t){var r,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(n=Vz(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function hi(){for(var t,r,n=0,i="",a=arguments.length;n<a;n++)(t=arguments[n])&&(r=Vz(t))&&(i&&(i+=" "),i+=r);return i}var Lne=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function KA(t){if(typeof t!="string")return!1;var r=Lne;return r.includes(t)}var zne=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Bne=new Set(zne);function $z(t){return typeof t!="string"?!1:Bne.has(t)}function Gz(t){return typeof t=="string"&&t.startsWith("data-")}function Hl(t){if(typeof t!="object"||t===null)return{};var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&($z(n)||Gz(n))&&(r[n]=t[n]);return r}function dm(t){if(t==null)return null;if(k.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var r=t.props;return Hl(r)}return typeof t=="object"&&!Array.isArray(t)?Hl(t):null}function Tl(t){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&($z(n)||Gz(n)||KA(n))&&(r[n]=t[n]);return r}function Fne(t){return t==null?null:k.isValidElement(t)?Tl(t.props):typeof t=="object"&&!Array.isArray(t)?Tl(t):null}var qne=["children","width","height","viewBox","className","style","title","desc"];function JC(){return JC=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},JC.apply(null,arguments)}function Une(t,r){if(t==null)return{};var n,i,a=Wne(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Wne(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var QA=k.forwardRef((t,r)=>{var{children:n,width:i,height:a,viewBox:s,className:o,style:l,title:u,desc:d}=t,f=Une(t,qne),p=s||{width:i,height:a,x:0,y:0},x=hi("recharts-surface",o);return k.createElement("svg",JC({},Tl(f),{className:x,width:i,height:a,style:l,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:r}),k.createElement("title",null,u),k.createElement("desc",null,d),n)}),Hne=["children","className"];function eN(){return eN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},eN.apply(null,arguments)}function Vne(t,r){if(t==null)return{};var n,i,a=$ne(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function $ne(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var Os=k.forwardRef((t,r)=>{var{children:n,className:i}=t,a=Vne(t,Hne),s=hi("recharts-layer",i);return k.createElement("g",eN({className:s},Tl(a),{ref:r}),n)}),Kz=k.createContext(null),Gne=()=>k.useContext(Kz);function fa(t){return function(){return t}}const Qz=Math.cos,Uv=Math.sin,Od=Math.sqrt,Wv=Math.PI,a2=2*Wv,tN=Math.PI,rN=2*tN,Df=1e-6,Kne=rN-Df;function Yz(t){this._+=t[0];for(let r=1,n=t.length;r<n;++r)this._+=arguments[r]+t[r]}function Qne(t){let r=Math.floor(t);if(!(r>=0))throw new Error(`invalid digits: ${t}`);if(r>15)return Yz;const n=10**r;return function(i){this._+=i[0];for(let a=1,s=i.length;a<s;++a)this._+=Math.round(arguments[a]*n)/n+i[a]}}class Yne{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?Yz:Qne(r)}moveTo(r,n){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,n){this._append`L${this._x1=+r},${this._y1=+n}`}quadraticCurveTo(r,n,i,a){this._append`Q${+r},${+n},${this._x1=+i},${this._y1=+a}`}bezierCurveTo(r,n,i,a,s,o){this._append`C${+r},${+n},${+i},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(r,n,i,a,s){if(r=+r,n=+n,i=+i,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,u=i-r,d=a-n,f=o-r,p=l-n,x=f*f+p*p;if(this._x1===null)this._append`M${this._x1=r},${this._y1=n}`;else if(x>Df)if(!(Math.abs(p*u-d*f)>Df)||!s)this._append`L${this._x1=r},${this._y1=n}`;else{let v=i-o,w=a-l,C=u*u+d*d,A=v*v+w*w,T=Math.sqrt(C),O=Math.sqrt(x),D=s*Math.tan((tN-Math.acos((C+x-A)/(2*T*O)))/2),M=D/O,Q=D/T;Math.abs(M-1)>Df&&this._append`L${r+M*f},${n+M*p}`,this._append`A${s},${s},0,0,${+(p*v>f*w)},${this._x1=r+Q*u},${this._y1=n+Q*d}`}}arc(r,n,i,a,s,o){if(r=+r,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(a),u=i*Math.sin(a),d=r+l,f=n+u,p=1^o,x=o?a-s:s-a;this._x1===null?this._append`M${d},${f}`:(Math.abs(this._x1-d)>Df||Math.abs(this._y1-f)>Df)&&this._append`L${d},${f}`,i&&(x<0&&(x=x%rN+rN),x>Kne?this._append`A${i},${i},0,1,${p},${r-l},${n-u}A${i},${i},0,1,${p},${this._x1=d},${this._y1=f}`:x>Df&&this._append`A${i},${i},0,${+(x>=tN)},${p},${this._x1=r+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(r,n,i,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}h${i=+i}v${+a}h${-i}Z`}toString(){return this._}}function YA(t){let r=3;return t.digits=function(n){if(!arguments.length)return r;if(n==null)r=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);r=i}return t},()=>new Yne(r)}function ZA(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Zz(t){this._context=t}Zz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;default:this._context.lineTo(t,r);break}}};function s2(t){return new Zz(t)}function Xz(t){return t[0]}function Jz(t){return t[1]}function eB(t,r){var n=fa(!0),i=null,a=s2,s=null,o=YA(l);t=typeof t=="function"?t:t===void 0?Xz:fa(t),r=typeof r=="function"?r:r===void 0?Jz:fa(r);function l(u){var d,f=(u=ZA(u)).length,p,x=!1,v;for(i==null&&(s=a(v=o())),d=0;d<=f;++d)!(d<f&&n(p=u[d],d,u))===x&&((x=!x)?s.lineStart():s.lineEnd()),x&&s.point(+t(p,d,u),+r(p,d,u));if(v)return s=null,v+""||null}return l.x=function(u){return arguments.length?(t=typeof u=="function"?u:fa(+u),l):t},l.y=function(u){return arguments.length?(r=typeof u=="function"?u:fa(+u),l):r},l.defined=function(u){return arguments.length?(n=typeof u=="function"?u:fa(!!u),l):n},l.curve=function(u){return arguments.length?(a=u,i!=null&&(s=a(i)),l):a},l.context=function(u){return arguments.length?(u==null?i=s=null:s=a(i=u),l):i},l}function Hx(t,r,n){var i=null,a=fa(!0),s=null,o=s2,l=null,u=YA(d);t=typeof t=="function"?t:t===void 0?Xz:fa(+t),r=typeof r=="function"?r:fa(r===void 0?0:+r),n=typeof n=="function"?n:n===void 0?Jz:fa(+n);function d(p){var x,v,w,C=(p=ZA(p)).length,A,T=!1,O,D=new Array(C),M=new Array(C);for(s==null&&(l=o(O=u())),x=0;x<=C;++x){if(!(x<C&&a(A=p[x],x,p))===T)if(T=!T)v=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),w=x-1;w>=v;--w)l.point(D[w],M[w]);l.lineEnd(),l.areaEnd()}T&&(D[x]=+t(A,x,p),M[x]=+r(A,x,p),l.point(i?+i(A,x,p):D[x],n?+n(A,x,p):M[x]))}if(O)return l=null,O+""||null}function f(){return eB().defined(a).curve(o).context(s)}return d.x=function(p){return arguments.length?(t=typeof p=="function"?p:fa(+p),i=null,d):t},d.x0=function(p){return arguments.length?(t=typeof p=="function"?p:fa(+p),d):t},d.x1=function(p){return arguments.length?(i=p==null?null:typeof p=="function"?p:fa(+p),d):i},d.y=function(p){return arguments.length?(r=typeof p=="function"?p:fa(+p),n=null,d):r},d.y0=function(p){return arguments.length?(r=typeof p=="function"?p:fa(+p),d):r},d.y1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:fa(+p),d):n},d.lineX0=d.lineY0=function(){return f().x(t).y(r)},d.lineY1=function(){return f().x(t).y(n)},d.lineX1=function(){return f().x(i).y(r)},d.defined=function(p){return arguments.length?(a=typeof p=="function"?p:fa(!!p),d):a},d.curve=function(p){return arguments.length?(o=p,s!=null&&(l=o(s)),d):o},d.context=function(p){return arguments.length?(p==null?s=l=null:l=o(s=p),d):s},d}class tB{constructor(r,n){this._context=r,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,n){switch(r=+r,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,n,r,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,r,this._y0,r,n);break}}this._x0=r,this._y0=n}}function Zne(t){return new tB(t,!0)}function Xne(t){return new tB(t,!1)}const XA={draw(t,r){const n=Od(r/Wv);t.moveTo(n,0),t.arc(0,0,n,0,a2)}},Jne={draw(t,r){const n=Od(r/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},rB=Od(1/3),eie=rB*2,tie={draw(t,r){const n=Od(r/eie),i=n*rB;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},rie={draw(t,r){const n=Od(r),i=-n/2;t.rect(i,i,n,n)}},nie=.8908130915292852,nB=Uv(Wv/10)/Uv(7*Wv/10),iie=Uv(a2/10)*nB,aie=-Qz(a2/10)*nB,sie={draw(t,r){const n=Od(r*nie),i=iie*n,a=aie*n;t.moveTo(0,-n),t.lineTo(i,a);for(let s=1;s<5;++s){const o=a2*s/5,l=Qz(o),u=Uv(o);t.lineTo(u*n,-l*n),t.lineTo(l*i-u*a,u*i+l*a)}t.closePath()}},W5=Od(3),oie={draw(t,r){const n=-Od(r/(W5*3));t.moveTo(0,n*2),t.lineTo(-W5*n,-n),t.lineTo(W5*n,-n),t.closePath()}},Kc=-.5,Qc=Od(3)/2,nN=1/Od(12),lie=(nN/2+1)*3,cie={draw(t,r){const n=Od(r/lie),i=n/2,a=n*nN,s=i,o=n*nN+n,l=-s,u=o;t.moveTo(i,a),t.lineTo(s,o),t.lineTo(l,u),t.lineTo(Kc*i-Qc*a,Qc*i+Kc*a),t.lineTo(Kc*s-Qc*o,Qc*s+Kc*o),t.lineTo(Kc*l-Qc*u,Qc*l+Kc*u),t.lineTo(Kc*i+Qc*a,Kc*a-Qc*i),t.lineTo(Kc*s+Qc*o,Kc*o-Qc*s),t.lineTo(Kc*l+Qc*u,Kc*u-Qc*l),t.closePath()}};function die(t,r){let n=null,i=YA(a);t=typeof t=="function"?t:fa(t||XA),r=typeof r=="function"?r:fa(r===void 0?64:+r);function a(){let s;if(n||(n=s=i()),t.apply(this,arguments).draw(n,+r.apply(this,arguments)),s)return n=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:fa(s),a):t},a.size=function(s){return arguments.length?(r=typeof s=="function"?s:fa(+s),a):r},a.context=function(s){return arguments.length?(n=s??null,a):n},a}function Hv(){}function Vv(t,r,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+r)/6,(t._y0+4*t._y1+n)/6)}function iB(t){this._context=t}iB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Vv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Vv(this,t,r);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r}};function uie(t){return new iB(t)}function aB(t){this._context=t}aB.prototype={areaStart:Hv,areaEnd:Hv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._x2=t,this._y2=r;break;case 1:this._point=2,this._x3=t,this._y3=r;break;case 2:this._point=3,this._x4=t,this._y4=r,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+r)/6);break;default:Vv(this,t,r);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r}};function hie(t){return new aB(t)}function sB(t){this._context=t}sB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Vv(this,t,r);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r}};function fie(t){return new sB(t)}function oB(t){this._context=t}oB.prototype={areaStart:Hv,areaEnd:Hv,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,r){t=+t,r=+r,this._point?this._context.lineTo(t,r):(this._point=1,this._context.moveTo(t,r))}};function mie(t){return new oB(t)}function u6(t){return t<0?-1:1}function h6(t,r,n){var i=t._x1-t._x0,a=r-t._x1,s=(t._y1-t._y0)/(i||a<0&&-0),o=(n-t._y1)/(a||i<0&&-0),l=(s*a+o*i)/(i+a);return(u6(s)+u6(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function f6(t,r){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-r)/2:r}function H5(t,r,n){var i=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-i)/3;t._context.bezierCurveTo(i+l,a+l*r,s-l,o-l*n,s,o)}function $v(t){this._context=t}$v.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:H5(this,this._t0,f6(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){var n=NaN;if(t=+t,r=+r,!(t===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;break;case 2:this._point=3,H5(this,f6(this,n=h6(this,t,r)),n);break;default:H5(this,this._t0,n=h6(this,t,r));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=r,this._t0=n}}};function lB(t){this._context=new cB(t)}(lB.prototype=Object.create($v.prototype)).point=function(t,r){$v.prototype.point.call(this,r,t)};function cB(t){this._context=t}cB.prototype={moveTo:function(t,r){this._context.moveTo(r,t)},closePath:function(){this._context.closePath()},lineTo:function(t,r){this._context.lineTo(r,t)},bezierCurveTo:function(t,r,n,i,a,s){this._context.bezierCurveTo(r,t,i,n,s,a)}};function pie(t){return new $v(t)}function gie(t){return new lB(t)}function dB(t){this._context=t}dB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,r=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],r[0]):this._context.moveTo(t[0],r[0]),n===2)this._context.lineTo(t[1],r[1]);else for(var i=m6(t),a=m6(r),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],a[0][s],i[1][s],a[1][s],t[o],r[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,r){this._x.push(+t),this._y.push(+r)}};function m6(t){var r,n=t.length-1,i,a=new Array(n),s=new Array(n),o=new Array(n);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],r=1;r<n-1;++r)a[r]=1,s[r]=4,o[r]=4*t[r]+2*t[r+1];for(a[n-1]=2,s[n-1]=7,o[n-1]=8*t[n-1]+t[n],r=1;r<n;++r)i=a[r]/s[r-1],s[r]-=i,o[r]-=i*o[r-1];for(a[n-1]=o[n-1]/s[n-1],r=n-2;r>=0;--r)a[r]=(o[r]-a[r+1])/s[r];for(s[n-1]=(t[n]+a[n-1])/2,r=0;r<n-1;++r)s[r]=2*t[r+1]-a[r+1];return[a,s]}function yie(t){return new dB(t)}function o2(t,r){this._context=t,this._t=r}o2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,r){switch(t=+t,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(t,r);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,r)}break}}this._x=t,this._y=r}};function xie(t){return new o2(t,.5)}function vie(t){return new o2(t,0)}function bie(t){return new o2(t,1)}function um(t,r){if((o=t.length)>1)for(var n=1,i,a,s=t[r[0]],o,l=s.length;n<o;++n)for(a=s,s=t[r[n]],i=0;i<l;++i)s[i][1]+=s[i][0]=isNaN(a[i][1])?a[i][0]:a[i][1]}function iN(t){for(var r=t.length,n=new Array(r);--r>=0;)n[r]=r;return n}function jie(t,r){return t[r]}function wie(t){const r=[];return r.key=t,r}function Sie(){var t=fa([]),r=iN,n=um,i=jie;function a(s){var o=Array.from(t.apply(this,arguments),wie),l,u=o.length,d=-1,f;for(const p of s)for(l=0,++d;l<u;++l)(o[l][d]=[0,+i(p,o[l].key,d,s)]).data=p;for(l=0,f=ZA(r(o));l<u;++l)o[f[l]].index=l;return n(o,f),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:fa(Array.from(s)),a):t},a.value=function(s){return arguments.length?(i=typeof s=="function"?s:fa(+s),a):i},a.order=function(s){return arguments.length?(r=s==null?iN:typeof s=="function"?s:fa(Array.from(s)),a):r},a.offset=function(s){return arguments.length?(n=s??um,a):n},a}function Cie(t,r){if((i=t.length)>0){for(var n,i,a=0,s=t[0].length,o;a<s;++a){for(o=n=0;n<i;++n)o+=t[n][a][1]||0;if(o)for(n=0;n<i;++n)t[n][a][1]/=o}um(t,r)}}function Nie(t,r){if((a=t.length)>0){for(var n=0,i=t[r[0]],a,s=i.length;n<s;++n){for(var o=0,l=0;o<a;++o)l+=t[o][n][1]||0;i[n][1]+=i[n][0]=-l/2}um(t,r)}}function Aie(t,r){if(!(!((o=t.length)>0)||!((s=(a=t[r[0]]).length)>0))){for(var n=0,i=1,a,s,o;i<s;++i){for(var l=0,u=0,d=0;l<o;++l){for(var f=t[r[l]],p=f[i][1]||0,x=f[i-1][1]||0,v=(p-x)/2,w=0;w<l;++w){var C=t[r[w]],A=C[i][1]||0,T=C[i-1][1]||0;v+=A-T}u+=p,d+=v*p}a[i-1][1]+=a[i-1][0]=n,u&&(n-=d/u)}a[i-1][1]+=a[i-1][0]=n,um(t,r)}}var V5={},$5={},p6;function Eie(){return p6||(p6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return n==="__proto__"}t.isUnsafeProperty=r})($5)),$5}var G5={},g6;function uB(){return g6||(g6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}t.isDeepKey=r})(G5)),G5}var K5={},y6;function JA(){return y6||(y6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}t.toKey=r})(K5)),K5}var Q5={},Y5={},x6;function _ie(){return x6||(x6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(r).join(",");const i=String(n);return i==="0"&&Object.is(Number(n),-0)?"-0":i}t.toString=r})(Y5)),Y5}var v6;function eE(){return v6||(v6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=_ie(),n=JA();function i(a){if(Array.isArray(a))return a.map(n.toKey);if(typeof a=="symbol")return[a];a=r.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,u="",d="",f=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const p=a[l];d?p==="\\"&&l+1<o?(l++,u+=a[l]):p===d?d="":u+=p:f?p==='"'||p==="'"?d=p:p==="]"?(f=!1,s.push(u),u=""):u+=p:p==="["?(f=!0,u&&(s.push(u),u="")):p==="."?u&&(s.push(u),u=""):u+=p,l++}return u&&s.push(u),s}t.toPath=i})(Q5)),Q5}var b6;function tE(){return b6||(b6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=Eie(),n=uB(),i=JA(),a=eE();function s(l,u,d){if(l==null)return d;switch(typeof u){case"string":{if(r.isUnsafeProperty(u))return d;const f=l[u];return f===void 0?n.isDeepKey(u)?s(l,a.toPath(u),d):d:f}case"number":case"symbol":{typeof u=="number"&&(u=i.toKey(u));const f=l[u];return f===void 0?d:f}default:{if(Array.isArray(u))return o(l,u,d);if(Object.is(u?.valueOf(),-0)?u="-0":u=String(u),r.isUnsafeProperty(u))return d;const f=l[u];return f===void 0?d:f}}}function o(l,u,d){if(u.length===0)return d;let f=l;for(let p=0;p<u.length;p++){if(f==null||r.isUnsafeProperty(u[p]))return d;f=f[u[p]]}return f===void 0?d:f}t.get=s})(V5)),V5}var Z5,j6;function Tie(){return j6||(j6=1,Z5=tE().get),Z5}var Iie=Tie();const hm=hc(Iie);var Oie=4;function ef(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Oie,n=10**r,i=Math.round(t*n)/n;return Object.is(i,-0)?0:i}function As(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t.reduce((a,s,o)=>{var l=n[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+ef(l)+s:a+s},"")}var Bo=t=>t===0?0:t>0?1:-1,id=t=>typeof t=="number"&&t!=+t,oh=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,or=t=>(typeof t=="number"||t instanceof Number)&&!id(t),uu=t=>or(t)||typeof t=="string",kie=0,Wg=t=>{var r=++kie;return"".concat(t||"").concat(r)},_l=function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!or(r)&&typeof r!="string")return i;var s;if(oh(r)){if(n==null)return i;var o=r.indexOf("%");s=n*parseFloat(r.slice(0,o))/100}else s=+r;return id(s)&&(s=i),a&&n!=null&&s>n&&(s=n),s},hB=t=>{if(!Array.isArray(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[String(t[i])])n[String(t[i])]=!0;else return!0;return!1};function Ti(t,r,n){return or(t)&&or(r)?ef(t+n*(r-t)):r}function fB(t,r,n){if(!(!t||!t.length))return t.find(i=>i&&(typeof r=="function"?r(i):hm(i,r))===n)}var Ta=t=>t===null||typeof t>"u",xy=t=>Ta(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function Die(t){return t!=null}function vy(){}var Pie=["type","size","sizeType"];function aN(){return aN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},aN.apply(null,arguments)}function w6(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function S6(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?w6(Object(n),!0).forEach(function(i){Rie(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Rie(t,r,n){return(r=Mie(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Mie(t){var r=Lie(t,"string");return typeof r=="symbol"?r:r+""}function Lie(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function zie(t,r){if(t==null)return{};var n,i,a=Bie(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Bie(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var mB={symbolCircle:XA,symbolCross:Jne,symbolDiamond:tie,symbolSquare:rie,symbolStar:sie,symbolTriangle:oie,symbolWye:cie},Fie=Math.PI/180,qie=t=>{var r="symbol".concat(xy(t));return mB[r]||XA},Uie=(t,r,n)=>{if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*Fie;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.tan(i)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Wie=(t,r)=>{mB["symbol".concat(xy(t))]=r},rE=t=>{var{type:r="circle",size:n=64,sizeType:i="area"}=t,a=zie(t,Pie),s=S6(S6({},a),{},{type:r,size:n,sizeType:i}),o="circle";typeof r=="string"&&(o=r);var l=()=>{var x=qie(o),v=die().type(x).size(Uie(n,i,o)),w=v();if(w!==null)return w},{className:u,cx:d,cy:f}=s,p=Tl(s);return or(d)&&or(f)&&or(n)?k.createElement("path",aN({},p,{className:hi("recharts-symbols",u),transform:"translate(".concat(d,", ").concat(f,")"),d:l()})):null};rE.registerSymbol=Wie;var pB=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,nE=(t,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(k.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{KA(a)&&(i[a]=(s=>n[a](n,s)))}),i},Hie=(t,r,n)=>i=>(t(r,n,i),null),by=(t,r,n)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var i=null;return Object.keys(t).forEach(a=>{var s=t[a];KA(a)&&typeof s=="function"&&(i||(i={}),i[a]=Hie(s,r,n))}),i};function C6(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Vie(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?C6(Object(n),!0).forEach(function(i){$ie(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function $ie(t,r,n){return(r=Gie(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Gie(t){var r=Kie(t,"string");return typeof r=="symbol"?r:r+""}function Kie(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function ks(t,r){var n=Vie({},t),i=r,a=Object.keys(r),s=a.reduce((o,l)=>(o[l]===void 0&&i[l]!==void 0&&(o[l]=i[l]),o),n);return s}function Gv(){return Gv=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Gv.apply(null,arguments)}function N6(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Qie(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?N6(Object(n),!0).forEach(function(i){Yie(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Yie(t,r,n){return(r=Zie(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Zie(t){var r=Xie(t,"string");return typeof r=="symbol"?r:r+""}function Xie(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Zc=32,Jie={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function eae(t){var{data:r,iconType:n,inactiveColor:i}=t,a=Zc/2,s=Zc/6,o=Zc/3,l=r.inactive?i:r.color,u=n??r.type;if(u==="none")return null;if(u==="plainline"){var d;return k.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(d=r.payload)===null||d===void 0?void 0:d.strokeDasharray,x1:0,y1:a,x2:Zc,y2:a,className:"recharts-legend-icon"})}if(u==="line")return k.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Zc,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(u==="rect")return k.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Zc/8,"h").concat(Zc,"v").concat(Zc*3/4,"h").concat(-Zc,"z"),className:"recharts-legend-icon"});if(k.isValidElement(r.legendIcon)){var f=Qie({},r);return delete f.legendIcon,k.cloneElement(r.legendIcon,f)}return k.createElement(rE,{fill:l,cx:a,cy:a,size:Zc,sizeType:"diameter",type:u})}function tae(t){var{payload:r,iconSize:n,layout:i,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:Zc,height:Zc},u={display:i==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map((f,p)=>{var x=f.formatter||a,v=hi({"recharts-legend-item":!0,["legend-item-".concat(p)]:!0,inactive:f.inactive});if(f.type==="none")return null;var w=f.inactive?s:f.color,C=x?x(f.value,f,p):f.value;return k.createElement("li",Gv({className:v,style:u,key:"legend-item-".concat(p)},by(t,f,p)),k.createElement(QA,{width:n,height:n,viewBox:l,style:d,"aria-label":"".concat(C," legend icon")},k.createElement(eae,{data:f,iconType:o,inactiveColor:s})),k.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},C))})}var rae=t=>{var r=ks(t,Jie),{payload:n,layout:i,align:a}=r;if(!n||!n.length)return null;var s={padding:0,margin:0,textAlign:i==="horizontal"?a:"left"};return k.createElement("ul",{className:"recharts-default-legend",style:s},k.createElement(tae,Gv({},r,{payload:n})))},X5={},J5={},A6;function nae(){return A6||(A6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n,i){const a=new Map;for(let s=0;s<n.length;s++){const o=n[s],l=i(o,s,n);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=r})(J5)),J5}var ew={},E6;function iae(){return E6||(E6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n,i){return function(...a){return n.apply(this,a.slice(0,i))}}t.ary=r})(ew)),ew}var tw={},_6;function gB(){return _6||(_6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return n}t.identity=r})(tw)),tw}var rw={},nw={},iw={},T6;function aae(){return T6||(T6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return Number.isSafeInteger(n)&&n>=0}t.isLength=r})(iw)),iw}var I6;function iE(){return I6||(I6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=aae();function n(i){return i!=null&&typeof i!="function"&&r.isLength(i.length)}t.isArrayLike=n})(nw)),nw}var aw={},O6;function sae(){return O6||(O6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="object"&&n!==null}t.isObjectLike=r})(aw)),aw}var k6;function oae(){return k6||(k6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=iE(),n=sae();function i(a){return n.isObjectLike(a)&&r.isArrayLike(a)}t.isArrayLikeObject=i})(rw)),rw}var sw={},ow={},D6;function lae(){return D6||(D6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=tE();function n(i){return function(a){return r.get(a,i)}}t.property=n})(ow)),ow}var lw={},cw={},dw={},uw={},P6;function yB(){return P6||(P6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return n!==null&&(typeof n=="object"||typeof n=="function")}t.isObject=r})(uw)),uw}var hw={},R6;function xB(){return R6||(R6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return n==null||typeof n!="object"&&typeof n!="function"}t.isPrimitive=r})(hw)),hw}var fw={},M6;function vB(){return M6||(M6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n,i){return n===i||Number.isNaN(n)&&Number.isNaN(i)}t.isEqualsSameValueZero=r})(fw)),fw}var L6;function cae(){return L6||(L6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=yB(),n=xB(),i=vB();function a(f,p,x){return typeof x!="function"?a(f,p,()=>{}):s(f,p,function v(w,C,A,T,O,D){const M=x(w,C,A,T,O,D);return M!==void 0?!!M:s(w,C,v,D)},new Map)}function s(f,p,x,v){if(p===f)return!0;switch(typeof p){case"object":return o(f,p,x,v);case"function":return Object.keys(p).length>0?s(f,{...p},x,v):i.isEqualsSameValueZero(f,p);default:return r.isObject(f)?typeof p=="string"?p==="":!0:i.isEqualsSameValueZero(f,p)}}function o(f,p,x,v){if(p==null)return!0;if(Array.isArray(p))return u(f,p,x,v);if(p instanceof Map)return l(f,p,x,v);if(p instanceof Set)return d(f,p,x,v);const w=Object.keys(p);if(f==null||n.isPrimitive(f))return w.length===0;if(w.length===0)return!0;if(v?.has(p))return v.get(p)===f;v?.set(p,f);try{for(let C=0;C<w.length;C++){const A=w[C];if(!n.isPrimitive(f)&&!(A in f)||p[A]===void 0&&f[A]!==void 0||p[A]===null&&f[A]!==null||!x(f[A],p[A],A,f,p,v))return!1}return!0}finally{v?.delete(p)}}function l(f,p,x,v){if(p.size===0)return!0;if(!(f instanceof Map))return!1;for(const[w,C]of p.entries()){const A=f.get(w);if(x(A,C,w,f,p,v)===!1)return!1}return!0}function u(f,p,x,v){if(p.length===0)return!0;if(!Array.isArray(f))return!1;const w=new Set;for(let C=0;C<p.length;C++){const A=p[C];let T=!1;for(let O=0;O<f.length;O++){if(w.has(O))continue;const D=f[O];let M=!1;if(x(D,A,C,f,p,v)&&(M=!0),M){w.add(O),T=!0;break}}if(!T)return!1}return!0}function d(f,p,x,v){return p.size===0?!0:f instanceof Set?u([...f],[...p],x,v):!1}t.isMatchWith=a,t.isSetMatch=d})(dw)),dw}var z6;function bB(){return z6||(z6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=cae();function n(i,a){return r.isMatchWith(i,a,()=>{})}t.isMatch=n})(cw)),cw}var mw={},pw={},gw={},B6;function dae(){return B6||(B6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return Object.getOwnPropertySymbols(n).filter(i=>Object.prototype.propertyIsEnumerable.call(n,i))}t.getSymbols=r})(gw)),gw}var yw={},F6;function aE(){return F6||(F6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}t.getTag=r})(yw)),yw}var xw={},q6;function jB(){return q6||(q6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r="[object RegExp]",n="[object String]",i="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",u="[object Map]",d="[object Set]",f="[object Array]",p="[object Function]",x="[object ArrayBuffer]",v="[object Object]",w="[object Error]",C="[object DataView]",A="[object Uint8Array]",T="[object Uint8ClampedArray]",O="[object Uint16Array]",D="[object Uint32Array]",M="[object BigUint64Array]",Q="[object Int8Array]",U="[object Int16Array]",$="[object Int32Array]",ee="[object BigInt64Array]",F="[object Float32Array]",Y="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=x,t.arrayTag=f,t.bigInt64ArrayTag=ee,t.bigUint64ArrayTag=M,t.booleanTag=a,t.dataViewTag=C,t.dateTag=l,t.errorTag=w,t.float32ArrayTag=F,t.float64ArrayTag=Y,t.functionTag=p,t.int16ArrayTag=U,t.int32ArrayTag=$,t.int8ArrayTag=Q,t.mapTag=u,t.numberTag=i,t.objectTag=v,t.regexpTag=r,t.setTag=d,t.stringTag=n,t.symbolTag=o,t.uint16ArrayTag=O,t.uint32ArrayTag=D,t.uint8ArrayTag=A,t.uint8ClampedArrayTag=T})(xw)),xw}var vw={},U6;function uae(){return U6||(U6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}t.isTypedArray=r})(vw)),vw}var W6;function wB(){return W6||(W6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=dae(),n=aE(),i=jB(),a=xB(),s=uae();function o(f,p){return l(f,void 0,f,new Map,p)}function l(f,p,x,v=new Map,w=void 0){const C=w?.(f,p,x,v);if(C!==void 0)return C;if(a.isPrimitive(f))return f;if(v.has(f))return v.get(f);if(Array.isArray(f)){const A=new Array(f.length);v.set(f,A);for(let T=0;T<f.length;T++)A[T]=l(f[T],T,x,v,w);return Object.hasOwn(f,"index")&&(A.index=f.index),Object.hasOwn(f,"input")&&(A.input=f.input),A}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const A=new RegExp(f.source,f.flags);return A.lastIndex=f.lastIndex,A}if(f instanceof Map){const A=new Map;v.set(f,A);for(const[T,O]of f)A.set(T,l(O,T,x,v,w));return A}if(f instanceof Set){const A=new Set;v.set(f,A);for(const T of f)A.add(l(T,void 0,x,v,w));return A}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(s.isTypedArray(f)){const A=new(Object.getPrototypeOf(f)).constructor(f.length);v.set(f,A);for(let T=0;T<f.length;T++)A[T]=l(f[T],T,x,v,w);return A}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const A=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return v.set(f,A),u(A,f,x,v,w),A}if(typeof File<"u"&&f instanceof File){const A=new File([f],f.name,{type:f.type});return v.set(f,A),u(A,f,x,v,w),A}if(typeof Blob<"u"&&f instanceof Blob){const A=new Blob([f],{type:f.type});return v.set(f,A),u(A,f,x,v,w),A}if(f instanceof Error){const A=new f.constructor;return v.set(f,A),A.message=f.message,A.name=f.name,A.stack=f.stack,A.cause=f.cause,u(A,f,x,v,w),A}if(f instanceof Boolean){const A=new Boolean(f.valueOf());return v.set(f,A),u(A,f,x,v,w),A}if(f instanceof Number){const A=new Number(f.valueOf());return v.set(f,A),u(A,f,x,v,w),A}if(f instanceof String){const A=new String(f.valueOf());return v.set(f,A),u(A,f,x,v,w),A}if(typeof f=="object"&&d(f)){const A=Object.create(Object.getPrototypeOf(f));return v.set(f,A),u(A,f,x,v,w),A}return f}function u(f,p,x=f,v,w){const C=[...Object.keys(p),...r.getSymbols(p)];for(let A=0;A<C.length;A++){const T=C[A],O=Object.getOwnPropertyDescriptor(f,T);(O==null||O.writable)&&(f[T]=l(p[T],T,x,v,w))}}function d(f){switch(n.getTag(f)){case i.argumentsTag:case i.arrayTag:case i.arrayBufferTag:case i.dataViewTag:case i.booleanTag:case i.dateTag:case i.float32ArrayTag:case i.float64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.mapTag:case i.numberTag:case i.objectTag:case i.regexpTag:case i.setTag:case i.stringTag:case i.symbolTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=u})(pw)),pw}var H6;function hae(){return H6||(H6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=wB();function n(i){return r.cloneDeepWithImpl(i,void 0,i,new Map,void 0)}t.cloneDeep=n})(mw)),mw}var V6;function fae(){return V6||(V6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=bB(),n=hae();function i(a){return a=n.cloneDeep(a),s=>r.isMatch(s,a)}t.matches=i})(lw)),lw}var bw={},jw={},ww={},$6;function mae(){return $6||($6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=wB(),n=aE(),i=jB();function a(s,o){return r.cloneDeepWith(s,(l,u,d,f)=>{const p=o?.(l,u,d,f);if(p!==void 0)return p;if(typeof s=="object"){if(n.getTag(s)===i.objectTag&&typeof s.constructor!="function"){const x={};return f.set(s,x),r.copyProperties(x,s,d,f),x}switch(Object.prototype.toString.call(s)){case i.numberTag:case i.stringTag:case i.booleanTag:{const x=new s.constructor(s?.valueOf());return r.copyProperties(x,s),x}case i.argumentsTag:{const x={};return r.copyProperties(x,s),x.length=s.length,x[Symbol.iterator]=s[Symbol.iterator],x}default:return}}})}t.cloneDeepWith=a})(ww)),ww}var G6;function pae(){return G6||(G6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=mae();function n(i){return r.cloneDeepWith(i)}t.cloneDeep=n})(jw)),jw}var Sw={},Cw={},K6;function SB(){return K6||(K6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=/^(?:0|[1-9]\d*)$/;function n(i,a=Number.MAX_SAFE_INTEGER){switch(typeof i){case"number":return Number.isInteger(i)&&i>=0&&i<a;case"symbol":return!1;case"string":return r.test(i)}}t.isIndex=n})(Cw)),Cw}var Nw={},Q6;function gae(){return Q6||(Q6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=aE();function n(i){return i!==null&&typeof i=="object"&&r.getTag(i)==="[object Arguments]"}t.isArguments=n})(Nw)),Nw}var Y6;function yae(){return Y6||(Y6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=uB(),n=SB(),i=gae(),a=eE();function s(o,l){let u;if(Array.isArray(l)?u=l:typeof l=="string"&&r.isDeepKey(l)&&o?.[l]==null?u=a.toPath(l):u=[l],u.length===0)return!1;let d=o;for(let f=0;f<u.length;f++){const p=u[f];if((d==null||!Object.hasOwn(d,p))&&!((Array.isArray(d)||i.isArguments(d))&&n.isIndex(p)&&p<d.length))return!1;d=d[p]}return!0}t.has=s})(Sw)),Sw}var Z6;function xae(){return Z6||(Z6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=bB(),n=JA(),i=pae(),a=tE(),s=yae();function o(l,u){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=n.toKey(l);break}}return u=i.cloneDeep(u),function(d){const f=a.get(d,l);return f===void 0?s.has(d,l):u===void 0?f===void 0:r.isMatch(f,u)}}t.matchesProperty=o})(bw)),bw}var X6;function vae(){return X6||(X6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=gB(),n=lae(),i=fae(),a=xae();function s(o){if(o==null)return r.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):i.matches(o);case"string":case"symbol":case"number":return n.property(o)}}t.iteratee=s})(sw)),sw}var J6;function bae(){return J6||(J6=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=nae(),n=iae(),i=gB(),a=oae(),s=vae();function o(l,u=i.identity){return a.isArrayLikeObject(l)?r.uniqBy(Array.from(l),n.ary(s.iteratee(u),1)):[]}t.uniqBy=o})(X5)),X5}var Aw,eI;function jae(){return eI||(eI=1,Aw=bae().uniqBy),Aw}var wae=jae();const tI=hc(wae);function CB(t,r,n){return r===!0?tI(t,n):typeof r=="function"?tI(t,r):t}var Ew={exports:{}},_w={};var rI;function Sae(){if(rI)return _w;rI=1;var t=Vp(),r=jz();function n(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var i=typeof Object.is=="function"?Object.is:n,a=r.useSyncExternalStore,s=t.useRef,o=t.useEffect,l=t.useMemo,u=t.useDebugValue;return _w.useSyncExternalStoreWithSelector=function(d,f,p,x,v){var w=s(null);if(w.current===null){var C={hasValue:!1,value:null};w.current=C}else C=w.current;w=l(function(){function T(U){if(!O){if(O=!0,D=U,U=x(U),v!==void 0&&C.hasValue){var $=C.value;if(v($,U))return M=$}return M=U}if($=M,i(D,U))return $;var ee=x(U);return v!==void 0&&v($,ee)?(D=U,$):(D=U,M=ee)}var O=!1,D,M,Q=p===void 0?null:p;return[function(){return T(f())},Q===null?void 0:function(){return T(Q())}]},[f,p,x,v]);var A=a(d,w[0],w[1]);return o(function(){C.hasValue=!0,C.value=A},[A]),u(A),A},_w}var nI;function Cae(){return nI||(nI=1,Ew.exports=Sae()),Ew.exports}var Nae=Cae(),sE=k.createContext(null),Aae=t=>t,pa=()=>{var t=k.useContext(sE);return t?t.store.dispatch:Aae},gv=()=>{},Eae=()=>gv,_ae=(t,r)=>t===r;function wr(t){var r=k.useContext(sE);return Nae.useSyncExternalStoreWithSelector(r?r.subscription.addNestedSub:Eae,r?r.store.getState:gv,r?r.store.getState:gv,r?t:gv,_ae)}function Tae(t,r=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(r)}function Iae(t,r=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(r)}function Oae(t,r="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(i=>typeof i=="function"?`function ${i.name||"unnamed"}()`:typeof i).join(", ");throw new TypeError(`${r}[${n}]`)}}var iI=t=>Array.isArray(t)?t:[t];function kae(t){const r=Array.isArray(t[0])?t[0]:t;return Oae(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}function Dae(t,r){const n=[],{length:i}=t;for(let a=0;a<i;a++)n.push(t[a].apply(null,r));return n}var Pae=class{constructor(t){this.value=t}deref(){return this.value}},Rae=typeof WeakRef<"u"?WeakRef:Pae,Mae=0,aI=1;function Vx(){return{s:Mae,v:void 0,o:null,p:null}}function NB(t,r={}){let n=Vx();const{resultEqualityCheck:i}=r;let a,s=0;function o(){let l=n;const{length:u}=arguments;for(let p=0,x=u;p<x;p++){const v=arguments[p];if(typeof v=="function"||typeof v=="object"&&v!==null){let w=l.o;w===null&&(l.o=w=new WeakMap);const C=w.get(v);C===void 0?(l=Vx(),w.set(v,l)):l=C}else{let w=l.p;w===null&&(l.p=w=new Map);const C=w.get(v);C===void 0?(l=Vx(),w.set(v,l)):l=C}}const d=l;let f;if(l.s===aI)f=l.v;else if(f=t.apply(null,arguments),s++,i){const p=a?.deref?.()??a;p!=null&&i(p,f)&&(f=p,s!==0&&s--),a=typeof f=="object"&&f!==null||typeof f=="function"?new Rae(f):f}return d.s=aI,d.v=f,f}return o.clearCache=()=>{n=Vx(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Lae(t,...r){const n=typeof t=="function"?{memoize:t,memoizeOptions:r}:t,i=(...a)=>{let s=0,o=0,l,u={},d=a.pop();typeof d=="object"&&(u=d,d=a.pop()),Tae(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const f={...n,...u},{memoize:p,memoizeOptions:x=[],argsMemoize:v=NB,argsMemoizeOptions:w=[]}=f,C=iI(x),A=iI(w),T=kae(a),O=p(function(){return s++,d.apply(null,arguments)},...C),D=v(function(){o++;const Q=Dae(T,arguments);return l=O.apply(null,Q),l},...A);return Object.assign(D,{resultFunc:d,memoizedResultFunc:O,dependencies:T,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:p,argsMemoize:v})};return Object.assign(i,{withTypes:()=>i}),i}var ut=Lae(NB),zae=Object.assign((t,r=ut)=>{Iae(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),i=n.map(s=>t[s]);return r(i,(...s)=>s.reduce((o,l,u)=>(o[n[u]]=l,o),{}))},{withTypes:()=>zae}),Tw={},Iw={},Ow={},sI;function Bae(){return sI||(sI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(i){return typeof i=="symbol"?1:i===null?2:i===void 0?3:i!==i?4:0}const n=(i,a,s)=>{if(i!==a){const o=r(i),l=r(a);if(o===l&&o===0){if(i<a)return s==="desc"?1:-1;if(i>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=n})(Ow)),Ow}var kw={},Dw={},oI;function AB(){return oI||(oI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="symbol"||n instanceof Symbol}t.isSymbol=r})(Dw)),Dw}var lI;function Fae(){return lI||(lI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=AB(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||r.isSymbol(s)?!0:typeof s=="string"&&(i.test(s)||!n.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})(kw)),kw}var cI;function qae(){return cI||(cI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=Bae(),n=Fae(),i=eE();function a(s,o,l,u){if(s==null)return[];l=u?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(v=>String(v));const d=(v,w)=>{let C=v;for(let A=0;A<w.length&&C!=null;++A)C=C[w[A]];return C},f=(v,w)=>w==null||v==null?w:typeof v=="object"&&"key"in v?Object.hasOwn(w,v.key)?w[v.key]:d(w,v.path):typeof v=="function"?v(w):Array.isArray(v)?d(w,v):typeof w=="object"?w[v]:w,p=o.map(v=>(Array.isArray(v)&&v.length===1&&(v=v[0]),v==null||typeof v=="function"||Array.isArray(v)||n.isKey(v)?v:{key:v,path:i.toPath(v)}));return s.map(v=>({original:v,criteria:p.map(w=>f(w,v))})).slice().sort((v,w)=>{for(let C=0;C<p.length;C++){const A=r.compareValues(v.criteria[C],w.criteria[C],l[C]);if(A!==0)return A}return 0}).map(v=>v.original)}t.orderBy=a})(Iw)),Iw}var Pw={},dI;function Uae(){return dI||(dI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n,i=1){const a=[],s=Math.floor(i),o=(l,u)=>{for(let d=0;d<l.length;d++){const f=l[d];Array.isArray(f)&&u<s?o(f,u+1):a.push(f)}};return o(n,0),a}t.flatten=r})(Pw)),Pw}var Rw={},uI;function EB(){return uI||(uI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=SB(),n=iE(),i=yB(),a=vB();function s(o,l,u){return i.isObject(u)&&(typeof l=="number"&&n.isArrayLike(u)&&r.isIndex(l)&&l<u.length||typeof l=="string"&&l in u)?a.isEqualsSameValueZero(u[l],o):!1}t.isIterateeCall=s})(Rw)),Rw}var hI;function Wae(){return hI||(hI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=qae(),n=Uae(),i=EB();function a(s,...o){const l=o.length;return l>1&&i.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&i.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),r.orderBy(s,n.flatten(o),["asc"])}t.sortBy=a})(Tw)),Tw}var Mw,fI;function Hae(){return fI||(fI=1,Mw=Wae().sortBy),Mw}var Vae=Hae();const l2=hc(Vae);var _B=t=>t.legend.settings,$ae=t=>t.legend.size,Gae=t=>t.legend.payload,Kae=ut([Gae,_B],(t,r)=>{var{itemSorter:n}=r,i=t.flat(1);return n?l2(i,n):i});function Qae(){return wr(Kae)}var $x=1;function TB(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[r,n]=k.useState({height:0,left:0,top:0,width:0}),i=k.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-r.height)>$x||Math.abs(o.left-r.left)>$x||Math.abs(o.top-r.top)>$x||Math.abs(o.width-r.width)>$x)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[r.width,r.height,r.top,r.left,...t]);return[r,i]}function cl(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Yae=typeof Symbol=="function"&&Symbol.observable||"@@observable",mI=Yae,Lw=()=>Math.random().toString(36).substring(7).split("").join("."),Zae={INIT:`@@redux/INIT${Lw()}`,REPLACE:`@@redux/REPLACE${Lw()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Lw()}`},Kv=Zae;function oE(t){if(typeof t!="object"||t===null)return!1;let r=t;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(t)===r||Object.getPrototypeOf(t)===null}function IB(t,r,n){if(typeof t!="function")throw new Error(cl(2));if(typeof r=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(cl(0));if(typeof r=="function"&&typeof n>"u"&&(n=r,r=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(cl(1));return n(IB)(t,r)}let i=t,a=r,s=new Map,o=s,l=0,u=!1;function d(){o===s&&(o=new Map,s.forEach((A,T)=>{o.set(T,A)}))}function f(){if(u)throw new Error(cl(3));return a}function p(A){if(typeof A!="function")throw new Error(cl(4));if(u)throw new Error(cl(5));let T=!0;d();const O=l++;return o.set(O,A),function(){if(T){if(u)throw new Error(cl(6));T=!1,d(),o.delete(O),s=null}}}function x(A){if(!oE(A))throw new Error(cl(7));if(typeof A.type>"u")throw new Error(cl(8));if(typeof A.type!="string")throw new Error(cl(17));if(u)throw new Error(cl(9));try{u=!0,a=i(a,A)}finally{u=!1}return(s=o).forEach(O=>{O()}),A}function v(A){if(typeof A!="function")throw new Error(cl(10));i=A,x({type:Kv.REPLACE})}function w(){const A=p;return{subscribe(T){if(typeof T!="object"||T===null)throw new Error(cl(11));function O(){const M=T;M.next&&M.next(f())}return O(),{unsubscribe:A(O)}},[mI](){return this}}}return x({type:Kv.INIT}),{dispatch:x,subscribe:p,getState:f,replaceReducer:v,[mI]:w}}function Xae(t){Object.keys(t).forEach(r=>{const n=t[r];if(typeof n(void 0,{type:Kv.INIT})>"u")throw new Error(cl(12));if(typeof n(void 0,{type:Kv.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(cl(13))})}function OB(t){const r=Object.keys(t),n={};for(let s=0;s<r.length;s++){const o=r[s];typeof t[o]=="function"&&(n[o]=t[o])}const i=Object.keys(n);let a;try{Xae(n)}catch(s){a=s}return function(o={},l){if(a)throw a;let u=!1;const d={};for(let f=0;f<i.length;f++){const p=i[f],x=n[p],v=o[p],w=x(v,l);if(typeof w>"u")throw l&&l.type,new Error(cl(14));d[p]=w,u=u||w!==v}return u=u||i.length!==Object.keys(o).length,u?d:o}}function Qv(...t){return t.length===0?r=>r:t.length===1?t[0]:t.reduce((r,n)=>(...i)=>r(n(...i)))}function Jae(...t){return r=>(n,i)=>{const a=r(n,i);let s=()=>{throw new Error(cl(15))};const o={getState:a.getState,dispatch:(u,...d)=>s(u,...d)},l=t.map(u=>u(o));return s=Qv(...l)(a.dispatch),{...a,dispatch:s}}}function kB(t){return oE(t)&&"type"in t&&typeof t.type=="string"}var DB=Symbol.for("immer-nothing"),pI=Symbol.for("immer-draftable"),Vl=Symbol.for("immer-state");function wd(t,...r){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Pc=Object,Bp=Pc.getPrototypeOf,Yv="constructor",c2="prototype",sN="configurable",Zv="enumerable",yv="writable",Hg="value",lh=t=>!!t&&!!t[Vl];function Ed(t){return t?PB(t)||u2(t)||!!t[pI]||!!t[Yv]?.[pI]||h2(t)||f2(t):!1}var ese=Pc[c2][Yv].toString(),gI=new WeakMap;function PB(t){if(!t||!lE(t))return!1;const r=Bp(t);if(r===null||r===Pc[c2])return!0;const n=Pc.hasOwnProperty.call(r,Yv)&&r[Yv];if(n===Object)return!0;if(!gp(n))return!1;let i=gI.get(n);return i===void 0&&(i=Function.toString.call(n),gI.set(n,i)),i===ese}function d2(t,r,n=!0){jy(t)===0?(n?Reflect.ownKeys(t):Pc.keys(t)).forEach(a=>{r(a,t[a],t)}):t.forEach((i,a)=>r(a,i,t))}function jy(t){const r=t[Vl];return r?r.type_:u2(t)?1:h2(t)?2:f2(t)?3:0}var yI=(t,r,n=jy(t))=>n===2?t.has(r):Pc[c2].hasOwnProperty.call(t,r),oN=(t,r,n=jy(t))=>n===2?t.get(r):t[r],Xv=(t,r,n,i=jy(t))=>{i===2?t.set(r,n):i===3?t.add(n):t[r]=n};function tse(t,r){return t===r?t!==0||1/t===1/r:t!==t&&r!==r}var u2=Array.isArray,h2=t=>t instanceof Map,f2=t=>t instanceof Set,lE=t=>typeof t=="object",gp=t=>typeof t=="function",zw=t=>typeof t=="boolean";function rse(t){const r=+t;return Number.isInteger(r)&&String(r)===t}var Wu=t=>t.copy_||t.base_,cE=t=>t.modified_?t.copy_:t.base_;function lN(t,r){if(h2(t))return new Map(t);if(f2(t))return new Set(t);if(u2(t))return Array[c2].slice.call(t);const n=PB(t);if(r===!0||r==="class_only"&&!n){const i=Pc.getOwnPropertyDescriptors(t);delete i[Vl];let a=Reflect.ownKeys(i);for(let s=0;s<a.length;s++){const o=a[s],l=i[o];l[yv]===!1&&(l[yv]=!0,l[sN]=!0),(l.get||l.set)&&(i[o]={[sN]:!0,[yv]:!0,[Zv]:l[Zv],[Hg]:t[o]})}return Pc.create(Bp(t),i)}else{const i=Bp(t);if(i!==null&&n)return{...t};const a=Pc.create(i);return Pc.assign(a,t)}}function dE(t,r=!1){return m2(t)||lh(t)||!Ed(t)||(jy(t)>1&&Pc.defineProperties(t,{set:Gx,add:Gx,clear:Gx,delete:Gx}),Pc.freeze(t),r&&d2(t,(n,i)=>{dE(i,!0)},!1)),t}function nse(){wd(2)}var Gx={[Hg]:nse};function m2(t){return t===null||!lE(t)?!0:Pc.isFrozen(t)}var Jv="MapSet",cN="Patches",xI="ArrayMethods",RB={};function fm(t){const r=RB[t];return r||wd(0,t),r}var vI=t=>!!RB[t],Vg,MB=()=>Vg,ise=(t,r)=>({drafts_:[],parent_:t,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:vI(Jv)?fm(Jv):void 0,arrayMethodsPlugin_:vI(xI)?fm(xI):void 0});function bI(t,r){r&&(t.patchPlugin_=fm(cN),t.patches_=[],t.inversePatches_=[],t.patchListener_=r)}function dN(t){uN(t),t.drafts_.forEach(ase),t.drafts_=null}function uN(t){t===Vg&&(Vg=t.parent_)}var jI=t=>Vg=ise(Vg,t);function ase(t){const r=t[Vl];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function wI(t,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];if(t!==void 0&&t!==n){n[Vl].modified_&&(dN(r),wd(4)),Ed(t)&&(t=SI(r,t));const{patchPlugin_:a}=r;a&&a.generateReplacementPatches_(n[Vl].base_,t,r)}else t=SI(r,n);return sse(r,t,!0),dN(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),t!==DB?t:void 0}function SI(t,r){if(m2(r))return r;const n=r[Vl];if(!n)return eb(r,t.handledSet_,t);if(!p2(n,t))return r;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:i}=n;if(i)for(;i.length>0;)i.pop()(t);BB(n,t)}return n.copy_}function sse(t,r,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&dE(r,n)}function LB(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var p2=(t,r)=>t.scope_===r,ose=[];function zB(t,r,n,i){const a=Wu(t),s=t.type_;if(i!==void 0&&oN(a,i,s)===r){Xv(a,i,n,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;d2(a,(u,d)=>{if(lh(d)){const f=l.get(d)||[];f.push(u),l.set(d,f)}})}const o=t.draftLocations_.get(r)??ose;for(const l of o)Xv(a,l,n,s)}function lse(t,r,n){t.callbacks_.push(function(a){const s=r;if(!s||!p2(s,a))return;a.mapSetPlugin_?.fixSetContents(s);const o=cE(s);zB(t,s.draft_??s,o,n),BB(s,a)})}function BB(t,r){if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(t.assigned_?.size??0)>0)){const{patchPlugin_:i}=r;if(i){const a=i.getPath(t);a&&i.generatePatches_(t,a,r)}LB(t)}}function cse(t,r,n){const{scope_:i}=t;if(lh(n)){const a=n[Vl];p2(a,i)&&a.callbacks_.push(function(){xv(t);const o=cE(a);zB(t,n,o,r)})}else Ed(n)&&t.callbacks_.push(function(){const s=Wu(t);t.type_===3?s.has(n)&&eb(n,i.handledSet_,i):oN(s,r,t.type_)===n&&i.drafts_.length>1&&(t.assigned_.get(r)??!1)===!0&&t.copy_&&eb(oN(t.copy_,r,t.type_),i.handledSet_,i)})}function eb(t,r,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||lh(t)||r.has(t)||!Ed(t)||m2(t)||(r.add(t),d2(t,(i,a)=>{if(lh(a)){const s=a[Vl];if(p2(s,n)){const o=cE(s);Xv(t,i,o,t.type_),LB(s)}}else Ed(a)&&eb(a,r,n)})),t}function dse(t,r){const n=u2(t),i={type_:n?1:0,scope_:r?r.scope_:MB(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:r,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=i,s=tb;n&&(a=[i],s=$g);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return i.draft_=l,i.revoke_=o,[l,i]}var tb={get(t,r){if(r===Vl)return t;let n=t.scope_.arrayMethodsPlugin_;const i=t.type_===1&&typeof r=="string";if(i&&n?.isArrayOperationMethod(r))return n.createMethodInterceptor(t,r);const a=Wu(t);if(!yI(a,r,t.type_))return use(t,a,r);const s=a[r];if(t.finalized_||!Ed(s)||i&&t.operationMethod&&n?.isMutatingArrayMethod(t.operationMethod)&&rse(r))return s;if(s===Bw(t.base_,r)){xv(t);const o=t.type_===1?+r:r,l=fN(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,r){return r in Wu(t)},ownKeys(t){return Reflect.ownKeys(Wu(t))},set(t,r,n){const i=FB(Wu(t),r);if(i?.set)return i.set.call(t.draft_,n),!0;if(!t.modified_){const a=Bw(Wu(t),r),s=a?.[Vl];if(s&&s.base_===n)return t.copy_[r]=n,t.assigned_.set(r,!1),!0;if(tse(n,a)&&(n!==void 0||yI(t.base_,r,t.type_)))return!0;xv(t),hN(t)}return t.copy_[r]===n&&(n!==void 0||r in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[r])||(t.copy_[r]=n,t.assigned_.set(r,!0),cse(t,r,n)),!0},deleteProperty(t,r){return xv(t),Bw(t.base_,r)!==void 0||r in t.base_?(t.assigned_.set(r,!1),hN(t)):t.assigned_.delete(r),t.copy_&&delete t.copy_[r],!0},getOwnPropertyDescriptor(t,r){const n=Wu(t),i=Reflect.getOwnPropertyDescriptor(n,r);return i&&{[yv]:!0,[sN]:t.type_!==1||r!=="length",[Zv]:i[Zv],[Hg]:n[r]}},defineProperty(){wd(11)},getPrototypeOf(t){return Bp(t.base_)},setPrototypeOf(){wd(12)}},$g={};for(let t in tb){let r=tb[t];$g[t]=function(){const n=arguments;return n[0]=n[0][0],r.apply(this,n)}}$g.deleteProperty=function(t,r){return $g.set.call(this,t,r,void 0)};$g.set=function(t,r,n){return tb.set.call(this,t[0],r,n,t[0])};function Bw(t,r){const n=t[Vl];return(n?Wu(n):t)[r]}function use(t,r,n){const i=FB(r,n);return i?Hg in i?i[Hg]:i.get?.call(t.draft_):void 0}function FB(t,r){if(!(r in t))return;let n=Bp(t);for(;n;){const i=Object.getOwnPropertyDescriptor(n,r);if(i)return i;n=Bp(n)}}function hN(t){t.modified_||(t.modified_=!0,t.parent_&&hN(t.parent_))}function xv(t){t.copy_||(t.assigned_=new Map,t.copy_=lN(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var hse=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,i,a)=>{if(gp(n)&&!gp(i)){const o=i;i=n;const l=this;return function(d=o,...f){return l.produce(d,p=>i.call(this,p,...f))}}gp(i)||wd(6),a!==void 0&&!gp(a)&&wd(7);let s;if(Ed(n)){const o=jI(this),l=fN(o,n,void 0);let u=!0;try{s=i(l),u=!1}finally{u?dN(o):uN(o)}return bI(o,a),wI(s,o)}else if(!n||!lE(n)){if(s=i(n),s===void 0&&(s=n),s===DB&&(s=void 0),this.autoFreeze_&&dE(s,!0),a){const o=[],l=[];fm(cN).generateReplacementPatches_(n,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else wd(1,n)},this.produceWithPatches=(n,i)=>{if(gp(n))return(l,...u)=>this.produceWithPatches(l,d=>n(d,...u));let a,s;return[this.produce(n,i,(l,u)=>{a=l,s=u}),a,s]},zw(r?.autoFreeze)&&this.setAutoFreeze(r.autoFreeze),zw(r?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(r.useStrictShallowCopy),zw(r?.useStrictIteration)&&this.setUseStrictIteration(r.useStrictIteration)}createDraft(r){Ed(r)||wd(8),lh(r)&&(r=Nd(r));const n=jI(this),i=fN(n,r,void 0);return i[Vl].isManual_=!0,uN(n),i}finishDraft(r,n){const i=r&&r[Vl];(!i||!i.isManual_)&&wd(9);const{scope_:a}=i;return bI(a,n),wI(void 0,a)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}setUseStrictIteration(r){this.useStrictIteration_=r}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(r,n){let i;for(i=n.length-1;i>=0;i--){const s=n[i];if(s.path.length===0&&s.op==="replace"){r=s.value;break}}i>-1&&(n=n.slice(i+1));const a=fm(cN).applyPatches_;return lh(r)?a(r,n):this.produce(r,s=>a(s,n))}};function fN(t,r,n,i){const[a,s]=h2(r)?fm(Jv).proxyMap_(r,n):f2(r)?fm(Jv).proxySet_(r,n):dse(r,n);return(n?.scope_??MB()).drafts_.push(a),s.callbacks_=n?.callbacks_??[],s.key_=i,n&&i!==void 0?lse(n,s,i):s.callbacks_.push(function(u){u.mapSetPlugin_?.fixSetContents(s);const{patchPlugin_:d}=u;s.modified_&&d&&d.generatePatches_(s,[],u)}),a}function Nd(t){return lh(t)||wd(10,t),qB(t)}function qB(t){if(!Ed(t)||m2(t))return t;const r=t[Vl];let n,i=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=lN(t,r.scope_.immer_.useStrictShallowCopy_),i=r.scope_.immer_.shouldUseStrictIteration()}else n=lN(t,!0);return d2(n,(a,s)=>{Xv(n,a,qB(s))},i),r&&(r.finalized_=!1),n}var fse=new hse,UB=fse.produce;function WB(t){return({dispatch:n,getState:i})=>a=>s=>typeof s=="function"?s(n,i,t):a(s)}var mse=WB(),pse=WB,gse=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Qv:Qv.apply(null,arguments)};function ad(t,r){function n(...i){if(r){let a=r(...i);if(!a)throw new Error(Lc(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:i[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=i=>kB(i)&&i.type===t,n}var HB=class jg extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,jg.prototype)}static get[Symbol.species](){return jg}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new jg(...r[0].concat(this)):new jg(...r.concat(this))}};function CI(t){return Ed(t)?UB(t,()=>{}):t}function Kx(t,r,n){return t.has(r)?t.get(r):t.set(r,n(r)).get(r)}function yse(t){return typeof t=="boolean"}var xse=()=>function(r){const{thunk:n=!0,immutableCheck:i=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=r??{};let o=new HB;return n&&(yse(n)?o.push(mse):o.push(pse(n.extraArgument))),o},VB="RTK_autoBatch",Ua=()=>t=>({payload:t,meta:{[VB]:!0}}),NI=t=>r=>{setTimeout(r,t)},$B=(t={type:"raf"})=>r=>(...n)=>{const i=r(...n);let a=!0,s=!1,o=!1;const l=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:NI(10):t.type==="callback"?t.queueNotification:NI(t.timeout),d=()=>{o=!1,s&&(s=!1,l.forEach(f=>f()))};return Object.assign({},i,{subscribe(f){const p=()=>a&&f(),x=i.subscribe(p);return l.add(f),()=>{x(),l.delete(f)}},dispatch(f){try{return a=!f?.meta?.[VB],s=!a,s&&(o||(o=!0,u(d))),i.dispatch(f)}finally{a=!0}}})},vse=t=>function(n){const{autoBatch:i=!0}=n??{};let a=new HB(t);return i&&a.push($B(typeof i=="object"?i:void 0)),a};function bse(t){const r=xse(),{reducer:n=void 0,middleware:i,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(oE(n))l=OB(n);else throw new Error(Lc(1));let u;typeof i=="function"?u=i(r):u=r();let d=Qv;a&&(d=gse({trace:!1,...typeof a=="object"&&a}));const f=Jae(...u),p=vse(f);let x=typeof o=="function"?o(p):p();const v=d(...x);return IB(l,s,v)}function GB(t){const r={},n=[];let i;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Lc(28));if(l in r)throw new Error(Lc(29));return r[l]=o,a},addAsyncThunk(s,o){return o.pending&&(r[s.pending.type]=o.pending),o.rejected&&(r[s.rejected.type]=o.rejected),o.fulfilled&&(r[s.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return n.push({matcher:s,reducer:o}),a},addDefaultCase(s){return i=s,a}};return t(a),[r,n,i]}function jse(t){return typeof t=="function"}function wse(t,r){let[n,i,a]=GB(r),s;if(jse(t))s=()=>CI(t());else{const l=CI(t);s=()=>l}function o(l=s(),u){let d=[n[u.type],...i.filter(({matcher:f})=>f(u)).map(({reducer:f})=>f)];return d.filter(f=>!!f).length===0&&(d=[a]),d.reduce((f,p)=>{if(p)if(lh(f)){const v=p(f,u);return v===void 0?f:v}else{if(Ed(f))return UB(f,x=>p(x,u));{const x=p(f,u);if(x===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return f},l)}return o.getInitialState=s,o}var Sse="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Cse=(t=21)=>{let r="",n=t;for(;n--;)r+=Sse[Math.random()*64|0];return r},Nse=Symbol.for("rtk-slice-createasyncthunk");function Ase(t,r){return`${t}/${r}`}function Ese({creators:t}={}){const r=t?.asyncThunk?.[Nse];return function(i){const{name:a,reducerPath:s=a}=i;if(!a)throw new Error(Lc(11));const o=(typeof i.reducers=="function"?i.reducers(Tse()):i.reducers)||{},l=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(D,M){const Q=typeof D=="string"?D:D.type;if(!Q)throw new Error(Lc(12));if(Q in u.sliceCaseReducersByType)throw new Error(Lc(13));return u.sliceCaseReducersByType[Q]=M,d},addMatcher(D,M){return u.sliceMatchers.push({matcher:D,reducer:M}),d},exposeAction(D,M){return u.actionCreators[D]=M,d},exposeCaseReducer(D,M){return u.sliceCaseReducersByName[D]=M,d}};l.forEach(D=>{const M=o[D],Q={reducerName:D,type:Ase(a,D),createNotation:typeof i.reducers=="function"};Ose(M)?Dse(Q,M,d,r):Ise(Q,M,d)});function f(){const[D={},M=[],Q=void 0]=typeof i.extraReducers=="function"?GB(i.extraReducers):[i.extraReducers],U={...D,...u.sliceCaseReducersByType};return wse(i.initialState,$=>{for(let ee in U)$.addCase(ee,U[ee]);for(let ee of u.sliceMatchers)$.addMatcher(ee.matcher,ee.reducer);for(let ee of M)$.addMatcher(ee.matcher,ee.reducer);Q&&$.addDefaultCase(Q)})}const p=D=>D,x=new Map,v=new WeakMap;let w;function C(D,M){return w||(w=f()),w(D,M)}function A(){return w||(w=f()),w.getInitialState()}function T(D,M=!1){function Q($){let ee=$[D];return typeof ee>"u"&&M&&(ee=Kx(v,Q,A)),ee}function U($=p){const ee=Kx(x,M,()=>new WeakMap);return Kx(ee,$,()=>{const F={};for(const[Y,J]of Object.entries(i.selectors??{}))F[Y]=_se(J,$,()=>Kx(v,$,A),M);return F})}return{reducerPath:D,getSelectors:U,get selectors(){return U(Q)},selectSlice:Q}}const O={name:a,reducer:C,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:A,...T(s),injectInto(D,{reducerPath:M,...Q}={}){const U=M??s;return D.inject({reducerPath:U,reducer:C},Q),{...O,...T(U,!0)}}};return O}}function _se(t,r,n,i){function a(s,...o){let l=r(s);return typeof l>"u"&&i&&(l=n()),t(l,...o)}return a.unwrapped=t,a}var fc=Ese();function Tse(){function t(r,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...n}}return t.withTypes=()=>t,{reducer(r){return Object.assign({[r.name](...n){return r(...n)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:n}},asyncThunk:t}}function Ise({type:t,reducerName:r,createNotation:n},i,a){let s,o;if("reducer"in i){if(n&&!kse(i))throw new Error(Lc(17));s=i.reducer,o=i.prepare}else s=i;a.addCase(t,s).exposeCaseReducer(r,s).exposeAction(r,o?ad(t,o):ad(t))}function Ose(t){return t._reducerDefinitionType==="asyncThunk"}function kse(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Dse({type:t,reducerName:r},n,i,a){if(!a)throw new Error(Lc(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:u,settled:d,options:f}=n,p=a(t,s,f);i.exposeAction(r,p),o&&i.addCase(p.fulfilled,o),l&&i.addCase(p.pending,l),u&&i.addCase(p.rejected,u),d&&i.addMatcher(p.settled,d),i.exposeCaseReducer(r,{fulfilled:o||Qx,pending:l||Qx,rejected:u||Qx,settled:d||Qx})}function Qx(){}var Pse="task",KB="listener",QB="completed",uE="cancelled",Rse=`task-${uE}`,Mse=`task-${QB}`,mN=`${KB}-${uE}`,Lse=`${KB}-${QB}`,g2=class{constructor(t){this.code=t,this.message=`${Pse} ${uE} (reason: ${t})`}name="TaskAbortError";message},hE=(t,r)=>{if(typeof t!="function")throw new TypeError(Lc(32))},rb=()=>{},YB=(t,r=rb)=>(t.catch(r),t),ZB=(t,r)=>(t.addEventListener("abort",r,{once:!0}),()=>t.removeEventListener("abort",r)),Zf=t=>{if(t.aborted)throw new g2(t.reason)};function XB(t,r){let n=rb;return new Promise((i,a)=>{const s=()=>a(new g2(t.reason));if(t.aborted){s();return}n=ZB(t,s),r.finally(()=>n()).then(i,a)}).finally(()=>{n=rb})}var zse=async(t,r)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(n){return{status:n instanceof g2?"cancelled":"rejected",error:n}}finally{r?.()}},nb=t=>r=>YB(XB(t,r).then(n=>(Zf(t),n))),JB=t=>{const r=nb(t);return n=>r(new Promise(i=>setTimeout(i,n)))},{assign:Ap}=Object,AI={},y2="listenerMiddleware",Bse=(t,r)=>{const n=i=>ZB(t,()=>i.abort(t.reason));return(i,a)=>{hE(i);const s=new AbortController;n(s);const o=zse(async()=>{Zf(t),Zf(s.signal);const l=await i({pause:nb(s.signal),delay:JB(s.signal),signal:s.signal});return Zf(s.signal),l},()=>s.abort(Mse));return a?.autoJoin&&r.push(o.catch(rb)),{result:nb(t)(o),cancel(){s.abort(Rse)}}}},Fse=(t,r)=>{const n=async(i,a)=>{Zf(r);let s=()=>{};const l=[new Promise((u,d)=>{let f=t({predicate:i,effect:(p,x)=>{x.unsubscribe(),u([p,x.getState(),x.getOriginalState()])}});s=()=>{f(),d()}})];a!=null&&l.push(new Promise(u=>setTimeout(u,a,null)));try{const u=await XB(r,Promise.race(l));return Zf(r),u}finally{s()}};return(i,a)=>YB(n(i,a))},e9=t=>{let{type:r,actionCreator:n,matcher:i,predicate:a,effect:s}=t;if(r)a=ad(r).match;else if(n)r=n.type,a=n.match;else if(i)a=i;else if(!a)throw new Error(Lc(21));return hE(s),{predicate:a,type:r,effect:s}},t9=Ap(t=>{const{type:r,predicate:n,effect:i}=e9(t);return{id:Cse(),effect:i,type:r,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Lc(22))}}},{withTypes:()=>t9}),EI=(t,r)=>{const{type:n,effect:i,predicate:a}=e9(r);return Array.from(t.values()).find(s=>(typeof n=="string"?s.type===n:s.predicate===a)&&s.effect===i)},pN=t=>{t.pending.forEach(r=>{r.abort(mN)})},qse=(t,r)=>()=>{for(const n of r.keys())pN(n);t.clear()},_I=(t,r,n)=>{try{t(r,n)}catch(i){setTimeout(()=>{throw i},0)}},r9=Ap(ad(`${y2}/add`),{withTypes:()=>r9}),Use=ad(`${y2}/removeAll`),n9=Ap(ad(`${y2}/remove`),{withTypes:()=>n9}),Wse=(...t)=>{console.error(`${y2}/error`,...t)},wy=(t={})=>{const r=new Map,n=new Map,i=v=>{const w=n.get(v)??0;n.set(v,w+1)},a=v=>{const w=n.get(v)??1;w===1?n.delete(v):n.set(v,w-1)},{extra:s,onError:o=Wse}=t;hE(o);const l=v=>(v.unsubscribe=()=>r.delete(v.id),r.set(v.id,v),w=>{v.unsubscribe(),w?.cancelActive&&pN(v)}),u=v=>{const w=EI(r,v)??t9(v);return l(w)};Ap(u,{withTypes:()=>u});const d=v=>{const w=EI(r,v);return w&&(w.unsubscribe(),v.cancelActive&&pN(w)),!!w};Ap(d,{withTypes:()=>d});const f=async(v,w,C,A)=>{const T=new AbortController,O=Fse(u,T.signal),D=[];try{v.pending.add(T),i(v),await Promise.resolve(v.effect(w,Ap({},C,{getOriginalState:A,condition:(M,Q)=>O(M,Q).then(Boolean),take:O,delay:JB(T.signal),pause:nb(T.signal),extra:s,signal:T.signal,fork:Bse(T.signal,D),unsubscribe:v.unsubscribe,subscribe:()=>{r.set(v.id,v)},cancelActiveListeners:()=>{v.pending.forEach((M,Q,U)=>{M!==T&&(M.abort(mN),U.delete(M))})},cancel:()=>{T.abort(mN),v.pending.delete(T)},throwIfCancelled:()=>{Zf(T.signal)}})))}catch(M){M instanceof g2||_I(o,M,{raisedBy:"effect"})}finally{await Promise.all(D),T.abort(Lse),a(v),v.pending.delete(T)}},p=qse(r,n);return{middleware:v=>w=>C=>{if(!kB(C))return w(C);if(r9.match(C))return u(C.payload);if(Use.match(C)){p();return}if(n9.match(C))return d(C.payload);let A=v.getState();const T=()=>{if(A===AI)throw new Error(Lc(23));return A};let O;try{if(O=w(C),r.size>0){const D=v.getState(),M=Array.from(r.values());for(const Q of M){let U=!1;try{U=Q.predicate(C,D,A)}catch($){U=!1,_I(o,$,{raisedBy:"predicate"})}U&&f(Q,C,v,T)}}}finally{A=AI}return O},startListening:u,stopListening:d,clearListeners:p}};function Lc(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Hse={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},i9=fc({name:"chartLayout",initialState:Hse,reducers:{setLayout(t,r){t.layoutType=r.payload},setChartSize(t,r){t.width=r.payload.width,t.height=r.payload.height},setMargin(t,r){var n,i,a,s;t.margin.top=(n=r.payload.top)!==null&&n!==void 0?n:0,t.margin.right=(i=r.payload.right)!==null&&i!==void 0?i:0,t.margin.bottom=(a=r.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=r.payload.left)!==null&&s!==void 0?s:0},setScale(t,r){t.scale=r.payload}}}),{setMargin:Vse,setLayout:$se,setChartSize:Gse,setScale:Kse}=i9.actions,Qse=i9.reducer;function a9(t,r,n){return Array.isArray(t)&&t&&r+n!==0?t.slice(r,n+1):t}function oa(t){return Number.isFinite(t)}function hu(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function TI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function bp(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?TI(Object(n),!0).forEach(function(i){Yse(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Yse(t,r,n){return(r=Zse(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Zse(t){var r=Xse(t,"string");return typeof r=="symbol"?r:r+""}function Xse(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Ii(t,r,n){return Ta(t)||Ta(r)?n:uu(r)?hm(t,r,n):typeof r=="function"?r(t):n}var Jse=(t,r,n)=>{if(r&&n){var{width:i,height:a}=n,{align:s,verticalAlign:o,layout:l}=r;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&or(t[s]))return bp(bp({},t),{},{[s]:t[s]+(i||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&or(t[o]))return bp(bp({},t),{},{[o]:t[o]+(a||0)})}return t},yu=(t,r)=>t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis",s9=(t,r,n,i)=>{if(i)return t.map(l=>l.coordinate);var a,s,o=t.map(l=>(l.coordinate===r&&(a=!0),l.coordinate===n&&(s=!0),l.coordinate));return a||o.push(r),s||o.push(n),o},o9=(t,r,n)=>{if(!t)return null;var{duplicateDomain:i,type:a,range:s,scale:o,realScaleType:l,isCategorical:u,categoricalDomain:d,tickCount:f,ticks:p,niceTicks:x,axisType:v}=t;if(!o)return null;var w=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,C=a==="category"&&o.bandwidth?o.bandwidth()/w:0;if(C=v==="angleAxis"&&s&&s.length>=2?Bo(s[0]-s[1])*2*C:C,p||x){var A=(p||x||[]).map((T,O)=>{var D=i?i.indexOf(T):T;return{coordinate:o(D)+C,value:T,offset:C,index:O}});return A.filter(T=>!id(T.coordinate))}return u&&d?d.map((T,O)=>({coordinate:o(T)+C,value:T,index:O,offset:C})):o.ticks&&f!=null?o.ticks(f).map((T,O)=>({coordinate:o(T)+C,value:T,offset:C,index:O})):o.domain().map((T,O)=>({coordinate:o(T)+C,value:i?i[T]:T,index:O,offset:C}))},II=1e-4,eoe=t=>{var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),a=Math.min(i[0],i[1])-II,s=Math.max(i[0],i[1])+II,o=t(r[0]),l=t(r[n-1]);(o<a||o>s||l<a||l>s)&&t.domain([r[0],r[n-1]])}},toe=(t,r)=>{if(!r||r.length!==2||!or(r[0])||!or(r[1]))return t;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),a=[t[0],t[1]];return(!or(t[0])||t[0]<n)&&(a[0]=n),(!or(t[1])||t[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<n&&(a[1]=n),a},roe=t=>{var r,n=t.length;if(!(n<=0)){var i=(r=t[0])===null||r===void 0?void 0:r.length;if(!(i==null||i<=0))for(var a=0;a<i;++a)for(var s=0,o=0,l=0;l<n;++l){var u=t[l],d=u?.[a];if(d!=null){var f=d[1],p=d[0],x=id(f)?p:f;x>=0?(d[0]=s,d[1]=s+x,s=f):(d[0]=o,d[1]=o+x,o=f)}}}},noe=t=>{var r,n=t.length;if(!(n<=0)){var i=(r=t[0])===null||r===void 0?void 0:r.length;if(!(i==null||i<=0))for(var a=0;a<i;++a)for(var s=0,o=0;o<n;++o){var l=t[o],u=l?.[a];if(u!=null){var d=id(u[1])?u[0]:u[1];d>=0?(u[0]=s,u[1]=s+d,s=u[1]):(u[0]=0,u[1]=0)}}}},ioe={sign:roe,expand:Cie,none:um,silhouette:Nie,wiggle:Aie,positive:noe},aoe=(t,r,n)=>{var i,a=(i=ioe[n])!==null&&i!==void 0?i:um,s=Sie().keys(r).value((l,u)=>Number(Ii(l,u,0))).order(iN).offset(a),o=s(t);return o.forEach((l,u)=>{l.forEach((d,f)=>{var p=Ii(t[f],r[u],0);Array.isArray(p)&&p.length===2&&or(p[0])&&or(p[1])&&(d[0]=p[0],d[1]=p[1])})}),o};function l9(t){return t==null?void 0:String(t)}function ib(t){var{axis:r,ticks:n,bandSize:i,entry:a,index:s,dataKey:o}=t;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!Ta(a[r.dataKey])){var l=fB(n,"value",a[r.dataKey]);if(l)return l.coordinate+i/2}return n[s]?n[s].coordinate+i/2:null}var u=Ii(a,Ta(o)?r.dataKey:o);return Ta(u)?null:r.scale(u)}var OI=t=>{var{axis:r,ticks:n,offset:i,bandSize:a,entry:s,index:o}=t;if(r.type==="category")return n[o]?n[o].coordinate+i:null;var l=Ii(s,r.dataKey,r.scale.domain()[o]);return Ta(l)?null:r.scale(l)-a/2+i},soe=t=>{var{numericAxis:r}=t,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return i<=0&&a>=0?0:a<0?a:i}return n[0]},ooe=t=>{var r=t.flat(2).filter(or);return[Math.min(...r),Math.max(...r)]},loe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],coe=(t,r,n)=>{if(t!=null)return loe(Object.keys(t).reduce((i,a)=>{var s=t[a];if(!s)return i;var{stackedData:o}=s,l=o.reduce((u,d)=>{var f=a9(d,r,n),p=ooe(f);return!oa(p[0])||!oa(p[1])?u:[Math.min(u[0],p[0]),Math.max(u[1],p[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]))},kI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,df=(t,r,n)=>{if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var a=l2(r,f=>f.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var u=a[o],d=a[o-1];s=Math.min((u?.coordinate||0)-(d?.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0};function PI(t){var{tooltipEntrySettings:r,dataKey:n,payload:i,value:a,name:s}=t;return bp(bp({},r),{},{dataKey:n,payload:i,value:a,name:s})}function pf(t,r){if(t)return String(t);if(typeof r=="string")return r}var doe=(t,r)=>{if(r==="horizontal")return t.chartX;if(r==="vertical")return t.chartY},uoe=(t,r)=>r==="centric"?t.angle:t.radius,gh=t=>t.layout.width,yh=t=>t.layout.height,hoe=t=>t.layout.scale,c9=t=>t.layout.margin,x2=ut(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),v2=ut(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),d9="data-recharts-item-index",u9="data-recharts-item-id",Sy=60;function RI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Yx(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?RI(Object(n),!0).forEach(function(i){foe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function foe(t,r,n){return(r=moe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function moe(t){var r=poe(t,"string");return typeof r=="symbol"?r:r+""}function poe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var goe=t=>t.brush.height;function yoe(t){var r=v2(t);return r.reduce((n,i)=>{if(i.orientation==="left"&&!i.mirror&&!i.hide){var a=typeof i.width=="number"?i.width:Sy;return n+a}return n},0)}function xoe(t){var r=v2(t);return r.reduce((n,i)=>{if(i.orientation==="right"&&!i.mirror&&!i.hide){var a=typeof i.width=="number"?i.width:Sy;return n+a}return n},0)}function voe(t){var r=x2(t);return r.reduce((n,i)=>i.orientation==="top"&&!i.mirror&&!i.hide?n+i.height:n,0)}function boe(t){var r=x2(t);return r.reduce((n,i)=>i.orientation==="bottom"&&!i.mirror&&!i.hide?n+i.height:n,0)}var jo=ut([gh,yh,c9,goe,yoe,xoe,voe,boe,_B,$ae],(t,r,n,i,a,s,o,l,u,d)=>{var f={left:(n.left||0)+a,right:(n.right||0)+s},p={top:(n.top||0)+o,bottom:(n.bottom||0)+l},x=Yx(Yx({},p),f),v=x.bottom;x.bottom+=i,x=Jse(x,u,d);var w=t-x.left-x.right,C=r-x.top-x.bottom;return Yx(Yx({brushBottom:v},x),{},{width:Math.max(w,0),height:Math.max(C,0)})}),joe=ut(jo,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),fE=ut(gh,yh,(t,r)=>({x:0,y:0,width:t,height:r})),woe=k.createContext(null),Ho=()=>k.useContext(woe)!=null,b2=t=>t.brush,j2=ut([b2,jo,c9],(t,r,n)=>({height:t.height,x:or(t.x)?t.x:r.left,y:or(t.y)?t.y:r.top+r.height+r.brushBottom-(n?.bottom||0),width:or(t.width)?t.width:r.width})),Fw={},qw={},Uw={},MI;function Soe(){return MI||(MI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n,i,{signal:a,edges:s}={}){let o,l=null;const u=s!=null&&s.includes("leading"),d=s==null||s.includes("trailing"),f=()=>{l!==null&&(n.apply(o,l),o=void 0,l=null)},p=()=>{d&&f(),C()};let x=null;const v=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,p()},i)},w=()=>{x!==null&&(clearTimeout(x),x=null)},C=()=>{w(),o=void 0,l=null},A=()=>{f()},T=function(...O){if(a?.aborted)return;o=this,l=O;const D=x==null;v(),u&&D&&f()};return T.schedule=v,T.cancel=C,T.flush=A,a?.addEventListener("abort",C,{once:!0}),T}t.debounce=r})(Uw)),Uw}var LI;function Coe(){return LI||(LI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=Soe();function n(i,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:u}=s,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let f,p=null;const x=r.debounce(function(...C){f=i.apply(this,C),p=null},a,{edges:d}),v=function(...C){return u!=null&&(p===null&&(p=Date.now()),Date.now()-p>=u)?(f=i.apply(this,C),p=Date.now(),x.cancel(),x.schedule(),f):(x.apply(this,C),f)},w=()=>(x.flush(),f);return v.cancel=x.cancel,v.flush=w,v}t.debounce=n})(qw)),qw}var zI;function Noe(){return zI||(zI=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=Coe();function n(i,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return r.debounce(i,a,{leading:o,maxWait:a,trailing:l})}t.throttle=n})(Fw)),Fw}var Ww,BI;function Aoe(){return BI||(BI=1,Ww=Noe().throttle),Ww}var Eoe=Aoe();const _oe=hc(Eoe);var ab=function(r,n){for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!r))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(n.replace(/%s/g,()=>a[o++]))}},h9=(t,r,n)=>{var{width:i="100%",height:a="100%",aspect:s,maxHeight:o}=n,l=oh(i)?t:Number(i),u=oh(a)?r:Number(a);return s&&s>0&&(l?u=l/s:u&&(l=u*s),o&&u!=null&&u>o&&(u=o)),{calculatedWidth:l,calculatedHeight:u}},Toe={width:0,height:0,overflow:"visible"},Ioe={width:0,overflowX:"visible"},Ooe={height:0,overflowY:"visible"},koe={},Doe=t=>{var{width:r,height:n}=t,i=oh(r),a=oh(n);return i&&a?Toe:i?Ioe:a?Ooe:koe};function Poe(t){var{width:r,height:n,aspect:i}=t,a=r,s=n;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=i&&i>0?void 0:"100%":s===void 0&&(s=i&&i>0?void 0:"100%"),{width:a,height:s}}function gN(){return gN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},gN.apply(null,arguments)}function FI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function qI(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?FI(Object(n),!0).forEach(function(i){Roe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Roe(t,r,n){return(r=Moe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Moe(t){var r=Loe(t,"string");return typeof r=="symbol"?r:r+""}function Loe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var f9=k.createContext({width:-1,height:-1});function zoe(t){return hu(t.width)&&hu(t.height)}function m9(t){var{children:r,width:n,height:i}=t,a=k.useMemo(()=>({width:n,height:i}),[n,i]);return zoe(a)?k.createElement(f9.Provider,{value:a},r):null}var mE=()=>k.useContext(f9),Boe=k.forwardRef((t,r)=>{var{aspect:n,initialDimension:i={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:u,children:d,debounce:f=0,id:p,className:x,onResize:v,style:w={}}=t,C=k.useRef(null),A=k.useRef();A.current=v,k.useImperativeHandle(r,()=>C.current);var[T,O]=k.useState({containerWidth:i.width,containerHeight:i.height}),D=k.useCallback((ee,F)=>{O(Y=>{var J=Math.round(ee),Z=Math.round(F);return Y.containerWidth===J&&Y.containerHeight===Z?Y:{containerWidth:J,containerHeight:Z}})},[]);k.useEffect(()=>{if(C.current==null||typeof ResizeObserver>"u")return vy;var ee=Z=>{var re,{width:de,height:le}=Z[0].contentRect;D(de,le),(re=A.current)===null||re===void 0||re.call(A,de,le)};f>0&&(ee=_oe(ee,f,{trailing:!0,leading:!1}));var F=new ResizeObserver(ee),{width:Y,height:J}=C.current.getBoundingClientRect();return D(Y,J),F.observe(C.current),()=>{F.disconnect()}},[D,f]);var{containerWidth:M,containerHeight:Q}=T;ab(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:U,calculatedHeight:$}=h9(M,Q,{width:a,height:s,aspect:n,maxHeight:u});return ab(U!=null&&U>0||$!=null&&$>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,U,$,a,s,o,l,n),k.createElement("div",{id:p?"".concat(p):void 0,className:hi("recharts-responsive-container",x),style:qI(qI({},w),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:u}),ref:C},k.createElement("div",{style:Doe({width:a,height:s})},k.createElement(m9,{width:U,height:$},d)))}),Ic=k.forwardRef((t,r)=>{var n=mE();if(hu(n.width)&&hu(n.height))return t.children;var{width:i,height:a}=Poe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=h9(void 0,void 0,{width:i,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return or(s)&&or(o)?k.createElement(m9,{width:s,height:o},t.children):k.createElement(Boe,gN({},t,{width:i,height:a,ref:r}))});function p9(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var w2=()=>{var t,r=Ho(),n=wr(joe),i=wr(j2),a=(t=wr(b2))===null||t===void 0?void 0:t.padding;return!r||!i||!a?n:{width:i.width-a.left-a.right,height:i.height-a.top-a.bottom,x:a.left,y:a.top}},Foe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},g9=()=>{var t;return(t=wr(jo))!==null&&t!==void 0?t:Foe},pE=()=>wr(gh),gE=()=>wr(yh),qoe=()=>wr(t=>t.layout.margin),Gn=t=>t.layout.layoutType,gf=()=>wr(Gn),Uoe=()=>{var t=gf();if(t==="horizontal"||t==="vertical")return t},Woe=()=>{var t=gf();return t!==void 0},S2=t=>{var r=pa(),n=Ho(),{width:i,height:a}=t,s=mE(),o=i,l=a;return s&&(o=s.width>0?s.width:i,l=s.height>0?s.height:a),k.useEffect(()=>{!n&&hu(o)&&hu(l)&&r(Gse({width:o,height:l}))},[r,n,o,l]),null},y9=Symbol.for("immer-nothing"),UI=Symbol.for("immer-draftable"),zc=Symbol.for("immer-state");function Sd(t,...r){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Gg=Object.getPrototypeOf;function Fp(t){return!!t&&!!t[zc]}function mm(t){return t?x9(t)||Array.isArray(t)||!!t[UI]||!!t.constructor?.[UI]||Cy(t)||N2(t):!1}var Hoe=Object.prototype.constructor.toString(),WI=new WeakMap;function x9(t){if(!t||typeof t!="object")return!1;const r=Object.getPrototypeOf(t);if(r===null||r===Object.prototype)return!0;const n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let i=WI.get(n);return i===void 0&&(i=Function.toString.call(n),WI.set(n,i)),i===Hoe}function sb(t,r,n=!0){C2(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{r(a,t[a],t)}):t.forEach((i,a)=>r(a,i,t))}function C2(t){const r=t[zc];return r?r.type_:Array.isArray(t)?1:Cy(t)?2:N2(t)?3:0}function yN(t,r){return C2(t)===2?t.has(r):Object.prototype.hasOwnProperty.call(t,r)}function v9(t,r,n){const i=C2(t);i===2?t.set(r,n):i===3?t.add(n):t[r]=n}function Voe(t,r){return t===r?t!==0||1/t===1/r:t!==t&&r!==r}function Cy(t){return t instanceof Map}function N2(t){return t instanceof Set}function Pf(t){return t.copy_||t.base_}function xN(t,r){if(Cy(t))return new Map(t);if(N2(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=x9(t);if(r===!0||r==="class_only"&&!n){const i=Object.getOwnPropertyDescriptors(t);delete i[zc];let a=Reflect.ownKeys(i);for(let s=0;s<a.length;s++){const o=a[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(Gg(t),i)}else{const i=Gg(t);if(i!==null&&n)return{...t};const a=Object.create(i);return Object.assign(a,t)}}function yE(t,r=!1){return A2(t)||Fp(t)||!mm(t)||(C2(t)>1&&Object.defineProperties(t,{set:Zx,add:Zx,clear:Zx,delete:Zx}),Object.freeze(t),r&&Object.values(t).forEach(n=>yE(n,!0))),t}function $oe(){Sd(2)}var Zx={value:$oe};function A2(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var Goe={};function pm(t){const r=Goe[t];return r||Sd(0,t),r}var Kg;function b9(){return Kg}function Koe(t,r){return{drafts_:[],parent_:t,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function HI(t,r){r&&(pm("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=r)}function vN(t){bN(t),t.drafts_.forEach(Qoe),t.drafts_=null}function bN(t){t===Kg&&(Kg=t.parent_)}function VI(t){return Kg=Koe(Kg,t)}function Qoe(t){const r=t[zc];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function $I(t,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];return t!==void 0&&t!==n?(n[zc].modified_&&(vN(r),Sd(4)),mm(t)&&(t=ob(r,t),r.parent_||lb(r,t)),r.patches_&&pm("Patches").generateReplacementPatches_(n[zc].base_,t,r.patches_,r.inversePatches_)):t=ob(r,n,[]),vN(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),t!==y9?t:void 0}function ob(t,r,n){if(A2(r))return r;const i=t.immer_.shouldUseStrictIteration(),a=r[zc];if(!a)return sb(r,(s,o)=>GI(t,a,r,s,o,n),i),r;if(a.scope_!==t)return r;if(!a.modified_)return lb(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),sb(o,(u,d)=>GI(t,a,s,u,d,n,l),i),lb(t,s,!1),n&&t.patches_&&pm("Patches").generatePatches_(a,n,t.patches_,t.inversePatches_)}return a.copy_}function GI(t,r,n,i,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=A2(a);if(!(l&&!o)){if(Fp(a)){const u=s&&r&&r.type_!==3&&!yN(r.assigned_,i)?s.concat(i):void 0,d=ob(t,a,u);if(v9(n,i,d),Fp(d))t.canAutoFreeze_=!1;else return}else o&&n.add(a);if(mm(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||r&&r.base_&&r.base_[i]===a&&l)return;ob(t,a),(!r||!r.scope_.parent_)&&typeof i!="symbol"&&(Cy(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))&&lb(t,a)}}}function lb(t,r,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&yE(r,n)}function Yoe(t,r){const n=Array.isArray(t),i={type_:n?1:0,scope_:r?r.scope_:b9(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,s=xE;n&&(a=[i],s=Qg);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return i.draft_=l,i.revoke_=o,l}var xE={get(t,r){if(r===zc)return t;const n=Pf(t);if(!yN(n,r))return Zoe(t,n,r);const i=n[r];return t.finalized_||!mm(i)?i:i===Hw(t.base_,r)?(Vw(t),t.copy_[r]=wN(i,t)):i},has(t,r){return r in Pf(t)},ownKeys(t){return Reflect.ownKeys(Pf(t))},set(t,r,n){const i=j9(Pf(t),r);if(i?.set)return i.set.call(t.draft_,n),!0;if(!t.modified_){const a=Hw(Pf(t),r),s=a?.[zc];if(s&&s.base_===n)return t.copy_[r]=n,t.assigned_[r]=!1,!0;if(Voe(n,a)&&(n!==void 0||yN(t.base_,r)))return!0;Vw(t),jN(t)}return t.copy_[r]===n&&(n!==void 0||r in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[r])||(t.copy_[r]=n,t.assigned_[r]=!0),!0},deleteProperty(t,r){return Hw(t.base_,r)!==void 0||r in t.base_?(t.assigned_[r]=!1,Vw(t),jN(t)):delete t.assigned_[r],t.copy_&&delete t.copy_[r],!0},getOwnPropertyDescriptor(t,r){const n=Pf(t),i=Reflect.getOwnPropertyDescriptor(n,r);return i&&{writable:!0,configurable:t.type_!==1||r!=="length",enumerable:i.enumerable,value:n[r]}},defineProperty(){Sd(11)},getPrototypeOf(t){return Gg(t.base_)},setPrototypeOf(){Sd(12)}},Qg={};sb(xE,(t,r)=>{Qg[t]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Qg.deleteProperty=function(t,r){return Qg.set.call(this,t,r,void 0)};Qg.set=function(t,r,n){return xE.set.call(this,t[0],r,n,t[0])};function Hw(t,r){const n=t[zc];return(n?Pf(n):t)[r]}function Zoe(t,r,n){const i=j9(r,n);return i?"value"in i?i.value:i.get?.call(t.draft_):void 0}function j9(t,r){if(!(r in t))return;let n=Gg(t);for(;n;){const i=Object.getOwnPropertyDescriptor(n,r);if(i)return i;n=Gg(n)}}function jN(t){t.modified_||(t.modified_=!0,t.parent_&&jN(t.parent_))}function Vw(t){t.copy_||(t.copy_=xN(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Xoe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(r,n,i)=>{if(typeof r=="function"&&typeof n!="function"){const s=n;n=r;const o=this;return function(u=s,...d){return o.produce(u,f=>n.call(this,f,...d))}}typeof n!="function"&&Sd(6),i!==void 0&&typeof i!="function"&&Sd(7);let a;if(mm(r)){const s=VI(this),o=wN(r,void 0);let l=!0;try{a=n(o),l=!1}finally{l?vN(s):bN(s)}return HI(s,i),$I(a,s)}else if(!r||typeof r!="object"){if(a=n(r),a===void 0&&(a=r),a===y9&&(a=void 0),this.autoFreeze_&&yE(a,!0),i){const s=[],o=[];pm("Patches").generateReplacementPatches_(r,a,s,o),i(s,o)}return a}else Sd(1,r)},this.produceWithPatches=(r,n)=>{if(typeof r=="function")return(o,...l)=>this.produceWithPatches(o,u=>r(u,...l));let i,a;return[this.produce(r,n,(o,l)=>{i=o,a=l}),i,a]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){mm(t)||Sd(8),Fp(t)&&(t=Joe(t));const r=VI(this),n=wN(t,void 0);return n[zc].isManual_=!0,bN(r),n}finishDraft(t,r){const n=t&&t[zc];(!n||!n.isManual_)&&Sd(9);const{scope_:i}=n;return HI(i,r),$I(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const a=r[n];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}n>-1&&(r=r.slice(n+1));const i=pm("Patches").applyPatches_;return Fp(t)?i(t,r):this.produce(t,a=>i(a,r))}};function wN(t,r){const n=Cy(t)?pm("MapSet").proxyMap_(t,r):N2(t)?pm("MapSet").proxySet_(t,r):Yoe(t,r);return(r?r.scope_:b9()).drafts_.push(n),n}function Joe(t){return Fp(t)||Sd(10,t),w9(t)}function w9(t){if(!mm(t)||A2(t))return t;const r=t[zc];let n,i=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=xN(t,r.scope_.immer_.useStrictShallowCopy_),i=r.scope_.immer_.shouldUseStrictIteration()}else n=xN(t,!0);return sb(n,(a,s)=>{v9(n,a,w9(s))},i),r&&(r.finalized_=!1),n}var ele=new Xoe;ele.produce;var tle={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},S9=fc({name:"legend",initialState:tle,reducers:{setLegendSize(t,r){t.size.width=r.payload.width,t.size.height=r.payload.height},setLegendSettings(t,r){t.settings.align=r.payload.align,t.settings.layout=r.payload.layout,t.settings.verticalAlign=r.payload.verticalAlign,t.settings.itemSorter=r.payload.itemSorter},addLegendPayload:{reducer(t,r){t.payload.push(r.payload)},prepare:Ua()},replaceLegendPayload:{reducer(t,r){var{prev:n,next:i}=r.payload,a=Nd(t).payload.indexOf(n);a>-1&&(t.payload[a]=i)},prepare:Ua()},removeLegendPayload:{reducer(t,r){var n=Nd(t).payload.indexOf(r.payload);n>-1&&t.payload.splice(n,1)},prepare:Ua()}}}),{setLegendSize:KI,setLegendSettings:rle,addLegendPayload:C9,replaceLegendPayload:N9,removeLegendPayload:A9}=S9.actions,nle=S9.reducer,ile=["contextPayload"];function SN(){return SN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},SN.apply(null,arguments)}function QI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function qp(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?QI(Object(n),!0).forEach(function(i){ale(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ale(t,r,n){return(r=sle(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function sle(t){var r=ole(t,"string");return typeof r=="symbol"?r:r+""}function ole(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function lle(t,r){if(t==null)return{};var n,i,a=cle(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function cle(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function dle(t){return t.value}function ule(t){var{contextPayload:r}=t,n=lle(t,ile),i=CB(r,t.payloadUniqBy,dle),a=qp(qp({},n),{},{payload:i});return k.isValidElement(t.content)?k.cloneElement(t.content,a):typeof t.content=="function"?k.createElement(t.content,a):k.createElement(rae,a)}function hle(t,r,n,i,a,s){var{layout:o,align:l,verticalAlign:u}=r,d,f;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?d={left:((i||0)-s.width)/2}:d=l==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(u==="middle"?f={top:((a||0)-s.height)/2}:f=u==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),qp(qp({},d),f)}function fle(t){var r=pa();return k.useEffect(()=>{r(rle(t))},[r,t]),null}function mle(t){var r=pa();return k.useEffect(()=>(r(KI(t)),()=>{r(KI({width:0,height:0}))}),[r,t]),null}function ple(t,r,n,i){return t==="vertical"&&or(r)?{height:r}:t==="horizontal"?{width:n||i}:null}var gle={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function E9(t){var r=ks(t,gle),n=Qae(),i=Gne(),a=qoe(),{width:s,height:o,wrapperStyle:l,portal:u}=r,[d,f]=TB([n]),p=pE(),x=gE();if(p==null||x==null)return null;var v=p-(a?.left||0)-(a?.right||0),w=ple(r.layout,o,s,v),C=u?l:qp(qp({position:"absolute",width:w?.width||s||"auto",height:w?.height||o||"auto"},hle(l,r,a,p,x,d)),l),A=u??i;if(A==null||n==null)return null;var T=k.createElement("div",{className:"recharts-legend-wrapper",style:C,ref:f},k.createElement(fle,{layout:r.layout,align:r.align,verticalAlign:r.verticalAlign,itemSorter:r.itemSorter}),!u&&k.createElement(mle,{width:d.width,height:d.height}),k.createElement(ule,SN({},r,w,{margin:a,chartWidth:p,chartHeight:x,contextPayload:n})));return CA.createPortal(T,A)}E9.displayName="Legend";function CN(){return CN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},CN.apply(null,arguments)}function YI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function $w(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?YI(Object(n),!0).forEach(function(i){yle(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function yle(t,r,n){return(r=xle(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function xle(t){var r=vle(t,"string");return typeof r=="symbol"?r:r+""}function vle(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function ble(t){return Array.isArray(t)&&uu(t[0])&&uu(t[1])?t.join(" ~ "):t}var jle=t=>{var{separator:r=" : ",contentStyle:n={},itemStyle:i={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:u,labelClassName:d,label:f,labelFormatter:p,accessibilityLayer:x=!1}=t,v=()=>{if(s&&s.length){var Q={padding:0,margin:0},U=(l?l2(s,l):s).map(($,ee)=>{if($.type==="none")return null;var F=$.formatter||o||ble,{value:Y,name:J}=$,Z=Y,re=J;if(F){var de=F(Y,J,$,ee,s);if(Array.isArray(de))[Z,re]=de;else if(de!=null)Z=de;else return null}var le=$w({display:"block",paddingTop:4,paddingBottom:4,color:$.color||"#000"},i);return k.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ee),style:le},uu(re)?k.createElement("span",{className:"recharts-tooltip-item-name"},re):null,uu(re)?k.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,k.createElement("span",{className:"recharts-tooltip-item-value"},Z),k.createElement("span",{className:"recharts-tooltip-item-unit"},$.unit||""))});return k.createElement("ul",{className:"recharts-tooltip-item-list",style:Q},U)}return null},w=$w({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),C=$w({margin:0},a),A=!Ta(f),T=A?f:"",O=hi("recharts-default-tooltip",u),D=hi("recharts-tooltip-label",d);A&&p&&s!==void 0&&s!==null&&(T=p(f,s));var M=x?{role:"status","aria-live":"assertive"}:{};return k.createElement("div",CN({className:O,style:w},M),k.createElement("p",{className:D,style:C},k.isValidElement(T)?T:"".concat(T)),v())},rg="recharts-tooltip-wrapper",wle={visibility:"hidden"};function Sle(t){var{coordinate:r,translateX:n,translateY:i}=t;return hi(rg,{["".concat(rg,"-right")]:or(n)&&r&&or(r.x)&&n>=r.x,["".concat(rg,"-left")]:or(n)&&r&&or(r.x)&&n<r.x,["".concat(rg,"-bottom")]:or(i)&&r&&or(r.y)&&i>=r.y,["".concat(rg,"-top")]:or(i)&&r&&or(r.y)&&i<r.y})}function ZI(t){var{allowEscapeViewBox:r,coordinate:n,key:i,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:u,viewBoxDimension:d}=t;if(s&&or(s[i]))return s[i];var f=n[i]-l-(a>0?a:0),p=n[i]+a;if(r[i])return o[i]?f:p;var x=u[i];if(x==null)return 0;if(o[i]){var v=f,w=x;return v<w?Math.max(p,x):Math.max(f,x)}if(d==null)return 0;var C=p+l,A=x+d;return C>A?Math.max(f,x):Math.max(p,x)}function Cle(t){var{translateX:r,translateY:n,useTranslate3d:i}=t;return{transform:i?"translate3d(".concat(r,"px, ").concat(n,"px, 0)"):"translate(".concat(r,"px, ").concat(n,"px)")}}function Nle(t){var{allowEscapeViewBox:r,coordinate:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:u}=t,d,f,p;return o.height>0&&o.width>0&&n?(f=ZI({allowEscapeViewBox:r,coordinate:n,key:"x",offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:u,viewBoxDimension:u.width}),p=ZI({allowEscapeViewBox:r,coordinate:n,key:"y",offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:u,viewBoxDimension:u.height}),d=Cle({translateX:f,translateY:p,useTranslate3d:l})):d=wle,{cssProperties:d,cssClasses:Sle({translateX:f,translateY:p,coordinate:n})}}function XI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Xx(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?XI(Object(n),!0).forEach(function(i){NN(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function NN(t,r,n){return(r=Ale(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Ale(t){var r=Ele(t,"string");return typeof r=="symbol"?r:r+""}function Ele(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}class _le extends k.PureComponent{constructor(){super(...arguments),NN(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),NN(this,"handleKeyDown",r=>{if(r.key==="Escape"){var n,i,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==null&&n!==void 0?n:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var r,n;this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:u,offset:d,position:f,reverseDirection:p,useTranslate3d:x,viewBox:v,wrapperStyle:w,lastBoundingBox:C,innerRef:A,hasPortalFromProps:T}=this.props,{cssClasses:O,cssProperties:D}=Nle({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:d,position:f,reverseDirection:p,tooltipBox:{height:C.height,width:C.width},useTranslate3d:x,viewBox:v}),M=T?{}:Xx(Xx({transition:u&&r?"transform ".concat(i,"ms ").concat(a):void 0},D),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&l?"visible":"hidden",position:"absolute",top:0,left:0}),Q=Xx(Xx({},M),{},{visibility:!this.state.dismissed&&r&&l?"visible":"hidden"},w);return k.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:O,style:Q,ref:A},s)}}var _9=()=>{var t;return(t=wr(r=>r.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function AN(){return AN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},AN.apply(null,arguments)}function JI(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function eO(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?JI(Object(n),!0).forEach(function(i){Tle(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JI(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Tle(t,r,n){return(r=Ile(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Ile(t){var r=Ole(t,"string");return typeof r=="symbol"?r:r+""}function Ole(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var tO={curveBasisClosed:hie,curveBasisOpen:fie,curveBasis:uie,curveBumpX:Zne,curveBumpY:Xne,curveLinearClosed:mie,curveLinear:s2,curveMonotoneX:pie,curveMonotoneY:gie,curveNatural:yie,curveStep:xie,curveStepAfter:bie,curveStepBefore:vie},cb=t=>oa(t.x)&&oa(t.y),rO=t=>t.base!=null&&cb(t.base)&&cb(t),ng=t=>t.x,ig=t=>t.y,kle=(t,r)=>{if(typeof t=="function")return t;var n="curve".concat(xy(t));return(n==="curveMonotone"||n==="curveBump")&&r?tO["".concat(n).concat(r==="vertical"?"Y":"X")]:tO[n]||s2},Dle=t=>{var{type:r="linear",points:n=[],baseLine:i,layout:a,connectNulls:s=!1}=t,o=kle(r,a),l=s?n.filter(cb):n,u;if(Array.isArray(i)){var d=n.map((v,w)=>eO(eO({},v),{},{base:i[w]}));a==="vertical"?u=Hx().y(ig).x1(ng).x0(v=>v.base.x):u=Hx().x(ng).y1(ig).y0(v=>v.base.y);var f=u.defined(rO).curve(o),p=s?d.filter(rO):d;return f(p)}a==="vertical"&&or(i)?u=Hx().y(ig).x1(ng).x0(i):or(i)?u=Hx().x(ng).y1(ig).y0(i):u=eB().x(ng).y(ig);var x=u.defined(cb).curve(o);return x(l)},Ep=t=>{var{className:r,points:n,path:i,pathRef:a}=t,s=gf();if((!n||!n.length)&&!i)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=n&&n.length?Dle(o):i;return k.createElement("path",AN({},Hl(t),nE(t),{className:hi("recharts-curve",r),d:l===null?void 0:l,ref:a}))},Ple=["x","y","top","left","width","height","className"];function EN(){return EN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},EN.apply(null,arguments)}function nO(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Rle(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?nO(Object(n),!0).forEach(function(i){Mle(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Mle(t,r,n){return(r=Lle(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Lle(t){var r=zle(t,"string");return typeof r=="symbol"?r:r+""}function zle(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Ble(t,r){if(t==null)return{};var n,i,a=Fle(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Fle(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var qle=(t,r,n,i,a,s)=>"M".concat(t,",").concat(a,"v").concat(i,"M").concat(s,",").concat(r,"h").concat(n),Ule=t=>{var{x:r=0,y:n=0,top:i=0,left:a=0,width:s=0,height:o=0,className:l}=t,u=Ble(t,Ple),d=Rle({x:r,y:n,top:i,left:a,width:s,height:o},u);return!or(r)||!or(n)||!or(s)||!or(o)||!or(i)||!or(a)?null:k.createElement("path",EN({},Tl(d),{className:hi("recharts-cross",l),d:qle(r,n,s,o,i,a)}))};function Wle(t,r,n,i){var a=i/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?r.x-a:n.left+.5,y:t==="horizontal"?n.top+.5:r.y-a,width:t==="horizontal"?i:n.width-1,height:t==="horizontal"?n.height-1:i}}function iO(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function aO(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?iO(Object(n),!0).forEach(function(i){Hle(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):iO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Hle(t,r,n){return(r=Vle(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Vle(t){var r=$le(t,"string");return typeof r=="symbol"?r:r+""}function $le(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Gle=t=>t.replace(/([A-Z])/g,r=>"-".concat(r.toLowerCase())),T9=(t,r,n)=>t.map(i=>"".concat(Gle(i)," ").concat(r,"ms ").concat(n)).join(","),Kle=(t,r)=>[Object.keys(t),Object.keys(r)].reduce((n,i)=>n.filter(a=>i.includes(a))),Yg=(t,r)=>Object.keys(r).reduce((n,i)=>aO(aO({},n),{},{[i]:t(i,r[i])}),{});function sO(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function po(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?sO(Object(n),!0).forEach(function(i){Qle(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Qle(t,r,n){return(r=Yle(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Yle(t){var r=Zle(t,"string");return typeof r=="symbol"?r:r+""}function Zle(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var db=(t,r,n)=>t+(r-t)*n,_N=t=>{var{from:r,to:n}=t;return r!==n},I9=(t,r,n)=>{var i=Yg((a,s)=>{if(_N(s)){var[o,l]=t(s.from,s.to,s.velocity);return po(po({},s),{},{from:o,velocity:l})}return s},r);return n<1?Yg((a,s)=>_N(s)&&i[a]!=null?po(po({},s),{},{velocity:db(s.velocity,i[a].velocity,n),from:db(s.from,i[a].from,n)}):s,r):I9(t,i,n-1)};function Xle(t,r,n,i,a,s){var o,l=i.reduce((x,v)=>po(po({},x),{},{[v]:{from:t[v],velocity:0,to:r[v]}}),{}),u=()=>Yg((x,v)=>v.from,l),d=()=>!Object.values(l).filter(_N).length,f=null,p=x=>{o||(o=x);var v=x-o,w=v/n.dt;l=I9(n,l,w),a(po(po(po({},t),r),u())),o=x,d()||(f=s.setTimeout(p))};return()=>(f=s.setTimeout(p),()=>{var x;(x=f)===null||x===void 0||x()})}function Jle(t,r,n,i,a,s,o){var l=null,u=a.reduce((p,x)=>{var v=t[x],w=r[x];return v==null||w==null?p:po(po({},p),{},{[x]:[v,w]})},{}),d,f=p=>{d||(d=p);var x=(p-d)/i,v=Yg((C,A)=>db(...A,n(x)),u);if(s(po(po(po({},t),r),v)),x<1)l=o.setTimeout(f);else{var w=Yg((C,A)=>db(...A,n(1)),u);s(po(po(po({},t),r),w))}};return()=>(l=o.setTimeout(f),()=>{var p;(p=l)===null||p===void 0||p()})}const ece=(t,r,n,i,a,s)=>{var o=Kle(t,r);return n==null?()=>(a(po(po({},t),r)),()=>{}):n.isStepper===!0?Xle(t,r,n,o,a,s):Jle(t,r,n,i,o,a,s)};var ub=1e-4,O9=(t,r)=>[0,3*t,3*r-6*t,3*t-3*r+1],k9=(t,r)=>t.map((n,i)=>n*r**i).reduce((n,i)=>n+i),oO=(t,r)=>n=>{var i=O9(t,r);return k9(i,n)},tce=(t,r)=>n=>{var i=O9(t,r),a=[...i.map((s,o)=>s*o).slice(1),0];return k9(a,n)},rce=t=>{var r,n=t.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var i=(r=n[1])===null||r===void 0||(r=r.split(")")[0])===null||r===void 0?void 0:r.split(",");if(i==null||i.length!==4)return null;var a=i.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},nce=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=rce(n[0]);if(a)return a}}return n.length===4?n:[0,0,1,1]},ice=(t,r,n,i)=>{var a=oO(t,n),s=oO(r,i),o=tce(t,n),l=d=>d>1?1:d<0?0:d,u=d=>{for(var f=d>1?1:d,p=f,x=0;x<8;++x){var v=a(p)-f,w=o(p);if(Math.abs(v-f)<ub||w<ub)return s(p);p=l(p-v/w)}return s(p)};return u.isStepper=!1,u},lO=function(){return ice(...nce(...arguments))},ace=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:i=8,dt:a=17}=r,s=(o,l,u)=>{var d=-(o-l)*n,f=u*i,p=u+(d-f)*a/1e3,x=u*a/1e3+o;return Math.abs(x-l)<ub&&Math.abs(p)<ub?[l,0]:[x,p]};return s.isStepper=!0,s.dt=a,s},sce=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return lO(t);case"spring":return ace();default:if(t.split("(")[0]==="cubic-bezier")return lO(t)}return typeof t=="function"?t:null};function oce(t){var r,n=()=>null,i=!1,a=null,s=o=>{if(!i){if(Array.isArray(o)){if(!o.length)return;var l=o,[u,...d]=l;if(typeof u=="number"){a=t.setTimeout(s.bind(null,d),u);return}s(u),a=t.setTimeout(s.bind(null,d));return}typeof o=="string"&&(r=o,n(r)),typeof o=="object"&&(r=o,n(r)),typeof o=="function"&&o()}};return{stop:()=>{i=!0},start:o=>{i=!1,a&&(a(),a=null),s(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>t}}class lce{setTimeout(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=performance.now(),a=null,s=o=>{o-i>=n?r(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function cce(){return oce(new lce)}var dce=k.createContext(cce);function uce(t,r){var n=k.useContext(dce);return k.useMemo(()=>r??n(t),[t,r,n])}var hce=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Ny={isSsr:hce()},fce={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},cO={t:0},Gw={t:1};function o0(t){var r=ks(t,fce),{isActive:n,canBegin:i,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:u,children:d}=r,f=n==="auto"?!Ny.isSsr:n,p=uce(r.animationId,r.animationManager),[x,v]=k.useState(f?cO:Gw),w=k.useRef(null);return k.useEffect(()=>{f||v(Gw)},[f]),k.useEffect(()=>{if(!f||!i)return vy;var C=ece(cO,Gw,sce(s),a,v,p.getTimeoutController()),A=()=>{w.current=C()};return p.start([u,o,A,a,l]),()=>{p.stop(),w.current&&w.current(),l()}},[f,i,a,s,o,u,l,p]),d(x.t)}function l0(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=k.useRef(Wg(r)),i=k.useRef(t);return i.current!==t&&(n.current=Wg(r),i.current=t),n.current}var mce=["radius"],pce=["radius"],dO,uO,hO,fO,mO,pO,gO,yO,xO,vO;function bO(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function jO(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?bO(Object(n),!0).forEach(function(i){gce(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function gce(t,r,n){return(r=yce(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function yce(t){var r=xce(t,"string");return typeof r=="symbol"?r:r+""}function xce(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function hb(){return hb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},hb.apply(null,arguments)}function wO(t,r){if(t==null)return{};var n,i,a=vce(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function vce(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Zd(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}var SO=(t,r,n,i,a)=>{var s=ef(n),o=ef(i),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),u=o>=0?1:-1,d=s>=0?1:-1,f=o>=0&&s>=0||o<0&&s<0?1:0,p;if(l>0&&a instanceof Array){for(var x=[0,0,0,0],v=0,w=4;v<w;v++)x[v]=a[v]>l?l:a[v];p=As(dO||(dO=Zd(["M",",",""])),t,r+u*x[0]),x[0]>0&&(p+=As(uO||(uO=Zd(["A ",",",",0,0,",",",",",""])),x[0],x[0],f,t+d*x[0],r)),p+=As(hO||(hO=Zd(["L ",",",""])),t+n-d*x[1],r),x[1]>0&&(p+=As(fO||(fO=Zd(["A ",",",",0,0,",`,
        `,",",""])),x[1],x[1],f,t+n,r+u*x[1])),p+=As(mO||(mO=Zd(["L ",",",""])),t+n,r+i-u*x[2]),x[2]>0&&(p+=As(pO||(pO=Zd(["A ",",",",0,0,",`,
        `,",",""])),x[2],x[2],f,t+n-d*x[2],r+i)),p+=As(gO||(gO=Zd(["L ",",",""])),t+d*x[3],r+i),x[3]>0&&(p+=As(yO||(yO=Zd(["A ",",",",0,0,",`,
        `,",",""])),x[3],x[3],f,t,r+i-u*x[3])),p+="Z"}else if(l>0&&a===+a&&a>0){var C=Math.min(l,a);p=As(xO||(xO=Zd(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,r+u*C,C,C,f,t+d*C,r,t+n-d*C,r,C,C,f,t+n,r+u*C,t+n,r+i-u*C,C,C,f,t+n-d*C,r+i,t+d*C,r+i,C,C,f,t,r+i-u*C)}else p=As(vO||(vO=Zd(["M ",","," h "," v "," h "," Z"])),t,r,n,i,-n);return p},CO={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},D9=t=>{var r=ks(t,CO),n=k.useRef(null),[i,a]=k.useState(-1);k.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var ue=n.current.getTotalLength();ue&&a(ue)}catch{}},[]);var{x:s,y:o,width:l,height:u,radius:d,className:f}=r,{animationEasing:p,animationDuration:x,animationBegin:v,isAnimationActive:w,isUpdateAnimationActive:C}=r,A=k.useRef(l),T=k.useRef(u),O=k.useRef(s),D=k.useRef(o),M=k.useMemo(()=>({x:s,y:o,width:l,height:u,radius:d}),[s,o,l,u,d]),Q=l0(M,"rectangle-");if(s!==+s||o!==+o||l!==+l||u!==+u||l===0||u===0)return null;var U=hi("recharts-rectangle",f);if(!C){var $=Tl(r),{radius:ee}=$,F=wO($,mce);return k.createElement("path",hb({},F,{x:ef(s),y:ef(o),width:ef(l),height:ef(u),radius:typeof d=="number"?d:void 0,className:U,d:SO(s,o,l,u,d)}))}var Y=A.current,J=T.current,Z=O.current,re=D.current,de="0px ".concat(i===-1?1:i,"px"),le="".concat(i,"px 0px"),K=T9(["strokeDasharray"],x,typeof p=="string"?p:CO.animationEasing);return k.createElement(o0,{animationId:Q,key:Q,canBegin:i>0,duration:x,easing:p,isActive:C,begin:v},ue=>{var ce=Ti(Y,l,ue),ye=Ti(J,u,ue),Se=Ti(Z,s,ue),V=Ti(re,o,ue);n.current&&(A.current=ce,T.current=ye,O.current=Se,D.current=V);var X;w?ue>0?X={transition:K,strokeDasharray:le}:X={strokeDasharray:de}:X={strokeDasharray:le};var se=Tl(r),{radius:W}=se,oe=wO(se,pce);return k.createElement("path",hb({},oe,{radius:typeof d=="number"?d:void 0,className:U,d:SO(Se,V,ce,ye,d),ref:n,style:jO(jO({},X),r.style)}))})};function NO(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function AO(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?NO(Object(n),!0).forEach(function(i){bce(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function bce(t,r,n){return(r=jce(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function jce(t){var r=wce(t,"string");return typeof r=="symbol"?r:r+""}function wce(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var fb=Math.PI/180,Sce=t=>t*180/Math.PI,ro=(t,r,n,i)=>({x:t+Math.cos(-fb*i)*n,y:r+Math.sin(-fb*i)*n}),P9=function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(i.left||0)-(i.right||0)),Math.abs(n-(i.top||0)-(i.bottom||0)))/2},Cce=(t,r)=>{var{x:n,y:i}=t,{x:a,y:s}=r;return Math.sqrt((n-a)**2+(i-s)**2)},Nce=(t,r)=>{var{x:n,y:i}=t,{cx:a,cy:s}=r,o=Cce({x:n,y:i},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(n-a)/o,u=Math.acos(l);return i>s&&(u=2*Math.PI-u),{radius:o,angle:Sce(u),angleInRadian:u}},Ace=t=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return{startAngle:r-s*360,endAngle:n-s*360}},Ece=(t,r)=>{var{startAngle:n,endAngle:i}=r,a=Math.floor(n/360),s=Math.floor(i/360),o=Math.min(a,s);return t+o*360},_ce=(t,r)=>{var{chartX:n,chartY:i}=t,{radius:a,angle:s}=Nce({x:n,y:i},r),{innerRadius:o,outerRadius:l}=r;if(a<o||a>l||a===0)return null;var{startAngle:u,endAngle:d}=Ace(r),f=s,p;if(u<=d){for(;f>d;)f-=360;for(;f<u;)f+=360;p=f>=u&&f<=d}else{for(;f>u;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=u}return p?AO(AO({},r),{},{radius:a,angle:Ece(f,r)}):null};function R9(t){var{cx:r,cy:n,radius:i,startAngle:a,endAngle:s}=t,o=ro(r,n,i,a),l=ro(r,n,i,s);return{points:[o,l],cx:r,cy:n,radius:i,startAngle:a,endAngle:s}}var EO,_O,TO,IO,OO,kO,DO;function TN(){return TN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},TN.apply(null,arguments)}function Hf(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}var Tce=(t,r)=>{var n=Bo(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},Jx=t=>{var{cx:r,cy:n,radius:i,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:u}=t,d=l*(o?1:-1)+i,f=Math.asin(l/d)/fb,p=u?a:a+s*f,x=ro(r,n,d,p),v=ro(r,n,i,p),w=u?a-s*f:a,C=ro(r,n,d*Math.cos(f*fb),w);return{center:x,circleTangency:v,lineTangency:C,theta:f}},M9=t=>{var{cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:s,endAngle:o}=t,l=Tce(s,o),u=s+l,d=ro(r,n,a,s),f=ro(r,n,a,u),p=As(EO||(EO=Hf(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),d.x,d.y,a,a,+(Math.abs(l)>180),+(s>u),f.x,f.y);if(i>0){var x=ro(r,n,i,s),v=ro(r,n,i,u);p+=As(_O||(_O=Hf(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),v.x,v.y,i,i,+(Math.abs(l)>180),+(s<=u),x.x,x.y)}else p+=As(TO||(TO=Hf(["L ",","," Z"])),r,n);return p},Ice=t=>{var{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:u,endAngle:d}=t,f=Bo(d-u),{circleTangency:p,lineTangency:x,theta:v}=Jx({cx:r,cy:n,radius:a,angle:u,sign:f,cornerRadius:s,cornerIsExternal:l}),{circleTangency:w,lineTangency:C,theta:A}=Jx({cx:r,cy:n,radius:a,angle:d,sign:-f,cornerRadius:s,cornerIsExternal:l}),T=l?Math.abs(u-d):Math.abs(u-d)-v-A;if(T<0)return o?As(IO||(IO=Hf(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),x.x,x.y,s,s,s*2,s,s,-s*2):M9({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:u,endAngle:d});var O=As(OO||(OO=Hf(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),x.x,x.y,s,s,+(f<0),p.x,p.y,a,a,+(T>180),+(f<0),w.x,w.y,s,s,+(f<0),C.x,C.y);if(i>0){var{circleTangency:D,lineTangency:M,theta:Q}=Jx({cx:r,cy:n,radius:i,angle:u,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:U,lineTangency:$,theta:ee}=Jx({cx:r,cy:n,radius:i,angle:d,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),F=l?Math.abs(u-d):Math.abs(u-d)-Q-ee;if(F<0&&s===0)return"".concat(O,"L").concat(r,",").concat(n,"Z");O+=As(kO||(kO=Hf(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),$.x,$.y,s,s,+(f<0),U.x,U.y,i,i,+(F>180),+(f>0),D.x,D.y,s,s,+(f<0),M.x,M.y)}else O+=As(DO||(DO=Hf(["L",",","Z"])),r,n);return O},Oce={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},L9=t=>{var r=ks(t,Oce),{cx:n,cy:i,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:u,startAngle:d,endAngle:f,className:p}=r;if(s<a||d===f)return null;var x=hi("recharts-sector",p),v=s-a,w=_l(o,v,0,!0),C;return w>0&&Math.abs(d-f)<360?C=Ice({cx:n,cy:i,innerRadius:a,outerRadius:s,cornerRadius:Math.min(w,v/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:d,endAngle:f}):C=M9({cx:n,cy:i,innerRadius:a,outerRadius:s,startAngle:d,endAngle:f}),k.createElement("path",TN({},Tl(r),{className:x,d:C}))};function kce(t,r,n){if(t==="horizontal")return[{x:r.x,y:n.top},{x:r.x,y:n.top+n.height}];if(t==="vertical")return[{x:n.left,y:r.y},{x:n.left+n.width,y:r.y}];if(pB(r)){if(t==="centric"){var{cx:i,cy:a,innerRadius:s,outerRadius:o,angle:l}=r,u=ro(i,a,s,l),d=ro(i,a,o,l);return[{x:u.x,y:u.y},{x:d.x,y:d.y}]}return R9(r)}}var Kw={},Qw={},Yw={},PO;function Dce(){return PO||(PO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=AB();function n(i){return r.isSymbol(i)?NaN:Number(i)}t.toNumber=n})(Yw)),Yw}var RO;function Pce(){return RO||(RO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=Dce();function n(i){return i?(i=r.toNumber(i),i===1/0||i===-1/0?(i<0?-1:1)*Number.MAX_VALUE:i===i?i:0):i===0?i:0}t.toFinite=n})(Qw)),Qw}var MO;function Rce(){return MO||(MO=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=EB(),n=Pce();function i(a,s,o){o&&typeof o!="number"&&r.isIterateeCall(a,s,o)&&(s=o=void 0),a=n.toFinite(a),s===void 0?(s=a,a=0):s=n.toFinite(s),o=o===void 0?a<s?1:-1:n.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),u=new Array(l);for(let d=0;d<l;d++)u[d]=a,a+=o;return u}t.range=i})(Kw)),Kw}var Zw,LO;function Mce(){return LO||(LO=1,Zw=Rce().range),Zw}var Lce=Mce();const z9=hc(Lce);function af(t,r){return t==null||r==null?NaN:t<r?-1:t>r?1:t>=r?0:NaN}function zce(t,r){return t==null||r==null?NaN:r<t?-1:r>t?1:r>=t?0:NaN}function vE(t){let r,n,i;t.length!==2?(r=af,n=(l,u)=>af(t(l),u),i=(l,u)=>t(l)-u):(r=t===af||t===zce?t:Bce,n=t,i=t);function a(l,u,d=0,f=l.length){if(d<f){if(r(u,u)!==0)return f;do{const p=d+f>>>1;n(l[p],u)<0?d=p+1:f=p}while(d<f)}return d}function s(l,u,d=0,f=l.length){if(d<f){if(r(u,u)!==0)return f;do{const p=d+f>>>1;n(l[p],u)<=0?d=p+1:f=p}while(d<f)}return d}function o(l,u,d=0,f=l.length){const p=a(l,u,d,f-1);return p>d&&i(l[p-1],u)>-i(l[p],u)?p-1:p}return{left:a,center:o,right:s}}function Bce(){return 0}function B9(t){return t===null?NaN:+t}function*Fce(t,r){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const qce=vE(af),Ay=qce.right;vE(B9).center;class zO extends Map{constructor(r,n=Hce){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),r!=null)for(const[i,a]of r)this.set(i,a)}get(r){return super.get(BO(this,r))}has(r){return super.has(BO(this,r))}set(r,n){return super.set(Uce(this,r),n)}delete(r){return super.delete(Wce(this,r))}}function BO({_intern:t,_key:r},n){const i=r(n);return t.has(i)?t.get(i):n}function Uce({_intern:t,_key:r},n){const i=r(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function Wce({_intern:t,_key:r},n){const i=r(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function Hce(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Vce(t=af){if(t===af)return F9;if(typeof t!="function")throw new TypeError("compare is not a function");return(r,n)=>{const i=t(r,n);return i||i===0?i:(t(n,n)===0)-(t(r,r)===0)}}function F9(t,r){return(t==null||!(t>=t))-(r==null||!(r>=r))||(t<r?-1:t>r?1:0)}const $ce=Math.sqrt(50),Gce=Math.sqrt(10),Kce=Math.sqrt(2);function mb(t,r,n){const i=(r-t)/Math.max(0,n),a=Math.floor(Math.log10(i)),s=i/Math.pow(10,a),o=s>=$ce?10:s>=Gce?5:s>=Kce?2:1;let l,u,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(t*d),u=Math.round(r*d),l/d<t&&++l,u/d>r&&--u,d=-d):(d=Math.pow(10,a)*o,l=Math.round(t/d),u=Math.round(r/d),l*d<t&&++l,u*d>r&&--u),u<l&&.5<=n&&n<2?mb(t,r,n*2):[l,u,d]}function IN(t,r,n){if(r=+r,t=+t,n=+n,!(n>0))return[];if(t===r)return[t];const i=r<t,[a,s,o]=i?mb(r,t,n):mb(t,r,n);if(!(s>=a))return[];const l=s-a+1,u=new Array(l);if(i)if(o<0)for(let d=0;d<l;++d)u[d]=(s-d)/-o;else for(let d=0;d<l;++d)u[d]=(s-d)*o;else if(o<0)for(let d=0;d<l;++d)u[d]=(a+d)/-o;else for(let d=0;d<l;++d)u[d]=(a+d)*o;return u}function ON(t,r,n){return r=+r,t=+t,n=+n,mb(t,r,n)[2]}function kN(t,r,n){r=+r,t=+t,n=+n;const i=r<t,a=i?ON(r,t,n):ON(t,r,n);return(i?-1:1)*(a<0?1/-a:a)}function FO(t,r){let n;for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function qO(t,r){let n;for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function q9(t,r,n=0,i=1/0,a){if(r=Math.floor(r),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(t.length-1,i)),!(n<=r&&r<=i))return t;for(a=a===void 0?F9:Vce(a);i>n;){if(i-n>600){const u=i-n+1,d=r-n+1,f=Math.log(u),p=.5*Math.exp(2*f/3),x=.5*Math.sqrt(f*p*(u-p)/u)*(d-u/2<0?-1:1),v=Math.max(n,Math.floor(r-d*p/u+x)),w=Math.min(i,Math.floor(r+(u-d)*p/u+x));q9(t,r,v,w,a)}const s=t[r];let o=n,l=i;for(ag(t,n,r),a(t[i],s)>0&&ag(t,n,i);o<l;){for(ag(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[n],s)===0?ag(t,n,l):(++l,ag(t,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}return t}function ag(t,r,n){const i=t[r];t[r]=t[n],t[n]=i}function Qce(t,r,n){if(t=Float64Array.from(Fce(t)),!(!(i=t.length)||isNaN(r=+r))){if(r<=0||i<2)return qO(t);if(r>=1)return FO(t);var i,a=(i-1)*r,s=Math.floor(a),o=FO(q9(t,s).subarray(0,s+1)),l=qO(t.subarray(s+1));return o+(l-o)*(a-s)}}function Yce(t,r,n=B9){if(!(!(i=t.length)||isNaN(r=+r))){if(r<=0||i<2)return+n(t[0],0,t);if(r>=1)return+n(t[i-1],i-1,t);var i,a=(i-1)*r,s=Math.floor(a),o=+n(t[s],s,t),l=+n(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function Zce(t,r,n){t=+t,r=+r,n=(a=arguments.length)<2?(r=t,t=0,1):a<3?1:+n;for(var i=-1,a=Math.max(0,Math.ceil((r-t)/n))|0,s=new Array(a);++i<a;)s[i]=t+i*n;return s}function dd(t,r){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(r).domain(t);break}return this}function xh(t,r){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const DN=Symbol("implicit");function bE(){var t=new zO,r=[],n=[],i=DN;function a(s){let o=t.get(s);if(o===void 0){if(i!==DN)return i;t.set(s,o=r.push(s)-1)}return n[o%n.length]}return a.domain=function(s){if(!arguments.length)return r.slice();r=[],t=new zO;for(const o of s)t.has(o)||t.set(o,r.push(o)-1);return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return bE(r,n).unknown(i)},dd.apply(a,arguments),a}function jE(){var t=bE().unknown(void 0),r=t.domain,n=t.range,i=0,a=1,s,o,l=!1,u=0,d=0,f=.5;delete t.unknown;function p(){var x=r().length,v=a<i,w=v?a:i,C=v?i:a;s=(C-w)/Math.max(1,x-u+d*2),l&&(s=Math.floor(s)),w+=(C-w-s*(x-u))*f,o=s*(1-u),l&&(w=Math.round(w),o=Math.round(o));var A=Zce(x).map(function(T){return w+s*T});return n(v?A.reverse():A)}return t.domain=function(x){return arguments.length?(r(x),p()):r()},t.range=function(x){return arguments.length?([i,a]=x,i=+i,a=+a,p()):[i,a]},t.rangeRound=function(x){return[i,a]=x,i=+i,a=+a,l=!0,p()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(x){return arguments.length?(l=!!x,p()):l},t.padding=function(x){return arguments.length?(u=Math.min(1,d=+x),p()):u},t.paddingInner=function(x){return arguments.length?(u=Math.min(1,x),p()):u},t.paddingOuter=function(x){return arguments.length?(d=+x,p()):d},t.align=function(x){return arguments.length?(f=Math.max(0,Math.min(1,x)),p()):f},t.copy=function(){return jE(r(),[i,a]).round(l).paddingInner(u).paddingOuter(d).align(f)},dd.apply(p(),arguments)}function U9(t){var r=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return U9(r())},t}function Xce(){return U9(jE.apply(null,arguments).paddingInner(1))}function wE(t,r,n){t.prototype=r.prototype=n,n.constructor=t}function W9(t,r){var n=Object.create(t.prototype);for(var i in r)n[i]=r[i];return n}function Ey(){}var Zg=.7,pb=1/Zg,_p="\\s*([+-]?\\d+)\\s*",Xg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",du="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jce=/^#([0-9a-f]{3,8})$/,ede=new RegExp(`^rgb\\(${_p},${_p},${_p}\\)$`),tde=new RegExp(`^rgb\\(${du},${du},${du}\\)$`),rde=new RegExp(`^rgba\\(${_p},${_p},${_p},${Xg}\\)$`),nde=new RegExp(`^rgba\\(${du},${du},${du},${Xg}\\)$`),ide=new RegExp(`^hsl\\(${Xg},${du},${du}\\)$`),ade=new RegExp(`^hsla\\(${Xg},${du},${du},${Xg}\\)$`),UO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wE(Ey,Jg,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:WO,formatHex:WO,formatHex8:sde,formatHsl:ode,formatRgb:HO,toString:HO});function WO(){return this.rgb().formatHex()}function sde(){return this.rgb().formatHex8()}function ode(){return H9(this).formatHsl()}function HO(){return this.rgb().formatRgb()}function Jg(t){var r,n;return t=(t+"").trim().toLowerCase(),(r=Jce.exec(t))?(n=r[1].length,r=parseInt(r[1],16),n===6?VO(r):n===3?new ac(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):n===8?e1(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):n===4?e1(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=ede.exec(t))?new ac(r[1],r[2],r[3],1):(r=tde.exec(t))?new ac(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=rde.exec(t))?e1(r[1],r[2],r[3],r[4]):(r=nde.exec(t))?e1(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=ide.exec(t))?KO(r[1],r[2]/100,r[3]/100,1):(r=ade.exec(t))?KO(r[1],r[2]/100,r[3]/100,r[4]):UO.hasOwnProperty(t)?VO(UO[t]):t==="transparent"?new ac(NaN,NaN,NaN,0):null}function VO(t){return new ac(t>>16&255,t>>8&255,t&255,1)}function e1(t,r,n,i){return i<=0&&(t=r=n=NaN),new ac(t,r,n,i)}function lde(t){return t instanceof Ey||(t=Jg(t)),t?(t=t.rgb(),new ac(t.r,t.g,t.b,t.opacity)):new ac}function PN(t,r,n,i){return arguments.length===1?lde(t):new ac(t,r,n,i??1)}function ac(t,r,n,i){this.r=+t,this.g=+r,this.b=+n,this.opacity=+i}wE(ac,PN,W9(Ey,{brighter(t){return t=t==null?pb:Math.pow(pb,t),new ac(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Zg:Math.pow(Zg,t),new ac(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ac(Xf(this.r),Xf(this.g),Xf(this.b),gb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$O,formatHex:$O,formatHex8:cde,formatRgb:GO,toString:GO}));function $O(){return`#${Vf(this.r)}${Vf(this.g)}${Vf(this.b)}`}function cde(){return`#${Vf(this.r)}${Vf(this.g)}${Vf(this.b)}${Vf((isNaN(this.opacity)?1:this.opacity)*255)}`}function GO(){const t=gb(this.opacity);return`${t===1?"rgb(":"rgba("}${Xf(this.r)}, ${Xf(this.g)}, ${Xf(this.b)}${t===1?")":`, ${t})`}`}function gb(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Xf(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Vf(t){return t=Xf(t),(t<16?"0":"")+t.toString(16)}function KO(t,r,n,i){return i<=0?t=r=n=NaN:n<=0||n>=1?t=r=NaN:r<=0&&(t=NaN),new Cd(t,r,n,i)}function H9(t){if(t instanceof Cd)return new Cd(t.h,t.s,t.l,t.opacity);if(t instanceof Ey||(t=Jg(t)),!t)return new Cd;if(t instanceof Cd)return t;t=t.rgb();var r=t.r/255,n=t.g/255,i=t.b/255,a=Math.min(r,n,i),s=Math.max(r,n,i),o=NaN,l=s-a,u=(s+a)/2;return l?(r===s?o=(n-i)/l+(n<i)*6:n===s?o=(i-r)/l+2:o=(r-n)/l+4,l/=u<.5?s+a:2-s-a,o*=60):l=u>0&&u<1?0:o,new Cd(o,l,u,t.opacity)}function dde(t,r,n,i){return arguments.length===1?H9(t):new Cd(t,r,n,i??1)}function Cd(t,r,n,i){this.h=+t,this.s=+r,this.l=+n,this.opacity=+i}wE(Cd,dde,W9(Ey,{brighter(t){return t=t==null?pb:Math.pow(pb,t),new Cd(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Zg:Math.pow(Zg,t),new Cd(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,r=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*r,a=2*n-i;return new ac(Xw(t>=240?t-240:t+120,a,i),Xw(t,a,i),Xw(t<120?t+240:t-120,a,i),this.opacity)},clamp(){return new Cd(QO(this.h),t1(this.s),t1(this.l),gb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=gb(this.opacity);return`${t===1?"hsl(":"hsla("}${QO(this.h)}, ${t1(this.s)*100}%, ${t1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function QO(t){return t=(t||0)%360,t<0?t+360:t}function t1(t){return Math.max(0,Math.min(1,t||0))}function Xw(t,r,n){return(t<60?r+(n-r)*t/60:t<180?n:t<240?r+(n-r)*(240-t)/60:r)*255}const SE=t=>()=>t;function ude(t,r){return function(n){return t+n*r}}function hde(t,r,n){return t=Math.pow(t,n),r=Math.pow(r,n)-t,n=1/n,function(i){return Math.pow(t+i*r,n)}}function fde(t){return(t=+t)==1?V9:function(r,n){return n-r?hde(r,n,t):SE(isNaN(r)?n:r)}}function V9(t,r){var n=r-t;return n?ude(t,n):SE(isNaN(t)?r:t)}const YO=(function t(r){var n=fde(r);function i(a,s){var o=n((a=PN(a)).r,(s=PN(s)).r),l=n(a.g,s.g),u=n(a.b,s.b),d=V9(a.opacity,s.opacity);return function(f){return a.r=o(f),a.g=l(f),a.b=u(f),a.opacity=d(f),a+""}}return i.gamma=t,i})(1);function mde(t,r){r||(r=[]);var n=t?Math.min(r.length,t.length):0,i=r.slice(),a;return function(s){for(a=0;a<n;++a)i[a]=t[a]*(1-s)+r[a]*s;return i}}function pde(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function gde(t,r){var n=r?r.length:0,i=t?Math.min(n,t.length):0,a=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)a[o]=c0(t[o],r[o]);for(;o<n;++o)s[o]=r[o];return function(l){for(o=0;o<i;++o)s[o]=a[o](l);return s}}function yde(t,r){var n=new Date;return t=+t,r=+r,function(i){return n.setTime(t*(1-i)+r*i),n}}function yb(t,r){return t=+t,r=+r,function(n){return t*(1-n)+r*n}}function xde(t,r){var n={},i={},a;(t===null||typeof t!="object")&&(t={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in t?n[a]=c0(t[a],r[a]):i[a]=r[a];return function(s){for(a in n)i[a]=n[a](s);return i}}var RN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jw=new RegExp(RN.source,"g");function vde(t){return function(){return t}}function bde(t){return function(r){return t(r)+""}}function jde(t,r){var n=RN.lastIndex=Jw.lastIndex=0,i,a,s,o=-1,l=[],u=[];for(t=t+"",r=r+"";(i=RN.exec(t))&&(a=Jw.exec(r));)(s=a.index)>n&&(s=r.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(i=i[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,u.push({i:o,x:yb(i,a)})),n=Jw.lastIndex;return n<r.length&&(s=r.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?u[0]?bde(u[0].x):vde(r):(r=u.length,function(d){for(var f=0,p;f<r;++f)l[(p=u[f]).i]=p.x(d);return l.join("")})}function c0(t,r){var n=typeof r,i;return r==null||n==="boolean"?SE(r):(n==="number"?yb:n==="string"?(i=Jg(r))?(r=i,YO):jde:r instanceof Jg?YO:r instanceof Date?yde:pde(r)?mde:Array.isArray(r)?gde:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?xde:yb)(t,r)}function CE(t,r){return t=+t,r=+r,function(n){return Math.round(t*(1-n)+r*n)}}function wde(t,r){r===void 0&&(r=t,t=c0);for(var n=0,i=r.length-1,a=r[0],s=new Array(i<0?0:i);n<i;)s[n]=t(a,a=r[++n]);return function(o){var l=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[l](o-l)}}function Sde(t){return function(){return t}}function xb(t){return+t}var ZO=[0,1];function ql(t){return t}function MN(t,r){return(r-=t=+t)?function(n){return(n-t)/r}:Sde(isNaN(r)?NaN:.5)}function Cde(t,r){var n;return t>r&&(n=t,t=r,r=n),function(i){return Math.max(t,Math.min(r,i))}}function Nde(t,r,n){var i=t[0],a=t[1],s=r[0],o=r[1];return a<i?(i=MN(a,i),s=n(o,s)):(i=MN(i,a),s=n(s,o)),function(l){return s(i(l))}}function Ade(t,r,n){var i=Math.min(t.length,r.length)-1,a=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),r=r.slice().reverse());++o<i;)a[o]=MN(t[o],t[o+1]),s[o]=n(r[o],r[o+1]);return function(l){var u=Ay(t,l,1,i)-1;return s[u](a[u](l))}}function _y(t,r){return r.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function E2(){var t=ZO,r=ZO,n=c0,i,a,s,o=ql,l,u,d;function f(){var x=Math.min(t.length,r.length);return o!==ql&&(o=Cde(t[0],t[x-1])),l=x>2?Ade:Nde,u=d=null,p}function p(x){return x==null||isNaN(x=+x)?s:(u||(u=l(t.map(i),r,n)))(i(o(x)))}return p.invert=function(x){return o(a((d||(d=l(r,t.map(i),yb)))(x)))},p.domain=function(x){return arguments.length?(t=Array.from(x,xb),f()):t.slice()},p.range=function(x){return arguments.length?(r=Array.from(x),f()):r.slice()},p.rangeRound=function(x){return r=Array.from(x),n=CE,f()},p.clamp=function(x){return arguments.length?(o=x?!0:ql,f()):o!==ql},p.interpolate=function(x){return arguments.length?(n=x,f()):n},p.unknown=function(x){return arguments.length?(s=x,p):s},function(x,v){return i=x,a=v,f()}}function NE(){return E2()(ql,ql)}function Ede(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function vb(t,r){if(!isFinite(t)||t===0)return null;var n=(t=r?t.toExponential(r-1):t.toExponential()).indexOf("e"),i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Up(t){return t=vb(Math.abs(t)),t?t[1]:NaN}function _de(t,r){return function(n,i){for(var a=n.length,s=[],o=0,l=t[0],u=0;a>0&&l>0&&(u+l+1>i&&(l=Math.max(1,i-u)),s.push(n.substring(a-=l,a+l)),!((u+=l+1)>i));)l=t[o=(o+1)%t.length];return s.reverse().join(r)}}function Tde(t){return function(r){return r.replace(/[0-9]/g,function(n){return t[+n]})}}var Ide=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ey(t){if(!(r=Ide.exec(t)))throw new Error("invalid format: "+t);var r;return new AE({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}ey.prototype=AE.prototype;function AE(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}AE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ode(t){e:for(var r=t.length,n=1,i=-1,a;n<r;++n)switch(t[n]){case".":i=a=n;break;case"0":i===0&&(i=n),a=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(a+1):t}var bb;function kde(t,r){var n=vb(t,r);if(!n)return bb=void 0,t.toPrecision(r);var i=n[0],a=n[1],s=a-(bb=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+vb(t,Math.max(0,r+s-1))[0]}function XO(t,r){var n=vb(t,r);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}const JO={"%":(t,r)=>(t*100).toFixed(r),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ede,e:(t,r)=>t.toExponential(r),f:(t,r)=>t.toFixed(r),g:(t,r)=>t.toPrecision(r),o:t=>Math.round(t).toString(8),p:(t,r)=>XO(t*100,r),r:XO,s:kde,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ek(t){return t}var tk=Array.prototype.map,rk=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Dde(t){var r=t.grouping===void 0||t.thousands===void 0?ek:_de(tk.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?ek:Tde(tk.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function d(p,x){p=ey(p);var v=p.fill,w=p.align,C=p.sign,A=p.symbol,T=p.zero,O=p.width,D=p.comma,M=p.precision,Q=p.trim,U=p.type;U==="n"?(D=!0,U="g"):JO[U]||(M===void 0&&(M=12),Q=!0,U="g"),(T||v==="0"&&w==="=")&&(T=!0,v="0",w="=");var $=(x&&x.prefix!==void 0?x.prefix:"")+(A==="$"?n:A==="#"&&/[boxX]/.test(U)?"0"+U.toLowerCase():""),ee=(A==="$"?i:/[%p]/.test(U)?o:"")+(x&&x.suffix!==void 0?x.suffix:""),F=JO[U],Y=/[defgprs%]/.test(U);M=M===void 0?6:/[gprs]/.test(U)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function J(Z){var re=$,de=ee,le,K,ue;if(U==="c")de=F(Z)+de,Z="";else{Z=+Z;var ce=Z<0||1/Z<0;if(Z=isNaN(Z)?u:F(Math.abs(Z),M),Q&&(Z=Ode(Z)),ce&&+Z==0&&C!=="+"&&(ce=!1),re=(ce?C==="("?C:l:C==="-"||C==="("?"":C)+re,de=(U==="s"&&!isNaN(Z)&&bb!==void 0?rk[8+bb/3]:"")+de+(ce&&C==="("?")":""),Y){for(le=-1,K=Z.length;++le<K;)if(ue=Z.charCodeAt(le),48>ue||ue>57){de=(ue===46?a+Z.slice(le+1):Z.slice(le))+de,Z=Z.slice(0,le);break}}}D&&!T&&(Z=r(Z,1/0));var ye=re.length+Z.length+de.length,Se=ye<O?new Array(O-ye+1).join(v):"";switch(D&&T&&(Z=r(Se+Z,Se.length?O-de.length:1/0),Se=""),w){case"<":Z=re+Z+de+Se;break;case"=":Z=re+Se+Z+de;break;case"^":Z=Se.slice(0,ye=Se.length>>1)+re+Z+de+Se.slice(ye);break;default:Z=Se+re+Z+de;break}return s(Z)}return J.toString=function(){return p+""},J}function f(p,x){var v=Math.max(-8,Math.min(8,Math.floor(Up(x)/3)))*3,w=Math.pow(10,-v),C=d((p=ey(p),p.type="f",p),{suffix:rk[8+v/3]});return function(A){return C(w*A)}}return{format:d,formatPrefix:f}}var r1,EE,$9;Pde({thousands:",",grouping:[3],currency:["$",""]});function Pde(t){return r1=Dde(t),EE=r1.format,$9=r1.formatPrefix,r1}function Rde(t){return Math.max(0,-Up(Math.abs(t)))}function Mde(t,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Up(r)/3)))*3-Up(Math.abs(t)))}function Lde(t,r){return t=Math.abs(t),r=Math.abs(r)-t,Math.max(0,Up(r)-Up(t))+1}function G9(t,r,n,i){var a=kN(t,r,n),s;switch(i=ey(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(r));return i.precision==null&&!isNaN(s=Mde(a,o))&&(i.precision=s),$9(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=Lde(a,Math.max(Math.abs(t),Math.abs(r))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=Rde(a))&&(i.precision=s-(i.type==="%")*2);break}}return EE(i)}function yf(t){var r=t.domain;return t.ticks=function(n){var i=r();return IN(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var a=r();return G9(a[0],a[a.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=r(),a=0,s=i.length-1,o=i[a],l=i[s],u,d,f=10;for(l<o&&(d=o,o=l,l=d,d=a,a=s,s=d);f-- >0;){if(d=ON(o,l,n),d===u)return i[a]=o,i[s]=l,r(i);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;u=d}return t},t}function K9(){var t=NE();return t.copy=function(){return _y(t,K9())},dd.apply(t,arguments),yf(t)}function Q9(t){var r;function n(i){return i==null||isNaN(i=+i)?r:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(t=Array.from(i,xb),n):t.slice()},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return Q9(t).unknown(r)},t=arguments.length?Array.from(t,xb):[0,1],yf(n)}function Y9(t,r){t=t.slice();var n=0,i=t.length-1,a=t[n],s=t[i],o;return s<a&&(o=n,n=i,i=o,o=a,a=s,s=o),t[n]=r.floor(a),t[i]=r.ceil(s),t}function nk(t){return Math.log(t)}function ik(t){return Math.exp(t)}function zde(t){return-Math.log(-t)}function Bde(t){return-Math.exp(-t)}function Fde(t){return isFinite(t)?+("1e"+t):t<0?0:t}function qde(t){return t===10?Fde:t===Math.E?Math.exp:r=>Math.pow(t,r)}function Ude(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),r=>Math.log(r)/t)}function ak(t){return(r,n)=>-t(-r,n)}function _E(t){const r=t(nk,ik),n=r.domain;let i=10,a,s;function o(){return a=Ude(i),s=qde(i),n()[0]<0?(a=ak(a),s=ak(s),t(zde,Bde)):t(nk,ik),r}return r.base=function(l){return arguments.length?(i=+l,o()):i},r.domain=function(l){return arguments.length?(n(l),o()):n()},r.ticks=l=>{const u=n();let d=u[0],f=u[u.length-1];const p=f<d;p&&([d,f]=[f,d]);let x=a(d),v=a(f),w,C;const A=l==null?10:+l;let T=[];if(!(i%1)&&v-x<A){if(x=Math.floor(x),v=Math.ceil(v),d>0){for(;x<=v;++x)for(w=1;w<i;++w)if(C=x<0?w/s(-x):w*s(x),!(C<d)){if(C>f)break;T.push(C)}}else for(;x<=v;++x)for(w=i-1;w>=1;--w)if(C=x>0?w/s(-x):w*s(x),!(C<d)){if(C>f)break;T.push(C)}T.length*2<A&&(T=IN(d,f,A))}else T=IN(x,v,Math.min(v-x,A)).map(s);return p?T.reverse():T},r.tickFormat=(l,u)=>{if(l==null&&(l=10),u==null&&(u=i===10?"s":","),typeof u!="function"&&(!(i%1)&&(u=ey(u)).precision==null&&(u.trim=!0),u=EE(u)),l===1/0)return u;const d=Math.max(1,i*l/r.ticks().length);return f=>{let p=f/s(Math.round(a(f)));return p*i<i-.5&&(p*=i),p<=d?u(f):""}},r.nice=()=>n(Y9(n(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),r}function Z9(){const t=_E(E2()).domain([1,10]);return t.copy=()=>_y(t,Z9()).base(t.base()),dd.apply(t,arguments),t}function sk(t){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/t))}}function ok(t){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*t}}function TE(t){var r=1,n=t(sk(r),ok(r));return n.constant=function(i){return arguments.length?t(sk(r=+i),ok(r)):r},yf(n)}function X9(){var t=TE(E2());return t.copy=function(){return _y(t,X9()).constant(t.constant())},dd.apply(t,arguments)}function lk(t){return function(r){return r<0?-Math.pow(-r,t):Math.pow(r,t)}}function Wde(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Hde(t){return t<0?-t*t:t*t}function IE(t){var r=t(ql,ql),n=1;function i(){return n===1?t(ql,ql):n===.5?t(Wde,Hde):t(lk(n),lk(1/n))}return r.exponent=function(a){return arguments.length?(n=+a,i()):n},yf(r)}function OE(){var t=IE(E2());return t.copy=function(){return _y(t,OE()).exponent(t.exponent())},dd.apply(t,arguments),t}function Vde(){return OE.apply(null,arguments).exponent(.5)}function ck(t){return Math.sign(t)*t*t}function $de(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function J9(){var t=NE(),r=[0,1],n=!1,i;function a(s){var o=$de(t(s));return isNaN(o)?i:n?Math.round(o):o}return a.invert=function(s){return t.invert(ck(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((r=Array.from(s,xb)).map(ck)),a):r.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(n=!!s,a):n},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return J9(t.domain(),r).round(n).clamp(t.clamp()).unknown(i)},dd.apply(a,arguments),yf(a)}function eF(){var t=[],r=[],n=[],i;function a(){var o=0,l=Math.max(1,r.length);for(n=new Array(l-1);++o<l;)n[o-1]=Yce(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?i:r[Ay(n,o)]}return s.invertExtent=function(o){var l=r.indexOf(o);return l<0?[NaN,NaN]:[l>0?n[l-1]:t[0],l<n.length?n[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(af),a()},s.range=function(o){return arguments.length?(r=Array.from(o),a()):r.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return eF().domain(t).range(r).unknown(i)},dd.apply(s,arguments)}function tF(){var t=0,r=1,n=1,i=[.5],a=[0,1],s;function o(u){return u!=null&&u<=u?a[Ay(i,u,0,n)]:s}function l(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*r-(u-n)*t)/(n+1);return o}return o.domain=function(u){return arguments.length?([t,r]=u,t=+t,r=+r,l()):[t,r]},o.range=function(u){return arguments.length?(n=(a=Array.from(u)).length-1,l()):a.slice()},o.invertExtent=function(u){var d=a.indexOf(u);return d<0?[NaN,NaN]:d<1?[t,i[0]]:d>=n?[i[n-1],r]:[i[d-1],i[d]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return i.slice()},o.copy=function(){return tF().domain([t,r]).range(a).unknown(s)},dd.apply(yf(o),arguments)}function rF(){var t=[.5],r=[0,1],n,i=1;function a(s){return s!=null&&s<=s?r[Ay(t,s,0,i)]:n}return a.domain=function(s){return arguments.length?(t=Array.from(s),i=Math.min(t.length,r.length-1),a):t.slice()},a.range=function(s){return arguments.length?(r=Array.from(s),i=Math.min(t.length,r.length-1),a):r.slice()},a.invertExtent=function(s){var o=r.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return rF().domain(t).range(r).unknown(n)},dd.apply(a,arguments)}const eS=new Date,tS=new Date;function wo(t,r,n,i){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),r(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(r(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const u=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return u;let d;do u.push(d=new Date(+s)),r(s,l),t(s);while(d<s&&s<o);return u},a.filter=s=>wo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;r(o,-1),!s(o););else for(;--l>=0;)for(;r(o,1),!s(o););}),n&&(a.count=(s,o)=>(eS.setTime(+s),tS.setTime(+o),t(eS),t(tS),Math.floor(n(eS,tS))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(i?o=>i(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const jb=wo(()=>{},(t,r)=>{t.setTime(+t+r)},(t,r)=>r-t);jb.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?wo(r=>{r.setTime(Math.floor(r/t)*t)},(r,n)=>{r.setTime(+r+n*t)},(r,n)=>(n-r)/t):jb);jb.range;const Gu=1e3,ed=Gu*60,Ku=ed*60,ch=Ku*24,kE=ch*7,dk=ch*30,rS=ch*365,$f=wo(t=>{t.setTime(t-t.getMilliseconds())},(t,r)=>{t.setTime(+t+r*Gu)},(t,r)=>(r-t)/Gu,t=>t.getUTCSeconds());$f.range;const DE=wo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Gu)},(t,r)=>{t.setTime(+t+r*ed)},(t,r)=>(r-t)/ed,t=>t.getMinutes());DE.range;const PE=wo(t=>{t.setUTCSeconds(0,0)},(t,r)=>{t.setTime(+t+r*ed)},(t,r)=>(r-t)/ed,t=>t.getUTCMinutes());PE.range;const RE=wo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Gu-t.getMinutes()*ed)},(t,r)=>{t.setTime(+t+r*Ku)},(t,r)=>(r-t)/Ku,t=>t.getHours());RE.range;const ME=wo(t=>{t.setUTCMinutes(0,0,0)},(t,r)=>{t.setTime(+t+r*Ku)},(t,r)=>(r-t)/Ku,t=>t.getUTCHours());ME.range;const Ty=wo(t=>t.setHours(0,0,0,0),(t,r)=>t.setDate(t.getDate()+r),(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ed)/ch,t=>t.getDate()-1);Ty.range;const _2=wo(t=>{t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r)},(t,r)=>(r-t)/ch,t=>t.getUTCDate()-1);_2.range;const nF=wo(t=>{t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r)},(t,r)=>(r-t)/ch,t=>Math.floor(t/ch));nF.range;function Cm(t){return wo(r=>{r.setDate(r.getDate()-(r.getDay()+7-t)%7),r.setHours(0,0,0,0)},(r,n)=>{r.setDate(r.getDate()+n*7)},(r,n)=>(n-r-(n.getTimezoneOffset()-r.getTimezoneOffset())*ed)/kE)}const T2=Cm(0),wb=Cm(1),Gde=Cm(2),Kde=Cm(3),Wp=Cm(4),Qde=Cm(5),Yde=Cm(6);T2.range;wb.range;Gde.range;Kde.range;Wp.range;Qde.range;Yde.range;function Nm(t){return wo(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-t)%7),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCDate(r.getUTCDate()+n*7)},(r,n)=>(n-r)/kE)}const I2=Nm(0),Sb=Nm(1),Zde=Nm(2),Xde=Nm(3),Hp=Nm(4),Jde=Nm(5),eue=Nm(6);I2.range;Sb.range;Zde.range;Xde.range;Hp.range;Jde.range;eue.range;const LE=wo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,r)=>{t.setMonth(t.getMonth()+r)},(t,r)=>r.getMonth()-t.getMonth()+(r.getFullYear()-t.getFullYear())*12,t=>t.getMonth());LE.range;const zE=wo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCMonth(t.getUTCMonth()+r)},(t,r)=>r.getUTCMonth()-t.getUTCMonth()+(r.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());zE.range;const dh=wo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r)},(t,r)=>r.getFullYear()-t.getFullYear(),t=>t.getFullYear());dh.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:wo(r=>{r.setFullYear(Math.floor(r.getFullYear()/t)*t),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,n)=>{r.setFullYear(r.getFullYear()+n*t)});dh.range;const uh=wo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r)},(t,r)=>r.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());uh.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:wo(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/t)*t),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCFullYear(r.getUTCFullYear()+n*t)});uh.range;function iF(t,r,n,i,a,s){const o=[[$f,1,Gu],[$f,5,5*Gu],[$f,15,15*Gu],[$f,30,30*Gu],[s,1,ed],[s,5,5*ed],[s,15,15*ed],[s,30,30*ed],[a,1,Ku],[a,3,3*Ku],[a,6,6*Ku],[a,12,12*Ku],[i,1,ch],[i,2,2*ch],[n,1,kE],[r,1,dk],[r,3,3*dk],[t,1,rS]];function l(d,f,p){const x=f<d;x&&([d,f]=[f,d]);const v=p&&typeof p.range=="function"?p:u(d,f,p),w=v?v.range(d,+f+1):[];return x?w.reverse():w}function u(d,f,p){const x=Math.abs(f-d)/p,v=vE(([,,A])=>A).right(o,x);if(v===o.length)return t.every(kN(d/rS,f/rS,p));if(v===0)return jb.every(Math.max(kN(d,f,p),1));const[w,C]=o[x/o[v-1][2]<o[v][2]/x?v-1:v];return w.every(C)}return[l,u]}const[tue,rue]=iF(uh,zE,I2,nF,ME,PE),[nue,iue]=iF(dh,LE,T2,Ty,RE,DE);function nS(t){if(0<=t.y&&t.y<100){var r=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return r.setFullYear(t.y),r}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function iS(t){if(0<=t.y&&t.y<100){var r=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return r.setUTCFullYear(t.y),r}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function sg(t,r,n){return{y:t,m:r,d:n,H:0,M:0,S:0,L:0}}function aue(t){var r=t.dateTime,n=t.date,i=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,u=t.shortMonths,d=og(a),f=lg(a),p=og(s),x=lg(s),v=og(o),w=lg(o),C=og(l),A=lg(l),T=og(u),O=lg(u),D={a:ue,A:ce,b:ye,B:Se,c:null,d:gk,e:gk,f:_ue,g:zue,G:Fue,H:Nue,I:Aue,j:Eue,L:aF,m:Tue,M:Iue,p:V,q:X,Q:vk,s:bk,S:Oue,u:kue,U:Due,V:Pue,w:Rue,W:Mue,x:null,X:null,y:Lue,Y:Bue,Z:que,"%":xk},M={a:se,A:W,b:oe,B:ge,c:null,d:yk,e:yk,f:Vue,g:the,G:nhe,H:Uue,I:Wue,j:Hue,L:oF,m:$ue,M:Gue,p:be,q:Le,Q:vk,s:bk,S:Kue,u:Que,U:Yue,V:Zue,w:Xue,W:Jue,x:null,X:null,y:ehe,Y:rhe,Z:ihe,"%":xk},Q={a:Y,A:J,b:Z,B:re,c:de,d:mk,e:mk,f:jue,g:fk,G:hk,H:pk,I:pk,j:yue,L:bue,m:gue,M:xue,p:F,q:pue,Q:Sue,s:Cue,S:vue,u:due,U:uue,V:hue,w:cue,W:fue,x:le,X:K,y:fk,Y:hk,Z:mue,"%":wue};D.x=U(n,D),D.X=U(i,D),D.c=U(r,D),M.x=U(n,M),M.X=U(i,M),M.c=U(r,M);function U(ke,He){return function(Je){var Qe=[],vt=-1,Pt=0,Oe=ke.length,st,Wt,Bt;for(Je instanceof Date||(Je=new Date(+Je));++vt<Oe;)ke.charCodeAt(vt)===37&&(Qe.push(ke.slice(Pt,vt)),(Wt=uk[st=ke.charAt(++vt)])!=null?st=ke.charAt(++vt):Wt=st==="e"?" ":"0",(Bt=He[st])&&(st=Bt(Je,Wt)),Qe.push(st),Pt=vt+1);return Qe.push(ke.slice(Pt,vt)),Qe.join("")}}function $(ke,He){return function(Je){var Qe=sg(1900,void 0,1),vt=ee(Qe,ke,Je+="",0),Pt,Oe;if(vt!=Je.length)return null;if("Q"in Qe)return new Date(Qe.Q);if("s"in Qe)return new Date(Qe.s*1e3+("L"in Qe?Qe.L:0));if(He&&!("Z"in Qe)&&(Qe.Z=0),"p"in Qe&&(Qe.H=Qe.H%12+Qe.p*12),Qe.m===void 0&&(Qe.m="q"in Qe?Qe.q:0),"V"in Qe){if(Qe.V<1||Qe.V>53)return null;"w"in Qe||(Qe.w=1),"Z"in Qe?(Pt=iS(sg(Qe.y,0,1)),Oe=Pt.getUTCDay(),Pt=Oe>4||Oe===0?Sb.ceil(Pt):Sb(Pt),Pt=_2.offset(Pt,(Qe.V-1)*7),Qe.y=Pt.getUTCFullYear(),Qe.m=Pt.getUTCMonth(),Qe.d=Pt.getUTCDate()+(Qe.w+6)%7):(Pt=nS(sg(Qe.y,0,1)),Oe=Pt.getDay(),Pt=Oe>4||Oe===0?wb.ceil(Pt):wb(Pt),Pt=Ty.offset(Pt,(Qe.V-1)*7),Qe.y=Pt.getFullYear(),Qe.m=Pt.getMonth(),Qe.d=Pt.getDate()+(Qe.w+6)%7)}else("W"in Qe||"U"in Qe)&&("w"in Qe||(Qe.w="u"in Qe?Qe.u%7:"W"in Qe?1:0),Oe="Z"in Qe?iS(sg(Qe.y,0,1)).getUTCDay():nS(sg(Qe.y,0,1)).getDay(),Qe.m=0,Qe.d="W"in Qe?(Qe.w+6)%7+Qe.W*7-(Oe+5)%7:Qe.w+Qe.U*7-(Oe+6)%7);return"Z"in Qe?(Qe.H+=Qe.Z/100|0,Qe.M+=Qe.Z%100,iS(Qe)):nS(Qe)}}function ee(ke,He,Je,Qe){for(var vt=0,Pt=He.length,Oe=Je.length,st,Wt;vt<Pt;){if(Qe>=Oe)return-1;if(st=He.charCodeAt(vt++),st===37){if(st=He.charAt(vt++),Wt=Q[st in uk?He.charAt(vt++):st],!Wt||(Qe=Wt(ke,Je,Qe))<0)return-1}else if(st!=Je.charCodeAt(Qe++))return-1}return Qe}function F(ke,He,Je){var Qe=d.exec(He.slice(Je));return Qe?(ke.p=f.get(Qe[0].toLowerCase()),Je+Qe[0].length):-1}function Y(ke,He,Je){var Qe=v.exec(He.slice(Je));return Qe?(ke.w=w.get(Qe[0].toLowerCase()),Je+Qe[0].length):-1}function J(ke,He,Je){var Qe=p.exec(He.slice(Je));return Qe?(ke.w=x.get(Qe[0].toLowerCase()),Je+Qe[0].length):-1}function Z(ke,He,Je){var Qe=T.exec(He.slice(Je));return Qe?(ke.m=O.get(Qe[0].toLowerCase()),Je+Qe[0].length):-1}function re(ke,He,Je){var Qe=C.exec(He.slice(Je));return Qe?(ke.m=A.get(Qe[0].toLowerCase()),Je+Qe[0].length):-1}function de(ke,He,Je){return ee(ke,r,He,Je)}function le(ke,He,Je){return ee(ke,n,He,Je)}function K(ke,He,Je){return ee(ke,i,He,Je)}function ue(ke){return o[ke.getDay()]}function ce(ke){return s[ke.getDay()]}function ye(ke){return u[ke.getMonth()]}function Se(ke){return l[ke.getMonth()]}function V(ke){return a[+(ke.getHours()>=12)]}function X(ke){return 1+~~(ke.getMonth()/3)}function se(ke){return o[ke.getUTCDay()]}function W(ke){return s[ke.getUTCDay()]}function oe(ke){return u[ke.getUTCMonth()]}function ge(ke){return l[ke.getUTCMonth()]}function be(ke){return a[+(ke.getUTCHours()>=12)]}function Le(ke){return 1+~~(ke.getUTCMonth()/3)}return{format:function(ke){var He=U(ke+="",D);return He.toString=function(){return ke},He},parse:function(ke){var He=$(ke+="",!1);return He.toString=function(){return ke},He},utcFormat:function(ke){var He=U(ke+="",M);return He.toString=function(){return ke},He},utcParse:function(ke){var He=$(ke+="",!0);return He.toString=function(){return ke},He}}}var uk={"-":"",_:" ",0:"0"},Vo=/^\s*\d+/,sue=/^%/,oue=/[\\^$*+?|[\]().{}]/g;function xi(t,r,n){var i=t<0?"-":"",a=(i?-t:t)+"",s=a.length;return i+(s<n?new Array(n-s+1).join(r)+a:a)}function lue(t){return t.replace(oue,"\\$&")}function og(t){return new RegExp("^(?:"+t.map(lue).join("|")+")","i")}function lg(t){return new Map(t.map((r,n)=>[r.toLowerCase(),n]))}function cue(t,r,n){var i=Vo.exec(r.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function due(t,r,n){var i=Vo.exec(r.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function uue(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function hue(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function fue(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function hk(t,r,n){var i=Vo.exec(r.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function fk(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function mue(t,r,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function pue(t,r,n){var i=Vo.exec(r.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function gue(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function mk(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function yue(t,r,n){var i=Vo.exec(r.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function pk(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function xue(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function vue(t,r,n){var i=Vo.exec(r.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function bue(t,r,n){var i=Vo.exec(r.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function jue(t,r,n){var i=Vo.exec(r.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function wue(t,r,n){var i=sue.exec(r.slice(n,n+1));return i?n+i[0].length:-1}function Sue(t,r,n){var i=Vo.exec(r.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Cue(t,r,n){var i=Vo.exec(r.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function gk(t,r){return xi(t.getDate(),r,2)}function Nue(t,r){return xi(t.getHours(),r,2)}function Aue(t,r){return xi(t.getHours()%12||12,r,2)}function Eue(t,r){return xi(1+Ty.count(dh(t),t),r,3)}function aF(t,r){return xi(t.getMilliseconds(),r,3)}function _ue(t,r){return aF(t,r)+"000"}function Tue(t,r){return xi(t.getMonth()+1,r,2)}function Iue(t,r){return xi(t.getMinutes(),r,2)}function Oue(t,r){return xi(t.getSeconds(),r,2)}function kue(t){var r=t.getDay();return r===0?7:r}function Due(t,r){return xi(T2.count(dh(t)-1,t),r,2)}function sF(t){var r=t.getDay();return r>=4||r===0?Wp(t):Wp.ceil(t)}function Pue(t,r){return t=sF(t),xi(Wp.count(dh(t),t)+(dh(t).getDay()===4),r,2)}function Rue(t){return t.getDay()}function Mue(t,r){return xi(wb.count(dh(t)-1,t),r,2)}function Lue(t,r){return xi(t.getFullYear()%100,r,2)}function zue(t,r){return t=sF(t),xi(t.getFullYear()%100,r,2)}function Bue(t,r){return xi(t.getFullYear()%1e4,r,4)}function Fue(t,r){var n=t.getDay();return t=n>=4||n===0?Wp(t):Wp.ceil(t),xi(t.getFullYear()%1e4,r,4)}function que(t){var r=t.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+xi(r/60|0,"0",2)+xi(r%60,"0",2)}function yk(t,r){return xi(t.getUTCDate(),r,2)}function Uue(t,r){return xi(t.getUTCHours(),r,2)}function Wue(t,r){return xi(t.getUTCHours()%12||12,r,2)}function Hue(t,r){return xi(1+_2.count(uh(t),t),r,3)}function oF(t,r){return xi(t.getUTCMilliseconds(),r,3)}function Vue(t,r){return oF(t,r)+"000"}function $ue(t,r){return xi(t.getUTCMonth()+1,r,2)}function Gue(t,r){return xi(t.getUTCMinutes(),r,2)}function Kue(t,r){return xi(t.getUTCSeconds(),r,2)}function Que(t){var r=t.getUTCDay();return r===0?7:r}function Yue(t,r){return xi(I2.count(uh(t)-1,t),r,2)}function lF(t){var r=t.getUTCDay();return r>=4||r===0?Hp(t):Hp.ceil(t)}function Zue(t,r){return t=lF(t),xi(Hp.count(uh(t),t)+(uh(t).getUTCDay()===4),r,2)}function Xue(t){return t.getUTCDay()}function Jue(t,r){return xi(Sb.count(uh(t)-1,t),r,2)}function ehe(t,r){return xi(t.getUTCFullYear()%100,r,2)}function the(t,r){return t=lF(t),xi(t.getUTCFullYear()%100,r,2)}function rhe(t,r){return xi(t.getUTCFullYear()%1e4,r,4)}function nhe(t,r){var n=t.getUTCDay();return t=n>=4||n===0?Hp(t):Hp.ceil(t),xi(t.getUTCFullYear()%1e4,r,4)}function ihe(){return"+0000"}function xk(){return"%"}function vk(t){return+t}function bk(t){return Math.floor(+t/1e3)}var ip,cF,dF;ahe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ahe(t){return ip=aue(t),cF=ip.format,ip.parse,dF=ip.utcFormat,ip.utcParse,ip}function she(t){return new Date(t)}function ohe(t){return t instanceof Date?+t:+new Date(+t)}function BE(t,r,n,i,a,s,o,l,u,d){var f=NE(),p=f.invert,x=f.domain,v=d(".%L"),w=d(":%S"),C=d("%I:%M"),A=d("%I %p"),T=d("%a %d"),O=d("%b %d"),D=d("%B"),M=d("%Y");function Q(U){return(u(U)<U?v:l(U)<U?w:o(U)<U?C:s(U)<U?A:i(U)<U?a(U)<U?T:O:n(U)<U?D:M)(U)}return f.invert=function(U){return new Date(p(U))},f.domain=function(U){return arguments.length?x(Array.from(U,ohe)):x().map(she)},f.ticks=function(U){var $=x();return t($[0],$[$.length-1],U??10)},f.tickFormat=function(U,$){return $==null?Q:d($)},f.nice=function(U){var $=x();return(!U||typeof U.range!="function")&&(U=r($[0],$[$.length-1],U??10)),U?x(Y9($,U)):f},f.copy=function(){return _y(f,BE(t,r,n,i,a,s,o,l,u,d))},f}function lhe(){return dd.apply(BE(nue,iue,dh,LE,T2,Ty,RE,DE,$f,cF).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function che(){return dd.apply(BE(tue,rue,uh,zE,I2,_2,ME,PE,$f,dF).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function O2(){var t=0,r=1,n,i,a,s,o=ql,l=!1,u;function d(p){return p==null||isNaN(p=+p)?u:o(a===0?.5:(p=(s(p)-n)*a,l?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([t,r]=p,n=s(t=+t),i=s(r=+r),a=n===i?0:1/(i-n),d):[t,r]},d.clamp=function(p){return arguments.length?(l=!!p,d):l},d.interpolator=function(p){return arguments.length?(o=p,d):o};function f(p){return function(x){var v,w;return arguments.length?([v,w]=x,o=p(v,w),d):[o(0),o(1)]}}return d.range=f(c0),d.rangeRound=f(CE),d.unknown=function(p){return arguments.length?(u=p,d):u},function(p){return s=p,n=p(t),i=p(r),a=n===i?0:1/(i-n),d}}function xf(t,r){return r.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function uF(){var t=yf(O2()(ql));return t.copy=function(){return xf(t,uF())},xh.apply(t,arguments)}function hF(){var t=_E(O2()).domain([1,10]);return t.copy=function(){return xf(t,hF()).base(t.base())},xh.apply(t,arguments)}function fF(){var t=TE(O2());return t.copy=function(){return xf(t,fF()).constant(t.constant())},xh.apply(t,arguments)}function FE(){var t=IE(O2());return t.copy=function(){return xf(t,FE()).exponent(t.exponent())},xh.apply(t,arguments)}function dhe(){return FE.apply(null,arguments).exponent(.5)}function mF(){var t=[],r=ql;function n(i){if(i!=null&&!isNaN(i=+i))return r((Ay(t,i,1)-1)/(t.length-1))}return n.domain=function(i){if(!arguments.length)return t.slice();t=[];for(let a of i)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(af),n},n.interpolator=function(i){return arguments.length?(r=i,n):r},n.range=function(){return t.map((i,a)=>r(a/(t.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(a,s)=>Qce(t,s/i))},n.copy=function(){return mF(r).domain(t)},xh.apply(n,arguments)}function k2(){var t=0,r=.5,n=1,i=1,a,s,o,l,u,d=ql,f,p=!1,x;function v(C){return isNaN(C=+C)?x:(C=.5+((C=+f(C))-s)*(i*C<i*s?l:u),d(p?Math.max(0,Math.min(1,C)):C))}v.domain=function(C){return arguments.length?([t,r,n]=C,a=f(t=+t),s=f(r=+r),o=f(n=+n),l=a===s?0:.5/(s-a),u=s===o?0:.5/(o-s),i=s<a?-1:1,v):[t,r,n]},v.clamp=function(C){return arguments.length?(p=!!C,v):p},v.interpolator=function(C){return arguments.length?(d=C,v):d};function w(C){return function(A){var T,O,D;return arguments.length?([T,O,D]=A,d=wde(C,[T,O,D]),v):[d(0),d(.5),d(1)]}}return v.range=w(c0),v.rangeRound=w(CE),v.unknown=function(C){return arguments.length?(x=C,v):x},function(C){return f=C,a=C(t),s=C(r),o=C(n),l=a===s?0:.5/(s-a),u=s===o?0:.5/(o-s),i=s<a?-1:1,v}}function pF(){var t=yf(k2()(ql));return t.copy=function(){return xf(t,pF())},xh.apply(t,arguments)}function gF(){var t=_E(k2()).domain([.1,1,10]);return t.copy=function(){return xf(t,gF()).base(t.base())},xh.apply(t,arguments)}function yF(){var t=TE(k2());return t.copy=function(){return xf(t,yF()).constant(t.constant())},xh.apply(t,arguments)}function qE(){var t=IE(k2());return t.copy=function(){return xf(t,qE()).exponent(t.exponent())},xh.apply(t,arguments)}function uhe(){return qE.apply(null,arguments).exponent(.5)}const wg=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:jE,scaleDiverging:pF,scaleDivergingLog:gF,scaleDivergingPow:qE,scaleDivergingSqrt:uhe,scaleDivergingSymlog:yF,scaleIdentity:Q9,scaleImplicit:DN,scaleLinear:K9,scaleLog:Z9,scaleOrdinal:bE,scalePoint:Xce,scalePow:OE,scaleQuantile:eF,scaleQuantize:tF,scaleRadial:J9,scaleSequential:uF,scaleSequentialLog:hF,scaleSequentialPow:FE,scaleSequentialQuantile:mF,scaleSequentialSqrt:dhe,scaleSequentialSymlog:fF,scaleSqrt:Vde,scaleSymlog:X9,scaleThreshold:rF,scaleTime:lhe,scaleUtc:che,tickFormat:G9},Symbol.toStringTag,{value:"Module"}));var vh=t=>t.chartData,D2=ut([vh],t=>{var r=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:r,dataStartIndex:0}}),UE=(t,r,n,i)=>i?D2(t):vh(t),xF=(t,r,n)=>n?D2(t):vh(t);function uf(t){if(Array.isArray(t)&&t.length===2){var[r,n]=t;if(oa(r)&&oa(n))return!0}return!1}function jk(t,r,n){return n?t:[Math.min(t[0],r[0]),Math.max(t[1],r[1])]}function vF(t,r){if(r&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[n,i]=t,a,s;if(oa(n))a=n;else if(typeof n=="function")return;if(oa(i))s=i;else if(typeof i=="function")return;var o=[a,s];if(uf(o))return o}}function hhe(t,r,n){if(!(!n&&r==null)){if(typeof t=="function"&&r!=null)try{var i=t(r,n);if(uf(i))return jk(i,r,n)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")r!=null&&(o=Math.min(...r));else if(or(a))o=a;else if(typeof a=="function")try{r!=null&&(o=a(r?.[0]))}catch{}else if(typeof a=="string"&&kI.test(a)){var u=kI.exec(a);if(u==null||u[1]==null||r==null)o=void 0;else{var d=+u[1];o=r[0]-d}}else o=r?.[0];if(s==="auto")r!=null&&(l=Math.max(...r));else if(or(s))l=s;else if(typeof s=="function")try{r!=null&&(l=s(r?.[1]))}catch{}else if(typeof s=="string"&&DI.test(s)){var f=DI.exec(s);if(f==null||f[1]==null||r==null)l=void 0;else{var p=+f[1];l=r[1]+p}}else l=r?.[1];var x=[o,l];if(uf(x))return r==null?x:jk(x,r,n)}}}var d0=1e9,fhe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},HE,Wa=!0,sd="[DecimalError] ",Jf=sd+"Invalid argument: ",WE=sd+"Exponent out of range: ",u0=Math.floor,Rf=Math.pow,mhe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Dc,Lo=1e7,Aa=7,bF=9007199254740991,Cb=u0(bF/Aa),yr={};yr.absoluteValue=yr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};yr.comparedTo=yr.cmp=function(t){var r,n,i,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(i=s.d.length,a=t.d.length,r=0,n=i<a?i:a;r<n;++r)if(s.d[r]!==t.d[r])return s.d[r]>t.d[r]^s.s<0?1:-1;return i===a?0:i>a^s.s<0?1:-1};yr.decimalPlaces=yr.dp=function(){var t=this,r=t.d.length-1,n=(r-t.e)*Aa;if(r=t.d[r],r)for(;r%10==0;r/=10)n--;return n<0?0:n};yr.dividedBy=yr.div=function(t){return Xu(this,new this.constructor(t))};yr.dividedToIntegerBy=yr.idiv=function(t){var r=this,n=r.constructor;return ia(Xu(r,new n(t),0,1),n.precision)};yr.equals=yr.eq=function(t){return!this.cmp(t)};yr.exponent=function(){return no(this)};yr.greaterThan=yr.gt=function(t){return this.cmp(t)>0};yr.greaterThanOrEqualTo=yr.gte=function(t){return this.cmp(t)>=0};yr.isInteger=yr.isint=function(){return this.e>this.d.length-2};yr.isNegative=yr.isneg=function(){return this.s<0};yr.isPositive=yr.ispos=function(){return this.s>0};yr.isZero=function(){return this.s===0};yr.lessThan=yr.lt=function(t){return this.cmp(t)<0};yr.lessThanOrEqualTo=yr.lte=function(t){return this.cmp(t)<1};yr.logarithm=yr.log=function(t){var r,n=this,i=n.constructor,a=i.precision,s=a+5;if(t===void 0)t=new i(10);else if(t=new i(t),t.s<1||t.eq(Dc))throw Error(sd+"NaN");if(n.s<1)throw Error(sd+(n.s?"NaN":"-Infinity"));return n.eq(Dc)?new i(0):(Wa=!1,r=Xu(ty(n,s),ty(t,s),s),Wa=!0,ia(r,a))};yr.minus=yr.sub=function(t){var r=this;return t=new r.constructor(t),r.s==t.s?SF(r,t):jF(r,(t.s=-t.s,t))};yr.modulo=yr.mod=function(t){var r,n=this,i=n.constructor,a=i.precision;if(t=new i(t),!t.s)throw Error(sd+"NaN");return n.s?(Wa=!1,r=Xu(n,t,0,1).times(t),Wa=!0,n.minus(r)):ia(new i(n),a)};yr.naturalExponential=yr.exp=function(){return wF(this)};yr.naturalLogarithm=yr.ln=function(){return ty(this)};yr.negated=yr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};yr.plus=yr.add=function(t){var r=this;return t=new r.constructor(t),r.s==t.s?jF(r,t):SF(r,(t.s=-t.s,t))};yr.precision=yr.sd=function(t){var r,n,i,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Jf+t);if(r=no(a)+1,i=a.d.length-1,n=i*Aa+1,i=a.d[i],i){for(;i%10==0;i/=10)n--;for(i=a.d[0];i>=10;i/=10)n++}return t&&r>n?r:n};yr.squareRoot=yr.sqrt=function(){var t,r,n,i,a,s,o,l=this,u=l.constructor;if(l.s<1){if(!l.s)return new u(0);throw Error(sd+"NaN")}for(t=no(l),Wa=!1,a=Math.sqrt(+l),a==0||a==1/0?(r=au(l.d),(r.length+t)%2==0&&(r+="0"),a=Math.sqrt(r),t=u0((t+1)/2)-(t<0||t%2),a==1/0?r="5e"+t:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+t),i=new u(r)):i=new u(a.toString()),n=u.precision,a=o=n+3;;)if(s=i,i=s.plus(Xu(l,s,o+2)).times(.5),au(s.d).slice(0,o)===(r=au(i.d)).slice(0,o)){if(r=r.slice(o-3,o+1),a==o&&r=="4999"){if(ia(s,n+1,0),s.times(s).eq(l)){i=s;break}}else if(r!="9999")break;o+=4}return Wa=!0,ia(i,n)};yr.times=yr.mul=function(t){var r,n,i,a,s,o,l,u,d,f=this,p=f.constructor,x=f.d,v=(t=new p(t)).d;if(!f.s||!t.s)return new p(0);for(t.s*=f.s,n=f.e+t.e,u=x.length,d=v.length,u<d&&(s=x,x=v,v=s,o=u,u=d,d=o),s=[],o=u+d,i=o;i--;)s.push(0);for(i=d;--i>=0;){for(r=0,a=u+i;a>i;)l=s[a]+v[i]*x[a-i-1]+r,s[a--]=l%Lo|0,r=l/Lo|0;s[a]=(s[a]+r)%Lo|0}for(;!s[--o];)s.pop();return r?++n:s.shift(),t.d=s,t.e=n,Wa?ia(t,p.precision):t};yr.toDecimalPlaces=yr.todp=function(t,r){var n=this,i=n.constructor;return n=new i(n),t===void 0?n:(fu(t,0,d0),r===void 0?r=i.rounding:fu(r,0,8),ia(n,t+no(n)+1,r))};yr.toExponential=function(t,r){var n,i=this,a=i.constructor;return t===void 0?n=gm(i,!0):(fu(t,0,d0),r===void 0?r=a.rounding:fu(r,0,8),i=ia(new a(i),t+1,r),n=gm(i,!0,t+1)),n};yr.toFixed=function(t,r){var n,i,a=this,s=a.constructor;return t===void 0?gm(a):(fu(t,0,d0),r===void 0?r=s.rounding:fu(r,0,8),i=ia(new s(a),t+no(a)+1,r),n=gm(i.abs(),!1,t+no(i)+1),a.isneg()&&!a.isZero()?"-"+n:n)};yr.toInteger=yr.toint=function(){var t=this,r=t.constructor;return ia(new r(t),no(t)+1,r.rounding)};yr.toNumber=function(){return+this};yr.toPower=yr.pow=function(t){var r,n,i,a,s,o,l=this,u=l.constructor,d=12,f=+(t=new u(t));if(!t.s)return new u(Dc);if(l=new u(l),!l.s){if(t.s<1)throw Error(sd+"Infinity");return l}if(l.eq(Dc))return l;if(i=u.precision,t.eq(Dc))return ia(l,i);if(r=t.e,n=t.d.length-1,o=r>=n,s=l.s,o){if((n=f<0?-f:f)<=bF){for(a=new u(Dc),r=Math.ceil(i/Aa+4),Wa=!1;n%2&&(a=a.times(l),Sk(a.d,r)),n=u0(n/2),n!==0;)l=l.times(l),Sk(l.d,r);return Wa=!0,t.s<0?new u(Dc).div(a):ia(a,i)}}else if(s<0)throw Error(sd+"NaN");return s=s<0&&t.d[Math.max(r,n)]&1?-1:1,l.s=1,Wa=!1,a=t.times(ty(l,i+d)),Wa=!0,a=wF(a),a.s=s,a};yr.toPrecision=function(t,r){var n,i,a=this,s=a.constructor;return t===void 0?(n=no(a),i=gm(a,n<=s.toExpNeg||n>=s.toExpPos)):(fu(t,1,d0),r===void 0?r=s.rounding:fu(r,0,8),a=ia(new s(a),t,r),n=no(a),i=gm(a,t<=n||n<=s.toExpNeg,t)),i};yr.toSignificantDigits=yr.tosd=function(t,r){var n=this,i=n.constructor;return t===void 0?(t=i.precision,r=i.rounding):(fu(t,1,d0),r===void 0?r=i.rounding:fu(r,0,8)),ia(new i(n),t,r)};yr.toString=yr.valueOf=yr.val=yr.toJSON=yr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,r=no(t),n=t.constructor;return gm(t,r<=n.toExpNeg||r>=n.toExpPos)};function jF(t,r){var n,i,a,s,o,l,u,d,f=t.constructor,p=f.precision;if(!t.s||!r.s)return r.s||(r=new f(t)),Wa?ia(r,p):r;if(u=t.d,d=r.d,o=t.e,a=r.e,u=u.slice(),s=o-a,s){for(s<0?(i=u,s=-s,l=d.length):(i=d,a=o,l=u.length),o=Math.ceil(p/Aa),l=o>l?o+1:l+1,s>l&&(s=l,i.length=1),i.reverse();s--;)i.push(0);i.reverse()}for(l=u.length,s=d.length,l-s<0&&(s=l,i=d,d=u,u=i),n=0;s;)n=(u[--s]=u[s]+d[s]+n)/Lo|0,u[s]%=Lo;for(n&&(u.unshift(n),++a),l=u.length;u[--l]==0;)u.pop();return r.d=u,r.e=a,Wa?ia(r,p):r}function fu(t,r,n){if(t!==~~t||t<r||t>n)throw Error(Jf+t)}function au(t){var r,n,i,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,r=1;r<a;r++)i=t[r]+"",n=Aa-i.length,n&&(s+=Yh(n)),s+=i;o=t[r],i=o+"",n=Aa-i.length,n&&(s+=Yh(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Xu=(function(){function t(i,a){var s,o=0,l=i.length;for(i=i.slice();l--;)s=i[l]*a+o,i[l]=s%Lo|0,o=s/Lo|0;return o&&i.unshift(o),i}function r(i,a,s,o){var l,u;if(s!=o)u=s>o?1:-1;else for(l=u=0;l<s;l++)if(i[l]!=a[l]){u=i[l]>a[l]?1:-1;break}return u}function n(i,a,s){for(var o=0;s--;)i[s]-=o,o=i[s]<a[s]?1:0,i[s]=o*Lo+i[s]-a[s];for(;!i[0]&&i.length>1;)i.shift()}return function(i,a,s,o){var l,u,d,f,p,x,v,w,C,A,T,O,D,M,Q,U,$,ee,F=i.constructor,Y=i.s==a.s?1:-1,J=i.d,Z=a.d;if(!i.s)return new F(i);if(!a.s)throw Error(sd+"Division by zero");for(u=i.e-a.e,$=Z.length,Q=J.length,v=new F(Y),w=v.d=[],d=0;Z[d]==(J[d]||0);)++d;if(Z[d]>(J[d]||0)&&--u,s==null?O=s=F.precision:o?O=s+(no(i)-no(a))+1:O=s,O<0)return new F(0);if(O=O/Aa+2|0,d=0,$==1)for(f=0,Z=Z[0],O++;(d<Q||f)&&O--;d++)D=f*Lo+(J[d]||0),w[d]=D/Z|0,f=D%Z|0;else{for(f=Lo/(Z[0]+1)|0,f>1&&(Z=t(Z,f),J=t(J,f),$=Z.length,Q=J.length),M=$,C=J.slice(0,$),A=C.length;A<$;)C[A++]=0;ee=Z.slice(),ee.unshift(0),U=Z[0],Z[1]>=Lo/2&&++U;do f=0,l=r(Z,C,$,A),l<0?(T=C[0],$!=A&&(T=T*Lo+(C[1]||0)),f=T/U|0,f>1?(f>=Lo&&(f=Lo-1),p=t(Z,f),x=p.length,A=C.length,l=r(p,C,x,A),l==1&&(f--,n(p,$<x?ee:Z,x))):(f==0&&(l=f=1),p=Z.slice()),x=p.length,x<A&&p.unshift(0),n(C,p,A),l==-1&&(A=C.length,l=r(Z,C,$,A),l<1&&(f++,n(C,$<A?ee:Z,A))),A=C.length):l===0&&(f++,C=[0]),w[d++]=f,l&&C[0]?C[A++]=J[M]||0:(C=[J[M]],A=1);while((M++<Q||C[0]!==void 0)&&O--)}return w[0]||w.shift(),v.e=u,ia(v,o?s+no(v)+1:s)}})();function wF(t,r){var n,i,a,s,o,l,u=0,d=0,f=t.constructor,p=f.precision;if(no(t)>16)throw Error(WE+no(t));if(!t.s)return new f(Dc);for(Wa=!1,l=p,o=new f(.03125);t.abs().gte(.1);)t=t.times(o),d+=5;for(i=Math.log(Rf(2,d))/Math.LN10*2+5|0,l+=i,n=a=s=new f(Dc),f.precision=l;;){if(a=ia(a.times(t),l),n=n.times(++u),o=s.plus(Xu(a,n,l)),au(o.d).slice(0,l)===au(s.d).slice(0,l)){for(;d--;)s=ia(s.times(s),l);return f.precision=p,r==null?(Wa=!0,ia(s,p)):s}s=o}}function no(t){for(var r=t.e*Aa,n=t.d[0];n>=10;n/=10)r++;return r}function aS(t,r,n){if(r>t.LN10.sd())throw Wa=!0,n&&(t.precision=n),Error(sd+"LN10 precision limit exceeded");return ia(new t(t.LN10),r)}function Yh(t){for(var r="";t--;)r+="0";return r}function ty(t,r){var n,i,a,s,o,l,u,d,f,p=1,x=10,v=t,w=v.d,C=v.constructor,A=C.precision;if(v.s<1)throw Error(sd+(v.s?"NaN":"-Infinity"));if(v.eq(Dc))return new C(0);if(r==null?(Wa=!1,d=A):d=r,v.eq(10))return r==null&&(Wa=!0),aS(C,d);if(d+=x,C.precision=d,n=au(w),i=n.charAt(0),s=no(v),Math.abs(s)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)v=v.times(t),n=au(v.d),i=n.charAt(0),p++;s=no(v),i>1?(v=new C("0."+n),s++):v=new C(i+"."+n.slice(1))}else return u=aS(C,d+2,A).times(s+""),v=ty(new C(i+"."+n.slice(1)),d-x).plus(u),C.precision=A,r==null?(Wa=!0,ia(v,A)):v;for(l=o=v=Xu(v.minus(Dc),v.plus(Dc),d),f=ia(v.times(v),d),a=3;;){if(o=ia(o.times(f),d),u=l.plus(Xu(o,new C(a),d)),au(u.d).slice(0,d)===au(l.d).slice(0,d))return l=l.times(2),s!==0&&(l=l.plus(aS(C,d+2,A).times(s+""))),l=Xu(l,new C(p),d),C.precision=A,r==null?(Wa=!0,ia(l,A)):l;l=u,a+=2}}function wk(t,r){var n,i,a;for((n=r.indexOf("."))>-1&&(r=r.replace(".","")),(i=r.search(/e/i))>0?(n<0&&(n=i),n+=+r.slice(i+1),r=r.substring(0,i)):n<0&&(n=r.length),i=0;r.charCodeAt(i)===48;)++i;for(a=r.length;r.charCodeAt(a-1)===48;)--a;if(r=r.slice(i,a),r){if(a-=i,n=n-i-1,t.e=u0(n/Aa),t.d=[],i=(n+1)%Aa,n<0&&(i+=Aa),i<a){for(i&&t.d.push(+r.slice(0,i)),a-=Aa;i<a;)t.d.push(+r.slice(i,i+=Aa));r=r.slice(i),i=Aa-r.length}else i-=a;for(;i--;)r+="0";if(t.d.push(+r),Wa&&(t.e>Cb||t.e<-Cb))throw Error(WE+n)}else t.s=0,t.e=0,t.d=[0];return t}function ia(t,r,n){var i,a,s,o,l,u,d,f,p=t.d;for(o=1,s=p[0];s>=10;s/=10)o++;if(i=r-o,i<0)i+=Aa,a=r,d=p[f=0];else{if(f=Math.ceil((i+1)/Aa),s=p.length,f>=s)return t;for(d=s=p[f],o=1;s>=10;s/=10)o++;i%=Aa,a=i-Aa+o}if(n!==void 0&&(s=Rf(10,o-a-1),l=d/s%10|0,u=r<0||p[f+1]!==void 0||d%s,u=n<4?(l||u)&&(n==0||n==(t.s<0?3:2)):l>5||l==5&&(n==4||u||n==6&&(i>0?a>0?d/Rf(10,o-a):0:p[f-1])%10&1||n==(t.s<0?8:7))),r<1||!p[0])return u?(s=no(t),p.length=1,r=r-s-1,p[0]=Rf(10,(Aa-r%Aa)%Aa),t.e=u0(-r/Aa)||0):(p.length=1,p[0]=t.e=t.s=0),t;if(i==0?(p.length=f,s=1,f--):(p.length=f+1,s=Rf(10,Aa-i),p[f]=a>0?(d/Rf(10,o-a)%Rf(10,a)|0)*s:0),u)for(;;)if(f==0){(p[0]+=s)==Lo&&(p[0]=1,++t.e);break}else{if(p[f]+=s,p[f]!=Lo)break;p[f--]=0,s=1}for(i=p.length;p[--i]===0;)p.pop();if(Wa&&(t.e>Cb||t.e<-Cb))throw Error(WE+no(t));return t}function SF(t,r){var n,i,a,s,o,l,u,d,f,p,x=t.constructor,v=x.precision;if(!t.s||!r.s)return r.s?r.s=-r.s:r=new x(t),Wa?ia(r,v):r;if(u=t.d,p=r.d,i=r.e,d=t.e,u=u.slice(),o=d-i,o){for(f=o<0,f?(n=u,o=-o,l=p.length):(n=p,i=d,l=u.length),a=Math.max(Math.ceil(v/Aa),l)+2,o>a&&(o=a,n.length=1),n.reverse(),a=o;a--;)n.push(0);n.reverse()}else{for(a=u.length,l=p.length,f=a<l,f&&(l=a),a=0;a<l;a++)if(u[a]!=p[a]){f=u[a]<p[a];break}o=0}for(f&&(n=u,u=p,p=n,r.s=-r.s),l=u.length,a=p.length-l;a>0;--a)u[l++]=0;for(a=p.length;a>o;){if(u[--a]<p[a]){for(s=a;s&&u[--s]===0;)u[s]=Lo-1;--u[s],u[a]+=Lo}u[a]-=p[a]}for(;u[--l]===0;)u.pop();for(;u[0]===0;u.shift())--i;return u[0]?(r.d=u,r.e=i,Wa?ia(r,v):r):new x(0)}function gm(t,r,n){var i,a=no(t),s=au(t.d),o=s.length;return r?(n&&(i=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Yh(i):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+Yh(-a-1)+s,n&&(i=n-o)>0&&(s+=Yh(i))):a>=o?(s+=Yh(a+1-o),n&&(i=n-a-1)>0&&(s=s+"."+Yh(i))):((i=a+1)<o&&(s=s.slice(0,i)+"."+s.slice(i)),n&&(i=n-o)>0&&(a+1===o&&(s+="."),s+=Yh(i))),t.s<0?"-"+s:s}function Sk(t,r){if(t.length>r)return t.length=r,!0}function CF(t){var r,n,i;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Jf+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return wk(o,s.toString())}else if(typeof s!="string")throw Error(Jf+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,mhe.test(s))wk(o,s);else throw Error(Jf+s)}if(a.prototype=yr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=CF,a.config=a.set=phe,t===void 0&&(t={}),t)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<i.length;)t.hasOwnProperty(n=i[r++])||(t[n]=this[n]);return a.config(t),a}function phe(t){if(!t||typeof t!="object")throw Error(sd+"Object expected");var r,n,i,a=["precision",1,d0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<a.length;r+=3)if((i=t[n=a[r]])!==void 0)if(u0(i)===i&&i>=a[r+1]&&i<=a[r+2])this[n]=i;else throw Error(Jf+n+": "+i);if((i=t[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(Jf+n+": "+i);return this}var HE=CF(fhe);Dc=new HE(1);const Li=HE;var ghe=t=>t,NF={},AF=t=>t===NF,Ck=t=>function r(){return arguments.length===0||arguments.length===1&&AF(arguments.length<=0?void 0:arguments[0])?r:t(...arguments)},EF=(t,r)=>t===1?r:Ck(function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=i.filter(o=>o!==NF).length;return s>=t?r(...i):EF(t-s,Ck(function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var d=i.map(f=>AF(f)?l.shift():f);return r(...d,...l)}))}),yhe=t=>EF(t.length,t),LN=(t,r)=>{for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},xhe=yhe((t,r)=>Array.isArray(r)?r.map(t):Object.keys(r).map(n=>r[n]).map(t)),vhe=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];if(!n.length)return ghe;var a=n.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,u)=>u(l),s(...arguments))}};function _F(t){var r;return t===0?r=1:r=Math.floor(new Li(t).abs().log(10).toNumber())+1,r}function TF(t,r,n){for(var i=new Li(t),a=0,s=[];i.lt(r)&&a<1e5;)s.push(i.toNumber()),i=i.add(n),a++;return s}var IF=t=>{var[r,n]=t,[i,a]=[r,n];return r>n&&([i,a]=[n,r]),[i,a]},OF=(t,r,n)=>{if(t.lte(0))return new Li(0);var i=_F(t.toNumber()),a=new Li(10).pow(i),s=t.div(a),o=i!==1?.05:.1,l=new Li(Math.ceil(s.div(o).toNumber())).add(n).mul(o),u=l.mul(a);return r?new Li(u.toNumber()):new Li(Math.ceil(u.toNumber()))},bhe=(t,r,n)=>{var i=new Li(1),a=new Li(t);if(!a.isint()&&n){var s=Math.abs(t);s<1?(i=new Li(10).pow(_F(t)-1),a=new Li(Math.floor(a.div(i).toNumber())).mul(i)):s>1&&(a=new Li(Math.floor(t)))}else t===0?a=new Li(Math.floor((r-1)/2)):n||(a=new Li(Math.floor(t)));var o=Math.floor((r-1)/2),l=vhe(xhe(u=>a.add(new Li(u-o).mul(i)).toNumber()),LN);return l(0,r)},kF=function(r,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-r)/(i-1)))return{step:new Li(0),tickMin:new Li(0),tickMax:new Li(0)};var o=OF(new Li(n).sub(r).div(i-1),a,s),l;r<=0&&n>=0?l=new Li(0):(l=new Li(r).add(n).div(2),l=l.sub(new Li(l).mod(o)));var u=Math.ceil(l.sub(r).div(o).toNumber()),d=Math.ceil(new Li(n).sub(l).div(o).toNumber()),f=u+d+1;return f>i?kF(r,n,i,a,s+1):(f<i&&(d=n>0?d+(i-f):d,u=n>0?u:u+(i-f)),{step:o,tickMin:l.sub(new Li(u).mul(o)),tickMax:l.add(new Li(d).mul(o))})},jhe=function(r){var[n,i]=r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,u]=IF([n,i]);if(l===-1/0||u===1/0){var d=u===1/0?[l,...LN(0,a-1).map(()=>1/0)]:[...LN(0,a-1).map(()=>-1/0),u];return n>i?d.reverse():d}if(l===u)return bhe(l,a,s);var{step:f,tickMin:p,tickMax:x}=kF(l,u,o,s,0),v=TF(p,x.add(new Li(.1).mul(f)),f);return n>i?v.reverse():v},whe=function(r,n){var[i,a]=r,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=IF([i,a]);if(o===-1/0||l===1/0)return[i,a];if(o===l)return[o];var u=Math.max(n,2),d=OF(new Li(l).sub(o).div(u-1),s,0),f=[...TF(new Li(o),new Li(l),d),l];return s===!1&&(f=f.map(p=>Math.round(p))),i>a?f.reverse():f},DF=t=>t.rootProps.maxBarSize,She=t=>t.rootProps.barGap,PF=t=>t.rootProps.barCategoryGap,Che=t=>t.rootProps.barSize,Iy=t=>t.rootProps.stackOffset,RF=t=>t.rootProps.reverseStackOrder,VE=t=>t.options.chartName,$E=t=>t.rootProps.syncId,MF=t=>t.rootProps.syncMethod,GE=t=>t.options.eventEmitter,Nhe=t=>t.rootProps.baseValue,$s={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Vu={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Oc={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},P2=(t,r)=>{if(!(!t||!r))return t!=null&&t.reversed?[r[1],r[0]]:r},Ahe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Vu.angleAxisId,includeHidden:!1,name:void 0,reversed:Vu.reversed,scale:Vu.scale,tick:Vu.tick,tickCount:void 0,ticks:void 0,type:Vu.type,unit:void 0},Ehe={allowDataOverflow:Oc.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Oc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Oc.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Oc.scale,tick:Oc.tick,tickCount:Oc.tickCount,ticks:void 0,type:Oc.type,unit:void 0},_he={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Vu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Vu.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Vu.scale,tick:Vu.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},The={allowDataOverflow:Oc.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Oc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Oc.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Oc.scale,tick:Oc.tick,tickCount:Oc.tickCount,ticks:void 0,type:"category",unit:void 0},KE=(t,r)=>t.polarAxis.angleAxis[r]!=null?t.polarAxis.angleAxis[r]:t.layout.layoutType==="radial"?_he:Ahe,QE=(t,r)=>t.polarAxis.radiusAxis[r]!=null?t.polarAxis.radiusAxis[r]:t.layout.layoutType==="radial"?The:Ehe,R2=t=>t.polarOptions,YE=ut([gh,yh,jo],P9),LF=ut([R2,YE],(t,r)=>{if(t!=null)return _l(t.innerRadius,r,0)}),zF=ut([R2,YE],(t,r)=>{if(t!=null)return _l(t.outerRadius,r,r*.8)}),Ihe=t=>{if(t==null)return[0,0];var{startAngle:r,endAngle:n}=t;return[r,n]},BF=ut([R2],Ihe);ut([KE,BF],P2);var FF=ut([YE,LF,zF],(t,r,n)=>{if(!(t==null||r==null||n==null))return[r,n]});ut([QE,FF],P2);var qF=ut([Gn,R2,LF,zF,gh,yh],(t,r,n,i,a,s)=>{if(!(t!=="centric"&&t!=="radial"||r==null||n==null||i==null)){var{cx:o,cy:l,startAngle:u,endAngle:d}=r;return{cx:_l(o,a,a/2),cy:_l(l,s,s/2),innerRadius:n,outerRadius:i,startAngle:u,endAngle:d,clockWise:!1}}}),Va=(t,r)=>r,Oy=(t,r,n)=>n;function M2(t){return t?.id}function UF(t,r,n){var{chartData:i=[]}=r,{allowDuplicatedCategory:a,dataKey:s}=n,o=new Map;return t.forEach(l=>{var u,d=(u=l.data)!==null&&u!==void 0?u:i;if(!(d==null||d.length===0)){var f=M2(l);d.forEach((p,x)=>{var v=s==null||a?x:String(Ii(p,s,null)),w=Ii(p,l.dataKey,0),C;o.has(v)?C=o.get(v):C={},Object.assign(C,{[f]:w}),o.set(v,C)})}}),Array.from(o.values())}function L2(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var z2=(t,r)=>t===r?!0:t==null||r==null?!1:t[0]===r[0]&&t[1]===r[1];function B2(t,r){return Array.isArray(t)&&Array.isArray(r)&&t.length===0&&r.length===0?!0:t===r}function Ohe(t,r){if(t.length===r.length){for(var n=0;n<t.length;n++)if(t[n]!==r[n])return!1;return!0}return!1}var So=t=>{var r=Gn(t);return r==="horizontal"?"xAxis":r==="vertical"?"yAxis":r==="centric"?"angleAxis":"radiusAxis"},h0=t=>t.tooltip.settings.axisId;function Nk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Nb(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Nk(Object(n),!0).forEach(function(i){khe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function khe(t,r,n){return(r=Dhe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Dhe(t){var r=Phe(t,"string");return typeof r=="symbol"?r:r+""}function Phe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var zN=[0,"auto"],Ro={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},WF=(t,r)=>t.cartesianAxis.xAxis[r],bh=(t,r)=>{var n=WF(t,r);return n??Ro},Mo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:zN,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Sy},HF=(t,r)=>t.cartesianAxis.yAxis[r],jh=(t,r)=>{var n=HF(t,r);return n??Mo},Rhe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ZE=(t,r)=>{var n=t.cartesianAxis.zAxis[r];return n??Rhe},ls=(t,r,n)=>{switch(r){case"xAxis":return bh(t,n);case"yAxis":return jh(t,n);case"zAxis":return ZE(t,n);case"angleAxis":return KE(t,n);case"radiusAxis":return QE(t,n);default:throw new Error("Unexpected axis type: ".concat(r))}},Mhe=(t,r,n)=>{switch(r){case"xAxis":return bh(t,n);case"yAxis":return jh(t,n);default:throw new Error("Unexpected axis type: ".concat(r))}},ky=(t,r,n)=>{switch(r){case"xAxis":return bh(t,n);case"yAxis":return jh(t,n);case"angleAxis":return KE(t,n);case"radiusAxis":return QE(t,n);default:throw new Error("Unexpected axis type: ".concat(r))}},VF=t=>t.graphicalItems.cartesianItems.some(r=>r.type==="bar")||t.graphicalItems.polarItems.some(r=>r.type==="radialBar");function XE(t,r){return n=>{switch(t){case"xAxis":return"xAxisId"in n&&n.xAxisId===r;case"yAxis":return"yAxisId"in n&&n.yAxisId===r;case"zAxis":return"zAxisId"in n&&n.zAxisId===r;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===r;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===r;default:return!1}}}var Dy=t=>t.graphicalItems.cartesianItems,Lhe=ut([Va,Oy],XE),JE=(t,r,n)=>t.filter(n).filter(i=>r?.includeHidden===!0?!0:!i.hide),Py=ut([Dy,ls,Lhe],JE,{memoizeOptions:{resultEqualityCheck:B2}}),$F=ut([Py],t=>t.filter(r=>r.type==="area"||r.type==="bar").filter(L2)),GF=t=>t.filter(r=>!("stackId"in r)||r.stackId===void 0),zhe=ut([Py],GF),e_=t=>t.map(r=>r.data).filter(Boolean).flat(1),Bhe=ut([Py],e_,{memoizeOptions:{resultEqualityCheck:B2}}),t_=(t,r)=>{var{chartData:n=[],dataStartIndex:i,dataEndIndex:a}=r;return t.length>0?t:n.slice(i,a+1)},r_=ut([Bhe,UE],t_),n_=(t,r,n)=>r?.dataKey!=null?t.map(i=>({value:Ii(i,r.dataKey)})):n.length>0?n.map(i=>i.dataKey).flatMap(i=>t.map(a=>({value:Ii(a,i)}))):t.map(i=>({value:i})),F2=ut([r_,ls,Py],n_);function KF(t,r){switch(t){case"xAxis":return r.direction==="x";case"yAxis":return r.direction==="y";default:return!1}}function vv(t){if(uu(t)||t instanceof Date){var r=Number(t);if(oa(r))return r}}function Ak(t){if(Array.isArray(t)){var r=[vv(t[0]),vv(t[1])];return uf(r)?r:void 0}var n=vv(t);if(n!=null)return[n,n]}function hh(t){return t.map(vv).filter(Die)}function Fhe(t,r,n){return!n||typeof r!="number"||id(r)?[]:n.length?hh(n.flatMap(i=>{var a=Ii(t,i.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!oa(s)||!oa(o)))return[r-s,r+o]})):[]}var Co=t=>{var r=So(t),n=h0(t);return ky(t,r,n)},Ry=ut([Co],t=>t?.dataKey),qhe=ut([$F,UE,Co],UF),QF=(t,r,n,i)=>{var a={},s=r.reduce((o,l)=>{if(l.stackId==null)return o;var u=o[l.stackId];return u==null&&(u=[]),u.push(l),o[l.stackId]=u,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,u]=o,d=i?[...u].reverse():u,f=d.map(M2);return[l,{stackedData:aoe(t,f,n),graphicalItems:d}]}))},Ab=ut([qhe,$F,Iy,RF],QF),YF=(t,r,n,i)=>{var{dataStartIndex:a,dataEndIndex:s}=r;if(i==null&&n!=="zAxis"){var o=coe(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},Uhe=ut([ls],t=>t.allowDataOverflow),i_=t=>{var r;if(t==null||!("domain"in t))return zN;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var n=hh(t.ticks);return[Math.min(...n),Math.max(...n)]}if(t.type==="category")return t.ticks.map(String)}return(r=t?.domain)!==null&&r!==void 0?r:zN},a_=ut([ls],i_),s_=ut([a_,Uhe],vF),Whe=ut([Ab,vh,Va,s_],YF,{memoizeOptions:{resultEqualityCheck:z2}}),q2=t=>t.errorBars,Hhe=(t,r,n)=>t.flatMap(i=>r[i.id]).filter(Boolean).filter(i=>KF(n,i)),Eb=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},o_=(t,r,n,i,a)=>{var s,o;if(n.length>0&&t.forEach(l=>{n.forEach(u=>{var d,f,p=(d=i[u.id])===null||d===void 0?void 0:d.filter(T=>KF(a,T)),x=Ii(l,(f=r.dataKey)!==null&&f!==void 0?f:u.dataKey),v=Fhe(l,x,p);if(v.length>=2){var w=Math.min(...v),C=Math.max(...v);(s==null||w<s)&&(s=w),(o==null||C>o)&&(o=C)}var A=Ak(x);A!=null&&(s=s==null?A[0]:Math.min(s,A[0]),o=o==null?A[1]:Math.max(o,A[1]))})}),r?.dataKey!=null&&t.forEach(l=>{var u=Ak(Ii(l,r.dataKey));u!=null&&(s=s==null?u[0]:Math.min(s,u[0]),o=o==null?u[1]:Math.max(o,u[1]))}),oa(s)&&oa(o))return[s,o]},Vhe=ut([r_,ls,zhe,q2,Va],o_,{memoizeOptions:{resultEqualityCheck:z2}});function $he(t){var{value:r}=t;if(uu(r)||r instanceof Date)return r}var Ghe=(t,r,n)=>{var i=t.map($he).filter(a=>a!=null);return n&&(r.dataKey==null||r.allowDuplicatedCategory&&hB(i))?z9(0,t.length):r.allowDuplicatedCategory?i:Array.from(new Set(i))},ZF=t=>t.referenceElements.dots,f0=(t,r,n)=>t.filter(i=>i.ifOverflow==="extendDomain").filter(i=>r==="xAxis"?i.xAxisId===n:i.yAxisId===n),Khe=ut([ZF,Va,Oy],f0),XF=t=>t.referenceElements.areas,Qhe=ut([XF,Va,Oy],f0),JF=t=>t.referenceElements.lines,Yhe=ut([JF,Va,Oy],f0),eq=(t,r)=>{if(t!=null){var n=hh(t.map(i=>r==="xAxis"?i.x:i.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},Zhe=ut(Khe,Va,eq),tq=(t,r)=>{if(t!=null){var n=hh(t.flatMap(i=>[r==="xAxis"?i.x1:i.y1,r==="xAxis"?i.x2:i.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},Xhe=ut([Qhe,Va],tq);function Jhe(t){var r;if(t.x!=null)return hh([t.x]);var n=(r=t.segment)===null||r===void 0?void 0:r.map(i=>i.x);return n==null||n.length===0?[]:hh(n)}function efe(t){var r;if(t.y!=null)return hh([t.y]);var n=(r=t.segment)===null||r===void 0?void 0:r.map(i=>i.y);return n==null||n.length===0?[]:hh(n)}var rq=(t,r)=>{if(t!=null){var n=t.flatMap(i=>r==="xAxis"?Jhe(i):efe(i));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},tfe=ut([Yhe,Va],rq),rfe=ut(Zhe,tfe,Xhe,(t,r,n)=>Eb(t,n,r)),l_=(t,r,n,i,a,s,o,l)=>{if(n!=null)return n;var u=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",d=u?Eb(i,s,a):Eb(s,a);return hhe(r,d,t.allowDataOverflow)},nfe=ut([ls,a_,s_,Whe,Vhe,rfe,Gn,Va],l_,{memoizeOptions:{resultEqualityCheck:z2}}),ife=[0,1],c_=(t,r,n,i,a,s,o)=>{if(!((t==null||n==null||n.length===0)&&o===void 0)){var{dataKey:l,type:u}=t,d=yu(r,s);if(d&&l==null){var f;return z9(0,(f=n?.length)!==null&&f!==void 0?f:0)}return u==="category"?Ghe(i,t,d):a==="expand"?ife:o}},d_=ut([ls,Gn,r_,F2,Iy,Va,nfe],c_),nq=(t,r,n,i,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return r==="radial"&&a==="radiusAxis"?"band":r==="radial"&&a==="angleAxis"?"linear":o==="category"&&i&&(i.indexOf("LineChart")>=0||i.indexOf("AreaChart")>=0||i.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(xy(s));return l in wg?l:"point"}}},m0=ut([ls,Gn,VF,VE,Va],nq);function afe(t){if(t!=null){if(t in wg)return wg[t]();var r="scale".concat(xy(t));if(r in wg)return wg[r]()}}function u_(t,r,n,i){if(!(n==null||i==null)){if(typeof t.scale=="function")return t.scale.copy().domain(n).range(i);var a=afe(r);if(a!=null){var s=a.domain(n).range(i);return eoe(s),s}}}var h_=(t,r,n)=>{var i=i_(r);if(!(n!=="auto"&&n!=="linear")){if(r!=null&&r.tickCount&&Array.isArray(i)&&(i[0]==="auto"||i[1]==="auto")&&uf(t))return jhe(t,r.tickCount,r.allowDecimals);if(r!=null&&r.tickCount&&r.type==="number"&&uf(t))return whe(t,r.tickCount,r.allowDecimals)}},f_=ut([d_,ky,m0],h_),m_=(t,r,n,i)=>{if(i!=="angleAxis"&&t?.type==="number"&&uf(r)&&Array.isArray(n)&&n.length>0){var a=r[0],s=n[0],o=r[1],l=n[n.length-1];return[Math.min(a,s),Math.max(o,l)]}return r},sfe=ut([ls,d_,f_,Va],m_),ofe=ut(F2,ls,(t,r)=>{if(!(!r||r.type!=="number")){var n=1/0,i=Array.from(hh(t.map(p=>p.value))).sort((p,x)=>p-x),a=i[0],s=i[i.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<i.length-1;l++){var u=i[l],d=i[l+1];if(!(u==null||d==null)){var f=d-u;n=Math.min(n,f)}}return n/o}}),iq=ut(ofe,Gn,PF,jo,(t,r,n,i,a)=>a,(t,r,n,i,a)=>{if(!oa(t))return 0;var s=r==="vertical"?i.height:i.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=_l(n,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),lfe=(t,r,n)=>{var i=bh(t,r);return i==null||typeof i.padding!="string"?0:iq(t,"xAxis",r,n,i.padding)},cfe=(t,r,n)=>{var i=jh(t,r);return i==null||typeof i.padding!="string"?0:iq(t,"yAxis",r,n,i.padding)},dfe=ut(bh,lfe,(t,r)=>{var n,i;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:r,right:r}:{left:((n=a.left)!==null&&n!==void 0?n:0)+r,right:((i=a.right)!==null&&i!==void 0?i:0)+r}}),ufe=ut(jh,cfe,(t,r)=>{var n,i;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:r,bottom:r}:{top:((n=a.top)!==null&&n!==void 0?n:0)+r,bottom:((i=a.bottom)!==null&&i!==void 0?i:0)+r}}),hfe=ut([jo,dfe,j2,b2,(t,r,n)=>n],(t,r,n,i,a)=>{var{padding:s}=i;return a?[s.left,n.width-s.right]:[t.left+r.left,t.left+t.width-r.right]}),ffe=ut([jo,Gn,ufe,j2,b2,(t,r,n)=>n],(t,r,n,i,a,s)=>{var{padding:o}=a;return s?[i.height-o.bottom,o.top]:r==="horizontal"?[t.top+t.height-n.bottom,t.top+n.top]:[t.top+n.top,t.top+t.height-n.bottom]}),My=(t,r,n,i)=>{var a;switch(r){case"xAxis":return hfe(t,n,i);case"yAxis":return ffe(t,n,i);case"zAxis":return(a=ZE(t,n))===null||a===void 0?void 0:a.range;case"angleAxis":return BF(t);case"radiusAxis":return FF(t,n);default:return}},aq=ut([ls,My],P2),U2=ut([ls,m0,sfe,aq],u_);ut([Py,q2,Va],Hhe);function sq(t,r){return t.id<r.id?-1:t.id>r.id?1:0}var W2=(t,r)=>r,H2=(t,r,n)=>n,mfe=ut(x2,W2,H2,(t,r,n)=>t.filter(i=>i.orientation===r).filter(i=>i.mirror===n).sort(sq)),pfe=ut(v2,W2,H2,(t,r,n)=>t.filter(i=>i.orientation===r).filter(i=>i.mirror===n).sort(sq)),oq=(t,r)=>({width:t.width,height:r.height}),gfe=(t,r)=>{var n=typeof r.width=="number"?r.width:Sy;return{width:n,height:t.height}},lq=ut(jo,bh,oq),yfe=(t,r,n)=>{switch(r){case"top":return t.top;case"bottom":return n-t.bottom;default:return 0}},xfe=(t,r,n)=>{switch(r){case"left":return t.left;case"right":return n-t.right;default:return 0}},vfe=ut(yh,jo,mfe,W2,H2,(t,r,n,i,a)=>{var s={},o;return n.forEach(l=>{var u=oq(r,l);o==null&&(o=yfe(r,i,t));var d=i==="top"&&!a||i==="bottom"&&a;s[l.id]=o-Number(d)*u.height,o+=(d?-1:1)*u.height}),s}),bfe=ut(gh,jo,pfe,W2,H2,(t,r,n,i,a)=>{var s={},o;return n.forEach(l=>{var u=gfe(r,l);o==null&&(o=xfe(r,i,t));var d=i==="left"&&!a||i==="right"&&a;s[l.id]=o-Number(d)*u.width,o+=(d?-1:1)*u.width}),s}),jfe=(t,r)=>{var n=bh(t,r);if(n!=null)return vfe(t,n.orientation,n.mirror)},wfe=ut([jo,bh,jfe,(t,r)=>r],(t,r,n,i)=>{if(r!=null){var a=n?.[i];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),Sfe=(t,r)=>{var n=jh(t,r);if(n!=null)return bfe(t,n.orientation,n.mirror)},Cfe=ut([jo,jh,Sfe,(t,r)=>r],(t,r,n,i)=>{if(r!=null){var a=n?.[i];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),cq=ut(jo,jh,(t,r)=>{var n=typeof r.width=="number"?r.width:Sy;return{width:n,height:t.height}}),Ek=(t,r,n)=>{switch(r){case"xAxis":return lq(t,n).width;case"yAxis":return cq(t,n).height;default:return}},dq=(t,r,n,i)=>{if(n!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=n,l=yu(t,i),u=r.map(d=>d.value);if(o&&l&&s==="category"&&a&&hB(u))return u}},p_=ut([Gn,F2,ls,Va],dq),uq=(t,r,n,i)=>{if(!(n==null||n.dataKey==null)){var{type:a,scale:s}=n,o=yu(t,i);if(o&&(a==="number"||s!=="auto"))return r.map(l=>l.value)}},g_=ut([Gn,F2,ky,Va],uq),_k=ut([Gn,Mhe,m0,U2,p_,g_,My,f_,Va],(t,r,n,i,a,s,o,l,u)=>{if(r!=null){var d=yu(t,u);return{angle:r.angle,interval:r.interval,minTickGap:r.minTickGap,orientation:r.orientation,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit,axisType:u,categoricalDomain:s,duplicateDomain:a,isCategorical:d,niceTicks:l,range:o,realScaleType:n,scale:i}}}),Nfe=(t,r,n,i,a,s,o,l,u)=>{if(!(r==null||i==null)){var d=yu(t,u),{type:f,ticks:p,tickCount:x}=r,v=n==="scaleBand"&&typeof i.bandwidth=="function"?i.bandwidth()/2:2,w=f==="category"&&i.bandwidth?i.bandwidth()/v:0;w=u==="angleAxis"&&s!=null&&s.length>=2?Bo(s[0]-s[1])*2*w:w;var C=p||a;if(C){var A=C.map((T,O)=>{var D=o?o.indexOf(T):T;return{index:O,coordinate:i(D)+w,value:T,offset:w}});return A.filter(T=>oa(T.coordinate))}return d&&l?l.map((T,O)=>({coordinate:i(T)+w,value:T,index:O,offset:w})).filter(T=>oa(T.coordinate)):i.ticks?i.ticks(x).map(T=>({coordinate:i(T)+w,value:T,offset:w})):i.domain().map((T,O)=>({coordinate:i(T)+w,value:o?o[T]:T,index:O,offset:w}))}},hq=ut([Gn,ky,m0,U2,f_,My,p_,g_,Va],Nfe),Afe=(t,r,n,i,a,s,o)=>{if(!(r==null||n==null||i==null||i[0]===i[1])){var l=yu(t,o),{tickCount:u}=r,d=0;return d=o==="angleAxis"&&i?.length>=2?Bo(i[0]-i[1])*2*d:d,l&&s?s.map((f,p)=>({coordinate:n(f)+d,value:f,index:p,offset:d})):n.ticks?n.ticks(u).map(f=>({coordinate:n(f)+d,value:f,offset:d})):n.domain().map((f,p)=>({coordinate:n(f)+d,value:a?a[f]:f,index:p,offset:d}))}},mu=ut([Gn,ky,U2,My,p_,g_,Va],Afe),pu=ut(ls,U2,(t,r)=>{if(!(t==null||r==null))return Nb(Nb({},t),{},{scale:r})}),Efe=ut([ls,m0,d_,aq],u_);ut((t,r,n)=>ZE(t,n),Efe,(t,r)=>{if(!(t==null||r==null))return Nb(Nb({},t),{},{scale:r})});var _fe=ut([Gn,x2,v2],(t,r,n)=>{switch(t){case"horizontal":return r.some(i=>i.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(i=>i.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),fq=t=>t.options.defaultTooltipEventType,mq=t=>t.options.validateTooltipEventTypes;function pq(t,r,n){if(t==null)return r;var i=t?"axis":"item";return n==null?r:n.includes(i)?i:r}function y_(t,r){var n=fq(t),i=mq(t);return pq(r,n,i)}function Tfe(t){return wr(r=>y_(r,t))}var gq=(t,r)=>{var n,i=Number(r);if(!(id(i)||r==null))return i>=0?t==null||(n=t[i])===null||n===void 0?void 0:n.value:void 0},Ife=t=>t.tooltip.settings,Xh={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Ofe={itemInteraction:{click:Xh,hover:Xh},axisInteraction:{click:Xh,hover:Xh},keyboardInteraction:Xh,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},yq=fc({name:"tooltip",initialState:Ofe,reducers:{addTooltipEntrySettings:{reducer(t,r){t.tooltipItemPayloads.push(r.payload)},prepare:Ua()},replaceTooltipEntrySettings:{reducer(t,r){var{prev:n,next:i}=r.payload,a=Nd(t).tooltipItemPayloads.indexOf(n);a>-1&&(t.tooltipItemPayloads[a]=i)},prepare:Ua()},removeTooltipEntrySettings:{reducer(t,r){var n=Nd(t).tooltipItemPayloads.indexOf(r.payload);n>-1&&t.tooltipItemPayloads.splice(n,1)},prepare:Ua()},setTooltipSettingsState(t,r){t.settings=r.payload},setActiveMouseOverItemIndex(t,r){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=r.payload.activeIndex,t.itemInteraction.hover.dataKey=r.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=r.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=r.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,r){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=r.payload.activeIndex,t.itemInteraction.click.dataKey=r.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=r.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=r.payload.activeCoordinate},setMouseOverAxisIndex(t,r){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=r.payload.activeIndex,t.axisInteraction.hover.dataKey=r.payload.activeDataKey,t.axisInteraction.hover.coordinate=r.payload.activeCoordinate},setMouseClickAxisIndex(t,r){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=r.payload.activeIndex,t.axisInteraction.click.dataKey=r.payload.activeDataKey,t.axisInteraction.click.coordinate=r.payload.activeCoordinate},setSyncInteraction(t,r){t.syncInteraction=r.payload},setKeyboardInteraction(t,r){t.keyboardInteraction.active=r.payload.active,t.keyboardInteraction.index=r.payload.activeIndex,t.keyboardInteraction.coordinate=r.payload.activeCoordinate}}}),{addTooltipEntrySettings:kfe,replaceTooltipEntrySettings:Dfe,removeTooltipEntrySettings:Pfe,setTooltipSettingsState:Rfe,setActiveMouseOverItemIndex:xq,mouseLeaveItem:Mfe,mouseLeaveChart:vq,setActiveClickItemIndex:Lfe,setMouseOverAxisIndex:bq,setMouseClickAxisIndex:zfe,setSyncInteraction:BN,setKeyboardInteraction:FN}=yq.actions,Bfe=yq.reducer;function Tk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function n1(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Tk(Object(n),!0).forEach(function(i){Ffe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Ffe(t,r,n){return(r=qfe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function qfe(t){var r=Ufe(t,"string");return typeof r=="symbol"?r:r+""}function Ufe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Wfe(t,r,n){return r==="axis"?n==="click"?t.axisInteraction.click:t.axisInteraction.hover:n==="click"?t.itemInteraction.click:t.itemInteraction.hover}function Hfe(t){return t.index!=null}var jq=(t,r,n,i)=>{if(r==null)return Xh;var a=Wfe(t,r,n);if(a==null)return Xh;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(Hfe(a)){if(s)return n1(n1({},a),{},{active:!0})}else if(i!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:i,graphicalItemId:void 0};return n1(n1({},Xh),{},{coordinate:a.coordinate})};function Vfe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var r=t.valueOf();return Number.isFinite(r)?r:void 0}var n=Number(t);return Number.isFinite(n)?n:void 0}function $fe(t,r){var n=Vfe(t),i=r[0],a=r[1];if(n===void 0)return!1;var s=Math.min(i,a),o=Math.max(i,a);return n>=s&&n<=o}function Gfe(t,r,n){if(n==null||r==null)return!0;var i=Ii(t,r);return i==null||!uf(n)?!0:$fe(i,n)}var x_=(t,r,n,i)=>{var a=t?.index;if(a==null)return null;var s=Number(a);if(!oa(s))return a;var o=0,l=1/0;r.length>0&&(l=r.length-1);var u=Math.max(o,Math.min(s,l)),d=r[u];return d==null||Gfe(d,n,i)?String(u):null},wq=(t,r,n,i,a,s,o,l)=>{if(!(s==null||l==null)){var u=o[0],d=u==null?void 0:l(u.positions,s);if(d!=null)return d;var f=a?.[Number(s)];if(f)return n==="horizontal"?{x:f.coordinate,y:(i.top+r)/2}:{x:(i.left+t)/2,y:f.coordinate}}},Sq=(t,r,n,i)=>{if(r==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(n==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&i!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},Ly=t=>t.options.tooltipPayloadSearcher,p0=t=>t.tooltip;function Ik(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Ok(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Ik(Object(n),!0).forEach(function(i){Kfe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ik(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Kfe(t,r,n){return(r=Qfe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Qfe(t){var r=Yfe(t,"string");return typeof r=="symbol"?r:r+""}function Yfe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Zfe(t,r){return t??r}var Cq=(t,r,n,i,a,s,o)=>{if(!(r==null||s==null)){var{chartData:l,computedData:u,dataStartIndex:d,dataEndIndex:f}=n,p=[];return t.reduce((x,v)=>{var w,{dataDefinedOnItem:C,settings:A}=v,T=Zfe(C,l),O=Array.isArray(T)?a9(T,d,f):T,D=(w=A?.dataKey)!==null&&w!==void 0?w:i,M=A?.nameKey,Q;if(i&&Array.isArray(O)&&!Array.isArray(O[0])&&o==="axis"?Q=fB(O,i,a):Q=s(O,r,u,M),Array.isArray(Q))Q.forEach($=>{var ee=Ok(Ok({},A),{},{name:$.name,unit:$.unit,color:void 0,fill:void 0});x.push(PI({tooltipEntrySettings:ee,dataKey:$.dataKey,payload:$.payload,value:Ii($.payload,$.dataKey),name:$.name}))});else{var U;x.push(PI({tooltipEntrySettings:A,dataKey:D,payload:Q,value:Ii(Q,D),name:(U=Ii(Q,M))!==null&&U!==void 0?U:A?.name}))}return x},p)}},v_=ut([Co,Gn,VF,VE,So],nq),Xfe=ut([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,r)=>[...t,...r]),Jfe=ut([So,h0],XE),g0=ut([Xfe,Co,Jfe],JE,{memoizeOptions:{resultEqualityCheck:B2}}),eme=ut([g0],t=>t.filter(L2)),tme=ut([g0],e_,{memoizeOptions:{resultEqualityCheck:B2}}),y0=ut([tme,vh],t_),rme=ut([eme,vh,Co],UF),b_=ut([y0,Co,g0],n_),Nq=ut([Co],i_),nme=ut([Co],t=>t.allowDataOverflow),Aq=ut([Nq,nme],vF),ime=ut([g0],t=>t.filter(L2)),ame=ut([rme,ime,Iy,RF],QF),sme=ut([ame,vh,So,Aq],YF),ome=ut([g0],GF),lme=ut([y0,Co,ome,q2,So],o_,{memoizeOptions:{resultEqualityCheck:z2}}),cme=ut([ZF,So,h0],f0),dme=ut([cme,So],eq),ume=ut([XF,So,h0],f0),hme=ut([ume,So],tq),fme=ut([JF,So,h0],f0),mme=ut([fme,So],rq),pme=ut([dme,mme,hme],Eb),gme=ut([Co,Nq,Aq,sme,lme,pme,Gn,So],l_),zy=ut([Co,Gn,y0,b_,Iy,So,gme],c_),yme=ut([zy,Co,v_],h_),xme=ut([Co,zy,yme,So],m_),Eq=t=>{var r=So(t),n=h0(t),i=!1;return My(t,r,n,i)},_q=ut([Co,Eq],P2),Tq=ut([Co,v_,xme,_q],u_),vme=ut([Gn,b_,Co,So],dq),bme=ut([Gn,b_,Co,So],uq),jme=(t,r,n,i,a,s,o,l)=>{if(r){var{type:u}=r,d=yu(t,l);if(i){var f=n==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,p=u==="category"&&i.bandwidth?i.bandwidth()/f:0;return p=l==="angleAxis"&&a!=null&&a?.length>=2?Bo(a[0]-a[1])*2*p:p,d&&o?o.map((x,v)=>({coordinate:i(x)+p,value:x,index:v,offset:p})):i.domain().map((x,v)=>({coordinate:i(x)+p,value:s?s[x]:x,index:v,offset:p}))}}},wh=ut([Gn,Co,v_,Tq,Eq,vme,bme,So],jme),j_=ut([fq,mq,Ife],(t,r,n)=>pq(n.shared,t,r)),Iq=t=>t.tooltip.settings.trigger,w_=t=>t.tooltip.settings.defaultIndex,By=ut([p0,j_,Iq,w_],jq),hf=ut([By,y0,Ry,zy],x_),Oq=ut([wh,hf],gq),S_=ut([By],t=>{if(t)return t.dataKey}),wme=ut([By],t=>{if(t)return t.graphicalItemId}),kq=ut([p0,j_,Iq,w_],Sq),Sme=ut([gh,yh,Gn,jo,wh,w_,kq,Ly],wq),Cme=ut([By,Sme],(t,r)=>t!=null&&t.coordinate?t.coordinate:r),Nme=ut([By],t=>{var r;return(r=t?.active)!==null&&r!==void 0?r:!1}),Ame=ut([kq,hf,vh,Ry,Oq,Ly,j_],Cq),Eme=ut([Ame],t=>{if(t!=null){var r=t.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(r))}});function kk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Dk(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?kk(Object(n),!0).forEach(function(i){_me(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function _me(t,r,n){return(r=Tme(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Tme(t){var r=Ime(t,"string");return typeof r=="symbol"?r:r+""}function Ime(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Ome=()=>wr(Co),kme=()=>{var t=Ome(),r=wr(wh),n=wr(Tq);return df(!t||!n?void 0:Dk(Dk({},t),{},{scale:n}),r)};function Pk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function ap(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Pk(Object(n),!0).forEach(function(i){Dme(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Dme(t,r,n){return(r=Pme(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Pme(t){var r=Rme(t,"string");return typeof r=="symbol"?r:r+""}function Rme(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Mme=(t,r,n,i)=>{var a=r.find(s=>s&&s.index===n);if(a){if(t==="horizontal")return{x:a.coordinate,y:i.chartY};if(t==="vertical")return{x:i.chartX,y:a.coordinate}}return{x:0,y:0}},Lme=(t,r,n,i)=>{var a=r.find(d=>d&&d.index===n);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=i;return ap(ap(ap({},i),ro(i.cx,i.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:u}=i;return ap(ap(ap({},i),ro(i.cx,i.cy,l,u)),{},{angle:u,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function zme(t,r){var{chartX:n,chartY:i}=t;return n>=r.left&&n<=r.left+r.width&&i>=r.top&&i<=r.top+r.height}var Dq=(t,r,n,i,a)=>{var s,o=(s=r?.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(i==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var u,d,f,p,x,v=l>0?(u=n[l-1])===null||u===void 0?void 0:u.coordinate:(d=n[o-1])===null||d===void 0?void 0:d.coordinate,w=(f=n[l])===null||f===void 0?void 0:f.coordinate,C=l>=o-1?(p=n[0])===null||p===void 0?void 0:p.coordinate:(x=n[l+1])===null||x===void 0?void 0:x.coordinate,A=void 0;if(!(v==null||w==null||C==null))if(Bo(w-v)!==Bo(C-w)){var T=[];if(Bo(C-w)===Bo(a[1]-a[0])){A=C;var O=w+a[1]-a[0];T[0]=Math.min(O,(O+v)/2),T[1]=Math.max(O,(O+v)/2)}else{A=v;var D=C+a[1]-a[0];T[0]=Math.min(w,(D+w)/2),T[1]=Math.max(w,(D+w)/2)}var M=[Math.min(w,(A+w)/2),Math.max(w,(A+w)/2)];if(t>M[0]&&t<=M[1]||t>=T[0]&&t<=T[1]){var Q;return(Q=n[l])===null||Q===void 0?void 0:Q.index}}else{var U=Math.min(v,C),$=Math.max(v,C);if(t>(U+w)/2&&t<=($+w)/2){var ee;return(ee=n[l])===null||ee===void 0?void 0:ee.index}}}else if(r)for(var F=0;F<o;F++){var Y=r[F];if(Y!=null){var J=r[F+1],Z=r[F-1];if(F===0&&J!=null&&t<=(Y.coordinate+J.coordinate)/2||F===o-1&&Z!=null&&t>(Y.coordinate+Z.coordinate)/2||F>0&&F<o-1&&Z!=null&&J!=null&&t>(Y.coordinate+Z.coordinate)/2&&t<=(Y.coordinate+J.coordinate)/2)return Y.index}}return-1},Pq=()=>wr(VE),C_=(t,r)=>r,Rq=(t,r,n)=>n,N_=(t,r,n,i)=>i,Bme=ut(wh,t=>l2(t,r=>r.coordinate)),A_=ut([p0,C_,Rq,N_],jq),E_=ut([A_,y0,Ry,zy],x_),Fme=(t,r,n)=>{if(r!=null){var i=p0(t);return r==="axis"?n==="hover"?i.axisInteraction.hover.dataKey:i.axisInteraction.click.dataKey:n==="hover"?i.itemInteraction.hover.dataKey:i.itemInteraction.click.dataKey}},Mq=ut([p0,C_,Rq,N_],Sq),_b=ut([gh,yh,Gn,jo,wh,N_,Mq,Ly],wq),qme=ut([A_,_b],(t,r)=>{var n;return(n=t.coordinate)!==null&&n!==void 0?n:r}),Lq=ut([wh,E_],gq),Ume=ut([Mq,E_,vh,Ry,Lq,Ly,C_],Cq),Wme=ut([A_,E_],(t,r)=>({isActive:t.active&&r!=null,activeIndex:r})),Hme=(t,r,n,i,a,s,o)=>{if(!(!t||!n||!i||!a)&&zme(t,o)){var l=doe(t,r),u=Dq(l,s,a,n,i),d=Mme(r,a,u,t);return{activeIndex:String(u),activeCoordinate:d}}},Vme=(t,r,n,i,a,s,o)=>{if(!(!t||!i||!a||!s||!n)){var l=_ce(t,n);if(l){var u=uoe(l,r),d=Dq(u,o,s,i,a),f=Lme(r,s,d,l);return{activeIndex:String(d),activeCoordinate:f}}}},$me=(t,r,n,i,a,s,o,l)=>{if(!(!t||!r||!i||!a||!s))return r==="horizontal"||r==="vertical"?Hme(t,r,i,a,s,o,l):Vme(t,r,n,i,a,s,o)},Gme=ut(t=>t.zIndex.zIndexMap,(t,r)=>r,(t,r,n)=>n,(t,r,n)=>{if(r!=null){var i=t[r];if(i!=null)return n?i.panoramaElement:i.element}}),Kme=ut(t=>t.zIndex.zIndexMap,t=>{var r=Object.keys(t).map(i=>parseInt(i,10)).concat(Object.values($s)),n=Array.from(new Set(r));return n.sort((i,a)=>i-a)},{memoizeOptions:{resultEqualityCheck:Ohe}});function Rk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Mk(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Rk(Object(n),!0).forEach(function(i){Qme(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Qme(t,r,n){return(r=Yme(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Yme(t){var r=Zme(t,"string");return typeof r=="symbol"?r:r+""}function Zme(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Xme={},Jme={zIndexMap:Object.values($s).reduce((t,r)=>Mk(Mk({},t),{},{[r]:{element:void 0,panoramaElement:void 0,consumers:0}}),Xme)},epe=new Set(Object.values($s));function tpe(t){return epe.has(t)}var zq=fc({name:"zIndex",initialState:Jme,reducers:{registerZIndexPortal:{reducer:(t,r)=>{var{zIndex:n}=r.payload;t.zIndexMap[n]?t.zIndexMap[n].consumers+=1:t.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Ua()},unregisterZIndexPortal:{reducer:(t,r)=>{var{zIndex:n}=r.payload;t.zIndexMap[n]&&(t.zIndexMap[n].consumers-=1,t.zIndexMap[n].consumers<=0&&!tpe(n)&&delete t.zIndexMap[n])},prepare:Ua()},registerZIndexPortalElement:{reducer:(t,r)=>{var{zIndex:n,element:i,isPanorama:a}=r.payload;t.zIndexMap[n]?a?t.zIndexMap[n].panoramaElement=i:t.zIndexMap[n].element=i:t.zIndexMap[n]={consumers:0,element:a?void 0:i,panoramaElement:a?i:void 0}},prepare:Ua()},unregisterZIndexPortalElement:{reducer:(t,r)=>{var{zIndex:n}=r.payload;t.zIndexMap[n]&&(r.payload.isPanorama?t.zIndexMap[n].panoramaElement=void 0:t.zIndexMap[n].element=void 0)},prepare:Ua()}}}),{registerZIndexPortal:rpe,unregisterZIndexPortal:npe,registerZIndexPortalElement:ipe,unregisterZIndexPortalElement:ape}=zq.actions,spe=zq.reducer;function $l(t){var{zIndex:r,children:n}=t,i=Woe(),a=i&&r!==void 0&&r!==0,s=Ho(),o=pa();k.useLayoutEffect(()=>a?(o(rpe({zIndex:r})),()=>{o(npe({zIndex:r}))}):vy,[o,r,a]);var l=wr(u=>Gme(u,r,s));return a?l?CA.createPortal(n,l):null:n}function qN(){return qN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},qN.apply(null,arguments)}function Lk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function i1(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Lk(Object(n),!0).forEach(function(i){ope(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ope(t,r,n){return(r=lpe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function lpe(t){var r=cpe(t,"string");return typeof r=="symbol"?r:r+""}function cpe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function dpe(t){var{cursor:r,cursorComp:n,cursorProps:i}=t;return k.isValidElement(r)?k.cloneElement(r,i):k.createElement(n,i)}function upe(t){var r,{coordinate:n,payload:i,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:u,tooltipEventType:d,chartName:f}=t,p=n,x=i,v=a;if(!u||!p||f!=="ScatterChart"&&d!=="axis")return null;var w,C,A;if(f==="ScatterChart")w=p,C=Ule,A=$s.cursorLine;else if(f==="BarChart")w=Wle(l,p,s,o),C=D9,A=$s.cursorRectangle;else if(l==="radial"&&pB(p)){var{cx:T,cy:O,radius:D,startAngle:M,endAngle:Q}=R9(p);w={cx:T,cy:O,startAngle:M,endAngle:Q,innerRadius:D,outerRadius:D},C=L9,A=$s.cursorLine}else w={points:kce(l,p,s)},C=Ep,A=$s.cursorLine;var U=typeof u=="object"&&"className"in u?u.className:void 0,$=i1(i1(i1(i1({stroke:"#ccc",pointerEvents:"none"},s),w),dm(u)),{},{payload:x,payloadIndex:v,className:hi("recharts-tooltip-cursor",U)});return k.createElement($l,{zIndex:(r=t.zIndex)!==null&&r!==void 0?r:A},k.createElement(dpe,{cursor:u,cursorComp:C,cursorProps:$}))}function hpe(t){var r=kme(),n=g9(),i=gf(),a=Pq();return r==null||n==null||i==null||a==null?null:k.createElement(upe,qN({},t,{offset:n,layout:i,tooltipAxisBandSize:r,chartName:a}))}var Bq=k.createContext(null),fpe=()=>k.useContext(Bq),sS={exports:{}},zk;function mpe(){return zk||(zk=1,(function(t){var r=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function a(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function s(u,d,f,p,x){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new a(f,p||u,x),w=n?n+d:d;return u._events[w]?u._events[w].fn?u._events[w]=[u._events[w],v]:u._events[w].push(v):(u._events[w]=v,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new i:delete u._events[d]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,p;if(this._eventsCount===0)return d;for(p in f=this._events)r.call(f,p)&&d.push(n?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=n?n+d:d,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var x=0,v=p.length,w=new Array(v);x<v;x++)w[x]=p[x].fn;return w},l.prototype.listenerCount=function(d){var f=n?n+d:d,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(d,f,p,x,v,w){var C=n?n+d:d;if(!this._events[C])return!1;var A=this._events[C],T=arguments.length,O,D;if(A.fn){switch(A.once&&this.removeListener(d,A.fn,void 0,!0),T){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,f),!0;case 3:return A.fn.call(A.context,f,p),!0;case 4:return A.fn.call(A.context,f,p,x),!0;case 5:return A.fn.call(A.context,f,p,x,v),!0;case 6:return A.fn.call(A.context,f,p,x,v,w),!0}for(D=1,O=new Array(T-1);D<T;D++)O[D-1]=arguments[D];A.fn.apply(A.context,O)}else{var M=A.length,Q;for(D=0;D<M;D++)switch(A[D].once&&this.removeListener(d,A[D].fn,void 0,!0),T){case 1:A[D].fn.call(A[D].context);break;case 2:A[D].fn.call(A[D].context,f);break;case 3:A[D].fn.call(A[D].context,f,p);break;case 4:A[D].fn.call(A[D].context,f,p,x);break;default:if(!O)for(Q=1,O=new Array(T-1);Q<T;Q++)O[Q-1]=arguments[Q];A[D].fn.apply(A[D].context,O)}}return!0},l.prototype.on=function(d,f,p){return s(this,d,f,p,!1)},l.prototype.once=function(d,f,p){return s(this,d,f,p,!0)},l.prototype.removeListener=function(d,f,p,x){var v=n?n+d:d;if(!this._events[v])return this;if(!f)return o(this,v),this;var w=this._events[v];if(w.fn)w.fn===f&&(!x||w.once)&&(!p||w.context===p)&&o(this,v);else{for(var C=0,A=[],T=w.length;C<T;C++)(w[C].fn!==f||x&&!w[C].once||p&&w[C].context!==p)&&A.push(w[C]);A.length?this._events[v]=A.length===1?A[0]:A:o(this,v)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=n?n+d:d,this._events[f]&&o(this,f)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l})(sS)),sS.exports}var ppe=mpe();const gpe=hc(ppe);var ry=new gpe,UN="recharts.syncEvent.tooltip",Bk="recharts.syncEvent.brush";function V2(t,r){if(r){var n=Number.parseInt(r,10);if(!id(n))return t?.[n]}}var ype={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Fq=fc({name:"options",initialState:ype,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),xpe=Fq.reducer,{createEventEmitter:vpe}=Fq.actions;function bpe(t){return t.tooltip.syncInteraction}var jpe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},qq=fc({name:"chartData",initialState:jpe,reducers:{setChartData(t,r){if(t.chartData=r.payload,r.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}r.payload.length>0&&t.dataEndIndex!==r.payload.length-1&&(t.dataEndIndex=r.payload.length-1)},setComputedData(t,r){t.computedData=r.payload},setDataStartEndIndexes(t,r){var{startIndex:n,endIndex:i}=r.payload;n!=null&&(t.dataStartIndex=n),i!=null&&(t.dataEndIndex=i)}}}),{setChartData:Fk,setDataStartEndIndexes:wpe,setComputedData:e_e}=qq.actions,Spe=qq.reducer,Cpe=["x","y"];function qk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function sp(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?qk(Object(n),!0).forEach(function(i){Npe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Npe(t,r,n){return(r=Ape(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Ape(t){var r=Epe(t,"string");return typeof r=="symbol"?r:r+""}function Epe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function _pe(t,r){if(t==null)return{};var n,i,a=Tpe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Tpe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Ipe(){var t=wr($E),r=wr(GE),n=pa(),i=wr(MF),a=wr(wh),s=gf(),o=w2(),l=wr(u=>u.rootProps.className);k.useEffect(()=>{if(t==null)return vy;var u=(d,f,p)=>{if(r!==p&&t===d){if(i==="index"){var x;if(o&&f!==null&&f!==void 0&&(x=f.payload)!==null&&x!==void 0&&x.coordinate&&f.payload.sourceViewBox){var v=f.payload.coordinate,{x:w,y:C}=v,A=_pe(v,Cpe),{x:T,y:O,width:D,height:M}=f.payload.sourceViewBox,Q=sp(sp({},A),{},{x:o.x+(D?(w-T)/D:0)*o.width,y:o.y+(M?(C-O)/M:0)*o.height});n(sp(sp({},f),{},{payload:sp(sp({},f.payload),{},{coordinate:Q})}))}else n(f);return}if(a!=null){var U;if(typeof i=="function"){var $={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},ee=i(a,$);U=a[ee]}else i==="value"&&(U=a.find(K=>String(K.value)===f.payload.label));var{coordinate:F}=f.payload;if(U==null||f.payload.active===!1||F==null||o==null){n(BN({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:Y,y:J}=F,Z=Math.min(Y,o.x+o.width),re=Math.min(J,o.y+o.height),de={x:s==="horizontal"?U.coordinate:Z,y:s==="horizontal"?re:U.coordinate},le=BN({active:f.payload.active,coordinate:de,dataKey:f.payload.dataKey,index:String(U.index),label:f.payload.label,sourceViewBox:f.payload.sourceViewBox,graphicalItemId:f.payload.graphicalItemId});n(le)}}};return ry.on(UN,u),()=>{ry.off(UN,u)}},[l,n,r,t,i,a,s,o])}function Ope(){var t=wr($E),r=wr(GE),n=pa();k.useEffect(()=>{if(t==null)return vy;var i=(a,s,o)=>{r!==o&&t===a&&n(wpe(s))};return ry.on(Bk,i),()=>{ry.off(Bk,i)}},[n,r,t])}function kpe(){var t=pa();k.useEffect(()=>{t(vpe())},[t]),Ipe(),Ope()}function Dpe(t,r,n,i,a,s){var o=wr(v=>Fme(v,t,r)),l=wr(GE),u=wr($E),d=wr(MF),f=wr(bpe),p=f?.active,x=w2();k.useEffect(()=>{if(!p&&u!=null&&l!=null){var v=BN({active:s,coordinate:n,dataKey:o,index:a,label:typeof i=="number"?String(i):i,sourceViewBox:x,graphicalItemId:void 0});ry.emit(UN,u,v,l)}},[p,n,o,a,i,l,u,d,s,x])}function Uk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Wk(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Uk(Object(n),!0).forEach(function(i){Ppe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Uk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Ppe(t,r,n){return(r=Rpe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Rpe(t){var r=Mpe(t,"string");return typeof r=="symbol"?r:r+""}function Mpe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Lpe(t){return t.dataKey}function zpe(t,r){return k.isValidElement(t)?k.cloneElement(t,r):typeof t=="function"?k.createElement(t,r):k.createElement(jle,r)}var Hk=[],Bpe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function kc(t){var r,n,i=ks(t,Bpe),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:u,filterNull:d,isAnimationActive:f,offset:p,payloadUniqBy:x,position:v,reverseDirection:w,useTranslate3d:C,wrapperStyle:A,cursor:T,shared:O,trigger:D,defaultIndex:M,portal:Q,axisId:U}=i,$=pa(),ee=typeof M=="number"?String(M):M;k.useEffect(()=>{$(Rfe({shared:O,trigger:D,axisId:U,active:a,defaultIndex:ee}))},[$,O,D,U,a,ee]);var F=w2(),Y=_9(),J=Tfe(O),{activeIndex:Z,isActive:re}=(r=wr(be=>Wme(be,J,D,ee)))!==null&&r!==void 0?r:{},de=wr(be=>Ume(be,J,D,ee)),le=wr(be=>Lq(be,J,D,ee)),K=wr(be=>qme(be,J,D,ee)),ue=de,ce=fpe(),ye=(n=a??re)!==null&&n!==void 0?n:!1,[Se,V]=TB([ue,ye]),X=J==="axis"?le:void 0;Dpe(J,D,K,X,Z,ye);var se=Q??ce;if(se==null||F==null||J==null)return null;var W=ue??Hk;ye||(W=Hk),d&&W.length&&(W=CB(W.filter(be=>be.value!=null&&(be.hide!==!0||i.includeHidden)),x,Lpe));var oe=W.length>0,ge=k.createElement(_le,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:f,active:ye,coordinate:K,hasPayload:oe,offset:p,position:v,reverseDirection:w,useTranslate3d:C,viewBox:F,wrapperStyle:A,lastBoundingBox:Se,innerRef:V,hasPortalFromProps:!!Q},zpe(u,Wk(Wk({},i),{},{payload:W,label:X,active:ye,activeIndex:Z,coordinate:K,accessibilityLayer:Y})));return k.createElement(k.Fragment,null,CA.createPortal(ge,se),ye&&k.createElement(hpe,{cursor:T,tooltipEventType:J,coordinate:K,payload:W,index:Z}))}var Ju=t=>null;Ju.displayName="Cell";function Fpe(t,r,n){return(r=qpe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function qpe(t){var r=Upe(t,"string");return typeof r=="symbol"?r:r+""}function Upe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}class Wpe{constructor(r){Fpe(this,"cache",new Map),this.maxSize=r}get(r){var n=this.cache.get(r);return n!==void 0&&(this.cache.delete(r),this.cache.set(r,n)),n}set(r,n){if(this.cache.has(r))this.cache.delete(r);else if(this.cache.size>=this.maxSize){var i=this.cache.keys().next().value;i!=null&&this.cache.delete(i)}this.cache.set(r,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function Vk(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Hpe(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Vk(Object(n),!0).forEach(function(i){Vpe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Vpe(t,r,n){return(r=$pe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function $pe(t){var r=Gpe(t,"string");return typeof r=="symbol"?r:r+""}function Gpe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Kpe={cacheSize:2e3,enableCache:!0},Uq=Hpe({},Kpe),$k=new Wpe(Uq.cacheSize),Qpe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Gk="recharts_measurement_span";function Ype(t,r){var n=r.fontSize||"",i=r.fontFamily||"",a=r.fontWeight||"",s=r.fontStyle||"",o=r.letterSpacing||"",l=r.textTransform||"";return"".concat(t,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var Kk=(t,r)=>{try{var n=document.getElementById(Gk);n||(n=document.createElement("span"),n.setAttribute("id",Gk),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,Qpe,r),n.textContent="".concat(t);var i=n.getBoundingClientRect();return{width:i.width,height:i.height}}catch{return{width:0,height:0}}},kg=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||Ny.isSsr)return{width:0,height:0};if(!Uq.enableCache)return Kk(r,n);var i=Ype(r,n),a=$k.get(i);if(a)return a;var s=Kk(r,n);return $k.set(i,s),s},Wq;function Zpe(t,r,n){return(r=Xpe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Xpe(t){var r=Jpe(t,"string");return typeof r=="symbol"?r:r+""}function Jpe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Qk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Yk=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,e0e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,t0e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,r0e={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},n0e=["cm","mm","pt","pc","in","Q","px"];function i0e(t){return n0e.includes(t)}var jp="NaN";function a0e(t,r){return t*r0e[r]}class dl{static parse(r){var n,[,i,a]=(n=t0e.exec(r))!==null&&n!==void 0?n:[];return i==null?dl.NaN:new dl(parseFloat(i),a??"")}constructor(r,n){this.num=r,this.unit=n,this.num=r,this.unit=n,id(r)&&(this.unit=""),n!==""&&!e0e.test(n)&&(this.num=NaN,this.unit=""),i0e(n)&&(this.num=a0e(r,n),this.unit="px")}add(r){return this.unit!==r.unit?new dl(NaN,""):new dl(this.num+r.num,this.unit)}subtract(r){return this.unit!==r.unit?new dl(NaN,""):new dl(this.num-r.num,this.unit)}multiply(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new dl(NaN,""):new dl(this.num*r.num,this.unit||r.unit)}divide(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new dl(NaN,""):new dl(this.num/r.num,this.unit||r.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return id(this.num)}}Wq=dl;Zpe(dl,"NaN",new Wq(NaN,""));function Hq(t){if(t==null||t.includes(jp))return jp;for(var r=t;r.includes("*")||r.includes("/");){var n,[,i,a,s]=(n=Qk.exec(r))!==null&&n!==void 0?n:[],o=dl.parse(i??""),l=dl.parse(s??""),u=a==="*"?o.multiply(l):o.divide(l);if(u.isNaN())return jp;r=r.replace(Qk,u.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var d,[,f,p,x]=(d=Yk.exec(r))!==null&&d!==void 0?d:[],v=dl.parse(f??""),w=dl.parse(x??""),C=p==="+"?v.add(w):v.subtract(w);if(C.isNaN())return jp;r=r.replace(Yk,C.toString())}return r}var Zk=/\(([^()]*)\)/;function s0e(t){for(var r=t,n;(n=Zk.exec(r))!=null;){var[,i]=n;r=r.replace(Zk,Hq(i))}return r}function o0e(t){var r=t.replace(/\s+/g,"");return r=s0e(r),r=Hq(r),r}function l0e(t){try{return o0e(t)}catch{return jp}}function oS(t){var r=l0e(t.slice(5,-1));return r===jp?"":r}var c0e=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],d0e=["dx","dy","angle","className","breakAll"];function WN(){return WN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},WN.apply(null,arguments)}function Xk(t,r){if(t==null)return{};var n,i,a=u0e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function u0e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var Vq=/[ \f\n\r\t\v\u2028\u2029]+/,$q=t=>{var{children:r,breakAll:n,style:i}=t;try{var a=[];Ta(r)||(n?a=r.toString().split(""):a=r.toString().split(Vq));var s=a.map(l=>({word:l,width:kg(l,i).width})),o=n?0:kg("",i).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function h0e(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var Gq=(t,r,n,i)=>t.reduce((a,s)=>{var{word:o,width:l}=s,u=a[a.length-1];if(u&&l!=null&&(r==null||i||u.width+l+n<Number(r)))u.words.push(o),u.width+=l+n;else{var d={words:[o],width:l};a.push(d)}return a},[]),Kq=t=>t.reduce((r,n)=>r.width>n.width?r:n),f0e="",Jk=(t,r,n,i,a,s,o,l)=>{var u=t.slice(0,r),d=$q({breakAll:n,style:i,children:u+f0e});if(!d)return[!1,[]];var f=Gq(d.wordsWithComputedWidth,s,o,l),p=f.length>a||Kq(f).width>Number(s);return[p,f]},m0e=(t,r,n,i,a)=>{var{maxLines:s,children:o,style:l,breakAll:u}=t,d=or(s),f=String(o),p=Gq(r,i,n,a);if(!d||a)return p;var x=p.length>s||Kq(p).width>Number(i);if(!x)return p;for(var v=0,w=f.length-1,C=0,A;v<=w&&C<=f.length-1;){var T=Math.floor((v+w)/2),O=T-1,[D,M]=Jk(f,O,u,l,s,i,n,a),[Q]=Jk(f,T,u,l,s,i,n,a);if(!D&&!Q&&(v=T+1),D&&Q&&(w=T-1),!D&&Q){A=M;break}C++}return A||p},eD=t=>{var r=Ta(t)?[]:t.toString().split(Vq);return[{words:r,width:void 0}]},p0e=t=>{var{width:r,scaleToFit:n,children:i,style:a,breakAll:s,maxLines:o}=t;if((r||n)&&!Ny.isSsr){var l,u,d=$q({breakAll:s,children:i,style:a});if(d){var{wordsWithComputedWidth:f,spaceWidth:p}=d;l=f,u=p}else return eD(i);return m0e({breakAll:s,children:i,maxLines:o,style:a},l,u,r,!!n)}return eD(i)},Qq="#808080",g0e={angle:0,breakAll:!1,capHeight:"0.71em",fill:Qq,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},$2=k.forwardRef((t,r)=>{var n=ks(t,g0e),{x:i,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:u,textAnchor:d,verticalAnchor:f}=n,p=Xk(n,c0e),x=k.useMemo(()=>p0e({breakAll:p.breakAll,children:p.children,maxLines:p.maxLines,scaleToFit:u,style:p.style,width:p.width}),[p.breakAll,p.children,p.maxLines,u,p.style,p.width]),{dx:v,dy:w,angle:C,className:A,breakAll:T}=p,O=Xk(p,d0e);if(!uu(i)||!uu(a)||x.length===0)return null;var D=Number(i)+(or(v)?v:0),M=Number(a)+(or(w)?w:0);if(!oa(D)||!oa(M))return null;var Q;switch(f){case"start":Q=oS("calc(".concat(o,")"));break;case"middle":Q=oS("calc(".concat((x.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:Q=oS("calc(".concat(x.length-1," * -").concat(s,")"));break}var U=[];if(u){var $=x[0].width,{width:ee}=p;U.push("scale(".concat(or(ee)&&or($)?ee/$:1,")"))}return C&&U.push("rotate(".concat(C,", ").concat(D,", ").concat(M,")")),U.length&&(O.transform=U.join(" ")),k.createElement("text",WN({},Tl(O),{ref:r,x:D,y:M,className:hi("recharts-text",A),textAnchor:d,fill:l.includes("url")?Qq:l}),x.map((F,Y)=>{var J=F.words.join(T?"":" ");return k.createElement("tspan",{x:D,dy:Y===0?Q:s,key:"".concat(J,"-").concat(Y)},J)}))});$2.displayName="Text";var y0e=["labelRef"],x0e=["content"];function tD(t,r){if(t==null)return{};var n,i,a=v0e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function v0e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function rD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Us(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?rD(Object(n),!0).forEach(function(i){b0e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function b0e(t,r,n){return(r=j0e(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function j0e(t){var r=w0e(t,"string");return typeof r=="symbol"?r:r+""}function w0e(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function $u(){return $u=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},$u.apply(null,arguments)}var Yq=k.createContext(null),S0e=t=>{var{x:r,y:n,upperWidth:i,lowerWidth:a,width:s,height:o,children:l}=t,u=k.useMemo(()=>({x:r,y:n,upperWidth:i,lowerWidth:a,width:s,height:o}),[r,n,i,a,s,o]);return k.createElement(Yq.Provider,{value:u},l)},Zq=()=>{var t=k.useContext(Yq),r=w2();return t||p9(r)},C0e=k.createContext(null),N0e=()=>{var t=k.useContext(C0e),r=wr(qF);return t||r},A0e=t=>{var{value:r,formatter:n}=t,i=Ta(t.children)?r:t.children;return typeof n=="function"?n(i):i},__=t=>t!=null&&typeof t=="function",E0e=(t,r)=>{var n=Bo(r-t),i=Math.min(Math.abs(r-t),360);return n*i},_0e=(t,r,n,i,a)=>{var{offset:s,className:o}=t,{cx:l,cy:u,innerRadius:d,outerRadius:f,startAngle:p,endAngle:x,clockWise:v}=a,w=(d+f)/2,C=E0e(p,x),A=C>=0?1:-1,T,O;switch(r){case"insideStart":T=p+A*s,O=v;break;case"insideEnd":T=x-A*s,O=!v;break;case"end":T=x+A*s,O=v;break;default:throw new Error("Unsupported position ".concat(r))}O=C<=0?O:!O;var D=ro(l,u,w,T),M=ro(l,u,w,T+(O?1:-1)*359),Q="M".concat(D.x,",").concat(D.y,`
    A`).concat(w,",").concat(w,",0,1,").concat(O?0:1,`,
    `).concat(M.x,",").concat(M.y),U=Ta(t.id)?Wg("recharts-radial-line-"):t.id;return k.createElement("text",$u({},i,{dominantBaseline:"central",className:hi("recharts-radial-bar-label",o)}),k.createElement("defs",null,k.createElement("path",{id:U,d:Q})),k.createElement("textPath",{xlinkHref:"#".concat(U)},n))},T0e=(t,r,n)=>{var{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:u}=t,d=(l+u)/2;if(n==="outside"){var{x:f,y:p}=ro(i,a,o+r,d);return{x:f,y:p,textAnchor:f>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(s+o)/2,{x:v,y:w}=ro(i,a,x,d);return{x:v,y:w,textAnchor:"middle",verticalAnchor:"middle"}},HN=t=>"cx"in t&&or(t.cx),I0e=(t,r)=>{var{parentViewBox:n,offset:i,position:a}=t,s;n!=null&&!HN(n)&&(s=n);var{x:o,y:l,upperWidth:u,lowerWidth:d,height:f}=r,p=o,x=o+(u-d)/2,v=(p+x)/2,w=(u+d)/2,C=p+u/2,A=f>=0?1:-1,T=A*i,O=A>0?"end":"start",D=A>0?"start":"end",M=u>=0?1:-1,Q=M*i,U=M>0?"end":"start",$=M>0?"start":"end";if(a==="top"){var ee={x:p+u/2,y:l-T,textAnchor:"middle",verticalAnchor:O};return Us(Us({},ee),s?{height:Math.max(l-s.y,0),width:u}:{})}if(a==="bottom"){var F={x:x+d/2,y:l+f+T,textAnchor:"middle",verticalAnchor:D};return Us(Us({},F),s?{height:Math.max(s.y+s.height-(l+f),0),width:d}:{})}if(a==="left"){var Y={x:v-Q,y:l+f/2,textAnchor:U,verticalAnchor:"middle"};return Us(Us({},Y),s?{width:Math.max(Y.x-s.x,0),height:f}:{})}if(a==="right"){var J={x:v+w+Q,y:l+f/2,textAnchor:$,verticalAnchor:"middle"};return Us(Us({},J),s?{width:Math.max(s.x+s.width-J.x,0),height:f}:{})}var Z=s?{width:w,height:f}:{};return a==="insideLeft"?Us({x:v+Q,y:l+f/2,textAnchor:$,verticalAnchor:"middle"},Z):a==="insideRight"?Us({x:v+w-Q,y:l+f/2,textAnchor:U,verticalAnchor:"middle"},Z):a==="insideTop"?Us({x:p+u/2,y:l+T,textAnchor:"middle",verticalAnchor:D},Z):a==="insideBottom"?Us({x:x+d/2,y:l+f-T,textAnchor:"middle",verticalAnchor:O},Z):a==="insideTopLeft"?Us({x:p+Q,y:l+T,textAnchor:$,verticalAnchor:D},Z):a==="insideTopRight"?Us({x:p+u-Q,y:l+T,textAnchor:U,verticalAnchor:D},Z):a==="insideBottomLeft"?Us({x:x+Q,y:l+f-T,textAnchor:$,verticalAnchor:O},Z):a==="insideBottomRight"?Us({x:x+d-Q,y:l+f-T,textAnchor:U,verticalAnchor:O},Z):a&&typeof a=="object"&&(or(a.x)||oh(a.x))&&(or(a.y)||oh(a.y))?Us({x:o+_l(a.x,w),y:l+_l(a.y,f),textAnchor:"end",verticalAnchor:"end"},Z):Us({x:C,y:l+f/2,textAnchor:"middle",verticalAnchor:"middle"},Z)},O0e={angle:0,offset:5,zIndex:$s.label,position:"middle",textBreakAll:!1};function Zh(t){var r=ks(t,O0e),{viewBox:n,position:i,value:a,children:s,content:o,className:l="",textBreakAll:u,labelRef:d}=r,f=N0e(),p=Zq(),x=i==="center"?p:f??p,v,w,C;if(n==null?v=x:HN(n)?v=n:v=p9(n),!v||Ta(a)&&Ta(s)&&!k.isValidElement(o)&&typeof o!="function")return null;var A=Us(Us({},r),{},{viewBox:v});if(k.isValidElement(o)){var{labelRef:T}=A,O=tD(A,y0e);return k.cloneElement(o,O)}if(typeof o=="function"){var{content:D}=A,M=tD(A,x0e);if(w=k.createElement(o,M),k.isValidElement(w))return w}else w=A0e(r);var Q=Tl(r);if(HN(v)){if(i==="insideStart"||i==="insideEnd"||i==="end")return _0e(r,i,w,Q,v);C=T0e(v,r.offset,r.position)}else C=I0e(r,v);return k.createElement($l,{zIndex:r.zIndex},k.createElement($2,$u({ref:d,className:hi("recharts-label",l)},Q,C,{textAnchor:h0e(Q.textAnchor)?Q.textAnchor:C.textAnchor,breakAll:u}),w))}Zh.displayName="Label";var k0e=(t,r,n)=>{if(!t)return null;var i={viewBox:r,labelRef:n};return t===!0?k.createElement(Zh,$u({key:"label-implicit"},i)):uu(t)?k.createElement(Zh,$u({key:"label-implicit",value:t},i)):k.isValidElement(t)?t.type===Zh?k.cloneElement(t,Us({key:"label-implicit"},i)):k.createElement(Zh,$u({key:"label-implicit",content:t},i)):__(t)?k.createElement(Zh,$u({key:"label-implicit",content:t},i)):t&&typeof t=="object"?k.createElement(Zh,$u({},t,{key:"label-implicit"},i)):null};function D0e(t){var{label:r,labelRef:n}=t,i=Zq();return k0e(r,i,n)||null}var lS={},cS={},nD;function P0e(){return nD||(nD=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return n[n.length-1]}t.last=r})(cS)),cS}var dS={},iD;function R0e(){return iD||(iD=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){return Array.isArray(n)?n:Array.from(n)}t.toArray=r})(dS)),dS}var aD;function M0e(){return aD||(aD=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=P0e(),n=R0e(),i=iE();function a(s){if(i.isArrayLike(s))return r.last(n.toArray(s))}t.last=a})(lS)),lS}var uS,sD;function L0e(){return sD||(sD=1,uS=M0e().last),uS}var z0e=L0e();const B0e=hc(z0e);var F0e=["valueAccessor"],q0e=["dataKey","clockWise","id","textBreakAll","zIndex"];function Tb(){return Tb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Tb.apply(null,arguments)}function oD(t,r){if(t==null)return{};var n,i,a=U0e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function U0e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var W0e=t=>Array.isArray(t.value)?B0e(t.value):t.value,Xq=k.createContext(void 0),T_=Xq.Provider,Jq=k.createContext(void 0),H0e=Jq.Provider;function V0e(){return k.useContext(Xq)}function $0e(){return k.useContext(Jq)}function bv(t){var{valueAccessor:r=W0e}=t,n=oD(t,F0e),{dataKey:i,clockWise:a,id:s,textBreakAll:o,zIndex:l}=n,u=oD(n,q0e),d=V0e(),f=$0e(),p=d||f;return!p||!p.length?null:k.createElement($l,{zIndex:l??$s.label},k.createElement(Os,{className:"recharts-label-list"},p.map((x,v)=>{var w,C=Ta(i)?r(x,v):Ii(x&&x.payload,i),A=Ta(s)?{}:{id:"".concat(s,"-").concat(v)};return k.createElement(Zh,Tb({key:"label-".concat(v)},Tl(x),u,A,{fill:(w=n.fill)!==null&&w!==void 0?w:x.fill,parentViewBox:x.parentViewBox,value:C,textBreakAll:o,viewBox:x.viewBox,index:v,zIndex:0}))})))}bv.displayName="LabelList";function G2(t){var{label:r}=t;return r?r===!0?k.createElement(bv,{key:"labelList-implicit"}):k.isValidElement(r)||__(r)?k.createElement(bv,{key:"labelList-implicit",content:r}):typeof r=="object"?k.createElement(bv,Tb({key:"labelList-implicit"},r,{type:String(r.type)})):null:null}function VN(){return VN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},VN.apply(null,arguments)}var eU=t=>{var{cx:r,cy:n,r:i,className:a}=t,s=hi("recharts-dot",a);return or(r)&&or(n)&&or(i)?k.createElement("circle",VN({},Hl(t),nE(t),{className:s,cx:r,cy:n,r:i})):null},tU=t=>t.graphicalItems.polarItems,G0e=ut([Va,Oy],XE),K2=ut([tU,ls,G0e],JE),K0e=ut([K2],e_),Q2=ut([K0e,D2],t_),Q0e=ut([Q2,ls,K2],n_);ut([Q2,ls,K2],(t,r,n)=>n.length>0?t.flatMap(i=>n.flatMap(a=>{var s,o=Ii(i,(s=r.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):r?.dataKey!=null?t.map(i=>({value:Ii(i,r.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})));var lD=()=>{},Y0e=ut([Q2,ls,K2,q2,Va],o_),Z0e=ut([ls,a_,s_,lD,Y0e,lD,Gn,Va],l_),rU=ut([ls,Gn,Q2,Q0e,Iy,Va,Z0e],c_),X0e=ut([rU,ls,m0],h_);ut([ls,rU,X0e,Va],m_);var J0e={radiusAxis:{},angleAxis:{}},nU=fc({name:"polarAxis",initialState:J0e,reducers:{addRadiusAxis(t,r){t.radiusAxis[r.payload.id]=r.payload},removeRadiusAxis(t,r){delete t.radiusAxis[r.payload.id]},addAngleAxis(t,r){t.angleAxis[r.payload.id]=r.payload},removeAngleAxis(t,r){delete t.angleAxis[r.payload.id]}}}),{addRadiusAxis:t_e,removeRadiusAxis:r_e,addAngleAxis:n_e,removeAngleAxis:i_e}=nU.actions,ege=nU.reducer;function cD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function dD(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?cD(Object(n),!0).forEach(function(i){tge(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function tge(t,r,n){return(r=rge(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function rge(t){var r=nge(t,"string");return typeof r=="symbol"?r:r+""}function nge(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var ige=(t,r)=>r,I_=ut([tU,ige],(t,r)=>t.filter(n=>n.type==="pie").find(n=>n.id===r)),age=[],O_=(t,r,n)=>n?.length===0?age:n,iU=ut([D2,I_,O_],(t,r,n)=>{var{chartData:i}=t;if(r!=null){var a;if(r?.data!=null&&r.data.length>0?a=r.data:a=i,(!a||!a.length)&&n!=null&&(a=n.map(s=>dD(dD({},r.presentationProps),s.props))),a!=null)return a}}),sge=ut([iU,I_,O_],(t,r,n)=>{if(!(t==null||r==null))return t.map((i,a)=>{var s,o=Ii(i,r.nameKey,r.name),l;return n!=null&&(s=n[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=n[a].props.fill:typeof i=="object"&&i!=null&&"fill"in i?l=i.fill:l=r.fill,{value:pf(o,r.dataKey),color:l,payload:i,type:r.legendType}})}),oge=ut([iU,I_,O_,jo],(t,r,n,i)=>{if(!(r==null||t==null))return cye({offset:i,pieSettings:r,displayedData:t,cells:n})}),hS={exports:{}},$i={};var uD;function lge(){if(uD)return $i;uD=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),v=Symbol.for("react.client.reference");function w(C){if(typeof C=="object"&&C!==null){var A=C.$$typeof;switch(A){case t:switch(C=C.type,C){case n:case a:case i:case u:case d:case x:return C;default:switch(C=C&&C.$$typeof,C){case o:case l:case p:case f:return C;case s:return C;default:return A}}case r:return A}}}return $i.ContextConsumer=s,$i.ContextProvider=o,$i.Element=t,$i.ForwardRef=l,$i.Fragment=n,$i.Lazy=p,$i.Memo=f,$i.Portal=r,$i.Profiler=a,$i.StrictMode=i,$i.Suspense=u,$i.SuspenseList=d,$i.isContextConsumer=function(C){return w(C)===s},$i.isContextProvider=function(C){return w(C)===o},$i.isElement=function(C){return typeof C=="object"&&C!==null&&C.$$typeof===t},$i.isForwardRef=function(C){return w(C)===l},$i.isFragment=function(C){return w(C)===n},$i.isLazy=function(C){return w(C)===p},$i.isMemo=function(C){return w(C)===f},$i.isPortal=function(C){return w(C)===r},$i.isProfiler=function(C){return w(C)===a},$i.isStrictMode=function(C){return w(C)===i},$i.isSuspense=function(C){return w(C)===u},$i.isSuspenseList=function(C){return w(C)===d},$i.isValidElementType=function(C){return typeof C=="string"||typeof C=="function"||C===n||C===a||C===i||C===u||C===d||typeof C=="object"&&C!==null&&(C.$$typeof===p||C.$$typeof===f||C.$$typeof===o||C.$$typeof===s||C.$$typeof===l||C.$$typeof===v||C.getModuleId!==void 0)},$i.typeOf=w,$i}var hD;function cge(){return hD||(hD=1,hS.exports=lge()),hS.exports}var dge=cge(),fD=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",mD=null,fS=null,aU=t=>{if(t===mD&&Array.isArray(fS))return fS;var r=[];return k.Children.forEach(t,n=>{Ta(n)||(dge.isFragment(n)?r=r.concat(aU(n.props.children)):r.push(n))}),fS=r,mD=t,r};function k_(t,r){var n=[],i=[];return Array.isArray(r)?i=r.map(a=>fD(a)):i=[fD(r)],aU(t).forEach(a=>{var s=hm(a,"type.displayName")||hm(a,"type.name");s&&i.indexOf(s)!==-1&&n.push(a)}),n}var D_=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,mS={},pD;function uge(){return pD||(pD=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function r(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const a=n[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${a}]`}let i=n;for(;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return Object.getPrototypeOf(n)===i}t.isPlainObject=r})(mS)),mS}var pS,gD;function hge(){return gD||(gD=1,pS=uge().isPlainObject),pS}var fge=hge();const mge=hc(fge);var yD,xD,vD,bD,jD;function wD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function SD(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?wD(Object(n),!0).forEach(function(i){pge(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function pge(t,r,n){return(r=gge(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function gge(t){var r=yge(t,"string");return typeof r=="symbol"?r:r+""}function yge(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Ib(){return Ib=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ib.apply(null,arguments)}function cg(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}var CD=(t,r,n,i,a)=>{var s=n-i,o;return o=As(yD||(yD=cg(["M ",",",""])),t,r),o+=As(xD||(xD=cg(["L ",",",""])),t+n,r),o+=As(vD||(vD=cg(["L ",",",""])),t+n-s/2,r+a),o+=As(bD||(bD=cg(["L ",",",""])),t+n-s/2-i,r+a),o+=As(jD||(jD=cg(["L ",","," Z"])),t,r),o},xge={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},vge=t=>{var r=ks(t,xge),{x:n,y:i,upperWidth:a,lowerWidth:s,height:o,className:l}=r,{animationEasing:u,animationDuration:d,animationBegin:f,isUpdateAnimationActive:p}=r,x=k.useRef(null),[v,w]=k.useState(-1),C=k.useRef(a),A=k.useRef(s),T=k.useRef(o),O=k.useRef(n),D=k.useRef(i),M=l0(t,"trapezoid-");if(k.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var de=x.current.getTotalLength();de&&w(de)}catch{}},[]),n!==+n||i!==+i||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var Q=hi("recharts-trapezoid",l);if(!p)return k.createElement("g",null,k.createElement("path",Ib({},Tl(r),{className:Q,d:CD(n,i,a,s,o)})));var U=C.current,$=A.current,ee=T.current,F=O.current,Y=D.current,J="0px ".concat(v===-1?1:v,"px"),Z="".concat(v,"px 0px"),re=T9(["strokeDasharray"],d,u);return k.createElement(o0,{animationId:M,key:M,canBegin:v>0,duration:d,easing:u,isActive:p,begin:f},de=>{var le=Ti(U,a,de),K=Ti($,s,de),ue=Ti(ee,o,de),ce=Ti(F,n,de),ye=Ti(Y,i,de);x.current&&(C.current=le,A.current=K,T.current=ue,O.current=ce,D.current=ye);var Se=de>0?{transition:re,strokeDasharray:Z}:{strokeDasharray:J};return k.createElement("path",Ib({},Tl(r),{className:Q,d:CD(ce,ye,le,K,ue),ref:x,style:SD(SD({},Se),r.style)}))})},bge=["option","shapeType","activeClassName"];function jge(t,r){if(t==null)return{};var n,i,a=wge(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function wge(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function ND(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Ob(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ND(Object(n),!0).forEach(function(i){Sge(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ND(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Sge(t,r,n){return(r=Cge(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Cge(t){var r=Nge(t,"string");return typeof r=="symbol"?r:r+""}function Nge(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Age(t,r){return Ob(Ob({},r),t)}function Ege(t,r){return t==="symbols"}function AD(t){var{shapeType:r,elementProps:n}=t;switch(r){case"rectangle":return k.createElement(D9,n);case"trapezoid":return k.createElement(vge,n);case"sector":return k.createElement(L9,n);case"symbols":if(Ege(r))return k.createElement(rE,n);break;case"curve":return k.createElement(Ep,n);default:return null}}function _ge(t){return k.isValidElement(t)?t.props:t}function P_(t){var{option:r,shapeType:n,activeClassName:i="recharts-active-shape"}=t,a=jge(t,bge),s;if(k.isValidElement(r))s=k.cloneElement(r,Ob(Ob({},a),_ge(r)));else if(typeof r=="function")s=r(a,a.index);else if(mge(r)&&typeof r!="boolean"){var o=Age(r,a);s=k.createElement(AD,{shapeType:n,elementProps:o})}else{var l=a;s=k.createElement(AD,{shapeType:n,elementProps:l})}return a.isActive?k.createElement(Os,{className:i},s):s}var R_=(t,r,n)=>{var i=pa();return(a,s)=>o=>{t?.(a,s,o),i(xq({activeIndex:String(s),activeDataKey:r,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:n}))}},M_=t=>{var r=pa();return(n,i)=>a=>{t?.(n,i,a),r(Mfe())}},L_=(t,r,n)=>{var i=pa();return(a,s)=>o=>{t?.(a,s,o),i(Lfe({activeIndex:String(s),activeDataKey:r,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:n}))}};function Y2(t){var{tooltipEntrySettings:r}=t,n=pa(),i=Ho(),a=k.useRef(null);return k.useLayoutEffect(()=>{i||(a.current===null?n(kfe(r)):a.current!==r&&n(Dfe({prev:a.current,next:r})),a.current=r)},[r,n,i]),k.useLayoutEffect(()=>()=>{a.current&&(n(Pfe(a.current)),a.current=null)},[n]),null}function z_(t){var{legendPayload:r}=t,n=pa(),i=Ho(),a=k.useRef(null);return k.useLayoutEffect(()=>{i||(a.current===null?n(C9(r)):a.current!==r&&n(N9({prev:a.current,next:r})),a.current=r)},[n,i,r]),k.useLayoutEffect(()=>()=>{a.current&&(n(A9(a.current)),a.current=null)},[n]),null}function Tge(t){var{legendPayload:r}=t,n=pa(),i=wr(Gn),a=k.useRef(null);return k.useLayoutEffect(()=>{i!=="centric"&&i!=="radial"||(a.current===null?n(C9(r)):a.current!==r&&n(N9({prev:a.current,next:r})),a.current=r)},[n,i,r]),k.useLayoutEffect(()=>()=>{a.current&&(n(A9(a.current)),a.current=null)},[n]),null}var gS,Ige=()=>{var[t]=k.useState(()=>Wg("uid-"));return t},Oge=(gS=SV.useId)!==null&&gS!==void 0?gS:Ige;function kge(t,r){var n=Oge();return r||(t?"".concat(t,"-").concat(n):n)}var Dge=k.createContext(void 0),Z2=t=>{var{id:r,type:n,children:i}=t,a=kge("recharts-".concat(n),r);return k.createElement(Dge.Provider,{value:a},i(a))},Pge={cartesianItems:[],polarItems:[]},sU=fc({name:"graphicalItems",initialState:Pge,reducers:{addCartesianGraphicalItem:{reducer(t,r){t.cartesianItems.push(r.payload)},prepare:Ua()},replaceCartesianGraphicalItem:{reducer(t,r){var{prev:n,next:i}=r.payload,a=Nd(t).cartesianItems.indexOf(n);a>-1&&(t.cartesianItems[a]=i)},prepare:Ua()},removeCartesianGraphicalItem:{reducer(t,r){var n=Nd(t).cartesianItems.indexOf(r.payload);n>-1&&t.cartesianItems.splice(n,1)},prepare:Ua()},addPolarGraphicalItem:{reducer(t,r){t.polarItems.push(r.payload)},prepare:Ua()},removePolarGraphicalItem:{reducer(t,r){var n=Nd(t).polarItems.indexOf(r.payload);n>-1&&t.polarItems.splice(n,1)},prepare:Ua()}}}),{addCartesianGraphicalItem:Rge,replaceCartesianGraphicalItem:Mge,removeCartesianGraphicalItem:Lge,addPolarGraphicalItem:zge,removePolarGraphicalItem:Bge}=sU.actions,Fge=sU.reducer,qge=t=>{var r=pa(),n=k.useRef(null);return k.useLayoutEffect(()=>{n.current===null?r(Rge(t)):n.current!==t&&r(Mge({prev:n.current,next:t})),n.current=t},[r,t]),k.useLayoutEffect(()=>()=>{n.current&&(r(Lge(n.current)),n.current=null)},[r]),null},B_=k.memo(qge);function Uge(t){var r=pa();return k.useLayoutEffect(()=>(r(zge(t)),()=>{r(Bge(t))}),[r,t]),null}var Wge=["key"],Hge=["onMouseEnter","onClick","onMouseLeave"],Vge=["id"],$ge=["id"];function ED(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Es(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ED(Object(n),!0).forEach(function(i){Gge(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ED(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Gge(t,r,n){return(r=Kge(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Kge(t){var r=Qge(t,"string");return typeof r=="symbol"?r:r+""}function Qge(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function ff(){return ff=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ff.apply(null,arguments)}function X2(t,r){if(t==null)return{};var n,i,a=Yge(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Yge(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Zge(t){var r=k.useMemo(()=>k_(t.children,Ju),[t.children]),n=wr(i=>sge(i,t.id,r));return n==null?null:k.createElement(Tge,{legendPayload:n})}var Xge=k.memo(t=>{var{dataKey:r,nameKey:n,sectors:i,stroke:a,strokeWidth:s,fill:o,name:l,hide:u,tooltipType:d,id:f}=t,p={dataDefinedOnItem:i.map(x=>x.tooltipPayload),positions:i.map(x=>x.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:r,nameKey:n,name:pf(l,r),hide:u,type:d,color:o,unit:"",graphicalItemId:f}};return k.createElement(Y2,{tooltipEntrySettings:p})}),Jge=(t,r)=>t>r?"start":t<r?"end":"middle",eye=(t,r,n)=>_l(typeof r=="function"?r(t):r,n,n*.8),tye=(t,r,n)=>{var{top:i,left:a,width:s,height:o}=r,l=P9(s,o),u=a+_l(t.cx,s,s/2),d=i+_l(t.cy,o,o/2),f=_l(t.innerRadius,l,0),p=eye(n,t.outerRadius,l),x=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:u,cy:d,innerRadius:f,outerRadius:p,maxRadius:x}},rye=(t,r)=>{var n=Bo(r-t),i=Math.min(Math.abs(r-t),360);return n*i};function nye(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var iye=(t,r)=>{if(k.isValidElement(t))return k.cloneElement(t,r);if(typeof t=="function")return t(r);var n=hi("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:i}=r,a=X2(r,Wge);return k.createElement(Ep,ff({},a,{type:"linear",className:n}))},aye=(t,r,n)=>{if(k.isValidElement(t))return k.cloneElement(t,r);var i=n;if(typeof t=="function"&&(i=t(r),k.isValidElement(i)))return i;var a=hi("recharts-pie-label-text",nye(t));return k.createElement($2,ff({},r,{alignmentBaseline:"middle",className:a}),i)};function sye(t){var{sectors:r,props:n,showLabels:i}=t,{label:a,labelLine:s,dataKey:o}=n;if(!i||!a||!r)return null;var l=Hl(n),u=dm(a),d=dm(s),f=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,p=r.map((x,v)=>{var w=(x.startAngle+x.endAngle)/2,C=ro(x.cx,x.cy,x.outerRadius+f,w),A=Es(Es(Es(Es({},l),x),{},{stroke:"none"},u),{},{index:v,textAnchor:Jge(C.x,x.cx)},C),T=Es(Es(Es(Es({},l),x),{},{fill:"none",stroke:x.fill},d),{},{index:v,points:[ro(x.cx,x.cy,x.outerRadius,w),C],key:"line"});return k.createElement($l,{zIndex:$s.label,key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(v)},k.createElement(Os,null,s&&iye(s,T),aye(a,A,Ii(x,o))))});return k.createElement(Os,{className:"recharts-pie-labels"},p)}function oye(t){var{sectors:r,props:n,showLabels:i}=t,{label:a}=n;return typeof a=="object"&&a!=null&&"position"in a?k.createElement(G2,{label:a}):k.createElement(sye,{sectors:r,props:n,showLabels:i})}function lye(t){var{sectors:r,activeShape:n,inactiveShape:i,allOtherPieProps:a,shape:s,id:o}=t,l=wr(hf),u=wr(S_),d=wr(wme),{onMouseEnter:f,onClick:p,onMouseLeave:x}=a,v=X2(a,Hge),w=R_(f,a.dataKey,o),C=M_(x),A=L_(p,a.dataKey,o);return r==null||r.length===0?null:k.createElement(k.Fragment,null,r.map((T,O)=>{if(T?.startAngle===0&&T?.endAngle===0&&r.length!==1)return null;var D=d==null||d===o,M=String(O)===l&&(u==null||a.dataKey===u)&&D,Q=l?i:null,U=n&&M?n:Q,$=Es(Es({},T),{},{stroke:T.stroke,tabIndex:-1,[d9]:O,[u9]:o});return k.createElement(Os,ff({key:"sector-".concat(T?.startAngle,"-").concat(T?.endAngle,"-").concat(T.midAngle,"-").concat(O),tabIndex:-1,className:"recharts-pie-sector"},by(v,T,O),{onMouseEnter:w(T,O),onMouseLeave:C(T,O),onClick:A(T,O)}),k.createElement(P_,ff({option:s??U,index:O,shapeType:"sector",isActive:M},$)))}))}function cye(t){var r,{pieSettings:n,displayedData:i,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:u,dataKey:d,nameKey:f,tooltipType:p}=n,x=Math.abs(n.minAngle),v=rye(l,u),w=Math.abs(v),C=i.length<=1?0:(r=n.paddingAngle)!==null&&r!==void 0?r:0,A=i.filter(U=>Ii(U,d,0)!==0).length,T=(w>=360?A:A-1)*C,O=w-A*x-T,D=i.reduce((U,$)=>{var ee=Ii($,d,0);return U+(or(ee)?ee:0)},0),M;if(D>0){var Q;M=i.map((U,$)=>{var ee=Ii(U,d,0),F=Ii(U,f,$),Y=tye(n,s,U),J=(or(ee)?ee:0)/D,Z,re=Es(Es({},U),a&&a[$]&&a[$].props);$?Z=Q.endAngle+Bo(v)*C*(ee!==0?1:0):Z=l;var de=Z+Bo(v)*((ee!==0?x:0)+J*O),le=(Z+de)/2,K=(Y.innerRadius+Y.outerRadius)/2,ue=[{name:F,value:ee,payload:re,dataKey:d,type:p,graphicalItemId:n.id}],ce=ro(Y.cx,Y.cy,K,le);return Q=Es(Es(Es(Es({},n.presentationProps),{},{percent:J,cornerRadius:typeof o=="string"?parseFloat(o):o,name:F,tooltipPayload:ue,midAngle:le,middleRadius:K,tooltipPosition:ce},re),Y),{},{value:ee,dataKey:d,startAngle:Z,endAngle:de,payload:re,paddingAngle:Bo(v)*C}),Q})}return M}function dye(t){var{showLabels:r,sectors:n,children:i}=t,a=k.useMemo(()=>!r||!n?[]:n.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[n,r]);return k.createElement(H0e,{value:r?a:void 0},i)}function uye(t){var{props:r,previousSectorsRef:n,id:i}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:u,activeShape:d,inactiveShape:f,onAnimationStart:p,onAnimationEnd:x}=r,v=l0(r,"recharts-pie-"),w=n.current,[C,A]=k.useState(!1),T=k.useCallback(()=>{typeof x=="function"&&x(),A(!1)},[x]),O=k.useCallback(()=>{typeof p=="function"&&p(),A(!0)},[p]);return k.createElement(dye,{showLabels:!C,sectors:a},k.createElement(o0,{animationId:v,begin:o,duration:l,isActive:s,easing:u,onAnimationStart:O,onAnimationEnd:T,key:v},D=>{var M=[],Q=a&&a[0],U=Q?.startAngle;return a?.forEach(($,ee)=>{var F=w&&w[ee],Y=ee>0?hm($,"paddingAngle",0):0;if(F){var J=Ti(F.endAngle-F.startAngle,$.endAngle-$.startAngle,D),Z=Es(Es({},$),{},{startAngle:U+Y,endAngle:U+J+Y});M.push(Z),U=Z.endAngle}else{var{endAngle:re,startAngle:de}=$,le=Ti(0,re-de,D),K=Es(Es({},$),{},{startAngle:U+Y,endAngle:U+le+Y});M.push(K),U=K.endAngle}}),n.current=M,k.createElement(Os,null,k.createElement(lye,{sectors:M,activeShape:d,inactiveShape:f,allOtherPieProps:r,shape:r.shape,id:i}))}),k.createElement(oye,{showLabels:!C,sectors:a,props:r}),r.children)}var hye={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:$s.area};function fye(t){var{id:r}=t,n=X2(t,Vge),{hide:i,className:a,rootTabIndex:s}=t,o=k.useMemo(()=>k_(t.children,Ju),[t.children]),l=wr(f=>oge(f,r,o)),u=k.useRef(null),d=hi("recharts-pie",a);return i||l==null?(u.current=null,k.createElement(Os,{tabIndex:s,className:d})):k.createElement($l,{zIndex:t.zIndex},k.createElement(Xge,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:r}),k.createElement(Os,{tabIndex:s,className:d},k.createElement(uye,{props:Es(Es({},n),{},{sectors:l}),previousSectorsRef:u,id:r})))}function Tp(t){var r=ks(t,hye),{id:n}=r,i=X2(r,$ge),a=Hl(i);return k.createElement(Z2,{id:n,type:"pie"},s=>k.createElement(k.Fragment,null,k.createElement(Uge,{type:"pie",id:s,data:i.data,dataKey:i.dataKey,hide:i.hide,angleAxisId:0,radiusAxisId:0,name:i.name,nameKey:i.nameKey,tooltipType:i.tooltipType,legendType:i.legendType,fill:i.fill,cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,paddingAngle:i.paddingAngle,minAngle:i.minAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius,cornerRadius:i.cornerRadius,presentationProps:a,maxRadius:r.maxRadius}),k.createElement(Zge,ff({},i,{id:s})),k.createElement(fye,ff({},i,{id:s}))))}Tp.displayName="Pie";var mye=["points"];function _D(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function yS(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?_D(Object(n),!0).forEach(function(i){pye(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_D(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function pye(t,r,n){return(r=gye(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function gye(t){var r=yye(t,"string");return typeof r=="symbol"?r:r+""}function yye(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function kb(){return kb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},kb.apply(null,arguments)}function xye(t,r){if(t==null)return{};var n,i,a=vye(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function vye(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function bye(t){var{option:r,dotProps:n,className:i}=t;if(k.isValidElement(r))return k.cloneElement(r,n);if(typeof r=="function")return r(n);var a=hi(i,typeof r!="boolean"?r.className:""),s=n??{},{points:o}=s,l=xye(s,mye);return k.createElement(eU,kb({},l,{className:a}))}function jye(t,r){return t==null?!1:r?!0:t.length===1}function oU(t){var{points:r,dot:n,className:i,dotClassName:a,dataKey:s,baseProps:o,needClip:l,clipPathId:u,zIndex:d=$s.scatter}=t;if(!jye(r,n))return null;var f=D_(n),p=Fne(n),x=r.map((w,C)=>{var A,T,O=yS(yS(yS({r:3},o),p),{},{index:C,cx:(A=w.x)!==null&&A!==void 0?A:void 0,cy:(T=w.y)!==null&&T!==void 0?T:void 0,dataKey:s,value:w.value,payload:w.payload,points:r});return k.createElement(bye,{key:"dot-".concat(C),option:n,dotProps:O,className:a})}),v={};return l&&u!=null&&(v.clipPath="url(#clipPath-".concat(f?"":"dots-").concat(u,")")),k.createElement($l,{zIndex:d},k.createElement(Os,kb({className:i},v),x))}function TD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function ID(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?TD(Object(n),!0).forEach(function(i){wye(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function wye(t,r,n){return(r=Sye(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Sye(t){var r=Cye(t,"string");return typeof r=="symbol"?r:r+""}function Cye(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var lU=0,Nye={xAxis:{},yAxis:{},zAxis:{}},cU=fc({name:"cartesianAxis",initialState:Nye,reducers:{addXAxis:{reducer(t,r){t.xAxis[r.payload.id]=r.payload},prepare:Ua()},replaceXAxis:{reducer(t,r){var{prev:n,next:i}=r.payload;t.xAxis[n.id]!==void 0&&(n.id!==i.id&&delete t.xAxis[n.id],t.xAxis[i.id]=i)},prepare:Ua()},removeXAxis:{reducer(t,r){delete t.xAxis[r.payload.id]},prepare:Ua()},addYAxis:{reducer(t,r){t.yAxis[r.payload.id]=r.payload},prepare:Ua()},replaceYAxis:{reducer(t,r){var{prev:n,next:i}=r.payload;t.yAxis[n.id]!==void 0&&(n.id!==i.id&&delete t.yAxis[n.id],t.yAxis[i.id]=i)},prepare:Ua()},removeYAxis:{reducer(t,r){delete t.yAxis[r.payload.id]},prepare:Ua()},addZAxis:{reducer(t,r){t.zAxis[r.payload.id]=r.payload},prepare:Ua()},replaceZAxis:{reducer(t,r){var{prev:n,next:i}=r.payload;t.zAxis[n.id]!==void 0&&(n.id!==i.id&&delete t.zAxis[n.id],t.zAxis[i.id]=i)},prepare:Ua()},removeZAxis:{reducer(t,r){delete t.zAxis[r.payload.id]},prepare:Ua()},updateYAxisWidth(t,r){var{id:n,width:i}=r.payload,a=t.yAxis[n];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&i===s[1]&&i!==a.width&&Math.abs(i-s[0])<=1)return;var o=[...s,i].slice(-3);t.yAxis[n]=ID(ID({},t.yAxis[n]),{},{width:i,widthHistory:o})}}}}),{addXAxis:Aye,replaceXAxis:Eye,removeXAxis:_ye,addYAxis:Tye,replaceYAxis:Iye,removeYAxis:Oye,addZAxis:a_e,replaceZAxis:s_e,removeZAxis:o_e,updateYAxisWidth:kye}=cU.actions,Dye=cU.reducer,Pye=ut([jo],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),Rye=ut([Pye,gh,yh],(t,r,n)=>{if(!(!t||r==null||n==null))return{x:t.left,y:t.top,width:Math.max(0,r-t.left-t.right),height:Math.max(0,n-t.top-t.bottom)}}),J2=()=>wr(Rye),Mye=()=>wr(Eme);function OD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function xS(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?OD(Object(n),!0).forEach(function(i){Lye(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Lye(t,r,n){return(r=zye(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function zye(t){var r=Bye(t,"string");return typeof r=="symbol"?r:r+""}function Bye(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var Fye=t=>{var{point:r,childIndex:n,mainColor:i,activeDot:a,dataKey:s,clipPath:o}=t;if(a===!1||r.x==null||r.y==null)return null;var l={index:n,dataKey:s,cx:r.x,cy:r.y,r:4,fill:i??"none",strokeWidth:2,stroke:"#fff",payload:r.payload,value:r.value},u=xS(xS(xS({},l),dm(a)),nE(a)),d;return k.isValidElement(a)?d=k.cloneElement(a,u):typeof a=="function"?d=a(u):d=k.createElement(eU,u),k.createElement(Os,{className:"recharts-active-dot",clipPath:o},d)};function $N(t){var{points:r,mainColor:n,activeDot:i,itemDataKey:a,clipPath:s,zIndex:o=$s.activeDot}=t,l=wr(hf),u=Mye();if(r==null||u==null)return null;var d=r.find(f=>u.includes(f.payload));return Ta(d)?null:k.createElement($l,{zIndex:o},k.createElement(Fye,{point:d,childIndex:Number(l),mainColor:n,dataKey:a,activeDot:i,clipPath:s}))}var kD=(t,r,n)=>{var i=n??t;if(!Ta(i))return _l(i,r,0)},qye=(t,r,n)=>{var i={},a=t.filter(L2),s=t.filter(d=>d.stackId==null),o=a.reduce((d,f)=>(d[f.stackId]||(d[f.stackId]=[]),d[f.stackId].push(f),d),i),l=Object.entries(o).map(d=>{var[f,p]=d,x=p.map(w=>w.dataKey),v=kD(r,n,p[0].barSize);return{stackId:f,dataKeys:x,barSize:v}}),u=s.map(d=>{var f=[d.dataKey].filter(x=>x!=null),p=kD(r,n,d.barSize);return{stackId:void 0,dataKeys:f,barSize:p}});return[...l,...u]};function DD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function a1(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?DD(Object(n),!0).forEach(function(i){Uye(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):DD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Uye(t,r,n){return(r=Wye(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Wye(t){var r=Hye(t,"string");return typeof r=="symbol"?r:r+""}function Hye(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Vye(t,r,n,i,a){var s=i.length;if(!(s<1)){var o=_l(t,n,0,!0),l,u=[];if(oa(i[0].barSize)){var d=!1,f=n/s,p=i.reduce((T,O)=>T+(O.barSize||0),0);p+=(s-1)*o,p>=n&&(p-=(s-1)*o,o=0),p>=n&&f>0&&(d=!0,f*=.9,p=s*f);var x=(n-p)/2>>0,v={offset:x-o,size:0};l=i.reduce((T,O)=>{var D,M={stackId:O.stackId,dataKeys:O.dataKeys,position:{offset:v.offset+v.size+o,size:d?f:(D=O.barSize)!==null&&D!==void 0?D:0}},Q=[...T,M];return v=Q[Q.length-1].position,Q},u)}else{var w=_l(r,n,0,!0);n-2*w-(s-1)*o<=0&&(o=0);var C=(n-2*w-(s-1)*o)/s;C>1&&(C>>=0);var A=oa(a)?Math.min(C,a):C;l=i.reduce((T,O,D)=>[...T,{stackId:O.stackId,dataKeys:O.dataKeys,position:{offset:w+(C+o)*D+(C-A)/2,size:A}}],u)}return l}}var $ye=(t,r,n,i,a,s,o)=>{var l=Ta(o)?r:o,u=Vye(n,i,a!==s?a:s,t,l);return a!==s&&u!=null&&(u=u.map(d=>a1(a1({},d),{},{position:a1(a1({},d.position),{},{offset:d.position.offset-a/2})}))),u},Gye=(t,r)=>{var n=M2(r);if(!(!t||n==null||r==null)){var{stackId:i}=r;if(i!=null){var a=t[i];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===n)}}}};function Kye(t,r){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&oa(t.zIndex)?t.zIndex:r}var dU=t=>{var{chartData:r}=t,n=pa(),i=Ho();return k.useEffect(()=>i?()=>{}:(n(Fk(r)),()=>{n(Fk(void 0))}),[r,n,i]),null},PD={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},uU=fc({name:"brush",initialState:PD,reducers:{setBrushSettings(t,r){return r.payload==null?PD:r.payload}}}),{setBrushSettings:l_e}=uU.actions,Qye=uU.reducer;function Yye(t,r,n){return(r=Zye(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Zye(t){var r=Xye(t,"string");return typeof r=="symbol"?r:r+""}function Xye(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}class F_{static create(r){return new F_(r)}constructor(r){this.scale=r}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(r){var{bandAware:n,position:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}return this.scale(r)}}isInRange(r){var n=this.range(),i=n[0],a=n[n.length-1];return i<=a?r>=i&&r<=a:r>=a&&r<=i}}Yye(F_,"EPS",1e-4);function Jye(t){return(t%180+180)%180}var exe=function(r){var{width:n,height:i}=r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=Jye(a),o=s*Math.PI/180,l=Math.atan(i/n),u=o>l&&o<Math.PI-l?i/Math.sin(o):n/Math.cos(o);return Math.abs(u)},txe={dots:[],areas:[],lines:[]},hU=fc({name:"referenceElements",initialState:txe,reducers:{addDot:(t,r)=>{t.dots.push(r.payload)},removeDot:(t,r)=>{var n=Nd(t).dots.findIndex(i=>i===r.payload);n!==-1&&t.dots.splice(n,1)},addArea:(t,r)=>{t.areas.push(r.payload)},removeArea:(t,r)=>{var n=Nd(t).areas.findIndex(i=>i===r.payload);n!==-1&&t.areas.splice(n,1)},addLine:(t,r)=>{t.lines.push(r.payload)},removeLine:(t,r)=>{var n=Nd(t).lines.findIndex(i=>i===r.payload);n!==-1&&t.lines.splice(n,1)}}}),{addDot:c_e,removeDot:d_e,addArea:u_e,removeArea:h_e,addLine:f_e,removeLine:m_e}=hU.actions,rxe=hU.reducer,nxe=k.createContext(void 0),ixe=t=>{var{children:r}=t,[n]=k.useState("".concat(Wg("recharts"),"-clip")),i=J2();if(i==null)return null;var{x:a,y:s,width:o,height:l}=i;return k.createElement(nxe.Provider,{value:n},k.createElement("defs",null,k.createElement("clipPath",{id:n},k.createElement("rect",{x:a,y:s,height:l,width:o}))),r)};function fU(t,r){if(r<1)return[];if(r===1)return t;for(var n=[],i=0;i<t.length;i+=r){var a=t[i];a!==void 0&&n.push(a)}return n}function axe(t,r,n){var i={width:t.width+r.width,height:t.height+r.height};return exe(i,n)}function sxe(t,r,n){var i=n==="width",{x:a,y:s,width:o,height:l}=t;return r===1?{start:i?a:s,end:i?a+o:s+l}:{start:i?a+o:s+l,end:i?a:s}}function ny(t,r,n,i,a){if(t*r<t*i||t*r>t*a)return!1;var s=n();return t*(r-t*s/2-i)>=0&&t*(r+t*s/2-a)<=0}function oxe(t,r){return fU(t,r+1)}function lxe(t,r,n,i,a){for(var s=(i||[]).slice(),{start:o,end:l}=r,u=0,d=1,f=o,p=function(){var w=i?.[u];if(w===void 0)return{v:fU(i,d)};var C=u,A,T=()=>(A===void 0&&(A=n(w,C)),A),O=w.coordinate,D=u===0||ny(t,O,T,f,l);D||(u=0,f=o,d+=1),D&&(f=O+t*(T()/2+a),u+=d)},x;d<=s.length;)if(x=p(),x)return x.v;return[]}function cxe(t,r,n,i,a){var s=(i||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:u}=r,d=1;d<=o;d++){for(var f=(o-1)%d,p=l,x=!0,v=function(){var O=i[w],D=w,M,Q=()=>(M===void 0&&(M=n(O,D)),M),U=O.coordinate,$=w===f||ny(t,U,Q,p,u);if(!$)return x=!1,1;$&&(p=U+t*(Q()/2+a))},w=f;w<o&&!v();w+=d);if(x){for(var C=[],A=f;A<o;A+=d)C.push(i[A]);return C}}return[]}function RD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Nl(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?RD(Object(n),!0).forEach(function(i){dxe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function dxe(t,r,n){return(r=uxe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function uxe(t){var r=hxe(t,"string");return typeof r=="symbol"?r:r+""}function hxe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function fxe(t,r,n,i,a){for(var s=(i||[]).slice(),o=s.length,{start:l}=r,{end:u}=r,d=function(x){var v=s[x],w,C=()=>(w===void 0&&(w=n(v,x)),w);if(x===o-1){var A=t*(v.coordinate+t*C()/2-u);s[x]=v=Nl(Nl({},v),{},{tickCoord:A>0?v.coordinate-A*t:v.coordinate})}else s[x]=v=Nl(Nl({},v),{},{tickCoord:v.coordinate});if(v.tickCoord!=null){var T=ny(t,v.tickCoord,C,l,u);T&&(u=v.tickCoord-t*(C()/2+a),s[x]=Nl(Nl({},v),{},{isShow:!0}))}},f=o-1;f>=0;f--)d(f);return s}function mxe(t,r,n,i,a,s){var o=(i||[]).slice(),l=o.length,{start:u,end:d}=r;if(s){var f=i[l-1],p=n(f,l-1),x=t*(f.coordinate+t*p/2-d);if(o[l-1]=f=Nl(Nl({},f),{},{tickCoord:x>0?f.coordinate-x*t:f.coordinate}),f.tickCoord!=null){var v=ny(t,f.tickCoord,()=>p,u,d);v&&(d=f.tickCoord-t*(p/2+a),o[l-1]=Nl(Nl({},f),{},{isShow:!0}))}}for(var w=s?l-1:l,C=function(O){var D=o[O],M,Q=()=>(M===void 0&&(M=n(D,O)),M);if(O===0){var U=t*(D.coordinate-t*Q()/2-u);o[O]=D=Nl(Nl({},D),{},{tickCoord:U<0?D.coordinate-U*t:D.coordinate})}else o[O]=D=Nl(Nl({},D),{},{tickCoord:D.coordinate});if(D.tickCoord!=null){var $=ny(t,D.tickCoord,Q,u,d);$&&(u=D.tickCoord+t*(Q()/2+a),o[O]=Nl(Nl({},D),{},{isShow:!0}))}},A=0;A<w;A++)C(A);return o}function q_(t,r,n){var{tick:i,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:u,tickFormatter:d,unit:f,angle:p}=t;if(!a||!a.length||!i)return[];if(or(u)||Ny.isSsr){var x;return(x=oxe(a,or(u)?u:0))!==null&&x!==void 0?x:[]}var v=[],w=l==="top"||l==="bottom"?"width":"height",C=f&&w==="width"?kg(f,{fontSize:r,letterSpacing:n}):{width:0,height:0},A=(D,M)=>{var Q=typeof d=="function"?d(D.value,M):D.value;return w==="width"?axe(kg(Q,{fontSize:r,letterSpacing:n}),C,p):kg(Q,{fontSize:r,letterSpacing:n})[w]},T=a.length>=2?Bo(a[1].coordinate-a[0].coordinate):1,O=sxe(s,T,w);return u==="equidistantPreserveStart"?lxe(T,O,A,a,o):u==="equidistantPreserveEnd"?cxe(T,O,A,a,o):(u==="preserveStart"||u==="preserveStartEnd"?v=mxe(T,O,A,a,o,u==="preserveStartEnd"):v=fxe(T,O,A,a,o),v.filter(D=>D.isShow))}var pxe=t=>{var{ticks:r,label:n,labelGapWithTick:i=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(r){Array.from(r).forEach(f=>{if(f){var p=f.getBoundingClientRect();p.width>o&&(o=p.width)}});var l=n?n.getBoundingClientRect().width:0,u=a+s,d=o+u+l+(n?i:0);return Math.round(d)}return 0},gxe=["axisLine","width","height","className","hide","ticks","axisType"];function yxe(t,r){if(t==null)return{};var n,i,a=xxe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function xxe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function ym(){return ym=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ym.apply(null,arguments)}function MD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function to(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?MD(Object(n),!0).forEach(function(i){vxe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function vxe(t,r,n){return(r=bxe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function bxe(t){var r=jxe(t,"string");return typeof r=="symbol"?r:r+""}function jxe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var eh={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:$s.axis};function wxe(t){var{x:r,y:n,width:i,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:u}=t;if(!l)return null;var d=to(to(to({},u),Hl(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var f=+(s==="top"&&!o||s==="bottom"&&o);d=to(to({},d),{},{x1:r,y1:n+f*a,x2:r+i,y2:n+f*a})}else{var p=+(s==="left"&&!o||s==="right"&&o);d=to(to({},d),{},{x1:r+p*i,y1:n,x2:r+p*i,y2:n+a})}return k.createElement("line",ym({},d,{className:hi("recharts-cartesian-axis-line",hm(l,"className"))}))}function Sxe(t,r,n,i,a,s,o,l,u){var d,f,p,x,v,w,C=l?-1:1,A=t.tickSize||o,T=or(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":d=f=t.coordinate,x=n+ +!l*a,p=x-C*A,w=p-C*u,v=T;break;case"left":p=x=t.coordinate,f=r+ +!l*i,d=f-C*A,v=d-C*u,w=T;break;case"right":p=x=t.coordinate,f=r+ +l*i,d=f+C*A,v=d+C*u,w=T;break;default:d=f=t.coordinate,x=n+ +l*a,p=x+C*A,w=p+C*u,v=T;break}return{line:{x1:d,y1:p,x2:f,y2:x},tick:{x:v,y:w}}}function Cxe(t,r){switch(t){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}function Nxe(t,r){switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}function Axe(t){var{option:r,tickProps:n,value:i}=t,a,s=hi(n.className,"recharts-cartesian-axis-tick-value");if(k.isValidElement(r))a=k.cloneElement(r,to(to({},n),{},{className:s}));else if(typeof r=="function")a=r(to(to({},n),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof r!="boolean"&&(o=hi(o,r?.className)),a=k.createElement($2,ym({},n,{className:o}),i)}return a}var Exe=k.forwardRef((t,r)=>{var{ticks:n=[],tick:i,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:u,tickTextProps:d,orientation:f,mirror:p,x,y:v,width:w,height:C,tickSize:A,tickMargin:T,fontSize:O,letterSpacing:D,getTicksConfig:M,events:Q,axisType:U}=t,$=q_(to(to({},M),{},{ticks:n}),O,D),ee=Cxe(f,p),F=Nxe(f,p),Y=Hl(M),J=dm(i),Z={};typeof a=="object"&&(Z=a);var re=to(to({},Y),{},{fill:"none"},Z),de=$.map(ue=>to({entry:ue},Sxe(ue,x,v,w,C,f,A,p,T))),le=de.map(ue=>{var{entry:ce,line:ye}=ue;return k.createElement(Os,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(ce.value,"-").concat(ce.coordinate,"-").concat(ce.tickCoord)},a&&k.createElement("line",ym({},re,ye,{className:hi("recharts-cartesian-axis-tick-line",hm(a,"className"))})))}),K=de.map((ue,ce)=>{var{entry:ye,tick:Se}=ue,V=to(to(to(to({textAnchor:ee,verticalAnchor:F},Y),{},{stroke:"none",fill:s},J),Se),{},{index:ce,payload:ye,visibleTicksCount:$.length,tickFormatter:o,padding:u},d);return k.createElement(Os,ym({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ye.value,"-").concat(ye.coordinate,"-").concat(ye.tickCoord)},by(Q,ye,ce)),i&&k.createElement(Axe,{option:i,tickProps:V,value:"".concat(typeof o=="function"?o(ye.value,ce):ye.value).concat(l||"")}))});return k.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(U,"-ticks")},K.length>0&&k.createElement($l,{zIndex:$s.label},k.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(U,"-tick-labels"),ref:r},K)),le.length>0&&k.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(U,"-tick-lines")},le))}),_xe=k.forwardRef((t,r)=>{var{axisLine:n,width:i,height:a,className:s,hide:o,ticks:l,axisType:u}=t,d=yxe(t,gxe),[f,p]=k.useState(""),[x,v]=k.useState(""),w=k.useRef(null);k.useImperativeHandle(r,()=>({getCalculatedWidth:()=>{var A;return pxe({ticks:w.current,label:(A=t.labelRef)===null||A===void 0?void 0:A.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var C=k.useCallback(A=>{if(A){var T=A.getElementsByClassName("recharts-cartesian-axis-tick-value");w.current=T;var O=T[0];if(O){var D=window.getComputedStyle(O),M=D.fontSize,Q=D.letterSpacing;(M!==f||Q!==x)&&(p(M),v(Q))}}},[f,x]);return o||i!=null&&i<=0||a!=null&&a<=0?null:k.createElement($l,{zIndex:t.zIndex},k.createElement(Os,{className:hi("recharts-cartesian-axis",s)},k.createElement(wxe,{x:t.x,y:t.y,width:i,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:n,otherSvgProps:Hl(t)}),k.createElement(Exe,{ref:C,axisType:u,events:d,fontSize:f,getTicksConfig:t,height:t.height,letterSpacing:x,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),k.createElement(S0e,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},k.createElement(D0e,{label:t.label,labelRef:t.labelRef}),t.children)))}),U_=k.forwardRef((t,r)=>{var n=ks(t,eh);return k.createElement(_xe,ym({},n,{ref:r}))});U_.displayName="CartesianAxis";var Txe=["x1","y1","x2","y2","key"],Ixe=["offset"],Oxe=["xAxisId","yAxisId"],kxe=["xAxisId","yAxisId"];function LD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Al(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?LD(Object(n),!0).forEach(function(i){Dxe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Dxe(t,r,n){return(r=Pxe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Pxe(t){var r=Rxe(t,"string");return typeof r=="symbol"?r:r+""}function Rxe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Gf(){return Gf=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Gf.apply(null,arguments)}function Db(t,r){if(t==null)return{};var n,i,a=Mxe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Mxe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var Lxe=t=>{var{fill:r}=t;if(!r||r==="none")return null;var{fillOpacity:n,x:i,y:a,width:s,height:o,ry:l}=t;return k.createElement("rect",{x:i,y:a,ry:l,width:s,height:o,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function mU(t){var{option:r,lineItemProps:n}=t,i;if(k.isValidElement(r))i=k.cloneElement(r,n);else if(typeof r=="function")i=r(n);else{var a,{x1:s,y1:o,x2:l,y2:u,key:d}=n,f=Db(n,Txe),p=(a=Hl(f))!==null&&a!==void 0?a:{},{offset:x}=p,v=Db(p,Ixe);i=k.createElement("line",Gf({},v,{x1:s,y1:o,x2:l,y2:u,fill:"none",key:d}))}return i}function zxe(t){var{x:r,width:n,horizontal:i=!0,horizontalPoints:a}=t;if(!i||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=t,l=Db(t,Oxe),u=a.map((d,f)=>{var p=Al(Al({},l),{},{x1:r,y1:d,x2:r+n,y2:d,key:"line-".concat(f),index:f});return k.createElement(mU,{key:"line-".concat(f),option:i,lineItemProps:p})});return k.createElement("g",{className:"recharts-cartesian-grid-horizontal"},u)}function Bxe(t){var{y:r,height:n,vertical:i=!0,verticalPoints:a}=t;if(!i||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=t,l=Db(t,kxe),u=a.map((d,f)=>{var p=Al(Al({},l),{},{x1:d,y1:r,x2:d,y2:r+n,key:"line-".concat(f),index:f});return k.createElement(mU,{option:i,lineItemProps:p,key:"line-".concat(f)})});return k.createElement("g",{className:"recharts-cartesian-grid-vertical"},u)}function Fxe(t){var{horizontalFill:r,fillOpacity:n,x:i,y:a,width:s,height:o,horizontalPoints:l,horizontal:u=!0}=t;if(!u||!r||!r.length||l==null)return null;var d=l.map(p=>Math.round(p+a-a)).sort((p,x)=>p-x);a!==d[0]&&d.unshift(0);var f=d.map((p,x)=>{var v=!d[x+1],w=v?a+o-p:d[x+1]-p;if(w<=0)return null;var C=x%r.length;return k.createElement("rect",{key:"react-".concat(x),y:p,x:i,height:w,width:s,stroke:"none",fill:r[C],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return k.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function qxe(t){var{vertical:r=!0,verticalFill:n,fillOpacity:i,x:a,y:s,width:o,height:l,verticalPoints:u}=t;if(!r||!n||!n.length)return null;var d=u.map(p=>Math.round(p+a-a)).sort((p,x)=>p-x);a!==d[0]&&d.unshift(0);var f=d.map((p,x)=>{var v=!d[x+1],w=v?a+o-p:d[x+1]-p;if(w<=0)return null;var C=x%n.length;return k.createElement("rect",{key:"react-".concat(x),x:p,y:s,width:w,height:l,stroke:"none",fill:n[C],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return k.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Uxe=(t,r)=>{var{xAxis:n,width:i,height:a,offset:s}=t;return s9(q_(Al(Al(Al({},eh),n),{},{ticks:o9(n),viewBox:{x:0,y:0,width:i,height:a}})),s.left,s.left+s.width,r)},Wxe=(t,r)=>{var{yAxis:n,width:i,height:a,offset:s}=t;return s9(q_(Al(Al(Al({},eh),n),{},{ticks:o9(n),viewBox:{x:0,y:0,width:i,height:a}})),s.top,s.top+s.height,r)},Hxe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:$s.grid};function Qu(t){var r=pE(),n=gE(),i=g9(),a=Al(Al({},ks(t,Hxe)),{},{x:or(t.x)?t.x:i.left,y:or(t.y)?t.y:i.top,width:or(t.width)?t.width:i.width,height:or(t.height)?t.height:i.height}),{xAxisId:s,yAxisId:o,x:l,y:u,width:d,height:f,syncWithTicks:p,horizontalValues:x,verticalValues:v}=a,w=Ho(),C=wr(F=>_k(F,"xAxis",s,w)),A=wr(F=>_k(F,"yAxis",o,w));if(!hu(d)||!hu(f)||!or(l)||!or(u))return null;var T=a.verticalCoordinatesGenerator||Uxe,O=a.horizontalCoordinatesGenerator||Wxe,{horizontalPoints:D,verticalPoints:M}=a;if((!D||!D.length)&&typeof O=="function"){var Q=x&&x.length,U=O({yAxis:A?Al(Al({},A),{},{ticks:Q?x:A.ticks}):void 0,width:r??d,height:n??f,offset:i},Q?!0:p);ab(Array.isArray(U),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof U,"]")),Array.isArray(U)&&(D=U)}if((!M||!M.length)&&typeof T=="function"){var $=v&&v.length,ee=T({xAxis:C?Al(Al({},C),{},{ticks:$?v:C.ticks}):void 0,width:r??d,height:n??f,offset:i},$?!0:p);ab(Array.isArray(ee),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof ee,"]")),Array.isArray(ee)&&(M=ee)}return k.createElement($l,{zIndex:a.zIndex},k.createElement("g",{className:"recharts-cartesian-grid"},k.createElement(Lxe,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),k.createElement(Fxe,Gf({},a,{horizontalPoints:D})),k.createElement(qxe,Gf({},a,{verticalPoints:M})),k.createElement(zxe,Gf({},a,{offset:i,horizontalPoints:D,xAxis:C,yAxis:A})),k.createElement(Bxe,Gf({},a,{offset:i,verticalPoints:M,xAxis:C,yAxis:A}))))}Qu.displayName="CartesianGrid";var Vxe={},pU=fc({name:"errorBars",initialState:Vxe,reducers:{addErrorBar:(t,r)=>{var{itemId:n,errorBar:i}=r.payload;t[n]||(t[n]=[]),t[n].push(i)},replaceErrorBar:(t,r)=>{var{itemId:n,prev:i,next:a}=r.payload;t[n]&&(t[n]=t[n].map(s=>s.dataKey===i.dataKey&&s.direction===i.direction?a:s))},removeErrorBar:(t,r)=>{var{itemId:n,errorBar:i}=r.payload;t[n]&&(t[n]=t[n].filter(a=>a.dataKey!==i.dataKey||a.direction!==i.direction))}}}),{addErrorBar:p_e,replaceErrorBar:g_e,removeErrorBar:y_e}=pU.actions,$xe=pU.reducer,Gxe=["children"];function Kxe(t,r){if(t==null)return{};var n,i,a=Qxe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Qxe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var Yxe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Zxe=k.createContext(Yxe);function gU(t){var{children:r}=t,n=Kxe(t,Gxe);return k.createElement(Zxe.Provider,{value:n},r)}function ej(t,r){var n,i,a=wr(d=>bh(d,t)),s=wr(d=>jh(d,r)),o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:Ro.allowDataOverflow,l=(i=s?.allowDataOverflow)!==null&&i!==void 0?i:Mo.allowDataOverflow,u=o||l;return{needClip:u,needClipX:o,needClipY:l}}function W_(t){var{xAxisId:r,yAxisId:n,clipPathId:i}=t,a=J2(),{needClipX:s,needClipY:o,needClip:l}=ej(r,n);if(!l||!a)return null;var{x:u,y:d,width:f,height:p}=a;return k.createElement("clipPath",{id:"clipPath-".concat(i)},k.createElement("rect",{x:s?u:u-f/2,y:o?d:d-p/2,width:s?f:f*2,height:o?p:p*2}))}var yU=(t,r,n,i)=>pu(t,"xAxis",r,i),xU=(t,r,n,i)=>mu(t,"xAxis",r,i),vU=(t,r,n,i)=>pu(t,"yAxis",n,i),bU=(t,r,n,i)=>mu(t,"yAxis",n,i),Xxe=ut([Gn,yU,vU,xU,bU],(t,r,n,i,a)=>yu(t,"xAxis")?df(r,i,!1):df(n,a,!1)),Jxe=(t,r,n,i,a)=>a;function e1e(t){return t.type==="line"}var t1e=ut([Dy,Jxe],(t,r)=>t.filter(e1e).find(n=>n.id===r)),r1e=ut([Gn,yU,vU,xU,bU,t1e,Xxe,UE],(t,r,n,i,a,s,o,l)=>{var{chartData:u,dataStartIndex:d,dataEndIndex:f}=l;if(!(s==null||r==null||n==null||i==null||a==null||i.length===0||a.length===0||o==null||t!=="horizontal"&&t!=="vertical")){var{dataKey:p,data:x}=s,v;if(x!=null&&x.length>0?v=x:v=u?.slice(d,f+1),v!=null)return U1e({layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:p,bandSize:o,displayedData:v})}});function jU(t){var r=dm(t),n=3,i=2;if(r!=null){var{r:a,strokeWidth:s}=r,o=Number(a),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=n),(Number.isNaN(l)||l<0)&&(l=i),{r:o,strokeWidth:l}}return{r:n,strokeWidth:i}}var vS={exports:{}},bS={};var zD;function n1e(){if(zD)return bS;zD=1;var t=Vp();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,i=t.useSyncExternalStore,a=t.useRef,s=t.useEffect,o=t.useMemo,l=t.useDebugValue;return bS.useSyncExternalStoreWithSelector=function(u,d,f,p,x){var v=a(null);if(v.current===null){var w={hasValue:!1,value:null};v.current=w}else w=v.current;v=o(function(){function A(Q){if(!T){if(T=!0,O=Q,Q=p(Q),x!==void 0&&w.hasValue){var U=w.value;if(x(U,Q))return D=U}return D=Q}if(U=D,n(O,Q))return U;var $=p(Q);return x!==void 0&&x(U,$)?(O=Q,U):(O=Q,D=$)}var T=!1,O,D,M=f===void 0?null:f;return[function(){return A(d())},M===null?void 0:function(){return A(M())}]},[d,f,p,x]);var C=i(u,v[0],v[1]);return s(function(){w.hasValue=!0,w.value=C},[C]),l(C),C},bS}var BD;function i1e(){return BD||(BD=1,vS.exports=n1e()),vS.exports}i1e();function a1e(t){t()}function s1e(){let t=null,r=null;return{clear(){t=null,r=null},notify(){a1e(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let i=t;for(;i;)n.push(i),i=i.next;return n},subscribe(n){let i=!0;const a=r={callback:n,next:null,prev:r};return a.prev?a.prev.next=a:t=a,function(){!i||t===null||(i=!1,a.next?a.next.prev=a.prev:r=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var FD={notify(){},get:()=>[]};function o1e(t,r){let n,i=FD,a=0,s=!1;function o(C){f();const A=i.subscribe(C);let T=!1;return()=>{T||(T=!0,A(),p())}}function l(){i.notify()}function u(){w.onStateChange&&w.onStateChange()}function d(){return s}function f(){a++,n||(n=t.subscribe(u),i=s1e())}function p(){a--,n&&a===0&&(n(),n=void 0,i.clear(),i=FD)}function x(){s||(s=!0,f())}function v(){s&&(s=!1,p())}const w={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:u,isSubscribed:d,trySubscribe:x,tryUnsubscribe:v,getListeners:()=>i};return w}var l1e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",c1e=l1e(),d1e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",u1e=d1e(),h1e=()=>c1e||u1e?k.useLayoutEffect:k.useEffect,f1e=h1e();function qD(t,r){return t===r?t!==0||r!==0||1/t===1/r:t!==t&&r!==r}function m1e(t,r){if(qD(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;const n=Object.keys(t),i=Object.keys(r);if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(!Object.prototype.hasOwnProperty.call(r,n[a])||!qD(t[n[a]],r[n[a]]))return!1;return!0}var p1e=Symbol.for("react-redux-context"),g1e=typeof globalThis<"u"?globalThis:{};function y1e(){if(!k.createContext)return{};const t=g1e[p1e]??=new Map;let r=t.get(k.createContext);return r||(r=k.createContext(null),t.set(k.createContext,r)),r}var x1e=y1e();function v1e(t){const{children:r,context:n,serverState:i,store:a}=t,s=k.useMemo(()=>{const u=o1e(a);return{store:a,subscription:u,getServerState:i?()=>i:void 0}},[a,i]),o=k.useMemo(()=>a.getState(),[a]);f1e(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==a.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,o]);const l=n||x1e;return k.createElement(l.Provider,{value:s},r)}var b1e=v1e,j1e=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function w1e(t,r){return t==null&&r==null?!0:typeof t=="number"&&typeof r=="number"?t===r||t!==t&&r!==r:t===r}function Fy(t,r){var n=new Set([...Object.keys(t),...Object.keys(r)]);for(var i of n)if(j1e.has(i)){if(t[i]==null&&r[i]==null)continue;if(!m1e(t[i],r[i]))return!1}else if(!w1e(t[i],r[i]))return!1;return!0}var S1e=["id"],C1e=["type","layout","connectNulls","needClip","shape"],N1e=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function iy(){return iy=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},iy.apply(null,arguments)}function UD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function ru(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?UD(Object(n),!0).forEach(function(i){A1e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function A1e(t,r,n){return(r=E1e(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function E1e(t){var r=_1e(t,"string");return typeof r=="symbol"?r:r+""}function _1e(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function H_(t,r){if(t==null)return{};var n,i,a=T1e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function T1e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var I1e=t=>{var{dataKey:r,name:n,stroke:i,legendType:a,hide:s}=t;return[{inactive:s,dataKey:r,type:a,color:i,value:pf(n,r),payload:t}]},O1e=k.memo(t=>{var{dataKey:r,data:n,stroke:i,strokeWidth:a,fill:s,name:o,hide:l,unit:u,tooltipType:d,id:f}=t,p={dataDefinedOnItem:n,positions:void 0,settings:{stroke:i,strokeWidth:a,fill:s,dataKey:r,nameKey:void 0,name:pf(o,r),hide:l,type:d,color:i,unit:u,graphicalItemId:f}};return k.createElement(Y2,{tooltipEntrySettings:p})}),wU=(t,r)=>"".concat(r,"px ").concat(t-r,"px");function k1e(t,r){for(var n=t.length%2!==0?[...t,0]:t,i=[],a=0;a<r;++a)i=[...i,...n];return i}var D1e=(t,r,n)=>{var i=n.reduce((p,x)=>p+x);if(!i)return wU(r,t);for(var a=Math.floor(t/i),s=t%i,o=r-t,l=[],u=0,d=0;u<n.length;d+=n[u],++u)if(d+n[u]>s){l=[...n.slice(0,u),s-d];break}var f=l.length%2===0?[0,o]:[o];return[...k1e(n,a),...l,...f].map(p=>"".concat(p,"px")).join(", ")};function P1e(t){var{clipPathId:r,points:n,props:i}=t,{dot:a,dataKey:s,needClip:o}=i,{id:l}=i,u=H_(i,S1e),d=Hl(u);return k.createElement(oU,{points:n,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:d,needClip:o,clipPathId:r})}function R1e(t){var{showLabels:r,children:n,points:i}=t,a=k.useMemo(()=>i?.map(s=>{var o,l,u={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return ru(ru({},u),{},{value:s.value,payload:s.payload,viewBox:u,parentViewBox:void 0,fill:void 0})}),[i]);return k.createElement(T_,{value:r?a:void 0},n)}function WD(t){var{clipPathId:r,pathRef:n,points:i,strokeDasharray:a,props:s}=t,{type:o,layout:l,connectNulls:u,needClip:d,shape:f}=s,p=H_(s,C1e),x=ru(ru({},Tl(p)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(r,")"):void 0,points:i,type:o,layout:l,connectNulls:u,strokeDasharray:a??s.strokeDasharray});return k.createElement(k.Fragment,null,i?.length>1&&k.createElement(P_,iy({shapeType:"curve",option:f},x,{pathRef:n})),k.createElement(P1e,{points:i,clipPathId:r,props:s}))}function M1e(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function L1e(t){var{clipPathId:r,props:n,pathRef:i,previousPointsRef:a,longestAnimatedLengthRef:s}=t,{points:o,strokeDasharray:l,isAnimationActive:u,animationBegin:d,animationDuration:f,animationEasing:p,animateNewValues:x,width:v,height:w,onAnimationEnd:C,onAnimationStart:A}=n,T=a.current,O=l0(o,"recharts-line-"),D=k.useRef(O),[M,Q]=k.useState(!1),U=!M,$=k.useCallback(()=>{typeof C=="function"&&C(),Q(!1)},[C]),ee=k.useCallback(()=>{typeof A=="function"&&A(),Q(!0)},[A]),F=M1e(i.current),Y=k.useRef(0);D.current!==O&&(Y.current=s.current,D.current=O);var J=Y.current;return k.createElement(R1e,{points:o,showLabels:U},n.children,k.createElement(o0,{animationId:O,begin:d,duration:f,isActive:u,easing:p,onAnimationEnd:$,onAnimationStart:ee,key:O},Z=>{var re=Ti(J,F+J,Z),de=Math.min(re,F),le;if(u)if(l){var K="".concat(l).split(/[,\s]+/gim).map(ye=>parseFloat(ye));le=D1e(de,F,K)}else le=wU(F,de);else le=l==null?void 0:String(l);if(Z>0&&F>0&&(a.current=o,s.current=Math.max(s.current,de)),T){var ue=T.length/o.length,ce=Z===1?o:o.map((ye,Se)=>{var V=Math.floor(Se*ue);if(T[V]){var X=T[V];return ru(ru({},ye),{},{x:Ti(X.x,ye.x,Z),y:Ti(X.y,ye.y,Z)})}return x?ru(ru({},ye),{},{x:Ti(v*2,ye.x,Z),y:Ti(w/2,ye.y,Z)}):ru(ru({},ye),{},{x:ye.x,y:ye.y})});return a.current=ce,k.createElement(WD,{props:n,points:ce,clipPathId:r,pathRef:i,strokeDasharray:le})}return k.createElement(WD,{props:n,points:o,clipPathId:r,pathRef:i,strokeDasharray:le})}),k.createElement(G2,{label:n.label}))}function z1e(t){var{clipPathId:r,props:n}=t,i=k.useRef(null),a=k.useRef(0),s=k.useRef(null);return k.createElement(L1e,{props:n,clipPathId:r,previousPointsRef:i,longestAnimatedLengthRef:a,pathRef:s})}var B1e=(t,r)=>{var n,i;return{x:(n=t.x)!==null&&n!==void 0?n:void 0,y:(i=t.y)!==null&&i!==void 0?i:void 0,value:t.value,errorVal:Ii(t.payload,r)}};class F1e extends k.Component{render(){var{hide:r,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:l,left:u,width:d,height:f,id:p,needClip:x,zIndex:v}=this.props;if(r)return null;var w=hi("recharts-line",a),C=p,{r:A,strokeWidth:T}=jU(n),O=D_(n),D=A*2+T,M=x?"url(#clipPath-".concat(O?"":"dots-").concat(C,")"):void 0;return k.createElement($l,{zIndex:v},k.createElement(Os,{className:w},x&&k.createElement("defs",null,k.createElement(W_,{clipPathId:C,xAxisId:s,yAxisId:o}),!O&&k.createElement("clipPath",{id:"clipPath-dots-".concat(C)},k.createElement("rect",{x:u-D/2,y:l-D/2,width:d+D,height:f+D}))),k.createElement(gU,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:B1e,errorBarOffset:0},k.createElement(z1e,{props:this.props,clipPathId:C}))),k.createElement($N,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:M}))}}var SU={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:$s.line,type:"linear"};function q1e(t){var r=ks(t,SU),{activeDot:n,animateNewValues:i,animationBegin:a,animationDuration:s,animationEasing:o,connectNulls:l,dot:u,hide:d,isAnimationActive:f,label:p,legendType:x,xAxisId:v,yAxisId:w,id:C}=r,A=H_(r,N1e),{needClip:T}=ej(v,w),O=J2(),D=gf(),M=Ho(),Q=wr(Y=>r1e(Y,v,w,M,C));if(D!=="horizontal"&&D!=="vertical"||Q==null||O==null)return null;var{height:U,width:$,x:ee,y:F}=O;return k.createElement(F1e,iy({},A,{id:C,connectNulls:l,dot:u,activeDot:n,animateNewValues:i,animationBegin:a,animationDuration:s,animationEasing:o,isAnimationActive:f,hide:d,label:p,legendType:x,xAxisId:v,yAxisId:w,points:Q,layout:D,height:U,width:$,left:ee,top:F,needClip:T}))}function U1e(t){var{layout:r,xAxis:n,yAxis:i,xAxisTicks:a,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:u}=t;return u.map((d,f)=>{var p=Ii(d,o);if(r==="horizontal"){var x=ib({axis:n,ticks:a,bandSize:l,entry:d,index:f}),v=Ta(p)?null:i.scale(p);return{x,y:v,value:p,payload:d}}var w=Ta(p)?null:n.scale(p),C=ib({axis:i,ticks:s,bandSize:l,entry:d,index:f});return w==null||C==null?null:{x:w,y:C,value:p,payload:d}}).filter(Boolean)}function W1e(t){var r=ks(t,SU),n=Ho();return k.createElement(Z2,{id:r.id,type:"line"},i=>k.createElement(k.Fragment,null,k.createElement(z_,{legendPayload:I1e(r)}),k.createElement(O1e,{dataKey:r.dataKey,data:r.data,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:i}),k.createElement(B_,{type:"line",id:i,data:r.data,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,hide:r.hide,isPanorama:n}),k.createElement(q1e,iy({},r,{id:i}))))}var ay=k.memo(W1e,Fy);ay.displayName="Line";function xu(t,r){var n,i;return(n=(i=t.graphicalItems.cartesianItems.find(a=>a.id===r))===null||i===void 0?void 0:i.xAxisId)!==null&&n!==void 0?n:lU}function vu(t,r){var n,i;return(n=(i=t.graphicalItems.cartesianItems.find(a=>a.id===r))===null||i===void 0?void 0:i.yAxisId)!==null&&n!==void 0?n:lU}var CU=(t,r,n)=>pu(t,"xAxis",xu(t,r),n),NU=(t,r,n)=>mu(t,"xAxis",xu(t,r),n),AU=(t,r,n)=>pu(t,"yAxis",vu(t,r),n),EU=(t,r,n)=>mu(t,"yAxis",vu(t,r),n),H1e=ut([Gn,CU,AU,NU,EU],(t,r,n,i,a)=>yu(t,"xAxis")?df(r,i,!1):df(n,a,!1)),V1e=(t,r)=>r,_U=ut([Dy,V1e],(t,r)=>t.filter(n=>n.type==="area").find(n=>n.id===r)),TU=t=>{var r=Gn(t),n=yu(r,"xAxis");return n?"yAxis":"xAxis"},$1e=(t,r)=>{var n=TU(t);return n==="yAxis"?vu(t,r):xu(t,r)},G1e=(t,r,n)=>Ab(t,TU(t),$1e(t,r),n),K1e=ut([_U,G1e],(t,r)=>{var n;if(!(t==null||r==null)){var{stackId:i}=t,a=M2(t);if(!(i==null||a==null)){var s=(n=r[i])===null||n===void 0?void 0:n.stackedData,o=s?.find(l=>l.key===a);if(o!=null)return o.map(l=>[l[0],l[1]])}}}),Q1e=ut([Gn,CU,AU,NU,EU,K1e,xF,H1e,_U,Nhe],(t,r,n,i,a,s,o,l,u,d)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:x}=o;if(!(u==null||t!=="horizontal"&&t!=="vertical"||r==null||n==null||i==null||a==null||i.length===0||a.length===0||l==null)){var{data:v}=u,w;if(v&&v.length>0?w=v:w=f?.slice(p,x+1),w!=null)return mve({layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataStartIndex:p,areaSettings:u,stackedData:s,displayedData:w,chartBaseValue:d,bandSize:l})}}),Y1e=["id"],Z1e=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function em(){return em=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},em.apply(null,arguments)}function IU(t,r){if(t==null)return{};var n,i,a=X1e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function X1e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function HD(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function wp(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?HD(Object(n),!0).forEach(function(i){J1e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HD(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function J1e(t,r,n){return(r=eve(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function eve(t){var r=tve(t,"string");return typeof r=="symbol"?r:r+""}function tve(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Pb(t,r){return t&&t!=="none"?t:r}var rve=t=>{var{dataKey:r,name:n,stroke:i,fill:a,legendType:s,hide:o}=t;return[{inactive:o,dataKey:r,type:s,color:Pb(i,a),value:pf(n,r),payload:t}]},nve=k.memo(t=>{var{dataKey:r,data:n,stroke:i,strokeWidth:a,fill:s,name:o,hide:l,unit:u,tooltipType:d,id:f}=t,p={dataDefinedOnItem:n,positions:void 0,settings:{stroke:i,strokeWidth:a,fill:s,dataKey:r,nameKey:void 0,name:pf(o,r),hide:l,type:d,color:Pb(i,s),unit:u,graphicalItemId:f}};return k.createElement(Y2,{tooltipEntrySettings:p})});function ive(t){var{clipPathId:r,points:n,props:i}=t,{needClip:a,dot:s,dataKey:o}=i,l=Hl(i);return k.createElement(oU,{points:n,dot:s,className:"recharts-area-dots",dotClassName:"recharts-area-dot",dataKey:o,baseProps:l,needClip:a,clipPathId:r})}function ave(t){var{showLabels:r,children:n,points:i}=t,a=i.map(s=>{var o,l,u={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return wp(wp({},u),{},{value:s.value,payload:s.payload,parentViewBox:void 0,viewBox:u,fill:void 0})});return k.createElement(T_,{value:r?a:void 0},n)}function VD(t){var{points:r,baseLine:n,needClip:i,clipPathId:a,props:s}=t,{layout:o,type:l,stroke:u,connectNulls:d,isRange:f}=s,{id:p}=s,x=IU(s,Y1e),v=Hl(x),w=Tl(x);return k.createElement(k.Fragment,null,r?.length>1&&k.createElement(Os,{clipPath:i?"url(#clipPath-".concat(a,")"):void 0},k.createElement(Ep,em({},w,{id:p,points:r,connectNulls:d,type:l,baseLine:n,layout:o,stroke:"none",className:"recharts-area-area"})),u!=="none"&&k.createElement(Ep,em({},v,{className:"recharts-area-curve",layout:o,type:l,connectNulls:d,fill:"none",points:r})),u!=="none"&&f&&k.createElement(Ep,em({},v,{className:"recharts-area-curve",layout:o,type:l,connectNulls:d,fill:"none",points:n}))),k.createElement(ive,{points:r,props:x,clipPathId:a}))}function sve(t){var r,n,{alpha:i,baseLine:a,points:s,strokeWidth:o}=t,l=(r=s[0])===null||r===void 0?void 0:r.y,u=(n=s[s.length-1])===null||n===void 0?void 0:n.y;if(!oa(l)||!oa(u))return null;var d=i*Math.abs(l-u),f=Math.max(...s.map(p=>p.x||0));return or(a)?f=Math.max(a,f):a&&Array.isArray(a)&&a.length&&(f=Math.max(...a.map(p=>p.x||0),f)),or(f)?k.createElement("rect",{x:0,y:l<u?l:l-d,width:f+(o?parseInt("".concat(o),10):1),height:Math.floor(d)}):null}function ove(t){var r,n,{alpha:i,baseLine:a,points:s,strokeWidth:o}=t,l=(r=s[0])===null||r===void 0?void 0:r.x,u=(n=s[s.length-1])===null||n===void 0?void 0:n.x;if(!oa(l)||!oa(u))return null;var d=i*Math.abs(l-u),f=Math.max(...s.map(p=>p.y||0));return or(a)?f=Math.max(a,f):a&&Array.isArray(a)&&a.length&&(f=Math.max(...a.map(p=>p.y||0),f)),or(f)?k.createElement("rect",{x:l<u?l:l-d,y:0,width:d,height:Math.floor(f+(o?parseInt("".concat(o),10):1))}):null}function lve(t){var{alpha:r,layout:n,points:i,baseLine:a,strokeWidth:s}=t;return n==="vertical"?k.createElement(sve,{alpha:r,points:i,baseLine:a,strokeWidth:s}):k.createElement(ove,{alpha:r,points:i,baseLine:a,strokeWidth:s})}function cve(t){var{needClip:r,clipPathId:n,props:i,previousPointsRef:a,previousBaselineRef:s}=t,{points:o,baseLine:l,isAnimationActive:u,animationBegin:d,animationDuration:f,animationEasing:p,onAnimationStart:x,onAnimationEnd:v}=i,w=k.useMemo(()=>({points:o,baseLine:l}),[o,l]),C=l0(w,"recharts-area-"),A=Uoe(),[T,O]=k.useState(!1),D=!T,M=k.useCallback(()=>{typeof v=="function"&&v(),O(!1)},[v]),Q=k.useCallback(()=>{typeof x=="function"&&x(),O(!0)},[x]);if(A==null)return null;var U=a.current,$=s.current;return k.createElement(ave,{showLabels:D,points:o},i.children,k.createElement(o0,{animationId:C,begin:d,duration:f,isActive:u,easing:p,onAnimationEnd:M,onAnimationStart:Q,key:C},ee=>{if(U){var F=U.length/o.length,Y=ee===1?o:o.map((Z,re)=>{var de=Math.floor(re*F);if(U[de]){var le=U[de];return wp(wp({},Z),{},{x:Ti(le.x,Z.x,ee),y:Ti(le.y,Z.y,ee)})}return Z}),J;return or(l)?J=Ti($,l,ee):Ta(l)||id(l)?J=Ti($,0,ee):J=l.map((Z,re)=>{var de=Math.floor(re*F);if(Array.isArray($)&&$[de]){var le=$[de];return wp(wp({},Z),{},{x:Ti(le.x,Z.x,ee),y:Ti(le.y,Z.y,ee)})}return Z}),ee>0&&(a.current=Y,s.current=J),k.createElement(VD,{points:Y,baseLine:J,needClip:r,clipPathId:n,props:i})}return ee>0&&(a.current=o,s.current=l),k.createElement(Os,null,u&&k.createElement("defs",null,k.createElement("clipPath",{id:"animationClipPath-".concat(n)},k.createElement(lve,{alpha:ee,points:o,baseLine:l,layout:A,strokeWidth:i.strokeWidth}))),k.createElement(Os,{clipPath:"url(#animationClipPath-".concat(n,")")},k.createElement(VD,{points:o,baseLine:l,needClip:r,clipPathId:n,props:i})))}),k.createElement(G2,{label:i.label}))}function dve(t){var{needClip:r,clipPathId:n,props:i}=t,a=k.useRef(null),s=k.useRef();return k.createElement(cve,{needClip:r,clipPathId:n,props:i,previousPointsRef:a,previousBaselineRef:s})}class uve extends k.PureComponent{render(){var{hide:r,dot:n,points:i,className:a,top:s,left:o,needClip:l,xAxisId:u,yAxisId:d,width:f,height:p,id:x,baseLine:v,zIndex:w}=this.props;if(r)return null;var C=hi("recharts-area",a),A=x,{r:T,strokeWidth:O}=jU(n),D=D_(n),M=T*2+O,Q=l?"url(#clipPath-".concat(D?"":"dots-").concat(A,")"):void 0;return k.createElement($l,{zIndex:w},k.createElement(Os,{className:C},l&&k.createElement("defs",null,k.createElement(W_,{clipPathId:A,xAxisId:u,yAxisId:d}),!D&&k.createElement("clipPath",{id:"clipPath-dots-".concat(A)},k.createElement("rect",{x:o-M/2,y:s-M/2,width:f+M,height:p+M}))),k.createElement(dve,{needClip:l,clipPathId:A,props:this.props})),k.createElement($N,{points:i,mainColor:Pb(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:Q}),this.props.isRange&&Array.isArray(v)&&k.createElement($N,{points:v,mainColor:Pb(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:Q}))}}var OU={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:"auto",legendType:"line",stroke:"#3182bd",strokeWidth:1,type:"linear",label:!1,xAxisId:0,yAxisId:0,zIndex:$s.area};function hve(t){var r,n=ks(t,OU),{activeDot:i,animationBegin:a,animationDuration:s,animationEasing:o,connectNulls:l,dot:u,fill:d,fillOpacity:f,hide:p,isAnimationActive:x,legendType:v,stroke:w,xAxisId:C,yAxisId:A}=n,T=IU(n,Z1e),O=gf(),D=Pq(),{needClip:M}=ej(C,A),Q=Ho(),{points:U,isRange:$,baseLine:ee}=(r=wr(de=>Q1e(de,t.id,Q)))!==null&&r!==void 0?r:{},F=J2();if(O!=="horizontal"&&O!=="vertical"||F==null||D!=="AreaChart"&&D!=="ComposedChart")return null;var{height:Y,width:J,x:Z,y:re}=F;return!U||!U.length?null:k.createElement(uve,em({},T,{activeDot:i,animationBegin:a,animationDuration:s,animationEasing:o,baseLine:ee,connectNulls:l,dot:u,fill:d,fillOpacity:f,height:Y,hide:p,layout:O,isAnimationActive:x==="auto"?!Ny.isSsr:x,isRange:$,legendType:v,needClip:M,points:U,stroke:w,width:J,left:Z,top:re,xAxisId:C,yAxisId:A}))}var fve=(t,r,n,i,a)=>{var s=n??r;if(or(s))return s;var o=t==="horizontal"?a:i,l=o.scale.domain();if(o.type==="number"){var u=Math.max(l[0],l[1]),d=Math.min(l[0],l[1]);return s==="dataMin"?d:s==="dataMax"||u<0?u:Math.max(Math.min(l[0],l[1]),0)}return s==="dataMin"?l[0]:s==="dataMax"?l[1]:l[0]};function mve(t){var{areaSettings:{connectNulls:r,baseValue:n,dataKey:i},stackedData:a,layout:s,chartBaseValue:o,xAxis:l,yAxis:u,displayedData:d,dataStartIndex:f,xAxisTicks:p,yAxisTicks:x,bandSize:v}=t,w=a&&a.length,C=fve(s,o,n,l,u),A=s==="horizontal",T=!1,O=d.map((M,Q)=>{var U,$,ee;if(w)ee=a[f+Q];else{var F=Ii(M,i);Array.isArray(F)?(ee=F,T=!0):ee=[C,F]}var Y=(U=($=ee)===null||$===void 0?void 0:$[1])!==null&&U!==void 0?U:null,J=Y==null||w&&!r&&Ii(M,i)==null;return A?{x:ib({axis:l,ticks:p,bandSize:v,entry:M,index:Q}),y:J?null:u.scale(Y),value:ee,payload:M}:{x:J?null:l.scale(Y),y:ib({axis:u,ticks:x,bandSize:v,entry:M,index:Q}),value:ee,payload:M}}),D;return w||T?D=O.map(M=>{var Q=Array.isArray(M.value)?M.value[0]:null;return A?{x:M.x,y:Q!=null&&M.y!=null?u.scale(Q):null,payload:M.payload}:{x:Q!=null?l.scale(Q):null,y:M.y,payload:M.payload}}):D=A?u.scale(C):l.scale(C),{points:O,baseLine:D,isRange:T}}function pve(t){var r=ks(t,OU),n=Ho();return k.createElement(Z2,{id:r.id,type:"area"},i=>k.createElement(k.Fragment,null,k.createElement(z_,{legendPayload:rve(r)}),k.createElement(nve,{dataKey:r.dataKey,data:r.data,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:i}),k.createElement(B_,{type:"area",id:i,data:r.data,dataKey:r.dataKey,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,stackId:l9(r.stackId),hide:r.hide,barSize:void 0,baseValue:r.baseValue,isPanorama:n,connectNulls:r.connectNulls}),k.createElement(hve,em({},r,{id:i}))))}var kU=k.memo(pve,Fy);kU.displayName="Area";var gve="Invariant failed";function yve(t,r){throw new Error(gve)}function GN(){return GN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},GN.apply(null,arguments)}function Rb(t){return k.createElement(P_,GN({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var xve=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(i,a)=>{if(or(r))return r;var s=or(i)||Ta(i);return s?r(i,a):(s||yve(),n)}},vve=(t,r,n)=>n,bve=(t,r)=>r,qy=ut([Dy,bve],(t,r)=>t.filter(n=>n.type==="bar").find(n=>n.id===r)),jve=ut([qy],t=>t?.maxBarSize),wve=(t,r,n,i)=>i,Sve=ut([Gn,Dy,xu,vu,vve],(t,r,n,i,a)=>r.filter(s=>t==="horizontal"?s.xAxisId===n:s.yAxisId===i).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),Cve=(t,r,n)=>{var i=Gn(t),a=xu(t,r),s=vu(t,r);if(!(a==null||s==null))return i==="horizontal"?Ab(t,"yAxis",s,n):Ab(t,"xAxis",a,n)},Nve=(t,r)=>{var n=Gn(t),i=xu(t,r),a=vu(t,r);if(!(i==null||a==null))return n==="horizontal"?Ek(t,"xAxis",i):Ek(t,"yAxis",a)},Ave=ut([Sve,Che,Nve],qye),Eve=(t,r,n)=>{var i,a,s=qy(t,r);if(s!=null){var o=xu(t,r),l=vu(t,r);if(!(o==null||l==null)){var u=Gn(t),d=DF(t),{maxBarSize:f}=s,p=Ta(f)?d:f,x,v;return u==="horizontal"?(x=pu(t,"xAxis",o,n),v=mu(t,"xAxis",o,n)):(x=pu(t,"yAxis",l,n),v=mu(t,"yAxis",l,n)),(i=(a=df(x,v,!0))!==null&&a!==void 0?a:p)!==null&&i!==void 0?i:0}}},DU=(t,r,n)=>{var i=Gn(t),a=xu(t,r),s=vu(t,r);if(!(a==null||s==null)){var o,l;return i==="horizontal"?(o=pu(t,"xAxis",a,n),l=mu(t,"xAxis",a,n)):(o=pu(t,"yAxis",s,n),l=mu(t,"yAxis",s,n)),df(o,l)}},_ve=ut([Ave,DF,She,PF,Eve,DU,jve],$ye),Tve=(t,r,n)=>{var i=xu(t,r);if(i!=null)return pu(t,"xAxis",i,n)},Ive=(t,r,n)=>{var i=vu(t,r);if(i!=null)return pu(t,"yAxis",i,n)},Ove=(t,r,n)=>{var i=xu(t,r);if(i!=null)return mu(t,"xAxis",i,n)},kve=(t,r,n)=>{var i=vu(t,r);if(i!=null)return mu(t,"yAxis",i,n)},Dve=ut([_ve,qy],(t,r)=>{if(!(t==null||r==null)){var n=t.find(i=>i.stackId===r.stackId&&r.dataKey!=null&&i.dataKeys.includes(r.dataKey));if(n!=null)return n.position}}),Pve=ut([Cve,qy],Gye),Rve=ut([jo,fE,Tve,Ive,Ove,kve,Dve,Gn,xF,DU,Pve,qy,wve],(t,r,n,i,a,s,o,l,u,d,f,p,x)=>{var{chartData:v,dataStartIndex:w,dataEndIndex:C}=u;if(!(p==null||o==null||r==null||l!=="horizontal"&&l!=="vertical"||n==null||i==null||a==null||s==null||d==null)){var{data:A}=p,T;if(A!=null&&A.length>0?T=A:T=v?.slice(w,C+1),T!=null)return dbe({layout:l,barSettings:p,pos:o,parentViewBox:r,bandSize:d,xAxis:n,yAxis:i,xAxisTicks:a,yAxisTicks:s,stackedData:f,displayedData:T,offset:t,cells:x,dataStartIndex:w})}}),Mve=["index"];function KN(){return KN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},KN.apply(null,arguments)}function Lve(t,r){if(t==null)return{};var n,i,a=zve(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function zve(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var PU=k.createContext(void 0),Bve=t=>{var r=k.useContext(PU);if(r!=null)return r.stackId;if(t!=null)return l9(t)},Fve=(t,r)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(r),qve=t=>{var r=k.useContext(PU);if(r!=null){var{stackId:n}=r;return"url(#".concat(Fve(n,t),")")}},Uve=t=>{var{index:r}=t,n=Lve(t,Mve),i=qve(r);return k.createElement(Os,KN({className:"recharts-bar-stack-layer",clipPath:i},n))},Wve=["onMouseEnter","onMouseLeave","onClick"],Hve=["value","background","tooltipPosition"],Vve=["id"],$ve=["onMouseEnter","onClick","onMouseLeave"];function fh(){return fh=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},fh.apply(null,arguments)}function $D(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Bl(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?$D(Object(n),!0).forEach(function(i){Gve(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$D(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Gve(t,r,n){return(r=Kve(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Kve(t){var r=Qve(t,"string");return typeof r=="symbol"?r:r+""}function Qve(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function Mb(t,r){if(t==null)return{};var n,i,a=Yve(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Yve(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var Zve=t=>{var{dataKey:r,name:n,fill:i,legendType:a,hide:s}=t;return[{inactive:s,dataKey:r,type:a,color:i,value:pf(n,r),payload:t}]},Xve=k.memo(t=>{var{dataKey:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:l,tooltipType:u,id:d}=t,f={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:r,nameKey:void 0,name:pf(s,r),hide:o,type:u,color:a,unit:l,graphicalItemId:d}};return k.createElement(Y2,{tooltipEntrySettings:f})});function Jve(t){var r=wr(hf),{data:n,dataKey:i,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:u}=s,d=Mb(s,Wve),f=R_(o,i,s.id),p=M_(l),x=L_(u,i,s.id);if(!a||n==null)return null;var v=dm(a);return k.createElement($l,{zIndex:Kye(a,$s.barBackground)},n.map((w,C)=>{var{value:A,background:T,tooltipPosition:O}=w,D=Mb(w,Hve);if(!T)return null;var M=f(w,C),Q=p(w,C),U=x(w,C),$=Bl(Bl(Bl(Bl(Bl({option:a,isActive:String(C)===r},D),{},{fill:"#eee"},T),v),by(d,w,C)),{},{onMouseEnter:M,onMouseLeave:Q,onClick:U,dataKey:i,index:C,className:"recharts-bar-background-rectangle"});return k.createElement(Rb,fh({key:"background-bar-".concat(C)},$))}))}function ebe(t){var{showLabels:r,children:n,rects:i}=t,a=i?.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Bl(Bl({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return k.createElement(T_,{value:r?a:void 0},n)}function tbe(t){var{shape:r,activeBar:n,baseProps:i,entry:a,index:s,dataKey:o}=t,l=wr(hf),u=wr(S_),d=n&&String(s)===l&&(u==null||o===u),f=d?n:r;return d?k.createElement($l,{zIndex:$s.activeBar},k.createElement(Rb,fh({},i,{name:String(i.name)},a,{isActive:d,option:f,index:s,dataKey:o}))):k.createElement(Rb,fh({},i,{name:String(i.name)},a,{isActive:d,option:f,index:s,dataKey:o}))}function rbe(t){var{shape:r,baseProps:n,entry:i,index:a,dataKey:s}=t;return k.createElement(Rb,fh({},n,{name:String(n.name)},i,{isActive:!1,option:r,index:a,dataKey:s}))}function nbe(t){var r,{data:n,props:i}=t,a=(r=Hl(i))!==null&&r!==void 0?r:{},{id:s}=a,o=Mb(a,Vve),{shape:l,dataKey:u,activeBar:d}=i,{onMouseEnter:f,onClick:p,onMouseLeave:x}=i,v=Mb(i,$ve),w=R_(f,u,s),C=M_(x),A=L_(p,u,s);return n?k.createElement(k.Fragment,null,n.map((T,O)=>k.createElement(Uve,fh({index:O,key:"rectangle-".concat(T?.x,"-").concat(T?.y,"-").concat(T?.value,"-").concat(O),className:"recharts-bar-rectangle"},by(v,T,O),{onMouseEnter:w(T,O),onMouseLeave:C(T,O),onClick:A(T,O)}),d?k.createElement(tbe,{shape:l,activeBar:d,baseProps:o,entry:T,index:O,dataKey:u}):k.createElement(rbe,{shape:l,baseProps:o,entry:T,index:O,dataKey:u})))):null}function ibe(t){var{props:r,previousRectanglesRef:n}=t,{data:i,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:u,onAnimationEnd:d,onAnimationStart:f}=r,p=n.current,x=l0(r,"recharts-bar-"),[v,w]=k.useState(!1),C=!v,A=k.useCallback(()=>{typeof d=="function"&&d(),w(!1)},[d]),T=k.useCallback(()=>{typeof f=="function"&&f(),w(!0)},[f]);return k.createElement(ebe,{showLabels:C,rects:i},k.createElement(o0,{animationId:x,begin:o,duration:l,isActive:s,easing:u,onAnimationEnd:A,onAnimationStart:T,key:x},O=>{var D=O===1?i:i?.map((M,Q)=>{var U=p&&p[Q];if(U)return Bl(Bl({},M),{},{x:Ti(U.x,M.x,O),y:Ti(U.y,M.y,O),width:Ti(U.width,M.width,O),height:Ti(U.height,M.height,O)});if(a==="horizontal"){var $=Ti(0,M.height,O),ee=Ti(M.stackedBarStart,M.y,O);return Bl(Bl({},M),{},{y:ee,height:$})}var F=Ti(0,M.width,O),Y=Ti(M.stackedBarStart,M.x,O);return Bl(Bl({},M),{},{width:F,x:Y})});return O>0&&(n.current=D??null),D==null?null:k.createElement(Os,null,k.createElement(nbe,{props:r,data:D}))}),k.createElement(G2,{label:r.label}),r.children)}function abe(t){var r=k.useRef(null);return k.createElement(ibe,{previousRectanglesRef:r,props:t})}var RU=0,sbe=(t,r)=>{var n=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:n,errorVal:Ii(t,r)}};class obe extends k.PureComponent{render(){var{hide:r,data:n,dataKey:i,className:a,xAxisId:s,yAxisId:o,needClip:l,background:u,id:d}=this.props;if(r||n==null)return null;var f=hi("recharts-bar",a),p=d;return k.createElement(Os,{className:f,id:d},l&&k.createElement("defs",null,k.createElement(W_,{clipPathId:p,xAxisId:s,yAxisId:o})),k.createElement(Os,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(p,")"):void 0},k.createElement(Jve,{data:n,dataKey:i,background:u,allOtherBarProps:this.props}),k.createElement(abe,this.props)))}}var lbe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:RU,xAxisId:0,yAxisId:0,zIndex:$s.bar};function cbe(t){var{xAxisId:r,yAxisId:n,hide:i,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:u,animationEasing:d,isAnimationActive:f}=t,{needClip:p}=ej(r,n),x=gf(),v=Ho(),w=k_(t.children,Ju),C=wr(O=>Rve(O,t.id,v,w));if(x!=="vertical"&&x!=="horizontal")return null;var A,T=C?.[0];return T==null||T.height==null||T.width==null?A=0:A=x==="vertical"?T.height/2:T.width/2,k.createElement(gU,{xAxisId:r,yAxisId:n,data:C,dataPointFormatter:sbe,errorBarOffset:A},k.createElement(obe,fh({},t,{layout:x,needClip:p,data:C,xAxisId:r,yAxisId:n,hide:i,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:u,animationEasing:d,isAnimationActive:f})))}function dbe(t){var{layout:r,barSettings:{dataKey:n,minPointSize:i},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:u,yAxisTicks:d,stackedData:f,displayedData:p,offset:x,cells:v,parentViewBox:w,dataStartIndex:C}=t,A=r==="horizontal"?l:o,T=f?A.scale.domain():null,O=soe({numericAxis:A}),D=A.scale(O);return p.map((M,Q)=>{var U,$,ee,F,Y,J;if(f){var Z=f[Q+C];if(Z==null)return null;U=toe(Z,T)}else U=Ii(M,n),Array.isArray(U)||(U=[O,U]);var re=xve(i,RU)(U[1],Q);if(r==="horizontal"){var de,[le,K]=[l.scale(U[0]),l.scale(U[1])];$=OI({axis:o,ticks:u,bandSize:s,offset:a.offset,entry:M,index:Q}),ee=(de=K??le)!==null&&de!==void 0?de:void 0,F=a.size;var ue=le-K;if(Y=id(ue)?0:ue,J={x:$,y:x.top,width:F,height:x.height},Math.abs(re)>0&&Math.abs(Y)<Math.abs(re)){var ce=Bo(Y||re)*(Math.abs(re)-Math.abs(Y));ee-=ce,Y+=ce}}else{var[ye,Se]=[o.scale(U[0]),o.scale(U[1])];if($=ye,ee=OI({axis:l,ticks:d,bandSize:s,offset:a.offset,entry:M,index:Q}),F=Se-ye,Y=a.size,J={x:x.left,y:ee,width:x.width,height:Y},Math.abs(re)>0&&Math.abs(F)<Math.abs(re)){var V=Bo(F||re)*(Math.abs(re)-Math.abs(F));F+=V}}if($==null||ee==null||F==null||Y==null)return null;var X=Bl(Bl({},M),{},{stackedBarStart:D,x:$,y:ee,width:F,height:Y,value:f?U:U[1],payload:M,background:J,tooltipPosition:{x:$+F/2,y:ee+Y/2},parentViewBox:w},v&&v[Q]&&v[Q].props);return X}).filter(Boolean)}function ube(t){var r=ks(t,lbe),n=Bve(r.stackId),i=Ho();return k.createElement(Z2,{id:r.id,type:"bar"},a=>k.createElement(k.Fragment,null,k.createElement(z_,{legendPayload:Zve(r)}),k.createElement(Xve,{dataKey:r.dataKey,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:a}),k.createElement(B_,{type:"bar",id:a,data:void 0,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,stackId:n,hide:r.hide,barSize:r.barSize,minPointSize:r.minPointSize,maxBarSize:r.maxBarSize,isPanorama:i}),k.createElement($l,{zIndex:r.zIndex},k.createElement(cbe,fh({},r,{id:a})))))}var tf=k.memo(ube,Fy);tf.displayName="Bar";var hbe=["domain","range"],fbe=["domain","range"];function GD(t,r){if(t==null)return{};var n,i,a=mbe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function mbe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function KD(t,r){return t===r?!0:Array.isArray(t)&&t.length===2&&Array.isArray(r)&&r.length===2?t[0]===r[0]&&t[1]===r[1]:!1}function MU(t,r){if(t===r)return!0;var{domain:n,range:i}=t,a=GD(t,hbe),{domain:s,range:o}=r,l=GD(r,fbe);return!KD(n,s)||!KD(i,o)?!1:Fy(a,l)}var pbe=["dangerouslySetInnerHTML","ticks","scale"],gbe=["id","scale"];function QN(){return QN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},QN.apply(null,arguments)}function QD(t,r){if(t==null)return{};var n,i,a=ybe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function ybe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function xbe(t){var r=pa(),n=k.useRef(null);return k.useLayoutEffect(()=>{n.current===null?r(Aye(t)):n.current!==t&&r(Eye({prev:n.current,next:t})),n.current=t},[t,r]),k.useLayoutEffect(()=>()=>{n.current&&(r(_ye(n.current)),n.current=null)},[r]),null}var vbe=t=>{var{xAxisId:r,className:n}=t,i=wr(fE),a=Ho(),s="xAxis",o=wr(T=>hq(T,s,r,a)),l=wr(T=>lq(T,r)),u=wr(T=>wfe(T,r)),d=wr(T=>WF(T,r));if(l==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:f,ticks:p,scale:x}=t,v=QD(t,pbe),{id:w,scale:C}=d,A=QD(d,gbe);return k.createElement(U_,QN({},v,A,{x:u.x,y:u.y,width:l.width,height:l.height,className:hi("recharts-".concat(s," ").concat(s),n),viewBox:i,ticks:o,axisType:s}))},bbe={allowDataOverflow:Ro.allowDataOverflow,allowDecimals:Ro.allowDecimals,allowDuplicatedCategory:Ro.allowDuplicatedCategory,angle:Ro.angle,axisLine:eh.axisLine,height:Ro.height,hide:!1,includeHidden:Ro.includeHidden,interval:Ro.interval,minTickGap:Ro.minTickGap,mirror:Ro.mirror,orientation:Ro.orientation,padding:Ro.padding,reversed:Ro.reversed,scale:Ro.scale,tick:Ro.tick,tickCount:Ro.tickCount,tickLine:eh.tickLine,tickSize:eh.tickSize,type:Ro.type,xAxisId:0},jbe=t=>{var r=ks(t,bbe);return k.createElement(k.Fragment,null,k.createElement(xbe,{allowDataOverflow:r.allowDataOverflow,allowDecimals:r.allowDecimals,allowDuplicatedCategory:r.allowDuplicatedCategory,angle:r.angle,dataKey:r.dataKey,domain:r.domain,height:r.height,hide:r.hide,id:r.xAxisId,includeHidden:r.includeHidden,interval:r.interval,minTickGap:r.minTickGap,mirror:r.mirror,name:r.name,orientation:r.orientation,padding:r.padding,reversed:r.reversed,scale:r.scale,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit}),k.createElement(vbe,r))},Yu=k.memo(jbe,MU);Yu.displayName="XAxis";var wbe=["dangerouslySetInnerHTML","ticks","scale"],Sbe=["id","scale"];function YN(){return YN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},YN.apply(null,arguments)}function YD(t,r){if(t==null)return{};var n,i,a=Cbe(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Cbe(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Nbe(t){var r=pa(),n=k.useRef(null);return k.useLayoutEffect(()=>{n.current===null?r(Tye(t)):n.current!==t&&r(Iye({prev:n.current,next:t})),n.current=t},[t,r]),k.useLayoutEffect(()=>()=>{n.current&&(r(Oye(n.current)),n.current=null)},[r]),null}var Abe=t=>{var{yAxisId:r,className:n,width:i,label:a}=t,s=k.useRef(null),o=k.useRef(null),l=wr(fE),u=Ho(),d=pa(),f="yAxis",p=wr(U=>cq(U,r)),x=wr(U=>Cfe(U,r)),v=wr(U=>hq(U,f,r,u)),w=wr(U=>HF(U,r));if(k.useLayoutEffect(()=>{if(!(i!=="auto"||!p||__(a)||k.isValidElement(a)||w==null)){var U=s.current;if(U){var $=U.getCalculatedWidth();Math.round(p.width)!==Math.round($)&&d(kye({id:r,width:$}))}}},[v,p,d,a,r,i,w]),p==null||x==null||w==null)return null;var{dangerouslySetInnerHTML:C,ticks:A,scale:T}=t,O=YD(t,wbe),{id:D,scale:M}=w,Q=YD(w,Sbe);return k.createElement(U_,YN({},O,Q,{ref:s,labelRef:o,x:x.x,y:x.y,tickTextProps:i==="auto"?{width:void 0}:{width:i},width:p.width,height:p.height,className:hi("recharts-".concat(f," ").concat(f),n),viewBox:l,ticks:v,axisType:f}))},Ebe={allowDataOverflow:Mo.allowDataOverflow,allowDecimals:Mo.allowDecimals,allowDuplicatedCategory:Mo.allowDuplicatedCategory,angle:Mo.angle,axisLine:eh.axisLine,hide:!1,includeHidden:Mo.includeHidden,interval:Mo.interval,minTickGap:Mo.minTickGap,mirror:Mo.mirror,orientation:Mo.orientation,padding:Mo.padding,reversed:Mo.reversed,scale:Mo.scale,tick:Mo.tick,tickCount:Mo.tickCount,tickLine:eh.tickLine,tickSize:eh.tickSize,type:Mo.type,width:Mo.width,yAxisId:0},_be=t=>{var r=ks(t,Ebe);return k.createElement(k.Fragment,null,k.createElement(Nbe,{interval:r.interval,id:r.yAxisId,scale:r.scale,type:r.type,domain:r.domain,allowDataOverflow:r.allowDataOverflow,dataKey:r.dataKey,allowDuplicatedCategory:r.allowDuplicatedCategory,allowDecimals:r.allowDecimals,tickCount:r.tickCount,padding:r.padding,includeHidden:r.includeHidden,reversed:r.reversed,ticks:r.ticks,width:r.width,orientation:r.orientation,mirror:r.mirror,hide:r.hide,unit:r.unit,name:r.name,angle:r.angle,minTickGap:r.minTickGap,tick:r.tick,tickFormatter:r.tickFormatter}),k.createElement(Abe,r))},nu=k.memo(_be,MU);nu.displayName="YAxis";var Tbe=(t,r)=>r,V_=ut([Tbe,Gn,qF,So,_q,wh,Bme,jo],$me),$_=t=>{var r=t.currentTarget.getBoundingClientRect(),n=r.width/t.currentTarget.offsetWidth,i=r.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-r.left)/n),chartY:Math.round((t.clientY-r.top)/i)}},LU=ad("mouseClick"),zU=wy();zU.startListening({actionCreator:LU,effect:(t,r)=>{var n=t.payload,i=V_(r.getState(),$_(n));i?.activeIndex!=null&&r.dispatch(zfe({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}});var ZN=ad("mouseMove"),BU=wy(),s1=null;BU.startListening({actionCreator:ZN,effect:(t,r)=>{var n=t.payload;s1!==null&&cancelAnimationFrame(s1);var i=$_(n);s1=requestAnimationFrame(()=>{var a=r.getState(),s=y_(a,a.tooltip.settings.shared);if(s==="axis"){var o=V_(a,i);o?.activeIndex!=null?r.dispatch(bq({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):r.dispatch(vq())}s1=null})}});function Ibe(t,r){return r instanceof HTMLElement?"HTMLElement <".concat(r.tagName,' class="').concat(r.className,'">'):r===window?"global.window":t==="children"&&typeof r=="object"&&r!==null?"<<CHILDREN>>":r}var ZD={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},FU=fc({name:"rootProps",initialState:ZD,reducers:{updateOptions:(t,r)=>{var n;t.accessibilityLayer=r.payload.accessibilityLayer,t.barCategoryGap=r.payload.barCategoryGap,t.barGap=(n=r.payload.barGap)!==null&&n!==void 0?n:ZD.barGap,t.barSize=r.payload.barSize,t.maxBarSize=r.payload.maxBarSize,t.stackOffset=r.payload.stackOffset,t.syncId=r.payload.syncId,t.syncMethod=r.payload.syncMethod,t.className=r.payload.className,t.baseValue=r.payload.baseValue,t.reverseStackOrder=r.payload.reverseStackOrder}}}),Obe=FU.reducer,{updateOptions:kbe}=FU.actions,qU=fc({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,r)=>r.payload}}),{updatePolarOptions:Dbe}=qU.actions,Pbe=qU.reducer,UU=ad("keyDown"),WU=ad("focus"),G_=wy();G_.startListening({actionCreator:UU,effect:(t,r)=>{var n=r.getState(),i=n.rootProps.accessibilityLayer!==!1;if(i){var{keyboardInteraction:a}=n.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=x_(a,y0(n),Ry(n),zy(n)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var u=wh(n);if(s==="Enter"){var d=_b(n,"axis","hover",String(a.index));r.dispatch(FN({active:!a.active,activeIndex:a.index,activeCoordinate:d}));return}var f=_fe(n),p=f==="left-to-right"?1:-1,x=s==="ArrowRight"?1:-1,v=l+x*p;if(!(u==null||v>=u.length||v<0)){var w=_b(n,"axis","hover",String(v));r.dispatch(FN({active:!0,activeIndex:v.toString(),activeCoordinate:w}))}}}}}});G_.startListening({actionCreator:WU,effect:(t,r)=>{var n=r.getState(),i=n.rootProps.accessibilityLayer!==!1;if(i){var{keyboardInteraction:a}=n.tooltip;if(!a.active&&a.index==null){var s="0",o=_b(n,"axis","hover",String(s));r.dispatch(FN({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Yc=ad("externalEvent"),HU=wy(),jS=new Map;HU.startListening({actionCreator:Yc,effect:(t,r)=>{var{handler:n,reactEvent:i}=t.payload;if(n!=null){i.persist();var a=i.type,s=jS.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=r.getState(),u={activeCoordinate:Cme(l),activeDataKey:S_(l),activeIndex:hf(l),activeLabel:Oq(l),activeTooltipIndex:hf(l),isTooltipActive:Nme(l)};n(u,i)}finally{jS.delete(a)}});jS.set(a,o)}}});var Rbe=ut([p0],t=>t.tooltipItemPayloads),Mbe=ut([Rbe,Ly,(t,r)=>r,(t,r,n)=>n],(t,r,n,i)=>{var a=t.find(l=>l.settings.graphicalItemId===i);if(a!=null){var{positions:s}=a;if(s!=null){var o=r(s,n);return o}}}),VU=ad("touchMove"),$U=wy();$U.startListening({actionCreator:VU,effect:(t,r)=>{var n=t.payload;if(!(n.touches==null||n.touches.length===0)){var i=r.getState(),a=y_(i,i.tooltip.settings.shared);if(a==="axis"){var s=n.touches[0];if(s==null)return;var o=V_(i,$_({clientX:s.clientX,clientY:s.clientY,currentTarget:n.currentTarget}));o?.activeIndex!=null&&r.dispatch(bq({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,u=n.touches[0];if(document.elementFromPoint==null||u==null)return;var d=document.elementFromPoint(u.clientX,u.clientY);if(!d||!d.getAttribute)return;var f=d.getAttribute(d9),p=(l=d.getAttribute(u9))!==null&&l!==void 0?l:void 0,x=g0(i).find(C=>C.id===p);if(f==null||x==null||p==null)return;var{dataKey:v}=x,w=Mbe(i,f,p);r.dispatch(xq({activeDataKey:v,activeIndex:f,activeCoordinate:w,activeGraphicalItemId:p}))}}}});var Lbe=OB({brush:Qye,cartesianAxis:Dye,chartData:Spe,errorBars:$xe,graphicalItems:Fge,layout:Qse,legend:nle,options:xpe,polarAxis:ege,polarOptions:Pbe,referenceElements:rxe,rootProps:Obe,tooltip:Bfe,zIndex:spe}),zbe=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return bse({reducer:Lbe,preloadedState:r,middleware:i=>{var a;return i({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([zU.middleware,BU.middleware,G_.middleware,HU.middleware,$U.middleware])},enhancers:i=>{var a=i;return typeof i=="function"&&(a=i()),a.concat($B({type:"raf"}))},devTools:{serialize:{replacer:Ibe},name:"recharts-".concat(n)}})};function GU(t){var{preloadedState:r,children:n,reduxStoreName:i}=t,a=Ho(),s=k.useRef(null);if(a)return n;s.current==null&&(s.current=zbe(r,i));var o=sE;return k.createElement(b1e,{context:o,store:s.current},n)}function Bbe(t){var{layout:r,margin:n}=t,i=pa(),a=Ho();return k.useEffect(()=>{a||(i($se(r)),i(Vse(n)))},[i,a,r,n]),null}var KU=k.memo(Bbe,Fy);function QU(t){var r=pa();return k.useEffect(()=>{r(kbe(t))},[r,t]),null}function XD(t){var{zIndex:r,isPanorama:n}=t,i=k.useRef(null),a=pa();return k.useLayoutEffect(()=>(i.current&&a(ipe({zIndex:r,element:i.current,isPanorama:n})),()=>{a(ape({zIndex:r,isPanorama:n}))}),[a,r,n]),k.createElement("g",{tabIndex:-1,ref:i})}function JD(t){var{children:r,isPanorama:n}=t,i=wr(Kme);if(!i||i.length===0)return r;var a=i.filter(o=>o<0),s=i.filter(o=>o>0);return k.createElement(k.Fragment,null,a.map(o=>k.createElement(XD,{key:o,zIndex:o,isPanorama:n})),r,s.map(o=>k.createElement(XD,{key:o,zIndex:o,isPanorama:n})))}var Fbe=["children"];function qbe(t,r){if(t==null)return{};var n,i,a=Ube(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function Ube(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Lb(){return Lb=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Lb.apply(null,arguments)}var Wbe={width:"100%",height:"100%",display:"block"},Hbe=k.forwardRef((t,r)=>{var n=pE(),i=gE(),a=_9();if(!hu(n)||!hu(i))return null;var{children:s,otherAttributes:o,title:l,desc:u}=t,d,f;return o!=null&&(typeof o.tabIndex=="number"?d=o.tabIndex:d=a?0:void 0,typeof o.role=="string"?f=o.role:f=a?"application":void 0),k.createElement(QA,Lb({},o,{title:l,desc:u,role:f,tabIndex:d,width:n,height:i,style:Wbe,ref:r}),s)}),Vbe=t=>{var{children:r}=t,n=wr(j2);if(!n)return null;var{width:i,height:a,y:s,x:o}=n;return k.createElement(QA,{width:i,height:a,x:o,y:s},r)},eP=k.forwardRef((t,r)=>{var{children:n}=t,i=qbe(t,Fbe),a=Ho();return a?k.createElement(Vbe,null,k.createElement(JD,{isPanorama:!0},n)):k.createElement(Hbe,Lb({ref:r},i),k.createElement(JD,{isPanorama:!1},n))});function $be(){var t=pa(),[r,n]=k.useState(null),i=wr(hoe);return k.useEffect(()=>{if(r!=null){var a=r.getBoundingClientRect(),s=a.width/r.offsetWidth;oa(s)&&s!==i&&t(Kse(s))}},[r,t,i]),n}function tP(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Gbe(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?tP(Object(n),!0).forEach(function(i){Kbe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tP(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Kbe(t,r,n){return(r=Qbe(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Qbe(t){var r=Ybe(t,"string");return typeof r=="symbol"?r:r+""}function Ybe(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function xm(){return xm=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},xm.apply(null,arguments)}var Zbe=()=>(kpe(),null);function zb(t){if(typeof t=="number")return t;if(typeof t=="string"){var r=parseFloat(t);if(!Number.isNaN(r))return r}return 0}var Xbe=k.forwardRef((t,r)=>{var n,i,a=k.useRef(null),[s,o]=k.useState({containerWidth:zb((n=t.style)===null||n===void 0?void 0:n.width),containerHeight:zb((i=t.style)===null||i===void 0?void 0:i.height)}),l=k.useCallback((d,f)=>{o(p=>{var x=Math.round(d),v=Math.round(f);return p.containerWidth===x&&p.containerHeight===v?p:{containerWidth:x,containerHeight:v}})},[]),u=k.useCallback(d=>{if(typeof r=="function"&&r(d),d!=null&&typeof ResizeObserver<"u"){var{width:f,height:p}=d.getBoundingClientRect();l(f,p);var x=w=>{var{width:C,height:A}=w[0].contentRect;l(C,A)},v=new ResizeObserver(x);v.observe(d),a.current=v}},[r,l]);return k.useEffect(()=>()=>{var d=a.current;d?.disconnect()},[l]),k.createElement(k.Fragment,null,k.createElement(S2,{width:s.containerWidth,height:s.containerHeight}),k.createElement("div",xm({ref:u},t)))}),Jbe=k.forwardRef((t,r)=>{var{width:n,height:i}=t,[a,s]=k.useState({containerWidth:zb(n),containerHeight:zb(i)}),o=k.useCallback((u,d)=>{s(f=>{var p=Math.round(u),x=Math.round(d);return f.containerWidth===p&&f.containerHeight===x?f:{containerWidth:p,containerHeight:x}})},[]),l=k.useCallback(u=>{if(typeof r=="function"&&r(u),u!=null){var{width:d,height:f}=u.getBoundingClientRect();o(d,f)}},[r,o]);return k.createElement(k.Fragment,null,k.createElement(S2,{width:a.containerWidth,height:a.containerHeight}),k.createElement("div",xm({ref:l},t)))}),e2e=k.forwardRef((t,r)=>{var{width:n,height:i}=t;return k.createElement(k.Fragment,null,k.createElement(S2,{width:n,height:i}),k.createElement("div",xm({ref:r},t)))}),t2e=k.forwardRef((t,r)=>{var{width:n,height:i}=t;return oh(n)||oh(i)?k.createElement(Jbe,xm({},t,{ref:r})):k.createElement(e2e,xm({},t,{ref:r}))});function r2e(t){return t===!0?Xbe:t2e}var n2e=k.forwardRef((t,r)=>{var{children:n,className:i,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:u,onMouseEnter:d,onMouseLeave:f,onMouseMove:p,onMouseUp:x,onTouchEnd:v,onTouchMove:w,onTouchStart:C,style:A,width:T,responsive:O,dispatchTouchEvents:D=!0}=t,M=k.useRef(null),Q=pa(),[U,$]=k.useState(null),[ee,F]=k.useState(null),Y=$be(),J=mE(),Z=J?.width>0?J.width:T,re=J?.height>0?J.height:a,de=k.useCallback(ke=>{Y(ke),typeof r=="function"&&r(ke),$(ke),F(ke),ke!=null&&(M.current=ke)},[Y,r,$,F]),le=k.useCallback(ke=>{Q(LU(ke)),Q(Yc({handler:s,reactEvent:ke}))},[Q,s]),K=k.useCallback(ke=>{Q(ZN(ke)),Q(Yc({handler:d,reactEvent:ke}))},[Q,d]),ue=k.useCallback(ke=>{Q(vq()),Q(Yc({handler:f,reactEvent:ke}))},[Q,f]),ce=k.useCallback(ke=>{Q(ZN(ke)),Q(Yc({handler:p,reactEvent:ke}))},[Q,p]),ye=k.useCallback(()=>{Q(WU())},[Q]),Se=k.useCallback(ke=>{Q(UU(ke.key))},[Q]),V=k.useCallback(ke=>{Q(Yc({handler:o,reactEvent:ke}))},[Q,o]),X=k.useCallback(ke=>{Q(Yc({handler:l,reactEvent:ke}))},[Q,l]),se=k.useCallback(ke=>{Q(Yc({handler:u,reactEvent:ke}))},[Q,u]),W=k.useCallback(ke=>{Q(Yc({handler:x,reactEvent:ke}))},[Q,x]),oe=k.useCallback(ke=>{Q(Yc({handler:C,reactEvent:ke}))},[Q,C]),ge=k.useCallback(ke=>{D&&Q(VU(ke)),Q(Yc({handler:w,reactEvent:ke}))},[Q,D,w]),be=k.useCallback(ke=>{Q(Yc({handler:v,reactEvent:ke}))},[Q,v]),Le=r2e(O);return k.createElement(Bq.Provider,{value:U},k.createElement(Kz.Provider,{value:ee},k.createElement(Le,{width:Z??A?.width,height:re??A?.height,className:hi("recharts-wrapper",i),style:Gbe({position:"relative",cursor:"default",width:Z,height:re},A),onClick:le,onContextMenu:V,onDoubleClick:X,onFocus:ye,onKeyDown:Se,onMouseDown:se,onMouseEnter:K,onMouseLeave:ue,onMouseMove:ce,onMouseUp:W,onTouchEnd:be,onTouchMove:ge,onTouchStart:oe,ref:de},k.createElement(Zbe,null),n)))}),i2e=["width","height","responsive","children","className","style","compact","title","desc"];function a2e(t,r){if(t==null)return{};var n,i,a=s2e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function s2e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var YU=k.forwardRef((t,r)=>{var{width:n,height:i,responsive:a,children:s,className:o,style:l,compact:u,title:d,desc:f}=t,p=a2e(t,i2e),x=Hl(p);return u?k.createElement(k.Fragment,null,k.createElement(S2,{width:n,height:i}),k.createElement(eP,{otherAttributes:x,title:d,desc:f},s)):k.createElement(n2e,{className:o,style:l,width:n,height:i,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},k.createElement(eP,{otherAttributes:x,title:d,desc:f,ref:r},k.createElement(ixe,null,s)))});function XN(){return XN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},XN.apply(null,arguments)}var o2e={top:5,right:5,bottom:5,left:5},l2e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:o2e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},K_=k.forwardRef(function(r,n){var i,a=ks(r.categoricalChartProps,l2e),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:u,categoricalChartProps:d}=r,f={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:u,eventEmitter:void 0};return k.createElement(GU,{preloadedState:{options:f},reduxStoreName:(i=d.id)!==null&&i!==void 0?i:s},k.createElement(dU,{chartData:d.data}),k.createElement(KU,{layout:a.layout,margin:a.margin}),k.createElement(QU,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),k.createElement(YU,XN({},a,{ref:n})))}),c2e=["axis"],ZU=k.forwardRef((t,r)=>k.createElement(K_,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:c2e,tooltipPayloadSearcher:V2,categoricalChartProps:t,ref:r})),d2e=["axis","item"],Dg=k.forwardRef((t,r)=>k.createElement(K_,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:d2e,tooltipPayloadSearcher:V2,categoricalChartProps:t,ref:r}));function u2e(t){var r=pa();return k.useEffect(()=>{r(Dbe(t))},[r,t]),null}var h2e=["layout"];function JN(){return JN=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},JN.apply(null,arguments)}function f2e(t,r){if(t==null)return{};var n,i,a=m2e(t,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function m2e(t,r){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(r.indexOf(i)!==-1)continue;n[i]=t[i]}return n}var p2e={top:5,right:5,bottom:5,left:5},XU={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:p2e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},g2e=k.forwardRef(function(r,n){var i,a=ks(r.categoricalChartProps,XU),{layout:s}=a,o=f2e(a,h2e),{chartName:l,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f}=r,p={chartName:l,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return k.createElement(GU,{preloadedState:{options:p},reduxStoreName:(i=a.id)!==null&&i!==void 0?i:l},k.createElement(dU,{chartData:a.data}),k.createElement(KU,{layout:s,margin:a.margin}),k.createElement(QU,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),k.createElement(u2e,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),k.createElement(YU,JN({},o,{ref:n})))});function rP(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function nP(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?rP(Object(n),!0).forEach(function(i){y2e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rP(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function y2e(t,r,n){return(r=x2e(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function x2e(t){var r=v2e(t,"string");return typeof r=="symbol"?r:r+""}function v2e(t,r){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var b2e=["item"],j2e=nP(nP({},XU),{},{layout:"centric",startAngle:0,endAngle:360}),Pg=k.forwardRef((t,r)=>{var n=ks(t,j2e);return k.createElement(g2e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:b2e,tooltipPayloadSearcher:V2,categoricalChartProps:n,ref:r})}),w2e=["axis"],S2e=k.forwardRef((t,r)=>k.createElement(K_,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:w2e,tooltipPayloadSearcher:V2,categoricalChartProps:t,ref:r}));const C2e=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];function N2e({value:t,direction:r}){const n=r==="up"?r0:r==="down"?hz:sz,i=r==="up"?"#10b981":r==="down"?"#ef4444":"#6b7280";return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:i},children:[e.jsx(n,{size:14}),e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:600},children:[Math.abs(t),"%"]})]})}function o1({title:t,subtitle:r,data:n,type:i,dataKey:a="value",colors:s=C2e,height:o=200,trend:l,target:u}){const d=k.useMemo(()=>{switch(i){case"area":return e.jsx(Ic,{width:"100%",height:o,children:e.jsxs(S2e,{data:n,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`gradient-${t}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:s[0],stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:s[0],stopOpacity:0})]})}),e.jsx(Qu,{strokeDasharray:"3 3",stroke:"var(--border)"}),e.jsx(Yu,{dataKey:"name",tick:{fontSize:11},stroke:"var(--text-muted)"}),e.jsx(nu,{tick:{fontSize:11},stroke:"var(--text-muted)"}),e.jsx(kc,{contentStyle:{backgroundColor:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",fontSize:"12px"}}),e.jsx(kU,{type:"monotone",dataKey:a,stroke:s[0],strokeWidth:2,fill:`url(#gradient-${t})`}),u&&e.jsx(ay,{type:"monotone",dataKey:()=>u,stroke:"#ef4444",strokeDasharray:"5 5",strokeWidth:1,dot:!1})]})});case"bar":return e.jsx(Ic,{width:"100%",height:o,children:e.jsxs(Dg,{data:n,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx(Qu,{strokeDasharray:"3 3",stroke:"var(--border)"}),e.jsx(Yu,{dataKey:"name",tick:{fontSize:11},stroke:"var(--text-muted)"}),e.jsx(nu,{tick:{fontSize:11},stroke:"var(--text-muted)"}),e.jsx(kc,{contentStyle:{backgroundColor:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",fontSize:"12px"}}),e.jsx(tf,{dataKey:a,fill:s[0],radius:[4,4,0,0]})]})});case"line":return e.jsx(Ic,{width:"100%",height:o,children:e.jsxs(ZU,{data:n,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx(Qu,{strokeDasharray:"3 3",stroke:"var(--border)"}),e.jsx(Yu,{dataKey:"name",tick:{fontSize:11},stroke:"var(--text-muted)"}),e.jsx(nu,{tick:{fontSize:11},stroke:"var(--text-muted)"}),e.jsx(kc,{contentStyle:{backgroundColor:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",fontSize:"12px"}}),e.jsx(ay,{type:"monotone",dataKey:a,stroke:s[0],strokeWidth:2,dot:{fill:s[0],strokeWidth:2}})]})});case"pie":case"donut":return e.jsx(Ic,{width:"100%",height:o,children:e.jsxs(Pg,{children:[e.jsx(Tp,{data:n,cx:"50%",cy:"50%",innerRadius:i==="donut"?50:0,outerRadius:70,paddingAngle:2,dataKey:a,children:n.map((f,p)=>e.jsx(Ju,{fill:s[p%s.length]},`cell-${p}`))}),e.jsx(kc,{contentStyle:{backgroundColor:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",fontSize:"12px"}}),e.jsx(E9,{wrapperStyle:{fontSize:"11px"},formatter:f=>e.jsx("span",{style:{color:"var(--text-secondary)"},children:f})})]})});default:return null}},[n,i,a,s,o,t,u]);return e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)",margin:0},children:t}),r&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:r})]}),l&&e.jsx(N2e,{value:l.value,direction:l.direction})]}),d]})}function A2e({throughputData:t=[],qcPassRateData:r=[],deliveryData:n=[],orderDistribution:i=[]}){return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(o1,{title:"Production Throughput",subtitle:"Batches completed (last 7 days)",data:t,type:"area",colors:["#3b82f6"],trend:{value:12,direction:"up"}}),e.jsx(o1,{title:"QC Pass Rate",subtitle:"First-time pass rate (%)",data:r,type:"bar",colors:["#10b981"],target:95,trend:{value:2,direction:"up"}}),e.jsx(o1,{title:"On-Time Delivery",subtitle:"Delivery performance (%)",data:n,type:"line",colors:["#8b5cf6"],trend:{value:5,direction:"up"}}),e.jsx(o1,{title:"Order Distribution",subtitle:"By status",data:i,type:"donut",colors:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"]})]})}function E2e(){Gr();const{data:t,isLoading:r,isError:n,error:i,refetch:a,isFetching:s}=Ve({queryKey:["dashboard-overview"],queryFn:async()=>{const{data:l}=await xe.get("/dashboard/overview");return l},refetchInterval:6e4});if(n)return e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(Hr,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Failed to load dashboard"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:i instanceof Error?i.message:"An error occurred while loading the dashboard."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>a(),children:"Try Again"})]});if(r)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[1,2,3,4].map(l=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},l))}),e.jsx("div",{className:"card skeleton",style:{height:"120px",marginBottom:"1.5rem"}}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[1,2,3,4].map(l=>e.jsx("div",{className:"card skeleton",style:{height:"300px"}},l))})]});const o=(t?.journeyCounts||[]).map(l=>({...l,linkTo:_2e(l.id)}));return e.jsxs("div",{children:[e.jsx(s0,{title:"Operations Command Center",subtitle:"End-to-end visibility across orders, production, QC, and logistics",lastRefreshed:t?.lastRefreshed?new Date(t.lastRefreshed):void 0,onRefresh:()=>a(),isRefreshing:s}),e.jsx(Dne,{}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsx(Mne,{alerts:t?.criticalAlerts||[],title:"Requiring Immediate Attention"})}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-muted)",marginBottom:"0.75rem",textTransform:"uppercase"},children:"Performance Analytics"}),e.jsx(A2e,{throughputData:t?.charts?.throughput||I2e(),qcPassRateData:t?.charts?.qcPassRate||O2e(),deliveryData:t?.charts?.delivery||k2e(),orderDistribution:t?.charts?.orderDistribution||D2e()}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-muted)",marginBottom:"0.75rem",textTransform:"uppercase"},children:"Orders & Production"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Due Today",value:t?.kpis?.ordersDueToday||0,icon:e.jsx(Qt,{size:20}),trend:t?.kpis?.ordersDueToday>0?"up":void 0,linkTo:"/orders?due=today"}),e.jsx(nt,{title:"Orders Late",value:t?.kpis?.ordersLate||0,icon:e.jsx(Hr,{size:20}),color:t?.kpis?.ordersLate>0?"danger":void 0,linkTo:"/orders?risk=high"}),e.jsx(nt,{title:"In Production",value:t?.kpis?.batchesInProduction||0,icon:e.jsx(lu,{size:20}),color:"info",linkTo:"/batches?status=IN_PRODUCTION"}),e.jsx(nt,{title:"Awaiting QC",value:t?.kpis?.batchesAwaitingQC||0,icon:e.jsx(Bi,{size:20}),color:"warning",linkTo:"/qc?status=QC_PENDING"}),e.jsx(nt,{title:"Awaiting QP",value:t?.kpis?.batchesAwaitingQP||0,icon:e.jsx(aa,{size:20}),color:"info",linkTo:"/release?status=QC_PASSED"}),e.jsx(nt,{title:"Ready to Dispense",value:t?.kpis?.readyToDispense||0,icon:e.jsx(Rr,{size:20}),color:"success",linkTo:"/dispensing?ready=true"})]}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-muted)",marginBottom:"0.75rem",textTransform:"uppercase"},children:"Logistics"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Ready to Dispatch",value:t?.kpis?.shipmentsReadyToDispatch||0,icon:e.jsx(dn,{size:20}),linkTo:"/shipments?status=ASSIGNED"}),e.jsx(nt,{title:"Delayed",value:t?.kpis?.shipmentsDelayed||0,icon:e.jsx(Hr,{size:20}),color:t?.kpis?.shipmentsDelayed>0?"danger":void 0,linkTo:"/shipments?status=DELAYED"}),e.jsx(nt,{title:"Delivered Today",value:t?.kpis?.deliveredToday||0,icon:e.jsx(Ft,{size:20}),color:"success",linkTo:"/shipments?delivered=today"})]}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-muted)",marginBottom:"0.75rem",textTransform:"uppercase"},children:"Procurement & Inventory"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"PO Pending Approval",value:t?.kpis?.poPendingApproval||0,icon:e.jsx(Ir,{size:20}),color:"warning",linkTo:"/purchase-orders?status=PENDING_APPROVAL"}),e.jsx(nt,{title:"PO Sent",value:t?.kpis?.poSent||0,icon:e.jsx(Fo,{size:20}),color:"info",linkTo:"/purchase-orders?status=SENT"}),e.jsx(nt,{title:"GRN Pending QC",value:t?.kpis?.grnPendingQC||0,icon:e.jsx(rh,{size:20}),color:"warning",linkTo:"/grn?status=PENDING_QC"}),e.jsx(nt,{title:"Low Stock Items",value:t?.kpis?.lowStockItems||0,icon:e.jsx(lm,{size:20}),color:t?.kpis?.lowStockItems>0?"danger":void 0,linkTo:"/inventory?lowStock=true"}),e.jsx(nt,{title:"eBR In Progress",value:t?.kpis?.batchRecordsInProgress||0,icon:e.jsx(lu,{size:20}),color:"info",linkTo:"/manufacturing?status=IN_PROGRESS"})]}),e.jsx(Hz,{title:"End-to-End Order Journey",stages:o}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-muted)",marginBottom:"0.75rem",textTransform:"uppercase"},children:"Work Queues - Production"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(Tc,{title:"Validation Queue",items:t?.queues?.validation||[],viewAllLink:"/orders?status=SUBMITTED",maxItems:5,icon:e.jsx(sf,{size:18,style:{color:"#2563eb"}}),accentColor:"#2563eb",emptyMessage:"No orders awaiting validation"}),e.jsx(Tc,{title:"Manufacturing Queue",items:t?.queues?.manufacturing||[],viewAllLink:"/manufacturing?status=IN_PROGRESS",maxItems:5,icon:e.jsx(lu,{size:18,style:{color:"#059669"}}),accentColor:"#059669",emptyMessage:"No batch records in progress"}),e.jsx(Tc,{title:"QC Queue",items:t?.queues?.qc||[],viewAllLink:"/qc?status=QC_PENDING",maxItems:5,icon:e.jsx(Bi,{size:18,style:{color:"#d97706"}}),accentColor:"#d97706",emptyMessage:"No batches awaiting QC"}),e.jsx(Tc,{title:"QP Release Queue",items:t?.queues?.qp||[],viewAllLink:"/release?status=QC_PASSED",maxItems:5,icon:e.jsx(aa,{size:18,style:{color:"#7c3aed"}}),accentColor:"#7c3aed",emptyMessage:"No batches awaiting QP release"})]}),e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--text-muted)",marginBottom:"0.75rem",textTransform:"uppercase"},children:"Work Queues - Procurement & Logistics"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(Tc,{title:"PO Approval Queue",items:t?.queues?.poApproval||[],viewAllLink:"/purchase-orders?status=PENDING_APPROVAL",maxItems:5,icon:e.jsx(Ir,{size:18,style:{color:"#ea580c"}}),accentColor:"#ea580c",emptyMessage:"No POs awaiting approval"}),e.jsx(Tc,{title:"GRN QC Queue",items:t?.queues?.grnQc||[],viewAllLink:"/grn?status=PENDING_QC",maxItems:5,icon:e.jsx(rh,{size:18,style:{color:"#0284c7"}}),accentColor:"#0284c7",emptyMessage:"No GRNs awaiting QC"}),e.jsx(Tc,{title:"Logistics Queue",items:t?.queues?.logistics||[],viewAllLink:"/shipments?status=CREATED",maxItems:5,icon:e.jsx(dn,{size:18,style:{color:"#0891b2"}}),accentColor:"#0891b2",emptyMessage:"No shipments pending"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr 1fr",gap:"1rem"},children:[e.jsx(yy,{title:"Exceptions & Alerts",items:t?.exceptions||[]}),e.jsx(kne,{title:"Capacity Overview (7 Days)",days:t?.capacity||T2e()}),e.jsx(One,{title:"Recent Activity",events:t?.recentActivity||[],maxEvents:8})]})]})}function _2e(t){return{submitted:"/orders?status=SUBMITTED",validated:"/orders?status=VALIDATED",scheduled:"/orders?status=SCHEDULED",in_production:"/batches?status=IN_PRODUCTION",qc_pending:"/qc?status=QC_PENDING",released:"/batches?status=RELEASED",dispensing:"/dispensing",packed:"/batches?status=PACKED",dispatched:"/shipments?status=IN_TRANSIT",delivered:"/shipments?status=DELIVERED"}[t]||"/orders"}function T2e(){const t=[],r=new Date;for(let n=0;n<7;n++){const i=new Date(r);i.setDate(i.getDate()+n),t.push({date:i,reservedMinutes:Math.floor(Math.random()*200)+100,committedMinutes:Math.floor(Math.random()*100)+50,totalCapacity:480,isFull:!1})}return t}function I2e(){return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(r=>({name:r,value:Math.floor(Math.random()*15)+5}))}function O2e(){return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(r=>({name:r,value:Math.floor(Math.random()*10)+88}))}function k2e(){return["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(r=>({name:r,value:Math.floor(Math.random()*8)+90}))}function D2e(){return[{name:"Pending",value:12},{name:"In Progress",value:28},{name:"QC",value:8},{name:"Ready",value:15},{name:"Delivered",value:42}]}function P2e(){const t=Gr(),[r,n]=k.useState({}),[i,a]=k.useState(null),{data:s,isLoading:o}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:w}=await xe.get("/customers");return w}}),{data:l}=Ve({queryKey:["settings","categories"],queryFn:async()=>{const{data:w}=await xe.get("/settings/categories");return w}}),u=w=>w?new Date(w)<new Date:!1,d=w=>!w.documents||w.documents.length===0,f=[{key:"search",label:"Search",type:"search",placeholder:"Search name, code, mobile, email, CR, tax..."},{key:"category",label:"Category",type:"select",options:[{value:"",label:"All Categories"},...l?.map(w=>({value:w.id,label:w.name}))||[]]},{key:"licenseStatus",label:"License",type:"select",options:[{value:"",label:"All"},{value:"valid",label:"Valid"},{value:"expired",label:"Expired"}]},{key:"docsStatus",label:"Documents",type:"select",options:[{value:"",label:"All"},{value:"missing",label:"Missing Docs"},{value:"uploaded",label:"Has Docs"}]}],p=s?.filter(w=>{if(r.category&&w.categoryId!==r.category||r.licenseStatus==="valid"&&u(w.licenseExpiryDate)||r.licenseStatus==="expired"&&!u(w.licenseExpiryDate)||r.docsStatus==="missing"&&!d(w)||r.docsStatus==="uploaded"&&d(w)||i==="expired"&&!u(w.licenseExpiryDate)||i==="licensed"&&u(w.licenseExpiryDate)||i==="hospitals"&&!w.category?.name?.toLowerCase().includes("hospital")||i==="missingDocs"&&!d(w))return!1;if(r.search){const C=r.search.toLowerCase();if(![w.name,w.nameEn,w.nameAr,w.code,w.email,w.mobile,w.phone,w.crNumber,w.taxNumber].some(T=>T?.toLowerCase().includes(C)))return!1}return!0}),x={total:s?.length||0,licensed:s?.filter(w=>!u(w.licenseExpiryDate)).length||0,expired:s?.filter(w=>u(w.licenseExpiryDate)).length||0,hospitals:s?.filter(w=>w.category?.name?.toLowerCase().includes("hospital")).length||0,missingDocs:s?.filter(w=>d(w)).length||0},v=w=>{a(i===w?null:w)};return o?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Customer Management"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage healthcare facilities and their licensing information"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>t("/customers/new"),children:[e.jsx(cn,{size:16}),"Add Customer"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Customers",value:x.total,icon:e.jsx(dc,{size:20}),color:"primary",onClick:()=>a(null),selected:i===null}),e.jsx(nt,{title:"Licensed",value:x.licensed,icon:e.jsx(dX,{size:20}),color:"success",onClick:()=>v("licensed"),selected:i==="licensed"}),e.jsx(nt,{title:"License Expired",value:x.expired,icon:e.jsx(Hr,{size:20}),color:"danger",onClick:()=>v("expired"),selected:i==="expired"}),e.jsx(nt,{title:"Hospitals",value:x.hospitals,icon:e.jsx(Lp,{size:20}),color:"info",onClick:()=>v("hospitals"),selected:i==="hospitals"}),e.jsx(nt,{title:"Missing Docs",value:x.missingDocs,icon:e.jsx(Ir,{size:20}),color:"warning",onClick:()=>v("missingDocs"),selected:i==="missingDocs"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:f,values:r,onChange:(w,C)=>n(A=>({...A,[w]:C})),onReset:()=>{n({}),a(null)}})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Customer List (",p?.length||0,")"]})}),p?.length>0?e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"table",style:{marginBottom:0,minWidth:"1000px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name (EN / AR)"}),e.jsx("th",{children:"City"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"CR Number"}),e.jsx("th",{children:"Tax Number"}),e.jsx("th",{children:"Docs"}),e.jsx("th",{children:"License Status"}),e.jsx("th",{style:{width:"80px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:p.map(w=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem"},children:w.code}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:w.nameEn||w.name}),w.nameAr&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",direction:"rtl"},children:w.nameAr})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(_a,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:w.city?.name||w.district||"-"})]})}),e.jsx("td",{children:e.jsxs("div",{style:{fontSize:"0.8125rem"},children:[w.mobile&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(vo,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:w.mobile})]}),w.email&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--text-muted)",fontSize:"0.75rem"},children:[e.jsx(uc,{size:12}),e.jsx("span",{children:w.email})]}),!w.mobile&&!w.email&&"-"]})}),e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.75rem"},children:w.crNumber||"-"}),e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.75rem"},children:w.taxNumber||"-"}),e.jsx("td",{children:w.documents?.length>0?e.jsxs("span",{className:"badge badge-success",style:{fontSize:"0.6875rem"},children:[w.documents.length," docs"]}):e.jsx("span",{className:"badge badge-warning",style:{fontSize:"0.6875rem"},children:"None"})}),e.jsx("td",{children:w.licenseNumber?e.jsxs("div",{children:[u(w.licenseExpiryDate)?e.jsx(Pn,{status:"EXPIRED",size:"sm"}):e.jsx(Pn,{status:"VALID",size:"sm"}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginTop:"0.125rem"},children:w.licenseExpiryDate?`Exp: ${Ze(new Date(w.licenseExpiryDate),"MMM dd, yyyy")}`:""})]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8125rem"},children:"-"})}),e.jsx("td",{children:e.jsx("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>t(`/customers/${w.id}/edit`),title:"Edit Customer",children:e.jsx(ma,{size:14})})})})]},w.id))})]})}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No customers found",message:"Add your first customer to get started",icon:"package"})})]})]})}function an(t){return t?t.response?.data?.error?t.response.data.error:t.response?.data?.message?{code:"UNKNOWN",message:t.response.data.message,userMessage:t.response.data.message}:t.message?{code:"NETWORK_ERROR",message:t.message,userMessage:"Unable to connect to the server. Please check your connection and try again."}:{code:"UNKNOWN",message:"An unknown error occurred",userMessage:"Something went wrong. Please try again."}:null}const iP={CR:"Commercial Registration",TAX_CERT:"Tax Certificate",LICENSE:"License",CONTRACT:"Contract",NDA:"Non-Disclosure Agreement",OTHER:"Other"},aP=5*1024*1024;function sP(){const{id:t}=fl(),r=Gr(),n=pr(),i=gn(),a=!!t,[s,o]=k.useState({code:"",nameEn:"",nameAr:"",email:"",mobile:"",phone:"",crNumber:"",taxNumber:"",fullAddress:"",shortAddress:"",buildingNo:"",street:"",secondaryNo:"",district:"",postalCode:"",countryId:"",regionId:"",cityId:"",categoryId:"",latitude:"",longitude:"",licenseNumber:"",licenseExpiryDate:"",travelTimeMinutes:60}),[l,u]=k.useState({}),[d,f]=k.useState(null),[p,x]=k.useState(!1),[v,w]=k.useState(!1),[C,A]=k.useState("CR"),T=k.useRef(null),O=k.useRef(null),{data:D,isLoading:M}=Ve({queryKey:["customer",t],queryFn:async()=>{const{data:V}=await xe.get(`/customers/${t}`);return V},enabled:a}),{data:Q}=Ve({queryKey:["settings","countries"],queryFn:async()=>{const{data:V}=await xe.get("/settings/countries");return V}}),{data:U}=Ve({queryKey:["settings","regions",s.countryId],queryFn:async()=>{const V=s.countryId?{countryId:s.countryId}:{},{data:X}=await xe.get("/settings/regions",{params:V});return X}}),{data:$}=Ve({queryKey:["settings","cities",s.regionId],queryFn:async()=>{const V=s.regionId?{regionId:s.regionId}:{},{data:X}=await xe.get("/settings/cities",{params:V});return X},enabled:!!s.regionId}),{data:ee}=Ve({queryKey:["settings","categories"],queryFn:async()=>{const{data:V}=await xe.get("/settings/categories");return V}});k.useEffect(()=>{if(D)o({code:D.code||"",nameEn:D.nameEn||D.name||"",nameAr:D.nameAr||"",email:D.email||"",mobile:D.mobile||D.phone||"",phone:D.phone||"",crNumber:D.crNumber||"",taxNumber:D.taxNumber||"",fullAddress:D.fullAddress||D.address||"",shortAddress:D.shortAddress||"",buildingNo:D.buildingNo||"",street:D.street||"",secondaryNo:D.secondaryNo||"",district:D.district||"",postalCode:D.postalCode||"",countryId:D.countryId||"",regionId:D.regionId||"",cityId:D.cityId||"",categoryId:D.categoryId||"",latitude:D.latitude?.toString()||"",longitude:D.longitude?.toString()||"",licenseNumber:D.licenseNumber||"",licenseExpiryDate:D.licenseExpiryDate?.split("T")[0]||"",travelTimeMinutes:D.travelTimeMinutes||60}),D.logoUrl&&f(D.logoUrl);else if(!a&&Q?.length>0){const V=Q.find(X=>X.code==="SA");V&&o(X=>({...X,countryId:V.id}))}},[D,Q,a]);const F=()=>{const V={};if(s.code.trim()||(V.code="Customer code is required"),s.nameEn.trim()||(V.nameEn="English name is required"),s.nameAr.trim()||(V.nameAr="Arabic name is required"),!s.mobile.trim())V.mobile="Mobile number is required";else{const X=/^(\+9665|05)\d{8}$/,se=/^\+\d{10,15}$/;!X.test(s.mobile)&&!se.test(s.mobile)&&(V.mobile="Enter a valid Saudi mobile number (e.g., 05xxxxxxxx or +9665xxxxxxxx)")}if(s.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)&&(V.email="Enter a valid email address"),s.crNumber.trim()||(V.crNumber="Commercial Registration number is required"),s.taxNumber.trim()||(V.taxNumber="Tax number is required"),s.fullAddress.trim()||(V.fullAddress="Full address is required"),s.shortAddress.trim()?/^[A-Z]{4}\d{4}$/.test(s.shortAddress.trim())||(V.shortAddress="Format: 4 letters + 4 digits (e.g., JERA4240)"):V.shortAddress="Short address is required (e.g., ABCD1234)",s.buildingNo.trim()||(V.buildingNo="Building number is required"),s.street.trim()||(V.street="Street name is required"),s.secondaryNo.trim()||(V.secondaryNo="Secondary number is required"),s.district.trim()||(V.district="District is required"),s.postalCode.trim()?/^\d{5}$/.test(s.postalCode.trim())||(V.postalCode="Postal code must be 5 digits"):V.postalCode="Postal code is required",s.cityId||(V.cityId="City is required"),s.latitude){const X=parseFloat(s.latitude);(isNaN(X)||X<-90||X>90)&&(V.latitude="Latitude must be between -90 and 90")}if(s.longitude){const X=parseFloat(s.longitude);(isNaN(X)||X<-180||X>180)&&(V.longitude="Longitude must be between -180 and 180")}return u(V),Object.keys(V).length===0},Y=ot({mutationFn:async V=>a?xe.put(`/customers/${t}`,V):xe.post("/customers",V),onSuccess:()=>{n.invalidateQueries({queryKey:["customers"]}),i.success(a?"Customer Updated":"Customer Created",a?"Customer details have been updated":"New customer has been added"),r("/customers")},onError:V=>{const X=an(V);i.error("Error",X?.userMessage||"Failed to save customer")}}),J=(V,X=!0)=>{if(V.preventDefault(),!F()){i.error("Validation Error","Please fix the errors in the form");return}Y.mutate(s)},Z=async V=>{if(!a){i.error("Error","Please save the customer first before uploading a logo");return}if(!["image/png","image/jpeg","image/jpg"].includes(V.type)){i.error("Invalid File Type","Only PNG and JPG images are allowed");return}if(V.size>aP){i.error("File Too Large","File exceeds 5 MB. Please upload a smaller file.");return}x(!0);const X=new FormData;X.append("logo",V);try{const{data:se}=await xe.post(`/customers/${t}/logo`,X,{headers:{"Content-Type":"multipart/form-data"}});f(se.logoUrl),n.invalidateQueries({queryKey:["customer",t]}),i.success("Logo Uploaded","Customer logo has been updated")}catch(se){const W=an(se);i.error("Upload Failed",W?.userMessage||"Failed to upload logo")}finally{x(!1)}},re=async()=>{if(a)try{await xe.delete(`/customers/${t}/logo`),f(null),n.invalidateQueries({queryKey:["customer",t]}),i.success("Logo Removed","Customer logo has been removed")}catch{i.error("Error","Failed to remove logo")}},de=async V=>{if(!a){i.error("Error","Please save the customer first before uploading documents");return}if(!["image/png","image/jpeg","image/jpg","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(V.type)){i.error("Invalid File Type","Allowed: PDF, PNG, JPG, DOCX");return}if(V.size>aP){i.error("File Too Large","File exceeds 5 MB. Please upload a smaller document.");return}w(!0);const se=new FormData;se.append("document",V),se.append("docType",C);try{await xe.post(`/customers/${t}/documents`,se,{headers:{"Content-Type":"multipart/form-data"}}),n.invalidateQueries({queryKey:["customer",t]}),i.success("Document Uploaded","Document has been added")}catch(W){const oe=an(W);i.error("Upload Failed",oe?.userMessage||"Failed to upload document")}finally{w(!1)}},le=async V=>{if(confirm("Are you sure you want to delete this document?"))try{await xe.delete(`/customers/${t}/documents/${V}`),n.invalidateQueries({queryKey:["customer",t]}),i.success("Document Deleted","Document has been removed")}catch{i.error("Error","Failed to delete document")}},K=V=>V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(1)} MB`,ue=(V,X)=>{o(se=>({...se,[V]:X})),l[V]&&u(se=>({...se,[V]:""}))},ce=V=>{o(X=>({...X,countryId:V,regionId:"",cityId:""}))},ye=V=>{o(X=>({...X,regionId:V,cityId:""}))};if(M&&a)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const Se=Object.keys(l).filter(V=>l[V]).length;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r("/customers"),children:e.jsx(sa,{size:16})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:a?"Edit Customer":"Create New Customer"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:a?"Update customer information and documents":"Add a new customer to the system"})]})]}),Se>0&&e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",borderColor:"var(--danger)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--danger)"},children:[e.jsx(sn,{size:18}),e.jsxs("span",{style:{fontWeight:500},children:["Please fix ",Se," error(s) before saving"]})]})}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(Uo,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Basic Information"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Customer Code *"}),e.jsx("input",{type:"text",className:`form-input ${l.code?"error":""}`,value:s.code,onChange:V=>ue("code",V.target.value),placeholder:"e.g., CUST001",disabled:a}),l.code&&e.jsx("span",{className:"form-error",children:l.code})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsxs("select",{className:"form-select",value:s.categoryId,onChange:V=>ue("categoryId",V.target.value),children:[e.jsx("option",{value:"",children:"Select Category"}),ee?.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (English) *"}),e.jsx("input",{type:"text",className:`form-input ${l.nameEn?"error":""}`,value:s.nameEn,onChange:V=>ue("nameEn",V.target.value),placeholder:"Customer name in English"}),l.nameEn&&e.jsx("span",{className:"form-error",children:l.nameEn})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic) *  "}),e.jsx("input",{type:"text",className:`form-input ${l.nameAr?"error":""}`,value:s.nameAr,onChange:V=>ue("nameAr",V.target.value),placeholder:" ",dir:"rtl"}),l.nameAr&&e.jsx("span",{className:"form-error",children:l.nameAr})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:`form-input ${l.email?"error":""}`,value:s.email,onChange:V=>ue("email",V.target.value),placeholder:"customer@example.com"}),l.email&&e.jsx("span",{className:"form-error",children:l.email})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Mobile Number *"}),e.jsx("input",{type:"tel",className:`form-input ${l.mobile?"error":""}`,value:s.mobile,onChange:V=>ue("mobile",V.target.value),placeholder:"05xxxxxxxx or +9665xxxxxxxx"}),l.mobile&&e.jsx("span",{className:"form-error",children:l.mobile})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Phone (Landline)"}),e.jsx("input",{type:"tel",className:"form-input",value:s.phone,onChange:V=>ue("phone",V.target.value),placeholder:"Optional"})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(_a,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Address & Location"})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Full Address *"}),e.jsx("textarea",{className:`form-textarea ${l.fullAddress?"error":""}`,value:s.fullAddress,onChange:V=>ue("fullAddress",V.target.value),rows:3,placeholder:"Enter complete street address, building name, landmarks...",style:{width:"100%",resize:"vertical"}}),l.fullAddress&&e.jsx("span",{className:"form-error",children:l.fullAddress})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"1rem",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx(_a,{size:16,style:{color:"var(--primary)"}}),e.jsx("h4",{style:{fontSize:"0.8125rem",fontWeight:600,margin:0,color:"var(--text-primary)"},children:"Saudi National Address"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Short Address *"}),e.jsx("input",{type:"text",className:`form-input ${l.shortAddress?"error":""}`,value:s.shortAddress,onChange:V=>ue("shortAddress",V.target.value.toUpperCase()),placeholder:"ABCD1234",maxLength:8}),l.shortAddress&&e.jsx("span",{className:"form-error",children:l.shortAddress})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Building No. *"}),e.jsx("input",{type:"text",className:`form-input ${l.buildingNo?"error":""}`,value:s.buildingNo,onChange:V=>ue("buildingNo",V.target.value),placeholder:"e.g., 4240"}),l.buildingNo&&e.jsx("span",{className:"form-error",children:l.buildingNo})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Street *"}),e.jsx("input",{type:"text",className:`form-input ${l.street?"error":""}`,value:s.street,onChange:V=>ue("street",V.target.value),placeholder:"e.g., Muhammad Ali Maghrebi"}),l.street&&e.jsx("span",{className:"form-error",children:l.street})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Secondary No. *"}),e.jsx("input",{type:"text",className:`form-input ${l.secondaryNo?"error":""}`,value:s.secondaryNo,onChange:V=>ue("secondaryNo",V.target.value),placeholder:"e.g., 9014"}),l.secondaryNo&&e.jsx("span",{className:"form-error",children:l.secondaryNo})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"District *"}),e.jsx("input",{type:"text",className:`form-input ${l.district?"error":""}`,value:s.district,onChange:V=>ue("district",V.target.value),placeholder:"e.g., Ar Rawdah Dist."}),l.district&&e.jsx("span",{className:"form-error",children:l.district})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Postal Code *"}),e.jsx("input",{type:"text",className:`form-input ${l.postalCode?"error":""}`,value:s.postalCode,onChange:V=>ue("postalCode",V.target.value),placeholder:"e.g., 23434",maxLength:5}),l.postalCode&&e.jsx("span",{className:"form-error",children:l.postalCode})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsxs("select",{className:"form-select",value:s.countryId,onChange:V=>ce(V.target.value),children:[e.jsx("option",{value:"",children:"Select Country"}),Q?.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Region"}),e.jsxs("select",{className:"form-select",value:s.regionId,onChange:V=>ye(V.target.value),disabled:!s.countryId,children:[e.jsx("option",{value:"",children:"Select Region"}),U?.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"City *"}),e.jsxs("select",{className:`form-select ${l.cityId?"error":""}`,value:s.cityId,onChange:V=>ue("cityId",V.target.value),disabled:!s.regionId,children:[e.jsx("option",{value:"",children:"Select City"}),$?.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]}),l.cityId&&e.jsx("span",{className:"form-error",children:l.cityId})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Latitude"}),e.jsx("input",{type:"number",step:"any",className:`form-input ${l.latitude?"error":""}`,value:s.latitude,onChange:V=>ue("latitude",V.target.value),placeholder:"-90 to 90"}),l.latitude&&e.jsx("span",{className:"form-error",children:l.latitude})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Longitude"}),e.jsx("input",{type:"number",step:"any",className:`form-input ${l.longitude?"error":""}`,value:s.longitude,onChange:V=>ue("longitude",V.target.value),placeholder:"-180 to 180"}),l.longitude&&e.jsx("span",{className:"form-error",children:l.longitude})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Travel Time (min)"}),e.jsx("input",{type:"number",className:"form-input",value:s.travelTimeMinutes,onChange:V=>ue("travelTimeMinutes",parseInt(V.target.value)||60),min:0})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(Lp,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Business Identifiers"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Commercial Registration (CR) *"}),e.jsx("input",{type:"text",className:`form-input ${l.crNumber?"error":""}`,value:s.crNumber,onChange:V=>ue("crNumber",V.target.value),placeholder:"e.g., 1010xxxxxx"}),l.crNumber&&e.jsx("span",{className:"form-error",children:l.crNumber})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tax Number (VAT) *"}),e.jsx("input",{type:"text",className:`form-input ${l.taxNumber?"error":""}`,value:s.taxNumber,onChange:V=>ue("taxNumber",V.target.value),placeholder:"e.g., 3xxxxxxxxxxxxxxx"}),l.taxNumber&&e.jsx("span",{className:"form-error",children:l.taxNumber})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"License Number"}),e.jsx("input",{type:"text",className:"form-input",value:s.licenseNumber,onChange:V=>ue("licenseNumber",V.target.value),placeholder:"Operating license number"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"License Expiry Date"}),e.jsx("input",{type:"date",className:"form-input",value:s.licenseExpiryDate,onChange:V=>ue("licenseExpiryDate",V.target.value)})]})]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(Rv,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Branding"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"120px",height:"120px",border:"2px dashed var(--border)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"var(--bg-secondary)",overflow:"hidden"},children:d?e.jsx("img",{src:d,alt:"Customer Logo",style:{width:"100%",height:"100%",objectFit:"contain"}}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:[e.jsx(Rv,{size:32}),e.jsx("p",{style:{fontSize:"0.75rem",margin:"0.5rem 0 0"},children:"No logo"})]})}),e.jsx("input",{ref:T,type:"file",accept:"image/png,image/jpeg,image/jpg",style:{display:"none"},onChange:V=>V.target.files?.[0]&&Z(V.target.files[0])}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{type:"button",className:"btn btn-outline btn-sm",onClick:()=>T.current?.click(),disabled:!a||p,children:p?"Uploading...":e.jsxs(e.Fragment,{children:[e.jsx(om,{size:14})," Upload"]})}),d&&e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:re,children:e.jsx(Gi,{size:14})})]}),e.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center",margin:0},children:["PNG or JPG, max 5MB",!a&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"Save customer first"]})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(gu,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Documents"})]}),a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("select",{className:"form-select",value:C,onChange:V=>A(V.target.value),style:{flex:1},children:Object.entries(iP).map(([V,X])=>e.jsx("option",{value:V,children:X},V))}),e.jsx("input",{ref:O,type:"file",accept:".pdf,.png,.jpg,.jpeg,.doc,.docx",style:{display:"none"},onChange:V=>V.target.files?.[0]&&de(V.target.files[0])}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>O.current?.click(),disabled:v,children:v?"Uploading...":e.jsxs(e.Fragment,{children:[e.jsx(om,{size:14})," Add"]})})]}),D?.documents?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:D.documents.map(V=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(Ir,{size:20,style:{color:"var(--primary)",flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.8125rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:V.docName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("span",{className:"badge badge-default",style:{fontSize:"0.625rem"},children:iP[V.docType]||V.docType}),e.jsx("span",{children:K(V.fileSizeBytes)}),e.jsx("span",{children:Ze(new Date(V.uploadedAt),"MMM dd, yyyy")})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("a",{href:V.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-sm",style:{padding:"0.25rem"},children:e.jsx(Jp,{size:14})}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",style:{padding:"0.25rem"},onClick:()=>le(V.id),children:e.jsx(Dr,{size:14})})]})]},V.id))}):e.jsxs("div",{style:{textAlign:"center",padding:"2rem 1rem",color:"var(--text-muted)"},children:[e.jsx(Ir,{size:32,style:{opacity:.5}}),e.jsx("p",{style:{fontSize:"0.875rem",margin:"0.5rem 0 0"},children:"No documents uploaded"})]})]}):e.jsxs("div",{style:{textAlign:"center",padding:"2rem 1rem",color:"var(--text-muted)"},children:[e.jsx(Ir,{size:32,style:{opacity:.5}}),e.jsx("p",{style:{fontSize:"0.875rem",margin:"0.5rem 0 0"},children:"Save customer first to upload documents"})]}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center",marginTop:"0.75rem"},children:"PDF, PNG, JPG, DOCX - Max 5MB each"})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1rem 1.5rem",marginTop:"1.5rem",display:"flex",justifyContent:"flex-end",gap:"0.75rem"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>r("/customers"),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:Y.isPending,children:[e.jsx(cc,{size:16}),Y.isPending?"Saving...":a?"Update Customer":"Create Customer"]})]})]})]})}let R2e={data:""},M2e=t=>{if(typeof window=="object"){let r=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return r.nonce=window.__nonce__,r.parentNode||(t||document.head).appendChild(r),r.firstChild}return t||R2e},L2e=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,z2e=/\/\*[^]*?\*\/|  +/g,oP=/\n+/g,Jh=(t,r)=>{let n="",i="",a="";for(let s in t){let o=t[s];s[0]=="@"?s[1]=="i"?n=s+" "+o+";":i+=s[1]=="f"?Jh(o,s):s+"{"+Jh(o,s[1]=="k"?"":r)+"}":typeof o=="object"?i+=Jh(o,r?r.replace(/([^,])+/g,l=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Jh.p?Jh.p(s,o):s+":"+o+";")}return n+(r&&a?r+"{"+a+"}":a)+i},zu={},JU=t=>{if(typeof t=="object"){let r="";for(let n in t)r+=n+JU(t[n]);return r}return t},B2e=(t,r,n,i,a)=>{let s=JU(t),o=zu[s]||(zu[s]=(u=>{let d=0,f=11;for(;d<u.length;)f=101*f+u.charCodeAt(d++)>>>0;return"go"+f})(s));if(!zu[o]){let u=s!==t?t:(d=>{let f,p,x=[{}];for(;f=L2e.exec(d.replace(z2e,""));)f[4]?x.shift():f[3]?(p=f[3].replace(oP," ").trim(),x.unshift(x[0][p]=x[0][p]||{})):x[0][f[1]]=f[2].replace(oP," ").trim();return x[0]})(t);zu[o]=Jh(a?{["@keyframes "+o]:u}:u,n?"":"."+o)}let l=n&&zu.g?zu.g:null;return n&&(zu.g=zu[o]),((u,d,f,p)=>{p?d.data=d.data.replace(p,u):d.data.indexOf(u)===-1&&(d.data=f?u+d.data:d.data+u)})(zu[o],r,i,l),o},F2e=(t,r,n)=>t.reduce((i,a,s)=>{let o=r[s];if(o&&o.call){let l=o(n),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Jh(l,""):l===!1?"":l}return i+a+(o??"")},"");function tj(t){let r=this||{},n=t.call?t(r.p):t;return B2e(n.unshift?n.raw?F2e(n,[].slice.call(arguments,1),r.p):n.reduce((i,a)=>Object.assign(i,a&&a.call?a(r.p):a),{}):n,M2e(r.target),r.g,r.o,r.k)}let eW,eA,tA;tj.bind({g:1});let mh=tj.bind({k:1});function q2e(t,r,n,i){Jh.p=r,eW=t,eA=n,tA=i}function vf(t,r){let n=this||{};return function(){let i=arguments;function a(s,o){let l=Object.assign({},s),u=l.className||a.className;n.p=Object.assign({theme:eA&&eA()},l),n.o=/ *go\d+/.test(u),l.className=tj.apply(n,i)+(u?" "+u:"");let d=t;return t[0]&&(d=l.as||t,delete l.as),tA&&d[0]&&tA(l),eW(d,l)}return a}}var U2e=t=>typeof t=="function",rA=(t,r)=>U2e(t)?t(r):t,W2e=(()=>{let t=0;return()=>(++t).toString()})(),H2e=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");t=!r||r.matches}return t}})(),V2e=20,tW="default",rW=(t,r)=>{let{toastLimit:n}=t.settings;switch(r.type){case 0:return{...t,toasts:[r.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===r.toast.id?{...o,...r.toast}:o)};case 2:let{toast:i}=r;return rW(t,{type:t.toasts.find(o=>o.id===i.id)?1:0,toast:i});case 3:let{toastId:a}=r;return{...t,toasts:t.toasts.map(o=>o.id===a||a===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return r.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==r.toastId)};case 5:return{...t,pausedAt:r.time};case 6:let s=r.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+s}))}}},$2e=[],G2e={toasts:[],pausedAt:void 0,settings:{toastLimit:V2e}},Ip={},nW=(t,r=tW)=>{Ip[r]=rW(Ip[r]||G2e,t),$2e.forEach(([n,i])=>{n===r&&i(Ip[r])})},iW=t=>Object.keys(Ip).forEach(r=>nW(t,r)),K2e=t=>Object.keys(Ip).find(r=>Ip[r].toasts.some(n=>n.id===t)),Q_=(t=tW)=>r=>{nW(r,t)},Q2e=(t,r="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:n?.id||W2e()}),Uy=t=>(r,n)=>{let i=Q2e(r,t,n);return Q_(i.toasterId||K2e(i.id))({type:2,toast:i}),i.id},ul=(t,r)=>Uy("blank")(t,r);ul.error=Uy("error");ul.success=Uy("success");ul.loading=Uy("loading");ul.custom=Uy("custom");ul.dismiss=(t,r)=>{let n={type:3,toastId:t};r?Q_(r)(n):iW(n)};ul.dismissAll=t=>ul.dismiss(void 0,t);ul.remove=(t,r)=>{let n={type:4,toastId:t};r?Q_(r)(n):iW(n)};ul.removeAll=t=>ul.remove(void 0,t);ul.promise=(t,r,n)=>{let i=ul.loading(r.loading,{...n,...n?.loading});return typeof t=="function"&&(t=t()),t.then(a=>{let s=r.success?rA(r.success,a):void 0;return s?ul.success(s,{id:i,...n,...n?.success}):ul.dismiss(i),a}).catch(a=>{let s=r.error?rA(r.error,a):void 0;s?ul.error(s,{id:i,...n,...n?.error}):ul.dismiss(i)}),t};var Y2e=mh`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Z2e=mh`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,X2e=mh`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,J2e=vf("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Y2e} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Z2e} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${X2e} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,eje=mh`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,tje=vf("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${eje} 1s linear infinite;
`,rje=mh`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,nje=mh`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ije=vf("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rje} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${nje} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,aje=vf("div")`
  position: absolute;
`,sje=vf("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,oje=mh`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lje=vf("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${oje} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,cje=({toast:t})=>{let{icon:r,type:n,iconTheme:i}=t;return r!==void 0?typeof r=="string"?k.createElement(lje,null,r):r:n==="blank"?null:k.createElement(sje,null,k.createElement(tje,{...i}),n!=="loading"&&k.createElement(aje,null,n==="error"?k.createElement(J2e,{...i}):k.createElement(ije,{...i})))},dje=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,uje=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,hje="0%{opacity:0;} 100%{opacity:1;}",fje="0%{opacity:1;} 100%{opacity:0;}",mje=vf("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,pje=vf("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,gje=(t,r)=>{let n=t.includes("top")?1:-1,[i,a]=H2e()?[hje,fje]:[dje(n),uje(n)];return{animation:r?`${mh(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${mh(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};k.memo(({toast:t,position:r,style:n,children:i})=>{let a=t.height?gje(t.position||r||"top-center",t.visible):{opacity:0},s=k.createElement(cje,{toast:t}),o=k.createElement(pje,{...t.ariaProps},rA(t.message,t));return k.createElement(mje,{className:t.className,style:{...a,...n,...t.style}},typeof i=="function"?i({icon:s,message:o}):k.createElement(k.Fragment,null,s,o))});q2e(k.createElement);tj`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;var Ki=ul;function yje(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`}function xje(t){return t.startsWith("image/")?Rv:t.includes("pdf")?Ir:rz}function mc({entityType:t,entityId:r,title:n="Attachments",readOnly:i=!1}){const a=pr(),s=k.useRef(null),[o,l]=k.useState(!1),[u,d]=k.useState(""),[f,p]=k.useState(null),{data:x,isLoading:v}=Ve({queryKey:["attachments",t,r],queryFn:async()=>{const{data:O}=await xe.get(`/attachments/${t}/${r}`);return O},enabled:!!r}),{data:w}=Ve({queryKey:["attachment-allowed"],queryFn:async()=>{const{data:O}=await xe.get("/attachments/allowed-extensions");return O}}),C=ot({mutationFn:async O=>{await xe.delete(`/attachments/${O}`)},onSuccess:()=>{a.invalidateQueries({queryKey:["attachments",t,r]}),Ki.success("Attachment deleted"),p(null)},onError:()=>{Ki.error("Failed to delete attachment"),p(null)}}),A=async O=>{const D=O.target.files?.[0];if(!D)return;const M=(w?.maxSizeMB||5)*1024*1024;if(D.size>M){Ki.error(`File too large. Maximum size is ${w?.maxSizeMB||5} MB`);return}if(w?.extensions&&w.extensions.length>0){const Q=D.name.split(".").pop()?.toLowerCase()||"";if(!w.extensions.includes(Q)){Ki.error(`File type .${Q} is not allowed`);return}}l(!0);try{const Q=new FormData;Q.append("file",D),u&&Q.append("description",u),await xe.post(`/attachments/${t}/${r}`,Q),a.invalidateQueries({queryKey:["attachments",t,r]}),Ki.success("File uploaded"),d("")}catch(Q){Ki.error(Q.response?.data?.error||"Upload failed")}finally{l(!1),s.current&&(s.current.value="")}},T=async O=>{try{const D=await xe.get(`/attachments/download/${O.id}`,{responseType:"blob"}),M=new Blob([D.data],{type:O.mimeType}),Q=window.URL.createObjectURL(M),U=document.createElement("a");U.href=Q,U.setAttribute("download",O.originalName),document.body.appendChild(U),U.click(),U.remove(),window.URL.revokeObjectURL(Q)}catch(D){console.error("Download error:",D),Ki.error("Failed to download file")}};return e.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:"12px",border:"1px solid var(--border)",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ah,{size:18}),e.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:600},children:n}),x&&x.length>0&&e.jsx("span",{style:{background:"var(--primary)",color:"white",padding:"0.125rem 0.5rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:x.length})]})}),e.jsxs("div",{style:{padding:"1rem"},children:[!i&&e.jsxs("div",{style:{marginBottom:"1rem",padding:"1rem",border:"2px dashed var(--border)",borderRadius:"8px",background:"var(--bg-secondary)"},children:[e.jsx("input",{ref:s,type:"file",onChange:A,disabled:o,style:{display:"none"},id:`file-upload-${t}-${r}`}),e.jsx("div",{style:{marginBottom:"0.75rem"},children:e.jsx("input",{type:"text",value:u,onChange:O=>d(O.target.value),placeholder:"Description (optional)",style:{width:"100%",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"0.875rem"}})}),e.jsxs("label",{htmlFor:`file-upload-${t}-${r}`,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.75rem 1rem",background:"var(--primary)",color:"white",borderRadius:"8px",cursor:o?"not-allowed":"pointer",opacity:o?.6:1},children:[e.jsx(om,{size:18}),o?"Uploading...":"Choose File to Upload"]}),w?.extensions&&w.extensions.length>0&&e.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center"},children:["Allowed: ",w.extensions.map(O=>`.${O}`).join(", ")," (max ",w.maxSizeMB,"MB)"]}),(!w?.extensions||w.extensions.length===0)&&e.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center"},children:"Max file size: 5MB"})]}),v?e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:"Loading attachments..."}):x?.length===0?e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem 1rem"},children:[e.jsx(ah,{size:32,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsx("p",{style:{margin:0},children:"No attachments yet"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:x?.map(O=>{const D=xje(O.mimeType);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border)"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",background:"var(--primary)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(D,{size:20})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.875rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.originalName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e.jsx("span",{children:yje(O.fileSize)}),e.jsxs("span",{children:[O.uploadedBy.firstName," ",O.uploadedBy.lastName]}),e.jsx("span",{children:Ze(new Date(O.createdAt),"MMM d, HH:mm")})]}),O.description&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:O.description})]}),e.jsxs("div",{style:{display:"flex",gap:"0.375rem"},children:[e.jsx("button",{onClick:()=>T(O),style:{padding:"0.375rem",background:"none",border:"1px solid var(--border)",borderRadius:"6px",cursor:"pointer"},title:"Download",children:e.jsx(Jp,{size:16})}),!i&&e.jsx("button",{onClick:()=>p(O),style:{padding:"0.375rem",background:"none",border:"1px solid #ef4444",borderRadius:"6px",cursor:"pointer",color:"#ef4444"},title:"Delete",children:e.jsx(Gi,{size:16})})]})]},O.id)})})]}),f&&e.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>p(null),children:e.jsxs("div",{className:"modal",style:{background:"var(--bg-primary)",borderRadius:"12px",padding:"1.5rem",maxWidth:"400px",width:"90%",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},onClick:O=>O.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"rgba(239, 68, 68, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Hr,{size:20,style:{color:"#ef4444"}})}),e.jsx("h3",{style:{margin:0,fontSize:"1.125rem",fontWeight:600},children:"Delete Attachment"})]}),e.jsxs("p",{style:{margin:"0 0 1.5rem",color:"var(--text-muted)",fontSize:"0.875rem"},children:["Are you sure you want to delete ",e.jsx("strong",{children:f.originalName}),"? This action cannot be undone."]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>p(null),disabled:C.isPending,children:"Cancel"}),e.jsx("button",{className:"btn",style:{background:"#ef4444",color:"white",border:"none"},onClick:()=>C.mutate(f.id),disabled:C.isPending,children:C.isPending?"Deleting...":"Delete"})]})]})})]})}function vje(){const t=Gr(),[r,n]=k.useState(!1),[i,a]=k.useState(null),[s,o]=k.useState(null),[l,u]=k.useState(""),[d,f]=k.useState(""),[p,x]=k.useState(""),v=pr(),w=gn(),{data:C,isLoading:A}=Ve({queryKey:["products"],queryFn:async()=>{const{data:$}=await xe.get("/products");return $}}),T=ot({mutationFn:async $=>i?xe.put(`/products/${i.id}`,$):xe.post("/products",$),onSuccess:()=>{v.invalidateQueries({queryKey:["products"]}),n(!1),a(null),w.success(i?"Product Updated":"Product Created",i?"Product details have been updated":"New product has been added")},onError:$=>{const ee=an($);w.error("Error",ee?.userMessage||"Failed to save product")}}),O=$=>{$.preventDefault();const ee=new FormData($.currentTarget);T.mutate({name:ee.get("name"),code:ee.get("code"),productType:ee.get("productType"),radionuclide:ee.get("radionuclide"),halfLifeMinutes:parseFloat(ee.get("halfLifeMinutes")),shelfLifeMinutes:parseFloat(ee.get("shelfLifeMinutes")),standardDose:parseFloat(ee.get("standardDose"))||null,doseUnit:ee.get("doseUnit"),productionMethod:ee.get("productionMethod"),synthesisTimeMinutes:parseInt(ee.get("synthesisTimeMinutes")),qcTimeMinutes:parseInt(ee.get("qcTimeMinutes")),packagingTimeMinutes:parseInt(ee.get("packagingTimeMinutes")),overagePercent:parseFloat(ee.get("overagePercent"))})},D=$=>{if($>=60){const ee=Math.floor($/60),F=$%60;return F>0?`${ee}h ${F}m`:`${ee}h`}return`${$}m`},M=C?.filter($=>{if(l&&$.productType!==l||d&&$.productionMethod!==d)return!1;if(p){const ee=p.toLowerCase();return $.name.toLowerCase().includes(ee)||$.code.toLowerCase().includes(ee)||$.radionuclide.toLowerCase().includes(ee)}return!0})||[],Q={total:C?.length||0,pet:C?.filter($=>$.productType==="PET").length||0,spect:C?.filter($=>$.productType==="SPECT").length||0,therapy:C?.filter($=>$.productType==="THERAPY").length||0},U=$=>{switch($){case"PET":return{bg:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"};case"SPECT":return{bg:"rgba(34, 197, 94, 0.1)",color:"var(--success)"};case"THERAPY":return{bg:"rgba(234, 179, 8, 0.1)",color:"var(--warning)"};default:return{bg:"rgba(100, 116, 139, 0.1)",color:"var(--text-muted)"}}};return A?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Product Catalog"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage radiopharmaceutical products with decay properties and production times"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>n(!0),children:[e.jsx(cn,{size:16})," Add Product"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Products",value:Q.total,icon:e.jsx(Rr,{size:20}),color:"primary",onClick:()=>u(""),active:!l}),e.jsx(nt,{title:"PET Products",value:Q.pet,icon:e.jsx(ou,{size:20}),color:"info",onClick:()=>u(l==="PET"?"":"PET"),active:l==="PET"}),e.jsx(nt,{title:"SPECT Products",value:Q.spect,icon:e.jsx(Mc,{size:20}),color:"success",onClick:()=>u(l==="SPECT"?"":"SPECT"),active:l==="SPECT"}),e.jsx(nt,{title:"Therapy Products",value:Q.therapy,icon:e.jsx(zp,{size:20}),color:"warning",onClick:()=>u(l==="THERAPY"?"":"THERAPY"),active:l==="THERAPY"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search by name, code, or isotope...",value:p,onChange:$=>x($.target.value),style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:l,onChange:$=>u($.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"PET",children:"PET"}),e.jsx("option",{value:"SPECT",children:"SPECT"}),e.jsx("option",{value:"THERAPY",children:"Therapy"})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"160px"},value:d,onChange:$=>f($.target.value),children:[e.jsx("option",{value:"",children:"All Methods"}),e.jsx("option",{value:"CYCLOTRON",children:"Cyclotron"}),e.jsx("option",{value:"GENERATOR",children:"Generator"}),e.jsx("option",{value:"KIT",children:"Kit"})]}),(l||d||p)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{u(""),f(""),x("")},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:s?"1fr 380px":"1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:M.map($=>{const ee=U($.productType),F=s?.id===$.id;return e.jsxs("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:F?"2px solid var(--primary)":"1px solid var(--border)",transition:"all 0.2s"},onClick:()=>o($),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:ee.bg,color:ee.color,fontWeight:600},children:$.productType}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:Y=>{Y.stopPropagation(),a($),n(!0)},children:e.jsx(ma,{size:14})})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"1rem"},children:$.name}),e.jsxs("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontFamily:"monospace"},children:$.code}),"  ",$.radionuclide]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.8125rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Qt,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["T: ",D($.halfLifeMinutes)]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(vp,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["Shelf: ",D($.shelfLifeMinutes)]})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("span",{className:"badge badge-default",style:{fontSize:"0.6875rem"},children:$.productionMethod}),e.jsxs("span",{style:{opacity:.7},children:[$.synthesisTimeMinutes+$.qcTimeMinutes+$.packagingTimeMinutes,"m total production"]})]})]},$.id)})}),M.length===0&&e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{title:"No products found",message:p||l||d?"Try adjusting your filters":"Add your first product to get started",icon:"package"})})]}),s&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:U(s.productType).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:U(s.productType).color,color:"white",marginBottom:"0.5rem"},children:s.productType}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:"0.5rem 0 0.25rem"},children:s.name}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:0},children:s.code})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>o(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Isotope Properties"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(ou,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Radionuclide"})]}),e.jsx("div",{style:{fontWeight:600},children:s.radionuclide})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Qt,{size:14,style:{color:"var(--warning)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Half-Life"})]}),e.jsx("div",{style:{fontWeight:600},children:D(s.halfLifeMinutes)})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(vp,{size:14,style:{color:"var(--success)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Shelf Life"})]}),e.jsx("div",{style:{fontWeight:600},children:D(s.shelfLifeMinutes)})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Wl,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Std. Dose"})]}),e.jsxs("div",{style:{fontWeight:600},children:[s.standardDose||"-"," ",s.doseUnit]})]})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Production Details"}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Bi,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Production Method"})]}),e.jsx("div",{style:{fontWeight:600},children:s.productionMethod})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"Synthesis Time"}),e.jsxs("span",{style:{fontWeight:600},children:[s.synthesisTimeMinutes," min"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"QC Testing Time"}),e.jsxs("span",{style:{fontWeight:600},children:[s.qcTimeMinutes," min"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"Packaging Time"}),e.jsxs("span",{style:{fontWeight:600},children:[s.packagingTimeMinutes," min"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem",background:"var(--primary)",color:"white",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"Total Production"}),e.jsxs("span",{style:{fontWeight:600},children:[s.synthesisTimeMinutes+s.qcTimeMinutes+s.packagingTimeMinutes," min"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Overage Factor"}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(234, 179, 8, 0.1)",borderRadius:"var(--radius)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"Decay compensation"}),e.jsxs("span",{style:{fontWeight:600,color:"var(--warning)"},children:["+",s.overagePercent,"%"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:["QC Tests (",s.qcTemplates?.length||0,")"]}),s.qcTemplates?.length>0?e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.375rem",marginBottom:"0.75rem"},children:s.qcTemplates.map($=>e.jsx("span",{className:"badge badge-default",style:{fontSize:"0.6875rem"},children:$.testName},$.id))}):e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:"No QC tests configured"}),e.jsxs("button",{className:"btn btn-secondary",style:{width:"100%",fontSize:"0.8125rem"},onClick:()=>t(`/products/${s.id}/qc-template`),children:[e.jsx(sh,{size:14})," Configure QC Tests"]})]}),e.jsx("div",{style:{marginTop:"1.25rem",marginBottom:"1rem"},children:e.jsx(mc,{entityType:"PRODUCT",entityId:s.id,title:"Product Documents"})}),e.jsxs("button",{className:"btn btn-primary",style:{width:"100%"},onClick:()=>{a(s),n(!0)},children:[e.jsx(ma,{size:16})," Edit Product"]})]})]})]}),r&&e.jsx("div",{className:"modal-overlay",onClick:()=>n(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"40rem"},onClick:$=>$.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:i?"Edit Product":"Add Product"}),e.jsx("button",{onClick:()=>{n(!1),a(null)},style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:O,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code"}),e.jsx("input",{name:"code",className:"form-input",defaultValue:i?.code,required:!0,disabled:!!i})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{name:"name",className:"form-input",defaultValue:i?.name,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Product Type"}),e.jsxs("select",{name:"productType",className:"form-select",defaultValue:i?.productType||"PET",required:!0,children:[e.jsx("option",{value:"PET",children:"PET"}),e.jsx("option",{value:"SPECT",children:"SPECT"}),e.jsx("option",{value:"THERAPY",children:"THERAPY"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Production Method"}),e.jsxs("select",{name:"productionMethod",className:"form-select",defaultValue:i?.productionMethod||"CYCLOTRON",required:!0,children:[e.jsx("option",{value:"CYCLOTRON",children:"Cyclotron"}),e.jsx("option",{value:"GENERATOR",children:"Generator"}),e.jsx("option",{value:"KIT",children:"Kit"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Radionuclide"}),e.jsx("input",{name:"radionuclide",className:"form-input",defaultValue:i?.radionuclide,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Half-Life (minutes)"}),e.jsx("input",{name:"halfLifeMinutes",type:"number",step:"0.1",className:"form-input",defaultValue:i?.halfLifeMinutes,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Shelf Life (minutes)"}),e.jsx("input",{name:"shelfLifeMinutes",type:"number",className:"form-input",defaultValue:i?.shelfLifeMinutes,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Standard Dose"}),e.jsx("input",{name:"standardDose",type:"number",step:"0.1",className:"form-input",defaultValue:i?.standardDose})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Dose Unit"}),e.jsxs("select",{name:"doseUnit",className:"form-select",defaultValue:i?.doseUnit||"mCi",children:[e.jsx("option",{value:"mCi",children:"mCi"}),e.jsx("option",{value:"GBq",children:"GBq"}),e.jsx("option",{value:"MBq",children:"MBq"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Overage %"}),e.jsx("input",{name:"overagePercent",type:"number",step:"0.1",className:"form-input",defaultValue:i?.overagePercent||10,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Synthesis Time (min)"}),e.jsx("input",{name:"synthesisTimeMinutes",type:"number",className:"form-input",defaultValue:i?.synthesisTimeMinutes||45,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"QC Time (min)"}),e.jsx("input",{name:"qcTimeMinutes",type:"number",className:"form-input",defaultValue:i?.qcTimeMinutes||30,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Packaging Time (min)"}),e.jsx("input",{name:"packagingTimeMinutes",type:"number",className:"form-input",defaultValue:i?.packagingTimeMinutes||15,required:!0})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{n(!1),a(null)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:T.isPending,children:T.isPending?"Saving...":"Save Product"})]})]})]})})]})}const wS={DRAFT:{label:"Draft",description:"Order created but not yet submitted for processing.",nextAction:"Submit order to begin processing"},SUBMITTED:{label:"Submitted",description:"Order submitted and awaiting validation by sales team.",nextAction:"Sales team validates order details"},VALIDATED:{label:"Validated",description:"Order validated and approved. Ready for production planning.",nextAction:"Production planner schedules batch"},SCHEDULED:{label:"Scheduled",description:"Order assigned to a production batch and scheduled for manufacturing.",nextAction:"Production team starts manufacturing"},IN_PRODUCTION:{label:"In Production",description:"Radiopharmaceutical is being manufactured.",nextAction:"Send to QC for quality testing"},QC_PENDING:{label:"QC Pending",description:"Quality control testing in progress.",nextAction:"QC analyst completes testing"},RELEASED:{label:"Released",description:"Batch passed QC and released by Qualified Person (QP). Ready for dispatch.",nextAction:"Logistics dispatches shipment"},DISPATCHED:{label:"Dispatched",description:"Order shipped and on the way to customer.",nextAction:"Confirm delivery to customer"},DELIVERED:{label:"Delivered",description:"Order successfully delivered to customer. Complete!",nextAction:"Order complete"},CANCELLED:{label:"Cancelled",description:"Order was cancelled and will not be fulfilled.",nextAction:"-"},REJECTED:{label:"Rejected",description:"Order was rejected during validation.",nextAction:"-"},FAILED_QC:{label:"Failed QC",description:"Batch did not pass quality control testing.",nextAction:"Rework or cancel order"},REWORK:{label:"Rework",description:"Order requires rework due to QC failure or other issues.",nextAction:"Create new batch"}};function bje(){const t=gn(),[r,n]=k.useState({}),[i,a]=k.useState(!1),s=pr(),{formatDateOnly:o,formatTimeOnly:l}=ph(),{data:u,isLoading:d}=Ve({queryKey:["orders",r.status,r.date],queryFn:async()=>{const A={};r.status&&(A.status=r.status),r.date&&(A.fromDate=r.date,A.toDate=r.date);const{data:T}=await xe.get("/orders",{params:A});return T}}),f=ot({mutationFn:async({id:A,status:T})=>xe.patch(`/orders/${A}/status`,{status:T}),onSuccess:(A,T)=>{s.invalidateQueries({queryKey:["orders"]});const O=wS[T.status];t.success("Status Updated",`Order moved to ${O?.label||T.status}`)},onError:A=>{const T=an(A);t.error("Update Failed",T?.userMessage||"Failed to update order status")}}),p=A=>({DRAFT:"default",SUBMITTED:"info",VALIDATED:"info",SCHEDULED:"info",IN_PRODUCTION:"warning",QC_PENDING:"warning",RELEASED:"success",DISPATCHED:"info",DELIVERED:"success",CANCELLED:"danger",REJECTED:"danger",FAILED_QC:"danger"})[A]||"default",x=A=>({DRAFT:"SUBMITTED",SUBMITTED:"VALIDATED",VALIDATED:"SCHEDULED"})[A]||null,v=[{key:"search",label:"Search",type:"search",placeholder:"Search orders..."},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},{value:"DRAFT",label:"Draft"},{value:"SUBMITTED",label:"Submitted"},{value:"VALIDATED",label:"Validated"},{value:"SCHEDULED",label:"Scheduled"},{value:"IN_PRODUCTION",label:"In Production"},{value:"QC_PENDING",label:"QC Pending"},{value:"RELEASED",label:"Released"},{value:"DISPATCHED",label:"Dispatched"},{value:"DELIVERED",label:"Delivered"}]}],w=u?.filter(A=>{if(r.search){const T=r.search.toLowerCase();if(!A.orderNumber.toLowerCase().includes(T)&&!A.customer?.name?.toLowerCase().includes(T)&&!A.product?.name?.toLowerCase().includes(T))return!1}return!0}),C={total:u?.length||0,pending:u?.filter(A=>["DRAFT","SUBMITTED","VALIDATED"].includes(A.status)).length||0,inProgress:u?.filter(A=>["SCHEDULED","IN_PRODUCTION","QC_PENDING"].includes(A.status)).length||0,ready:u?.filter(A=>["RELEASED","DISPATCHED"].includes(A.status)).length||0,delivered:u?.filter(A=>A.status==="DELIVERED").length||0};return d?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Orders"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage radiopharmaceutical orders from creation to delivery"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>a(!i),children:[e.jsx(am,{size:16}),"Status Guide",i?e.jsx(nh,{size:14}):e.jsx(qo,{size:14})]}),e.jsxs(nr,{to:"/orders/new",className:"btn btn-primary",children:[e.jsx(cn,{size:16}),"New Order"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Orders",value:C.total,icon:e.jsx(Fo,{size:20}),color:"primary",onClick:()=>n({}),selected:!r.status}),e.jsx(nt,{title:"Pending",value:C.pending,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>n(A=>({...A,status:"SUBMITTED"})),selected:r.status==="SUBMITTED"}),e.jsx(nt,{title:"In Progress",value:C.inProgress,icon:e.jsx(Rr,{size:20}),color:"info",onClick:()=>n(A=>({...A,status:"IN_PRODUCTION"})),selected:r.status==="IN_PRODUCTION"}),e.jsx(nt,{title:"Ready/Dispatched",value:C.ready,icon:e.jsx(dn,{size:20}),color:"success",onClick:()=>n(A=>({...A,status:"RELEASED"})),selected:r.status==="RELEASED"}),e.jsx(nt,{title:"Delivered",value:C.delivered,icon:e.jsx(Ft,{size:20}),color:"default",onClick:()=>n(A=>({...A,status:"DELIVERED"})),selected:r.status==="DELIVERED"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end",flexWrap:"wrap"},children:[e.jsx(cd,{widgets:v,values:r,onChange:(A,T)=>n(O=>({...O,[A]:T})),onReset:()=>n({})}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Delivery Date"}),e.jsx("input",{type:"date",className:"form-input",style:{width:"160px"},value:r.date||"",onChange:A=>n(T=>({...T,date:A.target.value}))})]})]})}),i&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.25rem"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(am,{size:18,style:{color:"var(--primary)"}}),"Order Workflow Guide"]}),e.jsx("div",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Orders flow through these stages from creation to delivery:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem",padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:["DRAFT","SUBMITTED","VALIDATED","SCHEDULED","IN_PRODUCTION","QC_PENDING","RELEASED","DISPATCHED","DELIVERED"].map((A,T,O)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Pn,{status:A,size:"sm"}),T<O.length-1&&e.jsx(lc,{size:14,style:{color:"var(--text-muted)"}})]},A))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"0.75rem"},children:Object.entries(wS).slice(0,9).map(([A,T])=>e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"var(--radius-sm)",borderLeft:`3px solid var(--${p(A)==="default"?"secondary":p(A)})`},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:e.jsx(Pn,{status:A,size:"sm"})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:T.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Next:"})," ",T.nextAction]})]},A))})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Order List (",w?.length||0,")"]})}),w?.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Delivery"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"150px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:w.map(A=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem"},children:A.orderNumber}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:A.customer?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:A.customer?.city})]}),e.jsxs("td",{children:[e.jsx("div",{children:A.product?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:A.product?.radionuclide})]}),e.jsxs("td",{children:[e.jsx("div",{children:o(A.deliveryDate)}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[l(A.deliveryTimeStart)," - ",l(A.deliveryTimeEnd)]})]}),e.jsxs("td",{children:[e.jsxs("div",{style:{fontWeight:500},children:[A.requestedActivity," ",A.activityUnit]}),A.calculatedProductionActivity&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Prod: ",A.calculatedProductionActivity.toFixed(1)," ",A.activityUnit]})]}),e.jsx("td",{children:e.jsx(Pn,{status:A.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx(nr,{to:`/orders/${A.id}/journey`,className:"btn btn-sm btn-outline",title:"View Journey",children:e.jsx(cz,{size:14})}),e.jsx(nr,{to:`/orders/${A.id}`,className:"btn btn-sm btn-outline",title:"Edit Order",children:e.jsx(os,{size:14})}),x(A.status)&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>f.mutate({id:A.id,status:x(A.status)}),disabled:f.isPending,title:`Move to ${wS[x(A.status)]?.label}`,children:e.jsx(lc,{size:14})})]})})]},A.id))})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No orders found",message:"Create your first order to get started",icon:"package"})})]})]})}function lP({entityType:t,entityId:r,compact:n=!1}){const{data:i,isLoading:a}=Ve({queryKey:["approvalHistory",t,r],queryFn:async()=>{const{data:d}=await xe.get(`/approvals/history/${t}/${r}`);return d},enabled:!!r});if(a)return e.jsx("span",{style:{color:"#9ca3af",fontSize:"0.875rem"},children:"Loading..."});if(!i||i.length===0)return n?null:e.jsx("div",{style:{color:"#9ca3af",fontSize:"0.875rem",fontStyle:"italic"},children:"No approval workflow active"});const s=i[0],o=d=>{switch(d){case"PENDING":return e.jsx(Qt,{size:16,color:"#f59e0b"});case"APPROVED":return e.jsx(Ft,{size:16,color:"#22c55e"});case"REJECTED":return e.jsx(ri,{size:16,color:"#ef4444"});default:return e.jsx(sn,{size:16,color:"#6b7280"})}},l=d=>{switch(d){case"PENDING":return"Pending Approval";case"APPROVED":return"Approved";case"REJECTED":return"Rejected";default:return d}};if(n)return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[o(s.status),e.jsx("span",{style:{fontSize:"0.875rem",color:"#374151"},children:l(s.status)})]});const u=s.workflow.steps.find(d=>d.stepOrder===s.currentStep);return e.jsxs("div",{style:{padding:"0.75rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[o(s.status),e.jsx("span",{style:{fontWeight:500},children:s.workflow.name}),e.jsx("span",{className:"badge",style:{marginLeft:"auto",background:s.status==="PENDING"?"#fef3c7":s.status==="APPROVED"?"#dcfce7":"#fee2e2",color:s.status==="PENDING"?"#92400e":s.status==="APPROVED"?"#166534":"#991b1b"},children:l(s.status)})]}),s.status==="PENDING"&&u&&e.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.5rem"},children:["Awaiting: ",e.jsx("strong",{children:u.stepName})]}),e.jsx("div",{style:{display:"flex",gap:"0.25rem",marginBottom:"0.5rem"},children:s.workflow.steps.map(d=>e.jsx("div",{style:{flex:1,height:"4px",borderRadius:"2px",background:d.stepOrder<s.currentStep?"#22c55e":d.stepOrder===s.currentStep?"#f59e0b":"#e5e7eb"},title:d.stepName},d.stepOrder))}),s.actions.length>0&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:["Last action: ",s.actions[s.actions.length-1].step.stepName," ","by ",s.actions[s.actions.length-1].actionBy.firstName," ","on ",Ze(new Date(s.actions[s.actions.length-1].createdAt),"MMM d, HH:mm")]})]})}function l1(t,r,n=""){try{if(!t)return n;const i=new Date(t);return isNaN(i.getTime())?n:Ze(i,r)}catch{return n}}function cP(){const{id:t}=fl(),r=Gr();gn();const[n,i]=k.useState({customerId:"",productId:"",deliveryDate:Ze(new Date,"yyyy-MM-dd"),deliveryTimeStart:"",deliveryTimeEnd:"",requestedActivity:"",activityUnit:"mCi",numberOfDoses:"",injectionTime:"",patientCount:"",specialNotes:""}),[a,s]=k.useState(""),[o,l]=k.useState(null),{data:u}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:O}=await xe.get("/customers");return O}}),{data:d}=Ve({queryKey:["products"],queryFn:async()=>{const{data:O}=await xe.get("/products");return O}}),{data:f,isLoading:p,error:x}=Ve({queryKey:["order",t],queryFn:async()=>{const{data:O}=await xe.get(`/orders/${t}`);return O},enabled:!!t});k.useEffect(()=>{if(f)try{i({customerId:f.customerId||"",productId:f.productId||"",deliveryDate:l1(f.deliveryDate,"yyyy-MM-dd",Ze(new Date,"yyyy-MM-dd")),deliveryTimeStart:l1(f.deliveryTimeStart,"yyyy-MM-dd'T'HH:mm"),deliveryTimeEnd:l1(f.deliveryTimeEnd,"yyyy-MM-dd'T'HH:mm"),requestedActivity:f.requestedActivity?.toString()||"",activityUnit:f.activityUnit||"mCi",numberOfDoses:f.numberOfDoses?.toString()||"",injectionTime:l1(f.injectionTime,"yyyy-MM-dd'T'HH:mm"),patientCount:f.patientCount?.toString()||"",specialNotes:f.specialNotes||""})}catch(O){console.error("Error loading order data:",O),s("Failed to load order data. Some fields may be missing.")}},[f]);const v=ot({mutationFn:async O=>t?xe.put(`/orders/${t}`,O):xe.post("/orders",O),onSuccess:()=>{r("/orders")},onError:O=>{s(O.response?.data?.error||"Failed to save order")}}),w=O=>{i({...n,[O.target.name]:O.target.value})},C=(O,D="DRAFT")=>{O.preventDefault(),s(""),d?.find(M=>M.id===n.productId),v.mutate({customerId:n.customerId,productId:n.productId,deliveryDate:n.deliveryDate,deliveryTimeStart:n.deliveryTimeStart,deliveryTimeEnd:n.deliveryTimeEnd,requestedActivity:parseFloat(n.requestedActivity),activityUnit:n.activityUnit,numberOfDoses:n.numberOfDoses?parseInt(n.numberOfDoses):null,injectionTime:n.injectionTime||null,patientCount:n.patientCount?parseInt(n.patientCount):null,specialNotes:n.specialNotes||null,status:D})},A=u?.find(O=>O.id===n.customerId),T=d?.find(O=>O.id===n.productId);if(t&&p)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(x){const O=an(x);return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>r("/orders"),className:"btn btn-secondary",style:{marginBottom:"1rem"},children:[e.jsx(sa,{size:18}),"Back to Orders"]}),e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h3",{style:{marginBottom:"0.5rem"},children:"Failed to Load Order"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:O?.userMessage||"Unable to load order details. Please try again."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:[e.jsx(cu,{size:18})," Try Again"]})]})]})}return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>r("/orders"),className:"btn btn-secondary",style:{marginBottom:"1rem"},children:[e.jsx(sa,{size:18}),"Back to Orders"]}),e.jsxs("div",{className:"card",style:{maxWidth:"50rem"},children:[e.jsx("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx("h2",{style:{fontWeight:600,margin:0},children:t?"Edit Order":"New Order"}),t&&f&&e.jsx("div",{style:{marginLeft:"1rem"},children:e.jsx(lP,{entityType:"ORDER",entityId:t,compact:!0})})]})}),t&&f&&e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx(lP,{entityType:"ORDER",entityId:t})}),a&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"1rem 1.5rem",background:"#fee2e2",color:"#991b1b"},children:[e.jsx(sn,{size:18}),a]}),e.jsxs("form",{onSubmit:O=>C(O),children:[e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"grid grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Customer *"}),e.jsxs("select",{name:"customerId",className:"form-select",value:n.customerId,onChange:w,required:!0,children:[e.jsx("option",{value:"",children:"Select Customer"}),u?.map(O=>e.jsxs("option",{value:O.id,children:[O.name," (",O.code,")"]},O.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Product *"}),e.jsxs("select",{name:"productId",className:"form-select",value:n.productId,onChange:w,required:!0,children:[e.jsx("option",{value:"",children:"Select Product"}),d?.map(O=>e.jsxs("option",{value:O.id,children:[O.name," (",O.radionuclide,")"]},O.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Date *"}),e.jsx("input",{type:"date",name:"deliveryDate",className:"form-input",value:n.deliveryDate,onChange:w,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Window Start *"}),e.jsx("input",{type:"datetime-local",name:"deliveryTimeStart",className:"form-input",value:n.deliveryTimeStart,onChange:w,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Window End *"}),e.jsx("input",{type:"datetime-local",name:"deliveryTimeEnd",className:"form-input",value:n.deliveryTimeEnd,onChange:w,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Injection Time (if different)"}),e.jsx("input",{type:"datetime-local",name:"injectionTime",className:"form-input",value:n.injectionTime,onChange:w})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Requested Activity *"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{type:"number",name:"requestedActivity",className:"form-input",value:n.requestedActivity,onChange:w,step:"0.1",required:!0}),e.jsxs("select",{name:"activityUnit",className:"form-select",style:{width:"6rem"},value:n.activityUnit,onChange:w,children:[e.jsx("option",{value:"mCi",children:"mCi"}),e.jsx("option",{value:"GBq",children:"GBq"}),e.jsx("option",{value:"MBq",children:"MBq"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Number of Doses"}),e.jsx("input",{type:"number",name:"numberOfDoses",className:"form-input",value:n.numberOfDoses,onChange:w})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Patient Count"}),e.jsx("input",{type:"number",name:"patientCount",className:"form-input",value:n.patientCount,onChange:w})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Special Notes"}),e.jsx("textarea",{name:"specialNotes",className:"form-input",rows:3,value:n.specialNotes,onChange:w})]})]}),T&&A&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("h4",{style:{fontWeight:600,marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(qQ,{size:18}),"Product & Delivery Info"]}),e.jsxs("div",{className:"grid grid-3",style:{fontSize:"0.875rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Half-life: "}),T.halfLifeMinutes," min"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Shelf Life: "}),T.shelfLifeMinutes," min"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Travel Time: "}),A.travelTimeMinutes," min"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Synthesis: "}),T.synthesisTimeMinutes," min"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"QC Time: "}),T.qcTimeMinutes," min"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Overage: "}),T.overagePercent,"%"]})]})]})]}),e.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--border)",display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>r("/orders"),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-secondary",disabled:v.isPending,children:"Save as Draft"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:O=>C(O,"SUBMITTED"),disabled:v.isPending,children:"Submit Order"})]})]})]})]})}function jje({window:t}){const r=n=>n==="FULL"?"var(--danger)":n==="NEAR_FULL"?"var(--warning)":"var(--success)";return e.jsxs("div",{style:{marginBottom:"0.75rem",padding:"0.75rem",background:"var(--bg-primary)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.8rem",fontWeight:500},children:t.name}),e.jsxs("span",{style:{fontSize:"0.75rem",color:r(t.status),fontWeight:600},children:[t.utilizationPercent,"% used"]})]}),e.jsx("div",{style:{height:"8px",background:"var(--bg-tertiary)",borderRadius:"4px",overflow:"hidden"},children:e.jsxs("div",{style:{display:"flex",height:"100%",transition:"width 0.3s ease"},children:[e.jsx("div",{style:{width:`${Math.min(100,t.usedMinutes/t.capacityMinutes*100)}%`,background:"#3b82f6"},title:`Used: ${t.usedMinutes} min`}),e.jsx("div",{style:{width:`${Math.min(100-t.usedMinutes/t.capacityMinutes*100,t.committedMinutes/t.capacityMinutes*100)}%`,background:"#22c55e"},title:`Committed: ${t.committedMinutes} min`}),e.jsx("div",{style:{width:`${Math.min(100-(t.usedMinutes+t.committedMinutes)/t.capacityMinutes*100,t.reservedMinutes/t.capacityMinutes*100)}%`,background:"#f59e0b"},title:`Reserved: ${t.reservedMinutes} min`})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.35rem",fontSize:"0.7rem",color:"var(--text-secondary)"},children:[e.jsxs("span",{children:[Ze(new Date(t.startTime),"HH:mm")," - ",Ze(new Date(t.endTime),"HH:mm")]}),e.jsxs("span",{children:[t.availableMinutes," min available"]})]})]})}function wje(){const[t,r]=k.useState(Ze(new Date,"yyyy-MM-dd")),n=pr(),i=Gr(),{data:a}=Ve({queryKey:["planner-capacity",t],queryFn:async()=>{const{data:w}=await xe.get("/planner/capacity",{params:{date:t,days:1}});return w}}),{data:s,isLoading:o}=Ve({queryKey:["planner-orders",t],queryFn:async()=>{const{data:w}=await xe.get("/planner/orders",{params:{date:t}});return w}}),{data:l,isLoading:u}=Ve({queryKey:["planner-batches",t],queryFn:async()=>{const{data:w}=await xe.get("/planner/batches",{params:{fromDate:t,toDate:t}});return w}}),{data:d}=Ve({queryKey:["suggested-batches",t],queryFn:async()=>{const{data:w}=await xe.post("/planner/group-orders",{date:t});return w},enabled:!!s?.length}),{data:f}=Ve({queryKey:["equipment"],queryFn:async()=>{const{data:w}=await xe.get("/planner/equipment");return w}}),p=ot({mutationFn:async w=>xe.post("/batches",w),onSuccess:()=>{n.invalidateQueries({queryKey:["planner-orders"]}),n.invalidateQueries({queryKey:["planner-batches"]}),n.invalidateQueries({queryKey:["suggested-batches"]})}}),x=w=>{const C=f?.find(T=>T.type==="Synthesis"),A=f?.find(T=>T.type==="HotCell");p.mutate({productId:w.productId,plannedStartTime:w.suggestedStartTime,plannedEndTime:w.suggestedEndTime,targetActivity:w.totalActivity,calibrationTime:w.suggestedStartTime,synthesisModuleId:C?.id,hotCellId:A?.id,orderIds:w.orders.map(T=>T.id)})},v=o||u;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"Production Planner"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r(Ze(hl(new Date(t),-1),"yyyy-MM-dd")),children:"Previous"}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto"},value:t,onChange:w=>r(w.target.value)}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r(Ze(hl(new Date(t),1),"yyyy-MM-dd")),children:"Next"})]})]}),a?.summary&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Mc,{size:20}),"Dispensing Capacity Overview"]})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"var(--primary)"},children:a.summary.totalCapacityMinutes}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Total Capacity (min)"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"#22c55e"},children:a.summary.totalCommittedMinutes}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Committed (min)"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"#f59e0b"},children:a.summary.totalReservedMinutes}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Reserved (min)"})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"var(--success)"},children:a.summary.totalAvailableMinutes}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Available (min)"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"center",fontSize:"0.75rem"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{style:{width:"12px",height:"12px",background:"#3b82f6",borderRadius:"2px"}})," Used"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{style:{width:"12px",height:"12px",background:"#22c55e",borderRadius:"2px"}})," Committed"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{style:{width:"12px",height:"12px",background:"#f59e0b",borderRadius:"2px"}})," Reserved (Tentative)"]})]}),a?.windows?.length>0&&e.jsx("div",{style:{marginTop:"1rem"},children:a.windows.map(w=>e.jsx(jje,{window:w},w.id))})]})]}),v?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{className:"grid grid-2",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx($n,{size:20}),"Orders to Schedule (",s?.length||0,")"]})}),e.jsx("div",{style:{padding:"1rem"},children:s?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:s.map(w=>e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:600},children:w.orderNumber}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("span",{className:"badge badge-info",children:w.product?.productType}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(`/orders/${w.id}/journey`),title:"View Order Details",children:e.jsx(os,{size:14})})]})]}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[e.jsx("div",{children:w.customer?.name}),e.jsx("div",{children:w.product?.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.25rem"},children:[e.jsx(Qt,{size:14}),"Delivery: ",Ze(new Date(w.deliveryTimeStart),"HH:mm")]}),e.jsxs("div",{children:["Activity: ",w.requestedActivity," ",w.activityUnit]})]})]},w.id))}):e.jsx("div",{className:"empty-state",children:"No orders pending scheduling for this date"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Rr,{size:20}),"Suggested Batches"]})}),e.jsx("div",{style:{padding:"1rem"},children:d?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:d.map((w,C)=>e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:600},children:w.product?.name}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>x(w),disabled:p.isPending,children:[e.jsx(yo,{size:14}),"Create Batch"]})]}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[e.jsxs("div",{children:["Total Activity: ",w.totalActivity.toFixed(1)," mCi"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.25rem"},children:[e.jsx(Qt,{size:14}),"Start: ",Ze(new Date(w.suggestedStartTime),"HH:mm")]})]}),w.orders?.length>0&&e.jsxs("div",{style:{marginTop:"0.75rem",borderTop:"1px solid var(--border)",paddingTop:"0.75rem"},children:[e.jsxs("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-secondary)",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(dc,{size:12}),"Orders in this batch (",w.orders.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:w.orders.map(A=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem",background:"var(--bg-primary)",borderRadius:"var(--radius-sm)",border:"1px solid var(--border)",fontSize:"0.8rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:500},children:A.orderNumber}),e.jsx("span",{style:{color:"var(--text-secondary)",marginLeft:"0.5rem"},children:A.customer?.name||A.customer?.nameEn}),e.jsxs("span",{style:{color:"var(--text-secondary)",marginLeft:"0.5rem"},children:["(",A.requestedActivity," mCi)"]})]}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(`/orders/${A.id}/journey`),title:"View Order History",style:{padding:"0.25rem 0.5rem",fontSize:"0.7rem"},children:e.jsx(os,{size:12})})]},A.id))})]})]},C))}):e.jsx("div",{className:"empty-state",children:"No batch suggestions available"})})]})]}),e.jsxs("div",{className:"card",style:{marginTop:"1.5rem"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600},children:["Scheduled Batches (",l?.length||0,")"]})}),e.jsx("div",{style:{padding:"0"},children:l?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Batch #"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Scheduled Time"}),e.jsx("th",{children:"Target Activity"}),e.jsx("th",{children:"Orders"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsx("tbody",{children:l.map(w=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:w.batchNumber}),e.jsx("td",{children:w.product?.name}),e.jsxs("td",{children:[Ze(new Date(w.plannedStartTime),"HH:mm")," - ",Ze(new Date(w.plannedEndTime),"HH:mm")]}),e.jsxs("td",{children:[w.targetActivity," ",w.activityUnit]}),e.jsx("td",{children:w.orders?.length||0}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${Sje(w.status)}`,children:w.status.replace("_"," ")})}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(`/batches/${w.id}/journey`),title:"View Batch Journey",children:[e.jsx(os,{size:14}),"View"]})})]},w.id))})]}):e.jsx("div",{className:"empty-state",children:"No batches scheduled for this date"})})]})]})}function Sje(t){return{PLANNED:"default",IN_PROGRESS:"warning",COMPLETED:"success",QC_PENDING:"warning",QC_IN_PROGRESS:"warning",QC_PASSED:"success",QC_FAILED:"danger",RELEASED:"success",CANCELLED:"danger"}[t]||"default"}const c1={PLANNED:"#94a3b8",IN_PRODUCTION:"#3b82f6",PRODUCTION_COMPLETE:"#22c55e",QC_PENDING:"#f59e0b",QC_PASSED:"#10b981",FAILED_QC:"#ef4444",RELEASED:"#8b5cf6",DISPENSED:"#06b6d4",CANCELLED:"#6b7280"};function Cje({batches:t,equipment:r,date:n,onBatchClick:i}){Yf(new Date(n));const a=Array.from({length:24},(u,d)=>d),s=k.useMemo(()=>{const u={};return t.forEach(d=>{const f=d.product?.name||"Unknown";u[f]||(u[f]=[]),u[f].push(d)}),Object.entries(u).sort((d,f)=>d[0].localeCompare(f[0]))},[t]),o=u=>{const d=new Date(u.plannedStartTime),f=new Date(u.plannedEndTime),p=Yf(new Date(n)),x=Ux(d,p),v=Ux(f,d),w=x/1440*100,C=v/1440*100;return{left:`${Math.max(0,w)}%`,width:`${Math.min(100-w,C)}%`}},l=u=>{if(!u.actualStartTime)return null;const d=new Date(u.actualStartTime),f=u.actualEndTime?new Date(u.actualEndTime):new Date,p=Yf(new Date(n)),x=Ux(d,p),v=Ux(f,d),w=x/1440*100,C=v/1440*100;return{left:`${Math.max(0,w)}%`,width:`${Math.min(100-w,C)}%`}};return e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,margin:0},children:["Production Schedule - ",Ze(new Date(n),"EEEE, MMMM d, yyyy")]})}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("div",{style:{minWidth:"1200px"},children:[e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{width:"180px",flexShrink:0,padding:"0.75rem 1rem",fontWeight:600,fontSize:"0.875rem"},children:"Product"}),e.jsx("div",{style:{flex:1,display:"flex"},children:a.map(u=>e.jsxs("div",{style:{flex:1,textAlign:"center",fontSize:"0.75rem",padding:"0.75rem 0",borderLeft:"1px solid var(--border)",color:"var(--text-secondary)",fontWeight:500},children:[u.toString().padStart(2,"0"),":00"]},u))})]}),s.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-secondary)"},children:"No batches scheduled for this date"}):s.map(([u,d])=>e.jsx("div",{style:{borderBottom:"1px solid var(--border)"},children:d.map((f,p)=>e.jsxs("div",{style:{display:"flex",minHeight:"48px",background:p%2===0?"var(--bg-primary)":"var(--bg-secondary)"},children:[e.jsxs("div",{style:{width:"180px",flexShrink:0,padding:"0.5rem 1rem",display:"flex",flexDirection:"column",justifyContent:"center",fontSize:"0.8rem"},children:[e.jsx("div",{style:{fontWeight:500},children:p===0?u:""}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"0.75rem"},children:f.batchNumber})]}),e.jsxs("div",{style:{flex:1,position:"relative",display:"flex"},children:[a.map(x=>e.jsx("div",{style:{flex:1,borderLeft:"1px solid var(--border)",background:x>=6&&x<18?"transparent":"rgba(0,0,0,0.02)"}},x)),f.actualStartTime&&e.jsx("div",{style:{position:"absolute",top:"4px",height:"calc(50% - 6px)",...l(f),background:c1[f.status]||"#3b82f6",borderRadius:"4px",opacity:.6,zIndex:1},title:`Actual: ${Ze(new Date(f.actualStartTime),"HH:mm")} - ${f.actualEndTime?Ze(new Date(f.actualEndTime),"HH:mm"):"ongoing"}`}),e.jsxs("div",{onClick:()=>i?.(f),style:{position:"absolute",top:f.actualStartTime?"calc(50% + 2px)":"8px",height:f.actualStartTime?"calc(50% - 6px)":"calc(100% - 16px)",...o(f),background:`linear-gradient(135deg, ${c1[f.status]||"#3b82f6"}, ${c1[f.status]||"#3b82f6"}dd)`,borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",color:"white",fontSize:"0.7rem",fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",boxShadow:"0 1px 3px rgba(0,0,0,0.2)",zIndex:2,transition:"transform 0.1s, box-shadow 0.1s"},onMouseEnter:x=>{x.currentTarget.style.transform="scale(1.02)",x.currentTarget.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)"},onMouseLeave:x=>{x.currentTarget.style.transform="scale(1)",x.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.2)"},title:`${f.batchNumber}: ${Ze(new Date(f.plannedStartTime),"HH:mm")} - ${Ze(new Date(f.plannedEndTime),"HH:mm")}
${f.status}
${f.targetActivity} ${f.activityUnit}`,children:[f.batchNumber,"  ",f.targetActivity,f.activityUnit]})]})]},f.id))},u))]})}),e.jsx("div",{style:{padding:"1rem",borderTop:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem",fontSize:"0.75rem"},children:Object.entries(c1).map(([u,d])=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"2px",background:d}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:u.replace(/_/g," ")})]},u))})})]})}const dP=t=>t===0?"var(--bg-secondary)":t<25?"#dcfce7":t<50?"#86efac":t<75?"#fcd34d":t<90?"#fb923c":"#ef4444",uP=t=>t===0?"var(--text-tertiary)":t<50?"#166534":t<75?"#92400e":"#ffffff";function Nje({equipment:t,utilizationData:r,weekStart:n,onCellClick:i,view:a="weekly",selectedDate:s}){const o=k.useMemo(()=>{if(a==="daily"&&s)return[new Date(s)];const p=cf(n,{weekStartsOn:1});return fte({start:p,end:hl(p,6)})},[n,a,s]),l=a==="daily"?Array.from({length:24},(p,x)=>x):[6,9,12,15,18],u=(p,x,v)=>r.find(C=>C.equipmentId===p&&C.date===x&&C.hour===v)?.utilizationPercent||0,d=(p,x,v)=>r.find(C=>C.equipmentId===p&&C.date===x&&C.hour===v)?.batchCount||0,f=(p,x)=>{const v=r.filter(C=>C.equipmentId===p&&C.date===x);if(v.length===0)return 0;const w=v.reduce((C,A)=>C+A.utilizationPercent,0);return Math.round(w/v.length)};return e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,margin:0},children:["Equipment Utilization Heat Map",a==="weekly"&&` - Week of ${Ze(n,"MMM d, yyyy")}`,a==="daily"&&s&&` - ${Ze(new Date(s),"EEEE, MMMM d")}`]})}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("div",{style:{minWidth:a==="daily"?"800px":"1000px"},children:[e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{width:"140px",flexShrink:0,padding:"0.75rem 1rem",fontWeight:600,fontSize:"0.85rem"},children:"Equipment"}),o.map(p=>e.jsx("div",{style:{flex:1,minWidth:a==="daily"?"auto":"100px"},children:a==="weekly"?e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",borderLeft:"1px solid var(--border)",fontWeight:500,fontSize:"0.8rem"},children:[e.jsx("div",{children:Ze(p,"EEE")}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"0.75rem"},children:Ze(p,"MMM d")})]}):e.jsx("div",{style:{display:"flex"},children:l.map(x=>e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"0.5rem 0.25rem",borderLeft:"1px solid var(--border)",fontSize:"0.7rem",color:"var(--text-secondary)"},children:[x.toString().padStart(2,"0"),":00"]},x))})},p.toISOString()))]}),t.length===0?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"No equipment data available"}):t.map((p,x)=>e.jsxs("div",{style:{display:"flex",borderBottom:"1px solid var(--border)",background:x%2===0?"var(--bg-primary)":"rgba(0,0,0,0.01)"},children:[e.jsxs("div",{style:{width:"140px",flexShrink:0,padding:"0.75rem 1rem",display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:p.name}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)"},children:p.type})]}),o.map(v=>{const w=Ze(v,"yyyy-MM-dd");if(a==="weekly"){const C=f(p.id,w);return e.jsx("div",{onClick:()=>i?.(p,w,12),style:{flex:1,minWidth:"100px",minHeight:"48px",borderLeft:"1px solid var(--border)",background:dP(C),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"opacity 0.15s"},onMouseEnter:A=>A.currentTarget.style.opacity="0.8",onMouseLeave:A=>A.currentTarget.style.opacity="1",title:`${p.name} - ${Ze(v,"EEE MMM d")}: ${C}% utilization`,children:e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:600,color:uP(C)},children:[C,"%"]})},w)}return e.jsx("div",{style:{flex:1,display:"flex"},children:l.map(C=>{const A=u(p.id,w,C),T=d(p.id,w,C);return e.jsx("div",{onClick:()=>i?.(p,w,C),style:{flex:1,minHeight:"40px",borderLeft:"1px solid var(--border)",background:dP(A),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"opacity 0.15s"},onMouseEnter:O=>O.currentTarget.style.opacity="0.8",onMouseLeave:O=>O.currentTarget.style.opacity="1",title:`${p.name} at ${C}:00 - ${A}% (${T} batches)`,children:A>0&&e.jsxs("span",{style:{fontSize:"0.65rem",fontWeight:500,color:uP(A)},children:[A,"%"]})},C)})},w)})]},p.id))]})}),e.jsx("div",{style:{padding:"1rem",borderTop:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem"},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:"Utilization:"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"20px",height:"12px",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:"0%"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"20px",height:"12px",background:"#dcfce7",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:"1-24%"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"20px",height:"12px",background:"#86efac",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:"25-49%"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"20px",height:"12px",background:"#fcd34d",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:"50-74%"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"20px",height:"12px",background:"#fb923c",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:"75-89%"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("div",{style:{width:"20px",height:"12px",background:"#ef4444",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:"90-100%"})]})]})})]})}function Aje(){const[t,r]=k.useState(Ze(new Date,"yyyy-MM-dd")),[n,i]=k.useState("gantt"),[a,s]=k.useState(!1),o=Gr(),l=k.useMemo(()=>cf(new Date(t),{weekStartsOn:1}),[t]),{data:u,isLoading:d}=Ve({queryKey:["production-schedule-batches",t,a],queryFn:async()=>{const C=a?Ze(l,"yyyy-MM-dd"):t,A=a?Ze(hl(l,6),"yyyy-MM-dd"):t,{data:T}=await xe.get("/planner/batches",{params:{fromDate:C,toDate:A}});return T}}),{data:f}=Ve({queryKey:["production-equipment"],queryFn:async()=>{const{data:C}=await xe.get("/planner/equipment");return C}}),p=k.useMemo(()=>{if(!u||!f)return[];const C=[];return f.forEach(A=>{const T=a?7:1;for(let O=0;O<T;O++){const D=a?Ze(hl(l,O),"yyyy-MM-dd"):t;for(let M=0;M<24;M++){const Q=new Date(`${D}T${M.toString().padStart(2,"0")}:00:00`),U=new Date(`${D}T${M.toString().padStart(2,"0")}:59:59`),$=u.filter(ee=>{const F=new Date(ee.plannedStartTime),Y=new Date(ee.plannedEndTime);return(ee.synthesisModuleId===A.id||ee.hotCellId===A.id)&&F<=U&&Y>=Q});C.push({hour:M,date:D,utilizationPercent:Math.min(100,$.length*50),batchCount:$.length,equipmentId:A.id})}}}),C},[u,f,t,l,a]),x=()=>{r(Ze(a?Ore(new Date(t)):HA(new Date(t),1),"yyyy-MM-dd"))},v=()=>{r(Ze(a?Tz(new Date(t),1):hl(new Date(t),1),"yyyy-MM-dd"))},w=C=>{o(`/batches/${C.id}/journey`)};return e.jsxs("div",{className:"page-container",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h1",{children:"Production Schedule"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Visual overview of batch production and equipment utilization"})]})}),e.jsx("div",{className:"card",style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{padding:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,style:{padding:"0.5rem"},children:e.jsx(Xp,{size:18})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",minWidth:"200px",justifyContent:"center"},children:[e.jsx($n,{size:18}),e.jsx("input",{type:"date",value:t,onChange:C=>r(C.target.value),style:{border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"0.5rem 0.75rem",fontSize:"0.9rem"}})]}),e.jsx("button",{className:"btn btn-secondary",onClick:v,style:{padding:"0.5rem"},children:e.jsx(bo,{size:18})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a,onChange:C=>s(C.target.checked),style:{width:"16px",height:"16px"}}),"Week View"]}),e.jsxs("div",{style:{display:"flex",background:"var(--bg-secondary)",borderRadius:"var(--radius)",padding:"2px"},children:[e.jsxs("button",{className:`btn btn-sm ${n==="gantt"?"btn-primary":"btn-secondary"}`,onClick:()=>i("gantt"),style:{display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.4rem 0.75rem"},children:[e.jsx(e2,{size:16}),"Gantt"]}),e.jsxs("button",{className:`btn btn-sm ${n==="heatmap"?"btn-primary":"btn-secondary"}`,onClick:()=>i("heatmap"),style:{display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.4rem 0.75rem"},children:[e.jsx(mv,{size:16}),"Heat Map"]}),e.jsxs("button",{className:`btn btn-sm ${n==="list"?"btn-primary":"btn-secondary"}`,onClick:()=>i("list"),style:{display:"flex",alignItems:"center",gap:"0.35rem",padding:"0.4rem 0.75rem"},children:[e.jsx(jZ,{size:16}),"List"]})]})]})]})}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--primary)"},children:u?.length||0}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Scheduled Batches"})]}),e.jsxs("div",{className:"card",style:{padding:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--success)"},children:u?.filter(C=>C.status==="IN_PRODUCTION").length||0}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"In Production"})]}),e.jsxs("div",{className:"card",style:{padding:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--warning)"},children:u?.filter(C=>C.status==="QC_PENDING").length||0}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Awaiting QC"})]}),e.jsxs("div",{className:"card",style:{padding:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--info)"},children:u?.filter(C=>C.status==="RELEASED").length||0}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Released"})]})]})}),d?e.jsx("div",{className:"card",style:{padding:"3rem",textAlign:"center",color:"var(--text-secondary)"},children:"Loading schedule..."}):n==="gantt"?e.jsx(Cje,{batches:u||[],equipment:f||[],date:t,onBatchClick:w}):n==="heatmap"?e.jsx(Nje,{equipment:f||[],utilizationData:p,weekStart:l,view:a?"weekly":"daily",selectedDate:t,onCellClick:(C,A,T)=>{console.log("Cell clicked:",C.name,A,T)}}):e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Batch List"})}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Batch #"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Planned Time"}),e.jsx("th",{children:"Target Activity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Orders"})]})}),e.jsx("tbody",{children:u?.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:["No batches scheduled for this ",a?"week":"date"]})}):u?.map(C=>e.jsxs("tr",{onClick:()=>w(C),style:{cursor:"pointer"},children:[e.jsx("td",{style:{fontWeight:500},children:C.batchNumber}),e.jsx("td",{children:C.product?.name}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[e.jsx(Qt,{size:14}),Ze(new Date(C.plannedStartTime),"MMM d HH:mm")," - ",Ze(new Date(C.plannedEndTime),"HH:mm")]})}),e.jsxs("td",{children:[C.targetActivity," ",C.activityUnit]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${C.status==="RELEASED"?"success":C.status==="IN_PRODUCTION"?"primary":"default"}`,children:C.status.replace(/_/g," ")})}),e.jsx("td",{children:C.orders?.length||0})]},C.id))})]})})]})]})}const Eje="modulepreload",_je=function(t){return"/"+t},hP={},jv=function(r,n,i){let a=Promise.resolve();if(n&&n.length>0){let u=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=u(n.map(d=>{if(d=_je(d),d in hP)return;hP[d]=!0;const f=d.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const x=document.createElement("link");if(x.rel=f?"stylesheet":Eje,f||(x.as="script"),x.crossOrigin="",x.href=d,l&&x.setAttribute("nonce",l),document.head.appendChild(x),f)return new Promise((v,w)=>{x.addEventListener("load",v),x.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return r().catch(s)})};var d1={},dg={},u1={},fP;function Fc(){if(fP)return u1;fP=1,Object.defineProperty(u1,"__esModule",{value:!0});function t(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}var r=function n(i,a){t(this,n),this.data=i,this.text=a.text||i,this.options=a};return u1.default=r,u1}var mP;function Tje(){if(mP)return dg;mP=1,Object.defineProperty(dg,"__esModule",{value:!0}),dg.CODE39=void 0;var t=(function(){function C(A,T){for(var O=0;O<T.length;O++){var D=T[O];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(A,D.key,D)}}return function(A,T,O){return T&&C(A.prototype,T),O&&C(A,O),A}})(),r=Fc(),n=i(r);function i(C){return C&&C.__esModule?C:{default:C}}function a(C,A){if(!(C instanceof A))throw new TypeError("Cannot call a class as a function")}function s(C,A){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:C}function o(C,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);C.prototype=Object.create(A&&A.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(C,A):C.__proto__=A)}var l=(function(C){o(A,C);function A(T,O){return a(this,A),T=T.toUpperCase(),O.mod43&&(T+=x(w(T))),s(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,T,O))}return t(A,[{key:"encode",value:function(){for(var O=f("*"),D=0;D<this.data.length;D++)O+=f(this.data[D])+"0";return O+=f("*"),{data:O,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),A})(n.default),u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],d=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function f(C){return p(v(C))}function p(C){return d[C].toString(2)}function x(C){return u[C]}function v(C){return u.indexOf(C)}function w(C){for(var A=0,T=0;T<C.length;T++)A+=v(C[T]);return A=A%43,A}return dg.CODE39=l,dg}var bd={},h1={},f1={},Ss={},pP;function Wy(){if(pP)return Ss;pP=1,Object.defineProperty(Ss,"__esModule",{value:!0});var t;function r(u,d,f){return d in u?Object.defineProperty(u,d,{value:f,enumerable:!0,configurable:!0,writable:!0}):u[d]=f,u}var n=Ss.SET_A=0,i=Ss.SET_B=1,a=Ss.SET_C=2;Ss.SHIFT=98;var s=Ss.START_A=103,o=Ss.START_B=104,l=Ss.START_C=105;return Ss.MODULO=103,Ss.STOP=106,Ss.FNC1=207,Ss.SET_BY_CODE=(t={},r(t,s,n),r(t,o,i),r(t,l,a),t),Ss.SWAP={101:n,100:i,99:a},Ss.A_START_CHAR="",Ss.B_START_CHAR="",Ss.C_START_CHAR="",Ss.A_CHARS="[\0-_-]",Ss.B_CHARS="[ --]",Ss.C_CHARS="(*[0-9]{2}*)",Ss.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],Ss}var gP;function rj(){if(gP)return f1;gP=1,Object.defineProperty(f1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=Fc(),n=a(r),i=Wy();function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(p,x){s(this,f);var v=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,p.substring(1),x));return v.bytes=p.split("").map(function(w){return w.charCodeAt(0)}),v}return t(f,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var x=this.bytes,v=x.shift()-105,w=i.SET_BY_CODE[v];if(w===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&x.unshift(i.FNC1);var C=f.next(x,1,w);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:f.getBar(v)+C.result+f.getBar((C.checksum+v)%i.MODULO)+f.getBar(i.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var x=this.options.ean128||!1;return typeof x=="string"&&(x=x.toLowerCase()==="true"),x}}],[{key:"getBar",value:function(x){return i.BARS[x]?i.BARS[x].toString():""}},{key:"correctIndex",value:function(x,v){if(v===i.SET_A){var w=x.shift();return w<32?w+64:w-32}else return v===i.SET_B?x.shift()-32:(x.shift()-48)*10+x.shift()-48}},{key:"next",value:function(x,v,w){if(!x.length)return{result:"",checksum:0};var C=void 0,A=void 0;if(x[0]>=200){A=x.shift()-105;var T=i.SWAP[A];T!==void 0?C=f.next(x,v+1,T):((w===i.SET_A||w===i.SET_B)&&A===i.SHIFT&&(x[0]=w===i.SET_A?x[0]>95?x[0]-96:x[0]:x[0]<32?x[0]+96:x[0]),C=f.next(x,v+1,w))}else A=f.correctIndex(x,w),C=f.next(x,v+1,w);var O=f.getBar(A),D=A*v;return{result:O+C.result,checksum:D+C.checksum}}}]),f})(n.default);return f1.default=u,f1}var m1={},yP;function Ije(){if(yP)return m1;yP=1,Object.defineProperty(m1,"__esModule",{value:!0});var t=Wy(),r=function(l){return l.match(new RegExp("^"+t.A_CHARS+"*"))[0].length},n=function(l){return l.match(new RegExp("^"+t.B_CHARS+"*"))[0].length},i=function(l){return l.match(new RegExp("^"+t.C_CHARS+"*"))[0]};function a(o,l){var u=l?t.A_CHARS:t.B_CHARS,d=o.match(new RegExp("^("+u+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(d)return d[1]+""+s(o.substring(d[1].length));var f=o.match(new RegExp("^"+u+"+"))[0];return f.length===o.length?o:f+String.fromCharCode(l?205:206)+a(o.substring(f.length),!l)}function s(o){var l=i(o),u=l.length;if(u===o.length)return o;o=o.substring(u);var d=r(o)>=n(o);return l+String.fromCharCode(d?206:205)+a(o,d)}return m1.default=function(o){var l=void 0,u=i(o).length;if(u>=2)l=t.C_START_CHAR+s(o);else{var d=r(o)>n(o);l=(d?t.A_START_CHAR:t.B_START_CHAR)+a(o,d)}return l.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(f,p){return""+p})},m1}var xP;function Oje(){if(xP)return h1;xP=1,Object.defineProperty(h1,"__esModule",{value:!0});var t=rj(),r=a(t),n=Ije(),i=a(n);function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(p,x){if(s(this,f),/^[\x00-\x7F\xC8-\xD3]+$/.test(p))var v=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,(0,i.default)(p),x));else var v=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,p,x));return o(v)}return f})(r.default);return h1.default=u,h1}var p1={},vP;function kje(){if(vP)return p1;vP=1,Object.defineProperty(p1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=rj(),n=a(r),i=Wy();function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(p,x){return s(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,i.A_START_CHAR+p,x))}return t(f,[{key:"valid",value:function(){return new RegExp("^"+i.A_CHARS+"+$").test(this.data)}}]),f})(n.default);return p1.default=u,p1}var g1={},bP;function Dje(){if(bP)return g1;bP=1,Object.defineProperty(g1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=rj(),n=a(r),i=Wy();function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(p,x){return s(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,i.B_START_CHAR+p,x))}return t(f,[{key:"valid",value:function(){return new RegExp("^"+i.B_CHARS+"+$").test(this.data)}}]),f})(n.default);return g1.default=u,g1}var y1={},jP;function Pje(){if(jP)return y1;jP=1,Object.defineProperty(y1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=rj(),n=a(r),i=Wy();function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(p,x){return s(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,i.C_START_CHAR+p,x))}return t(f,[{key:"valid",value:function(){return new RegExp("^"+i.C_CHARS+"+$").test(this.data)}}]),f})(n.default);return y1.default=u,y1}var wP;function Rje(){if(wP)return bd;wP=1,Object.defineProperty(bd,"__esModule",{value:!0}),bd.CODE128C=bd.CODE128B=bd.CODE128A=bd.CODE128=void 0;var t=Oje(),r=u(t),n=kje(),i=u(n),a=Dje(),s=u(a),o=Pje(),l=u(o);function u(d){return d&&d.__esModule?d:{default:d}}return bd.CODE128=r.default,bd.CODE128A=i.default,bd.CODE128B=s.default,bd.CODE128C=l.default,bd}var Ll={},x1={},Bu={},SP;function Hy(){return SP||(SP=1,Object.defineProperty(Bu,"__esModule",{value:!0}),Bu.SIDE_BIN="101",Bu.MIDDLE_BIN="01010",Bu.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},Bu.EAN2_STRUCTURE=["LL","LG","GL","GG"],Bu.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],Bu.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]),Bu}var v1={},b1={},CP;function Vy(){if(CP)return b1;CP=1,Object.defineProperty(b1,"__esModule",{value:!0});var t=Hy(),r=function(i,a,s){var o=i.split("").map(function(u,d){return t.BINARIES[a[d]]}).map(function(u,d){return u?u[i[d]]:""});if(s){var l=i.length-1;o=o.map(function(u,d){return d<l?u+s:u})}return o.join("")};return b1.default=r,b1}var NP;function aW(){if(NP)return v1;NP=1,Object.defineProperty(v1,"__esModule",{value:!0});var t=(function(){function p(x,v){for(var w=0;w<v.length;w++){var C=v[w];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(x,C.key,C)}}return function(x,v,w){return v&&p(x.prototype,v),w&&p(x,w),x}})(),r=Hy(),n=Vy(),i=o(n),a=Fc(),s=o(a);function o(p){return p&&p.__esModule?p:{default:p}}function l(p,x){if(!(p instanceof x))throw new TypeError("Cannot call a class as a function")}function u(p,x){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:p}function d(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(p,x):p.__proto__=x)}var f=(function(p){d(x,p);function x(v,w){l(this,x);var C=u(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,v,w));return C.fontSize=!w.flat&&w.fontSize>w.width*10?w.width*10:w.fontSize,C.guardHeight=w.height+C.fontSize/2+w.textMargin,C}return t(x,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(w,C){return this.text.substr(w,C)}},{key:"leftEncode",value:function(w,C){return(0,i.default)(w,C)}},{key:"rightText",value:function(w,C){return this.text.substr(w,C)}},{key:"rightEncode",value:function(w,C){return(0,i.default)(w,C)}},{key:"encodeGuarded",value:function(){var w={fontSize:this.fontSize},C={height:this.guardHeight};return[{data:r.SIDE_BIN,options:C},{data:this.leftEncode(),text:this.leftText(),options:w},{data:r.MIDDLE_BIN,options:C},{data:this.rightEncode(),text:this.rightText(),options:w},{data:r.SIDE_BIN,options:C}]}},{key:"encodeFlat",value:function(){var w=[r.SIDE_BIN,this.leftEncode(),r.MIDDLE_BIN,this.rightEncode(),r.SIDE_BIN];return{data:w.join(""),text:this.text}}}]),x})(s.default);return v1.default=f,v1}var AP;function Mje(){if(AP)return x1;AP=1,Object.defineProperty(x1,"__esModule",{value:!0});var t=(function(){function p(x,v){for(var w=0;w<v.length;w++){var C=v[w];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(x,C.key,C)}}return function(x,v,w){return v&&p(x.prototype,v),w&&p(x,w),x}})(),r=function p(x,v,w){x===null&&(x=Function.prototype);var C=Object.getOwnPropertyDescriptor(x,v);if(C===void 0){var A=Object.getPrototypeOf(x);return A===null?void 0:p(A,v,w)}else{if("value"in C)return C.value;var T=C.get;return T===void 0?void 0:T.call(w)}},n=Hy(),i=aW(),a=s(i);function s(p){return p&&p.__esModule?p:{default:p}}function o(p,x){if(!(p instanceof x))throw new TypeError("Cannot call a class as a function")}function l(p,x){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:p}function u(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(p,x):p.__proto__=x)}var d=function(x){var v=x.substr(0,12).split("").map(function(w){return+w}).reduce(function(w,C,A){return A%2?w+C*3:w+C},0);return(10-v%10)%10},f=(function(p){u(x,p);function x(v,w){o(this,x),v.search(/^[0-9]{12}$/)!==-1&&(v+=d(v));var C=l(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,v,w));return C.lastChar=w.lastChar,C}return t(x,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===d(this.data)}},{key:"leftText",value:function(){return r(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var w=this.data.substr(1,6),C=n.EAN13_STRUCTURE[this.data[0]];return r(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"leftEncode",this).call(this,w,C)}},{key:"rightText",value:function(){return r(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var w=this.data.substr(7,6);return r(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"rightEncode",this).call(this,w,"RRRRRR")}},{key:"encodeGuarded",value:function(){var w=r(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(w.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(w.push({data:"00"}),w.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),w}}]),x})(a.default);return x1.default=f,x1}var j1={},EP;function Lje(){if(EP)return j1;EP=1,Object.defineProperty(j1,"__esModule",{value:!0});var t=(function(){function f(p,x){for(var v=0;v<x.length;v++){var w=x[v];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(p,w.key,w)}}return function(p,x,v){return x&&f(p.prototype,x),v&&f(p,v),p}})(),r=function f(p,x,v){p===null&&(p=Function.prototype);var w=Object.getOwnPropertyDescriptor(p,x);if(w===void 0){var C=Object.getPrototypeOf(p);return C===null?void 0:f(C,x,v)}else{if("value"in w)return w.value;var A=w.get;return A===void 0?void 0:A.call(v)}},n=aW(),i=a(n);function a(f){return f&&f.__esModule?f:{default:f}}function s(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function o(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function l(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var u=function(p){var x=p.substr(0,7).split("").map(function(v){return+v}).reduce(function(v,w,C){return C%2?v+w:v+w*3},0);return(10-x%10)%10},d=(function(f){l(p,f);function p(x,v){return s(this,p),x.search(/^[0-9]{7}$/)!==-1&&(x+=u(x)),o(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,x,v))}return t(p,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===u(this.data)}},{key:"leftText",value:function(){return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var v=this.data.substr(0,4);return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"leftEncode",this).call(this,v,"LLLL")}},{key:"rightText",value:function(){return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var v=this.data.substr(4,4);return r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"rightEncode",this).call(this,v,"RRRR")}}]),p})(i.default);return j1.default=d,j1}var w1={},_P;function zje(){if(_P)return w1;_P=1,Object.defineProperty(w1,"__esModule",{value:!0});var t=(function(){function x(v,w){for(var C=0;C<w.length;C++){var A=w[C];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(v,A.key,A)}}return function(v,w,C){return w&&x(v.prototype,w),C&&x(v,C),v}})(),r=Hy(),n=Vy(),i=o(n),a=Fc(),s=o(a);function o(x){return x&&x.__esModule?x:{default:x}}function l(x,v){if(!(x instanceof v))throw new TypeError("Cannot call a class as a function")}function u(x,v){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:x}function d(x,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);x.prototype=Object.create(v&&v.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(x,v):x.__proto__=v)}var f=function(v){var w=v.split("").map(function(C){return+C}).reduce(function(C,A,T){return T%2?C+A*9:C+A*3},0);return w%10},p=(function(x){d(v,x);function v(w,C){return l(this,v),u(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,w,C))}return t(v,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var C=r.EAN5_STRUCTURE[f(this.data)];return{data:"1011"+(0,i.default)(this.data,C,"01"),text:this.text}}}]),v})(s.default);return w1.default=p,w1}var S1={},TP;function Bje(){if(TP)return S1;TP=1,Object.defineProperty(S1,"__esModule",{value:!0});var t=(function(){function p(x,v){for(var w=0;w<v.length;w++){var C=v[w];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(x,C.key,C)}}return function(x,v,w){return v&&p(x.prototype,v),w&&p(x,w),x}})(),r=Hy(),n=Vy(),i=o(n),a=Fc(),s=o(a);function o(p){return p&&p.__esModule?p:{default:p}}function l(p,x){if(!(p instanceof x))throw new TypeError("Cannot call a class as a function")}function u(p,x){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:p}function d(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(p,x):p.__proto__=x)}var f=(function(p){d(x,p);function x(v,w){return l(this,x),u(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,v,w))}return t(x,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var w=r.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,i.default)(this.data,w,"01"),text:this.text}}}]),x})(s.default);return S1.default=f,S1}var ug={},IP;function sW(){if(IP)return ug;IP=1,Object.defineProperty(ug,"__esModule",{value:!0});var t=(function(){function p(x,v){for(var w=0;w<v.length;w++){var C=v[w];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(x,C.key,C)}}return function(x,v,w){return v&&p(x.prototype,v),w&&p(x,w),x}})();ug.checksum=f;var r=Vy(),n=s(r),i=Fc(),a=s(i);function s(p){return p&&p.__esModule?p:{default:p}}function o(p,x){if(!(p instanceof x))throw new TypeError("Cannot call a class as a function")}function l(p,x){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:p}function u(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(p,x):p.__proto__=x)}var d=(function(p){u(x,p);function x(v,w){o(this,x),v.search(/^[0-9]{11}$/)!==-1&&(v+=f(v));var C=l(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,v,w));return C.displayValue=w.displayValue,w.fontSize>w.width*10?C.fontSize=w.width*10:C.fontSize=w.fontSize,C.guardHeight=w.height+C.fontSize/2+w.textMargin,C}return t(x,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==f(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var w="";return w+="101",w+=(0,n.default)(this.data.substr(0,6),"LLLLLL"),w+="01010",w+=(0,n.default)(this.data.substr(6,6),"RRRRRR"),w+="101",{data:w,text:this.text}}},{key:"guardedEncoding",value:function(){var w=[];return this.displayValue&&w.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),w.push({data:"101"+(0,n.default)(this.data[0],"L"),options:{height:this.guardHeight}}),w.push({data:(0,n.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),w.push({data:"01010",options:{height:this.guardHeight}}),w.push({data:(0,n.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),w.push({data:(0,n.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&w.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),w}}]),x})(a.default);function f(p){var x=0,v;for(v=1;v<11;v+=2)x+=parseInt(p[v]);for(v=0;v<11;v+=2)x+=parseInt(p[v])*3;return(10-x%10)%10}return ug.default=d,ug}var C1={},OP;function Fje(){if(OP)return C1;OP=1,Object.defineProperty(C1,"__esModule",{value:!0});var t=(function(){function w(C,A){for(var T=0;T<A.length;T++){var O=A[T];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(C,O.key,O)}}return function(C,A,T){return A&&w(C.prototype,A),T&&w(C,T),C}})(),r=Vy(),n=o(r),i=Fc(),a=o(i),s=sW();function o(w){return w&&w.__esModule?w:{default:w}}function l(w,C){if(!(w instanceof C))throw new TypeError("Cannot call a class as a function")}function u(w,C){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:w}function d(w,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);w.prototype=Object.create(C&&C.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(w,C):w.__proto__=C)}var f=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],p=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],x=(function(w){d(C,w);function C(A,T){l(this,C);var O=u(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,A,T));if(O.isValid=!1,A.search(/^[0-9]{6}$/)!==-1)O.middleDigits=A,O.upcA=v(A,"0"),O.text=T.text||""+O.upcA[0]+A+O.upcA[O.upcA.length-1],O.isValid=!0;else if(A.search(/^[01][0-9]{7}$/)!==-1)if(O.middleDigits=A.substring(1,A.length-1),O.upcA=v(O.middleDigits,A[0]),O.upcA[O.upcA.length-1]===A[A.length-1])O.isValid=!0;else return u(O);else return u(O);return O.displayValue=T.displayValue,T.fontSize>T.width*10?O.fontSize=T.width*10:O.fontSize=T.fontSize,O.guardHeight=T.height+O.fontSize/2+T.textMargin,O}return t(C,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var T="";return T+="101",T+=this.encodeMiddleDigits(),T+="010101",{data:T,text:this.text}}},{key:"guardedEncoding",value:function(){var T=[];return this.displayValue&&T.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),T.push({data:"101",options:{height:this.guardHeight}}),T.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),T.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&T.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),T}},{key:"encodeMiddleDigits",value:function(){var T=this.upcA[0],O=this.upcA[this.upcA.length-1],D=p[parseInt(O)][parseInt(T)];return(0,n.default)(this.middleDigits,D)}}]),C})(a.default);function v(w,C){for(var A=parseInt(w[w.length-1]),T=f[A],O="",D=0,M=0;M<T.length;M++){var Q=T[M];Q==="X"?O+=w[D++]:O+=Q}return O=""+C+O,""+O+(0,s.checksum)(O)}return C1.default=x,C1}var kP;function qje(){if(kP)return Ll;kP=1,Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.UPCE=Ll.UPC=Ll.EAN2=Ll.EAN5=Ll.EAN8=Ll.EAN13=void 0;var t=Mje(),r=x(t),n=Lje(),i=x(n),a=zje(),s=x(a),o=Bje(),l=x(o),u=sW(),d=x(u),f=Fje(),p=x(f);function x(v){return v&&v.__esModule?v:{default:v}}return Ll.EAN13=r.default,Ll.EAN8=i.default,Ll.EAN5=s.default,Ll.EAN2=l.default,Ll.UPC=d.default,Ll.UPCE=p.default,Ll}var _f={},N1={},op={},DP;function Uje(){return DP||(DP=1,Object.defineProperty(op,"__esModule",{value:!0}),op.START_BIN="1010",op.END_BIN="11101",op.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]),op}var PP;function oW(){if(PP)return N1;PP=1,Object.defineProperty(N1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=Uje(),n=Fc(),i=a(n);function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(){return s(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return t(f,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var x=this,v=this.data.match(/.{2}/g).map(function(w){return x.encodePair(w)}).join("");return{data:r.START_BIN+v+r.END_BIN,text:this.text}}},{key:"encodePair",value:function(x){var v=r.BINARIES[x[1]];return r.BINARIES[x[0]].split("").map(function(w,C){return(w==="1"?"111":"1")+(v[C]==="1"?"000":"0")}).join("")}}]),f})(i.default);return N1.default=u,N1}var A1={},RP;function Wje(){if(RP)return A1;RP=1,Object.defineProperty(A1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=oW(),n=i(r);function i(d){return d&&d.__esModule?d:{default:d}}function a(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function s(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function o(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var l=function(f){var p=f.substr(0,13).split("").map(function(x){return parseInt(x,10)}).reduce(function(x,v,w){return x+v*(3-w%2*2)},0);return Math.ceil(p/10)*10-p},u=(function(d){o(f,d);function f(p,x){return a(this,f),p.search(/^[0-9]{13}$/)!==-1&&(p+=l(p)),s(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,p,x))}return t(f,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===l(this.data)}}]),f})(n.default);return A1.default=u,A1}var MP;function Hje(){if(MP)return _f;MP=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.ITF14=_f.ITF=void 0;var t=oW(),r=a(t),n=Wje(),i=a(n);function a(s){return s&&s.__esModule?s:{default:s}}return _f.ITF=r.default,_f.ITF14=i.default,_f}var Nc={},E1={},LP;function $y(){if(LP)return E1;LP=1,Object.defineProperty(E1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=Fc(),n=i(r);function i(d){return d&&d.__esModule?d:{default:d}}function a(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function s(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function o(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var l=(function(d){o(f,d);function f(p,x){return a(this,f),s(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,p,x))}return t(f,[{key:"encode",value:function(){for(var x="110",v=0;v<this.data.length;v++){var w=parseInt(this.data[v]),C=w.toString(2);C=u(C,4-C.length);for(var A=0;A<C.length;A++)x+=C[A]=="0"?"100":"110"}return x+="1001",{data:x,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),f})(n.default);function u(d,f){for(var p=0;p<f;p++)d="0"+d;return d}return E1.default=l,E1}var _1={},hg={},zP;function nj(){if(zP)return hg;zP=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.mod10=t,hg.mod11=r;function t(n){for(var i=0,a=0;a<n.length;a++){var s=parseInt(n[a]);(a+n.length)%2===0?i+=s:i+=s*2%10+Math.floor(s*2/10)}return(10-i%10)%10}function r(n){for(var i=0,a=[2,3,4,5,6,7],s=0;s<n.length;s++){var o=parseInt(n[n.length-1-s]);i+=a[s%a.length]*o}return(11-i%11)%11}return hg}var BP;function Vje(){if(BP)return _1;BP=1,Object.defineProperty(_1,"__esModule",{value:!0});var t=$y(),r=i(t),n=nj();function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){return a(this,d),s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f+(0,n.mod10)(f),p))}return d})(r.default);return _1.default=l,_1}var T1={},FP;function $je(){if(FP)return T1;FP=1,Object.defineProperty(T1,"__esModule",{value:!0});var t=$y(),r=i(t),n=nj();function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){return a(this,d),s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f+(0,n.mod11)(f),p))}return d})(r.default);return T1.default=l,T1}var I1={},qP;function Gje(){if(qP)return I1;qP=1,Object.defineProperty(I1,"__esModule",{value:!0});var t=$y(),r=i(t),n=nj();function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){return a(this,d),f+=(0,n.mod10)(f),f+=(0,n.mod10)(f),s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,p))}return d})(r.default);return I1.default=l,I1}var O1={},UP;function Kje(){if(UP)return O1;UP=1,Object.defineProperty(O1,"__esModule",{value:!0});var t=$y(),r=i(t),n=nj();function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){return a(this,d),f+=(0,n.mod11)(f),f+=(0,n.mod10)(f),s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,p))}return d})(r.default);return O1.default=l,O1}var WP;function Qje(){if(WP)return Nc;WP=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.MSI1110=Nc.MSI1010=Nc.MSI11=Nc.MSI10=Nc.MSI=void 0;var t=$y(),r=f(t),n=Vje(),i=f(n),a=$je(),s=f(a),o=Gje(),l=f(o),u=Kje(),d=f(u);function f(p){return p&&p.__esModule?p:{default:p}}return Nc.MSI=r.default,Nc.MSI10=i.default,Nc.MSI11=s.default,Nc.MSI1010=l.default,Nc.MSI1110=d.default,Nc}var fg={},HP;function Yje(){if(HP)return fg;HP=1,Object.defineProperty(fg,"__esModule",{value:!0}),fg.pharmacode=void 0;var t=(function(){function u(d,f){for(var p=0;p<f.length;p++){var x=f[p];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,f,p){return f&&u(d.prototype,f),p&&u(d,p),d}})(),r=Fc(),n=i(r);function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){a(this,d);var x=s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,p));return x.number=parseInt(f,10),x}return t(d,[{key:"encode",value:function(){for(var p=this.number,x="";!isNaN(p)&&p!=0;)p%2===0?(x="11100"+x,p=(p-2)/2):(x="100"+x,p=(p-1)/2);return x=x.slice(0,-2),{data:x,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),d})(n.default);return fg.pharmacode=l,fg}var mg={},VP;function Zje(){if(VP)return mg;VP=1,Object.defineProperty(mg,"__esModule",{value:!0}),mg.codabar=void 0;var t=(function(){function u(d,f){for(var p=0;p<f.length;p++){var x=f[p];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,f,p){return f&&u(d.prototype,f),p&&u(d,p),d}})(),r=Fc(),n=i(r);function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){a(this,d),f.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(f="A"+f+"A");var x=s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f.toUpperCase(),p));return x.text=x.options.text||x.text.replace(/[A-D]/g,""),x}return t(d,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var p=[],x=this.getEncodings(),v=0;v<this.data.length;v++)p.push(x[this.data.charAt(v)]),v!==this.data.length-1&&p.push("0");return{text:this.text,data:p.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),d})(n.default);return mg.codabar=l,mg}var Tf={},k1={},lp={},$P;function Xje(){return $P||($P=1,Object.defineProperty(lp,"__esModule",{value:!0}),lp.SYMBOLS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","($)","(%)","(/)","(+)",""],lp.BINARIES=["100010100","101001000","101000100","101000010","100101000","100100100","100100010","101010000","100010010","100001010","110101000","110100100","110100010","110010100","110010010","110001010","101101000","101100100","101100010","100110100","100011010","101011000","101001100","101000110","100101100","100010110","110110100","110110010","110101100","110100110","110010110","110011010","101101100","101100110","100110110","100111010","100101110","111010100","111010010","111001010","101101110","101110110","110101110","100100110","111011010","111010110","100110010","101011110"],lp.MULTI_SYMBOLS={"\0":["(%)","U"],"":["($)","A"],"":["($)","B"],"":["($)","C"],"":["($)","D"],"":["($)","E"],"":["($)","F"],"\x07":["($)","G"],"\b":["($)","H"],"	":["($)","I"],"\n":["($)","J"],"\v":["($)","K"],"\f":["($)","L"],"\r":["($)","M"],"":["($)","N"],"":["($)","O"],"":["($)","P"],"":["($)","Q"],"":["($)","R"],"":["($)","S"],"":["($)","T"],"":["($)","U"],"":["($)","V"],"":["($)","W"],"":["($)","X"],"":["($)","Y"],"":["($)","Z"],"\x1B":["(%)","A"],"":["(%)","B"],"":["(%)","C"],"":["(%)","D"],"":["(%)","E"],"!":["(/)","A"],'"':["(/)","B"],"#":["(/)","C"],"&":["(/)","F"],"'":["(/)","G"],"(":["(/)","H"],")":["(/)","I"],"*":["(/)","J"],",":["(/)","L"],":":["(/)","Z"],";":["(%)","F"],"<":["(%)","G"],"=":["(%)","H"],">":["(%)","I"],"?":["(%)","J"],"@":["(%)","V"],"[":["(%)","K"],"\\":["(%)","L"],"]":["(%)","M"],"^":["(%)","N"],_:["(%)","O"],"`":["(%)","W"],a:["(+)","A"],b:["(+)","B"],c:["(+)","C"],d:["(+)","D"],e:["(+)","E"],f:["(+)","F"],g:["(+)","G"],h:["(+)","H"],i:["(+)","I"],j:["(+)","J"],k:["(+)","K"],l:["(+)","L"],m:["(+)","M"],n:["(+)","N"],o:["(+)","O"],p:["(+)","P"],q:["(+)","Q"],r:["(+)","R"],s:["(+)","S"],t:["(+)","T"],u:["(+)","U"],v:["(+)","V"],w:["(+)","W"],x:["(+)","X"],y:["(+)","Y"],z:["(+)","Z"],"{":["(%)","P"],"|":["(%)","Q"],"}":["(%)","R"],"~":["(%)","S"],"":["(%)","T"]}),lp}var GP;function lW(){if(GP)return k1;GP=1,Object.defineProperty(k1,"__esModule",{value:!0});var t=(function(){function d(f,p){for(var x=0;x<p.length;x++){var v=p[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}return function(f,p,x){return p&&d(f.prototype,p),x&&d(f,x),f}})(),r=Xje(),n=Fc(),i=a(n);function a(d){return d&&d.__esModule?d:{default:d}}function s(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function o(d,f){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:d}function l(d,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);d.prototype=Object.create(f&&f.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(d,f):d.__proto__=f)}var u=(function(d){l(f,d);function f(p,x){return s(this,f),o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,p,x))}return t(f,[{key:"valid",value:function(){return/^[0-9A-Z\-. $/+%]+$/.test(this.data)}},{key:"encode",value:function(){var x=this.data.split("").flatMap(function(A){return r.MULTI_SYMBOLS[A]||A}),v=x.map(function(A){return f.getEncoding(A)}).join(""),w=f.checksum(x,20),C=f.checksum(x.concat(w),15);return{text:this.text,data:f.getEncoding("")+v+f.getEncoding(w)+f.getEncoding(C)+f.getEncoding("")+"1"}}}],[{key:"getEncoding",value:function(x){return r.BINARIES[f.symbolValue(x)]}},{key:"getSymbol",value:function(x){return r.SYMBOLS[x]}},{key:"symbolValue",value:function(x){return r.SYMBOLS.indexOf(x)}},{key:"checksum",value:function(x,v){var w=x.slice().reverse().reduce(function(C,A,T){var O=T%v+1;return C+f.symbolValue(A)*O},0);return f.getSymbol(w%47)}}]),f})(i.default);return k1.default=u,k1}var D1={},KP;function Jje(){if(KP)return D1;KP=1,Object.defineProperty(D1,"__esModule",{value:!0});var t=(function(){function u(d,f){for(var p=0;p<f.length;p++){var x=f[p];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,f,p){return f&&u(d.prototype,f),p&&u(d,p),d}})(),r=lW(),n=i(r);function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){return a(this,d),s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,p))}return t(d,[{key:"valid",value:function(){return/^[\x00-\x7f]+$/.test(this.data)}}]),d})(n.default);return D1.default=l,D1}var QP;function e5e(){if(QP)return Tf;QP=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.CODE93FullASCII=Tf.CODE93=void 0;var t=lW(),r=a(t),n=Jje(),i=a(n);function a(s){return s&&s.__esModule?s:{default:s}}return Tf.CODE93=r.default,Tf.CODE93FullASCII=i.default,Tf}var pg={},YP;function t5e(){if(YP)return pg;YP=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.GenericBarcode=void 0;var t=(function(){function u(d,f){for(var p=0;p<f.length;p++){var x=f[p];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,f,p){return f&&u(d.prototype,f),p&&u(d,p),d}})(),r=Fc(),n=i(r);function i(u){return u&&u.__esModule?u:{default:u}}function a(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function s(u,d){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:u}function o(u,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);u.prototype=Object.create(d&&d.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(u,d):u.__proto__=d)}var l=(function(u){o(d,u);function d(f,p){return a(this,d),s(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,f,p))}return t(d,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),d})(n.default);return pg.GenericBarcode=l,pg}var ZP;function r5e(){if(ZP)return d1;ZP=1,Object.defineProperty(d1,"__esModule",{value:!0});var t=Tje(),r=Rje(),n=qje(),i=Hje(),a=Qje(),s=Yje(),o=Zje(),l=e5e(),u=t5e();return d1.default={CODE39:t.CODE39,CODE128:r.CODE128,CODE128A:r.CODE128A,CODE128B:r.CODE128B,CODE128C:r.CODE128C,EAN13:n.EAN13,EAN8:n.EAN8,EAN5:n.EAN5,EAN2:n.EAN2,UPC:n.UPC,UPCE:n.UPCE,ITF14:i.ITF14,ITF:i.ITF,MSI:a.MSI,MSI10:a.MSI10,MSI11:a.MSI11,MSI1010:a.MSI1010,MSI1110:a.MSI1110,pharmacode:s.pharmacode,codabar:o.codabar,CODE93:l.CODE93,CODE93FullASCII:l.CODE93FullASCII,GenericBarcode:u.GenericBarcode},d1}var P1={},XP;function ij(){if(XP)return P1;XP=1,Object.defineProperty(P1,"__esModule",{value:!0});var t=Object.assign||function(r){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r};return P1.default=function(r,n){return t({},r,n)},P1}var R1={},JP;function n5e(){if(JP)return R1;JP=1,Object.defineProperty(R1,"__esModule",{value:!0}),R1.default=t;function t(r){var n=[];function i(a){if(Array.isArray(a))for(var s=0;s<a.length;s++)i(a[s]);else a.text=a.text||"",a.data=a.data||"",n.push(a)}return i(r),n}return R1}var M1={},eR;function i5e(){if(eR)return M1;eR=1,Object.defineProperty(M1,"__esModule",{value:!0}),M1.default=t;function t(r){return r.marginTop=r.marginTop||r.margin,r.marginBottom=r.marginBottom||r.margin,r.marginRight=r.marginRight||r.margin,r.marginLeft=r.marginLeft||r.margin,r}return M1}var L1={},z1={},B1={},tR;function cW(){if(tR)return B1;tR=1,Object.defineProperty(B1,"__esModule",{value:!0}),B1.default=t;function t(r){var n=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var i in n)n.hasOwnProperty(i)&&(i=n[i],typeof r[i]=="string"&&(r[i]=parseInt(r[i],10)));return typeof r.displayValue=="string"&&(r.displayValue=r.displayValue!="false"),r}return B1}var F1={},rR;function dW(){if(rR)return F1;rR=1,Object.defineProperty(F1,"__esModule",{value:!0});var t={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};return F1.default=t,F1}var nR;function a5e(){if(nR)return z1;nR=1,Object.defineProperty(z1,"__esModule",{value:!0});var t=cW(),r=a(t),n=dW(),i=a(n);function a(o){return o&&o.__esModule?o:{default:o}}function s(o){var l={};for(var u in i.default)i.default.hasOwnProperty(u)&&(o.hasAttribute("jsbarcode-"+u.toLowerCase())&&(l[u]=o.getAttribute("jsbarcode-"+u.toLowerCase())),o.hasAttribute("data-"+u.toLowerCase())&&(l[u]=o.getAttribute("data-"+u.toLowerCase())));return l.value=o.getAttribute("jsbarcode-value")||o.getAttribute("data-value"),l=(0,r.default)(l),l}return z1.default=s,z1}var q1={},U1={},Ac={},iR;function uW(){if(iR)return Ac;iR=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.getTotalWidthOfEncodings=Ac.calculateEncodingAttributes=Ac.getBarcodePadding=Ac.getEncodingHeight=Ac.getMaximumHeightOfEncodings=void 0;var t=ij(),r=n(t);function n(d){return d&&d.__esModule?d:{default:d}}function i(d,f){return f.height+(f.displayValue&&d.text.length>0?f.fontSize+f.textMargin:0)+f.marginTop+f.marginBottom}function a(d,f,p){if(p.displayValue&&f<d){if(p.textAlign=="center")return Math.floor((d-f)/2);if(p.textAlign=="left")return 0;if(p.textAlign=="right")return Math.floor(d-f)}return 0}function s(d,f,p){for(var x=0;x<d.length;x++){var v=d[x],w=(0,r.default)(f,v.options),C;w.displayValue?C=u(v.text,w,p):C=0;var A=v.data.length*w.width;v.width=Math.ceil(Math.max(C,A)),v.height=i(v,w),v.barcodePadding=a(C,A,w)}}function o(d){for(var f=0,p=0;p<d.length;p++)f+=d[p].width;return f}function l(d){for(var f=0,p=0;p<d.length;p++)d[p].height>f&&(f=d[p].height);return f}function u(d,f,p){var x;if(p)x=p;else if(typeof document<"u")x=document.createElement("canvas").getContext("2d");else return 0;x.font=f.fontOptions+" "+f.fontSize+"px "+f.font;var v=x.measureText(d);if(!v)return 0;var w=v.width;return w}return Ac.getMaximumHeightOfEncodings=l,Ac.getEncodingHeight=i,Ac.getBarcodePadding=a,Ac.calculateEncodingAttributes=s,Ac.getTotalWidthOfEncodings=o,Ac}var aR;function s5e(){if(aR)return U1;aR=1,Object.defineProperty(U1,"__esModule",{value:!0});var t=(function(){function l(u,d){for(var f=0;f<d.length;f++){var p=d[f];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}return function(u,d,f){return d&&l(u.prototype,d),f&&l(u,f),u}})(),r=ij(),n=a(r),i=uW();function a(l){return l&&l.__esModule?l:{default:l}}function s(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=(function(){function l(u,d,f){s(this,l),this.canvas=u,this.encodings=d,this.options=f}return t(l,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var d=0;d<this.encodings.length;d++){var f=(0,n.default)(this.options,this.encodings[d].options);this.drawCanvasBarcode(f,this.encodings[d]),this.drawCanvasText(f,this.encodings[d]),this.moveCanvasDrawing(this.encodings[d])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var d=this.canvas.getContext("2d");d.save(),(0,i.calculateEncodingAttributes)(this.encodings,this.options,d);var f=(0,i.getTotalWidthOfEncodings)(this.encodings),p=(0,i.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=f+this.options.marginLeft+this.options.marginRight,this.canvas.height=p,d.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(d.fillStyle=this.options.background,d.fillRect(0,0,this.canvas.width,this.canvas.height)),d.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(d,f){var p=this.canvas.getContext("2d"),x=f.data,v;d.textPosition=="top"?v=d.marginTop+d.fontSize+d.textMargin:v=d.marginTop,p.fillStyle=d.lineColor;for(var w=0;w<x.length;w++){var C=w*d.width+f.barcodePadding;x[w]==="1"?p.fillRect(C,v,d.width,d.height):x[w]&&p.fillRect(C,v,d.width,d.height*x[w])}}},{key:"drawCanvasText",value:function(d,f){var p=this.canvas.getContext("2d"),x=d.fontOptions+" "+d.fontSize+"px "+d.font;if(d.displayValue){var v,w;d.textPosition=="top"?w=d.marginTop+d.fontSize-d.textMargin:w=d.height+d.textMargin+d.marginTop+d.fontSize,p.font=x,d.textAlign=="left"||f.barcodePadding>0?(v=0,p.textAlign="left"):d.textAlign=="right"?(v=f.width-1,p.textAlign="right"):(v=f.width/2,p.textAlign="center"),p.fillText(f.text,v,w)}}},{key:"moveCanvasDrawing",value:function(d){var f=this.canvas.getContext("2d");f.translate(d.width,0)}},{key:"restoreCanvas",value:function(){var d=this.canvas.getContext("2d");d.restore()}}]),l})();return U1.default=o,U1}var W1={},sR;function o5e(){if(sR)return W1;sR=1,Object.defineProperty(W1,"__esModule",{value:!0});var t=(function(){function u(d,f){for(var p=0;p<f.length;p++){var x=f[p];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}return function(d,f,p){return f&&u(d.prototype,f),p&&u(d,p),d}})(),r=ij(),n=a(r),i=uW();function a(u){return u&&u.__esModule?u:{default:u}}function s(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}var o="http://www.w3.org/2000/svg",l=(function(){function u(d,f,p){s(this,u),this.svg=d,this.encodings=f,this.options=p,this.document=p.xmlDocument||document}return t(u,[{key:"render",value:function(){var f=this.options.marginLeft;this.prepareSVG();for(var p=0;p<this.encodings.length;p++){var x=this.encodings[p],v=(0,n.default)(this.options,x.options),w=this.createGroup(f,v.marginTop,this.svg);this.setGroupOptions(w,v),this.drawSvgBarcode(w,v,x),this.drawSVGText(w,v,x),f+=x.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,i.calculateEncodingAttributes)(this.encodings,this.options);var f=(0,i.getTotalWidthOfEncodings)(this.encodings),p=(0,i.getMaximumHeightOfEncodings)(this.encodings),x=f+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(x,p),this.options.background&&this.drawRect(0,0,x,p,this.svg).setAttribute("fill",this.options.background)}},{key:"drawSvgBarcode",value:function(f,p,x){var v=x.data,w;p.textPosition=="top"?w=p.fontSize+p.textMargin:w=0;for(var C=0,A=0,T=0;T<v.length;T++)A=T*p.width+x.barcodePadding,v[T]==="1"?C++:C>0&&(this.drawRect(A-p.width*C,w,p.width*C,p.height,f),C=0);C>0&&this.drawRect(A-p.width*(C-1),w,p.width*C,p.height,f)}},{key:"drawSVGText",value:function(f,p,x){var v=this.document.createElementNS(o,"text");if(p.displayValue){var w,C;v.setAttribute("font-family",p.font),v.setAttribute("font-size",p.fontSize),p.fontOptions.includes("bold")&&v.setAttribute("font-weight","bold"),p.fontOptions.includes("italic")&&v.setAttribute("font-style","italic"),p.textPosition=="top"?C=p.fontSize-p.textMargin:C=p.height+p.textMargin+p.fontSize,p.textAlign=="left"||x.barcodePadding>0?(w=0,v.setAttribute("text-anchor","start")):p.textAlign=="right"?(w=x.width-1,v.setAttribute("text-anchor","end")):(w=x.width/2,v.setAttribute("text-anchor","middle")),v.setAttribute("x",w),v.setAttribute("y",C),v.appendChild(this.document.createTextNode(x.text)),f.appendChild(v)}}},{key:"setSvgAttributes",value:function(f,p){var x=this.svg;x.setAttribute("width",f+"px"),x.setAttribute("height",p+"px"),x.setAttribute("x","0px"),x.setAttribute("y","0px"),x.setAttribute("viewBox","0 0 "+f+" "+p),x.setAttribute("xmlns",o),x.setAttribute("version","1.1")}},{key:"createGroup",value:function(f,p,x){var v=this.document.createElementNS(o,"g");return v.setAttribute("transform","translate("+f+", "+p+")"),x.appendChild(v),v}},{key:"setGroupOptions",value:function(f,p){f.setAttribute("fill",p.lineColor)}},{key:"drawRect",value:function(f,p,x,v,w){var C=this.document.createElementNS(o,"rect");return C.setAttribute("x",f),C.setAttribute("y",p),C.setAttribute("width",x),C.setAttribute("height",v),w.appendChild(C),C}}]),u})();return W1.default=l,W1}var H1={},oR;function l5e(){if(oR)return H1;oR=1,Object.defineProperty(H1,"__esModule",{value:!0});var t=(function(){function i(a,s){for(var o=0;o<s.length;o++){var l=s[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}return function(a,s,o){return s&&i(a.prototype,s),o&&i(a,o),a}})();function r(i,a){if(!(i instanceof a))throw new TypeError("Cannot call a class as a function")}var n=(function(){function i(a,s,o){r(this,i),this.object=a,this.encodings=s,this.options=o}return t(i,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),i})();return H1.default=n,H1}var lR;function c5e(){if(lR)return q1;lR=1,Object.defineProperty(q1,"__esModule",{value:!0});var t=s5e(),r=o(t),n=o5e(),i=o(n),a=l5e(),s=o(a);function o(l){return l&&l.__esModule?l:{default:l}}return q1.default={CanvasRenderer:r.default,SVGRenderer:i.default,ObjectRenderer:s.default},q1}var cp={},cR;function hW(){if(cR)return cp;cR=1,Object.defineProperty(cp,"__esModule",{value:!0});function t(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}function r(o,l){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l&&(typeof l=="object"||typeof l=="function")?l:o}function n(o,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof l);o.prototype=Object.create(l&&l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(o,l):o.__proto__=l)}var i=(function(o){n(l,o);function l(u,d){t(this,l);var f=r(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return f.name="InvalidInputException",f.symbology=u,f.input=d,f.message='"'+f.input+'" is not a valid input for '+f.symbology,f}return l})(Error),a=(function(o){n(l,o);function l(){t(this,l);var u=r(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return u.name="InvalidElementException",u.message="Not supported type to render on",u}return l})(Error),s=(function(o){n(l,o);function l(){t(this,l);var u=r(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return u.name="NoElementException",u.message="No element to render on.",u}return l})(Error);return cp.InvalidInputException=i,cp.InvalidElementException=a,cp.NoElementException=s,cp}var dR;function d5e(){if(dR)return L1;dR=1,Object.defineProperty(L1,"__esModule",{value:!0});var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},r=a5e(),n=o(r),i=c5e(),a=o(i),s=hW();function o(f){return f&&f.__esModule?f:{default:f}}function l(f){if(typeof f=="string")return u(f);if(Array.isArray(f)){for(var p=[],x=0;x<f.length;x++)p.push(l(f[x]));return p}else{if(typeof HTMLCanvasElement<"u"&&f instanceof HTMLImageElement)return d(f);if(f&&f.nodeName&&f.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&f instanceof SVGElement)return{element:f,options:(0,n.default)(f),renderer:a.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement)return{element:f,options:(0,n.default)(f),renderer:a.default.CanvasRenderer};if(f&&f.getContext)return{element:f,renderer:a.default.CanvasRenderer};if(f&&(typeof f>"u"?"undefined":t(f))==="object"&&!f.nodeName)return{element:f,renderer:a.default.ObjectRenderer};throw new s.InvalidElementException}}function u(f){var p=document.querySelectorAll(f);if(p.length!==0){for(var x=[],v=0;v<p.length;v++)x.push(l(p[v]));return x}}function d(f){var p=document.createElement("canvas");return{element:p,options:(0,n.default)(f),renderer:a.default.CanvasRenderer,afterRender:function(){f.setAttribute("src",p.toDataURL())}}}return L1.default=l,L1}var V1={},uR;function u5e(){if(uR)return V1;uR=1,Object.defineProperty(V1,"__esModule",{value:!0});var t=(function(){function i(a,s){for(var o=0;o<s.length;o++){var l=s[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}return function(a,s,o){return s&&i(a.prototype,s),o&&i(a,o),a}})();function r(i,a){if(!(i instanceof a))throw new TypeError("Cannot call a class as a function")}var n=(function(){function i(a){r(this,i),this.api=a}return t(i,[{key:"handleCatch",value:function(s){if(s.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw s.message;else throw s;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(s){try{var o=s.apply(void 0,arguments);return this.api._options.valid(!0),o}catch(l){return this.handleCatch(l),this.api}}}]),i})();return V1.default=n,V1}var SS,hR;function h5e(){if(hR)return SS;hR=1;var t=r5e(),r=T(t),n=ij(),i=T(n),a=n5e(),s=T(a),o=i5e(),l=T(o),u=d5e(),d=T(u),f=cW(),p=T(f),x=u5e(),v=T(x),w=hW(),C=dW(),A=T(C);function T(F){return F&&F.__esModule?F:{default:F}}var O=function(){},D=function(Y,J,Z){var re=new O;if(typeof Y>"u")throw Error("No element to render on was provided.");return re._renderProperties=(0,d.default)(Y),re._encodings=[],re._options=A.default,re._errorHandler=new v.default(re),typeof J<"u"&&(Z=Z||{},Z.format||(Z.format=$()),re.options(Z)[Z.format](J,Z).render()),re};D.getModule=function(F){return r.default[F]};for(var M in r.default)r.default.hasOwnProperty(M)&&Q(r.default,M);function Q(F,Y){O.prototype[Y]=O.prototype[Y.toUpperCase()]=O.prototype[Y.toLowerCase()]=function(J,Z){var re=this;return re._errorHandler.wrapBarcodeCall(function(){Z.text=typeof Z.text>"u"?void 0:""+Z.text;var de=(0,i.default)(re._options,Z);de=(0,p.default)(de);var le=F[Y],K=U(J,le,de);return re._encodings.push(K),re})}}function U(F,Y,J){F=""+F;var Z=new Y(F,J);if(!Z.valid())throw new w.InvalidInputException(Z.constructor.name,F);var re=Z.encode();re=(0,s.default)(re);for(var de=0;de<re.length;de++)re[de].options=(0,i.default)(J,re[de].options);return re}function $(){return r.default.CODE128?"CODE128":Object.keys(r.default)[0]}O.prototype.options=function(F){return this._options=(0,i.default)(this._options,F),this},O.prototype.blank=function(F){var Y=new Array(F+1).join("0");return this._encodings.push({data:Y}),this},O.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var F;for(var Y in this._renderProperties){F=this._renderProperties[Y];var J=(0,i.default)(this._options,F.options);J.format=="auto"&&(J.format=$()),this._errorHandler.wrapBarcodeCall(function(){var Z=J.value,re=r.default[J.format.toUpperCase()],de=U(Z,re,J);ee(F,de,J)})}}},O.prototype.render=function(){if(!this._renderProperties)throw new w.NoElementException;if(Array.isArray(this._renderProperties))for(var F=0;F<this._renderProperties.length;F++)ee(this._renderProperties[F],this._encodings,this._options);else ee(this._renderProperties,this._encodings,this._options);return this},O.prototype._defaults=A.default;function ee(F,Y,J){Y=(0,s.default)(Y);for(var Z=0;Z<Y.length;Z++)Y[Z].options=(0,i.default)(J,Y[Z].options),(0,l.default)(Y[Z].options);(0,l.default)(J);var re=F.renderer,de=new re(F.element,Y,J);de.render(),F.afterRender&&F.afterRender()}return typeof window<"u"&&(window.JsBarcode=D),typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(F,Y){var J=[];return jQuery(this).each(function(){J.push(this)}),D(J,F,Y)}),SS=D,SS}var f5e=h5e();const m5e=hc(f5e);var dp={},CS,fR;function p5e(){return fR||(fR=1,CS=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),CS}var NS={},$h={},mR;function Am(){if(mR)return $h;mR=1;let t;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return $h.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},$h.getSymbolTotalCodewords=function(i){return r[i]},$h.getBCHDigit=function(n){let i=0;for(;n!==0;)i++,n>>>=1;return i},$h.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');t=i},$h.isKanjiModeEnabled=function(){return typeof t<"u"},$h.toSJIS=function(i){return t(i)},$h}var AS={},pR;function Y_(){return pR||(pR=1,(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function r(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},t.from=function(i,a){if(t.isValid(i))return i;try{return r(i)}catch{return a}}})(AS)),AS}var ES,gR;function g5e(){if(gR)return ES;gR=1;function t(){this.buffer=[],this.length=0}return t.prototype={get:function(r){const n=Math.floor(r/8);return(this.buffer[n]>>>7-r%8&1)===1},put:function(r,n){for(let i=0;i<n;i++)this.putBit((r>>>n-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),r&&(this.buffer[n]|=128>>>this.length%8),this.length++}},ES=t,ES}var _S,yR;function y5e(){if(yR)return _S;yR=1;function t(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}return t.prototype.set=function(r,n,i,a){const s=r*this.size+n;this.data[s]=i,a&&(this.reservedBit[s]=!0)},t.prototype.get=function(r,n){return this.data[r*this.size+n]},t.prototype.xor=function(r,n,i){this.data[r*this.size+n]^=i},t.prototype.isReserved=function(r,n){return this.reservedBit[r*this.size+n]},_S=t,_S}var TS={},xR;function x5e(){return xR||(xR=1,(function(t){const r=Am().getSymbolSize;t.getRowColCoords=function(i){if(i===1)return[];const a=Math.floor(i/7)+2,s=r(i),o=s===145?26:Math.ceil((s-13)/(2*a-2))*2,l=[s-7];for(let u=1;u<a-1;u++)l[u]=l[u-1]-o;return l.push(6),l.reverse()},t.getPositions=function(i){const a=[],s=t.getRowColCoords(i),o=s.length;for(let l=0;l<o;l++)for(let u=0;u<o;u++)l===0&&u===0||l===0&&u===o-1||l===o-1&&u===0||a.push([s[l],s[u]]);return a}})(TS)),TS}var IS={},vR;function v5e(){if(vR)return IS;vR=1;const t=Am().getSymbolSize,r=7;return IS.getPositions=function(i){const a=t(i);return[[0,0],[a-r,0],[0,a-r]]},IS}var OS={},bR;function b5e(){return bR||(bR=1,(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};t.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},t.from=function(a){return t.isValid(a)?parseInt(a,10):void 0},t.getPenaltyN1=function(a){const s=a.size;let o=0,l=0,u=0,d=null,f=null;for(let p=0;p<s;p++){l=u=0,d=f=null;for(let x=0;x<s;x++){let v=a.get(p,x);v===d?l++:(l>=5&&(o+=r.N1+(l-5)),d=v,l=1),v=a.get(x,p),v===f?u++:(u>=5&&(o+=r.N1+(u-5)),f=v,u=1)}l>=5&&(o+=r.N1+(l-5)),u>=5&&(o+=r.N1+(u-5))}return o},t.getPenaltyN2=function(a){const s=a.size;let o=0;for(let l=0;l<s-1;l++)for(let u=0;u<s-1;u++){const d=a.get(l,u)+a.get(l,u+1)+a.get(l+1,u)+a.get(l+1,u+1);(d===4||d===0)&&o++}return o*r.N2},t.getPenaltyN3=function(a){const s=a.size;let o=0,l=0,u=0;for(let d=0;d<s;d++){l=u=0;for(let f=0;f<s;f++)l=l<<1&2047|a.get(d,f),f>=10&&(l===1488||l===93)&&o++,u=u<<1&2047|a.get(f,d),f>=10&&(u===1488||u===93)&&o++}return o*r.N3},t.getPenaltyN4=function(a){let s=0;const o=a.data.length;for(let u=0;u<o;u++)s+=a.data[u];return Math.abs(Math.ceil(s*100/o/5)-10)*r.N4};function n(i,a,s){switch(i){case t.Patterns.PATTERN000:return(a+s)%2===0;case t.Patterns.PATTERN001:return a%2===0;case t.Patterns.PATTERN010:return s%3===0;case t.Patterns.PATTERN011:return(a+s)%3===0;case t.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(s/3))%2===0;case t.Patterns.PATTERN101:return a*s%2+a*s%3===0;case t.Patterns.PATTERN110:return(a*s%2+a*s%3)%2===0;case t.Patterns.PATTERN111:return(a*s%3+(a+s)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}t.applyMask=function(a,s){const o=s.size;for(let l=0;l<o;l++)for(let u=0;u<o;u++)s.isReserved(u,l)||s.xor(u,l,n(a,u,l))},t.getBestMask=function(a,s){const o=Object.keys(t.Patterns).length;let l=0,u=1/0;for(let d=0;d<o;d++){s(d),t.applyMask(d,a);const f=t.getPenaltyN1(a)+t.getPenaltyN2(a)+t.getPenaltyN3(a)+t.getPenaltyN4(a);t.applyMask(d,a),f<u&&(u=f,l=d)}return l}})(OS)),OS}var $1={},jR;function fW(){if(jR)return $1;jR=1;const t=Y_(),r=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return $1.getBlocksCount=function(a,s){switch(s){case t.L:return r[(a-1)*4+0];case t.M:return r[(a-1)*4+1];case t.Q:return r[(a-1)*4+2];case t.H:return r[(a-1)*4+3];default:return}},$1.getTotalCodewordsCount=function(a,s){switch(s){case t.L:return n[(a-1)*4+0];case t.M:return n[(a-1)*4+1];case t.Q:return n[(a-1)*4+2];case t.H:return n[(a-1)*4+3];default:return}},$1}var kS={},gg={},wR;function j5e(){if(wR)return gg;wR=1;const t=new Uint8Array(512),r=new Uint8Array(256);return(function(){let i=1;for(let a=0;a<255;a++)t[a]=i,r[i]=a,i<<=1,i&256&&(i^=285);for(let a=255;a<512;a++)t[a]=t[a-255]})(),gg.log=function(i){if(i<1)throw new Error("log("+i+")");return r[i]},gg.exp=function(i){return t[i]},gg.mul=function(i,a){return i===0||a===0?0:t[r[i]+r[a]]},gg}var SR;function w5e(){return SR||(SR=1,(function(t){const r=j5e();t.mul=function(i,a){const s=new Uint8Array(i.length+a.length-1);for(let o=0;o<i.length;o++)for(let l=0;l<a.length;l++)s[o+l]^=r.mul(i[o],a[l]);return s},t.mod=function(i,a){let s=new Uint8Array(i);for(;s.length-a.length>=0;){const o=s[0];for(let u=0;u<a.length;u++)s[u]^=r.mul(a[u],o);let l=0;for(;l<s.length&&s[l]===0;)l++;s=s.slice(l)}return s},t.generateECPolynomial=function(i){let a=new Uint8Array([1]);for(let s=0;s<i;s++)a=t.mul(a,new Uint8Array([1,r.exp(s)]));return a}})(kS)),kS}var DS,CR;function S5e(){if(CR)return DS;CR=1;const t=w5e();function r(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}return r.prototype.initialize=function(i){this.degree=i,this.genPoly=t.generateECPolynomial(this.degree)},r.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const a=new Uint8Array(i.length+this.degree);a.set(i);const s=t.mod(a,this.genPoly),o=this.degree-s.length;if(o>0){const l=new Uint8Array(this.degree);return l.set(s,o),l}return s},DS=r,DS}var PS={},RS={},MS={},NR;function mW(){return NR||(NR=1,MS.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40}),MS}var Xd={},AR;function pW(){if(AR)return Xd;AR=1;const t="[0-9]+",r="[A-Z $%*+\\-./:]+";let n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n=n.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+n+`)(?:.|[\r
]))+`;Xd.KANJI=new RegExp(n,"g"),Xd.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Xd.BYTE=new RegExp(i,"g"),Xd.NUMERIC=new RegExp(t,"g"),Xd.ALPHANUMERIC=new RegExp(r,"g");const a=new RegExp("^"+n+"$"),s=new RegExp("^"+t+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Xd.testKanji=function(u){return a.test(u)},Xd.testNumeric=function(u){return s.test(u)},Xd.testAlphanumeric=function(u){return o.test(u)},Xd}var ER;function Em(){return ER||(ER=1,(function(t){const r=mW(),n=pW();t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!r.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},t.getBestModeForData=function(s){return n.testNumeric(s)?t.NUMERIC:n.testAlphanumeric(s)?t.ALPHANUMERIC:n.testKanji(s)?t.KANJI:t.BYTE},t.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},t.isValid=function(s){return s&&s.bit&&s.ccBits};function i(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+a)}}t.from=function(s,o){if(t.isValid(s))return s;try{return i(s)}catch{return o}}})(RS)),RS}var _R;function C5e(){return _R||(_R=1,(function(t){const r=Am(),n=fW(),i=Y_(),a=Em(),s=mW(),o=7973,l=r.getBCHDigit(o);function u(x,v,w){for(let C=1;C<=40;C++)if(v<=t.getCapacity(C,w,x))return C}function d(x,v){return a.getCharCountIndicator(x,v)+4}function f(x,v){let w=0;return x.forEach(function(C){const A=d(C.mode,v);w+=A+C.getBitsLength()}),w}function p(x,v){for(let w=1;w<=40;w++)if(f(x,w)<=t.getCapacity(w,v,a.MIXED))return w}t.from=function(v,w){return s.isValid(v)?parseInt(v,10):w},t.getCapacity=function(v,w,C){if(!s.isValid(v))throw new Error("Invalid QR Code version");typeof C>"u"&&(C=a.BYTE);const A=r.getSymbolTotalCodewords(v),T=n.getTotalCodewordsCount(v,w),O=(A-T)*8;if(C===a.MIXED)return O;const D=O-d(C,v);switch(C){case a.NUMERIC:return Math.floor(D/10*3);case a.ALPHANUMERIC:return Math.floor(D/11*2);case a.KANJI:return Math.floor(D/13);case a.BYTE:default:return Math.floor(D/8)}},t.getBestVersionForData=function(v,w){let C;const A=i.from(w,i.M);if(Array.isArray(v)){if(v.length>1)return p(v,A);if(v.length===0)return 1;C=v[0]}else C=v;return u(C.mode,C.getLength(),A)},t.getEncodedBits=function(v){if(!s.isValid(v)||v<7)throw new Error("Invalid QR Code version");let w=v<<12;for(;r.getBCHDigit(w)-l>=0;)w^=o<<r.getBCHDigit(w)-l;return v<<12|w}})(PS)),PS}var LS={},TR;function N5e(){if(TR)return LS;TR=1;const t=Am(),r=1335,n=21522,i=t.getBCHDigit(r);return LS.getEncodedBits=function(s,o){const l=s.bit<<3|o;let u=l<<10;for(;t.getBCHDigit(u)-i>=0;)u^=r<<t.getBCHDigit(u)-i;return(l<<10|u)^n},LS}var zS={},BS,IR;function A5e(){if(IR)return BS;IR=1;const t=Em();function r(n){this.mode=t.NUMERIC,this.data=n.toString()}return r.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(i){let a,s,o;for(a=0;a+3<=this.data.length;a+=3)s=this.data.substr(a,3),o=parseInt(s,10),i.put(o,10);const l=this.data.length-a;l>0&&(s=this.data.substr(a),o=parseInt(s,10),i.put(o,l*3+1))},BS=r,BS}var FS,OR;function E5e(){if(OR)return FS;OR=1;const t=Em(),r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(i){this.mode=t.ALPHANUMERIC,this.data=i}return n.getBitsLength=function(a){return 11*Math.floor(a/2)+6*(a%2)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){let s;for(s=0;s+2<=this.data.length;s+=2){let o=r.indexOf(this.data[s])*45;o+=r.indexOf(this.data[s+1]),a.put(o,11)}this.data.length%2&&a.put(r.indexOf(this.data[s]),6)},FS=n,FS}var qS,kR;function _5e(){if(kR)return qS;kR=1;const t=Em();function r(n){this.mode=t.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}return r.getBitsLength=function(i){return i*8},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){for(let i=0,a=this.data.length;i<a;i++)n.put(this.data[i],8)},qS=r,qS}var US,DR;function T5e(){if(DR)return US;DR=1;const t=Em(),r=Am();function n(i){this.mode=t.KANJI,this.data=i}return n.getBitsLength=function(a){return a*13},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(i){let a;for(a=0;a<this.data.length;a++){let s=r.toSJIS(this.data[a]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[a]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),i.put(s,13)}},US=n,US}var WS={exports:{}},PR;function I5e(){return PR||(PR=1,(function(t){var r={single_source_shortest_paths:function(n,i,a){var s={},o={};o[i]=0;var l=r.PriorityQueue.make();l.push(i,0);for(var u,d,f,p,x,v,w,C,A;!l.empty();){u=l.pop(),d=u.value,p=u.cost,x=n[d]||{};for(f in x)x.hasOwnProperty(f)&&(v=x[f],w=p+v,C=o[f],A=typeof o[f]>"u",(A||C>w)&&(o[f]=w,l.push(f,w),s[f]=d))}if(typeof a<"u"&&typeof o[a]>"u"){var T=["Could not find a path from ",i," to ",a,"."].join("");throw new Error(T)}return s},extract_shortest_path_from_predecessor_list:function(n,i){for(var a=[],s=i;s;)a.push(s),n[s],s=n[s];return a.reverse(),a},find_path:function(n,i,a){var s=r.single_source_shortest_paths(n,i,a);return r.extract_shortest_path_from_predecessor_list(s,a)},PriorityQueue:{make:function(n){var i=r.PriorityQueue,a={},s;n=n||{};for(s in i)i.hasOwnProperty(s)&&(a[s]=i[s]);return a.queue=[],a.sorter=n.sorter||i.default_sorter,a},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var a={value:n,cost:i};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=r})(WS)),WS.exports}var RR;function O5e(){return RR||(RR=1,(function(t){const r=Em(),n=A5e(),i=E5e(),a=_5e(),s=T5e(),o=pW(),l=Am(),u=I5e();function d(T){return unescape(encodeURIComponent(T)).length}function f(T,O,D){const M=[];let Q;for(;(Q=T.exec(D))!==null;)M.push({data:Q[0],index:Q.index,mode:O,length:Q[0].length});return M}function p(T){const O=f(o.NUMERIC,r.NUMERIC,T),D=f(o.ALPHANUMERIC,r.ALPHANUMERIC,T);let M,Q;return l.isKanjiModeEnabled()?(M=f(o.BYTE,r.BYTE,T),Q=f(o.KANJI,r.KANJI,T)):(M=f(o.BYTE_KANJI,r.BYTE,T),Q=[]),O.concat(D,M,Q).sort(function($,ee){return $.index-ee.index}).map(function($){return{data:$.data,mode:$.mode,length:$.length}})}function x(T,O){switch(O){case r.NUMERIC:return n.getBitsLength(T);case r.ALPHANUMERIC:return i.getBitsLength(T);case r.KANJI:return s.getBitsLength(T);case r.BYTE:return a.getBitsLength(T)}}function v(T){return T.reduce(function(O,D){const M=O.length-1>=0?O[O.length-1]:null;return M&&M.mode===D.mode?(O[O.length-1].data+=D.data,O):(O.push(D),O)},[])}function w(T){const O=[];for(let D=0;D<T.length;D++){const M=T[D];switch(M.mode){case r.NUMERIC:O.push([M,{data:M.data,mode:r.ALPHANUMERIC,length:M.length},{data:M.data,mode:r.BYTE,length:M.length}]);break;case r.ALPHANUMERIC:O.push([M,{data:M.data,mode:r.BYTE,length:M.length}]);break;case r.KANJI:O.push([M,{data:M.data,mode:r.BYTE,length:d(M.data)}]);break;case r.BYTE:O.push([{data:M.data,mode:r.BYTE,length:d(M.data)}])}}return O}function C(T,O){const D={},M={start:{}};let Q=["start"];for(let U=0;U<T.length;U++){const $=T[U],ee=[];for(let F=0;F<$.length;F++){const Y=$[F],J=""+U+F;ee.push(J),D[J]={node:Y,lastCount:0},M[J]={};for(let Z=0;Z<Q.length;Z++){const re=Q[Z];D[re]&&D[re].node.mode===Y.mode?(M[re][J]=x(D[re].lastCount+Y.length,Y.mode)-x(D[re].lastCount,Y.mode),D[re].lastCount+=Y.length):(D[re]&&(D[re].lastCount=Y.length),M[re][J]=x(Y.length,Y.mode)+4+r.getCharCountIndicator(Y.mode,O))}}Q=ee}for(let U=0;U<Q.length;U++)M[Q[U]].end=0;return{map:M,table:D}}function A(T,O){let D;const M=r.getBestModeForData(T);if(D=r.from(O,M),D!==r.BYTE&&D.bit<M.bit)throw new Error('"'+T+'" cannot be encoded with mode '+r.toString(D)+`.
 Suggested mode is: `+r.toString(M));switch(D===r.KANJI&&!l.isKanjiModeEnabled()&&(D=r.BYTE),D){case r.NUMERIC:return new n(T);case r.ALPHANUMERIC:return new i(T);case r.KANJI:return new s(T);case r.BYTE:return new a(T)}}t.fromArray=function(O){return O.reduce(function(D,M){return typeof M=="string"?D.push(A(M,null)):M.data&&D.push(A(M.data,M.mode)),D},[])},t.fromString=function(O,D){const M=p(O,l.isKanjiModeEnabled()),Q=w(M),U=C(Q,D),$=u.find_path(U.map,"start","end"),ee=[];for(let F=1;F<$.length-1;F++)ee.push(U.table[$[F]].node);return t.fromArray(v(ee))},t.rawSplit=function(O){return t.fromArray(p(O,l.isKanjiModeEnabled()))}})(zS)),zS}var MR;function k5e(){if(MR)return NS;MR=1;const t=Am(),r=Y_(),n=g5e(),i=y5e(),a=x5e(),s=v5e(),o=b5e(),l=fW(),u=S5e(),d=C5e(),f=N5e(),p=Em(),x=O5e();function v(U,$){const ee=U.size,F=s.getPositions($);for(let Y=0;Y<F.length;Y++){const J=F[Y][0],Z=F[Y][1];for(let re=-1;re<=7;re++)if(!(J+re<=-1||ee<=J+re))for(let de=-1;de<=7;de++)Z+de<=-1||ee<=Z+de||(re>=0&&re<=6&&(de===0||de===6)||de>=0&&de<=6&&(re===0||re===6)||re>=2&&re<=4&&de>=2&&de<=4?U.set(J+re,Z+de,!0,!0):U.set(J+re,Z+de,!1,!0))}}function w(U){const $=U.size;for(let ee=8;ee<$-8;ee++){const F=ee%2===0;U.set(ee,6,F,!0),U.set(6,ee,F,!0)}}function C(U,$){const ee=a.getPositions($);for(let F=0;F<ee.length;F++){const Y=ee[F][0],J=ee[F][1];for(let Z=-2;Z<=2;Z++)for(let re=-2;re<=2;re++)Z===-2||Z===2||re===-2||re===2||Z===0&&re===0?U.set(Y+Z,J+re,!0,!0):U.set(Y+Z,J+re,!1,!0)}}function A(U,$){const ee=U.size,F=d.getEncodedBits($);let Y,J,Z;for(let re=0;re<18;re++)Y=Math.floor(re/3),J=re%3+ee-8-3,Z=(F>>re&1)===1,U.set(Y,J,Z,!0),U.set(J,Y,Z,!0)}function T(U,$,ee){const F=U.size,Y=f.getEncodedBits($,ee);let J,Z;for(J=0;J<15;J++)Z=(Y>>J&1)===1,J<6?U.set(J,8,Z,!0):J<8?U.set(J+1,8,Z,!0):U.set(F-15+J,8,Z,!0),J<8?U.set(8,F-J-1,Z,!0):J<9?U.set(8,15-J-1+1,Z,!0):U.set(8,15-J-1,Z,!0);U.set(F-8,8,1,!0)}function O(U,$){const ee=U.size;let F=-1,Y=ee-1,J=7,Z=0;for(let re=ee-1;re>0;re-=2)for(re===6&&re--;;){for(let de=0;de<2;de++)if(!U.isReserved(Y,re-de)){let le=!1;Z<$.length&&(le=($[Z]>>>J&1)===1),U.set(Y,re-de,le),J--,J===-1&&(Z++,J=7)}if(Y+=F,Y<0||ee<=Y){Y-=F,F=-F;break}}}function D(U,$,ee){const F=new n;ee.forEach(function(de){F.put(de.mode.bit,4),F.put(de.getLength(),p.getCharCountIndicator(de.mode,U)),de.write(F)});const Y=t.getSymbolTotalCodewords(U),J=l.getTotalCodewordsCount(U,$),Z=(Y-J)*8;for(F.getLengthInBits()+4<=Z&&F.put(0,4);F.getLengthInBits()%8!==0;)F.putBit(0);const re=(Z-F.getLengthInBits())/8;for(let de=0;de<re;de++)F.put(de%2?17:236,8);return M(F,U,$)}function M(U,$,ee){const F=t.getSymbolTotalCodewords($),Y=l.getTotalCodewordsCount($,ee),J=F-Y,Z=l.getBlocksCount($,ee),re=F%Z,de=Z-re,le=Math.floor(F/Z),K=Math.floor(J/Z),ue=K+1,ce=le-K,ye=new u(ce);let Se=0;const V=new Array(Z),X=new Array(Z);let se=0;const W=new Uint8Array(U.buffer);for(let ke=0;ke<Z;ke++){const He=ke<de?K:ue;V[ke]=W.slice(Se,Se+He),X[ke]=ye.encode(V[ke]),Se+=He,se=Math.max(se,He)}const oe=new Uint8Array(F);let ge=0,be,Le;for(be=0;be<se;be++)for(Le=0;Le<Z;Le++)be<V[Le].length&&(oe[ge++]=V[Le][be]);for(be=0;be<ce;be++)for(Le=0;Le<Z;Le++)oe[ge++]=X[Le][be];return oe}function Q(U,$,ee,F){let Y;if(Array.isArray(U))Y=x.fromArray(U);else if(typeof U=="string"){let le=$;if(!le){const K=x.rawSplit(U);le=d.getBestVersionForData(K,ee)}Y=x.fromString(U,le||40)}else throw new Error("Invalid data");const J=d.getBestVersionForData(Y,ee);if(!J)throw new Error("The amount of data is too big to be stored in a QR Code");if(!$)$=J;else if($<J)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+J+`.
`);const Z=D($,ee,Y),re=t.getSymbolSize($),de=new i(re);return v(de,$),w(de),C(de,$),T(de,ee,0),$>=7&&A(de,$),O(de,Z),isNaN(F)&&(F=o.getBestMask(de,T.bind(null,de,ee))),o.applyMask(F,de),T(de,ee,F),{modules:de,version:$,errorCorrectionLevel:ee,maskPattern:F,segments:Y}}return NS.create=function($,ee){if(typeof $>"u"||$==="")throw new Error("No input text");let F=r.M,Y,J;return typeof ee<"u"&&(F=r.from(ee.errorCorrectionLevel,r.M),Y=d.from(ee.version),J=o.from(ee.maskPattern),ee.toSJISFunc&&t.setToSJISFunction(ee.toSJISFunc)),Q($,Y,F,J)},NS}var HS={},VS={},LR;function gW(){return LR||(LR=1,(function(t){function r(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(s){return[s,s]}))),i.length===6&&i.push("F","F");const a=parseInt(i.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+i.slice(0,6).join("")}}t.getOptions=function(i){i||(i={}),i.color||(i.color={});const a=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,s=i.width&&i.width>=21?i.width:void 0,o=i.scale||4;return{width:s,scale:s?4:o,margin:a,color:{dark:r(i.color.dark||"#000000ff"),light:r(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},t.getScale=function(i,a){return a.width&&a.width>=i+a.margin*2?a.width/(i+a.margin*2):a.scale},t.getImageWidth=function(i,a){const s=t.getScale(i,a);return Math.floor((i+a.margin*2)*s)},t.qrToImageData=function(i,a,s){const o=a.modules.size,l=a.modules.data,u=t.getScale(o,s),d=Math.floor((o+s.margin*2)*u),f=s.margin*u,p=[s.color.light,s.color.dark];for(let x=0;x<d;x++)for(let v=0;v<d;v++){let w=(x*d+v)*4,C=s.color.light;if(x>=f&&v>=f&&x<d-f&&v<d-f){const A=Math.floor((x-f)/u),T=Math.floor((v-f)/u);C=p[l[A*o+T]?1:0]}i[w++]=C.r,i[w++]=C.g,i[w++]=C.b,i[w]=C.a}}})(VS)),VS}var zR;function D5e(){return zR||(zR=1,(function(t){const r=gW();function n(a,s,o){a.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(s,o,l){let u=l,d=o;typeof u>"u"&&(!o||!o.getContext)&&(u=o,o=void 0),o||(d=i()),u=r.getOptions(u);const f=r.getImageWidth(s.modules.size,u),p=d.getContext("2d"),x=p.createImageData(f,f);return r.qrToImageData(x.data,s,u),n(p,d,f),p.putImageData(x,0,0),d},t.renderToDataURL=function(s,o,l){let u=l;typeof u>"u"&&(!o||!o.getContext)&&(u=o,o=void 0),u||(u={});const d=t.render(s,o,u),f=u.type||"image/png",p=u.rendererOpts||{};return d.toDataURL(f,p.quality)}})(HS)),HS}var $S={},BR;function P5e(){if(BR)return $S;BR=1;const t=gW();function r(a,s){const o=a.a/255,l=s+'="'+a.hex+'"';return o<1?l+" "+s+'-opacity="'+o.toFixed(2).slice(1)+'"':l}function n(a,s,o){let l=a+s;return typeof o<"u"&&(l+=" "+o),l}function i(a,s,o){let l="",u=0,d=!1,f=0;for(let p=0;p<a.length;p++){const x=Math.floor(p%s),v=Math.floor(p/s);!x&&!d&&(d=!0),a[p]?(f++,p>0&&x>0&&a[p-1]||(l+=d?n("M",x+o,.5+v+o):n("m",u,0),u=0,d=!1),x+1<s&&a[p+1]||(l+=n("h",f),f=0)):u++}return l}return $S.render=function(s,o,l){const u=t.getOptions(o),d=s.modules.size,f=s.modules.data,p=d+u.margin*2,x=u.color.light.a?"<path "+r(u.color.light,"fill")+' d="M0 0h'+p+"v"+p+'H0z"/>':"",v="<path "+r(u.color.dark,"stroke")+' d="'+i(f,d,u.margin)+'"/>',w='viewBox="0 0 '+p+" "+p+'"',A='<svg xmlns="http://www.w3.org/2000/svg" '+(u.width?'width="'+u.width+'" height="'+u.width+'" ':"")+w+' shape-rendering="crispEdges">'+x+v+`</svg>
`;return typeof l=="function"&&l(null,A),A},$S}var FR;function R5e(){if(FR)return dp;FR=1;const t=p5e(),r=k5e(),n=D5e(),i=P5e();function a(s,o,l,u,d){const f=[].slice.call(arguments,1),p=f.length,x=typeof f[p-1]=="function";if(!x&&!t())throw new Error("Callback required as last argument");if(x){if(p<2)throw new Error("Too few arguments provided");p===2?(d=l,l=o,o=u=void 0):p===3&&(o.getContext&&typeof d>"u"?(d=u,u=void 0):(d=u,u=l,l=o,o=void 0))}else{if(p<1)throw new Error("Too few arguments provided");return p===1?(l=o,o=u=void 0):p===2&&!o.getContext&&(u=l,l=o,o=void 0),new Promise(function(v,w){try{const C=r.create(l,u);v(s(C,o,u))}catch(C){w(C)}})}try{const v=r.create(l,u);d(null,s(v,o,u))}catch(v){d(v)}}return dp.create=r.create,dp.toCanvas=a.bind(null,n.render),dp.toDataURL=a.bind(null,n.renderToDataURL),dp.toString=a.bind(null,function(s,o,l){return i.render(s,l)}),dp}var M5e=R5e();const yW=hc(M5e);function Z_({data:t,size:r="medium",showPrintButton:n=!0}){const i=k.useRef(null),a=k.useRef(null),s=k.useRef(null),l={small:{width:200,height:100,fontSize:10,qrSize:50},medium:{width:300,height:150,fontSize:12,qrSize:80},large:{width:400,height:200,fontSize:14,qrSize:100}}[r];k.useEffect(()=>{if(i.current&&t.barcodeData)try{m5e(i.current,t.barcodeData,{format:"CODE128",width:1.5,height:40,displayValue:!0,fontSize:l.fontSize,margin:5})}catch(f){console.error("Barcode generation error:",f)}},[t.barcodeData,l.fontSize]),k.useEffect(()=>{a.current&&t.qrData&&yW.toCanvas(a.current,t.qrData,{width:l.qrSize,margin:1,color:{dark:"#000000",light:"#ffffff"}}).catch(f=>console.error("QR code generation error:",f))},[t.qrData,l.qrSize]);const u=async()=>{if(!s.current)return;const f=window.open("","_blank");if(!f)return;let p="";a.current&&(p=a.current.toDataURL("image/png"));let x=s.current.innerHTML;p&&a.current&&(x=x.replace(/<canvas[^>]*><\/canvas>/i,`<img src="${p}" width="${l.qrSize}" height="${l.qrSize}" />`)),f.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Print Label - ${t.primaryText}</title>
          <style>
            @page {
              size: ${l.width}px ${l.height}px;
              margin: 0;
            }
            body {
              margin: 0;
              padding: 10px;
              font-family: 'Arial', sans-serif;
              -webkit-print-color-adjust: exact;
              print-color-adjust: exact;
            }
            .label-container {
              width: ${l.width-20}px;
              height: ${l.height-20}px;
              border: 1px solid #000;
              padding: 10px;
              box-sizing: border-box;
              display: flex;
              flex-direction: column;
            }
            .label-header {
              display: flex;
              justify-content: space-between;
              align-items: flex-start;
              margin-bottom: 8px;
            }
            .label-title {
              font-size: ${l.fontSize+4}px;
              font-weight: bold;
              margin: 0;
            }
            .label-subtitle {
              font-size: ${l.fontSize}px;
              color: #666;
              margin: 2px 0 0 0;
            }
            .label-type {
              font-size: ${l.fontSize-2}px;
              background: #000;
              color: #fff;
              padding: 2px 6px;
              border-radius: 4px;
              text-transform: uppercase;
            }
            .label-details {
              display: flex;
              flex-wrap: wrap;
              gap: 8px;
              margin-bottom: 8px;
              font-size: ${l.fontSize}px;
            }
            .detail-item {
              display: flex;
              gap: 4px;
            }
            .detail-label {
              font-weight: 600;
            }
            .codes-container {
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-top: auto;
            }
            canvas, svg {
              max-width: 100%;
            }
            @media print {
              body { margin: 0; padding: 0; }
            }
          </style>
        </head>
        <body>
          ${x}
          <script>
            window.onload = function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            };
          <\/script>
        </body>
      </html>
    `),f.document.close()},d=async()=>{if(s.current)try{const f=(await jv(async()=>{const{default:v}=await import("./html2canvas.esm-DXEQVQnt.js");return{default:v}},[])).default,p=await f(s.current,{scale:2,backgroundColor:"#ffffff"}),x=document.createElement("a");x.download=`label-${t.type}-${t.id}.png`,x.href=p.toDataURL("image/png"),x.click()}catch(f){console.error("Download error:",f)}};return e.jsxs("div",{children:[e.jsxs("div",{ref:s,className:"label-container",style:{width:`${l.width}px`,minHeight:`${l.height}px`,border:"2px solid #000",borderRadius:"8px",padding:"12px",background:"#fff",color:"#000",fontFamily:"Arial, sans-serif"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:`${l.fontSize+4}px`,fontWeight:"bold"},children:t.primaryText}),t.secondaryText&&e.jsx("p",{style:{margin:"2px 0 0",fontSize:`${l.fontSize}px`,color:"#666"},children:t.secondaryText})]}),e.jsx("span",{style:{fontSize:`${l.fontSize-2}px`,background:"#000",color:"#fff",padding:"2px 8px",borderRadius:"4px",textTransform:"uppercase",fontWeight:600},children:t.type})]}),t.details&&t.details.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginBottom:"10px",fontSize:`${l.fontSize}px`},children:t.details.map((f,p)=>e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsxs("span",{style:{fontWeight:600},children:[f.label,":"]}),e.jsx("span",{children:f.value})]},p))}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"auto"},children:[t.barcodeData&&e.jsx("svg",{ref:i,style:{maxWidth:"60%"}}),t.qrData&&e.jsx("canvas",{ref:a,style:{marginLeft:"auto"}})]})]}),n&&e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"12px"},children:[e.jsxs("button",{onClick:u,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",borderRadius:"6px",border:"none",background:"var(--primary)",color:"white",cursor:"pointer",fontSize:"13px",fontWeight:500},children:[e.jsx(wm,{size:16}),"Print Label"]}),e.jsxs("button",{onClick:d,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 16px",borderRadius:"6px",border:"1px solid var(--border)",background:"var(--bg-secondary)",color:"var(--text-primary)",cursor:"pointer",fontSize:"13px",fontWeight:500},children:[e.jsx(Jp,{size:16}),"Download"]})]})]})}function L5e({batch:t}){const r={id:t.id,type:"batch",primaryText:t.batchNumber||`BATCH-${t.id.slice(0,8)}`,secondaryText:t.product?.name,details:[{label:"Product",value:t.product?.code||"N/A"},{label:"Qty",value:`${t.plannedQuantity||0} ${t.product?.unitOfMeasure||"units"}`},...t.expiryDate?[{label:"Exp",value:new Date(t.expiryDate).toLocaleDateString()}]:[]],barcodeData:t.batchNumber||t.id,qrData:JSON.stringify({type:"batch",id:t.id,batchNumber:t.batchNumber,product:t.product?.code})};return e.jsx(Z_,{data:r,size:"medium"})}function z5e({shipment:t}){const r={id:t.id,type:"shipment",primaryText:t.shipmentNumber||`SHIP-${t.id.slice(0,8)}`,secondaryText:t.customer?.name,details:[{label:"To",value:t.deliveryAddress?.city||"N/A"},...t.scheduledDate?[{label:"Date",value:new Date(t.scheduledDate).toLocaleDateString()}]:[],...t.priority?[{label:"Priority",value:t.priority}]:[]],barcodeData:t.shipmentNumber||t.id,qrData:JSON.stringify({type:"shipment",id:t.id,shipmentNumber:t.shipmentNumber,customer:t.customer?.name})};return e.jsx(Z_,{data:r,size:"medium"})}function B5e({material:t}){const r={id:t.id,type:"material",primaryText:t.name,secondaryText:t.code,details:[{label:"Cat",value:t.category?.replace(/_/g," ")||"N/A"},{label:"Unit",value:t.unitOfMeasure||"N/A"},...t.lotNumber?[{label:"Lot",value:t.lotNumber}]:[]],barcodeData:t.barcode||t.code||t.id,qrData:JSON.stringify({type:"material",id:t.id,code:t.code,name:t.name})};return e.jsx(Z_,{data:r,size:"small"})}const qR=[{value:"PLANNED",label:"Planned",group:"main"},{value:"SCHEDULED",label:"Scheduled",group:"main"},{value:"IN_PRODUCTION",label:"In Production",group:"main"},{value:"PRODUCTION_COMPLETE",label:"Production Complete",group:"main"},{value:"QC_PENDING",label:"QC Pending",group:"main"},{value:"QC_IN_PROGRESS",label:"QC In Progress",group:"main"},{value:"QC_PASSED",label:"QC Passed",group:"main"},{value:"QP_REVIEW",label:"QP Review",group:"main"},{value:"RELEASED",label:"Released",group:"main"},{value:"DISPENSING_IN_PROGRESS",label:"Dispensing",group:"main"},{value:"DISPENSED",label:"Dispensed",group:"main"},{value:"PACKED",label:"Packed",group:"main"},{value:"DISPATCHED",label:"Dispatched",group:"main"},{value:"CLOSED",label:"Closed",group:"main"},{value:"ON_HOLD",label:"On Hold",group:"exception"},{value:"REJECTED",label:"Rejected",group:"exception"},{value:"FAILED_QC",label:"QC Failed",group:"exception"},{value:"CANCELLED",label:"Cancelled",group:"exception"},{value:"DEVIATION_OPEN",label:"Deviation",group:"exception"}];function F5e(){const[t,r]=k.useState(""),[n,i]=k.useState(""),[a,s]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(!1),[x,v]=k.useState(!1),[w,C]=k.useState(null),A=pr(),T=gn(),{data:O,isLoading:D}=Ve({queryKey:["batches",t,n,a,o],queryFn:async()=>{const Z={};t&&(Z.status=t),n&&(Z.productId=n),a&&(Z.fromDate=a),o&&(Z.toDate=o);const{data:re}=await xe.get("/batches",{params:Z});return re}}),{data:M}=Ve({queryKey:["batch-metrics"],queryFn:async()=>{const{data:Z}=await xe.get("/batches/metrics/summary");return Z}}),{data:Q}=Ve({queryKey:["products"],queryFn:async()=>{const{data:Z}=await xe.get("/products");return Z}}),U=ot({mutationFn:async({id:Z,status:re})=>xe.post(`/batches/${Z}/transition`,{status:re}),onSuccess:(Z,re)=>{A.invalidateQueries({queryKey:["batches"]}),A.invalidateQueries({queryKey:["batch-metrics"]}),T.success("Status Updated",`Batch moved to ${re.status.replace(/_/g," ")}`)},onError:Z=>{const re=an(Z);T.error("Update Failed",re?.userMessage||"Failed to update batch status")}}),$=Z=>({PLANNED:{status:"IN_PRODUCTION",label:"Start"},SCHEDULED:{status:"IN_PRODUCTION",label:"Start"},IN_PRODUCTION:{status:"PRODUCTION_COMPLETE",label:"Complete"},PRODUCTION_COMPLETE:{status:"QC_PENDING",label:"To QC"},QC_PENDING:{status:"QC_IN_PROGRESS",label:"Start QC"},QC_IN_PROGRESS:{status:"QC_PASSED",label:"Pass QC"},QC_PASSED:{status:"QP_REVIEW",label:"To QP"},RELEASED:{status:"DISPENSING_IN_PROGRESS",label:"Dispense"},DISPENSING_IN_PROGRESS:{status:"DISPENSED",label:"Done"},DISPENSED:{status:"PACKED",label:"Pack"},PACKED:{status:"DISPATCHED",label:"Dispatch"},DISPATCHED:{status:"CLOSED",label:"Close"}})[Z]||null,ee=Z=>["ON_HOLD","REJECTED","FAILED_QC","CANCELLED","DEVIATION_OPEN"].includes(Z),F=O?.filter(Z=>{if(f&&!ee(Z.status))return!1;if(u){const re=u.toLowerCase();if(!Z.batchNumber.toLowerCase().includes(re)&&!Z.product?.name.toLowerCase().includes(re))return!1}return!0}),Y=()=>{r(""),i(""),s(""),l(""),d(""),p(!1)},J=t||n||a||o||u||f;return D?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Batch Management"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Track production batches through the manufacturing lifecycle"})]}),e.jsxs("button",{className:`btn ${x?"btn-primary":"btn-secondary"}`,onClick:()=>v(!x),children:[e.jsx(Wo,{size:16})," Filters ",J&&e.jsx("span",{className:"badge badge-danger",style:{marginLeft:"0.25rem"},children:"!"})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Today's Batches",value:M?.batchesToday||0,icon:e.jsx($n,{size:20}),color:"primary",onClick:()=>{Y()},selected:!t&&!f}),e.jsx(nt,{title:"Awaiting QC",value:M?.awaitingQC||0,icon:e.jsx(Wl,{size:20}),color:"warning",onClick:()=>{r("QC_PENDING"),p(!1)},selected:t==="QC_PENDING"}),e.jsx(nt,{title:"Awaiting Release",value:M?.awaitingRelease||0,icon:e.jsx(aa,{size:20}),color:"info",onClick:()=>{r("QP_REVIEW"),p(!1)},selected:t==="QP_REVIEW"}),e.jsx(nt,{title:"Exceptions",value:M?.exceptions||0,icon:e.jsx(Hr,{size:20}),color:"danger",onClick:()=>{p(!f),r("")},selected:f})]}),x&&e.jsxs("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h4",{style:{margin:0,fontSize:"0.875rem",fontWeight:600},children:"Filters"}),J&&e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:Y,children:[e.jsx(Dr,{size:14})," Clear All"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Search"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",style:{paddingLeft:"2.25rem"},placeholder:"Batch # or product...",value:u,onChange:Z=>d(Z.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:t,onChange:Z=>r(Z.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("optgroup",{label:"Main Stages",children:qR.filter(Z=>Z.group==="main").map(Z=>e.jsx("option",{value:Z.value,children:Z.label},Z.value))}),e.jsx("optgroup",{label:"Exceptions",children:qR.filter(Z=>Z.group==="exception").map(Z=>e.jsx("option",{value:Z.value,children:Z.label},Z.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsxs("select",{className:"form-select",value:n,onChange:Z=>i(Z.target.value),children:[e.jsx("option",{value:"",children:"All Products"}),Q?.map(Z=>e.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"From Date"}),e.jsx("input",{type:"date",className:"form-input",value:a,onChange:Z=>s(Z.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"To Date"}),e.jsx("input",{type:"date",className:"form-input",value:o,onChange:Z=>l(Z.target.value)})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:f,onChange:Z=>p(Z.target.checked)}),"Exceptions Only"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Batch List (",F?.length||0,")"]})}),F?.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Batch #"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Planned Start"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Orders"}),e.jsx("th",{children:"Doses"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{style:{width:"160px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:F.map(Z=>{const re=$(Z.status),de=Z.doseUnits?.length||0;return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("span",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem"},children:Z.batchNumber}),ee(Z.status)&&e.jsx(Hr,{size:14,style:{color:"var(--danger)",marginLeft:"0.25rem"}})]}),e.jsx("td",{style:{fontWeight:500},children:Z.product?.name}),e.jsx("td",{children:Ze(new Date(Z.plannedStartTime),"MMM dd HH:mm")}),e.jsx("td",{children:e.jsx(Pn,{status:Z.status,size:"sm"})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-default",children:Z.orders?.length||0})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-default",children:de})}),e.jsx("td",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:Ze(new Date(Z.updatedAt),"MMM dd HH:mm")}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",title:"Print Label",onClick:()=>C(Z),children:e.jsx(wm,{size:14})}),e.jsx(nr,{to:`/batches/${Z.id}/journey`,className:"btn btn-sm btn-outline",title:"View Journey",children:e.jsx(cz,{size:14})}),re&&!ee(Z.status)&&e.jsxs("button",{className:"btn btn-primary btn-sm",style:{minWidth:"80px"},onClick:()=>U.mutate({id:Z.id,status:re.status}),disabled:U.isPending,title:re.label,children:[e.jsx(yo,{size:14})," ",re.label]})]})})]},Z.id)})})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No batches found",message:"Batches will appear here when orders are scheduled for production",icon:"package"})})]}),w&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(null),children:e.jsxs("div",{className:"modal",style:{maxWidth:"450px"},onClick:Z=>Z.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Print Batch Label"}),e.jsx("button",{onClick:()=>C(null),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsx("div",{className:"modal-body",style:{display:"flex",justifyContent:"center"},children:e.jsx(L5e,{batch:w})})]})})]})}const UR=[{key:"pending",label:"Pending",icon:Qt},{key:"testing",label:"Testing",icon:Wl},{key:"review",label:"Review",icon:Ir},{key:"complete",label:"Complete",icon:Ft}];function WR(t){if(!t||t.length===0)return{completed:0,total:0,passed:0,failed:0};const r=t.filter(a=>a.passed!==null).length,n=t.filter(a=>a.passed===!0).length,i=t.filter(a=>a.passed===!1).length;return{completed:r,total:t.length,passed:n,failed:i}}function q5e(){const[t,r]=k.useState(null),[n,i]=k.useState("workbench"),[a,s]=k.useState({}),o=pr(),l=gn(),{formatDateTime:u}=ph(),{data:d}=Ve({queryKey:["qc-stats"],queryFn:async()=>{const{data:F}=await xe.get("/qc/stats");return F}}),{data:f,isLoading:p}=Ve({queryKey:["qc-batches"],queryFn:async()=>{const{data:F}=await xe.get("/qc/batches");return F}}),{data:x,isLoading:v}=Ve({queryKey:["qc-history"],queryFn:async()=>{const{data:F}=await xe.get("/qc/history?days=14");return F},enabled:n==="history"}),{data:w,isLoading:C}=Ve({queryKey:["batch-qc",t?.id],queryFn:async()=>{const{data:F}=await xe.get(`/qc/batches/${t.id}`);return F},enabled:!!t}),A=ot({mutationFn:async F=>xe.post(`/qc/batches/${F}/initialize`),onSuccess:()=>{o.invalidateQueries({queryKey:["qc-batches"]}),o.invalidateQueries({queryKey:["batch-qc"]}),o.invalidateQueries({queryKey:["qc-stats"]}),l.success("QC testing initialized")},onError:()=>l.error("Failed to initialize QC")}),T=ot({mutationFn:async({resultId:F,data:Y})=>xe.put(`/qc/results/${F}`,Y),onSuccess:()=>{o.invalidateQueries({queryKey:["batch-qc"]})},onError:()=>l.error("Failed to update result")}),O=ot({mutationFn:async F=>xe.post(`/qc/batches/${F}/complete`),onSuccess:F=>{o.invalidateQueries({queryKey:["qc-batches"]}),o.invalidateQueries({queryKey:["batch-qc"]}),o.invalidateQueries({queryKey:["qc-stats"]}),o.invalidateQueries({queryKey:["qc-history"]}),F.data?.passed?l.success("QC completed - All tests passed!"):l.error("QC completed - Some tests failed"),r(null)},onError:F=>{const Y=F.response?.data?.error||"Failed to complete QC";l.error(Y)}}),D=(F,Y,J)=>{T.mutate({resultId:F.id,data:{[Y]:J}})},M=[{key:"search",label:"Search",type:"search",placeholder:"Search batches..."}],Q=(n==="workbench"?f:x)?.filter(F=>{if(a.search){const Y=a.search.toLowerCase();if(!F.batchNumber.toLowerCase().includes(Y)&&!F.product?.name.toLowerCase().includes(Y))return!1}return!0}),U=w?WR(w.qcResults):null,$=w?.qcResults?.length?w?.status==="QC_PASSED"||w?.status==="FAILED_QC"?"complete":U?.completed===U?.total?"review":"testing":"pending",ee=F=>{i(F),r(null)};return p?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Quality Control"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Execute QC tests and manage batch testing workflows"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:`btn ${n==="workbench"?"btn-primary":"btn-secondary"}`,onClick:()=>ee("workbench"),children:[e.jsx(Wl,{size:16})," Workbench"]}),e.jsxs("button",{className:`btn ${n==="history"?"btn-primary":"btn-secondary"}`,onClick:()=>ee("history"),children:[e.jsx(jm,{size:16})," History"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Pending QC",value:d?.pending||0,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>i("workbench")}),e.jsx(nt,{title:"In Progress",value:d?.inProgress||0,icon:e.jsx(Wl,{size:20}),color:"info",onClick:()=>i("workbench")}),e.jsx(nt,{title:"Passed Today",value:d?.passedToday||0,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>i("history")}),e.jsx(nt,{title:"Failed Today",value:d?.failedToday||0,icon:e.jsx(ri,{size:20}),color:"danger",onClick:()=>i("history")})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:M,values:a,onChange:(F,Y)=>s(J=>({...J,[F]:Y})),onReset:()=>s({})})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:t?"1fr 1.5fr":"1fr"},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx("h3",{style:{fontWeight:600},children:n==="workbench"?`Batches Pending QC (${Q?.length||0})`:`QC History (${Q?.length||0})`})}),e.jsx("div",{style:{padding:"0",maxHeight:"60vh",overflowY:"auto"},children:(n==="workbench"?p:v)?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx("div",{className:"spinner"})}):Q?.length>0?Q.map(F=>{const Y=WR(F.qcResults);return e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",cursor:"pointer",background:t?.id===F.id?"var(--bg-secondary)":void 0,transition:"background 0.15s"},onClick:()=>r(F),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:600},children:F.batchNumber}),F.status==="FAILED_QC"&&e.jsx(Hr,{size:14,color:"var(--danger)"})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:F.product?.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[F.orders?.length||0," orders | ",u(F.plannedStartTime||F.createdAt)]}),Y.total>0&&e.jsxs("div",{style:{marginTop:"0.5rem"},children:[e.jsx("div",{style:{height:"4px",background:"var(--border)",borderRadius:"2px",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${Y.completed/Y.total*100}%`,background:Y.failed>0?"var(--danger)":"var(--success)",transition:"width 0.3s"}})}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[Y.completed,"/",Y.total," tests (",Y.passed," passed, ",Y.failed," failed)"]})]})]}),e.jsx(Pn,{status:F.status,size:"sm"})]})},F.id)}):e.jsx(fn,{title:n==="workbench"?"No batches pending QC":"No QC history found",message:n==="workbench"?"All batches have completed QC testing":"No completed QC tests in the selected period",icon:"success",variant:"compact"})})]}),t&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("h3",{style:{fontWeight:600},children:w?.batchNumber||t.batchNumber}),e.jsx(Pn,{status:w?.status||t.status})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:w?.product?.name||t.product?.name})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs(nr,{to:`/batches/${t.id}/journey`,className:"btn btn-secondary btn-sm",children:[e.jsx(os,{size:14})," Batch Journey"]}),e.jsx("button",{onClick:()=>r(null),style:{background:"none",border:"none",fontSize:"1.25rem",cursor:"pointer",color:"var(--text-muted)"},children:""})]})]}),C?e.jsx("div",{style:{padding:"3rem",textAlign:"center"},children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",marginBottom:"1.5rem",gap:"0.5rem"},children:UR.map((F,Y)=>{const J=UR.findIndex(de=>de.key===$)>Y,Z=F.key===$,re=F.icon;return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",opacity:J||Z?1:.4},children:[e.jsx("div",{style:{width:"2rem",height:"2rem",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:J?"var(--success)":Z?"var(--primary)":"var(--border)",color:J||Z?"white":"var(--text-muted)",marginBottom:"0.5rem"},children:e.jsx(re,{size:14})}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:Z?600:400},children:F.label})]},F.key)})}),w?.qcResults?.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx(sf,{size:48,color:"var(--text-muted)",style:{marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"QC testing not yet initialized"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>A.mutate(t.id),disabled:A.isPending,children:[e.jsx(yo,{size:18}),A.isPending?"Initializing...":"Start QC Testing"]})]}):e.jsxs(e.Fragment,{children:[U&&e.jsxs("div",{style:{background:"var(--bg-secondary)",borderRadius:"0.5rem",padding:"1rem",marginBottom:"1rem",display:"flex",justifyContent:"space-around"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:U.total}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Total Tests"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--success)"},children:U.passed}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Passed"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--danger)"},children:U.failed}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Failed"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--warning)"},children:U.total-U.completed}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Pending"})]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Test"}),e.jsx("th",{children:"Criteria"}),e.jsx("th",{children:"Result"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:w?.qcResults?.map(F=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:F.template?.testName}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:F.template?.testMethod})]}),e.jsxs("td",{style:{fontSize:"0.875rem"},children:[F.template?.acceptanceCriteria,F.template?.minValue!==null&&F.template?.maxValue!==null&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Range: ",F.template.minValue," - ",F.template.maxValue," ",F.template.unit]})]}),e.jsx("td",{children:n==="history"?e.jsx("span",{style:{fontWeight:500},children:F.numericResult!==null?`${F.numericResult} ${F.template?.unit||""}`:F.passed===!0?"Pass":F.passed===!1?"Fail":"-"}):F.template?.minValue!==null?e.jsx("input",{type:"number",step:"0.01",className:"form-input",style:{width:"6rem"},value:F.numericResult??"",onChange:Y=>D(F,"numericResult",parseFloat(Y.target.value))}):e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:`btn btn-sm ${F.passed===!0?"btn-success":"btn-secondary"}`,onClick:()=>D(F,"passed",!0),disabled:T.isPending,children:[e.jsx(Ft,{size:14}),"Pass"]}),e.jsxs("button",{className:`btn btn-sm ${F.passed===!1?"btn-danger":"btn-secondary"}`,onClick:()=>D(F,"passed",!1),disabled:T.isPending,children:[e.jsx(ri,{size:14}),"Fail"]})]})}),e.jsxs("td",{children:[F.passed===!0&&e.jsx("span",{className:"badge badge-success",children:"Passed"}),F.passed===!1&&e.jsx("span",{className:"badge badge-danger",children:"Failed"}),F.passed===null&&e.jsx("span",{className:"badge badge-default",children:"Pending"})]})]},F.id))})]}),n==="workbench"&&e.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end",gap:"0.5rem"},children:e.jsxs("button",{className:"btn btn-primary",onClick:()=>O.mutate(t.id),disabled:O.isPending||!!(U&&U.completed<U.total),title:U&&U.completed<U.total?"Complete all tests first":"Complete QC",children:[e.jsx(Ft,{size:18}),O.isPending?"Completing...":"Complete QC"]})})]})]})]})]})]})}const U5e=[{key:"production",label:"Production"},{key:"qc",label:"QC Testing"},{key:"qp_review",label:"QP Review"},{key:"released",label:"Released"}];function W5e(t){return{QC_PASSED:["production","qc"],QP_REVIEW:["production","qc"],RELEASED:["production","qc","qp_review","released"],REJECTED:["production","qc"]}[t]||[]}function H5e(t){return{QC_PASSED:"qp_review",QP_REVIEW:"qp_review",RELEASED:"released",REJECTED:"qp_review"}[t]||"qp_review"}function V5e(){const[t,r]=k.useState(null),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(!1),[u,d]=k.useState("pending"),[f,p]=k.useState({}),x=pr(),v=gn(),{data:w}=Ve({queryKey:["release-stats"],queryFn:async()=>{const{data:ce}=await xe.get("/batches/release/stats");return ce}}),{data:C,isLoading:A}=Ve({queryKey:["batches-for-release"],queryFn:async()=>{const{data:ce}=await xe.get("/batches",{params:{status:"QC_PASSED"}});return ce}}),{data:T,isLoading:O}=Ve({queryKey:["release-history"],queryFn:async()=>{const{data:ce}=await xe.get("/batches/release/history?days=14");return ce},enabled:u==="history"}),{data:D,isLoading:M}=Ve({queryKey:["batch-release-details",t?.id],queryFn:async()=>{const{data:ce}=await xe.get(`/batches/${t.id}`);return ce},enabled:!!t}),Q=()=>{x.invalidateQueries({queryKey:["batches-for-release"]}),x.invalidateQueries({queryKey:["batch-release-details"]}),x.invalidateQueries({queryKey:["release-stats"]}),x.invalidateQueries({queryKey:["release-history"]})},U=ot({mutationFn:async ce=>xe.post(`/batches/${t.id}/release`,{...ce,disposition:"RELEASE"}),onSuccess:()=>{Q(),i(!1),r(null),v.success("Batch Released","Batch has been successfully released for dispensing")},onError:ce=>{const ye=ce.response?.data;ye?.error==="SEGREGATION_OF_DUTIES_VIOLATION"?v.error("Segregation of Duties Violation",ye.userMessage||"You cannot release a batch you tested"):v.error("Release Failed",ye?.error||"Failed to release batch")}}),$=ot({mutationFn:async ce=>xe.post(`/batches/${t.id}/release`,{...ce,disposition:"REJECT"}),onSuccess:()=>{Q(),s(!1),r(null),v.warning("Batch Rejected","Batch has been rejected and removed from release queue")},onError:ce=>{const ye=ce.response?.data?.error||"Failed to reject batch";v.error("Rejection Failed",ye)}}),ee=ot({mutationFn:async ce=>xe.post(`/batches/${t.id}/release`,{...ce,disposition:"HOLD"}),onSuccess:()=>{Q(),l(!1),r(null),v.warning("Batch On Hold","Batch has been placed on hold for further investigation")},onError:ce=>{const ye=ce.response?.data?.error||"Failed to hold batch";v.error("Hold Failed",ye)}}),F=ce=>{ce.preventDefault();const ye=new FormData(ce.currentTarget);U.mutate({electronicSignature:ye.get("signature"),meaning:ye.get("meaning")||"I certify this batch meets all GMP requirements",reason:ye.get("reason"),releaseType:"FULL"})},Y=ce=>{ce.preventDefault();const ye=new FormData(ce.currentTarget);$.mutate({electronicSignature:ye.get("signature"),meaning:"REJECT - Batch does not meet release criteria",reason:ye.get("reason")})},J=ce=>{ce.preventDefault();const ye=new FormData(ce.currentTarget);ee.mutate({electronicSignature:ye.get("signature"),meaning:"HOLD - Pending investigation or additional review",reason:ye.get("reason")})},Z=ce=>{d(ce),r(null)},re=[{key:"search",label:"Search",type:"search",placeholder:"Search batches..."}],le=(u==="pending"?C:T)?.filter(ce=>{if(f.search){const ye=f.search.toLowerCase();if(!ce.batchNumber.toLowerCase().includes(ye)&&!ce.product?.name.toLowerCase().includes(ye))return!1}return!0}),K=D?.qcResults?.filter(ce=>ce.passed).length||0,ue=D?.qcResults?.length||0;return A?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"QP Release"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Review and release batches with qualified person approval"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:`btn ${u==="pending"?"btn-primary":"btn-secondary"}`,onClick:()=>Z("pending"),children:[e.jsx(Qt,{size:16})," Pending"]}),e.jsxs("button",{className:`btn ${u==="history"?"btn-primary":"btn-secondary"}`,onClick:()=>Z("history"),children:[e.jsx(jm,{size:16})," History"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Pending Release",value:w?.pendingRelease||0,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>Z("pending")}),e.jsx(nt,{title:"In QP Review",value:w?.qpReview||0,icon:e.jsx(Pv,{size:20}),color:"info"}),e.jsx(nt,{title:"Released Today",value:w?.releasedToday||0,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>Z("history")}),e.jsx(nt,{title:"Rejected Today",value:w?.rejectedToday||0,icon:e.jsx(ri,{size:20}),color:"danger",onClick:()=>Z("history")})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:re,values:f,onChange:(ce,ye)=>p(Se=>({...Se,[ce]:ye})),onReset:()=>p({})})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:t?"1fr 1.5fr":"1fr"},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600},children:u==="pending"?`Batches Ready for Release (${le?.length||0})`:`Release History (${le?.length||0})`})}),e.jsx("div",{style:{padding:"0",maxHeight:"60vh",overflowY:"auto"},children:(u==="pending"?A:O)?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx("div",{className:"spinner"})}):le?.length>0?le.map(ce=>e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",cursor:"pointer",background:t?.id===ce.id?"var(--bg-secondary)":void 0,transition:"background 0.15s"},onClick:()=>r(ce),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:600},children:ce.batchNumber}),ce.status==="REJECTED"&&e.jsx(Hr,{size:14,color:"var(--danger)"})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:ce.product?.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[ce.orders?.length||0," orders | ",ce.targetActivity," ",ce.activityUnit]}),u==="history"&&ce.batchReleases?.[0]&&e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Released by: ",ce.batchReleases[0].releasedBy?.email," | ",Ze(new Date(ce.batchReleases[0].releasedAt),"MMM dd HH:mm")]})]}),e.jsx(Pn,{status:ce.status,size:"sm"})]})},ce.id)):e.jsx(fn,{title:u==="pending"?"No batches pending release":"No release history found",message:u==="pending"?"All batches have been reviewed by QP":"No releases in the selected period",icon:"success",variant:"compact"})})]}),t&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("h3",{style:{fontWeight:600},children:D?.batchNumber||t.batchNumber}),e.jsx(Pn,{status:D?.status||t.status})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:D?.product?.name||t.product?.name})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs(nr,{to:`/batches/${t.id}/journey`,className:"btn btn-secondary btn-sm",children:[e.jsx(os,{size:14})," Batch Journey"]}),e.jsx("button",{onClick:()=>r(null),style:{background:"none",border:"none",fontSize:"1.25rem",cursor:"pointer",color:"var(--text-muted)"},children:""})]})]}),M?e.jsx("div",{style:{padding:"3rem",textAlign:"center"},children:e.jsx("div",{className:"spinner"})}):D?e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsx(Uz,{steps:U5e,currentStep:H5e(D.status),completedSteps:W5e(D.status),exceptionStep:D.status==="REJECTED"?"qp_review":void 0,size:"sm"})}),e.jsxs("div",{style:{background:"var(--bg-secondary)",borderRadius:"0.5rem",padding:"1rem",marginBottom:"1.5rem",display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Product"}),e.jsx("div",{style:{fontWeight:500},children:D.product?.name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Activity"}),e.jsxs("div",{style:{fontWeight:500},children:[D.actualActivity||D.targetActivity," ",D.activityUnit]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Orders"}),e.jsx("div",{style:{fontWeight:500},children:D.orders?.length||0})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"QC Tests"}),e.jsxs("div",{style:{fontWeight:500,color:K===ue?"var(--success)":"var(--danger)"},children:[K,"/",ue," Passed"]})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{fontWeight:600,marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ir,{size:16})," QC Results Summary"]}),e.jsx("div",{style:{display:"grid",gap:"0.25rem"},children:D.qcResults?.map(ce=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem 0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",fontSize:"0.875rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:500},children:ce.template?.testName}),ce.numericResult!==null&&e.jsxs("span",{style:{color:"var(--text-muted)",marginLeft:"0.5rem"},children:["(",ce.numericResult," ",ce.template?.unit,")"]})]}),e.jsx("span",{className:`badge badge-${ce.passed?"success":"danger"}`,children:ce.passed?"Pass":"Fail"})]},ce.id))})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h4",{style:{fontWeight:600,marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(kQ,{size:16})," Orders to be Released"]}),e.jsx("div",{style:{display:"grid",gap:"0.25rem"},children:D.orders?.map(ce=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem 0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",fontSize:"0.875rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:500},children:ce.orderNumber}),e.jsx("span",{style:{color:"var(--text-muted)",marginLeft:"0.5rem"},children:ce.customer?.name})]}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[ce.requestedActivity," ",ce.activityUnit]})]},ce.id))})]}),D.batchReleases?.length>0&&e.jsxs("div",{style:{background:D.status==="RELEASED"?"#f0fdf4":"#fef2f2",borderRadius:"0.5rem",padding:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:"0.5rem",color:D.status==="RELEASED"?"var(--success)":"var(--danger)"},children:[D.status==="RELEASED"?"Released":"Rejected"," by QP"]}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"QP:"})," ",D.batchReleases[0].releasedBy?.email]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",Ze(new Date(D.batchReleases[0].releasedAt),"MMM dd, yyyy HH:mm")]}),D.batchReleases[0].reason&&e.jsxs("div",{children:[e.jsx("strong",{children:"Notes:"})," ",D.batchReleases[0].reason]})]})]}),u==="pending"&&D.status==="QC_PASSED"&&e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[e.jsxs("button",{className:"btn btn-danger",style:{flex:"1 1 auto",minWidth:"80px"},onClick:()=>s(!0),children:[e.jsx(ri,{size:18}),"Reject"]}),e.jsxs("button",{className:"btn btn-warning",style:{flex:"1 1 auto",minWidth:"80px"},onClick:()=>l(!0),children:[e.jsx(Hr,{size:18}),"Hold"]}),e.jsxs("button",{className:"btn btn-success",style:{flex:"2 1 auto",minWidth:"120px"},onClick:()=>i(!0),children:[e.jsx(aa,{size:18}),"Release Batch"]})]})]}):null]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",onClick:ce=>ce.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Batch Release - Electronic Signature"}),e.jsx("button",{onClick:()=>i(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",background:"#f0fdf4",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.875rem",border:"1px solid #bbf7d0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(aa,{size:18,color:"var(--success)"}),e.jsx("strong",{style:{color:"var(--success)"},children:"Qualified Person Release"})]}),e.jsx("p",{style:{margin:0,color:"#166534"},children:"By signing below, I confirm that this batch has been manufactured and tested in accordance with GMP requirements and is fit for release."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Batch Number"}),e.jsx("input",{className:"form-input",value:D?.batchNumber||"",disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Electronic Signature (Type your full name) *"}),e.jsx("input",{name:"signature",className:"form-input",required:!0,placeholder:"Enter your full name",autoComplete:"off"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Release Notes"}),e.jsx("textarea",{name:"reason",className:"form-input",rows:3,placeholder:"Optional notes for this release"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-success",disabled:U.isPending,children:[e.jsx(Ft,{size:18}),U.isPending?"Releasing...":"Confirm Release"]})]})]})]})}),a&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:e.jsxs("div",{className:"modal",onClick:ce=>ce.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Reject Batch"}),e.jsx("button",{onClick:()=>s(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:Y,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",background:"#fef2f2",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.875rem",border:"1px solid #fecaca"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Hr,{size:18,color:"var(--danger)"}),e.jsx("strong",{style:{color:"var(--danger)"},children:"Batch Rejection"})]}),e.jsx("p",{style:{margin:0,color:"#991b1b"},children:"This action will reject the batch and prevent it from being released. Please provide a reason for the rejection."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Batch Number"}),e.jsx("input",{className:"form-input",value:D?.batchNumber||"",disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Electronic Signature (Type your full name) *"}),e.jsx("input",{name:"signature",className:"form-input",required:!0,placeholder:"Enter your full name",autoComplete:"off"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Rejection Reason *"}),e.jsx("textarea",{name:"reason",className:"form-input",rows:3,required:!0,placeholder:"Enter reason for rejection"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-danger",disabled:$.isPending,children:[e.jsx(ri,{size:18}),$.isPending?"Rejecting...":"Confirm Rejection"]})]})]})]})}),o&&e.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:e.jsxs("div",{className:"modal",onClick:ce=>ce.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Place Batch On Hold"}),e.jsx("button",{onClick:()=>l(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",background:"#fffbeb",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.875rem",border:"1px solid #fde68a"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Hr,{size:18,color:"var(--warning)"}),e.jsx("strong",{style:{color:"#b45309"},children:"Hold for Investigation"})]}),e.jsx("p",{style:{margin:0,color:"#92400e"},children:"This action will place the batch on hold pending further investigation. The batch cannot be dispensed until it is released or rejected."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Batch Number"}),e.jsx("input",{className:"form-input",value:D?.batchNumber||"",disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Electronic Signature (Type your full name) *"}),e.jsx("input",{name:"signature",className:"form-input",required:!0,placeholder:"Enter your full name",autoComplete:"off"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Reason for Hold *"}),e.jsx("textarea",{name:"reason",className:"form-input",rows:3,required:!0,placeholder:"Enter reason for placing batch on hold"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-warning",disabled:ee.isPending,children:[e.jsx(Hr,{size:18}),ee.isPending?"Holding...":"Confirm Hold"]})]})]})]})})]})}function $5e(){const[t,r]=k.useState(null),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(!1),[u,d]=k.useState(!1),[f,p]=k.useState(null),[x,v]=k.useState({}),[w,C]=k.useState(null),A=k.useRef(null),T=pr(),O=gn(),{formatDateOnly:D,formatTimeOnly:M,formatDateTime:Q}=ph();k.useEffect(()=>{const W=oe=>{A.current&&!A.current.contains(oe.target)&&p(null)};return f&&document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[f]);const{data:U,isLoading:$}=Ve({queryKey:["shipments",x],queryFn:async()=>{const{data:W}=await xe.get("/shipments",{params:x});return W}}),{data:ee}=Ve({queryKey:["released-orders"],queryFn:async()=>{const{data:W}=await xe.get("/orders",{params:{status:"RELEASED"}});return W}}),{data:F}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:W}=await xe.get("/customers");return W}}),{data:Y}=Ve({queryKey:["drivers"],queryFn:async()=>{const{data:W}=await xe.get("/drivers");return W}}),J=ot({mutationFn:async W=>xe.post("/shipments",W),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),T.invalidateQueries({queryKey:["released-orders"]}),i(!1),O.success("Shipment Created","New shipment has been created successfully")},onError:W=>{const oe=an(W);O.error("Creation Failed",oe?.userMessage||"Failed to create shipment")}}),Z=ot({mutationFn:async({id:W,data:oe})=>xe.post(`/shipments/${W}/dispatch`,oe),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),p(null),O.success("Dispatched","Shipment is now in transit")},onError:W=>{const oe=an(W);O.error("Dispatch Failed",oe?.userMessage||"Failed to dispatch shipment")}}),re=ot({mutationFn:async({id:W,data:oe})=>xe.post(`/shipments/${W}/deliver`,oe),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),s(!1),r(null),O.success("Delivered","Shipment marked as delivered")},onError:W=>{const oe=an(W);O.error("Delivery Failed",oe?.userMessage||"Failed to confirm delivery")}}),de=ot({mutationFn:async({id:W,data:oe})=>xe.post(`/shipments/${W}/assign-driver`,oe),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),l(!1),r(null),O.success("Driver Assigned","Driver has been assigned to the shipment")},onError:W=>{const oe=an(W);O.error("Assignment Failed",oe?.userMessage||"Failed to assign driver")}}),le=ot({mutationFn:async({id:W,data:oe})=>xe.post(`/shipments/${W}/schedule`,oe),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),d(!1),r(null),O.success("Scheduled","Shipment schedule updated")},onError:W=>{const oe=an(W);O.error("Schedule Failed",oe?.userMessage||"Failed to update schedule")}}),K=ot({mutationFn:async W=>xe.post(`/shipments/${W}/mark-packed`),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),p(null),O.success("Packed","Shipment marked as packed")},onError:W=>{const oe=an(W);O.error("Failed",oe?.userMessage||"Failed to mark as packed")}}),ue=ot({mutationFn:async({id:W,reason:oe})=>xe.post(`/shipments/${W}/cancel`,{reason:oe}),onSuccess:()=>{T.invalidateQueries({queryKey:["shipments"]}),p(null),O.success("Cancelled","Shipment has been cancelled")},onError:W=>{const oe=an(W);O.error("Cancel Failed",oe?.userMessage||"Failed to cancel shipment")}}),ce=W=>{W.preventDefault();const oe=new FormData(W.currentTarget),ge=Array.from(oe.getAll("orderIds"));J.mutate({customerId:oe.get("customerId"),courierName:oe.get("courierName"),vehicleInfo:oe.get("vehicleInfo"),scheduledDepartureTime:oe.get("scheduledDepartureTime"),expectedArrivalTime:oe.get("expectedArrivalTime"),orderIds:ge})},ye=W=>{W.preventDefault();const oe=new FormData(W.currentTarget);re.mutate({id:t.id,data:{receiverName:oe.get("receiverName"),notes:oe.get("notes")}})},Se=W=>{W.preventDefault();const oe=new FormData(W.currentTarget);de.mutate({id:t.id,data:{driverId:oe.get("driverId"),scheduledPickupAt:oe.get("scheduledPickupAt"),scheduledDeliveryAt:oe.get("scheduledDeliveryAt"),driverNotes:oe.get("driverNotes"),priority:oe.get("priority")}})},V=W=>{W.preventDefault();const oe=new FormData(W.currentTarget);le.mutate({id:t.id,data:{scheduledPickupAt:oe.get("scheduledPickupAt"),scheduledDeliveryAt:oe.get("scheduledDeliveryAt"),priority:oe.get("priority")}})},X=[{key:"search",label:"Search",type:"search",placeholder:"Search shipments..."},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},{value:"PACKED",label:"Packed"},{value:"ASSIGNED_TO_DRIVER",label:"Assigned"},{value:"ACCEPTED_BY_DRIVER",label:"Accepted"},{value:"PICKED_UP",label:"Picked Up"},{value:"IN_TRANSIT",label:"In Transit"},{value:"ARRIVED",label:"Arrived"},{value:"DELIVERED",label:"Delivered"},{value:"DELIVERY_FAILED",label:"Failed"},{value:"DELAYED",label:"Delayed"}]},{key:"unassigned",label:"Unassigned Only",type:"select",options:[{value:"",label:"All"},{value:"true",label:"Unassigned"}]},{key:"priority",label:"Priority",type:"select",options:[{value:"",label:"All Priorities"},{value:"NORMAL",label:"Normal"},{value:"URGENT",label:"Urgent"}]}],se={total:U?.length||0,packed:U?.filter(W=>W.status==="PACKED").length||0,assigned:U?.filter(W=>["ASSIGNED_TO_DRIVER","ACCEPTED_BY_DRIVER"].includes(W.status)).length||0,inTransit:U?.filter(W=>["PICKED_UP","IN_TRANSIT","ARRIVED"].includes(W.status)).length||0,delivered:U?.filter(W=>W.status==="DELIVERED").length||0,issues:U?.filter(W=>["DELAYED","DELIVERY_FAILED"].includes(W.status)).length||0};return $?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Logistics & Shipments"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage deliveries, assign drivers, and track shipment status"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs(nr,{to:"/drivers",className:"btn btn-secondary",children:[e.jsx(Np,{size:16}),"Manage Drivers"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>i(!0),children:[e.jsx(cn,{size:16}),"Create Shipment"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(6, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total",value:se.total,icon:e.jsx(dn,{size:20}),color:"primary",onClick:()=>v({}),selected:!x.status&&!x.unassigned}),e.jsx(nt,{title:"Packed",value:se.packed,icon:e.jsx(Rr,{size:20}),color:"warning",onClick:()=>v({status:"PACKED"}),selected:x.status==="PACKED"}),e.jsx(nt,{title:"Assigned",value:se.assigned,icon:e.jsx(Np,{size:20}),color:"info",onClick:()=>v({status:"ASSIGNED_TO_DRIVER"}),selected:x.status==="ASSIGNED_TO_DRIVER"}),e.jsx(nt,{title:"In Transit",value:se.inTransit,icon:e.jsx(Qi,{size:20}),color:"primary",onClick:()=>v({status:"IN_TRANSIT"}),selected:x.status==="IN_TRANSIT"}),e.jsx(nt,{title:"Delivered",value:se.delivered,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>v({status:"DELIVERED"}),selected:x.status==="DELIVERED"}),e.jsx(nt,{title:"Issues",value:se.issues,icon:e.jsx(Hr,{size:20}),color:"danger",onClick:()=>v({status:"DELAYED"}),selected:x.status==="DELAYED"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:X,values:x,onChange:(W,oe)=>v(ge=>({...ge,[W]:oe})),onReset:()=>v({})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Shipment List (",U?.length||0,")"]})}),U?.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Shipment #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Driver"}),e.jsx("th",{children:"Orders"}),e.jsx("th",{children:"Scheduled"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"120px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:U.map(W=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(nr,{to:`/shipments/${W.id}`,style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem",color:"var(--primary)"},children:W.shipmentNumber})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:W.customer?.nameEn||W.customer?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W.customer?.city})]}),e.jsx("td",{children:W.driver?e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:W.driver.fullName}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W.driver.vehiclePlateNo})]}):e.jsx("span",{className:"badge badge-warning",style:{fontSize:"0.6875rem"},children:"Unassigned"})}),e.jsx("td",{children:e.jsxs("span",{className:"badge badge-default",children:[W.orders?.length||0," orders"]})}),e.jsx("td",{children:W.scheduledDeliveryAt?e.jsxs("div",{children:[e.jsx("div",{children:D(W.scheduledDeliveryAt)}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:M(W.scheduledDeliveryAt)})]}):W.scheduledDepartureTime?e.jsxs("div",{children:[e.jsx("div",{children:Q(W.scheduledDepartureTime)}),W.expectedArrivalTime&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["ETA: ",M(W.expectedArrivalTime)]})]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"Not scheduled"})}),e.jsx("td",{children:W.priority==="URGENT"?e.jsx("span",{className:"badge badge-danger",children:"Urgent"}):e.jsx("span",{className:"badge badge-default",children:"Normal"})}),e.jsx("td",{children:e.jsx(Pn,{status:W.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",position:"relative"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",title:"Print Label",onClick:()=>C(W),children:e.jsx(wm,{size:14})}),e.jsx(nr,{to:`/shipments/${W.id}`,className:"btn btn-sm btn-outline",title:"View Details",children:e.jsx(os,{size:14})}),e.jsxs("div",{style:{position:"relative"},ref:f===W.id?A:null,children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:oe=>{oe.stopPropagation(),p(f===W.id?null:W.id)},children:e.jsx(ez,{size:14})}),f===W.id&&e.jsxs("div",{className:"dropdown-menu",onClick:oe=>oe.stopPropagation(),children:[["DRAFT","READY_TO_PACK","PACKED","ASSIGNED_TO_DRIVER","DELIVERY_FAILED"].includes(W.status)&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{r(W),l(!0),p(null)},children:[e.jsx(Np,{size:14}),W.driver?"Reassign Driver":"Assign Driver"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>{r(W),d(!0),p(null)},children:[e.jsx($n,{size:14}),"Schedule"]}),["DRAFT","READY_TO_PACK"].includes(W.status)&&e.jsxs("button",{className:"dropdown-item",onClick:()=>K.mutate(W.id),children:[e.jsx(Rr,{size:14}),"Mark Packed"]}),W.status==="PACKED"&&W.driver&&e.jsxs("button",{className:"dropdown-item",onClick:()=>Z.mutate({id:W.id,data:{}}),children:[e.jsx(Qi,{size:14}),"Dispatch"]}),["ARRIVED","IN_TRANSIT"].includes(W.status)&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{r(W),s(!0),p(null)},children:[e.jsx(Ft,{size:14}),"Mark Delivered"]}),!["DELIVERED","CANCELLED"].includes(W.status)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item danger",onClick:()=>{confirm("Are you sure you want to cancel this shipment?")&&ue.mutate({id:W.id,reason:"Cancelled by user"})},children:[e.jsx(Dr,{size:14}),"Cancel Shipment"]})]})]})]})]})})]},W.id))})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No shipments found",message:"Create a shipment to start delivering orders",icon:"package"})})]}),f&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:999},onClick:()=>p(null)}),n&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"600px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Create Shipment"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(!1),children:""})]}),e.jsxs("form",{onSubmit:ce,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Customer *"}),e.jsxs("select",{name:"customerId",className:"form-select",required:!0,children:[e.jsx("option",{value:"",children:"Select Customer"}),F?.map(W=>e.jsxs("option",{value:W.id,children:[W.nameEn||W.name," - ",W.city]},W.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Orders to Ship"}),e.jsxs("div",{style:{maxHeight:"150px",overflow:"auto",border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"0.5rem"},children:[ee?.map(W=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0"},children:[e.jsx("input",{type:"checkbox",name:"orderIds",value:W.id}),e.jsxs("span",{children:[W.orderNumber," - ",W.product?.name]})]},W.id)),(!ee||ee.length===0)&&e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"No released orders available"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Courier Name"}),e.jsx("input",{type:"text",name:"courierName",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Info"}),e.jsx("input",{type:"text",name:"vehicleInfo",className:"form-input",placeholder:"e.g., Van ABC-123"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Departure Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledDepartureTime",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Expected Arrival"}),e.jsx("input",{type:"datetime-local",name:"expectedArrivalTime",className:"form-input"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:J.isPending,children:J.isPending?"Creating...":"Create Shipment"})]})]})]})}),o&&t&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Assign Driver"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>{l(!1),r(null)},children:""})]}),e.jsxs("form",{onSubmit:Se,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1rem"},children:[e.jsx("div",{style:{fontWeight:500},children:t.shipmentNumber}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[t.customer?.nameEn||t.customer?.name,"  ",t.orders?.length||0," orders"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Driver *"}),e.jsxs("select",{name:"driverId",className:"form-select",required:!0,children:[e.jsx("option",{value:"",children:"Select Driver"}),Y?.filter(W=>W.status==="ACTIVE").map(W=>e.jsxs("option",{value:W.id,children:[W.fullName," - ",W.vehicleType," (",W.vehiclePlateNo,")",W.inTransit>0&&`  ${W.inTransit} in transit`]},W.id))]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Pickup Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledPickupAt",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledDeliveryAt",className:"form-input"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Priority"}),e.jsxs("select",{name:"priority",className:"form-select",defaultValue:t.priority||"NORMAL",children:[e.jsx("option",{value:"NORMAL",children:"Normal"}),e.jsx("option",{value:"URGENT",children:"Urgent"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes for Driver"}),e.jsx("textarea",{name:"driverNotes",className:"form-textarea",rows:2,placeholder:"Special instructions for the driver..."})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(!1),r(null)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:de.isPending,children:de.isPending?"Assigning...":"Assign Driver"})]})]})]})}),u&&t&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Schedule Shipment"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>{d(!1),r(null)},children:""})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1rem"},children:[e.jsx("div",{style:{fontWeight:500},children:t.shipmentNumber}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:t.customer?.nameEn||t.customer?.name})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Pickup Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledPickupAt",className:"form-input",defaultValue:t.scheduledPickupAt?Ze(new Date(t.scheduledPickupAt),"yyyy-MM-dd'T'HH:mm"):""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledDeliveryAt",className:"form-input",defaultValue:t.scheduledDeliveryAt?Ze(new Date(t.scheduledDeliveryAt),"yyyy-MM-dd'T'HH:mm"):""})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Priority"}),e.jsxs("select",{name:"priority",className:"form-select",defaultValue:t.priority||"NORMAL",children:[e.jsx("option",{value:"NORMAL",children:"Normal"}),e.jsx("option",{value:"URGENT",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{d(!1),r(null)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:le.isPending,children:le.isPending?"Saving...":"Save Schedule"})]})]})]})}),a&&t&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Confirm Delivery"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>{s(!1),r(null)},children:""})]}),e.jsxs("form",{onSubmit:ye,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{backgroundColor:"var(--bg-secondary)",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1rem"},children:[e.jsx("div",{style:{fontWeight:500},children:t.shipmentNumber}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[t.customer?.nameEn||t.customer?.name,"  ",t.orders?.length||0," orders"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Receiver Name *"}),e.jsx("input",{type:"text",name:"receiverName",className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Notes"}),e.jsx("textarea",{name:"notes",className:"form-textarea",rows:3,placeholder:"Any notes about the delivery..."})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{s(!1),r(null)},children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-success",disabled:re.isPending,children:[e.jsx(Ft,{size:16}),re.isPending?"Confirming...":"Confirm Delivery"]})]})]})]})}),w&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(null),children:e.jsxs("div",{className:"modal",style:{maxWidth:"450px"},onClick:W=>W.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Print Shipment Label"}),e.jsx("button",{onClick:()=>C(null),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsx("div",{className:"modal-body",style:{display:"flex",justifyContent:"center"},children:e.jsx(z5e,{shipment:w})})]})})]})}function G5e(){const[t,r]=k.useState(!1),[n,i]=k.useState(null),[a,s]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState({}),[f,p]=k.useState(null),x=pr(),v=gn(),{data:w,isLoading:C}=Ve({queryKey:["users"],queryFn:async()=>{const{data:Y}=await xe.get("/users");return Y}}),{data:A}=Ve({queryKey:["roles"],queryFn:async()=>{const{data:Y}=await xe.get("/roles");return Y}}),{data:T}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:Y}=await xe.get("/customers");return Y}}),O=A?.find(Y=>Y.id===a)?.name==="Customer",D=A?.find(Y=>Y.id===a)?.name==="Driver";k.useEffect(()=>{n?(s(n.roleId||""),l(n.customerId||"")):(s(""),l(""))},[n]);const M=ot({mutationFn:async Y=>n?xe.put(`/users/${n.id}`,Y):xe.post("/users",Y),onSuccess:()=>{x.invalidateQueries({queryKey:["users"]}),r(!1),i(null),v.success("Success",n?"User updated successfully":"User created successfully")},onError:Y=>{v.error("Error",Y.response?.data?.error||"Failed to save user")}}),Q=Y=>{Y.preventDefault();const J=new FormData(Y.currentTarget),Z=J.get("roleId"),re=J.get("customerId");if(A?.find(le=>le.id===Z)?.name==="Customer"&&!re){v.error("Customer Required","Users with Customer role must be linked to a customer record.");return}M.mutate({email:J.get("email"),password:J.get("password")||void 0,firstName:J.get("firstName"),lastName:J.get("lastName"),phone:J.get("phone"),roleId:Z,customerId:re||null,isActive:J.get("isActive")==="true"})},U=[{key:"search",label:"Search",type:"search",placeholder:"Search name, email, phone..."},{key:"role",label:"Role",type:"select",options:[{value:"",label:"All Roles"},...A?.map(Y=>({value:Y.id,label:Y.name}))||[]]},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}]},{key:"customerLinked",label:"Customer Link",type:"select",options:[{value:"",label:"All"},{value:"linked",label:"Linked to Customer"},{value:"internal",label:"Internal Users"}]}],$=w?.filter(Y=>{if(u.role&&Y.roleId!==u.role||u.status==="active"&&!Y.isActive||u.status==="inactive"&&Y.isActive||u.customerLinked==="linked"&&!Y.customerId||u.customerLinked==="internal"&&Y.customerId||f==="active"&&!Y.isActive||f==="inactive"&&Y.isActive||f==="admins"&&Y.role?.name!=="Admin"||f==="customers"&&Y.role?.name!=="Customer"||f==="drivers"&&Y.role?.name!=="Driver")return!1;if(u.search){const J=u.search.toLowerCase();if(![Y.firstName,Y.lastName,`${Y.firstName} ${Y.lastName}`,Y.email,Y.phone,Y.role?.name,Y.customer?.name].some(re=>re?.toLowerCase().includes(J)))return!1}return!0}),ee={total:w?.length||0,active:w?.filter(Y=>Y.isActive).length||0,inactive:w?.filter(Y=>!Y.isActive).length||0,admins:w?.filter(Y=>Y.role?.name==="Admin").length||0,customers:w?.filter(Y=>Y.role?.name==="Customer").length||0,drivers:w?.filter(Y=>Y.role?.name==="Driver").length||0},F=Y=>{p(f===Y?null:Y)};return C?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"User Management"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage system users, roles, and customer access"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>r(!0),children:[e.jsx(cn,{size:16}),"Add User"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Users",value:ee.total,icon:e.jsx(dc,{size:20}),color:"primary",onClick:()=>p(null),selected:f===null}),e.jsx(nt,{title:"Active",value:ee.active,icon:e.jsx(WC,{size:20}),color:"success",onClick:()=>F("active"),selected:f==="active"}),e.jsx(nt,{title:"Inactive",value:ee.inactive,icon:e.jsx(v8,{size:20}),color:"danger",onClick:()=>F("inactive"),selected:f==="inactive"}),e.jsx(nt,{title:"Admins",value:ee.admins,icon:e.jsx(aa,{size:20}),color:"info",onClick:()=>F("admins"),selected:f==="admins"}),e.jsx(nt,{title:"Customers",value:ee.customers,icon:e.jsx(Lp,{size:20}),color:"warning",onClick:()=>F("customers"),selected:f==="customers"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:U,values:u,onChange:(Y,J)=>d(Z=>({...Z,[Y]:J})),onReset:()=>{d({}),p(null)}})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["User List (",$?.length||0,")"]})}),$?.length>0?e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"table",style:{marginBottom:0,minWidth:"900px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Linked Customer"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"80px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:$.map(Y=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsxs("div",{style:{width:"2.25rem",height:"2.25rem",borderRadius:"50%",background:Y.isActive?"var(--primary)":"var(--text-muted)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.8125rem"},children:[Y.firstName?.[0],Y.lastName?.[0]]}),e.jsx("div",{children:e.jsxs("div",{style:{fontWeight:500},children:[Y.firstName," ",Y.lastName]})})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.875rem"},children:[e.jsx(uc,{size:14,style:{color:"var(--text-muted)"}}),Y.email]})}),e.jsx("td",{children:Y.phone?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.875rem"},children:[e.jsx(vo,{size:14,style:{color:"var(--text-muted)"}}),Y.phone]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"-"})}),e.jsx("td",{children:e.jsxs("span",{className:`badge ${Y.role?.name==="Admin"?"badge-primary":Y.role?.name==="Customer"?"badge-warning":Y.role?.name==="Driver"?"badge-info":"badge-secondary"}`,children:[Y.role?.name==="Admin"&&e.jsx(aa,{size:12,style:{marginRight:"0.25rem"}}),Y.role?.name==="Customer"&&e.jsx(Lp,{size:12,style:{marginRight:"0.25rem"}}),Y.role?.name==="Driver"&&e.jsx(dn,{size:12,style:{marginRight:"0.25rem"}}),Y.role?.name]})}),e.jsx("td",{children:Y.customer?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(p8,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:Y.customer.nameEn||Y.customer.name})]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"Internal"})}),e.jsx("td",{children:Y.isActive?e.jsxs("span",{className:"badge badge-success",children:[e.jsx(WC,{size:12,style:{marginRight:"0.25rem"}}),"Active"]}):e.jsxs("span",{className:"badge badge-danger",children:[e.jsx(v8,{size:12,style:{marginRight:"0.25rem"}}),"Inactive"]})}),e.jsx("td",{children:e.jsx("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>{i(Y),r(!0)},title:"Edit User",children:e.jsx(ma,{size:14})})})})]},Y.id))})]})}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No users found",message:"Add your first user to get started",icon:"user"})})]}),t&&e.jsx("div",{className:"modal-overlay",onClick:()=>r(!1),children:e.jsxs("div",{className:"modal",onClick:Y=>Y.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:n?"Edit User":"Add User"}),e.jsx("button",{onClick:()=>{r(!1),i(null)},style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"grid grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"First Name *"}),e.jsx("input",{name:"firstName",className:"form-input",defaultValue:n?.firstName,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Last Name *"}),e.jsx("input",{name:"lastName",className:"form-input",defaultValue:n?.lastName,required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email *"}),e.jsx("input",{name:"email",type:"email",className:"form-input",defaultValue:n?.email,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:n?"New Password (leave blank to keep)":"Password *"}),e.jsx("input",{name:"password",type:"password",className:"form-input",required:!n})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{name:"phone",className:"form-input",defaultValue:n?.phone})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Role *"}),e.jsxs("select",{name:"roleId",className:"form-select",value:a,onChange:Y=>s(Y.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Role"}),A?.map(Y=>e.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(p8,{size:14}),"Linked Customer ",O&&e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]})}),e.jsxs("select",{name:"customerId",className:"form-select",value:o,onChange:Y=>l(Y.target.value),required:O,style:O&&!o?{borderColor:"var(--warning)"}:{},children:[e.jsx("option",{value:"",children:"None (Internal User)"}),T?.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.nameEn||Y.name," (",Y.code,")"]},Y.id))]}),O&&!o&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.5rem",padding:"0.5rem 0.75rem",backgroundColor:"rgba(251, 191, 36, 0.1)",borderRadius:"var(--radius)",fontSize:"0.75rem",color:"var(--warning)"},children:[e.jsx(Hr,{size:14}),"Customer role requires linking to a customer record"]}),!O&&!D&&o&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:"Note: Only Customer role users can access the customer portal"})]}),n&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{name:"isActive",className:"form-select",defaultValue:n?.isActive?"true":"false",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{r(!1),i(null)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:M.isPending,children:M.isPending?"Saving...":"Save User"})]})]})]})})]})}const HR=["#2563eb","#22c55e","#f59e0b","#ef4444","#8b5cf6","#06b6d4"];function K5e(){const[t,r]=k.useState({fromDate:Ze(HA(new Date,7),"yyyy-MM-dd"),toDate:Ze(new Date,"yyyy-MM-dd")}),{data:n}=Ve({queryKey:["daily-production",t],queryFn:async()=>{const{data:l}=await xe.get("/reports/daily-production",{params:t});return l}}),{data:i}=Ve({queryKey:["on-time-delivery",t],queryFn:async()=>{const{data:l}=await xe.get("/reports/on-time-delivery",{params:t});return l}}),{data:a}=Ve({queryKey:["qc-pass-rate",t],queryFn:async()=>{const{data:l}=await xe.get("/reports/qc-pass-rate",{params:t});return l}}),{data:s}=Ve({queryKey:["capacity-utilization",t],queryFn:async()=>{const{data:l}=await xe.get("/reports/capacity-utilization",{params:t});return l}}),{data:o}=Ve({queryKey:["order-turnaround",t],queryFn:async()=>{const{data:l}=await xe.get("/reports/order-turnaround",{params:t});return l}});return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"Reports & Analytics"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx($n,{size:18,color:"var(--text-muted)"}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto"},value:t.fromDate,onChange:l=>r({...t,fromDate:l.target.value})}),e.jsx("span",{children:"to"}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto"},value:t.toDate,onChange:l=>r({...t,toDate:l.target.value})})]})]}),e.jsxs("div",{className:"grid grid-4",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(dn,{size:20,color:"var(--primary)"}),e.jsx("span",{className:"stat-label",children:"On-Time Delivery"})]}),e.jsxs("div",{className:"stat-value",children:[i?.onTimeRate||0,"%"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[i?.onTime||0," of ",i?.totalDelivered||0," deliveries"]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Ft,{size:20,color:"var(--success)"}),e.jsx("span",{className:"stat-label",children:"QC Pass Rate"})]}),e.jsxs("div",{className:"stat-value",children:[a?.passRate||0,"%"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[a?.passed||0," passed, ",a?.failed||0," failed"]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Qt,{size:20,color:"var(--warning)"}),e.jsx("span",{className:"stat-label",children:"Avg Turnaround"})]}),e.jsxs("div",{className:"stat-value",children:[o?.averageTurnaroundHours||0,"h"]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Order to delivery"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(r0,{size:20,color:"var(--info)"}),e.jsx("span",{className:"stat-label",children:"Total Orders"})]}),e.jsx("div",{className:"stat-value",children:o?.totalOrders||0}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivered in period"})]})]}),e.jsxs("div",{className:"grid grid-2",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600},children:"Daily Production Summary"})}),e.jsx("div",{style:{padding:"1.5rem",height:"300px"},children:n?.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Dg,{data:n,children:[e.jsx(Qu,{strokeDasharray:"3 3"}),e.jsx(Yu,{dataKey:"date",tickFormatter:l=>Ze(new Date(l),"MMM dd")}),e.jsx(nu,{}),e.jsx(kc,{}),e.jsx(tf,{dataKey:"totalBatches",fill:"#2563eb",name:"Batches"}),e.jsx(tf,{dataKey:"totalOrders",fill:"#22c55e",name:"Orders"})]})}):e.jsx("div",{className:"empty-state",children:"No production data for this period"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600},children:"QC Pass Rate by Product"})}),e.jsx("div",{style:{padding:"1.5rem",height:"300px"},children:a?.byProduct&&Object.keys(a.byProduct).length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Pg,{children:[e.jsx(Tp,{data:Object.entries(a.byProduct).map(([l,u])=>({name:l,value:u.passed})),cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:u})=>`${l} (${(u*100).toFixed(0)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:Object.entries(a.byProduct).map((l,u)=>e.jsx(Ju,{fill:HR[u%HR.length]},`cell-${u}`))}),e.jsx(kc,{})]})}):e.jsx("div",{className:"empty-state",children:"No QC data for this period"})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600},children:"Capacity Utilization"})}),e.jsx("div",{style:{padding:"0"},children:s?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Equipment"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Batches"}),e.jsx("th",{children:"Minutes Used"}),e.jsx("th",{children:"Utilization"})]})}),e.jsx("tbody",{children:s.map(l=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:l.equipment}),e.jsx("td",{children:l.type}),e.jsx("td",{children:l.batchCount}),e.jsxs("td",{children:[l.minutesUsed.toFixed(0)," min"]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"100px",height:"8px",background:"var(--bg-tertiary)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${l.utilizationPercent}%`,height:"100%",background:parseFloat(l.utilizationPercent)>80?"var(--success)":"var(--primary)",borderRadius:"4px"}})}),e.jsxs("span",{children:[l.utilizationPercent,"%"]})]})})]},l.equipment))})]}):e.jsx("div",{className:"empty-state",children:"No capacity data for this period"})})]})]})}const Jd=["#2563eb","#22c55e","#f59e0b","#ef4444","#8b5cf6","#06b6d4"],GS={inventory:YL,production:lu,orders:Fo,quality:sf,dispensing:Rr,logistics:dn,finance:td,customers:Ts,products:Rr,planner:$n,payments:Ul,users:dc,audit:Ir},Q5e={inventory:"primary",production:"warning",orders:"info",quality:"success",dispensing:"primary",logistics:"info",finance:"success",customers:"primary",products:"default",planner:"warning",payments:"success",users:"info",audit:"default"};function Y5e(){const t=gn(),[r,n]=k.useState("dashboard"),[i,a]=k.useState(null),[s,o]=k.useState(null),[l,u]=k.useState({}),[d,f]=k.useState(1),[p,x]=k.useState(!0),[v,w]=k.useState(null),[C,A]=k.useState({fromDate:Ze(HA(new Date,7),"yyyy-MM-dd"),toDate:Ze(new Date,"yyyy-MM-dd")}),{data:T=[]}=Ve({queryKey:["report-categories"],queryFn:async()=>{const{data:be}=await xe.get("/reports/enterprise/categories");return be}}),{data:O=[]}=Ve({queryKey:["reports-list",i],queryFn:async()=>{const be=i?`/reports/enterprise/list?category=${i}`:"/reports/enterprise/list",{data:Le}=await xe.get(be);return Le}}),{data:D}=Ve({queryKey:["report-definition",s],queryFn:async()=>{const{data:be}=await xe.get(`/reports/enterprise/${s}/definition`);return be},enabled:!!s}),{data:M,isLoading:Q,refetch:U}=Ve({queryKey:["report-data",s,l,d],queryFn:async()=>{const{data:be}=await xe.post(`/reports/enterprise/${s}/data`,{filters:l,page:d,pageSize:25});return be},enabled:!!s}),{data:$}=Ve({queryKey:["daily-production",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/daily-production",{params:C});return be},enabled:r==="dashboard"}),{data:ee}=Ve({queryKey:["on-time-delivery",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/on-time-delivery",{params:C});return be},enabled:r==="dashboard"}),{data:F}=Ve({queryKey:["qc-pass-rate",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/qc-pass-rate",{params:C});return be},enabled:r==="dashboard"}),{data:Y}=Ve({queryKey:["capacity-utilization",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/capacity-utilization",{params:C});return be},enabled:r==="dashboard"}),{data:J}=Ve({queryKey:["order-turnaround",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/order-turnaround",{params:C});return be},enabled:r==="dashboard"}),{data:Z=[]}=Ve({queryKey:["quick-insights-order-status",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/quick-insights/order-status",{params:C});return be},enabled:r==="dashboard"}),{data:re=[]}=Ve({queryKey:["quick-insights-batch-status",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/quick-insights/batch-status",{params:C});return be},enabled:r==="dashboard"}),{data:de=[]}=Ve({queryKey:["quick-insights-top-products",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/quick-insights/top-products",{params:{...C,limit:5}});return be},enabled:r==="dashboard"}),{data:le=[]}=Ve({queryKey:["quick-insights-top-customers",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/quick-insights/top-customers",{params:{...C,limit:5}});return be},enabled:r==="dashboard"}),{data:K=[]}=Ve({queryKey:["quick-insights-invoice-trend",C],queryFn:async()=>{const{data:be}=await xe.get("/reports/quick-insights/invoice-trend",{params:C});return be},enabled:r==="dashboard"}),ue=O.reduce((be,Le)=>(be[Le.category]||(be[Le.category]=[]),be[Le.category].push(Le),be),{}),ce=(be,Le)=>{u(ke=>({...ke,[be]:Le}))},ye=()=>{u({}),f(1)},Se=async be=>{if(s){w(be);try{const Le=await xe.post(`/reports/enterprise/${s}/export/${be}`,{filters:l},{responseType:"blob"}),ke=new Blob([Le.data],{type:be==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"application/pdf"}),He=window.URL.createObjectURL(ke),Je=document.createElement("a");Je.href=He,Je.download=`${s}-${new Date().toISOString().slice(0,10)}.${be==="excel"?"xlsx":"pdf"}`,document.body.appendChild(Je),Je.click(),window.URL.revokeObjectURL(He),document.body.removeChild(Je),t.success("Export Complete",`Report exported to ${be.toUpperCase()}`)}catch{t.error("Export Failed",`Failed to export report to ${be.toUpperCase()}`)}finally{w(null)}}},V=(be,Le)=>{if(be==null)return"-";switch(Le){case"date":return new Date(be).toLocaleDateString();case"datetime":return new Date(be).toLocaleString();case"currency":return`SAR ${Number(be).toLocaleString(void 0,{minimumFractionDigits:2})}`;case"number":return Number(be).toLocaleString();case"percent":return`${be}%`;case"boolean":return be?"Yes":"No";default:return String(be)}},X=(be,Le)=>Le&&Le[be]?Le[be]:{ACTIVE:"success",APPROVED:"success",COMPLETED:"success",DELIVERED:"success",PENDING:"warning",IN_PROGRESS:"warning",DRAFT:"default",CANCELLED:"danger",REJECTED:"danger",FAILED:"danger",EXPIRED:"danger"}[be]||"default",se=be=>{s===be?o(null):(o(be),u({}),f(1))},W=be=>{i===be?(a(null),o(null)):(a(be),o(null),u({}))},oe=i?ue[i]||[]:[],ge=T.find(be=>be.id===i)?.name||"";return e.jsxs("div",{children:[e.jsx(Ad,{title:"Enterprise Reporting Center",subtitle:"Analytics dashboard and comprehensive reports across all business areas"}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem",marginBottom:"1.5rem",borderBottom:"1px solid var(--border)",paddingBottom:"0"},children:[e.jsxs("button",{onClick:()=>{n("dashboard"),a(null),o(null)},style:{padding:"0.75rem 1.25rem",border:"none",background:"transparent",cursor:"pointer",fontSize:"0.9375rem",fontWeight:500,color:r==="dashboard"?"var(--primary)":"var(--text-muted)",borderBottom:r==="dashboard"?"2px solid var(--primary)":"2px solid transparent",marginBottom:"-1px",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s"},children:[e.jsx(e2,{size:18}),"Analytics Dashboard"]}),e.jsxs("button",{onClick:()=>{n("reports"),a(null),o(null)},style:{padding:"0.75rem 1.25rem",border:"none",background:"transparent",cursor:"pointer",fontSize:"0.9375rem",fontWeight:500,color:r==="reports"?"var(--primary)":"var(--text-muted)",borderBottom:r==="reports"?"2px solid var(--primary)":"2px solid transparent",marginBottom:"-1px",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s"},children:[e.jsx(Ir,{size:18}),"Report Categories"]})]}),r==="dashboard"&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx($n,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto",padding:"0.375rem 0.625rem"},value:C.fromDate,onChange:be=>A({...C,fromDate:be.target.value})}),e.jsx("span",{style:{color:"var(--text-muted)"},children:"to"}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto",padding:"0.375rem 0.625rem"},value:C.toDate,onChange:be=>A({...C,toDate:be.target.value})})]})}),e.jsxs("div",{className:"grid grid-4",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(dn,{size:20,color:"var(--primary)"}),e.jsx("span",{className:"stat-label",children:"On-Time Delivery"})]}),e.jsxs("div",{className:"stat-value",children:[ee?.onTimeRate||0,"%"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[ee?.onTime||0," of ",ee?.totalDelivered||0," deliveries"]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Ft,{size:20,color:"var(--success)"}),e.jsx("span",{className:"stat-label",children:"QC Pass Rate"})]}),e.jsxs("div",{className:"stat-value",children:[F?.passRate||0,"%"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[F?.passed||0," passed, ",F?.failed||0," failed"]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Qt,{size:20,color:"var(--warning)"}),e.jsx("span",{className:"stat-label",children:"Avg Turnaround"})]}),e.jsxs("div",{className:"stat-value",children:[J?.averageTurnaroundHours||0,"h"]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Order to delivery"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(r0,{size:20,color:"var(--info)"}),e.jsx("span",{className:"stat-label",children:"Total Orders"})]}),e.jsx("div",{className:"stat-value",children:J?.totalOrders||0}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivered in period"})]})]}),e.jsxs("div",{className:"grid grid-2",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Daily Production Summary"})}),e.jsx("div",{style:{padding:"1.5rem",height:"300px"},children:$?.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Dg,{data:$,children:[e.jsx(Qu,{strokeDasharray:"3 3"}),e.jsx(Yu,{dataKey:"date",tickFormatter:be=>Ze(new Date(be),"MMM dd")}),e.jsx(nu,{}),e.jsx(kc,{}),e.jsx(tf,{dataKey:"totalBatches",fill:"#2563eb",name:"Batches"}),e.jsx(tf,{dataKey:"totalOrders",fill:"#22c55e",name:"Orders"})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:"No production data for this period"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0},children:"QC Pass Rate by Product"})}),e.jsx("div",{style:{padding:"1.5rem",height:"300px"},children:F?.byProduct&&Object.keys(F.byProduct).length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Pg,{children:[e.jsx(Tp,{data:Object.entries(F.byProduct).map(([be,Le])=>({name:be,value:Le.passed})),cx:"50%",cy:"50%",labelLine:!1,label:({name:be,percent:Le})=>`${be} (${((Le||0)*100).toFixed(0)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:Object.entries(F.byProduct).map((be,Le)=>e.jsx(Ju,{fill:Jd[Le%Jd.length]},`cell-${Le}`))}),e.jsx(kc,{})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:"No QC data for this period"})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Capacity Utilization"})}),e.jsx("div",{style:{padding:0},children:Y?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Equipment"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Batches"}),e.jsx("th",{children:"Minutes Used"}),e.jsx("th",{children:"Utilization"})]})}),e.jsx("tbody",{children:Y.map(be=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:be.equipment}),e.jsx("td",{children:be.type}),e.jsx("td",{children:be.batchCount}),e.jsxs("td",{children:[be.minutesUsed.toFixed(0)," min"]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"100px",height:"8px",background:"var(--bg-tertiary)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${be.utilizationPercent}%`,height:"100%",background:parseFloat(be.utilizationPercent)>80?"var(--success)":"var(--primary)",borderRadius:"4px"}})}),e.jsxs("span",{children:[be.utilizationPercent,"%"]})]})})]},be.equipment))})]}):e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No capacity data for this period"})})]}),e.jsx("div",{style:{marginTop:"2rem",marginBottom:"1.25rem"},children:e.jsxs("h3",{style:{fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ZQ,{size:16}),"Quick Insights"]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1.25rem",marginBottom:"1.25rem"},children:[e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0,fontSize:"0.875rem",color:"var(--text-primary)"},children:"Order Status Distribution"})}),e.jsxs("div",{style:{padding:"1.25rem",display:"flex",alignItems:"center",gap:"1.5rem"},children:[e.jsx("div",{style:{width:"180px",height:"180px",flexShrink:0},children:Z.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Pg,{children:[e.jsx(Tp,{data:Z,cx:"50%",cy:"50%",innerRadius:45,outerRadius:75,paddingAngle:2,dataKey:"value",children:Z.map((be,Le)=>e.jsx(Ju,{fill:Jd[Le%Jd.length]},`cell-${Le}`))}),e.jsx(kc,{contentStyle:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)",fontSize:"0.875rem"},children:"No data"})}),e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:Z.map((be,Le)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"2px",background:Jd[Le%Jd.length]}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:be.name})]}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:600},children:be.value})]},be.name))})]})]}),e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0,fontSize:"0.875rem",color:"var(--text-primary)"},children:"Batch Status Distribution"})}),e.jsxs("div",{style:{padding:"1.25rem",display:"flex",alignItems:"center",gap:"1.5rem"},children:[e.jsx("div",{style:{width:"180px",height:"180px",flexShrink:0},children:re.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Pg,{children:[e.jsx(Tp,{data:re,cx:"50%",cy:"50%",innerRadius:45,outerRadius:75,paddingAngle:2,dataKey:"value",children:re.map((be,Le)=>e.jsx(Ju,{fill:Jd[Le%Jd.length]},`cell-${Le}`))}),e.jsx(kc,{contentStyle:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)",fontSize:"0.875rem"},children:"No data"})}),e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"0.5rem"},children:re.map((be,Le)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"2px",background:Jd[Le%Jd.length]}}),e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:be.name})]}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:600},children:be.value})]},be.name))})]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.25rem",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{fontWeight:600,margin:0,fontSize:"0.875rem",color:"var(--text-primary)"},children:"Revenue Trend"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",fontSize:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx("div",{style:{width:"12px",height:"3px",background:"#2563eb",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-muted)"},children:"Revenue"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx("div",{style:{width:"12px",height:"3px",background:"#22c55e",borderRadius:"2px"}}),e.jsx("span",{style:{color:"var(--text-muted)"},children:"Invoices"})]})]})]}),e.jsx("div",{style:{padding:"1.25rem 1rem 1rem 0",height:"260px"},children:K.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(ZU,{data:K,margin:{top:5,right:20,bottom:5,left:10},children:[e.jsx(Qu,{strokeDasharray:"3 3",stroke:"var(--border)"}),e.jsx(Yu,{dataKey:"date",tickFormatter:be=>Ze(new Date(be),"MMM dd"),tick:{fontSize:11,fill:"var(--text-muted)"},axisLine:{stroke:"var(--border)"}}),e.jsx(nu,{yAxisId:"left",tickFormatter:be=>`${(be/1e3).toFixed(0)}K`,tick:{fontSize:11,fill:"var(--text-muted)"},axisLine:{stroke:"var(--border)"}}),e.jsx(nu,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:"var(--text-muted)"},axisLine:{stroke:"var(--border)"}}),e.jsx(kc,{contentStyle:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:"0.8125rem"},formatter:(be,Le)=>[Le==="revenue"?`SAR ${be.toLocaleString()}`:be,Le==="revenue"?"Revenue":"Invoices"],labelFormatter:be=>Ze(new Date(be),"MMM dd, yyyy")}),e.jsx(ay,{yAxisId:"left",type:"monotone",dataKey:"revenue",stroke:"#2563eb",strokeWidth:2.5,name:"revenue",dot:!1,activeDot:{r:5,strokeWidth:2}}),e.jsx(ay,{yAxisId:"right",type:"monotone",dataKey:"count",stroke:"#22c55e",strokeWidth:2.5,name:"invoices",dot:!1,activeDot:{r:5,strokeWidth:2}})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:"No invoice data for this period"})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1.25rem"},children:[e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0,fontSize:"0.875rem",color:"var(--text-primary)"},children:"Top Products by Orders"})}),e.jsx("div",{style:{padding:"1rem 1.25rem 1.25rem 0",height:"240px"},children:de.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Dg,{data:de,layout:"vertical",margin:{left:10,right:20,top:5,bottom:5},children:[e.jsx(Qu,{strokeDasharray:"3 3",stroke:"var(--border)",horizontal:!0,vertical:!1}),e.jsx(Yu,{type:"number",tick:{fontSize:11,fill:"var(--text-muted)"},axisLine:{stroke:"var(--border)"}}),e.jsx(nu,{type:"category",dataKey:"name",width:120,tick:{fontSize:11,fill:"var(--text-secondary)"},axisLine:{stroke:"var(--border)"}}),e.jsx(kc,{contentStyle:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:"0.8125rem"},formatter:be=>[be,"Orders"]}),e.jsx(tf,{dataKey:"orderCount",fill:"#3b82f6",name:"Orders",radius:[0,4,4,0],maxBarSize:24})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:"No product data for this period"})})]}),e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsx("h3",{style:{fontWeight:600,margin:0,fontSize:"0.875rem",color:"var(--text-primary)"},children:"Top Customers by Orders"})}),e.jsx("div",{style:{padding:"1rem 1.25rem 1.25rem 0",height:"240px"},children:le.length>0?e.jsx(Ic,{width:"100%",height:"100%",children:e.jsxs(Dg,{data:le,layout:"vertical",margin:{left:10,right:20,top:5,bottom:5},children:[e.jsx(Qu,{strokeDasharray:"3 3",stroke:"var(--border)",horizontal:!0,vertical:!1}),e.jsx(Yu,{type:"number",tick:{fontSize:11,fill:"var(--text-muted)"},axisLine:{stroke:"var(--border)"}}),e.jsx(nu,{type:"category",dataKey:"name",width:120,tick:{fontSize:11,fill:"var(--text-secondary)"},axisLine:{stroke:"var(--border)"}}),e.jsx(kc,{contentStyle:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:"0.8125rem"},formatter:be=>[be,"Orders"]}),e.jsx(tf,{dataKey:"orderCount",fill:"#10b981",name:"Orders",radius:[0,4,4,0],maxBarSize:24})]})}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"},children:"No customer data for this period"})})]})]})]}),r==="reports"&&!i&&e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{padding:"2rem",marginBottom:"1.5rem",textAlign:"center"},children:[e.jsx(Ir,{size:40,style:{color:"var(--primary)",marginBottom:"1rem"}}),e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.5rem"},children:"Select a Report Category"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:"Choose a category below to view available reports"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"1rem"},children:T.map(be=>{const Le=GS[be.id]||Ir,ke=Q5e[be.id]||"default",He=ue[be.id]?.length||0;return e.jsxs("button",{onClick:()=>W(be.id),className:"card",style:{padding:"1.5rem",border:"1px solid var(--border)",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},onMouseEnter:Je=>{Je.currentTarget.style.borderColor="var(--primary)",Je.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:Je=>{Je.currentTarget.style.borderColor="var(--border)",Je.currentTarget.style.transform="translateY(0)"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:`var(--${ke==="default"?"bg-secondary":ke+"-light"}, var(--bg-secondary))`,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.75rem"},children:e.jsx(Le,{size:24,style:{color:`var(--${ke==="default"?"text-muted":ke})`}})}),e.jsx("div",{style:{fontSize:"0.9375rem",fontWeight:600,marginBottom:"0.25rem"},children:be.name}),e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:[He," reports"]})]},be.id)})})]}),r==="reports"&&i&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>{a(null),o(null)},style:{padding:"0.375rem 0.625rem"},children:e.jsx(sa,{size:16})}),(()=>{const be=GS[i]||Ir;return e.jsx(be,{size:24,style:{color:"var(--primary)"}})})(),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.125rem",fontWeight:600,margin:0},children:ge}),e.jsxs("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",margin:0},children:[oe.length," reports available - click a report to view data"]})]})]}),oe.length===0?e.jsxs("div",{className:"card",style:{padding:"3rem",textAlign:"center"},children:[e.jsx(sn,{size:32,style:{color:"var(--text-muted)",marginBottom:"1rem"}}),e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"0.5rem"},children:"No Reports Available"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"There are no reports in this category or you don't have access to them."})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:oe.map(be=>{const Le=s===be.key,ke=GS[i]||Ir;return e.jsxs("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>se(be.key),style:{display:"flex",alignItems:"center",gap:"1rem",width:"100%",padding:"1rem 1.25rem",border:"none",background:Le?"var(--primary-light, #eff6ff)":"transparent",textAlign:"left",cursor:"pointer",transition:"background 0.2s"},children:[e.jsx("div",{style:{padding:"0.625rem",borderRadius:"8px",background:Le?"var(--primary)":"var(--bg-secondary)",color:Le?"white":"var(--text-muted)"},children:e.jsx(ke,{size:20})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"0.9375rem",fontWeight:600,color:Le?"var(--primary)":"var(--text-primary)",marginBottom:"0.125rem"},children:be.name}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:be.description})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[Le&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--primary)",fontWeight:500},children:"Viewing"}),Le?e.jsx(qo,{size:18}):e.jsx(bo,{size:18})]})]}),Le&&e.jsxs("div",{style:{borderTop:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.25rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsxs("button",{className:`btn ${p?"btn-primary":"btn-secondary"}`,onClick:()=>x(!p),style:{padding:"0.5rem 0.75rem"},children:[e.jsx(Wo,{size:14}),"Filters",Object.keys(l).filter(He=>l[He]).length>0&&e.jsx("span",{style:{marginLeft:"0.375rem",padding:"0.125rem 0.375rem",borderRadius:"10px",fontSize:"0.6875rem",background:p?"white":"var(--primary)",color:p?"var(--primary)":"white"},children:Object.keys(l).filter(He=>l[He]).length})]}),M&&e.jsxs("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:[M.total," records found"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>Se("excel"),disabled:v!==null||!M?.data.length,style:{padding:"0.5rem 0.75rem"},children:[v==="excel"?e.jsx(_g,{size:14,className:"animate-spin"}):e.jsx(VY,{size:14}),"Excel"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>Se("pdf"),disabled:v!==null||!M?.data.length,style:{padding:"0.5rem 0.75rem"},children:[v==="pdf"?e.jsx(_g,{size:14,className:"animate-spin"}):e.jsx(rz,{size:14}),"PDF"]})]})]}),p&&D?.filters&&D.filters.length>0&&e.jsxs("div",{style:{padding:"1rem 1.25rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"0.75rem",marginBottom:"0.75rem"},children:D.filters.map(He=>e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.6875rem",marginBottom:"0.25rem"},children:He.label}),He.type==="text"&&e.jsx("input",{type:"text",className:"form-input",style:{padding:"0.375rem 0.625rem",fontSize:"0.8125rem"},value:l[He.key]||"",onChange:Je=>ce(He.key,Je.target.value),placeholder:`Enter ${He.label.toLowerCase()}`}),He.type==="date"&&e.jsx("input",{type:"date",className:"form-input",style:{padding:"0.375rem 0.625rem",fontSize:"0.8125rem"},value:l[He.key]||"",onChange:Je=>ce(He.key,Je.target.value)}),He.type==="number"&&e.jsx("input",{type:"number",className:"form-input",style:{padding:"0.375rem 0.625rem",fontSize:"0.8125rem"},value:l[He.key]||He.defaultValue||"",onChange:Je=>ce(He.key,Je.target.value)}),He.type==="select"&&He.options&&e.jsxs("select",{className:"form-select",style:{padding:"0.375rem 0.625rem",fontSize:"0.8125rem"},value:l[He.key]||"",onChange:Je=>ce(He.key,Je.target.value),children:[e.jsx("option",{value:"",children:"All"}),He.options.map(Je=>e.jsx("option",{value:Je.value,children:Je.label},Je.value))]})]},He.key))}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>U(),style:{padding:"0.375rem 0.75rem",fontSize:"0.8125rem"},children:[e.jsx(Gs,{size:14}),"Apply"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:ye,style:{padding:"0.375rem 0.75rem",fontSize:"0.8125rem"},children:[e.jsx(Dr,{size:14}),"Clear"]})]})]}),Q?e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"3rem"},children:[e.jsx(_g,{size:32,className:"animate-spin",style:{color:"var(--primary)"}}),e.jsx("p",{style:{marginTop:"0.75rem",color:"var(--text-muted)"},children:"Loading report data..."})]}):M?.data.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsx("tr",{children:D?.columns.map(He=>e.jsx("th",{style:{fontSize:"0.75rem"},children:He.label},He.key))})}),e.jsx("tbody",{children:M.data.map((He,Je)=>e.jsx("tr",{children:D?.columns.map(Qe=>e.jsx("td",{style:{fontSize:"0.8125rem"},children:Qe.type==="badge"?e.jsx("span",{className:`badge badge-${X(He[Qe.key],Qe.badgeMap)}`,children:He[Qe.key]}):V(He[Qe.key],Qe.type)},Qe.key))},He.id||Je))})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem 1.25rem",borderTop:"1px solid var(--border)",fontSize:"0.8125rem",color:"var(--text-muted)",background:"var(--bg-secondary)"},children:[e.jsxs("span",{children:["Showing ",(d-1)*25+1," - ",Math.min(d*25,M.total)," of ",M.total]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary",disabled:d<=1,onClick:()=>f(He=>He-1),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:"Previous"}),e.jsxs("span",{style:{padding:"0 0.5rem"},children:["Page ",d," of ",M.totalPages]}),e.jsx("button",{className:"btn btn-secondary",disabled:d>=M.totalPages,onClick:()=>f(He=>He+1),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:"Next"})]})]})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"3rem"},children:[e.jsx(sn,{size:32,style:{color:"var(--text-muted)"}}),e.jsx("h3",{style:{margin:"1rem 0 0.5rem 0",fontSize:"1rem",color:"var(--text-primary)"},children:"No Data Found"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"Try adjusting your filters to see results"})]})]})]},be.key)})})]}),e.jsx("style",{children:`
        .animate-spin {
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function Z5e(){const[t,r]=k.useState({entityType:"",action:"",fromDate:"",toDate:"",limit:50,offset:0}),[n,i]=k.useState(null),{formatDateOnly:a,formatTimeOnly:s}=ph(),{data:o,isLoading:l}=Ve({queryKey:["audit-logs",t],queryFn:async()=>{const x={...t};Object.keys(x).forEach(w=>{x[w]||delete x[w]});const{data:v}=await xe.get("/audit",{params:x});return v}}),{data:u}=Ve({queryKey:["audit-actions"],queryFn:async()=>{const{data:x}=await xe.get("/audit/actions");return x}}),{data:d}=Ve({queryKey:["audit-entity-types"],queryFn:async()=>{const{data:x}=await xe.get("/audit/entity-types");return x}}),f=x=>{r(v=>({...v,offset:x==="next"?v.offset+v.limit:Math.max(0,v.offset-v.limit)}))},p=x=>x.includes("CREATE")?"success":x.includes("UPDATE")||x.includes("CHANGE")?"warning":x.includes("DELETE")?"danger":x.includes("LOGIN")||x.includes("LOGOUT")?"info":"default";return l?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.5rem"},children:e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:"Audit Log"})}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsx(Wo,{size:18,color:"var(--text-muted)"}),e.jsxs("select",{className:"form-select",style:{width:"auto"},value:t.entityType,onChange:x=>r({...t,entityType:x.target.value,offset:0}),children:[e.jsx("option",{value:"",children:"All Entity Types"}),d?.map(x=>e.jsx("option",{value:x,children:x},x))]}),e.jsxs("select",{className:"form-select",style:{width:"auto"},value:t.action,onChange:x=>r({...t,action:x.target.value,offset:0}),children:[e.jsx("option",{value:"",children:"All Actions"}),u?.map(x=>e.jsx("option",{value:x,children:x},x))]}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto"},value:t.fromDate,onChange:x=>r({...t,fromDate:x.target.value,offset:0}),placeholder:"From Date"}),e.jsx("input",{type:"date",className:"form-input",style:{width:"auto"},value:t.toDate,onChange:x=>r({...t,toDate:x.target.value,offset:0}),placeholder:"To Date"}),(t.entityType||t.action||t.fromDate||t.toDate)&&e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r({entityType:"",action:"",fromDate:"",toDate:"",limit:50,offset:0}),children:"Clear Filters"})]})}),e.jsxs("div",{className:"card",children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Timestamp"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Entity Type"}),e.jsx("th",{children:"Entity ID"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:o?.logs?.map(x=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{children:a(x.createdAt)}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:s(x.createdAt)})]}),e.jsx("td",{children:x.user?e.jsxs("div",{children:[e.jsxs("div",{children:[x.user.firstName," ",x.user.lastName]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:x.user.email})]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"System"})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${p(x.action)}`,children:x.action})}),e.jsx("td",{children:x.entityType}),e.jsx("td",{children:e.jsx("code",{style:{fontSize:"0.75rem",background:"var(--bg-tertiary)",padding:"0.125rem 0.25rem",borderRadius:"4px"},children:x.entityId?.slice(0,8)||"-"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(x),children:"View"})})]},x.id))})]}),o?.logs?.length===0&&e.jsx("div",{className:"empty-state",children:"No audit logs found"}),e.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:["Showing ",t.offset+1," - ",Math.min(t.offset+t.limit,o?.total||0)," of ",o?.total||0]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>f("prev"),disabled:t.offset===0,children:[e.jsx(Xp,{size:16}),"Previous"]}),e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>f("next"),disabled:t.offset+t.limit>=(o?.total||0),children:["Next",e.jsx(bo,{size:16})]})]})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(null),children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"720px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",borderRadius:"16px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",style:{background:"linear-gradient(135deg, var(--primary) 0%, #1e40af 100%)",padding:"1.5rem",borderRadius:"16px 16px 0 0",color:"white"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},children:e.jsx(Mc,{size:24,color:"white"})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.25rem",fontWeight:600,color:"white"},children:"Audit Log Details"}),e.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"rgba(255,255,255,0.8)"},children:[a(n.createdAt)," at ",s(n.createdAt)]})]})]}),e.jsx("button",{onClick:()=>i(null),style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Dr,{size:20,color:"white"})})]}),e.jsxs("div",{className:"modal-body",style:{overflow:"auto",flex:1,padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1.25rem",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:"12px",border:"1px solid #bae6fd"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",background:"#0284c7",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Uo,{size:14,color:"white"})}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#0369a1",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em"},children:"User"})]}),n.user?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:"1rem",color:"#0c4a6e"},children:[n.user.firstName," ",n.user.lastName]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#0369a1",marginTop:"0.25rem"},children:n.user.email}),n.actorRole&&e.jsx("span",{className:"badge badge-info",style:{marginTop:"0.75rem",display:"inline-block"},children:n.actorRole})]}):e.jsx("div",{style:{fontWeight:600,fontSize:"1rem",color:"#64748b"},children:"System"})]}),e.jsxs("div",{style:{padding:"1.25rem",background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",borderRadius:"12px",border:"1px solid #bbf7d0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",background:"#16a34a",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Qt,{size:14,color:"white"})}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#15803d",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em"},children:"Timestamp"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"1rem",color:"#14532d"},children:a(n.createdAt)}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#15803d",marginTop:"0.25rem"},children:s(n.createdAt)})]}),e.jsxs("div",{style:{padding:"1.25rem",background:"linear-gradient(135deg, #fefce8 0%, #fef9c3 100%)",borderRadius:"12px",border:"1px solid #fde047"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",background:"#ca8a04",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ir,{size:14,color:"white"})}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#a16207",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em"},children:"Entity"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"1rem",color:"#713f12"},children:n.entityType}),e.jsx("code",{style:{fontSize:"0.75rem",background:"rgba(0,0,0,0.05)",padding:"0.375rem 0.625rem",borderRadius:"6px",display:"inline-block",marginTop:"0.5rem",color:"#92400e",fontFamily:"monospace",wordBreak:"break-all"},children:n.entityId||"N/A"})]}),e.jsxs("div",{style:{padding:"1.25rem",background:"linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%)",borderRadius:"12px",border:"1px solid #e879f9"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"6px",background:"#a855f7",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(MA,{size:14,color:"white"})}),e.jsx("span",{style:{fontSize:"0.75rem",color:"#7e22ce",textTransform:"uppercase",fontWeight:600,letterSpacing:"0.05em"},children:"Action"})]}),e.jsx("span",{className:`badge badge-${p(n.action)}`,style:{fontSize:"0.875rem",fontWeight:600},children:n.action}),n.traceId&&e.jsxs("div",{style:{marginTop:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"#7e22ce"},children:"Trace ID: "}),e.jsxs("code",{style:{fontSize:"0.7rem",background:"rgba(0,0,0,0.05)",padding:"0.25rem 0.5rem",borderRadius:"4px"},children:[n.traceId.slice(0,16),"..."]})]})]})]}),(n.oldValues||n.newValues)&&e.jsxs("div",{style:{marginTop:"1.5rem",padding:"1.25rem",background:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(lc,{size:16,color:"white"})}),e.jsx("h4",{style:{fontSize:"1rem",fontWeight:600,margin:0,color:"var(--text-primary)"},children:"Changes"})]}),n.oldValues&&n.newValues?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"#dc2626",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.05em",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#dc2626"}}),"Before"]}),e.jsx("pre",{style:{background:"#fef2f2",padding:"1rem",borderRadius:"8px",fontSize:"0.8rem",overflow:"auto",maxHeight:"220px",border:"1px solid #fecaca",margin:0,color:"#991b1b",fontFamily:'"SF Mono", "Fira Code", monospace',lineHeight:1.5},children:JSON.stringify(n.oldValues,null,2)})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.75rem",fontWeight:600,color:"#16a34a",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.05em",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#16a34a"}}),"After"]}),e.jsx("pre",{style:{background:"#f0fdf4",padding:"1rem",borderRadius:"8px",fontSize:"0.8rem",overflow:"auto",maxHeight:"220px",border:"1px solid #bbf7d0",margin:0,color:"#166534",fontFamily:'"SF Mono", "Fira Code", monospace',lineHeight:1.5},children:JSON.stringify(n.newValues,null,2)})]})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.75rem",fontWeight:600,color:n.oldValues?"#dc2626":"#16a34a",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.05em",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:n.oldValues?"#dc2626":"#16a34a"}}),n.oldValues?"Previous Values":"New Values"]}),e.jsx("pre",{style:{background:n.oldValues?"#fef2f2":"#f0fdf4",padding:"1rem",borderRadius:"8px",fontSize:"0.8rem",overflow:"auto",maxHeight:"300px",border:`1px solid ${n.oldValues?"#fecaca":"#bbf7d0"}`,margin:0,color:n.oldValues?"#991b1b":"#166534",fontFamily:'"SF Mono", "Fira Code", monospace',lineHeight:1.5},children:JSON.stringify(n.oldValues||n.newValues,null,2)})]})]}),!n.oldValues&&!n.newValues&&e.jsxs("div",{style:{textAlign:"center",padding:"2.5rem",color:"var(--text-muted)",background:"var(--bg-secondary)",borderRadius:"12px",border:"2px dashed var(--border)",marginTop:"1rem"},children:[e.jsx(Ir,{size:32,style:{marginBottom:"0.75rem",opacity:.5}}),e.jsx("div",{style:{fontWeight:500},children:"No detailed change data available"}),e.jsx("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem"},children:"This log entry does not contain before/after values."})]})]}),e.jsx("div",{className:"modal-footer",style:{borderTop:"1px solid var(--border)",padding:"1rem 1.5rem",display:"flex",justifyContent:"flex-end",background:"var(--bg-secondary)",borderRadius:"0 0 16px 16px"},children:e.jsx("button",{className:"btn btn-primary",onClick:()=>i(null),children:"Close"})})]})})]})}function X5e(){const t=pr(),r=gn(),[n,i]=k.useState(null),[a,s]=k.useState("PENDING"),[o,l]=k.useState({}),[u,d]=k.useState(null),[f,p]=k.useState(""),[x,v]=k.useState(""),{data:w=[],isLoading:C}=Ve({queryKey:["approvals","pending"],queryFn:async()=>{const{data:F}=await xe.get("/approvals/pending");return F}}),{data:A=[],isLoading:T}=Ve({queryKey:["approvals","requests",a],queryFn:async()=>{const F=a!=="all"?`?status=${a}`:"",{data:Y}=await xe.get(`/approvals/requests${F}`);return Y}}),O=ot({mutationFn:async({requestId:F,action:Y,comments:J,signature:Z})=>{const{data:re}=await xe.post(`/approvals/${F}/action`,{action:Y,comments:J,signature:Z});return re},onSuccess:(F,Y)=>{t.invalidateQueries({queryKey:["approvals"]}),d(null),p(""),v(""),Y.action==="APPROVED"?r.success("Request Approved","The approval request has been approved successfully"):r.warning("Request Rejected","The approval request has been rejected")},onError:F=>{r.error("Action Failed",F.response?.data?.error||"Failed to process approval action")}}),D=(F,Y,J)=>{d({requestId:F,action:Y,workflowName:J})},M=()=>{u&&O.mutate({requestId:u.requestId,action:u.action,comments:f||void 0,signature:x||void 0})},Q=[{key:"search",label:"Search",type:"search",placeholder:"Search workflows..."}],U=w.filter(F=>{if(o.search){const Y=o.search.toLowerCase();if(!F.workflow.name.toLowerCase().includes(Y)&&!F.entityType.toLowerCase().includes(Y)&&!`${F.requestedBy.firstName} ${F.requestedBy.lastName}`.toLowerCase().includes(Y))return!1}return!0}),$=A.filter(F=>{if(o.search){const Y=o.search.toLowerCase();if(!F.workflow.name.toLowerCase().includes(Y)&&!F.entityType.toLowerCase().includes(Y))return!1}return!0}),ee={pending:w.length,approved:A.filter(F=>F.status==="APPROVED").length,rejected:A.filter(F=>F.status==="REJECTED").length,urgent:w.filter(F=>F.priority==="URGENT").length};return C||T?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Approval Inbox"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Review and process pending approval requests"})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Pending Approvals",value:ee.pending,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>s("PENDING"),selected:a==="PENDING"}),e.jsx(nt,{title:"Urgent",value:ee.urgent,icon:e.jsx(gu,{size:20}),color:"danger",onClick:()=>l(F=>({...F,priority:"URGENT"}))}),e.jsx(nt,{title:"Approved",value:ee.approved,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>s("APPROVED"),selected:a==="APPROVED"}),e.jsx(nt,{title:"Rejected",value:ee.rejected,icon:e.jsx(ri,{size:20}),color:"default",onClick:()=>s("REJECTED"),selected:a==="REJECTED"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:Q,values:o,onChange:(F,Y)=>l(J=>({...J,[F]:Y})),onReset:()=>l({})})}),U.length>0&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(lZ,{size:18,style:{color:"var(--warning)"}}),e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Awaiting Your Approval (",U.length,")"]})]}),e.jsx("div",{style:{padding:0},children:e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"}}),e.jsx("th",{children:"Workflow"}),e.jsx("th",{children:"Entity"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Current Step"}),e.jsx("th",{children:"Requested By"}),e.jsx("th",{children:"Date"}),e.jsx("th",{style:{width:"200px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:U.map(F=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline",style:{padding:"0.25rem"},onClick:()=>i(n===F.id?null:F.id),children:n===F.id?e.jsx(qo,{size:14}):e.jsx(bo,{size:14})})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:F.workflow.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:F.entityType})]}),e.jsxs("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:[F.entityId.slice(0,8),"..."]}),e.jsx("td",{children:e.jsx(Pn,{status:F.priority,size:"sm"})}),e.jsx("td",{children:F.workflow.steps.find(Y=>Y.stepOrder===F.currentStep)?.stepName||"Unknown"}),e.jsxs("td",{children:[F.requestedBy.firstName," ",F.requestedBy.lastName]}),e.jsx("td",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:Ze(new Date(F.createdAt),"MMM d, HH:mm")}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>i(n===F.id?null:F.id),title:"View Details",children:e.jsx(os,{size:14})}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>D(F.id,"APPROVED",F.workflow.name),style:{minWidth:"80px"},children:[e.jsx(Ft,{size:14}),"Approve"]}),e.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>D(F.id,"REJECTED",F.workflow.name),style:{minWidth:"70px"},children:[e.jsx(ri,{size:14}),"Reject"]})]})})]},F.id),n===F.id&&e.jsx("tr",{children:e.jsxs("td",{colSpan:8,style:{background:"var(--bg-secondary)",padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.75rem",fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)"},children:"Workflow Steps"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:F.workflow.steps.map(Y=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",background:Y.stepOrder===F.currentStep?"rgba(59, 130, 246, 0.1)":"var(--bg)",borderRadius:"var(--radius)",border:Y.stepOrder===F.currentStep?"1px solid var(--primary)":"1px solid var(--border)"},children:[Y.stepOrder<F.currentStep?e.jsx(Ft,{size:18,color:"var(--success)"}):Y.stepOrder===F.currentStep?e.jsx(Qt,{size:18,color:"var(--primary)"}):e.jsx("div",{style:{width:18,height:18,borderRadius:"50%",border:"2px solid var(--border)"}}),e.jsxs("span",{style:{fontWeight:Y.stepOrder===F.currentStep?500:400,flex:1},children:[Y.stepOrder,". ",Y.stepName]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Y.approverRole.name})]},Y.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.75rem",fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)"},children:"Approval History"}),F.actions.length===0?e.jsx("div",{style:{color:"var(--text-muted)",fontStyle:"italic",padding:"1rem",background:"var(--bg)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:"No actions taken yet"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:F.actions.map(Y=>e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[Y.action==="APPROVED"?e.jsx(Ft,{size:16,color:"var(--success)"}):e.jsx(ri,{size:16,color:"var(--danger)"}),e.jsx("span",{style:{fontWeight:500},children:Y.step.stepName}),e.jsx("span",{style:{marginLeft:"auto",fontSize:"0.75rem",color:"var(--text-muted)"},children:Ze(new Date(Y.createdAt),"MMM d, HH:mm")})]}),e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["by ",Y.actionBy.firstName," ",Y.actionBy.lastName]}),Y.comments&&e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.5rem",fontStyle:"italic",paddingLeft:"1.5rem"},children:['"',Y.comments,'"']})]},Y.id))})]})]}),F.notes&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"var(--bg)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsx("strong",{style:{fontSize:"0.8125rem"},children:"Notes:"}),e.jsx("span",{style:{marginLeft:"0.5rem",color:"var(--text-secondary)"},children:F.notes})]})]})},`${F.id}-details`)]}))})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"All Approval Requests"})]}),e.jsx("div",{style:{display:"inline-flex",background:"var(--bg)",borderRadius:"8px",padding:"4px",border:"1px solid var(--border)"},children:[{key:"PENDING",label:"Pending",icon:Qt,color:"var(--warning)"},{key:"APPROVED",label:"Approved",icon:Ft,color:"var(--success)"},{key:"REJECTED",label:"Rejected",icon:ri,color:"var(--danger)"},{key:"all",label:"All",icon:null,color:"var(--primary)"}].map((F,Y,J)=>{const Z=a===F.key,re=F.icon;return e.jsxs("button",{onClick:()=>s(F.key),style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 14px",fontSize:"0.8125rem",fontWeight:Z?600:500,color:Z?"#fff":"var(--text-secondary)",background:Z?F.color:"transparent",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.15s ease",whiteSpace:"nowrap"},onMouseEnter:de=>{Z||(de.currentTarget.style.background="var(--bg-hover)")},onMouseLeave:de=>{Z||(de.currentTarget.style.background="transparent")},children:[re&&e.jsx(re,{size:14}),F.label]},F.key)})})]}),e.jsx("div",{style:{padding:0},children:$.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Workflow"}),e.jsx("th",{children:"Entity Type"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Current Step"}),e.jsx("th",{children:"Requested By"}),e.jsx("th",{children:"Date"})]})}),e.jsx("tbody",{children:$.map(F=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:F.workflow.name}),e.jsx("td",{children:F.entityType}),e.jsx("td",{children:e.jsx(Pn,{status:F.status,size:"sm"})}),e.jsx("td",{children:e.jsx(Pn,{status:F.priority,size:"sm"})}),e.jsx("td",{children:F.workflow.steps.find(Y=>Y.stepOrder===F.currentStep)?.stepName||"-"}),e.jsxs("td",{children:[F.requestedBy.firstName," ",F.requestedBy.lastName]}),e.jsx("td",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:Ze(new Date(F.createdAt),"MMM d, yyyy HH:mm")})]},F.id))})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No approval requests",message:`No ${a==="all"?"":a.toLowerCase()} approval requests found`,icon:"package",variant:"compact"})})})]}),u&&e.jsx("div",{className:"modal-overlay",onClick:()=>d(null),children:e.jsxs("div",{className:"modal",onClick:F=>F.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{margin:0,fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:u.action==="APPROVED"?e.jsxs(e.Fragment,{children:[e.jsx(Ft,{color:"var(--success)",size:20})," Approve Request"]}):e.jsxs(e.Fragment,{children:[e.jsx(ri,{color:"var(--danger)",size:20})," Reject Request"]})}),e.jsx("button",{onClick:()=>d(null),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{style:{padding:"1rem",background:u.action==="APPROVED"?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius)",marginBottom:"1rem",border:u.action==="APPROVED"?"1px solid rgba(34, 197, 94, 0.3)":"1px solid rgba(239, 68, 68, 0.3)"},children:e.jsxs("p",{style:{margin:0,fontSize:"0.875rem"},children:["You are about to ",e.jsx("strong",{children:u.action==="APPROVED"?"approve":"reject"})," the request for ",e.jsx("strong",{children:u.workflowName}),"."]})}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Comments ",u.action==="REJECTED"?"*":"(optional)"]}),e.jsx("textarea",{className:"form-input",value:f,onChange:F=>p(F.target.value),placeholder:u.action==="REJECTED"?"Please provide a reason for rejection...":"Add any comments or notes...",rows:3,required:u.action==="REJECTED"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Electronic Signature *"}),e.jsx("input",{type:"text",className:"form-input",value:x,onChange:F=>v(F.target.value),placeholder:"Type your full name to sign"}),e.jsx("small",{style:{color:"var(--text-muted)",display:"block",marginTop:"0.5rem",fontSize:"0.75rem"},children:"By signing, you confirm this action is in compliance with GMP requirements."})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>d(null),children:"Cancel"}),e.jsxs("button",{className:`btn ${u.action==="APPROVED"?"btn-primary":"btn-danger"}`,onClick:M,disabled:O.isPending||!x.trim()||u.action==="REJECTED"&&!f.trim(),style:{minWidth:"140px"},children:[e.jsx(Qi,{size:16}),O.isPending?"Processing...":`Confirm ${u.action==="APPROVED"?"Approval":"Rejection"}`]})]})]})})]})}function J5e(){const[t,r]=k.useState(""),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(null),[u,d]=k.useState(""),[f,p]=k.useState({}),[x,v]=k.useState({batchId:"",orderId:"",patientReference:"",requestedActivity:"",volume:"",containerType:"",notes:""}),w=pr(),C=gn(),{data:A}=Ve({queryKey:["dispensing-stats"],queryFn:async()=>{const{data:K}=await xe.get("/dispensing/stats");return K}}),{data:T,isLoading:O}=Ve({queryKey:["batches","RELEASED"],queryFn:async()=>{const{data:K}=await xe.get("/batches",{params:{status:"RELEASED"}});return K}}),{data:D,isLoading:M}=Ve({queryKey:["dispensing","batch",t],queryFn:async()=>{const{data:K}=await xe.get(`/dispensing/batch/${t}`);return K},enabled:!!t}),{data:Q}=Ve({queryKey:["dispensing"],queryFn:async()=>{const{data:K}=await xe.get("/dispensing");return K}}),U=ot({mutationFn:async K=>xe.post("/dispensing",K),onSuccess:()=>{w.invalidateQueries({queryKey:["dispensing"]}),w.invalidateQueries({queryKey:["dispensing-stats"]}),i(!1),v({batchId:"",orderId:"",patientReference:"",requestedActivity:"",volume:"",containerType:"",notes:""}),C.success("Dose Created","New dose unit has been created successfully")},onError:K=>{C.error("Creation Failed",K.response?.data?.error||"Failed to create dose unit")}}),$=ot({mutationFn:async({id:K,dispensedActivity:ue})=>xe.put(`/dispensing/${K}/dispense`,{dispensedActivity:ue}),onSuccess:()=>{w.invalidateQueries({queryKey:["dispensing"]}),w.invalidateQueries({queryKey:["dispensing-stats"]}),C.success("Dose Dispensed","Dose has been marked as dispensed")},onError:K=>{C.error("Dispense Failed",K.response?.data?.error||"Failed to dispense dose")}}),ee=ot({mutationFn:async K=>xe.put(`/dispensing/${K}/label`),onSuccess:()=>{w.invalidateQueries({queryKey:["dispensing"]}),C.success("Label Printed","Dose has been labeled")},onError:K=>{C.error("Label Failed",K.response?.data?.error||"Failed to label dose")}}),F=ot({mutationFn:async({id:K,reason:ue})=>xe.put(`/dispensing/${K}/waste`,{reason:ue}),onSuccess:()=>{w.invalidateQueries({queryKey:["dispensing"]}),w.invalidateQueries({queryKey:["dispensing-stats"]}),s(!1),l(null),d(""),C.warning("Dose Wasted","Dose has been marked as wasted")},onError:K=>{C.error("Waste Failed",K.response?.data?.error||"Failed to mark as wasted")}}),Y=()=>{!x.batchId||!x.requestedActivity||U.mutate({batchId:x.batchId,orderId:x.orderId||void 0,patientReference:x.patientReference||void 0,requestedActivity:parseFloat(x.requestedActivity),volume:x.volume?parseFloat(x.volume):void 0,containerType:x.containerType||void 0,notes:x.notes||void 0})},J=()=>{!o||!u.trim()||F.mutate({id:o.id,reason:u})},Z=K=>{l(K),d(""),s(!0)},re=[{key:"search",label:"Search",type:"search",placeholder:"Search doses..."}],de=T?.filter(K=>{if(f.search){const ue=f.search.toLowerCase();if(!K.batchNumber.toLowerCase().includes(ue)&&!K.product?.name.toLowerCase().includes(ue))return!1}return!0}),le=Q?.filter(K=>{if(f.search){const ue=f.search.toLowerCase();if(!K.doseNumber.toLowerCase().includes(ue)&&!K.batch?.batchNumber?.toLowerCase().includes(ue)&&!K.batch?.product?.name?.toLowerCase().includes(ue))return!1}return!0});return O?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Dose Dispensing"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Create and manage individual dose units from released batches"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>i(!0),children:[e.jsx(cn,{size:18})," Create Dose Unit"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Released Batches",value:A?.releasedBatches||0,icon:e.jsx(Wl,{size:20}),color:"primary"}),e.jsx(nt,{title:"Total Doses",value:A?.totalDoses||0,icon:e.jsx(Bf,{size:20}),color:"default"}),e.jsx(nt,{title:"Pending",value:A?.pending||0,icon:e.jsx(Qt,{size:20}),color:"warning"}),e.jsx(nt,{title:"Dispensed Today",value:A?.dispensedToday||0,icon:e.jsx(Ft,{size:20}),color:"success"}),e.jsx(nt,{title:"Shipped",value:A?.shipped||0,icon:e.jsx(dn,{size:20}),color:"info"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:re,values:f,onChange:(K,ue)=>p(ce=>({...ce,[K]:ue})),onReset:()=>p({})})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"320px 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wl,{size:18,style:{color:"var(--primary)"}}),e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Released Batches (",de?.length||0,")"]})]}),e.jsx("div",{style:{padding:"0.75rem",maxHeight:"50vh",overflowY:"auto"},children:de?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:de.map(K=>{const ue=K.doseUnits?.length||0;return e.jsxs("button",{className:`btn ${t===K.id?"btn-primary":"btn-outline"}`,style:{textAlign:"left",justifyContent:"flex-start",padding:"0.75rem 1rem",height:"auto"},onClick:()=>r(K.id),children:[e.jsx(Rr,{size:16}),e.jsxs("div",{style:{flex:1,marginLeft:"0.5rem"},children:[e.jsx("div",{style:{fontWeight:500},children:K.batchNumber}),e.jsx("div",{style:{fontSize:"0.75rem",opacity:.7},children:K.product?.name}),e.jsxs("div",{style:{fontSize:"0.7rem",opacity:.5,marginTop:"0.25rem"},children:[ue," doses | ",K.targetActivity," ",K.activityUnit]})]})]},K.id)})}):e.jsx(fn,{title:"No released batches",message:"Batches must be released by QP before dispensing",icon:"package",variant:"compact"})})]}),e.jsx("div",{className:"card",children:t&&D?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:0},children:D.batch?.batchNumber}),e.jsx(Pn,{status:D.batch?.status,size:"sm"})]}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",margin:"0.25rem 0 0 0"},children:D.batch?.product?.name})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("div",{style:{textAlign:"right",backgroundColor:"var(--bg-secondary)",padding:"0.5rem 0.75rem",borderRadius:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx(Mc,{size:14,style:{color:"var(--primary)"}}),e.jsxs("span",{style:{fontSize:"1rem",fontWeight:600,color:"var(--primary)"},children:[D.remainingActivity?.toFixed(2)," ",D.batch?.activityUnit]})]}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:"Available"})]}),e.jsx(nr,{to:`/batches/${t}/journey`,className:"btn btn-secondary btn-sm",children:e.jsx(os,{size:14})})]})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("h4",{style:{fontWeight:600,fontSize:"0.875rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)",margin:0},children:["Dose Units (",D.doseUnits?.length||0,")"]}),e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>{v({...x,batchId:t}),i(!0)},children:[e.jsx(cn,{size:14})," Add Dose"]})]}),D.doseUnits?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dose #"}),e.jsx("th",{children:"Patient Ref"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"140px"},children:"Actions"})]})}),e.jsx("tbody",{children:D.doseUnits.map(K=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:K.doseNumber}),e.jsx("td",{children:K.patientReference||e.jsx("span",{style:{color:"var(--text-muted)"},children:"-"})}),e.jsxs("td",{style:{fontWeight:500},children:[K.dispensedActivity||K.requestedActivity," ",K.activityUnit]}),e.jsx("td",{children:e.jsx(Pn,{status:K.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[K.status==="CREATED"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>ee.mutate(K.id),disabled:ee.isPending,title:"Print Label",children:e.jsx(r2,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>$.mutate({id:K.id}),disabled:$.isPending,title:"Dispense",children:e.jsx(Bf,{size:14})})]}),K.status==="LABELED"&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>$.mutate({id:K.id}),disabled:$.isPending,title:"Dispense",children:e.jsx(Bf,{size:14})}),["CREATED","LABELED"].includes(K.status)&&e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>Z(K),title:"Mark as Wasted",children:e.jsx(Gi,{size:14})})]})})]},K.id))})]}):e.jsx(fn,{title:"No dose units",message:"Create dose units for this batch",icon:"package",variant:"compact",ctaLabel:"Create Dose",onCta:()=>{v({...x,batchId:t}),i(!0)}}),D.pendingOrders?.length>0&&e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsxs("h4",{style:{fontWeight:600,marginBottom:"0.75rem",fontSize:"0.875rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)"},children:["Pending Orders (",D.pendingOrders.length,")"]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Requested Activity"}),e.jsx("th",{style:{width:"120px"},children:"Action"})]})}),e.jsx("tbody",{children:D.pendingOrders.map(K=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:K.orderNumber}),e.jsx("td",{children:K.customer?.name}),e.jsxs("td",{style:{fontWeight:500},children:[K.requestedActivity," ",K.activityUnit]}),e.jsx("td",{children:e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>{v({...x,batchId:t,orderId:K.id,requestedActivity:K.requestedActivity.toString()}),i(!0)},children:[e.jsx(cn,{size:14})," Create Dose"]})})]},K.id))})]})]})]})]}):M?e.jsx("div",{style:{padding:"4rem",textAlign:"center"},children:e.jsx("div",{className:"spinner"})}):e.jsx("div",{style:{padding:"1.5rem"},children:e.jsx(fn,{title:"No Batch Selected",message:"Select a released batch from the left to view and manage dose units",icon:"package"})})})]}),e.jsxs("div",{className:"card",style:{marginTop:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Bf,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Recent Dose Units"})]}),e.jsx("div",{style:{padding:"0"},children:le?.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dose #"}),e.jsx("th",{children:"Batch"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"})]})}),e.jsx("tbody",{children:le.slice(0,15).map(K=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:K.doseNumber}),e.jsx("td",{children:K.batch?.batchNumber}),e.jsx("td",{children:K.batch?.product?.name}),e.jsx("td",{children:K.order?.customer?.name||e.jsx("span",{style:{color:"var(--text-muted)"},children:"-"})}),e.jsxs("td",{style:{fontWeight:500},children:[K.dispensedActivity||K.requestedActivity," ",K.activityUnit]}),e.jsx("td",{children:e.jsx(Pn,{status:K.status,size:"sm"})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:"0.8125rem"},children:Ze(new Date(K.createdAt),"MMM d, HH:mm")})]},K.id))})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No dose units",message:"Create dose units from released batches",icon:"package",variant:"compact"})})})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Create Dose Unit"}),e.jsx("button",{onClick:()=>i(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Batch *"}),e.jsxs("select",{className:"form-select",value:x.batchId,onChange:K=>v({...x,batchId:K.target.value}),children:[e.jsx("option",{value:"",children:"Select a batch"}),T?.map(K=>e.jsxs("option",{value:K.id,children:[K.batchNumber," - ",K.product?.name]},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Requested Activity (mCi) *"}),e.jsx("input",{type:"number",className:"form-input",value:x.requestedActivity,onChange:K=>v({...x,requestedActivity:K.target.value}),step:"0.01",placeholder:"Enter activity amount"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Patient Reference"}),e.jsx("input",{type:"text",className:"form-input",value:x.patientReference,onChange:K=>v({...x,patientReference:K.target.value}),placeholder:"e.g., Hospital order ref or pseudonym"})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Volume (mL)"}),e.jsx("input",{type:"number",className:"form-input",value:x.volume,onChange:K=>v({...x,volume:K.target.value}),step:"0.1",placeholder:"Optional"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Container Type"}),e.jsx("input",{type:"text",className:"form-input",value:x.containerType,onChange:K=>v({...x,containerType:K.target.value}),placeholder:"e.g., Vial, Syringe"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-input",value:x.notes,onChange:K=>v({...x,notes:K.target.value}),rows:2,placeholder:"Optional notes"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:Y,disabled:U.isPending||!x.batchId||!x.requestedActivity,children:[e.jsx(Bf,{size:16}),U.isPending?"Creating...":"Create Dose Unit"]})]})]})}),a&&o&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:e.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Mark Dose as Wasted"}),e.jsx("button",{onClick:()=>s(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",background:"#fef2f2",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.875rem",border:"1px solid #fecaca"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Hr,{size:18,color:"var(--danger)"}),e.jsx("strong",{style:{color:"var(--danger)"},children:"Dose Waste"})]}),e.jsx("p",{style:{margin:0,color:"#991b1b"},children:"This action will mark the dose as wasted. Please provide a reason for the waste."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Dose Number"}),e.jsx("input",{className:"form-input",value:o.doseNumber,disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Activity"}),e.jsx("input",{className:"form-input",value:`${o.requestedActivity} ${o.activityUnit}`,disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Waste Reason *"}),e.jsx("textarea",{className:"form-input",value:u,onChange:K=>d(K.target.value),rows:3,required:!0,placeholder:"Enter reason for waste (e.g., spillage, contamination, decay)"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsxs("button",{className:"btn btn-danger",onClick:J,disabled:F.isPending||!u.trim(),children:[e.jsx(Gi,{size:16}),F.isPending?"Processing...":"Confirm Waste"]})]})]})})]})}function ewe(){const[t,r]=k.useState(new Date),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(null),u=pr(),d=cf(t,{weekStartsOn:1}),f=pte(t,{weekStartsOn:1}),{data:p,isLoading:x}=Ve({queryKey:["availability","calendar",d.toISOString(),f.toISOString()],queryFn:async()=>{const{data:K}=await xe.get("/availability/calendar",{params:{startDate:d.toISOString(),endDate:f.toISOString()}});return K}}),{data:v}=Ve({queryKey:["reservations",d.toISOString(),f.toISOString()],queryFn:async()=>{const{data:K}=await xe.get("/reservations",{params:{startDate:d.toISOString(),endDate:f.toISOString()}});return K}}),w=ot({mutationFn:async K=>xe.post("/availability/windows",K),onSuccess:()=>{u.invalidateQueries({queryKey:["availability"]}),i(!1)}}),C=ot({mutationFn:async K=>xe.post("/availability/windows/generate",K),onSuccess:()=>{u.invalidateQueries({queryKey:["availability"]}),s(!1)}}),[A,T]=k.useState({name:"",date:Ze(new Date,"yyyy-MM-dd"),startTime:"08:00",endTime:"17:00",capacityMinutes:480}),[O,D]=k.useState({startDate:Ze(new Date,"yyyy-MM-dd"),endDate:Ze(hl(new Date,30),"yyyy-MM-dd"),startTime:"08:00",endTime:"17:00",capacityMinutes:480,excludeWeekends:!0}),M=Array.from({length:7},(K,ue)=>hl(d,ue)),Q=K=>{if(!p)return[];const ue=Ze(K,"yyyy-MM-dd");return p.filter(ce=>Ze(new Date(ce.date),"yyyy-MM-dd")===ue)},U=K=>K>=90?"var(--danger)":K>=70?"var(--warning)":K>=40?"var(--primary)":"var(--success)",$=()=>{const K=A.date;w.mutate({name:A.name||`Delivery Window ${K}`,date:K,startTime:`${K}T${A.startTime}:00`,endTime:`${K}T${A.endTime}:00`,capacityMinutes:A.capacityMinutes})},ee=()=>{C.mutate({startDate:O.startDate,endDate:O.endDate,startTime:O.startTime,endTime:O.endTime,capacityMinutes:O.capacityMinutes,excludeWeekends:O.excludeWeekends})},F=K=>{l(K)},Y=K=>v?v.filter(ue=>ue.windowId===K&&["TENTATIVE","CONFIRMED"].includes(ue.status)):[],J=v?.filter(K=>["TENTATIVE","CONFIRMED"].includes(K.status))||[],Z=o?J.filter(K=>K.windowId===o.id):J,re=p?.length||0,de=p?.reduce((K,ue)=>K+ue.capacityMinutes,0)||0,le=p?.reduce((K,ue)=>K+ue.usedMinutes,0)||0;return x?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Availability & Capacity"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage delivery windows and track capacity utilization"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:[e.jsx(h8,{size:16})," Generate Windows"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>i(!0),children:[e.jsx(cn,{size:18})," Add Window"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card stat-card",style:{cursor:"pointer"},onClick:()=>l(null),children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"},children:e.jsx(h8,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"stat-value",style:{color:"var(--primary)"},children:re}),e.jsx("div",{className:"stat-label",children:"Delivery Windows"})]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(100, 116, 139, 0.1)",color:"var(--text-muted)"},children:e.jsx(Qt,{size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"stat-value",children:[Math.round(de/60),"h"]}),e.jsx("div",{className:"stat-label",children:"Total Capacity"})]})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:de>0?`${U(le/de*100)}15`:"rgba(34, 197, 94, 0.1)",color:de>0?U(le/de*100):"var(--success)"},children:e.jsx(dc,{size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"stat-value",style:{color:de>0?U(le/de*100):"var(--success)"},children:[de>0?Math.round(le/de*100):0,"%"]}),e.jsx("div",{className:"stat-label",children:"Utilization"})]})]}),e.jsxs("div",{className:"card stat-card",style:{cursor:"pointer",border:o===null&&J.length>0?"2px solid var(--warning)":void 0},onClick:()=>l(null),children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(234, 179, 8, 0.1)",color:"var(--warning)"},children:e.jsx(Rr,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"stat-value",style:{color:"var(--warning)"},children:J.length}),e.jsx("div",{className:"stat-label",children:"Active Reservations"})]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.25rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>r(hl(t,-7)),children:[e.jsx(Xp,{size:18})," Previous Week"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx($n,{size:20,style:{color:"var(--primary)"}}),e.jsxs("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:0},children:[Ze(d,"MMM d")," - ",Ze(f,"MMM d, yyyy")]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>r(hl(t,7)),children:["Next Week ",e.jsx(bo,{size:18})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0.75rem"},children:M.map(K=>{const ue=Q(K),ce=Ze(K,"yyyy-MM-dd")===Ze(new Date,"yyyy-MM-dd"),ye=K.getDay()===0||K.getDay()===6;return e.jsxs("div",{style:{border:ce?"2px solid var(--primary)":"1px solid var(--border)",borderRadius:"var(--radius)",padding:"1rem",minHeight:"180px",backgroundColor:ye?"var(--bg-secondary)":"white",transition:"box-shadow 0.2s"},children:[e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:600,textTransform:"uppercase",color:ce?"var(--primary)":"var(--text-muted)",letterSpacing:"0.05em"},children:Ze(K,"EEE")}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:600,color:ce?"var(--primary)":"var(--text)"},children:Ze(K,"d")})]}),ue.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:ue.map(Se=>{const V=Y(Se.id),X=o?.id===Se.id;return e.jsxs("div",{onClick:()=>F(Se),style:{backgroundColor:X?"rgba(59, 130, 246, 0.1)":"var(--bg-secondary)",borderRadius:"var(--radius)",padding:"0.625rem",fontSize:"0.75rem",border:X?"2px solid var(--primary)":"1px solid var(--border)",cursor:"pointer",transition:"all 0.2s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.5rem"},children:[e.jsx(Qt,{size:12,style:{color:"var(--text-muted)"}}),e.jsxs("span",{style:{fontWeight:500},children:[Ze(new Date(Se.startTime),"HH:mm"),"-",Ze(new Date(Se.endTime),"HH:mm")]})]}),e.jsx("div",{style:{height:"6px",backgroundColor:"var(--border)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Se.utilizationPercent}%`,height:"100%",backgroundColor:U(Se.utilizationPercent),transition:"width 0.3s"}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.375rem"},children:[e.jsxs("span",{style:{color:"var(--text-muted)"},children:[Se.availableMinutes,"m free"]}),e.jsxs("span",{style:{color:U(Se.utilizationPercent),fontWeight:500},children:[Se.utilizationPercent,"%"]})]}),V.length>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--primary)",marginTop:"0.375rem",fontSize:"0.6875rem"},children:[e.jsx(dc,{size:10}),V.length," reservation",V.length>1?"s":""]})]},Se.id)})}):e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem",textAlign:"center",paddingTop:"2rem",opacity:.7},children:"No windows"})]},K.toISOString())})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(dc,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:o?"Window Reservations":"Active Reservations"}),o&&e.jsxs("span",{className:"badge badge-primary",style:{marginLeft:"0.5rem"},children:[Ze(new Date(o.date),"MMM d")," ",Ze(new Date(o.startTime),"HH:mm"),"-",Ze(new Date(o.endTime),"HH:mm")]})]}),o&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>l(null),children:[e.jsx(Dr,{size:14})," Clear Filter"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Reservation #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Window"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Est. Minutes"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[Z.map(K=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>K.windowId&&l(p?.find(ue=>ue.id===K.windowId)),children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem",fontWeight:500},children:K.reservationNumber}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ts,{size:14,style:{color:"var(--text-muted)"}}),K.customer?.name]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Rr,{size:14,style:{color:"var(--text-muted)"}}),K.product?.name]})}),e.jsx("td",{children:K.window?e.jsxs("span",{style:{fontSize:"0.8125rem",color:"var(--primary)"},children:[Ze(new Date(K.window.startTime),"HH:mm"),"-",Ze(new Date(K.window.endTime),"HH:mm")]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"No window"})}),e.jsx("td",{children:Ze(new Date(K.requestedDate),"MMM d, yyyy")}),e.jsxs("td",{style:{fontWeight:500},children:[K.requestedActivity," ",K.activityUnit]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Qt,{size:12,style:{color:"var(--text-muted)"}}),K.estimatedMinutes," min"]})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${K.status==="CONFIRMED"?"success":"warning"}`,children:K.status})})]},K.id)),Z.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:o?"No reservations for this window":"No active reservations for this period"})})]})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Create Delivery Window"}),e.jsx("button",{onClick:()=>i(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Add a new delivery window for a specific date"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-input",value:A.name,onChange:K=>T({...A,name:K.target.value}),placeholder:"e.g., Morning Delivery Window"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Date"}),e.jsx("input",{type:"date",className:"form-input",value:A.date,onChange:K=>T({...A,date:K.target.value})})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Start Time"}),e.jsx("input",{type:"time",className:"form-input",value:A.startTime,onChange:K=>T({...A,startTime:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"End Time"}),e.jsx("input",{type:"time",className:"form-input",value:A.endTime,onChange:K=>T({...A,endTime:K.target.value})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Capacity (minutes)"}),e.jsx("input",{type:"number",className:"form-input",value:A.capacityMinutes,onChange:K=>T({...A,capacityMinutes:parseInt(K.target.value)||0}),min:"0",step:"30"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:$,disabled:w.isPending,children:w.isPending?"Creating...":"Create Window"})]})]})}),a&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:e.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Generate Delivery Windows"}),e.jsx("button",{onClick:()=>s(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Automatically generate delivery windows for a date range"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Start Date"}),e.jsx("input",{type:"date",className:"form-input",value:O.startDate,onChange:K=>D({...O,startDate:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"End Date"}),e.jsx("input",{type:"date",className:"form-input",value:O.endDate,onChange:K=>D({...O,endDate:K.target.value})})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Start Time"}),e.jsx("input",{type:"time",className:"form-input",value:O.startTime,onChange:K=>D({...O,startTime:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"End Time"}),e.jsx("input",{type:"time",className:"form-input",value:O.endTime,onChange:K=>D({...O,endTime:K.target.value})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Capacity (minutes per day)"}),e.jsx("input",{type:"number",className:"form-input",value:O.capacityMinutes,onChange:K=>D({...O,capacityMinutes:parseInt(K.target.value)||0}),min:"0",step:"30"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:O.excludeWeekends,onChange:K=>D({...O,excludeWeekends:K.target.checked}),style:{width:"16px",height:"16px"}}),e.jsx("span",{className:"form-label",style:{margin:0},children:"Exclude weekends"})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:ee,disabled:C.isPending,children:C.isPending?"Generating...":"Generate Windows"})]})]})})]})}const twe={TENTATIVE:"warning",CONFIRMED:"success",CANCELLED:"default",CONVERTED:"primary",EXPIRED:"default"};function rwe(){const t=gn(),[r,n]=k.useState(!1),[i,a]=k.useState(""),[s,o]=k.useState({customerId:"",productId:"",windowId:"",requestedDate:new Date().toISOString().split("T")[0],requestedActivity:"",numberOfDoses:"1",notes:""}),l=pr(),{data:u,isLoading:d}=Ve({queryKey:["reservations",i],queryFn:async()=>{const F=new URLSearchParams;i&&F.append("status",i);const{data:Y}=await xe.get(`/reservations?${F.toString()}`);return Y}}),{data:f}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:F}=await xe.get("/customers");return F}}),{data:p}=Ve({queryKey:["products"],queryFn:async()=>{const{data:F}=await xe.get("/products");return F}}),{data:x}=Ve({queryKey:["availability-windows"],queryFn:async()=>{const F=new Date().toISOString().split("T")[0],{data:Y}=await xe.get(`/availability/windows?startDate=${F}&isActive=true`);return Y}}),v=ot({mutationFn:async F=>(await xe.post("/reservations",F)).data,onSuccess:()=>{l.invalidateQueries({queryKey:["reservations"]}),l.invalidateQueries({queryKey:["availability-windows"]}),n(!1),T()}}),w=ot({mutationFn:async F=>(await xe.put(`/reservations/${F}/confirm`)).data,onSuccess:()=>{l.invalidateQueries({queryKey:["reservations"]})}}),C=ot({mutationFn:async F=>(await xe.put(`/reservations/${F}/cancel`,{reason:"Cancelled by user"})).data,onSuccess:()=>{l.invalidateQueries({queryKey:["reservations"]}),l.invalidateQueries({queryKey:["availability-windows"]})}}),A=ot({mutationFn:async F=>(await xe.post(`/reservations/${F}/convert`)).data,onSuccess:F=>{l.invalidateQueries({queryKey:["reservations"]}),l.invalidateQueries({queryKey:["orders"]}),t.success("Order Created",`Order ${F.order?.orderNumber||""} created successfully from reservation.`)},onError:F=>{const Y=an(F);t.error("Conversion Failed",Y?.userMessage||"Failed to convert reservation to order.")}}),T=()=>{o({customerId:"",productId:"",windowId:"",requestedDate:new Date().toISOString().split("T")[0],requestedActivity:"",numberOfDoses:"1",notes:""})},O=F=>{o({customerId:F.customerId||"",productId:F.productId||"",windowId:"",requestedDate:new Date().toISOString().split("T")[0],requestedActivity:F.requestedActivity?.toString()||"",numberOfDoses:F.numberOfDoses?.toString()||"1",notes:F.notes||""}),n(!0)},D=async()=>{!s.customerId||!s.productId||!s.requestedActivity||await v.mutateAsync({...s,requestedActivity:parseFloat(s.requestedActivity),numberOfDoses:parseInt(s.numberOfDoses)||1,windowId:s.windowId||void 0})},Q=!s.windowId||!x?null:x.find(F=>F.id===s.windowId),U=Q?Q.capacityMinutes-Q.usedMinutes:0,$=Q?Math.round(Q.usedMinutes/Q.capacityMinutes*100):0,ee={total:u?.length||0,tentative:u?.filter(F=>F.status==="TENTATIVE").length||0,confirmed:u?.filter(F=>F.status==="CONFIRMED").length||0,converted:u?.filter(F=>F.status==="CONVERTED").length||0};return d?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Reservations"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage capacity reservations to prevent overbooking"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>n(!0),children:[e.jsx(cn,{size:16})," New Reservation"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Reservations",value:ee.total,icon:e.jsx($n,{size:20}),color:"primary",onClick:()=>a(""),selected:!i}),e.jsx(nt,{title:"Tentative",value:ee.tentative,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>a("TENTATIVE"),selected:i==="TENTATIVE"}),e.jsx(nt,{title:"Confirmed",value:ee.confirmed,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>a("CONFIRMED"),selected:i==="CONFIRMED"}),e.jsx(nt,{title:"Converted to Orders",value:ee.converted,icon:e.jsx(Fo,{size:20}),color:"info",onClick:()=>a("CONVERTED"),selected:i==="CONVERTED"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1.5rem"},children:e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsx("label",{style:{fontWeight:500},children:"Status:"}),e.jsxs("select",{className:"form-select",style:{width:"auto"},value:i,onChange:F=>a(F.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"TENTATIVE",children:"Tentative"}),e.jsx("option",{value:"CONFIRMED",children:"Confirmed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"}),e.jsx("option",{value:"CONVERTED",children:"Converted"}),e.jsx("option",{value:"EXPIRED",children:"Expired"})]})]})})}),e.jsx("div",{className:"card",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Reservation #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Doses"}),e.jsx("th",{children:"Est. Time"}),e.jsx("th",{children:"Window"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[u?.map(F=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:F.reservationNumber}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ts,{size:14,style:{color:"var(--text-muted)"}}),F.customer?.name]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Rr,{size:14,style:{color:"var(--text-muted)"}}),F.product?.name]})}),e.jsx("td",{children:new Date(F.requestedDate).toLocaleDateString()}),e.jsxs("td",{children:[F.requestedActivity," mCi"]}),e.jsx("td",{children:F.numberOfDoses}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Qt,{size:14,style:{color:"var(--text-muted)"}}),F.estimatedMinutes," min"]})}),e.jsx("td",{children:F.window?e.jsx("span",{style:{fontSize:"0.8125rem"},children:F.window.name||new Date(F.window.date).toLocaleDateString()}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"-"})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${twe[F.status]||"default"}`,children:F.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>O(F),title:"Copy as New",children:e.jsx(RA,{size:14})}),F.status==="TENTATIVE"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>w.mutate(F.id),disabled:w.isPending,title:"Confirm",children:e.jsx(Ai,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>C.mutate(F.id),disabled:C.isPending,title:"Cancel",children:e.jsx(Dr,{size:14})})]}),F.status==="CONFIRMED"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>A.mutate(F.id),disabled:A.isPending,title:"Convert to Order",children:e.jsx(Fo,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>C.mutate(F.id),disabled:C.isPending,title:"Cancel",children:e.jsx(Dr,{size:14})})]})]})})]},F.id)),u?.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:10,style:{textAlign:"center",color:"var(--text-muted)",padding:"3rem"},children:"No reservations found"})})]})]})}),r&&e.jsx("div",{className:"modal-overlay",onClick:()=>n(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"560px"},onClick:F=>F.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"New Reservation"}),e.jsx("button",{onClick:()=>n(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Reserve capacity in a delivery window to prevent overbooking"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Customer *"}),e.jsxs("select",{className:"form-select",value:s.customerId,onChange:F=>o({...s,customerId:F.target.value}),children:[e.jsx("option",{value:"",children:"Select customer"}),f?.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Product *"}),e.jsxs("select",{className:"form-select",value:s.productId,onChange:F=>o({...s,productId:F.target.value}),children:[e.jsx("option",{value:"",children:"Select product"}),p?.map(F=>e.jsxs("option",{value:F.id,children:[F.name," (",F.code,")"]},F.id))]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Window"}),e.jsxs("select",{className:"form-select",value:s.windowId,onChange:F=>o({...s,windowId:F.target.value}),children:[e.jsx("option",{value:"",children:"No specific window"}),x?.map(F=>{const Y=F.capacityMinutes-F.usedMinutes,J=Math.round(F.usedMinutes/F.capacityMinutes*100);return e.jsxs("option",{value:F.id,children:[new Date(F.date).toLocaleDateString()," ",F.startTime,"-",F.endTime," (",Y," min available, ",J,"% used)"]},F.id)})]})]}),Q&&e.jsxs("div",{style:{padding:"0.75rem 1rem",background:$>80?"rgba(239, 68, 68, 0.1)":"rgba(34, 197, 94, 0.1)",borderRadius:"var(--radius)",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[$>80?e.jsx(sn,{size:18,style:{color:"var(--danger)"}}):e.jsx($n,{size:18,style:{color:"var(--success)"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:500,fontSize:"0.875rem"},children:[U," minutes available"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[$,"% capacity used"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Requested Date *"}),e.jsx("input",{type:"date",className:"form-input",value:s.requestedDate,onChange:F=>o({...s,requestedDate:F.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Activity (mCi) *"}),e.jsx("input",{type:"number",className:"form-input",value:s.requestedActivity,onChange:F=>o({...s,requestedActivity:F.target.value}),step:"0.1",placeholder:"e.g., 15"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"No. of Doses"}),e.jsx("input",{type:"number",className:"form-input",value:s.numberOfDoses,onChange:F=>o({...s,numberOfDoses:F.target.value}),min:"1"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-input",value:s.notes,onChange:F=>o({...s,notes:F.target.value}),rows:2,placeholder:"Optional notes about this reservation"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:D,disabled:v.isPending||!s.customerId||!s.productId||!s.requestedActivity,children:v.isPending?"Creating...":"Create Reservation"})]})]})})]})}const Xc="SAR",nwe="en-SA";function Mf(t,r=Xc,n=nwe){if(t==null)return`${Xc} 0.00`;const i=new Intl.NumberFormat(n,{minimumFractionDigits:2,maximumFractionDigits:2}).format(t);return`${r} ${i}`}function ci(t){return Mf(t,Xc)}function iwe(){const[t,r]=k.useState(null),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(""),[u,d]=k.useState("info"),f=pr(),{data:p,isLoading:x}=Ve({queryKey:["contracts",o],queryFn:async()=>{const ce={includeExpired:"true"};o&&(ce.status=o);const{data:ye}=await xe.get("/contracts",{params:ce});return ye}}),{data:v}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:ce}=await xe.get("/customers");return ce}}),{data:w}=Ve({queryKey:["products"],queryFn:async()=>{const{data:ce}=await xe.get("/products");return ce}}),[C,A]=k.useState({customerId:"",name:"",startDate:Ze(new Date,"yyyy-MM-dd"),endDate:Ze(new Date(Date.now()+365*24*60*60*1e3),"yyyy-MM-dd"),paymentTermsDays:30,creditLimit:"",discountPercent:0,notes:""}),[T,O]=k.useState({productId:"",unitPrice:"",priceUnit:"per mCi",minimumQuantity:"",discountPercent:0}),D=ot({mutationFn:async ce=>xe.post("/contracts",ce),onSuccess:()=>{f.invalidateQueries({queryKey:["contracts"]}),i(!1),ee()}}),M=ot({mutationFn:async({contractId:ce,data:ye})=>xe.post(`/contracts/${ce}/price-items`,ye),onSuccess:()=>{if(f.invalidateQueries({queryKey:["contracts"]}),s(!1),F(),t){const ce=p?.find(ye=>ye.id===t.id);ce&&r(ce)}}}),Q=ot({mutationFn:async({contractId:ce,itemId:ye})=>xe.delete(`/contracts/${ce}/price-items/${ye}`),onSuccess:()=>{f.invalidateQueries({queryKey:["contracts"]})}}),U=ot({mutationFn:async ce=>xe.put(`/contracts/${ce}/activate`),onSuccess:()=>{f.invalidateQueries({queryKey:["contracts"]})}}),$=ot({mutationFn:async({id:ce,reason:ye})=>xe.put(`/contracts/${ce}/terminate`,{reason:ye}),onSuccess:()=>{f.invalidateQueries({queryKey:["contracts"]}),r(null)}}),ee=()=>{A({customerId:"",name:"",startDate:Ze(new Date,"yyyy-MM-dd"),endDate:Ze(new Date(Date.now()+365*24*60*60*1e3),"yyyy-MM-dd"),paymentTermsDays:30,creditLimit:"",discountPercent:0,notes:""})},F=()=>{O({productId:"",unitPrice:"",priceUnit:"per mCi",minimumQuantity:"",discountPercent:0})},Y=ce=>({DRAFT:"default",ACTIVE:"success",EXPIRED:"warning",TERMINATED:"danger"})[ce]||"default",J=ce=>{const ye=new Date(ce.startDate).getTime(),Se=new Date(ce.endDate).getTime(),V=Date.now();return V<ye?0:V>Se?100:Math.round((V-ye)/(Se-ye)*100)},Z=ce=>{const ye=new Date(ce.endDate);return ste(ye,new Date)},re=()=>{!C.customerId||!C.name||D.mutate({customerId:C.customerId,name:C.name,startDate:C.startDate,endDate:C.endDate,paymentTermsDays:C.paymentTermsDays,creditLimit:C.creditLimit?parseFloat(C.creditLimit):void 0,discountPercent:C.discountPercent,notes:C.notes||void 0})},de=()=>{!T.productId||!T.unitPrice||!t||M.mutate({contractId:t.id,data:{productId:T.productId,unitPrice:parseFloat(T.unitPrice),priceUnit:T.priceUnit,minimumQuantity:T.minimumQuantity?parseInt(T.minimumQuantity):void 0,discountPercent:T.discountPercent}})},le=p?.filter(ce=>ce.status==="ACTIVE").length||0,K=p?.reduce((ce,ye)=>ce+(ye.creditLimit||0),0)||0;p?.length&&(p.reduce((ce,ye)=>ce+(ye.discountPercent||0),0)/p.length).toFixed(1);const ue=p?.filter(ce=>{if(ce.status!=="ACTIVE")return!1;const ye=Z(ce);return ye>=0&&ye<=30}).length||0;return x?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Contracts & Pricing"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage customer contracts, payment terms, and product pricing"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"140px"},value:o,onChange:ce=>l(ce.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"EXPIRED",children:"Expired"}),e.jsx("option",{value:"TERMINATED",children:"Terminated"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>i(!0),children:[e.jsx(cn,{size:18})," New Contract"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Contracts",value:p?.length||0,icon:e.jsx(Ir,{size:20}),color:"primary",onClick:()=>l(""),selected:!o}),e.jsx(nt,{title:"Active",value:le,icon:e.jsx(Ai,{size:20}),color:"success",onClick:()=>l("ACTIVE"),selected:o==="ACTIVE"}),e.jsx(nt,{title:"Total Credit",value:`${Xc} ${(K/1e3).toFixed(0)}k`,icon:e.jsx(Ul,{size:20}),color:"info"}),e.jsx(nt,{title:"Expiring Soon",value:ue,icon:e.jsx(Hr,{size:20}),color:ue>0?"warning":"default",onClick:()=>l("EXPIRING"),selected:o==="EXPIRING"})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:t?"1fr 420px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{className:"card",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Contract"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Period"}),e.jsx("th",{children:"Credit / Discount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[p?.map(ce=>{const ye=Z(ce),Se=J(ce);return e.jsxs("tr",{style:{cursor:"pointer",backgroundColor:t?.id===ce.id?"var(--bg-secondary)":void 0},onClick:()=>{r(ce),d("info")},children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.125rem"},children:ce.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",fontFamily:"monospace"},children:ce.contractNumber})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ts,{size:16,style:{color:"var(--text-muted)"}})}),e.jsx("span",{style:{fontWeight:500},children:ce.customer?.name})]})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontSize:"0.875rem"},children:Ze(new Date(ce.startDate),"MMM d, yyyy")}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["to ",Ze(new Date(ce.endDate),"MMM d, yyyy")]}),ce.status==="ACTIVE"&&e.jsxs("div",{style:{marginTop:"0.375rem"},children:[e.jsx("div",{style:{height:"4px",background:"var(--border)",borderRadius:"2px",overflow:"hidden",width:"100px"},children:e.jsx("div",{style:{height:"100%",width:`${Se}%`,background:ye<=30?"var(--warning)":"var(--success)",borderRadius:"2px",transition:"width 0.3s ease"}})}),e.jsx("div",{style:{fontSize:"0.6875rem",color:ye<=30?"var(--warning)":"var(--text-muted)",marginTop:"0.125rem"},children:ye>0?`${ye} days left`:"Expired"})]})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Ul,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500},children:ce.creditLimit?ci(ce.creditLimit):"No limit"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(g8,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{color:ce.discountPercent>0?"var(--success)":"var(--text-muted)",fontWeight:ce.discountPercent>0?500:400},children:ce.discountPercent>0?`${ce.discountPercent}% discount`:"No discount"})]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${Y(ce.status)}`,children:ce.status})}),e.jsx("td",{onClick:V=>V.stopPropagation(),children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[ce.status==="DRAFT"&&e.jsx("button",{className:"btn btn-sm btn-secondary",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--success)",border:"none"},onClick:()=>U.mutate(ce.id),disabled:U.isPending,title:"Activate Contract",children:e.jsx(Ai,{size:14})}),ce.status==="ACTIVE"&&e.jsx("button",{className:"btn btn-sm btn-secondary",style:{background:"rgba(239, 68, 68, 0.1)",color:"var(--danger)",border:"none"},onClick:()=>{const V=prompt("Reason for termination:");V&&$.mutate({id:ce.id,reason:V})},disabled:$.isPending,title:"Terminate Contract",children:e.jsx(Dr,{size:14})})]})})]},ce.id)}),(!p||p.length===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,style:{textAlign:"center",color:"var(--text-muted)",padding:"3rem"},children:[e.jsx(tz,{size:40,style:{opacity:.2,marginBottom:"0.75rem"}}),e.jsx("div",{children:"No contracts found"})]})})]})]})}),t&&e.jsxs("div",{className:"card",style:{padding:0},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:e.jsx("span",{className:`badge badge-${Y(t.status)}`,children:t.status})}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",marginBottom:"0.25rem"},children:t.name}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.8125rem",fontFamily:"monospace",margin:0},children:t.contractNumber})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>r(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsx("div",{style:{borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",padding:"0 1rem"},children:[e.jsx("button",{style:{padding:"0.75rem 1rem",background:"none",border:"none",borderBottom:u==="info"?"2px solid var(--primary)":"2px solid transparent",color:u==="info"?"var(--primary)":"var(--text-muted)",fontWeight:500,cursor:"pointer",fontSize:"0.875rem"},onClick:()=>d("info"),children:"Contract Info"}),e.jsxs("button",{style:{padding:"0.75rem 1rem",background:"none",border:"none",borderBottom:u==="pricing"?"2px solid var(--primary)":"2px solid transparent",color:u==="pricing"?"var(--primary)":"var(--text-muted)",fontWeight:500,cursor:"pointer",fontSize:"0.875rem"},onClick:()=>d("pricing"),children:["Product Pricing (",t.priceItems?.length||0,")"]}),e.jsxs("button",{style:{padding:"0.75rem 1rem",background:"none",border:"none",borderBottom:u==="attachments"?"2px solid var(--primary)":"2px solid transparent",color:u==="attachments"?"var(--primary)":"var(--text-muted)",fontWeight:500,cursor:"pointer",fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.375rem"},onClick:()=>d("attachments"),children:[e.jsx(ah,{size:14})," Documents"]})]})}),e.jsxs("div",{style:{padding:"1.25rem"},children:[u==="info"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"1.25rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"white",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsx(Ts,{size:20,style:{color:"var(--primary)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:t.customer?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:t.customer?.code})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsx($n,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Contract Period"})]}),e.jsxs("div",{style:{padding:"1rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Start"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(t.startDate),"MMM d, yyyy")})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"End"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(t.endDate),"MMM d, yyyy")})]})]}),t.status==="ACTIVE"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{height:"6px",background:"var(--border)",borderRadius:"3px",overflow:"hidden",marginBottom:"0.5rem"},children:e.jsx("div",{style:{height:"100%",width:`${J(t)}%`,background:Z(t)<=30?"var(--warning)":"var(--success)",borderRadius:"3px"}})}),e.jsx("div",{style:{fontSize:"0.75rem",color:Z(t)<=30?"var(--warning)":"var(--text-muted)",textAlign:"center"},children:Z(t)>0?`${Z(t)} days remaining`:"Contract has expired"})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx(Qt,{size:18,style:{color:"var(--primary)",marginBottom:"0.375rem"}}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Payment Terms"}),e.jsxs("div",{style:{fontWeight:600,fontSize:"1.125rem"},children:["Net ",t.paymentTermsDays]})]}),e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx(g8,{size:18,style:{color:t.discountPercent>0?"var(--success)":"var(--text-muted)",marginBottom:"0.375rem"}}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Discount"}),e.jsxs("div",{style:{fontWeight:600,fontSize:"1.125rem",color:t.discountPercent>0?"var(--success)":void 0},children:[t.discountPercent,"%"]})]}),e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx(Ul,{size:18,style:{color:"#10b981",marginBottom:"0.375rem"}}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Credit Limit"}),e.jsx("div",{style:{fontWeight:600,fontSize:"1.125rem"},children:t.creditLimit?ci(t.creditLimit):"Unlimited"})]}),e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx(Ir,{size:18,style:{color:"var(--primary)",marginBottom:"0.375rem"}}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Invoices"}),e.jsx("div",{style:{fontWeight:600,fontSize:"1.125rem"},children:t._count?.invoices||0})]})]}),t.notes&&e.jsxs("div",{style:{marginTop:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.5rem"},children:"Notes"}),e.jsx("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",fontSize:"0.875rem",lineHeight:1.5},children:t.notes})]})]}),u==="pricing"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Custom pricing for this contract"}),t.status==="DRAFT"&&e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>s(!0),children:[e.jsx(cn,{size:14})," Add"]})]}),t.priceItems?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.priceItems.map(ce=>e.jsxs("div",{style:{padding:"1rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"8px",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Rr,{size:18,style:{color:"var(--primary)"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.125rem"},children:ce.product?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:ce.product?.code})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--primary)"},children:ci(ce.unitPrice)}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:ce.priceUnit})]}),ce.discountPercent>0&&e.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--success)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:500},children:["-",ce.discountPercent,"%"]}),t.status==="DRAFT"&&e.jsx("button",{className:"btn btn-sm btn-secondary",style:{background:"rgba(239, 68, 68, 0.1)",color:"var(--danger)",border:"none"},onClick:()=>Q.mutate({contractId:t.id,itemId:ce.id}),children:e.jsx(Gi,{size:14})})]},ce.id))}):e.jsxs("div",{style:{textAlign:"center",padding:"2.5rem 1rem",color:"var(--text-muted)",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(PA,{size:32,style:{opacity:.3,marginBottom:"0.75rem"}}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:"No custom pricing"}),e.jsx("div",{style:{fontSize:"0.75rem"},children:"Using default product rates"})]})]}),u==="attachments"&&e.jsx(mc,{entityType:"CONTRACT",entityId:t.id,title:"Contract Documents"})]})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"520px"},onClick:ce=>ce.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"New Contract"}),e.jsx("button",{onClick:()=>i(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Create a new customer contract with payment terms and pricing"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Customer *"}),e.jsxs("select",{className:"form-select",value:C.customerId,onChange:ce=>A({...C,customerId:ce.target.value}),children:[e.jsx("option",{value:"",children:"Select a customer"}),v?.map(ce=>e.jsxs("option",{value:ce.id,children:[ce.name," (",ce.code,")"]},ce.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Contract Name *"}),e.jsx("input",{type:"text",className:"form-input",value:C.name,onChange:ce=>A({...C,name:ce.target.value}),placeholder:"e.g., Annual Supply Agreement 2026"})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Start Date"}),e.jsx("input",{type:"date",className:"form-input",value:C.startDate,onChange:ce=>A({...C,startDate:ce.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"End Date"}),e.jsx("input",{type:"date",className:"form-input",value:C.endDate,onChange:ce=>A({...C,endDate:ce.target.value})})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Payment Terms (days)"}),e.jsx("input",{type:"number",className:"form-input",value:C.paymentTermsDays,onChange:ce=>A({...C,paymentTermsDays:parseInt(ce.target.value)||30})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Credit Limit ($)"}),e.jsx("input",{type:"number",className:"form-input",value:C.creditLimit,onChange:ce=>A({...C,creditLimit:ce.target.value}),placeholder:"Leave empty for no limit"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Contract Discount (%)"}),e.jsx("input",{type:"number",className:"form-input",value:C.discountPercent,onChange:ce=>A({...C,discountPercent:parseFloat(ce.target.value)||0}),min:"0",max:"100",step:"0.5"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-input",value:C.notes,onChange:ce=>A({...C,notes:ce.target.value}),rows:2,placeholder:"Optional notes about this contract"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:re,disabled:D.isPending||!C.customerId||!C.name,children:D.isPending?"Creating...":"Create Contract"})]})]})}),a&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"440px"},onClick:ce=>ce.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Add Product Pricing"}),e.jsx("button",{onClick:()=>s(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Add custom pricing for a product in this contract"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Product *"}),e.jsxs("select",{className:"form-select",value:T.productId,onChange:ce=>O({...T,productId:ce.target.value}),children:[e.jsx("option",{value:"",children:"Select a product"}),w?.filter(ce=>!t?.priceItems?.some(ye=>ye.productId===ce.id)).map(ce=>e.jsxs("option",{value:ce.id,children:[ce.name," (",ce.code,")"]},ce.id))]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Unit Price ($) *"}),e.jsx("input",{type:"number",className:"form-input",value:T.unitPrice,onChange:ce=>O({...T,unitPrice:ce.target.value}),step:"0.01",placeholder:"0.00"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Price Unit"}),e.jsxs("select",{className:"form-select",value:T.priceUnit,onChange:ce=>O({...T,priceUnit:ce.target.value}),children:[e.jsx("option",{value:"per mCi",children:"per mCi"}),e.jsx("option",{value:"per MBq",children:"per MBq"}),e.jsx("option",{value:"per dose",children:"per dose"}),e.jsx("option",{value:"per vial",children:"per vial"})]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Minimum Quantity"}),e.jsx("input",{type:"number",className:"form-input",value:T.minimumQuantity,onChange:ce=>O({...T,minimumQuantity:ce.target.value}),placeholder:"Optional"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Product Discount (%)"}),e.jsx("input",{type:"number",className:"form-input",value:T.discountPercent,onChange:ce=>O({...T,discountPercent:parseFloat(ce.target.value)||0}),min:"0",max:"100",step:"0.5"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:de,disabled:M.isPending||!T.productId||!T.unitPrice,children:M.isPending?"Adding...":"Add Pricing"})]})]})})]})}function zi(t){"@babel/helpers - typeof";return zi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},zi(t)}var _d=Uint8Array,Rc=Uint16Array,X_=Int32Array,J_=new _d([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e3=new _d([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),VR=new _d([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xW=function(t,r){for(var n=new Rc(31),i=0;i<31;++i)n[i]=r+=1<<t[i-1];for(var a=new X_(n[30]),i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)a[s]=s-n[i]<<5|i;return{b:n,r:a}},vW=xW(J_,2),awe=vW.b,nA=vW.r;awe[28]=258,nA[258]=28;var swe=xW(e3,0),$R=swe.r,iA=new Rc(32768);for(var Ea=0;Ea<32768;++Ea){var Gh=(Ea&43690)>>1|(Ea&21845)<<1;Gh=(Gh&52428)>>2|(Gh&13107)<<2,Gh=(Gh&61680)>>4|(Gh&3855)<<4,iA[Ea]=((Gh&65280)>>8|(Gh&255)<<8)>>1}var Rg=(function(t,r,n){for(var i=t.length,a=0,s=new Rc(r);a<i;++a)t[a]&&++s[t[a]-1];var o=new Rc(r);for(a=1;a<r;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(n){l=new Rc(1<<r);var u=15-r;for(a=0;a<i;++a)if(t[a])for(var d=a<<4|t[a],f=r-t[a],p=o[t[a]-1]++<<f,x=p|(1<<f)-1;p<=x;++p)l[iA[p]>>u]=d}else for(l=new Rc(i),a=0;a<i;++a)t[a]&&(l[a]=iA[o[t[a]-1]++]>>15-t[a]);return l}),vm=new _d(288);for(var Ea=0;Ea<144;++Ea)vm[Ea]=8;for(var Ea=144;Ea<256;++Ea)vm[Ea]=9;for(var Ea=256;Ea<280;++Ea)vm[Ea]=7;for(var Ea=280;Ea<288;++Ea)vm[Ea]=8;var Bb=new _d(32);for(var Ea=0;Ea<32;++Ea)Bb[Ea]=5;var owe=Rg(vm,9,0),lwe=Rg(Bb,5,0),bW=function(t){return(t+7)/8|0},cwe=function(t,r,n){return(n==null||n>t.length)&&(n=t.length),new _d(t.subarray(r,n))},Fu=function(t,r,n){n<<=r&7;var i=r/8|0;t[i]|=n,t[i+1]|=n>>8},yg=function(t,r,n){n<<=r&7;var i=r/8|0;t[i]|=n,t[i+1]|=n>>8,t[i+2]|=n>>16},KS=function(t,r){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var a=n.length,s=n.slice();if(!a)return{t:wW,l:0};if(a==1){var o=new _d(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(Q,U){return Q.f-U.f}),n.push({s:-1,f:25001});var l=n[0],u=n[1],d=0,f=1,p=2;for(n[0]={s:-1,f:l.f+u.f,l,r:u};f!=a-1;)l=n[n[d].f<n[p].f?d++:p++],u=n[d!=f&&n[d].f<n[p].f?d++:p++],n[f++]={s:-1,f:l.f+u.f,l,r:u};for(var x=s[0].s,i=1;i<a;++i)s[i].s>x&&(x=s[i].s);var v=new Rc(x+1),w=aA(n[f-1],v,0);if(w>r){var i=0,C=0,A=w-r,T=1<<A;for(s.sort(function(U,$){return v[$.s]-v[U.s]||U.f-$.f});i<a;++i){var O=s[i].s;if(v[O]>r)C+=T-(1<<w-v[O]),v[O]=r;else break}for(C>>=A;C>0;){var D=s[i].s;v[D]<r?C-=1<<r-v[D]++-1:++i}for(;i>=0&&C;--i){var M=s[i].s;v[M]==r&&(--v[M],++C)}w=r}return{t:new _d(v),l:w}},aA=function(t,r,n){return t.s==-1?Math.max(aA(t.l,r,n+1),aA(t.r,r,n+1)):r[t.s]=n},GR=function(t){for(var r=t.length;r&&!t[--r];);for(var n=new Rc(++r),i=0,a=t[0],s=1,o=function(u){n[i++]=u},l=1;l<=r;++l)if(t[l]==a&&l!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:n.subarray(0,i),n:r}},xg=function(t,r){for(var n=0,i=0;i<r.length;++i)n+=t[i]*r[i];return n},jW=function(t,r,n){var i=n.length,a=bW(r+2);t[a]=i&255,t[a+1]=i>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<i;++s)t[a+s+4]=n[s];return(a+4+i)*8},KR=function(t,r,n,i,a,s,o,l,u,d,f){Fu(r,f++,n),++a[256];for(var p=KS(a,15),x=p.t,v=p.l,w=KS(s,15),C=w.t,A=w.l,T=GR(x),O=T.c,D=T.n,M=GR(C),Q=M.c,U=M.n,$=new Rc(19),ee=0;ee<O.length;++ee)++$[O[ee]&31];for(var ee=0;ee<Q.length;++ee)++$[Q[ee]&31];for(var F=KS($,7),Y=F.t,J=F.l,Z=19;Z>4&&!Y[VR[Z-1]];--Z);var re=d+5<<3,de=xg(a,vm)+xg(s,Bb)+o,le=xg(a,x)+xg(s,C)+o+14+3*Z+xg($,Y)+2*$[16]+3*$[17]+7*$[18];if(u>=0&&re<=de&&re<=le)return jW(r,f,t.subarray(u,u+d));var K,ue,ce,ye;if(Fu(r,f,1+(le<de)),f+=2,le<de){K=Rg(x,v,0),ue=x,ce=Rg(C,A,0),ye=C;var Se=Rg(Y,J,0);Fu(r,f,D-257),Fu(r,f+5,U-1),Fu(r,f+10,Z-4),f+=14;for(var ee=0;ee<Z;++ee)Fu(r,f+3*ee,Y[VR[ee]]);f+=3*Z;for(var V=[O,Q],X=0;X<2;++X)for(var se=V[X],ee=0;ee<se.length;++ee){var W=se[ee]&31;Fu(r,f,Se[W]),f+=Y[W],W>15&&(Fu(r,f,se[ee]>>5&127),f+=se[ee]>>12)}}else K=owe,ue=vm,ce=lwe,ye=Bb;for(var ee=0;ee<l;++ee){var oe=i[ee];if(oe>255){var W=oe>>18&31;yg(r,f,K[W+257]),f+=ue[W+257],W>7&&(Fu(r,f,oe>>23&31),f+=J_[W]);var ge=oe&31;yg(r,f,ce[ge]),f+=ye[ge],ge>3&&(yg(r,f,oe>>5&8191),f+=e3[ge])}else yg(r,f,K[oe]),f+=ue[oe]}return yg(r,f,K[256]),f+ue[256]},dwe=new X_([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),wW=new _d(0),uwe=function(t,r,n,i,a,s){var o=s.z||t.length,l=new _d(i+o+5*(1+Math.ceil(o/7e3))+a),u=l.subarray(i,l.length-a),d=s.l,f=(s.r||0)&7;if(r){f&&(u[0]=s.r>>3);for(var p=dwe[r-1],x=p>>13,v=p&8191,w=(1<<n)-1,C=s.p||new Rc(32768),A=s.h||new Rc(w+1),T=Math.ceil(n/3),O=2*T,D=function(Pt){return(t[Pt]^t[Pt+1]<<T^t[Pt+2]<<O)&w},M=new X_(25e3),Q=new Rc(288),U=new Rc(32),$=0,ee=0,F=s.i||0,Y=0,J=s.w||0,Z=0;F+2<o;++F){var re=D(F),de=F&32767,le=A[re];if(C[de]=le,A[re]=de,J<=F){var K=o-F;if(($>7e3||Y>24576)&&(K>423||!d)){f=KR(t,u,0,M,Q,U,ee,Y,Z,F-Z,f),Y=$=ee=0,Z=F;for(var ue=0;ue<286;++ue)Q[ue]=0;for(var ue=0;ue<30;++ue)U[ue]=0}var ce=2,ye=0,Se=v,V=de-le&32767;if(K>2&&re==D(F-V))for(var X=Math.min(x,K)-1,se=Math.min(32767,F),W=Math.min(258,K);V<=se&&--Se&&de!=le;){if(t[F+ce]==t[F+ce-V]){for(var oe=0;oe<W&&t[F+oe]==t[F+oe-V];++oe);if(oe>ce){if(ce=oe,ye=V,oe>X)break;for(var ge=Math.min(V,oe-2),be=0,ue=0;ue<ge;++ue){var Le=F-V+ue&32767,ke=C[Le],He=Le-ke&32767;He>be&&(be=He,le=Le)}}}de=le,le=C[de],V+=de-le&32767}if(ye){M[Y++]=268435456|nA[ce]<<18|$R[ye];var Je=nA[ce]&31,Qe=$R[ye]&31;ee+=J_[Je]+e3[Qe],++Q[257+Je],++U[Qe],J=F+ce,++$}else M[Y++]=t[F],++Q[t[F]]}}for(F=Math.max(F,J);F<o;++F)M[Y++]=t[F],++Q[t[F]];f=KR(t,u,d,M,Q,U,ee,Y,Z,F-Z,f),d||(s.r=f&7|u[f/8|0]<<3,f-=7,s.h=A,s.p=C,s.i=F,s.w=J)}else{for(var F=s.w||0;F<o+d;F+=65535){var vt=F+65535;vt>=o&&(u[f/8|0]=d,vt=o),f=jW(u,f+1,t.subarray(F,vt))}s.i=o}return cwe(l,0,i+bW(f)+a)},SW=function(){var t=1,r=0;return{p:function(n){for(var i=t,a=r,s=n.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=i+=n[o];i=(i&65535)+15*(i>>16),a=(a&65535)+15*(a>>16)}t=i,r=a},d:function(){return t%=65521,r%=65521,(t&255)<<24|(t&65280)<<8|(r&255)<<8|r>>8}}},hwe=function(t,r,n,i,a){if(!a&&(a={l:1},r.dictionary)){var s=r.dictionary.subarray(-32768),o=new _d(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return uwe(t,r.level==null?6:r.level,r.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+r.mem,n,i,a)},CW=function(t,r,n){for(;n;++r)t[r]=n,n>>>=8},fwe=function(t,r){var n=r.level,i=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=i<<6|(r.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,r.dictionary){var a=SW();a.p(r.dictionary),CW(t,2,a.d())}};function sA(t,r){r||(r={});var n=SW();n.p(t);var i=hwe(t,r,r.dictionary?6:2,4);return fwe(i,r),CW(i,i.length-4,n.d()),i}var mwe=typeof TextDecoder<"u"&&new TextDecoder,pwe=0;try{mwe.decode(wW,{stream:!0}),pwe=1}catch{}function gwe(t){if(Array.isArray(t))return t}function ywe(t,r){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,d=!1;try{if(s=(n=n.call(t)).next,r!==0)for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==r);u=!0);}catch(f){d=!0,a=f}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function QR(t,r){(r==null||r>t.length)&&(r=t.length);for(var n=0,i=Array(r);n<r;n++)i[n]=t[n];return i}function xwe(t,r){if(t){if(typeof t=="string")return QR(t,r);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QR(t,r):void 0}}function vwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YR(t,r){return gwe(t)||ywe(t,r)||xwe(t,r)||vwe()}function ZR(t,r="utf8"){return new TextDecoder(r).decode(t)}const bwe=new TextEncoder;function jwe(t){return bwe.encode(t)}const wwe=1024*8,Swe=(()=>{const t=new Uint8Array(4),r=new Uint32Array(t.buffer);return!((r[0]=1)&t[0])})(),QS={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class t3{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=wwe,n={}){let i=!1;typeof r=="number"?r=new ArrayBuffer(r):(i=!0,this.lastWrittenByte=r.byteLength);const a=n.offset?n.offset>>>0:0,s=r.byteLength-a;let o=a;(ArrayBuffer.isView(r)||r instanceof t3)&&(r.byteLength!==r.buffer.byteLength&&(o=r.byteOffset+a),r=r.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=r,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const i=(this.offset+r)*2,a=new Uint8Array(i);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,n){const i=QS[n].BYTES_PER_ELEMENT*r,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+i);if(this.littleEndian===Swe&&n!=="uint8"&&n!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+i));l.reverse();const u=new QS[n](l.buffer);return this.offset+=i,u.reverse(),u}const o=new QS[n](s);return this.offset+=i,o}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let n="";for(let i=0;i<r;i++)n+=this.readChar();return n}readUtf8(r=1){return ZR(this.readBytes(r))}decodeText(r=1,n="utf8"){return ZR(this.readBytes(r),n)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let n=0;n<r.length;n++)this._data.setUint8(this.offset++,r[n]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let n=0;n<r.length;n++)this.writeUint8(r.charCodeAt(n));return this}writeUtf8(r){return this.writeBytes(jwe(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function x0(t){let r=t.length;for(;--r>=0;)t[r]=0}const Cwe=3,Nwe=258,NW=29,Awe=256,Ewe=Awe+1+NW,AW=30,_we=512,Twe=new Array((Ewe+2)*2);x0(Twe);const Iwe=new Array(AW*2);x0(Iwe);const Owe=new Array(_we);x0(Owe);const kwe=new Array(Nwe-Cwe+1);x0(kwe);const Dwe=new Array(NW);x0(Dwe);const Pwe=new Array(AW);x0(Pwe);const Rwe=(t,r,n,i)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do a=a+r[i++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var oA=Rwe;const Mwe=()=>{let t,r=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;r[n]=t}return r},Lwe=new Uint32Array(Mwe()),zwe=(t,r,n,i)=>{const a=Lwe,s=i+n;t^=-1;for(let o=i;o<s;o++)t=t>>>8^a[(t^r[o])&255];return t^-1};var eu=zwe,lA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},EW={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Bwe=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);var Fwe=function(t){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const n=r.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)Bwe(n,i)&&(t[i]=n[i])}}return t},qwe=t=>{let r=0;for(let i=0,a=t.length;i<a;i++)r+=t[i].length;const n=new Uint8Array(r);for(let i=0,a=0,s=t.length;i<s;i++){let o=t[i];n.set(o,a),a+=o.length}return n},_W={assign:Fwe,flattenChunks:qwe};let TW=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{TW=!1}const sy=new Uint8Array(256);for(let t=0;t<256;t++)sy[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;sy[254]=sy[254]=1;var Uwe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let r,n,i,a,s,o=t.length,l=0;for(a=0;a<o;a++)n=t.charCodeAt(a),(n&64512)===55296&&a+1<o&&(i=t.charCodeAt(a+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),a++)),l+=n<128?1:n<2048?2:n<65536?3:4;for(r=new Uint8Array(l),s=0,a=0;s<l;a++)n=t.charCodeAt(a),(n&64512)===55296&&a+1<o&&(i=t.charCodeAt(a+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),a++)),n<128?r[s++]=n:n<2048?(r[s++]=192|n>>>6,r[s++]=128|n&63):n<65536?(r[s++]=224|n>>>12,r[s++]=128|n>>>6&63,r[s++]=128|n&63):(r[s++]=240|n>>>18,r[s++]=128|n>>>12&63,r[s++]=128|n>>>6&63,r[s++]=128|n&63);return r};const Wwe=(t,r)=>{if(r<65534&&t.subarray&&TW)return String.fromCharCode.apply(null,t.length===r?t:t.subarray(0,r));let n="";for(let i=0;i<r;i++)n+=String.fromCharCode(t[i]);return n};var Hwe=(t,r)=>{const n=r||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,r));let i,a;const s=new Array(n*2);for(a=0,i=0;i<n;){let o=t[i++];if(o<128){s[a++]=o;continue}let l=sy[o];if(l>4){s[a++]=65533,i+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&i<n;)o=o<<6|t[i++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return Wwe(s,a)},Vwe=(t,r)=>{r=r||t.length,r>t.length&&(r=t.length);let n=r-1;for(;n>=0&&(t[n]&192)===128;)n--;return n<0||n===0?r:n+sy[t[n]]>r?n:r},cA={string2buf:Uwe,buf2string:Hwe,utf8border:Vwe};function $we(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Gwe=$we;const G1=16209,Kwe=16191;var Qwe=function(r,n){let i,a,s,o,l,u,d,f,p,x,v,w,C,A,T,O,D,M,Q,U,$,ee,F,Y;const J=r.state;i=r.next_in,F=r.input,a=i+(r.avail_in-5),s=r.next_out,Y=r.output,o=s-(n-r.avail_out),l=s+(r.avail_out-257),u=J.dmax,d=J.wsize,f=J.whave,p=J.wnext,x=J.window,v=J.hold,w=J.bits,C=J.lencode,A=J.distcode,T=(1<<J.lenbits)-1,O=(1<<J.distbits)-1;e:do{w<15&&(v+=F[i++]<<w,w+=8,v+=F[i++]<<w,w+=8),D=C[v&T];t:for(;;){if(M=D>>>24,v>>>=M,w-=M,M=D>>>16&255,M===0)Y[s++]=D&65535;else if(M&16){Q=D&65535,M&=15,M&&(w<M&&(v+=F[i++]<<w,w+=8),Q+=v&(1<<M)-1,v>>>=M,w-=M),w<15&&(v+=F[i++]<<w,w+=8,v+=F[i++]<<w,w+=8),D=A[v&O];r:for(;;){if(M=D>>>24,v>>>=M,w-=M,M=D>>>16&255,M&16){if(U=D&65535,M&=15,w<M&&(v+=F[i++]<<w,w+=8,w<M&&(v+=F[i++]<<w,w+=8)),U+=v&(1<<M)-1,U>u){r.msg="invalid distance too far back",J.mode=G1;break e}if(v>>>=M,w-=M,M=s-o,U>M){if(M=U-M,M>f&&J.sane){r.msg="invalid distance too far back",J.mode=G1;break e}if($=0,ee=x,p===0){if($+=d-M,M<Q){Q-=M;do Y[s++]=x[$++];while(--M);$=s-U,ee=Y}}else if(p<M){if($+=d+p-M,M-=p,M<Q){Q-=M;do Y[s++]=x[$++];while(--M);if($=0,p<Q){M=p,Q-=M;do Y[s++]=x[$++];while(--M);$=s-U,ee=Y}}}else if($+=p-M,M<Q){Q-=M;do Y[s++]=x[$++];while(--M);$=s-U,ee=Y}for(;Q>2;)Y[s++]=ee[$++],Y[s++]=ee[$++],Y[s++]=ee[$++],Q-=3;Q&&(Y[s++]=ee[$++],Q>1&&(Y[s++]=ee[$++]))}else{$=s-U;do Y[s++]=Y[$++],Y[s++]=Y[$++],Y[s++]=Y[$++],Q-=3;while(Q>2);Q&&(Y[s++]=Y[$++],Q>1&&(Y[s++]=Y[$++]))}}else if((M&64)===0){D=A[(D&65535)+(v&(1<<M)-1)];continue r}else{r.msg="invalid distance code",J.mode=G1;break e}break}}else if((M&64)===0){D=C[(D&65535)+(v&(1<<M)-1)];continue t}else if(M&32){J.mode=Kwe;break e}else{r.msg="invalid literal/length code",J.mode=G1;break e}break}}while(i<a&&s<l);Q=w>>3,i-=Q,w-=Q<<3,v&=(1<<w)-1,r.next_in=i,r.next_out=s,r.avail_in=i<a?5+(a-i):5-(i-a),r.avail_out=s<l?257+(l-s):257-(s-l),J.hold=v,J.bits=w};const up=15,XR=852,JR=592,e7=0,YS=1,t7=2,Ywe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zwe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Xwe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Jwe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),eSe=(t,r,n,i,a,s,o,l)=>{const u=l.bits;let d=0,f=0,p=0,x=0,v=0,w=0,C=0,A=0,T=0,O=0,D,M,Q,U,$,ee=null,F;const Y=new Uint16Array(up+1),J=new Uint16Array(up+1);let Z=null,re,de,le;for(d=0;d<=up;d++)Y[d]=0;for(f=0;f<i;f++)Y[r[n+f]]++;for(v=u,x=up;x>=1&&Y[x]===0;x--);if(v>x&&(v=x),x===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(p=1;p<x&&Y[p]===0;p++);for(v<p&&(v=p),A=1,d=1;d<=up;d++)if(A<<=1,A-=Y[d],A<0)return-1;if(A>0&&(t===e7||x!==1))return-1;for(J[1]=0,d=1;d<up;d++)J[d+1]=J[d]+Y[d];for(f=0;f<i;f++)r[n+f]!==0&&(o[J[r[n+f]]++]=f);if(t===e7?(ee=Z=o,F=20):t===YS?(ee=Ywe,Z=Zwe,F=257):(ee=Xwe,Z=Jwe,F=0),O=0,f=0,d=p,$=s,w=v,C=0,Q=-1,T=1<<v,U=T-1,t===YS&&T>XR||t===t7&&T>JR)return 1;for(;;){re=d-C,o[f]+1<F?(de=0,le=o[f]):o[f]>=F?(de=Z[o[f]-F],le=ee[o[f]-F]):(de=96,le=0),D=1<<d-C,M=1<<w,p=M;do M-=D,a[$+(O>>C)+M]=re<<24|de<<16|le|0;while(M!==0);for(D=1<<d-1;O&D;)D>>=1;if(D!==0?(O&=D-1,O+=D):O=0,f++,--Y[d]===0){if(d===x)break;d=r[n+o[f]]}if(d>v&&(O&U)!==Q){for(C===0&&(C=v),$+=p,w=d-C,A=1<<w;w+C<x&&(A-=Y[w+C],!(A<=0));)w++,A<<=1;if(T+=1<<w,t===YS&&T>XR||t===t7&&T>JR)return 1;Q=O&U,a[Q]=v<<24|w<<16|$-s|0}}return O!==0&&(a[$+O]=d-C<<24|64<<16|0),l.bits=v,0};var Mg=eSe;const tSe=0,IW=1,OW=2,{Z_FINISH:r7,Z_BLOCK:rSe,Z_TREES:K1,Z_OK:bm,Z_STREAM_END:nSe,Z_NEED_DICT:iSe,Z_STREAM_ERROR:od,Z_DATA_ERROR:kW,Z_MEM_ERROR:DW,Z_BUF_ERROR:aSe,Z_DEFLATED:n7}=EW,aj=16180,i7=16181,a7=16182,s7=16183,o7=16184,l7=16185,c7=16186,d7=16187,u7=16188,h7=16189,Fb=16190,qu=16191,ZS=16192,f7=16193,XS=16194,m7=16195,p7=16196,g7=16197,y7=16198,Q1=16199,Y1=16200,x7=16201,v7=16202,b7=16203,j7=16204,w7=16205,JS=16206,S7=16207,C7=16208,qa=16209,PW=16210,RW=16211,sSe=852,oSe=592,lSe=15,cSe=lSe,N7=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function dSe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _m=t=>{if(!t)return 1;const r=t.state;return!r||r.strm!==t||r.mode<aj||r.mode>RW?1:0},MW=t=>{if(_m(t))return od;const r=t.state;return t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=r.wrap&1),r.mode=aj,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(sSe),r.distcode=r.distdyn=new Int32Array(oSe),r.sane=1,r.back=-1,bm},LW=t=>{if(_m(t))return od;const r=t.state;return r.wsize=0,r.whave=0,r.wnext=0,MW(t)},zW=(t,r)=>{let n;if(_m(t))return od;const i=t.state;return r<0?(n=0,r=-r):(n=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?od:(i.window!==null&&i.wbits!==r&&(i.window=null),i.wrap=n,i.wbits=r,LW(t))},BW=(t,r)=>{if(!t)return od;const n=new dSe;t.state=n,n.strm=t,n.window=null,n.mode=aj;const i=zW(t,r);return i!==bm&&(t.state=null),i},uSe=t=>BW(t,cSe);let A7=!0,eC,tC;const hSe=t=>{if(A7){eC=new Int32Array(512),tC=new Int32Array(32);let r=0;for(;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(Mg(IW,t.lens,0,288,eC,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;Mg(OW,t.lens,0,32,tC,0,t.work,{bits:5}),A7=!1}t.lencode=eC,t.lenbits=9,t.distcode=tC,t.distbits=5},FW=(t,r,n,i)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(r.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>i&&(a=i),s.window.set(r.subarray(n-i,n-i+a),s.wnext),i-=a,i?(s.window.set(r.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},fSe=(t,r)=>{let n,i,a,s,o,l,u,d,f,p,x,v,w,C,A=0,T,O,D,M,Q,U,$,ee;const F=new Uint8Array(4);let Y,J;const Z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_m(t)||!t.output||!t.input&&t.avail_in!==0)return od;n=t.state,n.mode===qu&&(n.mode=ZS),o=t.next_out,a=t.output,u=t.avail_out,s=t.next_in,i=t.input,l=t.avail_in,d=n.hold,f=n.bits,p=l,x=u,ee=bm;e:for(;;)switch(n.mode){case aj:if(n.wrap===0){n.mode=ZS;break}for(;f<16;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(n.wrap&2&&d===35615){n.wbits===0&&(n.wbits=15),n.check=0,F[0]=d&255,F[1]=d>>>8&255,n.check=eu(n.check,F,2,0),d=0,f=0,n.mode=i7;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",n.mode=qa;break}if((d&15)!==n7){t.msg="unknown compression method",n.mode=qa;break}if(d>>>=4,f-=4,$=(d&15)+8,n.wbits===0&&(n.wbits=$),$>15||$>n.wbits){t.msg="invalid window size",n.mode=qa;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=d&512?h7:qu,d=0,f=0;break;case i7:for(;f<16;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(n.flags=d,(n.flags&255)!==n7){t.msg="unknown compression method",n.mode=qa;break}if(n.flags&57344){t.msg="unknown header flags set",n.mode=qa;break}n.head&&(n.head.text=d>>8&1),n.flags&512&&n.wrap&4&&(F[0]=d&255,F[1]=d>>>8&255,n.check=eu(n.check,F,2,0)),d=0,f=0,n.mode=a7;case a7:for(;f<32;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}n.head&&(n.head.time=d),n.flags&512&&n.wrap&4&&(F[0]=d&255,F[1]=d>>>8&255,F[2]=d>>>16&255,F[3]=d>>>24&255,n.check=eu(n.check,F,4,0)),d=0,f=0,n.mode=s7;case s7:for(;f<16;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}n.head&&(n.head.xflags=d&255,n.head.os=d>>8),n.flags&512&&n.wrap&4&&(F[0]=d&255,F[1]=d>>>8&255,n.check=eu(n.check,F,2,0)),d=0,f=0,n.mode=o7;case o7:if(n.flags&1024){for(;f<16;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}n.length=d,n.head&&(n.head.extra_len=d),n.flags&512&&n.wrap&4&&(F[0]=d&255,F[1]=d>>>8&255,n.check=eu(n.check,F,2,0)),d=0,f=0}else n.head&&(n.head.extra=null);n.mode=l7;case l7:if(n.flags&1024&&(v=n.length,v>l&&(v=l),v&&(n.head&&($=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+v),$)),n.flags&512&&n.wrap&4&&(n.check=eu(n.check,i,v,s)),l-=v,s+=v,n.length-=v),n.length))break e;n.length=0,n.mode=c7;case c7:if(n.flags&2048){if(l===0)break e;v=0;do $=i[s+v++],n.head&&$&&n.length<65536&&(n.head.name+=String.fromCharCode($));while($&&v<l);if(n.flags&512&&n.wrap&4&&(n.check=eu(n.check,i,v,s)),l-=v,s+=v,$)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=d7;case d7:if(n.flags&4096){if(l===0)break e;v=0;do $=i[s+v++],n.head&&$&&n.length<65536&&(n.head.comment+=String.fromCharCode($));while($&&v<l);if(n.flags&512&&n.wrap&4&&(n.check=eu(n.check,i,v,s)),l-=v,s+=v,$)break e}else n.head&&(n.head.comment=null);n.mode=u7;case u7:if(n.flags&512){for(;f<16;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(n.wrap&4&&d!==(n.check&65535)){t.msg="header crc mismatch",n.mode=qa;break}d=0,f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=qu;break;case h7:for(;f<32;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}t.adler=n.check=N7(d),d=0,f=0,n.mode=Fb;case Fb:if(n.havedict===0)return t.next_out=o,t.avail_out=u,t.next_in=s,t.avail_in=l,n.hold=d,n.bits=f,iSe;t.adler=n.check=1,n.mode=qu;case qu:if(r===rSe||r===K1)break e;case ZS:if(n.last){d>>>=f&7,f-=f&7,n.mode=JS;break}for(;f<3;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}switch(n.last=d&1,d>>>=1,f-=1,d&3){case 0:n.mode=f7;break;case 1:if(hSe(n),n.mode=Q1,r===K1){d>>>=2,f-=2;break e}break;case 2:n.mode=p7;break;case 3:t.msg="invalid block type",n.mode=qa}d>>>=2,f-=2;break;case f7:for(d>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",n.mode=qa;break}if(n.length=d&65535,d=0,f=0,n.mode=XS,r===K1)break e;case XS:n.mode=m7;case m7:if(v=n.length,v){if(v>l&&(v=l),v>u&&(v=u),v===0)break e;a.set(i.subarray(s,s+v),o),l-=v,s+=v,u-=v,o+=v,n.length-=v;break}n.mode=qu;break;case p7:for(;f<14;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(n.nlen=(d&31)+257,d>>>=5,f-=5,n.ndist=(d&31)+1,d>>>=5,f-=5,n.ncode=(d&15)+4,d>>>=4,f-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=qa;break}n.have=0,n.mode=g7;case g7:for(;n.have<n.ncode;){for(;f<3;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}n.lens[Z[n.have++]]=d&7,d>>>=3,f-=3}for(;n.have<19;)n.lens[Z[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Y={bits:n.lenbits},ee=Mg(tSe,n.lens,0,19,n.lencode,0,n.work,Y),n.lenbits=Y.bits,ee){t.msg="invalid code lengths set",n.mode=qa;break}n.have=0,n.mode=y7;case y7:for(;n.have<n.nlen+n.ndist;){for(;A=n.lencode[d&(1<<n.lenbits)-1],T=A>>>24,O=A>>>16&255,D=A&65535,!(T<=f);){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(D<16)d>>>=T,f-=T,n.lens[n.have++]=D;else{if(D===16){for(J=T+2;f<J;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(d>>>=T,f-=T,n.have===0){t.msg="invalid bit length repeat",n.mode=qa;break}$=n.lens[n.have-1],v=3+(d&3),d>>>=2,f-=2}else if(D===17){for(J=T+3;f<J;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}d>>>=T,f-=T,$=0,v=3+(d&7),d>>>=3,f-=3}else{for(J=T+7;f<J;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}d>>>=T,f-=T,$=0,v=11+(d&127),d>>>=7,f-=7}if(n.have+v>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=qa;break}for(;v--;)n.lens[n.have++]=$}}if(n.mode===qa)break;if(n.lens[256]===0){t.msg="invalid code -- missing end-of-block",n.mode=qa;break}if(n.lenbits=9,Y={bits:n.lenbits},ee=Mg(IW,n.lens,0,n.nlen,n.lencode,0,n.work,Y),n.lenbits=Y.bits,ee){t.msg="invalid literal/lengths set",n.mode=qa;break}if(n.distbits=6,n.distcode=n.distdyn,Y={bits:n.distbits},ee=Mg(OW,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Y),n.distbits=Y.bits,ee){t.msg="invalid distances set",n.mode=qa;break}if(n.mode=Q1,r===K1)break e;case Q1:n.mode=Y1;case Y1:if(l>=6&&u>=258){t.next_out=o,t.avail_out=u,t.next_in=s,t.avail_in=l,n.hold=d,n.bits=f,Qwe(t,x),o=t.next_out,a=t.output,u=t.avail_out,s=t.next_in,i=t.input,l=t.avail_in,d=n.hold,f=n.bits,n.mode===qu&&(n.back=-1);break}for(n.back=0;A=n.lencode[d&(1<<n.lenbits)-1],T=A>>>24,O=A>>>16&255,D=A&65535,!(T<=f);){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(O&&(O&240)===0){for(M=T,Q=O,U=D;A=n.lencode[U+((d&(1<<M+Q)-1)>>M)],T=A>>>24,O=A>>>16&255,D=A&65535,!(M+T<=f);){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}d>>>=M,f-=M,n.back+=M}if(d>>>=T,f-=T,n.back+=T,n.length=D,O===0){n.mode=w7;break}if(O&32){n.back=-1,n.mode=qu;break}if(O&64){t.msg="invalid literal/length code",n.mode=qa;break}n.extra=O&15,n.mode=x7;case x7:if(n.extra){for(J=n.extra;f<J;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,f-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=v7;case v7:for(;A=n.distcode[d&(1<<n.distbits)-1],T=A>>>24,O=A>>>16&255,D=A&65535,!(T<=f);){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if((O&240)===0){for(M=T,Q=O,U=D;A=n.distcode[U+((d&(1<<M+Q)-1)>>M)],T=A>>>24,O=A>>>16&255,D=A&65535,!(M+T<=f);){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}d>>>=M,f-=M,n.back+=M}if(d>>>=T,f-=T,n.back+=T,O&64){t.msg="invalid distance code",n.mode=qa;break}n.offset=D,n.extra=O&15,n.mode=b7;case b7:if(n.extra){for(J=n.extra;f<J;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,f-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=qa;break}n.mode=j7;case j7:if(u===0)break e;if(v=x-u,n.offset>v){if(v=n.offset-v,v>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=qa;break}v>n.wnext?(v-=n.wnext,w=n.wsize-v):w=n.wnext-v,v>n.length&&(v=n.length),C=n.window}else C=a,w=o-n.offset,v=n.length;v>u&&(v=u),u-=v,n.length-=v;do a[o++]=C[w++];while(--v);n.length===0&&(n.mode=Y1);break;case w7:if(u===0)break e;a[o++]=n.length,u--,n.mode=Y1;break;case JS:if(n.wrap){for(;f<32;){if(l===0)break e;l--,d|=i[s++]<<f,f+=8}if(x-=u,t.total_out+=x,n.total+=x,n.wrap&4&&x&&(t.adler=n.check=n.flags?eu(n.check,a,x,o-x):oA(n.check,a,x,o-x)),x=u,n.wrap&4&&(n.flags?d:N7(d))!==n.check){t.msg="incorrect data check",n.mode=qa;break}d=0,f=0}n.mode=S7;case S7:if(n.wrap&&n.flags){for(;f<32;){if(l===0)break e;l--,d+=i[s++]<<f,f+=8}if(n.wrap&4&&d!==(n.total&4294967295)){t.msg="incorrect length check",n.mode=qa;break}d=0,f=0}n.mode=C7;case C7:ee=nSe;break e;case qa:ee=kW;break e;case PW:return DW;case RW:default:return od}return t.next_out=o,t.avail_out=u,t.next_in=s,t.avail_in=l,n.hold=d,n.bits=f,(n.wsize||x!==t.avail_out&&n.mode<qa&&(n.mode<JS||r!==r7))&&FW(t,t.output,t.next_out,x-t.avail_out),p-=t.avail_in,x-=t.avail_out,t.total_in+=p,t.total_out+=x,n.total+=x,n.wrap&4&&x&&(t.adler=n.check=n.flags?eu(n.check,a,x,t.next_out-x):oA(n.check,a,x,t.next_out-x)),t.data_type=n.bits+(n.last?64:0)+(n.mode===qu?128:0)+(n.mode===Q1||n.mode===XS?256:0),(p===0&&x===0||r===r7)&&ee===bm&&(ee=aSe),ee},mSe=t=>{if(_m(t))return od;let r=t.state;return r.window&&(r.window=null),t.state=null,bm},pSe=(t,r)=>{if(_m(t))return od;const n=t.state;return(n.wrap&2)===0?od:(n.head=r,r.done=!1,bm)},gSe=(t,r)=>{const n=r.length;let i,a,s;return _m(t)||(i=t.state,i.wrap!==0&&i.mode!==Fb)?od:i.mode===Fb&&(a=1,a=oA(a,r,n,0),a!==i.check)?kW:(s=FW(t,r,n,n),s?(i.mode=PW,DW):(i.havedict=1,bm))};var ySe=LW,xSe=zW,vSe=MW,bSe=uSe,jSe=BW,wSe=fSe,SSe=mSe,CSe=pSe,NSe=gSe,ASe="pako inflate (from Nodeca project)",Hu={inflateReset:ySe,inflateReset2:xSe,inflateResetKeep:vSe,inflateInit:bSe,inflateInit2:jSe,inflate:wSe,inflateEnd:SSe,inflateGetHeader:CSe,inflateSetDictionary:NSe,inflateInfo:ASe};function ESe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var _Se=ESe;const qW=Object.prototype.toString,{Z_NO_FLUSH:TSe,Z_FINISH:ISe,Z_OK:oy,Z_STREAM_END:rC,Z_NEED_DICT:nC,Z_STREAM_ERROR:OSe,Z_DATA_ERROR:E7,Z_MEM_ERROR:kSe}=EW;function Gy(t){this.options=_W.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(t&&t.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gwe,this.strm.avail_out=0;let n=Hu.inflateInit2(this.strm,r.windowBits);if(n!==oy)throw new Error(lA[n]);if(this.header=new _Se,Hu.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=cA.string2buf(r.dictionary):qW.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(n=Hu.inflateSetDictionary(this.strm,r.dictionary),n!==oy)))throw new Error(lA[n])}Gy.prototype.push=function(t,r){const n=this.strm,i=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(r===~~r?o=r:o=r===!0?ISe:TSe,qW.call(t)==="[object ArrayBuffer]"?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=Hu.inflate(n,o),s===nC&&a&&(s=Hu.inflateSetDictionary(n,a),s===oy?s=Hu.inflate(n,o):s===E7&&(s=nC));n.avail_in>0&&s===rC&&n.state.wrap>0&&t[n.next_in]!==0;)Hu.inflateReset(n),s=Hu.inflate(n,o);switch(s){case OSe:case E7:case nC:case kSe:return this.onEnd(s),this.ended=!0,!1}if(l=n.avail_out,n.next_out&&(n.avail_out===0||s===rC))if(this.options.to==="string"){let u=cA.utf8border(n.output,n.next_out),d=n.next_out-u,f=cA.buf2string(n.output,u);n.next_out=d,n.avail_out=i-d,d&&n.output.set(n.output.subarray(u,u+d),0),this.onData(f)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===oy&&l===0)){if(s===rC)return s=Hu.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Gy.prototype.onData=function(t){this.chunks.push(t)};Gy.prototype.onEnd=function(t){t===oy&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_W.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function DSe(t,r){const n=new Gy(r);if(n.push(t),n.err)throw n.msg||lA[n.err];return n.result}var PSe=Gy,RSe=DSe,MSe={Inflate:PSe,inflate:RSe};const{Inflate:LSe,inflate:zSe}=MSe;var _7=LSe,BSe=zSe;const UW=[];for(let t=0;t<256;t++){let r=t;for(let n=0;n<8;n++)r&1?r=3988292384^r>>>1:r=r>>>1;UW[t]=r}const T7=4294967295;function FSe(t,r,n){let i=t;for(let a=0;a<n;a++)i=UW[(i^r[a])&255]^i>>>8;return i}function qSe(t,r){return(FSe(T7,t,r)^T7)>>>0}function I7(t,r,n){const i=t.readUint32(),a=qSe(new Uint8Array(t.buffer,t.byteOffset+t.offset-r-4,r),r);if(a!==i)throw new Error(`CRC mismatch for chunk ${n}. Expected ${i}, found ${a}`)}function WW(t,r,n){for(let i=0;i<n;i++)r[i]=t[i]}function HW(t,r,n,i){let a=0;for(;a<i;a++)r[a]=t[a];for(;a<n;a++)r[a]=t[a]+r[a-i]&255}function VW(t,r,n,i){let a=0;if(n.length===0)for(;a<i;a++)r[a]=t[a];else for(;a<i;a++)r[a]=t[a]+n[a]&255}function $W(t,r,n,i,a){let s=0;if(n.length===0){for(;s<a;s++)r[s]=t[s];for(;s<i;s++)r[s]=t[s]+(r[s-a]>>1)&255}else{for(;s<a;s++)r[s]=t[s]+(n[s]>>1)&255;for(;s<i;s++)r[s]=t[s]+(r[s-a]+n[s]>>1)&255}}function GW(t,r,n,i,a){let s=0;if(n.length===0){for(;s<a;s++)r[s]=t[s];for(;s<i;s++)r[s]=t[s]+r[s-a]&255}else{for(;s<a;s++)r[s]=t[s]+n[s]&255;for(;s<i;s++)r[s]=t[s]+USe(r[s-a],n[s],n[s-a])&255}}function USe(t,r,n){const i=t+r-n,a=Math.abs(i-t),s=Math.abs(i-r),o=Math.abs(i-n);return a<=s&&a<=o?t:s<=o?r:n}function WSe(t,r,n,i,a,s){switch(t){case 0:WW(r,n,a);break;case 1:HW(r,n,a,s);break;case 2:VW(r,n,i,a);break;case 3:$W(r,n,i,a,s);break;case 4:GW(r,n,i,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const HSe=new Uint16Array([255]),VSe=new Uint8Array(HSe.buffer),$Se=VSe[0]===255;function GSe(t){const{data:r,width:n,height:i,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,u=new Uint8Array(i*n*l);let d=0;for(let f=0;f<7;f++){const p=o[f],x=Math.ceil((n-p.x)/p.xStep),v=Math.ceil((i-p.y)/p.yStep);if(x<=0||v<=0)continue;const w=x*l,C=new Uint8Array(w);for(let A=0;A<v;A++){const T=r[d++],O=r.subarray(d,d+w);d+=w;const D=new Uint8Array(w);WSe(T,O,D,C,w,l),C.set(D);for(let M=0;M<x;M++){const Q=p.x+M*p.xStep,U=p.y+A*p.yStep;if(!(Q>=n||U>=i))for(let $=0;$<l;$++)u[(U*n+Q)*l+$]=D[M*l+$]}}}if(s===16){const f=new Uint16Array(u.buffer);if($Se)for(let p=0;p<f.length;p++)f[p]=KSe(f[p]);return f}else return u}function KSe(t){return(t&255)<<8|t>>8&255}const QSe=new Uint16Array([255]),YSe=new Uint8Array(QSe.buffer),ZSe=YSe[0]===255,XSe=new Uint8Array(0);function O7(t){const{data:r,width:n,height:i,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*n),u=new Uint8Array(i*l);let d=XSe,f=0,p,x;for(let v=0;v<i;v++){switch(p=r.subarray(f+1,f+1+l),x=u.subarray(v*l,(v+1)*l),r[f]){case 0:WW(p,x,l);break;case 1:HW(p,x,l,o);break;case 2:VW(p,x,d,l);break;case 3:$W(p,x,d,l,o);break;case 4:GW(p,x,d,l,o);break;default:throw new Error(`Unsupported filter: ${r[f]}`)}d=x,f+=l+1}if(s===16){const v=new Uint16Array(u.buffer);if(ZSe)for(let w=0;w<v.length;w++)v[w]=JSe(v[w]);return v}else return u}function JSe(t){return(t&255)<<8|t>>8&255}const wv=Uint8Array.of(137,80,78,71,13,10,26,10);function k7(t){if(!eCe(t.readBytes(wv.length)))throw new Error("wrong PNG signature")}function eCe(t){if(t.length<wv.length)return!1;for(let r=0;r<wv.length;r++)if(t[r]!==wv[r])return!1;return!0}const tCe="tEXt",rCe=0,KW=new TextDecoder("latin1");function nCe(t){if(aCe(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const iCe=/^[\u0000-\u00FF]*$/;function aCe(t){if(!iCe.test(t))throw new Error("invalid latin1 text")}function sCe(t,r,n){const i=QW(r);t[i]=oCe(r,n-i.length-1)}function QW(t){for(t.mark();t.readByte()!==rCe;);const r=t.offset;t.reset();const n=KW.decode(t.readBytes(r-t.offset-1));return t.skip(1),nCe(n),n}function oCe(t,r){return KW.decode(t.readBytes(r))}const Ec={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},iC={UNKNOWN:-1,DEFLATE:0},D7={UNKNOWN:-1,ADAPTIVE:0},aC={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Z1={NONE:0,BACKGROUND:1,PREVIOUS:2},sC={SOURCE:0,OVER:1};class lCe extends t3{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,n={}){super(r);const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new _7,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=iC.UNKNOWN,this._filterMethod=D7.UNKNOWN,this._interlaceMethod=aC.UNKNOWN,this._colorType=Ec.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(k7(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(k7(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case tCe:sCe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?I7(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?I7(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=cCe(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case Ec.GREYSCALE:i=1;break;case Ec.TRUECOLOUR:i=3;break;case Ec.INDEXED_COLOUR:i=1;break;case Ec.GREYSCALE_ALPHA:i=2;break;case Ec.TRUECOLOUR_ALPHA:i=4;break;case Ec.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==iC.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let a=0;a<n;a++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Ec.GREYSCALE:case Ec.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Ec.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ec.UNKNOWN:case Ec.GREYSCALE_ALPHA:case Ec.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=QW(this),i=this.readUint8();if(i!==iC.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:BSe(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=O7({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(i,a,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case Z1.NONE:break;case Z1.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let s=0;s<this._png.width;s++){const o=(a*r.width+s)*this._png.channels;for(let l=0;l<this._png.channels;l++)i.data[o+l]=0}break;case Z1.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,a=(s,o)=>{const l=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,u=(s*n.width+o)*this._png.channels;return{index:l,frameIndex:u}};switch(n.blendOp){case sC.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=a(s,o);for(let d=0;d<this._png.channels;d++)r.data[l+d]=n.data[u+d]}break;case sC.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=a(s,o);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/i,p=d%(this._png.channels-1)===0?1:n.data[u+d],x=Math.floor(f*p+(1-f)*r.data[l+d]);r.data[l+d]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==D7.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===aC.NO_INTERLACE)this._png.data=O7({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===aC.ADAM7)this._png.data=GSe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Z1.NONE,blendOp:sC.SOURCE,data:r}),this._inflator=new _7,this._writingDataChunks=!1}}function cCe(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var P7;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(P7||(P7={}));function dCe(t,r){return new lCe(t,r).decode()}var hn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function oC(){hn.console&&typeof hn.console.log=="function"&&hn.console.log.apply(hn.console,arguments)}var na={log:oC,warn:function(t){hn.console&&(typeof hn.console.warn=="function"?hn.console.warn.apply(hn.console,arguments):oC.call(null,arguments))},error:function(t){hn.console&&(typeof hn.console.error=="function"?hn.console.error.apply(hn.console,arguments):oC(t))}};function lC(t,r,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){Lf(i.response,r,n)},i.onerror=function(){na.error("could not download file")},i.send()}function R7(t){var r=new XMLHttpRequest;r.open("HEAD",t,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function X1(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}}var Lf=hn.saveAs||((typeof window>"u"?"undefined":zi(window))!=="object"||window!==hn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,r,n){var i=hn.URL||hn.webkitURL,a=document.createElement("a");r=r||t.name||"download",a.download=r,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?R7(a.href)?lC(t,r,n):X1(a,a.target="_blank"):X1(a)):(a.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(a.href)},4e4),setTimeout(function(){X1(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,n){if(r=r||t.name||"download",typeof t=="string")if(R7(t))lC(t,r,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){X1(i)})}else navigator.msSaveOrOpenBlob((function(a,s){return s===void 0?s={autoBom:!1}:zi(s)!=="object"&&(na.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a})(t,n),r)}:function(t,r,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof t=="string")return lC(t,r,n);var a=t.type==="application/octet-stream",s=/constructor/i.test(hn.HTMLElement)||hn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":zi(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=f:location=f,i=null},l.readAsDataURL(t)}else{var u=hn.URL||hn.webkitURL,d=u.createObjectURL(t);i?i.location=d:location.href=d,i=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});function YW(t){var r;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],i=0;i<n.length;i++){var a=n[i].re,s=n[i].process,o=a.exec(t);o&&(r=s(o),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),u=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),d.length==1&&(d="0"+d),"#"+l+u+d}}var Sv=hn.atob.bind(hn),M7=hn.btoa.bind(hn);function cC(t,r){var n=t[0],i=t[1],a=t[2],s=t[3];n=jl(n,i,a,s,r[0],7,-680876936),s=jl(s,n,i,a,r[1],12,-389564586),a=jl(a,s,n,i,r[2],17,606105819),i=jl(i,a,s,n,r[3],22,-1044525330),n=jl(n,i,a,s,r[4],7,-176418897),s=jl(s,n,i,a,r[5],12,1200080426),a=jl(a,s,n,i,r[6],17,-1473231341),i=jl(i,a,s,n,r[7],22,-45705983),n=jl(n,i,a,s,r[8],7,1770035416),s=jl(s,n,i,a,r[9],12,-1958414417),a=jl(a,s,n,i,r[10],17,-42063),i=jl(i,a,s,n,r[11],22,-1990404162),n=jl(n,i,a,s,r[12],7,1804603682),s=jl(s,n,i,a,r[13],12,-40341101),a=jl(a,s,n,i,r[14],17,-1502002290),n=wl(n,i=jl(i,a,s,n,r[15],22,1236535329),a,s,r[1],5,-165796510),s=wl(s,n,i,a,r[6],9,-1069501632),a=wl(a,s,n,i,r[11],14,643717713),i=wl(i,a,s,n,r[0],20,-373897302),n=wl(n,i,a,s,r[5],5,-701558691),s=wl(s,n,i,a,r[10],9,38016083),a=wl(a,s,n,i,r[15],14,-660478335),i=wl(i,a,s,n,r[4],20,-405537848),n=wl(n,i,a,s,r[9],5,568446438),s=wl(s,n,i,a,r[14],9,-1019803690),a=wl(a,s,n,i,r[3],14,-187363961),i=wl(i,a,s,n,r[8],20,1163531501),n=wl(n,i,a,s,r[13],5,-1444681467),s=wl(s,n,i,a,r[2],9,-51403784),a=wl(a,s,n,i,r[7],14,1735328473),n=Sl(n,i=wl(i,a,s,n,r[12],20,-1926607734),a,s,r[5],4,-378558),s=Sl(s,n,i,a,r[8],11,-2022574463),a=Sl(a,s,n,i,r[11],16,1839030562),i=Sl(i,a,s,n,r[14],23,-35309556),n=Sl(n,i,a,s,r[1],4,-1530992060),s=Sl(s,n,i,a,r[4],11,1272893353),a=Sl(a,s,n,i,r[7],16,-155497632),i=Sl(i,a,s,n,r[10],23,-1094730640),n=Sl(n,i,a,s,r[13],4,681279174),s=Sl(s,n,i,a,r[0],11,-358537222),a=Sl(a,s,n,i,r[3],16,-722521979),i=Sl(i,a,s,n,r[6],23,76029189),n=Sl(n,i,a,s,r[9],4,-640364487),s=Sl(s,n,i,a,r[12],11,-421815835),a=Sl(a,s,n,i,r[15],16,530742520),n=Cl(n,i=Sl(i,a,s,n,r[2],23,-995338651),a,s,r[0],6,-198630844),s=Cl(s,n,i,a,r[7],10,1126891415),a=Cl(a,s,n,i,r[14],15,-1416354905),i=Cl(i,a,s,n,r[5],21,-57434055),n=Cl(n,i,a,s,r[12],6,1700485571),s=Cl(s,n,i,a,r[3],10,-1894986606),a=Cl(a,s,n,i,r[10],15,-1051523),i=Cl(i,a,s,n,r[1],21,-2054922799),n=Cl(n,i,a,s,r[8],6,1873313359),s=Cl(s,n,i,a,r[15],10,-30611744),a=Cl(a,s,n,i,r[6],15,-1560198380),i=Cl(i,a,s,n,r[13],21,1309151649),n=Cl(n,i,a,s,r[4],6,-145523070),s=Cl(s,n,i,a,r[11],10,-1120210379),a=Cl(a,s,n,i,r[2],15,718787259),i=Cl(i,a,s,n,r[9],21,-343485551),t[0]=rf(n,t[0]),t[1]=rf(i,t[1]),t[2]=rf(a,t[2]),t[3]=rf(s,t[3])}function sj(t,r,n,i,a,s){return r=rf(rf(r,t),rf(i,s)),rf(r<<a|r>>>32-a,n)}function jl(t,r,n,i,a,s,o){return sj(r&n|~r&i,t,r,a,s,o)}function wl(t,r,n,i,a,s,o){return sj(r&i|n&~i,t,r,a,s,o)}function Sl(t,r,n,i,a,s,o){return sj(r^n^i,t,r,a,s,o)}function Cl(t,r,n,i,a,s,o){return sj(n^(r|~i),t,r,a,s,o)}function ZW(t){var r,n=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=t.length;r+=64)cC(i,uCe(t.substring(r-64,r)));t=t.substring(r-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<t.length;r++)a[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(a[r>>2]|=128<<(r%4<<3),r>55)for(cC(i,a),r=0;r<16;r++)a[r]=0;return a[14]=8*n,cC(i,a),i}function uCe(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return n}var L7="0123456789abcdef".split("");function hCe(t){for(var r="",n=0;n<4;n++)r+=L7[t>>8*n+4&15]+L7[t>>8*n&15];return r}function fCe(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function dA(t){return ZW(t).map(fCe).join("")}var mCe=(function(t){for(var r=0;r<t.length;r++)t[r]=hCe(t[r]);return t.join("")})(ZW("hello"))!="5d41402abc4b2a76b9719d911017c592";function rf(t,r){if(mCe){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n}return t+r&4294967295}function uA(t,r){var n,i,a,s;if(t!==n){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],u=0;u<256;u++)l[u]=u;var d=0;for(u=0;u<256;u++){var f=l[u];d=(d+f+o.charCodeAt(u))%256,l[u]=l[d],l[d]=f}n=t,i=l}else l=i;var p=r.length,x=0,v=0,w="";for(u=0;u<p;u++)v=(v+(f=l[x=(x+1)%256]))%256,l[x]=l[v],l[v]=f,o=l[(l[x]+l[v])%256],w+=String.fromCharCode(r.charCodeAt(u)^o);return w}var z7={print:4,modify:8,copy:16,"annot-forms":32};function yp(t,r,n,i){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(z7.perm!==void 0)throw new Error("Invalid permission: "+l);a+=z7[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(r+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=dA(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=uA(this.encryptionKey,this.padding)}function xp(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var r="",n=t.length,i=0;i<n;i++){var a=t.charCodeAt(i);r+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[i]}return r}function B7(t){if(zi(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(n,i,a){if(a=a||!1,typeof n!="string"||typeof i!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(n)||(r[n]={});var s=Math.random().toString(35);return r[n][s]=[i,!!a],s},this.unsubscribe=function(n){for(var i in r)if(r[i][n])return delete r[i][n],Object.keys(r[i]).length===0&&delete r[i],!0;return!1},this.publish=function(n){if(r.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),a=[];for(var s in r[n]){var o=r[n][s];try{o[0].apply(t,i)}catch(l){hn.console&&na.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function qb(t){if(!(this instanceof qb))return new qb(t);var r="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&r.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function XW(t,r){this.gState=t,this.matrix=r,this.id="",this.objectNumber=-1}function Ff(t,r,n,i,a){if(!(this instanceof Ff))return new Ff(t,r,n,i,a);this.type=t==="axial"?2:3,this.coords=r,this.colors=n,XW.call(this,i,a)}function Sp(t,r,n,i,a){if(!(this instanceof Sp))return new Sp(t,r,n,i,a);this.boundingBox=t,this.xStep=r,this.yStep=n,this.stream="",this.cloneIndex=0,XW.call(this,i,a)}function Br(t){var r,n=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,u=16,d="S",f=null;zi(t=t||{})==="object"&&(n=t.orientation,i=t.unit||i,a=t.format||a,s=t.compress||t.compressPdf||s,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(r=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),i=i||"mm",n=(""+(n||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,x={},v={internal:{},__private__:{}};v.__private__.PubSub=B7;var w="1.3",C=v.__private__.getPdfVersion=function(){return w};v.__private__.setPdfVersion=function(te){w=te};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};v.__private__.getPageFormats=function(){return A};var T=v.__private__.getPageFormat=function(te){return A[te]};a=a||"a4";var O="compat",D="advanced",M=O;function Q(){this.saveGraphicsState(),Oe(new vr(tn,0,0,-tn,0,Rl()*tn).toString()+" cm"),this.setFontSize(this.getFontSize()/tn),d="n",M=D}function U(){this.restoreGraphicsState(),d="S",M=O}var $=v.__private__.combineFontStyleAndFontWeight=function(te,we){if(te=="bold"&&we=="normal"||te=="bold"&&we==400||te=="normal"&&we=="italic"||te=="bold"&&we=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return we&&(te=we==400||we==="normal"?te==="italic"?"italic":"normal":we!=700&&we!=="bold"||te!=="normal"?(we==700?"bold":we)+""+te:"bold"),te};v.advancedAPI=function(te){var we=M===O;return we&&Q.call(this),typeof te!="function"||(te(this),we&&U.call(this)),this},v.compatAPI=function(te){var we=M===D;return we&&U.call(this),typeof te!="function"||(te(this),we&&Q.call(this)),this},v.isAdvancedAPI=function(){return M===D};var ee,F=function(te){if(M!==D)throw new Error(te+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Y=v.roundToPrecision=v.__private__.roundToPrecision=function(te,we){var Re=r||we;if(isNaN(te)||isNaN(Re))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return te.toFixed(Re).replace(/0+$/,"")};ee=v.hpf=v.__private__.hpf=typeof u=="number"?function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(te,u)}:u==="smart"?function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(te,te>-1&&te<1?16:5)}:function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(te,16)};var J=v.f2=v.__private__.f2=function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.f2");return Y(te,2)},Z=v.__private__.f3=function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.f3");return Y(te,3)},re=v.scale=v.__private__.scale=function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.scale");return M===O?te*tn:M===D?te:void 0},de=function(te){return re((function(we){return M===O?Rl()-we:M===D?we:void 0})(te))};v.__private__.setPrecision=v.setPrecision=function(te){typeof parseInt(te,10)=="number"&&(r=parseInt(te,10))};var le,K="00000000000000000000000000000000",ue=v.__private__.getFileId=function(){return K},ce=v.__private__.setFileId=function(te){return K=te!==void 0&&/^[a-fA-F0-9]{32}$/.test(te)?te.toUpperCase():K.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(di=new yp(f.userPermissions,f.userPassword,f.ownerPassword,K)),K};v.setFileId=function(te){return ce(te),this},v.getFileId=function(){return ue()};var ye=v.__private__.convertDateToPDFDate=function(te){var we=te.getTimezoneOffset(),Re=we<0?"+":"-",We=Math.floor(Math.abs(we/60)),et=Math.abs(we%60),Ct=[Re,W(We),"'",W(et),"'"].join("");return["D:",te.getFullYear(),W(te.getMonth()+1),W(te.getDate()),W(te.getHours()),W(te.getMinutes()),W(te.getSeconds()),Ct].join("")},Se=v.__private__.convertPDFDateToDate=function(te){var we=parseInt(te.substr(2,4),10),Re=parseInt(te.substr(6,2),10)-1,We=parseInt(te.substr(8,2),10),et=parseInt(te.substr(10,2),10),Ct=parseInt(te.substr(12,2),10),Lt=parseInt(te.substr(14,2),10);return new Date(we,Re,We,et,Ct,Lt,0)},V=v.__private__.setCreationDate=function(te){var we;if(te===void 0&&(te=new Date),te instanceof Date)we=ye(te);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(te))throw new Error("Invalid argument passed to jsPDF.setCreationDate");we=te}return le=we},X=v.__private__.getCreationDate=function(te){var we=le;return te==="jsDate"&&(we=Se(le)),we};v.setCreationDate=function(te){return V(te),this},v.getCreationDate=function(te){return X(te)};var se,W=v.__private__.padd2=function(te){return("0"+parseInt(te)).slice(-2)},oe=v.__private__.padd2Hex=function(te){return("00"+(te=te.toString())).substr(te.length)},ge=0,be=[],Le=[],ke=0,He=[],Je=[],Qe=!1,vt=Le;v.__private__.setCustomOutputDestination=function(te){Qe=!0,vt=te};var Pt=function(te){Qe||(vt=te)};v.__private__.resetCustomOutputDestination=function(){Qe=!1,vt=Le};var Oe=v.__private__.out=function(te){return te=te.toString(),ke+=te.length+1,vt.push(te),vt},st=v.__private__.write=function(te){return Oe(arguments.length===1?te.toString():Array.prototype.join.call(arguments," "))},Wt=v.__private__.getArrayBuffer=function(te){for(var we=te.length,Re=new ArrayBuffer(we),We=new Uint8Array(Re);we--;)We[we]=te.charCodeAt(we);return Re},Bt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];v.__private__.getStandardFonts=function(){return Bt};var yt=t.fontSize||16;v.__private__.setFontSize=v.setFontSize=function(te){return yt=M===D?te/tn:te,this};var rr,St=v.__private__.getFontSize=v.getFontSize=function(){return M===O?yt:yt*tn},xr=t.R2L||!1;v.__private__.setR2L=v.setR2L=function(te){return xr=te,this},v.__private__.getR2L=v.getR2L=function(){return xr};var hr,zr=v.__private__.setZoomMode=function(te){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(te))rr=te;else if(isNaN(te)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(te)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+te+'" is not recognized.');rr=te}else rr=parseInt(te,10)};v.__private__.getZoomMode=function(){return rr};var yn,Or=v.__private__.setPageMode=function(te){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(te)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+te+'" is not recognized.');hr=te};v.__private__.getPageMode=function(){return hr};var xn=v.__private__.setLayoutMode=function(te){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(te)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+te+'" is not recognized.');yn=te};v.__private__.getLayoutMode=function(){return yn},v.__private__.setDisplayMode=v.setDisplayMode=function(te,we,Re){return zr(te),xn(we),Or(Re),this};var Yr={title:"",subject:"",author:"",keywords:"",creator:""};v.__private__.getDocumentProperty=function(te){if(Object.keys(Yr).indexOf(te)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Yr[te]},v.__private__.getDocumentProperties=function(){return Yr},v.__private__.setDocumentProperties=v.setProperties=v.setDocumentProperties=function(te){for(var we in Yr)Yr.hasOwnProperty(we)&&te[we]&&(Yr[we]=te[we]);return this},v.__private__.setDocumentProperty=function(te,we){if(Object.keys(Yr).indexOf(te)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Yr[te]=we};var tr,tn,fr,Yi,Er,wt={},sr={},ur=[],Yt={},Kn={},Fr={},Kr={},Sr=null,Qr=0,_r=[],On=new B7(v),Zi=t.hotfixes||[],Ia={},vi={},$a=[],vr=function te(we,Re,We,et,Ct,Lt){if(!(this instanceof te))return new te(we,Re,We,et,Ct,Lt);isNaN(we)&&(we=1),isNaN(Re)&&(Re=0),isNaN(We)&&(We=0),isNaN(et)&&(et=1),isNaN(Ct)&&(Ct=0),isNaN(Lt)&&(Lt=0),this._matrix=[we,Re,We,et,Ct,Lt]};Object.defineProperty(vr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(te){this._matrix[0]=te}}),Object.defineProperty(vr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(te){this._matrix[1]=te}}),Object.defineProperty(vr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(te){this._matrix[2]=te}}),Object.defineProperty(vr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(te){this._matrix[3]=te}}),Object.defineProperty(vr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(te){this._matrix[4]=te}}),Object.defineProperty(vr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(te){this._matrix[5]=te}}),Object.defineProperty(vr.prototype,"a",{get:function(){return this._matrix[0]},set:function(te){this._matrix[0]=te}}),Object.defineProperty(vr.prototype,"b",{get:function(){return this._matrix[1]},set:function(te){this._matrix[1]=te}}),Object.defineProperty(vr.prototype,"c",{get:function(){return this._matrix[2]},set:function(te){this._matrix[2]=te}}),Object.defineProperty(vr.prototype,"d",{get:function(){return this._matrix[3]},set:function(te){this._matrix[3]=te}}),Object.defineProperty(vr.prototype,"e",{get:function(){return this._matrix[4]},set:function(te){this._matrix[4]=te}}),Object.defineProperty(vr.prototype,"f",{get:function(){return this._matrix[5]},set:function(te){this._matrix[5]=te}}),Object.defineProperty(vr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vr.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vr.prototype.join=function(te){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ee).join(te)},vr.prototype.multiply=function(te){var we=te.sx*this.sx+te.shy*this.shx,Re=te.sx*this.shy+te.shy*this.sy,We=te.shx*this.sx+te.sy*this.shx,et=te.shx*this.shy+te.sy*this.sy,Ct=te.tx*this.sx+te.ty*this.shx+this.tx,Lt=te.tx*this.shy+te.ty*this.sy+this.ty;return new vr(we,Re,We,et,Ct,Lt)},vr.prototype.decompose=function(){var te=this.sx,we=this.shy,Re=this.shx,We=this.sy,et=this.tx,Ct=this.ty,Lt=Math.sqrt(te*te+we*we),ar=(te/=Lt)*Re+(we/=Lt)*We;Re-=te*ar,We-=we*ar;var Gt=Math.sqrt(Re*Re+We*We);return ar/=Gt,te*(We/=Gt)<we*(Re/=Gt)&&(te=-te,we=-we,ar=-ar,Lt=-Lt),{scale:new vr(Lt,0,0,Gt,0,0),translate:new vr(1,0,0,1,et,Ct),rotate:new vr(te,we,-we,te,0,0),skew:new vr(1,0,ar,1,0,0)}},vr.prototype.toString=function(te){return this.join(" ")},vr.prototype.inversed=function(){var te=this.sx,we=this.shy,Re=this.shx,We=this.sy,et=this.tx,Ct=this.ty,Lt=1/(te*We-we*Re),ar=We*Lt,Gt=-we*Lt,Ur=-Re*Lt,lr=te*Lt;return new vr(ar,Gt,Ur,lr,-ar*et-Ur*Ct,-Gt*et-lr*Ct)},vr.prototype.applyToPoint=function(te){var we=te.x*this.sx+te.y*this.shx+this.tx,Re=te.x*this.shy+te.y*this.sy+this.ty;return new ji(we,Re)},vr.prototype.applyToRectangle=function(te){var we=this.applyToPoint(te),Re=this.applyToPoint(new ji(te.x+te.w,te.y+te.h));return new Zo(we.x,we.y,Re.x-we.x,Re.y-we.y)},vr.prototype.clone=function(){var te=this.sx,we=this.shy,Re=this.shx,We=this.sy,et=this.tx,Ct=this.ty;return new vr(te,we,Re,We,et,Ct)},v.Matrix=vr;var Oa=v.matrixMult=function(te,we){return we.multiply(te)},ml=new vr(1,0,0,1,0,0);v.unitMatrix=v.identityMatrix=ml;var ga=function(te,we){if(!Kn[te]){var Re=(we instanceof Ff?"Sh":"P")+(Object.keys(Yt).length+1).toString(10);we.id=Re,Kn[te]=Re,Yt[Re]=we,On.publish("addPattern",we)}};v.ShadingPattern=Ff,v.TilingPattern=Sp,v.addShadingPattern=function(te,we){return F("addShadingPattern()"),ga(te,we),this},v.beginTilingPattern=function(te){F("beginTilingPattern()"),Gl(te.boundingBox[0],te.boundingBox[1],te.boundingBox[2]-te.boundingBox[0],te.boundingBox[3]-te.boundingBox[1],te.matrix)},v.endTilingPattern=function(te,we){F("endTilingPattern()"),we.stream=Je[se].join(`
`),ga(te,we),On.publish("endTilingPattern",we),$a.pop().restore()};var Ds,Xr=v.__private__.newObject=function(){var te=$t();return Qn(te,!0),te},$t=v.__private__.newObjectDeferred=function(){return ge++,be[ge]=function(){return ke},ge},Qn=function(te,we){return we=typeof we=="boolean"&&we,be[te]=ke,we&&Oe(te+" 0 obj"),te},er=v.__private__.newAdditionalObject=function(){var te={objId:$t(),content:""};return He.push(te),te},Xi=$t(),Yn=$t(),vn=v.__private__.decodeColorString=function(te){var we=te.split(" ");if(we.length!==2||we[1]!=="g"&&we[1]!=="G")we.length!==5||we[4]!=="k"&&we[4]!=="K"||(we=[(1-we[0])*(1-we[3]),(1-we[1])*(1-we[3]),(1-we[2])*(1-we[3]),"r"]);else{var Re=parseFloat(we[0]);we=[Re,Re,Re,"r"]}for(var We="#",et=0;et<3;et++)We+=("0"+Math.floor(255*parseFloat(we[et])).toString(16)).slice(-2);return We},Fi=v.__private__.encodeColorString=function(te){var we;typeof te=="string"&&(te={ch1:te});var Re=te.ch1,We=te.ch2,et=te.ch3,Ct=te.ch4,Lt=te.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Re=="string"&&Re.charAt(0)!=="#"){var ar=new YW(Re);if(ar.ok)Re=ar.toHex();else if(!/^\d*\.?\d*$/.test(Re))throw new Error('Invalid color "'+Re+'" passed to jsPDF.encodeColorString.')}if(typeof Re=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Re)&&(Re="#"+Re[1]+Re[1]+Re[2]+Re[2]+Re[3]+Re[3]),typeof Re=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Re)){var Gt=parseInt(Re.substr(1),16);Re=Gt>>16&255,We=Gt>>8&255,et=255&Gt}if(We===void 0||Ct===void 0&&Re===We&&We===et)we=typeof Re=="string"?Re+" "+Lt[0]:te.precision===2?J(Re/255)+" "+Lt[0]:Z(Re/255)+" "+Lt[0];else if(Ct===void 0||zi(Ct)==="object"){if(Ct&&!isNaN(Ct.a)&&Ct.a===0)return["1.","1.","1.",Lt[1]].join(" ");we=typeof Re=="string"?[Re,We,et,Lt[1]].join(" "):te.precision===2?[J(Re/255),J(We/255),J(et/255),Lt[1]].join(" "):[Z(Re/255),Z(We/255),Z(et/255),Lt[1]].join(" ")}else we=typeof Re=="string"?[Re,We,et,Ct,Lt[2]].join(" "):te.precision===2?[J(Re),J(We),J(et),J(Ct),Lt[2]].join(" "):[Z(Re),Z(We),Z(et),Z(Ct),Lt[2]].join(" ");return we},Ji=v.__private__.getFilters=function(){return o},cs=v.__private__.putStream=function(te){var we=(te=te||{}).data||"",Re=te.filters||Ji(),We=te.alreadyAppliedFilters||[],et=te.addLength1||!1,Ct=we.length,Lt=te.objectId,ar=function(va){return va};if(f!==null&&Lt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(ar=di.encryptor(Lt,0));var Gt={};Re===!0&&(Re=["FlateEncode"]);var Ur=te.additionalKeyValues||[],lr=(Gt=Br.API.processDataByFilters!==void 0?Br.API.processDataByFilters(we,Re):{data:we,reverseChain:[]}).reverseChain+(Array.isArray(We)?We.join(" "):We.toString());if(Gt.data.length!==0&&(Ur.push({key:"Length",value:Gt.data.length}),et===!0&&Ur.push({key:"Length1",value:Ct})),lr.length!=0)if(lr.split("/").length-1==1)Ur.push({key:"Filter",value:lr});else{Ur.push({key:"Filter",value:"["+lr+"]"});for(var Sn=0;Sn<Ur.length;Sn+=1)if(Ur[Sn].key==="DecodeParms"){for(var ei=[],Zr=0;Zr<Gt.reverseChain.split("/").length-1;Zr+=1)ei.push("null");ei.push(Ur[Sn].value),Ur[Sn].value="["+ei.join(" ")+"]"}}Oe("<<");for(var Xt=0;Xt<Ur.length;Xt++)Oe("/"+Ur[Xt].key+" "+Ur[Xt].value);Oe(">>"),Gt.data.length!==0&&(Oe("stream"),Oe(ar(Gt.data)),Oe("endstream"))},ds=v.__private__.putPage=function(te){var we=te.number,Re=te.data,We=te.objId,et=te.contentsObjId;Qn(We,!0),Oe("<</Type /Page"),Oe("/Parent "+te.rootDictionaryObjId+" 0 R"),Oe("/Resources "+te.resourceDictionaryObjId+" 0 R"),Oe("/MediaBox ["+parseFloat(ee(te.mediaBox.bottomLeftX))+" "+parseFloat(ee(te.mediaBox.bottomLeftY))+" "+ee(te.mediaBox.topRightX)+" "+ee(te.mediaBox.topRightY)+"]"),te.cropBox!==null&&Oe("/CropBox ["+ee(te.cropBox.bottomLeftX)+" "+ee(te.cropBox.bottomLeftY)+" "+ee(te.cropBox.topRightX)+" "+ee(te.cropBox.topRightY)+"]"),te.bleedBox!==null&&Oe("/BleedBox ["+ee(te.bleedBox.bottomLeftX)+" "+ee(te.bleedBox.bottomLeftY)+" "+ee(te.bleedBox.topRightX)+" "+ee(te.bleedBox.topRightY)+"]"),te.trimBox!==null&&Oe("/TrimBox ["+ee(te.trimBox.bottomLeftX)+" "+ee(te.trimBox.bottomLeftY)+" "+ee(te.trimBox.topRightX)+" "+ee(te.trimBox.topRightY)+"]"),te.artBox!==null&&Oe("/ArtBox ["+ee(te.artBox.bottomLeftX)+" "+ee(te.artBox.bottomLeftY)+" "+ee(te.artBox.topRightX)+" "+ee(te.artBox.topRightY)+"]"),typeof te.userUnit=="number"&&te.userUnit!==1&&Oe("/UserUnit "+te.userUnit),On.publish("putPage",{objId:We,pageContext:_r[we],pageNumber:we,page:Re}),Oe("/Contents "+et+" 0 R"),Oe(">>"),Oe("endobj");var Ct=Re.join(`
`);return M===D&&(Ct+=`
Q`),Qn(et,!0),cs({data:Ct,filters:Ji(),objectId:et}),Oe("endobj"),We},$o=v.__private__.putPages=function(){var te,we,Re=[];for(te=1;te<=Qr;te++)_r[te].objId=$t(),_r[te].contentsObjId=$t();for(te=1;te<=Qr;te++)Re.push(ds({number:te,data:Je[te],objId:_r[te].objId,contentsObjId:_r[te].contentsObjId,mediaBox:_r[te].mediaBox,cropBox:_r[te].cropBox,bleedBox:_r[te].bleedBox,trimBox:_r[te].trimBox,artBox:_r[te].artBox,userUnit:_r[te].userUnit,rootDictionaryObjId:Xi,resourceDictionaryObjId:Yn}));Qn(Xi,!0),Oe("<</Type /Pages");var We="/Kids [";for(we=0;we<Qr;we++)We+=Re[we]+" 0 R ";Oe(We+"]"),Oe("/Count "+Qr),Oe(">>"),Oe("endobj"),On.publish("postPutPages")},Go=function(te){On.publish("putFont",{font:te,out:Oe,newObject:Xr,putStream:cs}),te.isAlreadyPutted!==!0&&(te.objectNumber=Xr(),Oe("<<"),Oe("/Type /Font"),Oe("/BaseFont /"+xp(te.postScriptName)),Oe("/Subtype /Type1"),typeof te.encoding=="string"&&Oe("/Encoding /"+te.encoding),Oe("/FirstChar 32"),Oe("/LastChar 255"),Oe(">>"),Oe("endobj"))},Ga=function(te){te.objectNumber=Xr();var we=[];we.push({key:"Type",value:"/XObject"}),we.push({key:"Subtype",value:"/Form"}),we.push({key:"BBox",value:"["+[ee(te.x),ee(te.y),ee(te.x+te.width),ee(te.y+te.height)].join(" ")+"]"}),we.push({key:"Matrix",value:"["+te.matrix.toString()+"]"});var Re=te.pages[1].join(`
`);cs({data:Re,additionalKeyValues:we,objectId:te.objectNumber}),Oe("endobj")},fi=function(te,we){we||(we=21);var Re=Xr(),We=(function(Lt,ar){var Gt,Ur=[],lr=1/(ar-1);for(Gt=0;Gt<1;Gt+=lr)Ur.push(Gt);if(Ur.push(1),Lt[0].offset!=0){var Sn={offset:0,color:Lt[0].color};Lt.unshift(Sn)}if(Lt[Lt.length-1].offset!=1){var ei={offset:1,color:Lt[Lt.length-1].color};Lt.push(ei)}for(var Zr="",Xt=0,va=0;va<Ur.length;va++){for(Gt=Ur[va];Gt>Lt[Xt+1].offset;)Xt++;var rn=Lt[Xt].offset,Ei=(Gt-rn)/(Lt[Xt+1].offset-rn),es=Lt[Xt].color,ts=Lt[Xt+1].color;Zr+=oe(Math.round((1-Ei)*es[0]+Ei*ts[0]).toString(16))+oe(Math.round((1-Ei)*es[1]+Ei*ts[1]).toString(16))+oe(Math.round((1-Ei)*es[2]+Ei*ts[2]).toString(16))}return Zr.trim()})(te.colors,we),et=[];et.push({key:"FunctionType",value:"0"}),et.push({key:"Domain",value:"[0.0 1.0]"}),et.push({key:"Size",value:"["+we+"]"}),et.push({key:"BitsPerSample",value:"8"}),et.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),et.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),cs({data:We,additionalKeyValues:et,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Re}),Oe("endobj"),te.objectNumber=Xr(),Oe("<< /ShadingType "+te.type),Oe("/ColorSpace /DeviceRGB");var Ct="/Coords ["+ee(parseFloat(te.coords[0]))+" "+ee(parseFloat(te.coords[1]))+" ";te.type===2?Ct+=ee(parseFloat(te.coords[2]))+" "+ee(parseFloat(te.coords[3])):Ct+=ee(parseFloat(te.coords[2]))+" "+ee(parseFloat(te.coords[3]))+" "+ee(parseFloat(te.coords[4]))+" "+ee(parseFloat(te.coords[5])),Oe(Ct+="]"),te.matrix&&Oe("/Matrix ["+te.matrix.toString()+"]"),Oe("/Function "+Re+" 0 R"),Oe("/Extend [true true]"),Oe(">>"),Oe("endobj")},kn=function(te,we){var Re=$t(),We=Xr();we.push({resourcesOid:Re,objectOid:We}),te.objectNumber=We;var et=[];et.push({key:"Type",value:"/Pattern"}),et.push({key:"PatternType",value:"1"}),et.push({key:"PaintType",value:"1"}),et.push({key:"TilingType",value:"1"}),et.push({key:"BBox",value:"["+te.boundingBox.map(ee).join(" ")+"]"}),et.push({key:"XStep",value:ee(te.xStep)}),et.push({key:"YStep",value:ee(te.yStep)}),et.push({key:"Resources",value:Re+" 0 R"}),te.matrix&&et.push({key:"Matrix",value:"["+te.matrix.toString()+"]"}),cs({data:te.stream,additionalKeyValues:et,objectId:te.objectNumber}),Oe("endobj")},Ko=function(te){for(var we in te.objectNumber=Xr(),Oe("<<"),te)switch(we){case"opacity":Oe("/ca "+J(te[we]));break;case"stroke-opacity":Oe("/CA "+J(te[we]))}Oe(">>"),Oe("endobj")},Ka=function(te){Qn(te.resourcesOid,!0),Oe("<<"),Oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var we in Oe("/Font <<"),wt)wt.hasOwnProperty(we)&&(p===!1||p===!0&&x.hasOwnProperty(we))&&Oe("/"+we+" "+wt[we].objectNumber+" 0 R");Oe(">>")})(),(function(){if(Object.keys(Yt).length>0){for(var we in Oe("/Shading <<"),Yt)Yt.hasOwnProperty(we)&&Yt[we]instanceof Ff&&Yt[we].objectNumber>=0&&Oe("/"+we+" "+Yt[we].objectNumber+" 0 R");On.publish("putShadingPatternDict"),Oe(">>")}})(),(function(we){if(Object.keys(Yt).length>0){for(var Re in Oe("/Pattern <<"),Yt)Yt.hasOwnProperty(Re)&&Yt[Re]instanceof v.TilingPattern&&Yt[Re].objectNumber>=0&&Yt[Re].objectNumber<we&&Oe("/"+Re+" "+Yt[Re].objectNumber+" 0 R");On.publish("putTilingPatternDict"),Oe(">>")}})(te.objectOid),(function(){if(Object.keys(Fr).length>0){var we;for(we in Oe("/ExtGState <<"),Fr)Fr.hasOwnProperty(we)&&Fr[we].objectNumber>=0&&Oe("/"+we+" "+Fr[we].objectNumber+" 0 R");On.publish("putGStateDict"),Oe(">>")}})(),(function(){for(var we in Oe("/XObject <<"),Ia)Ia.hasOwnProperty(we)&&Ia[we].objectNumber>=0&&Oe("/"+we+" "+Ia[we].objectNumber+" 0 R");On.publish("putXobjectDict"),Oe(">>")})(),Oe(">>"),Oe("endobj")},Oi=function(te){sr[te.fontName]=sr[te.fontName]||{},sr[te.fontName][te.fontStyle]=te.id},Rt=function(te,we,Re,We,et){var Ct={id:"F"+(Object.keys(wt).length+1).toString(10),postScriptName:te,fontName:we,fontStyle:Re,encoding:We,isStandardFont:et||!1,metadata:{}};return On.publish("addFont",{font:Ct,instance:this}),wt[Ct.id]=Ct,Oi(Ct),Ct.id},io=v.__private__.pdfEscape=v.pdfEscape=function(te,we){return(function(Re,We){var et,Ct,Lt,ar,Gt,Ur,lr,Sn,ei;if(Lt=(We=We||{}).sourceEncoding||"Unicode",Gt=We.outputEncoding,(We.autoencode||Gt)&&wt[tr].metadata&&wt[tr].metadata[Lt]&&wt[tr].metadata[Lt].encoding&&(ar=wt[tr].metadata[Lt].encoding,!Gt&&wt[tr].encoding&&(Gt=wt[tr].encoding),!Gt&&ar.codePages&&(Gt=ar.codePages[0]),typeof Gt=="string"&&(Gt=ar[Gt]),Gt)){for(lr=!1,Ur=[],et=0,Ct=Re.length;et<Ct;et++)(Sn=Gt[Re.charCodeAt(et)])?Ur.push(String.fromCharCode(Sn)):Ur.push(Re[et]),Ur[et].charCodeAt(0)>>8&&(lr=!0);Re=Ur.join("")}for(et=Re.length;lr===void 0&&et!==0;)Re.charCodeAt(et-1)>>8&&(lr=!0),et--;if(!lr)return Re;for(Ur=We.noBOM?[]:[254,255],et=0,Ct=Re.length;et<Ct;et++){if((ei=(Sn=Re.charCodeAt(et))>>8)>>8)throw new Error("Character at position "+et+" of string '"+Re+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ur.push(ei),Ur.push(Sn-(ei<<8))}return String.fromCharCode.apply(void 0,Ur)})(te,we).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zn=v.__private__.beginPage=function(te){Je[++Qr]=[],_r[Qr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(te[0]),topRightY:Number(te[1])}},_n(Qr),Pt(Je[se])},us=function(te,we){var Re,We,et;switch(n=we||n,typeof te=="string"&&(Re=T(te.toLowerCase()),Array.isArray(Re)&&(We=Re[0],et=Re[1])),Array.isArray(te)&&(We=te[0]*tn,et=te[1]*tn),isNaN(We)&&(We=a[0],et=a[1]),(We>14400||et>14400)&&(na.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),We=Math.min(14400,We),et=Math.min(14400,et)),a=[We,et],n.substr(0,1)){case"l":et>We&&(a=[et,We]);break;case"p":We>et&&(a=[et,We])}zn(a),qt(Pl),Oe(fs),yc!==0&&Oe(yc+" J"),ki!==0&&Oe(ki+" j"),On.publish("addPage",{pageNumber:Qr})},kl=function(te){te>0&&te<=Qr&&(Je.splice(te,1),_r.splice(te,1),Qr--,se>Qr&&(se=Qr),this.setPage(se))},_n=function(te){te>0&&te<=Qr&&(se=te)},An=v.__private__.getNumberOfPages=v.getNumberOfPages=function(){return Je.length-1},on=function(te,we,Re){var We,et=void 0;return Re=Re||{},te=te!==void 0?te:wt[tr].fontName,we=we!==void 0?we:wt[tr].fontStyle,We=te.toLowerCase(),sr[We]!==void 0&&sr[We][we]!==void 0?et=sr[We][we]:sr[te]!==void 0&&sr[te][we]!==void 0?et=sr[te][we]:Re.disableWarning===!1&&na.warn("Unable to look up font label for font '"+te+"', '"+we+"'. Refer to getFontList() for available fonts."),et||Re.noFallback||(et=sr.times[we])==null&&(et=sr.times.normal),et},Jr=v.__private__.putInfo=function(){var te=Xr(),we=function(We){return We};for(var Re in f!==null&&(we=di.encryptor(te,0)),Oe("<<"),Oe("/Producer ("+io(we("jsPDF "+Br.version))+")"),Yr)Yr.hasOwnProperty(Re)&&Yr[Re]&&Oe("/"+Re.substr(0,1).toUpperCase()+Re.substr(1)+" ("+io(we(Yr[Re]))+")");Oe("/CreationDate ("+io(we(le))+")"),Oe(">>"),Oe("endobj")},Rn=v.__private__.putCatalog=function(te){var we=(te=te||{}).rootDictionaryObjId||Xi;switch(Xr(),Oe("<<"),Oe("/Type /Catalog"),Oe("/Pages "+we+" 0 R"),rr||(rr="fullwidth"),rr){case"fullwidth":Oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Oe("/OpenAction [3 0 R /Fit]");break;case"original":Oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Re=""+rr;Re.substr(Re.length-1)==="%"&&(rr=parseInt(rr)/100),typeof rr=="number"&&Oe("/OpenAction [3 0 R /XYZ null null "+J(rr)+"]")}switch(yn||(yn="continuous"),yn){case"continuous":Oe("/PageLayout /OneColumn");break;case"single":Oe("/PageLayout /SinglePage");break;case"two":case"twoleft":Oe("/PageLayout /TwoColumnLeft");break;case"tworight":Oe("/PageLayout /TwoColumnRight")}hr&&Oe("/PageMode /"+hr),On.publish("putCatalog"),Oe(">>"),Oe("endobj")},hs=v.__private__.putTrailer=function(){Oe("trailer"),Oe("<<"),Oe("/Size "+(ge+1)),Oe("/Root "+ge+" 0 R"),Oe("/Info "+(ge-1)+" 0 R"),f!==null&&Oe("/Encrypt "+di.oid+" 0 R"),Oe("/ID [ <"+K+"> <"+K+"> ]"),Oe(">>")},Mr=v.__private__.putHeader=function(){Oe("%PDF-"+w),Oe("%")},Qa=v.__private__.putXRef=function(){var te="0000000000";Oe("xref"),Oe("0 "+(ge+1)),Oe("0000000000 65535 f ");for(var we=1;we<=ge;we++)typeof be[we]=="function"?Oe((te+be[we]()).slice(-10)+" 00000 n "):be[we]!==void 0?Oe((te+be[we]).slice(-10)+" 00000 n "):Oe("0000000000 00000 n ")},No=v.__private__.buildDocument=function(){var te;ge=0,ke=0,Le=[],be=[],He=[],Xi=$t(),Yn=$t(),Pt(Le),On.publish("buildDocument"),Mr(),$o(),(function(){On.publish("putAdditionalObjects");for(var Re=0;Re<He.length;Re++){var We=He[Re];Qn(We.objId,!0),Oe(We.content),Oe("endobj")}On.publish("postPutAdditionalObjects")})(),te=[],(function(){for(var Re in wt)wt.hasOwnProperty(Re)&&(p===!1||p===!0&&x.hasOwnProperty(Re))&&Go(wt[Re])})(),(function(){var Re;for(Re in Fr)Fr.hasOwnProperty(Re)&&Ko(Fr[Re])})(),(function(){for(var Re in Ia)Ia.hasOwnProperty(Re)&&Ga(Ia[Re])})(),(function(Re){var We;for(We in Yt)Yt.hasOwnProperty(We)&&(Yt[We]instanceof Ff?fi(Yt[We]):Yt[We]instanceof Sp&&kn(Yt[We],Re))})(te),On.publish("putResources"),te.forEach(Ka),Ka({resourcesOid:Yn,objectOid:Number.MAX_SAFE_INTEGER}),On.publish("postPutResources"),f!==null&&(di.oid=Xr(),Oe("<<"),Oe("/Filter /Standard"),Oe("/V "+di.v),Oe("/R "+di.r),Oe("/U <"+di.toHexString(di.U)+">"),Oe("/O <"+di.toHexString(di.O)+">"),Oe("/P "+di.P),Oe(">>"),Oe("endobj")),Jr(),Rn();var we=ke;return Qa(),hs(),Oe("startxref"),Oe(""+we),Oe("%%EOF"),Pt(Je[se]),Le.join(`
`)},ir=v.__private__.getBlob=function(te){return new Blob([Wt(te)],{type:"application/pdf"})},Bn=v.output=v.__private__.output=(Ds=function(te,we){switch(typeof(we=we||{})=="string"?we={filename:we}:we.filename=we.filename||"generated.pdf",te){case void 0:return No();case"save":v.save(we.filename);break;case"arraybuffer":return Wt(No());case"blob":return ir(No());case"bloburi":case"bloburl":if(hn.URL!==void 0&&typeof hn.URL.createObjectURL=="function")return hn.URL&&hn.URL.createObjectURL(ir(No()))||void 0;na.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Re="",We=No();try{Re=M7(We)}catch{Re=M7(unescape(encodeURIComponent(We)))}return"data:application/pdf;filename="+we.filename+";base64,"+Re;case"pdfobjectnewwindow":if(Object.prototype.toString.call(hn)==="[object Window]"){var et="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ct=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';we.pdfObjectUrl&&(et=we.pdfObjectUrl,Ct="");var Lt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+et+'"'+Ct+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(we)+");<\/script></body></html>",ar=hn.open();return ar!==null&&ar.document.write(Lt),ar}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(hn)==="[object Window]"){var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(we.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+we.filename+'" width="500px" height="400px" /></body></html>',Ur=hn.open();if(Ur!==null){Ur.document.write(Gt);var lr=this;Ur.document.documentElement.querySelector("#pdfViewer").onload=function(){Ur.document.title=we.filename,Ur.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(lr.output("bloburl"))}}return Ur}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(hn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Sn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",we)+'"></iframe></body></html>',ei=hn.open();if(ei!==null&&(ei.document.write(Sn),ei.document.title=we.filename),ei||typeof safari>"u")return ei;break;case"datauri":case"dataurl":return hn.document.location.href=this.output("datauristring",we);default:return null}},Ds.foo=function(){try{return Ds.apply(this,arguments)}catch(Re){var te=Re.stack||"";~te.indexOf(" at ")&&(te=te.split(" at ")[1]);var we="Error in function "+te.split(`
`)[0].split("<")[0]+": "+Re.message;if(!hn.console)throw new Error(we);hn.console.error(we,Re),hn.alert&&alert(we)}},Ds.foo.bar=Ds,Ds.foo),Ya=function(te){return Array.isArray(Zi)===!0&&Zi.indexOf(te)>-1};switch(i){case"pt":tn=1;break;case"mm":tn=72/25.4;break;case"cm":tn=72/2.54;break;case"in":tn=72;break;case"px":tn=Ya("px_scaling")==1?.75:96/72;break;case"pc":case"em":tn=12;break;case"ex":tn=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);tn=i}var di=null;V(),ce();var kr=v.__private__.getPageInfo=v.getPageInfo=function(te){if(isNaN(te)||te%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_r[te].objId,pageNumber:te,pageContext:_r[te]}},ea=v.__private__.getPageInfoByObjId=function(te){if(isNaN(te)||te%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var we in _r)if(_r[we].objId===te)break;return kr(we)},it=v.__private__.getCurrentPageInfo=v.getCurrentPageInfo=function(){return{objId:_r[se].objId,pageNumber:se,pageContext:_r[se]}};v.addPage=function(){return us.apply(this,arguments),this},v.setPage=function(){return _n.apply(this,arguments),Pt.call(this,Je[se]),this},v.insertPage=function(te){return this.addPage(),this.movePage(se,te),this},v.movePage=function(te,we){var Re,We;if(te>we){Re=Je[te],We=_r[te];for(var et=te;et>we;et--)Je[et]=Je[et-1],_r[et]=_r[et-1];Je[we]=Re,_r[we]=We,this.setPage(we)}else if(te<we){Re=Je[te],We=_r[te];for(var Ct=te;Ct<we;Ct++)Je[Ct]=Je[Ct+1],_r[Ct]=_r[Ct+1];Je[we]=Re,_r[we]=We,this.setPage(we)}return this},v.deletePage=function(){return kl.apply(this,arguments),this},v.__private__.text=v.text=function(te,we,Re,We,et){var Ct,Lt,ar,Gt,Ur,lr,Sn,ei,Zr,Xt=(We=We||{}).scope||this;if(typeof te=="number"&&typeof we=="number"&&(typeof Re=="string"||Array.isArray(Re))){var va=Re;Re=we,we=te,te=va}if(arguments[3]instanceof vr==0?(ar=arguments[4],Gt=arguments[5],zi(Sn=arguments[3])==="object"&&Sn!==null||(typeof ar=="string"&&(Gt=ar,ar=null),typeof Sn=="string"&&(Gt=Sn,Sn=null),typeof Sn=="number"&&(ar=Sn,Sn=null),We={flags:Sn,angle:ar,align:Gt})):(F("The transform parameter of text() with a Matrix value"),Zr=et),isNaN(we)||isNaN(Re)||te==null)throw new Error("Invalid arguments passed to jsPDF.text");if(te.length===0)return Xt;var rn,Ei="",es=typeof We.lineHeightFactor=="number"?We.lineHeightFactor:Ao,ts=Xt.internal.scaleFactor;function Da(Tt){return Tt=Tt.split("	").join(Array(We.TabLen||9).join(" ")),io(Tt,Sn)}function Xo(Tt){for(var _t,At=Tt.concat(),Tr=[],qr=At.length;qr--;)typeof(_t=At.shift())=="string"?Tr.push(_t):Array.isArray(Tt)&&(_t.length===1||_t[1]===void 0&&_t[2]===void 0)?Tr.push(_t[0]):Tr.push([_t[0],_t[1],_t[2]]);return Tr}function Pa(Tt,_t){var At;if(typeof Tt=="string")At=_t(Tt)[0];else if(Array.isArray(Tt)){for(var Tr,qr,Mn=Tt.concat(),ua=[],Ra=Mn.length;Ra--;)typeof(Tr=Mn.shift())=="string"?ua.push(_t(Tr)[0]):Array.isArray(Tr)&&typeof Tr[0]=="string"&&(qr=_t(Tr[0],Tr[1],Tr[2]),ua.push([qr[0],qr[1],qr[2]]));At=ua}return At}var so=!1,oo=!0;if(typeof te=="string")so=!0;else if(Array.isArray(te)){var Ql=te.concat();Lt=[];for(var Jo,wi=Ql.length;wi--;)(typeof(Jo=Ql.shift())!="string"||Array.isArray(Jo)&&typeof Jo[0]!="string")&&(oo=!1);so=oo}if(so===!1)throw new Error('Type of text must be string or Array. "'+te+'" is not recognized.');typeof te=="string"&&(te=te.match(/[\r?\n]/)?te.split(/\r\n|\r|\n/g):[te]);var pl=yt/Xt.internal.scaleFactor,Yl=pl*(es-1);switch(We.baseline){case"bottom":Re-=Yl;break;case"top":Re+=pl-Yl;break;case"hanging":Re+=pl-2*Yl;break;case"middle":Re+=pl/2-Yl}if((lr=We.maxWidth||0)>0&&(typeof te=="string"?te=Xt.splitTextToSize(te,lr):Object.prototype.toString.call(te)==="[object Array]"&&(te=te.reduce(function(Tt,_t){return Tt.concat(Xt.splitTextToSize(_t,lr))},[]))),Ct={text:te,x:we,y:Re,options:We,mutex:{pdfEscape:io,activeFontKey:tr,fonts:wt,activeFontSize:yt}},On.publish("preProcessText",Ct),te=Ct.text,ar=(We=Ct.options).angle,Zr instanceof vr==0&&ar&&typeof ar=="number"){ar*=Math.PI/180,We.rotationDirection===0&&(ar=-ar),M===D&&(ar=-ar);var el=Math.cos(ar),gl=Math.sin(ar);Zr=new vr(el,gl,-gl,el,0,0)}else ar&&ar instanceof vr&&(Zr=ar);M!==D||Zr||(Zr=ml),(Ur=We.charSpace||Ja)!==void 0&&(Ei+=ee(re(Ur))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ei=We.horizontalScale)!==void 0&&(Ei+=ee(100*ei)+` Tz
`),We.lang;var qn=-1,rs=We.renderingMode!==void 0?We.renderingMode:We.stroke,ns=Xt.internal.getCurrentPageInfo().pageContext;switch(rs){case 0:case!1:case"fill":qn=0;break;case 1:case!0:case"stroke":qn=1;break;case 2:case"fillThenStroke":qn=2;break;case 3:case"invisible":qn=3;break;case 4:case"fillAndAddForClipping":qn=4;break;case 5:case"strokeAndAddPathForClipping":qn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":qn=6;break;case 7:case"addToPathForClipping":qn=7}var Qs=ns.usedRenderingMode!==void 0?ns.usedRenderingMode:-1;qn!==-1?Ei+=qn+` Tr
`:Qs!==-1&&(Ei+=`0 Tr
`),qn!==-1&&(ns.usedRenderingMode=qn),Gt=We.align||"left";var qi,ps=yt*es,tl=Xt.internal.pageSize.getWidth(),Ml=wt[tr];Ur=We.charSpace||Ja,lr=We.maxWidth||0,Sn=Object.assign({autoencode:!0,noBOM:!0},We.flags);var lo=[],da=function(Tt){return Xt.getStringUnitWidth(Tt,{font:Ml,charSpace:Ur,fontSize:yt,doKerning:!1})*yt/ts};if(Object.prototype.toString.call(te)==="[object Array]"){var Ys;Lt=Xo(te),Gt!=="left"&&(qi=Lt.map(da));var _i,is=0;if(Gt==="right"){we-=qi[0],te=[],wi=Lt.length;for(var ln=0;ln<wi;ln++)ln===0?(_i=Lr(we),Ys=Tn(Re)):(_i=re(is-qi[ln]),Ys=-ps),te.push([Lt[ln],_i,Ys]),is=qi[ln]}else if(Gt==="center"){we-=qi[0]/2,te=[],wi=Lt.length;for(var Zs=0;Zs<wi;Zs++)Zs===0?(_i=Lr(we),Ys=Tn(Re)):(_i=re((is-qi[Zs])/2),Ys=-ps),te.push([Lt[Zs],_i,Ys]),is=qi[Zs]}else if(Gt==="left"){te=[],wi=Lt.length;for(var je=0;je<wi;je++)te.push(Lt[je])}else if(Gt==="justify"&&Ml.encoding==="Identity-H"){te=[],wi=Lt.length,lr=lr!==0?lr:tl;for(var h=0,g=0;g<wi;g++)if(Ys=g===0?Tn(Re):-ps,_i=g===0?Lr(we):h,g<wi-1){var b=re((lr-qi[g])/(Lt[g].split(" ").length-1)),S=Lt[g].split(" ");te.push([S[0]+" ",_i,Ys]),h=0;for(var N=1;N<S.length;N++){var I=(da(S[N-1]+" "+S[N])-da(S[N]))*ts+b;N==S.length-1?te.push([S[N],I,0]):te.push([S[N]+" ",I,0]),h-=I}}else te.push([Lt[g],_i,Ys]);te.push(["",h,0])}else{if(Gt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(te=[],wi=Lt.length,lr=lr!==0?lr:tl,g=0;g<wi;g++){Ys=g===0?Tn(Re):-ps,_i=g===0?Lr(we):0;var R=Lt[g].split(" ").length-1,H=R>0?(lr-qi[g])/R:0;g<wi-1?lo.push(ee(re(H))):lo.push(0),te.push([Lt[g],_i,Ys])}}}(typeof We.R2L=="boolean"?We.R2L:xr)===!0&&(te=Pa(te,function(Tt,_t,At){return[Tt.split("").reverse().join(""),_t,At]})),Ct={text:te,x:we,y:Re,options:We,mutex:{pdfEscape:io,activeFontKey:tr,fonts:wt,activeFontSize:yt}},On.publish("postProcessText",Ct),te=Ct.text,rn=Ct.mutex.isHex||!1;var ne=wt[tr].encoding;ne!=="WinAnsiEncoding"&&ne!=="StandardEncoding"||(te=Pa(te,function(Tt,_t,At){return[Da(Tt),_t,At]})),Lt=Xo(te),te=[];for(var he,ve,Ne,Me=Array.isArray(Lt[0])?1:0,qe="",$e=function(Tt,_t,At){var Tr="";return At instanceof vr?(At=typeof We.angle=="number"?Oa(At,new vr(1,0,0,1,Tt,_t)):Oa(new vr(1,0,0,1,Tt,_t),At),M===D&&(At=Oa(new vr(1,0,0,-1,0,0),At)),Tr=At.join(" ")+` Tm
`):Tr=ee(Tt)+" "+ee(_t)+` Td
`,Tr},Xe=0;Xe<Lt.length;Xe++){switch(qe="",Me){case 1:Ne=(rn?"<":"(")+Lt[Xe][0]+(rn?">":")"),he=parseFloat(Lt[Xe][1]),ve=parseFloat(Lt[Xe][2]);break;case 0:Ne=(rn?"<":"(")+Lt[Xe]+(rn?">":")"),he=Lr(we),ve=Tn(Re)}lo!==void 0&&lo[Xe]!==void 0&&(qe=lo[Xe]+` Tw
`),Xe===0?te.push(qe+$e(he,ve,Zr)+Ne):Me===0?te.push(qe+Ne):Me===1&&te.push(qe+$e(he,ve,Zr)+Ne)}te=Me===0?te.join(` Tj
T* `):te.join(` Tj
`),te+=` Tj
`;var ct=`BT
/`;return ct+=tr+" "+yt+` Tf
`,ct+=ee(yt*es)+` TL
`,ct+=mi+`
`,ct+=Ei,ct+=te,Oe(ct+="ET"),x[tr]=!0,Xt};var Pe=v.__private__.clip=v.clip=function(te){return Oe(te==="evenodd"?"W*":"W"),this};v.clipEvenOdd=function(){return Pe("evenodd")},v.__private__.discardPath=v.discardPath=function(){return Oe("n"),this};var Ht=v.__private__.isValidStyle=function(te){var we=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(te)!==-1&&(we=!0),we};v.__private__.setDefaultPathOperation=v.setDefaultPathOperation=function(te){return Ht(te)&&(d=te),this};var ni=v.__private__.getStyle=v.getStyle=function(te){var we=d;switch(te){case"D":case"S":we="S";break;case"F":we="f";break;case"FD":case"DF":we="B";break;case"f":case"f*":case"B":case"B*":we=te}return we},la=v.close=function(){return Oe("h"),this};v.stroke=function(){return Oe("S"),this},v.fill=function(te){return Ps("f",te),this},v.fillEvenOdd=function(te){return Ps("f*",te),this},v.fillStroke=function(te){return Ps("B",te),this},v.fillStrokeEvenOdd=function(te){return Ps("B*",te),this};var Ps=function(te,we){zi(we)==="object"?Cr(we,te):Oe(te)},Qo=function(te){te===null||M===D&&te===void 0||(te=ni(te),Oe(te))};function ya(te,we,Re,We,et){var Ct=new Sp(we||this.boundingBox,Re||this.xStep,We||this.yStep,this.gState,et||this.matrix);Ct.stream=this.stream;var Lt=te+"$$"+this.cloneIndex+++"$$";return ga(Lt,Ct),Ct}var Cr=function(te,we){var Re=Kn[te.key],We=Yt[Re];if(We instanceof Ff)Oe("q"),Oe(Jn(we)),We.gState&&v.setGState(We.gState),Oe(te.matrix.toString()+" cm"),Oe("/"+Re+" sh"),Oe("Q");else if(We instanceof Sp){var et=new vr(1,0,0,-1,0,Rl());te.matrix&&(et=et.multiply(te.matrix||ml),Re=ya.call(We,te.key,te.boundingBox,te.xStep,te.yStep,et).id),Oe("q"),Oe("/Pattern cs"),Oe("/"+Re+" scn"),We.gState&&v.setGState(We.gState),Oe(we),Oe("Q")}},Jn=function(te){switch(te){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Dl=v.moveTo=function(te,we){return Oe(ee(re(te))+" "+ee(de(we))+" m"),this},qc=v.lineTo=function(te,we){return Oe(ee(re(te))+" "+ee(de(we))+" l"),this},ka=v.curveTo=function(te,we,Re,We,et,Ct){return Oe([ee(re(te)),ee(de(we)),ee(re(Re)),ee(de(We)),ee(re(et)),ee(de(Ct)),"c"].join(" ")),this};v.__private__.line=v.line=function(te,we,Re,We,et){if(isNaN(te)||isNaN(we)||isNaN(Re)||isNaN(We)||!Ht(et))throw new Error("Invalid arguments passed to jsPDF.line");return M===O?this.lines([[Re-te,We-we]],te,we,[1,1],et||"S"):this.lines([[Re-te,We-we]],te,we,[1,1]).stroke()},v.__private__.lines=v.lines=function(te,we,Re,We,et,Ct){var Lt,ar,Gt,Ur,lr,Sn,ei,Zr,Xt,va,rn,Ei;if(typeof te=="number"&&(Ei=Re,Re=we,we=te,te=Ei),We=We||[1,1],Ct=Ct||!1,isNaN(we)||isNaN(Re)||!Array.isArray(te)||!Array.isArray(We)||!Ht(et)||typeof Ct!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Dl(we,Re),Lt=We[0],ar=We[1],Ur=te.length,va=we,rn=Re,Gt=0;Gt<Ur;Gt++)(lr=te[Gt]).length===2?(va=lr[0]*Lt+va,rn=lr[1]*ar+rn,qc(va,rn)):(Sn=lr[0]*Lt+va,ei=lr[1]*ar+rn,Zr=lr[2]*Lt+va,Xt=lr[3]*ar+rn,va=lr[4]*Lt+va,rn=lr[5]*ar+rn,ka(Sn,ei,Zr,Xt,va,rn));return Ct&&la(),Qo(et),this},v.path=function(te){for(var we=0;we<te.length;we++){var Re=te[we],We=Re.c;switch(Re.op){case"m":Dl(We[0],We[1]);break;case"l":qc(We[0],We[1]);break;case"c":ka.apply(this,We);break;case"h":la()}}return this},v.__private__.rect=v.rect=function(te,we,Re,We,et){if(isNaN(te)||isNaN(we)||isNaN(Re)||isNaN(We)||!Ht(et))throw new Error("Invalid arguments passed to jsPDF.rect");return M===O&&(We=-We),Oe([ee(re(te)),ee(de(we)),ee(re(Re)),ee(re(We)),"re"].join(" ")),Qo(et),this},v.__private__.triangle=v.triangle=function(te,we,Re,We,et,Ct,Lt){if(isNaN(te)||isNaN(we)||isNaN(Re)||isNaN(We)||isNaN(et)||isNaN(Ct)||!Ht(Lt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Re-te,We-we],[et-Re,Ct-We],[te-et,we-Ct]],te,we,[1,1],Lt,!0),this},v.__private__.roundedRect=v.roundedRect=function(te,we,Re,We,et,Ct,Lt){if(isNaN(te)||isNaN(we)||isNaN(Re)||isNaN(We)||isNaN(et)||isNaN(Ct)||!Ht(Lt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ar=4/3*(Math.SQRT2-1);return et=Math.min(et,.5*Re),Ct=Math.min(Ct,.5*We),this.lines([[Re-2*et,0],[et*ar,0,et,Ct-Ct*ar,et,Ct],[0,We-2*Ct],[0,Ct*ar,-et*ar,Ct,-et,Ct],[2*et-Re,0],[-et*ar,0,-et,-Ct*ar,-et,-Ct],[0,2*Ct-We],[0,-Ct*ar,et*ar,-Ct,et,-Ct]],te+et,we,[1,1],Lt,!0),this},v.__private__.ellipse=v.ellipse=function(te,we,Re,We,et){if(isNaN(te)||isNaN(we)||isNaN(Re)||isNaN(We)||!Ht(et))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ct=4/3*(Math.SQRT2-1)*Re,Lt=4/3*(Math.SQRT2-1)*We;return Dl(te+Re,we),ka(te+Re,we-Lt,te+Ct,we-We,te,we-We),ka(te-Ct,we-We,te-Re,we-Lt,te-Re,we),ka(te-Re,we+Lt,te-Ct,we+We,te,we+We),ka(te+Ct,we+We,te+Re,we+Lt,te+Re,we),Qo(et),this},v.__private__.circle=v.circle=function(te,we,Re,We){if(isNaN(te)||isNaN(we)||isNaN(Re)||!Ht(We))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(te,we,Re,Re,We)},v.setFont=function(te,we,Re){return Re&&(we=$(we,Re)),tr=on(te,we,{disableWarning:!1}),this};var Za=v.__private__.getFont=v.getFont=function(){return wt[on.apply(v,arguments)]};v.__private__.getFontList=v.getFontList=function(){var te,we,Re={};for(te in sr)if(sr.hasOwnProperty(te))for(we in Re[te]=[],sr[te])sr[te].hasOwnProperty(we)&&Re[te].push(we);return Re},v.addFont=function(te,we,Re,We,et){var Ct=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ct.indexOf(arguments[3])!==-1?et=arguments[3]:arguments[3]&&Ct.indexOf(arguments[3])==-1&&(Re=$(Re,We)),Rt.call(this,te,we,Re,et=et||"Identity-H")};var Ao,Pl=t.lineWidth||.200025,bi=v.__private__.getLineWidth=v.getLineWidth=function(){return Pl},qt=v.__private__.setLineWidth=v.setLineWidth=function(te){return Pl=te,Oe(ee(re(te))+" w"),this};v.__private__.setLineDash=Br.API.setLineDash=Br.API.setLineDashPattern=function(te,we){if(te=te||[],we=we||0,isNaN(we)||!Array.isArray(te))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return te=te.map(function(Re){return ee(re(Re))}).join(" "),we=ee(re(we)),Oe("["+te+"] "+we+" d"),this};var ca=v.__private__.getLineHeight=v.getLineHeight=function(){return yt*Ao};v.__private__.getLineHeight=v.getLineHeight=function(){return yt*Ao};var Zt=v.__private__.setLineHeightFactor=v.setLineHeightFactor=function(te){return typeof(te=te||1.15)=="number"&&(Ao=te),this},ud=v.__private__.getLineHeightFactor=v.getLineHeightFactor=function(){return Ao};Zt(t.lineHeight);var Lr=v.__private__.getHorizontalCoordinate=function(te){return re(te)},Tn=v.__private__.getVerticalCoordinate=function(te){return M===D?te:_r[se].mediaBox.topRightY-_r[se].mediaBox.bottomLeftY-re(te)},gc=v.__private__.getHorizontalCoordinateString=v.getHorizontalCoordinateString=function(te){return ee(Lr(te))},Rs=v.__private__.getVerticalCoordinateString=v.getVerticalCoordinateString=function(te){return ee(Tn(te))},fs=t.strokeColor||"0 G";v.__private__.getStrokeColor=v.getDrawColor=function(){return vn(fs)},v.__private__.setStrokeColor=v.setDrawColor=function(te,we,Re,We){return fs=Fi({ch1:te,ch2:we,ch3:Re,ch4:We,pdfColorType:"draw",precision:2}),Oe(fs),this};var Xa=t.fillColor||"0 g";v.__private__.getFillColor=v.getFillColor=function(){return vn(Xa)},v.__private__.setFillColor=v.setFillColor=function(te,we,Re,We){return Xa=Fi({ch1:te,ch2:we,ch3:Re,ch4:We,pdfColorType:"fill",precision:2}),Oe(Xa),this};var mi=t.textColor||"0 g",Ks=v.__private__.getTextColor=v.getTextColor=function(){return vn(mi)};v.__private__.setTextColor=v.setTextColor=function(te,we,Re,We){return mi=Fi({ch1:te,ch2:we,ch3:Re,ch4:We,pdfColorType:"text",precision:3}),this};var Ja=t.charSpace,Yo=v.__private__.getCharSpace=v.getCharSpace=function(){return parseFloat(Ja||0)};v.__private__.setCharSpace=v.setCharSpace=function(te){if(isNaN(te))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ja=te,this};var yc=0;v.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},v.__private__.setLineCap=v.setLineCap=function(te){var we=v.CapJoinStyles[te];if(we===void 0)throw new Error("Line cap style of '"+te+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return yc=we,Oe(we+" J"),this};var ki=0;v.__private__.setLineJoin=v.setLineJoin=function(te){var we=v.CapJoinStyles[te];if(we===void 0)throw new Error("Line join style of '"+te+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ki=we,Oe(we+" j"),this},v.__private__.setLineMiterLimit=v.__private__.setMiterLimit=v.setLineMiterLimit=v.setMiterLimit=function(te){if(te=te||0,isNaN(te))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Oe(ee(re(te))+" M"),this},v.GState=qb,v.setGState=function(te){(te=typeof te=="string"?Fr[Kr[te]]:ms(null,te)).equals(Sr)||(Oe("/"+te.id+" gs"),Sr=te)};var ms=function(te,we){if(!te||!Kr[te]){var Re=!1;for(var We in Fr)if(Fr.hasOwnProperty(We)&&Fr[We].equals(we)){Re=!0;break}if(Re)we=Fr[We];else{var et="GS"+(Object.keys(Fr).length+1).toString(10);Fr[et]=we,we.id=et}return te&&(Kr[te]=we.id),On.publish("addGState",we),we}};v.addGState=function(te,we){return ms(te,we),this},v.saveGraphicsState=function(){return Oe("q"),ur.push({key:tr,size:yt,color:mi}),this},v.restoreGraphicsState=function(){Oe("Q");var te=ur.pop();return tr=te.key,yt=te.size,mi=te.color,Sr=null,this},v.setCurrentTransformationMatrix=function(te){return Oe(te.toString()+" cm"),this},v.comment=function(te){return Oe("#"+te),this};var ji=function(te,we){var Re=te||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Re},set:function(Ct){isNaN(Ct)||(Re=parseFloat(Ct))}});var We=we||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return We},set:function(Ct){isNaN(Ct)||(We=parseFloat(Ct))}});var et="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return et},set:function(Ct){et=Ct.toString()}}),this},Zo=function(te,we,Re,We){ji.call(this,te,we),this.type="rect";var et=Re||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return et},set:function(Lt){isNaN(Lt)||(et=parseFloat(Lt))}});var Ct=We||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ct},set:function(Lt){isNaN(Lt)||(Ct=parseFloat(Lt))}}),this},mn=function(){this.page=Qr,this.currentPage=se,this.pages=Je.slice(0),this.pagesContext=_r.slice(0),this.x=fr,this.y=Yi,this.matrix=Er,this.width=ao(se),this.height=Fn(se),this.outputDestination=vt,this.id="",this.objectNumber=-1};mn.prototype.restore=function(){Qr=this.page,se=this.currentPage,_r=this.pagesContext,Je=this.pages,fr=this.x,Yi=this.y,Er=this.matrix,Kl(se,this.width),Eo(se,this.height),vt=this.outputDestination};var Gl=function(te,we,Re,We,et){$a.push(new mn),Qr=se=0,Je=[],fr=te,Yi=we,Er=et,zn([Re,We])};for(var xa in v.beginFormObject=function(te,we,Re,We,et){return Gl(te,we,Re,We,et),this},v.endFormObject=function(te){return(function(we){if(vi[we])$a.pop().restore();else{var Re=new mn,We="Xo"+(Object.keys(Ia).length+1).toString(10);Re.id=We,vi[we]=We,Ia[We]=Re,On.publish("addFormObject",Re),$a.pop().restore()}})(te),this},v.doFormObject=function(te,we){var Re=Ia[vi[te]];return Oe("q"),Oe(we.toString()+" cm"),Oe("/"+Re.id+" Do"),Oe("Q"),this},v.getFormObject=function(te){var we=Ia[vi[te]];return{x:we.x,y:we.y,width:we.width,height:we.height,matrix:we.matrix}},v.save=function(te,we){return te=te||"generated.pdf",(we=we||{}).returnPromise=we.returnPromise||!1,we.returnPromise===!1?(Lf(ir(No()),te),typeof Lf.unload=="function"&&hn.setTimeout&&setTimeout(Lf.unload,911),this):new Promise(function(Re,We){try{var et=Lf(ir(No()),te);typeof Lf.unload=="function"&&hn.setTimeout&&setTimeout(Lf.unload,911),Re(et)}catch(Ct){We(Ct.message)}})},Br.API)Br.API.hasOwnProperty(xa)&&(xa==="events"&&Br.API.events.length?(function(te,we){var Re,We,et;for(et=we.length-1;et!==-1;et--)Re=we[et][0],We=we[et][1],te.subscribe.apply(te,[Re].concat(typeof We=="function"?[We]:We))})(On,Br.API.events):v[xa]=Br.API[xa]);function ao(te){return _r[te].mediaBox.topRightX-_r[te].mediaBox.bottomLeftX}function Kl(te,we){_r[te].mediaBox.topRightX=we+_r[te].mediaBox.bottomLeftX}function Fn(te){return _r[te].mediaBox.topRightY-_r[te].mediaBox.bottomLeftY}function Eo(te,we){_r[te].mediaBox.topRightY=we+_r[te].mediaBox.bottomLeftY}var _o=v.getPageWidth=function(te){return ao(te=te||se)/tn},To=v.setPageWidth=function(te,we){Kl(te,we*tn)},Rl=v.getPageHeight=function(te){return Fn(te=te||se)/tn},pt=v.setPageHeight=function(te,we){Eo(te,we*tn)};return v.internal={pdfEscape:io,getStyle:ni,getFont:Za,getFontSize:St,getCharSpace:Yo,getTextColor:Ks,getLineHeight:ca,getLineHeightFactor:ud,getLineWidth:bi,write:st,getHorizontalCoordinate:Lr,getVerticalCoordinate:Tn,getCoordinateString:gc,getVerticalCoordinateString:Rs,collections:{},newObject:Xr,newAdditionalObject:er,newObjectDeferred:$t,newObjectDeferredBegin:Qn,getFilters:Ji,putStream:cs,events:On,scaleFactor:tn,pageSize:{getWidth:function(){return _o(se)},setWidth:function(te){To(se,te)},getHeight:function(){return Rl(se)},setHeight:function(te){pt(se,te)}},encryptionOptions:f,encryption:di,getEncryptor:function(te){return f!==null?di.encryptor(te,0):function(we){return we}},output:Bn,getNumberOfPages:An,get pages(){return Je},out:Oe,f2:J,f3:Z,getPageInfo:kr,getPageInfoByObjId:ea,getCurrentPageInfo:it,getPDFVersion:C,Point:ji,Rectangle:Zo,Matrix:vr,hasHotfix:Ya},Object.defineProperty(v.internal.pageSize,"width",{get:function(){return _o(se)},set:function(te){To(se,te)},enumerable:!0,configurable:!0}),Object.defineProperty(v.internal.pageSize,"height",{get:function(){return Rl(se)},set:function(te){pt(se,te)},enumerable:!0,configurable:!0}),(function(te){for(var we=0,Re=Bt.length;we<Re;we++){var We=Rt.call(this,te[we][0],te[we][1],te[we][2],Bt[we][3],!0);p===!1&&(x[We]=!0);var et=te[we][0].split("-");Oi({id:We,fontName:et[0],fontStyle:et[1]||""})}On.publish("addFonts",{fonts:wt,dictionary:sr})}).call(v,Bt),tr="F1",us(a,n),On.publish("initialized"),v}yp.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},yp.prototype.toHexString=function(t){return t.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},yp.prototype.hexToBytes=function(t){for(var r=[],n=0;n<t.length;n+=2)r.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return r.join("")},yp.prototype.processOwnerPassword=function(t,r){return uA(dA(r).substr(0,5),t)},yp.prototype.encryptor=function(t,r){var n=dA(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&r,r>>8&255)).substr(0,10);return function(i){return uA(n,i)}},qb.prototype.equals=function(t){var r,n="id,objectNumber,equals";if(!t||zi(t)!==zi(this))return!1;var i=0;for(r in this)if(!(n.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!t.hasOwnProperty(r)||this[r]!==t[r])return!1;i++}for(r in t)t.hasOwnProperty(r)&&n.indexOf(r)<0&&i--;return i===0},Br.API={events:[]},Br.version="4.1.0";var Cs=Br.API,r3=1,Tm=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hp=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ub=function(t){return t.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(r){var n=r.charCodeAt(0).toString(16).toUpperCase();return"#"+(n.length===1?"0"+n:n)})},wn=function(t){return t.toFixed(2)},Kh=function(t){return t.toFixed(5)};Cs.__acroform__={};var pc=function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t},F7=function(t){return t*r3},tu=function(t){var r=new eH,n=Ar.internal.getHeight(t)||0,i=Ar.internal.getWidth(t)||0;return r.BBox=[0,0,Number(wn(i)),Number(wn(n))],r},pCe=Cs.__acroform__.setBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<r},gCe=Cs.__acroform__.clearBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<r)},yCe=Cs.__acroform__.getBit=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<r?1:0},Ws=Cs.__acroform__.getBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return yCe(t,r-1)},Hs=Cs.__acroform__.setBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return pCe(t,r-1)},Vs=Cs.__acroform__.clearBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return gCe(t,r-1)},xCe=Cs.__acroform__.calculateCoordinates=function(t,r){var n=r.internal.getHorizontalCoordinate,i=r.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],u={};return u.lowerLeft_X=n(a)||0,u.lowerLeft_Y=i(s+l)||0,u.upperRight_X=n(a+o)||0,u.upperRight_Y=i(s)||0,[Number(wn(u.lowerLeft_X)),Number(wn(u.lowerLeft_Y)),Number(wn(u.upperRight_X)),Number(wn(u.upperRight_Y))]},vCe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var r=[],n=t._V||t.DV,i=hA(t,n),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(t.scope.__private__.encodeColorString(t.color)),r.push("/"+a+" "+wn(i.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC");var s=tu(t);return s.scope=t.scope,s.stream=r.join(`
`),s}},hA=function(t,r){var n=t.fontSize===0?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},a=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");a=t.multiline?a.map(function(J){return J.split(`
`)}):a.map(function(J){return[J]});var s=n,o=Ar.internal.getHeight(t)||0;o=o<0?-o:o;var l=Ar.internal.getWidth(t)||0;l=l<0?-l:l;var u=function(J,Z,re){if(J+1<a.length){var de=Z+" "+a[J+1][0];return J1(de,t,re).width<=l-4}return!1};s++;e:for(;s>0;){r="",s--;var d,f,p=J1("3",t,s).height,x=t.multiline?o-s:(o-p)/2,v=x+=2,w=0,C=0,A=0;if(s<=0){r=`(...) Tj
`,r+="% Width of Text: "+J1(r,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var T="",O=0,D=0;D<a.length;D++)if(a.hasOwnProperty(D)){var M=!1;if(a[D].length!==1&&A!==a[D].length-1){if((p+2)*(O+2)+2>o)continue e;T+=a[D][A],M=!0,C=D,D--}else{T=(T+=a[D][A]+" ").substr(T.length-1)==" "?T.substr(0,T.length-1):T;var Q=parseInt(D),U=u(Q,T,s),$=D>=a.length-1;if(U&&!$){T+=" ",A=0;continue}if(U||$){if($)C=Q;else if(t.multiline&&(p+2)*(O+2)+2>o)continue e}else{if(!t.multiline||(p+2)*(O+2)+2>o)continue e;C=Q}}for(var ee="",F=w;F<=C;F++){var Y=a[F];if(t.multiline){if(F===C){ee+=Y[A]+" ",A=(A+1)%Y.length;continue}if(F===w){ee+=Y[Y.length-1]+" ";continue}}ee+=Y[0]+" "}switch(ee=ee.substr(ee.length-1)==" "?ee.substr(0,ee.length-1):ee,f=J1(ee,t,s).width,t.textAlign){case"right":d=l-f-2;break;case"center":d=(l-f)/2;break;default:d=2}r+=wn(d)+" "+wn(v)+` Td
`,r+="("+Tm(ee)+`) Tj
`,r+=-wn(d)+` 0 Td
`,v=-(s+2),f=0,w=M?C:C+1,O++,T=""}break}return i.text=r,i.fontSize=s,i},J1=function(t,r,n){var i=r.scope.internal.getFont(r.fontName,r.fontStyle),a=r.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:r.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:a}},bCe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},jCe=function(t,r){var n={type:"reference",object:t};r.internal.getPageInfo(t.page).pageContext.annotations.find(function(i){return i.type===n.type&&i.object===n.object})===void 0&&r.internal.getPageInfo(t.page).pageContext.annotations.push(n)},wCe=function(t,r){if(r.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(kd.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(bCe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");r3=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new tH,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];s.objId=void 0,s.hasAnnotation&&jCe(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(i,a){var s=!i;for(var o in i||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(o)){var l=i[o],u=[],d=l.Rect;if(l.Rect&&(l.Rect=xCe(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Ar.createDefaultAppearanceStream(l),zi(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(u=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=vCe(l);u.push({key:"AP",value:"<</N "+f+">>"}),a.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var p="";for(var x in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(x)){var v=l.appearanceStreamContent[x];if(p+="/"+x+" ",p+="<<",Object.keys(v).length>=1||Array.isArray(v)){for(var o in v)if(v.hasOwnProperty(o)){var w=v[o];typeof w=="function"&&(w=w.call(a,l)),p+="/"+o+" "+w+" ",a.internal.acroformPlugin.xForms.indexOf(w)>=0||a.internal.acroformPlugin.xForms.push(w)}}else typeof(w=v)=="function"&&(w=w.call(a,l)),p+="/"+o+" "+w,a.internal.acroformPlugin.xForms.indexOf(w)>=0||a.internal.acroformPlugin.xForms.push(w);p+=">>"}u.push({key:"AP",value:`<<
`+p+">>"})}a.internal.putStream({additionalKeyValues:u,objectId:l.objId}),a.internal.out("endobj")}s&&(function(C,A){for(var T in C)if(C.hasOwnProperty(T)){var O=T,D=C[T];A.internal.newObjectDeferredBegin(D.objId,!0),zi(D)==="object"&&typeof D.putStream=="function"&&D.putStream(),delete C[O]}})(a.internal.acroformPlugin.xForms,a)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},JW=Cs.__acroform__.arrayToPdfArray=function(t,r,n){var i=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),zi(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)==="/"?a+="/"+Ub(t[s].substr(1)):(r!==void 0&&n&&(i=n.internal.getEncryptor(r)),a+="("+Tm(i(t[s].toString()))+")")}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},dC=function(t,r,n){var i=function(a){return a};return r!==void 0&&n&&(i=n.internal.getEncryptor(r)),(t=t||"").toString(),"("+Tm(i(t))+")"},su=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};su.prototype.toString=function(){return this.objId+" 0 R"},su.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},su.prototype.getKeyValueListForStream=function(){var t=[],r=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in r)if(Object.getOwnPropertyDescriptor(this,r[n]).configurable===!1){var i=r[n],a=this[i];a&&(Array.isArray(a)?t.push({key:i,value:JW(a,this.objId,this.scope)}):a instanceof su?(a.scope=this.scope,t.push({key:i,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:i,value:a}))}return t};var eH=function(){su.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};pc(eH,su);var tH=function(){su.call(this);var t,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(i){return i};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Tm(n(t))+")"}},set:function(n){t=n}})};pc(tH,su);var kd=function t(){su.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute F supplied.');r=T}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ws(r,3)},set:function(T){T?this.F=Hs(r,3):this.F=Vs(r,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute Ff supplied.');n=T}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(T){i=T!==void 0?T:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(T){i[0]=T}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(T){i[1]=T}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(T){i[2]=T}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(T){i[3]=T}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(T){switch(T){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=T;break;default:throw new Error('Invalid value "'+T+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Wb)return;s="FieldObject"+t.FieldNum++}var T=function(O){return O};return this.scope&&(T=this.scope.internal.getEncryptor(this.objId)),"("+Tm(T(s))+")"},set:function(T){s=T.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(T){s=T}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(T){o=T}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(T){l=T}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(T){u=T}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/r3:d},set:function(T){d=T}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(T){f=T}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Wb||this instanceof tm))return dC(p,this.objId,this.scope)},set:function(T){T=T.toString(),p=T}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof zo==0?dC(x,this.objId,this.scope):x},set:function(T){T=T.toString(),x=this instanceof zo==0?T.substr(0,1)==="("?hp(T.substr(1,T.length-2)):hp(T):T}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zo==1?hp(x.substr(1,x.length-1)):x},set:function(T){T=T.toString(),x=this instanceof zo==1?"/"+Ub(T):T}});var v=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(v)return v},set:function(T){this.V=T}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof zo==0?dC(v,this.objId,this.scope):v},set:function(T){T=T.toString(),v=this instanceof zo==0?T.substr(0,1)==="("?hp(T.substr(1,T.length-2)):hp(T):T}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zo==1?hp(v.substr(1,v.length-1)):v},set:function(T){T=T.toString(),v=this instanceof zo==1?"/"+Ub(T):T}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,C=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return C},set:function(T){T=!!T,C=T}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(T){w=T}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,1)},set:function(T){T?this.Ff=Hs(this.Ff,1):this.Ff=Vs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,2)},set:function(T){T?this.Ff=Hs(this.Ff,2):this.Ff=Vs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,3)},set:function(T){T?this.Ff=Hs(this.Ff,3):this.Ff=Vs(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(T){if([0,1,2].indexOf(T)===-1)throw new Error('Invalid value "'+T+'" for attribute Q supplied.');A=T}}),Object.defineProperty(this,"textAlign",{get:function(){var T;switch(A){case 0:default:T="left";break;case 1:T="center";break;case 2:T="right"}return T},configurable:!0,enumerable:!0,set:function(T){switch(T){case"right":case 2:A=2;break;case"center":case 1:A=1;break;default:A=0}}})};pc(kd,su);var Op=function(){kd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return JW(r,this.objId,this.scope)},set:function(n){var i,a;a=[],typeof(i=n)=="string"&&(a=(function(s,o,l){l||(l=1);for(var u,d=[];u=o.exec(s);)d.push(u[l]);return d})(i,/\((.*?)\)/g)),r=a}}),this.getOptions=function(){return r},this.setOptions=function(n){r=n,this.sort&&r.sort()},this.addOption=function(n){n=(n=n||"").toString(),r.push(n),this.sort&&r.sort()},this.removeOption=function(n,i){for(i=i||!1,n=(n=n||"").toString();r.indexOf(n)!==-1&&(r.splice(r.indexOf(n),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,18)},set:function(n){n?this.Ff=Hs(this.Ff,18):this.Ff=Vs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Hs(this.Ff,19):this.Ff=Vs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,20)},set:function(n){n?(this.Ff=Hs(this.Ff,20),r.sort()):this.Ff=Vs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,22)},set:function(n){n?this.Ff=Hs(this.Ff,22):this.Ff=Vs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,23)},set:function(n){n?this.Ff=Hs(this.Ff,23):this.Ff=Vs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,27)},set:function(n){n?this.Ff=Hs(this.Ff,27):this.Ff=Vs(this.Ff,27)}}),this.hasAppearanceStream=!1};pc(Op,kd);var kp=function(){Op.call(this),this.fontName="helvetica",this.combo=!1};pc(kp,Op);var Dp=function(){kp.call(this),this.combo=!0};pc(Dp,kp);var Cv=function(){Dp.call(this),this.edit=!0};pc(Cv,Dp);var zo=function(){kd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,15)},set:function(n){n?this.Ff=Hs(this.Ff,15):this.Ff=Vs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,16)},set:function(n){n?this.Ff=Hs(this.Ff,16):this.Ff=Vs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,17)},set:function(n){n?this.Ff=Hs(this.Ff,17):this.Ff=Vs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,26)},set:function(n){n?this.Ff=Hs(this.Ff,26):this.Ff=Vs(this.Ff,26)}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var i,a=[];for(i in a.push("<<"),r)a.push("/"+i+" ("+Tm(n(r[i]))+")");return a.push(">>"),a.join(`
`)}},set:function(n){zi(n)==="object"&&(r=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(n){typeof n=="string"&&(r.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+Ub(n)}})};pc(zo,kd);var Nv=function(){zo.call(this),this.pushButton=!0};pc(Nv,zo);var Pp=function(){zo.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r!==void 0?r:[]}})};pc(Pp,zo);var Wb=function(){var t,r;kd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(a){r=a}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),i)o.push("/"+s+" ("+Tm(a(i[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){zi(a)==="object"&&(i=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(a){typeof a=="string"&&(i.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(a){n=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(a){n="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ar.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};pc(Wb,kd),Pp.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var n=this.Kids[r];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},Pp.prototype.createOption=function(t){var r=new Wb;return r.Parent=this,r.optionName=t,this.Kids.push(r),SCe.call(this.scope,r),r};var Av=function(){zo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ar.CheckBox.createAppearanceStream()};pc(Av,zo);var tm=function(){kd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,13)},set:function(r){r?this.Ff=Hs(this.Ff,13):this.Ff=Vs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,21)},set:function(r){r?this.Ff=Hs(this.Ff,21):this.Ff=Vs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,23)},set:function(r){r?this.Ff=Hs(this.Ff,23):this.Ff=Vs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,24)},set:function(r){r?this.Ff=Hs(this.Ff,24):this.Ff=Vs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,25)},set:function(r){r?this.Ff=Hs(this.Ff,25):this.Ff=Vs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,26)},set:function(r){r?this.Ff=Hs(this.Ff,26):this.Ff=Vs(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){Number.isInteger(r)&&(t=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};pc(tm,kd);var Ev=function(){tm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ws(this.Ff,14)},set:function(t){t?this.Ff=Hs(this.Ff,14):this.Ff=Vs(this.Ff,14)}}),this.password=!0};pc(Ev,tm);var Ar={CheckBox:{createAppearanceStream:function(){return{N:{On:Ar.CheckBox.YesNormal},D:{On:Ar.CheckBox.YesPushDown,Off:Ar.CheckBox.OffPushDown}}},YesPushDown:function(t){var r=tu(t);r.scope=t.scope;var n=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=hA(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+wn(Ar.internal.getWidth(t))+" "+wn(Ar.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+wn(s.fontSize)+" Tf "+a),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),r.stream=n.join(`
`),r},YesNormal:function(t){var r=tu(t);r.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=[],s=Ar.internal.getHeight(t),o=Ar.internal.getWidth(t),l=hA(t,t.caption);return a.push("1 g"),a.push("0 0 "+wn(o)+" "+wn(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+wn(o-1)+" "+wn(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+n+" "+wn(l.fontSize)+" Tf "+i),a.push(l.text),a.push("ET"),a.push("Q"),r.stream=a.join(`
`),r},OffPushDown:function(t){var r=tu(t);r.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+wn(Ar.internal.getWidth(t))+" "+wn(Ar.internal.getHeight(t))+" re"),n.push("f"),r.stream=n.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(t){var r={D:{Off:Ar.RadioButton.Circle.OffPushDown},N:{}};return r.N[t]=Ar.RadioButton.Circle.YesNormal,r.D[t]=Ar.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(t){var r=tu(t);r.scope=t.scope;var n=[],i=Ar.internal.getWidth(t)<=Ar.internal.getHeight(t)?Ar.internal.getWidth(t)/4:Ar.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var a=Ar.internal.Bezier_C,s=Number((i*a).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Kh(Ar.internal.getWidth(t)/2)+" "+Kh(Ar.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),r.stream=n.join(`
`),r},YesPushDown:function(t){var r=tu(t);r.scope=t.scope;var n=[],i=Ar.internal.getWidth(t)<=Ar.internal.getHeight(t)?Ar.internal.getWidth(t)/4:Ar.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var a=Number((2*i).toFixed(5)),s=Number((a*Ar.internal.Bezier_C).toFixed(5)),o=Number((i*Ar.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Kh(Ar.internal.getWidth(t)/2)+" "+Kh(Ar.internal.getHeight(t)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),n.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),n.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),n.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Kh(Ar.internal.getWidth(t)/2)+" "+Kh(Ar.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),n.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),n.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),n.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),n.push("f"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(t){var r=tu(t);r.scope=t.scope;var n=[],i=Ar.internal.getWidth(t)<=Ar.internal.getHeight(t)?Ar.internal.getWidth(t)/4:Ar.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var a=Number((2*i).toFixed(5)),s=Number((a*Ar.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Kh(Ar.internal.getWidth(t)/2)+" "+Kh(Ar.internal.getHeight(t)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),n.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),n.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),n.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),n.push("f"),n.push("Q"),r.stream=n.join(`
`),r}},Cross:{createAppearanceStream:function(t){var r={D:{Off:Ar.RadioButton.Cross.OffPushDown},N:{}};return r.N[t]=Ar.RadioButton.Cross.YesNormal,r.D[t]=Ar.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(t){var r=tu(t);r.scope=t.scope;var n=[],i=Ar.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+wn(Ar.internal.getWidth(t)-2)+" "+wn(Ar.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(wn(i.x1.x)+" "+wn(i.x1.y)+" m"),n.push(wn(i.x2.x)+" "+wn(i.x2.y)+" l"),n.push(wn(i.x4.x)+" "+wn(i.x4.y)+" m"),n.push(wn(i.x3.x)+" "+wn(i.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},YesPushDown:function(t){var r=tu(t);r.scope=t.scope;var n=Ar.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+wn(Ar.internal.getWidth(t))+" "+wn(Ar.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+wn(Ar.internal.getWidth(t)-2)+" "+wn(Ar.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(wn(n.x1.x)+" "+wn(n.x1.y)+" m"),i.push(wn(n.x2.x)+" "+wn(n.x2.y)+" l"),i.push(wn(n.x4.x)+" "+wn(n.x4.y)+" m"),i.push(wn(n.x3.x)+" "+wn(n.x3.y)+" l"),i.push("s"),i.push("Q"),r.stream=i.join(`
`),r},OffPushDown:function(t){var r=tu(t);r.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+wn(Ar.internal.getWidth(t))+" "+wn(Ar.internal.getHeight(t))+" re"),n.push("f"),r.stream=n.join(`
`),r}}},createDefaultAppearanceStream:function(t){var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+r+" "+t.fontSize+" Tf "+n}};Ar.internal={Bezier_C:.551915024494,calculateCross:function(t){var r=Ar.internal.getWidth(t),n=Ar.internal.getHeight(t),i=Math.min(r,n);return{x1:{x:(r-i)/2,y:(n-i)/2+i},x2:{x:(r-i)/2+i,y:(n-i)/2},x3:{x:(r-i)/2,y:(n-i)/2},x4:{x:(r-i)/2+i,y:(n-i)/2+i}}}},Ar.internal.getWidth=function(t){var r=0;return zi(t)==="object"&&(r=F7(t.Rect[2])),r},Ar.internal.getHeight=function(t){var r=0;return zi(t)==="object"&&(r=F7(t.Rect[3])),r};var SCe=Cs.addField=function(t){if(wCe(this,t),!(t instanceof kd))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=t).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Cs.AcroFormChoiceField=Op,Cs.AcroFormListBox=kp,Cs.AcroFormComboBox=Dp,Cs.AcroFormEditBox=Cv,Cs.AcroFormButton=zo,Cs.AcroFormPushButton=Nv,Cs.AcroFormRadioButton=Pp,Cs.AcroFormCheckBox=Av,Cs.AcroFormTextField=tm,Cs.AcroFormPasswordField=Ev,Cs.AcroFormAppearance=Ar,Cs.AcroForm={ChoiceField:Op,ListBox:kp,ComboBox:Dp,EditBox:Cv,Button:zo,PushButton:Nv,RadioButton:Pp,CheckBox:Av,TextField:tm,PasswordField:Ev,Appearance:Ar},Br.AcroForm={ChoiceField:Op,ListBox:kp,ComboBox:Dp,EditBox:Cv,Button:zo,PushButton:Nv,RadioButton:Pp,CheckBox:Av,TextField:tm,PasswordField:Ev,Appearance:Ar};Br.AcroForm;function rH(t){return t.reduce(function(r,n,i){return r[n]=i,r},{})}(function(t){var r="addImage_";t.__addimage__={};var n="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(J,Z){var re,de,le,K,ue,ce=n;if((Z=Z||n)==="RGBA"||J.data!==void 0&&J.data instanceof Uint8ClampedArray&&"height"in J&&"width"in J)return"RGBA";if(U(J))for(ue in i)for(le=i[ue],re=0;re<le.length;re+=1){for(K=!0,de=0;de<le[re].length;de+=1)if(le[re][de]!==void 0&&le[re][de]!==J[de]){K=!1;break}if(K===!0){ce=ue;break}}else for(ue in i)for(le=i[ue],re=0;re<le.length;re+=1){for(K=!0,de=0;de<le[re].length;de+=1)if(le[re][de]!==void 0&&le[re][de]!==J.charCodeAt(de)){K=!1;break}if(K===!0){ce=ue;break}}return ce===n&&Z!==n&&(ce=Z),ce},s=function J(Z){for(var re=this.internal.write,de=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);Z.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:Z.width}),K.push({key:"Height",value:Z.height}),Z.colorSpace===T.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(Z.palette.length/3-1)+" "+("sMask"in Z&&Z.sMask!==void 0?Z.objectId+2:Z.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+Z.colorSpace}),Z.colorSpace===T.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:Z.bitsPerComponent}),"decodeParameters"in Z&&Z.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+Z.decodeParameters+">>"}),"transparency"in Z&&Array.isArray(Z.transparency)&&Z.transparency.length>0){for(var ue="",ce=0,ye=Z.transparency.length;ce<ye;ce++)ue+=Z.transparency[ce]+" "+Z.transparency[ce]+" ";K.push({key:"Mask",value:"["+ue+"]"})}Z.sMask!==void 0&&K.push({key:"SMask",value:Z.objectId+1+" 0 R"});var Se=Z.filter!==void 0?["/"+Z.filter]:void 0;if(de({data:Z.data,additionalKeyValues:K,alreadyAppliedFilters:Se,objectId:Z.objectId}),re("endobj"),"sMask"in Z&&Z.sMask!==void 0){var V,X=(V=Z.sMaskBitsPerComponent)!==null&&V!==void 0?V:Z.bitsPerComponent,se={width:Z.width,height:Z.height,colorSpace:"DeviceGray",bitsPerComponent:X,data:Z.sMask};"filter"in Z&&(se.decodeParameters="/Predictor ".concat(Z.predictor," /Colors 1 /BitsPerComponent ").concat(X," /Columns ").concat(Z.width),se.filter=Z.filter),J.call(this,se)}if(Z.colorSpace===T.INDEXED){var W=this.internal.newObject();de({data:ee(new Uint8Array(Z.palette)),objectId:W}),re("endobj")}},o=function(){var J=this.internal.collections[r+"images"];for(var Z in J)s.call(this,J[Z])},l=function(){var J,Z=this.internal.collections[r+"images"],re=this.internal.write;for(var de in Z)re("/I"+(J=Z[de]).index,J.objectId,"0","R")},u=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var J=this.internal.collections[r+"images"];return u.call(this),J},f=function(){return Object.keys(this.internal.collections[r+"images"]).length},p=function(J){return typeof t["process"+J.toUpperCase()]=="function"},x=function(J){return zi(J)==="object"&&J.nodeType===1},v=function(J,Z){if(J.nodeName==="IMG"&&J.hasAttribute("src")){var re=""+J.getAttribute("src");if(re.indexOf("data:image/")===0)return Sv(unescape(re).split("base64,").pop());var de=t.loadFile(re,!0);if(de!==void 0)return de}if(J.nodeName==="CANVAS"){if(J.width===0||J.height===0)throw new Error("Given canvas must have data. Canvas width: "+J.width+", height: "+J.height);var le;switch(Z){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;default:le="image/jpeg"}return Sv(J.toDataURL(le,1).split("base64,").pop())}},w=function(J){var Z=this.internal.collections[r+"images"];if(Z){for(var re in Z)if(J===Z[re].alias)return Z[re]}},C=function(J,Z,re){return J||Z||(J=-96,Z=-96),J<0&&(J=-1*re.width*72/J/this.internal.scaleFactor),Z<0&&(Z=-1*re.height*72/Z/this.internal.scaleFactor),J===0&&(J=Z*re.width/re.height),Z===0&&(Z=J*re.height/re.width),[J,Z]},A=function(J,Z,re,de,le,K){var ue=C.call(this,re,de,le),ce=this.internal.getCoordinateString,ye=this.internal.getVerticalCoordinateString,Se=d.call(this);if(re=ue[0],de=ue[1],Se[le.index]=le,K){K*=Math.PI/180;var V=Math.cos(K),X=Math.sin(K),se=function(oe){return oe.toFixed(4)},W=[se(V),se(X),se(-1*X),se(V),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,ce(J),ye(Z+de),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([ce(re),"0","0",ce(de),"0","0","cm"].join(" "))):this.internal.write([ce(re),"0","0",ce(de),ce(J),ye(Z+de),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},T=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var O=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},D=t.__addimage__.sHashCode=function(J){var Z,re,de=0;if(typeof J=="string")for(re=J.length,Z=0;Z<re;Z++)de=(de<<5)-de+J.charCodeAt(Z),de|=0;else if(U(J))for(re=J.byteLength/2,Z=0;Z<re;Z++)de=(de<<5)-de+J[Z],de|=0;return de},M=t.__addimage__.validateStringAsBase64=function(J){(J=J||"").toString().trim();var Z=!0;return J.length===0&&(Z=!1),J.length%4!=0&&(Z=!1),/^[A-Za-z0-9+/]+$/.test(J.substr(0,J.length-2))===!1&&(Z=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(J.substr(-2))===!1&&(Z=!1),Z},Q=t.__addimage__.extractImageFromDataUrl=function(J){if(J==null||!(J=J.trim()).startsWith("data:"))return null;var Z=J.indexOf(",");return Z<0?null:J.substring(0,Z).trim().endsWith("base64")?J.substring(Z+1):null};t.__addimage__.isArrayBuffer=function(J){return J instanceof ArrayBuffer};var U=t.__addimage__.isArrayBufferView=function(J){return J instanceof Int8Array||J instanceof Uint8Array||J instanceof Uint8ClampedArray||J instanceof Int16Array||J instanceof Uint16Array||J instanceof Int32Array||J instanceof Uint32Array||J instanceof Float32Array||J instanceof Float64Array},$=t.__addimage__.binaryStringToUint8Array=function(J){for(var Z=J.length,re=new Uint8Array(Z),de=0;de<Z;de++)re[de]=J.charCodeAt(de);return re},ee=t.__addimage__.arrayBufferToBinaryString=function(J){for(var Z="",re=U(J)?J:new Uint8Array(J),de=0;de<re.length;de+=8192)Z+=String.fromCharCode.apply(null,re.subarray(de,de+8192));return Z};t.addImage=function(){var J,Z,re,de,le,K,ue,ce,ye;if(typeof arguments[1]=="number"?(Z=n,re=arguments[1],de=arguments[2],le=arguments[3],K=arguments[4],ue=arguments[5],ce=arguments[6],ye=arguments[7]):(Z=arguments[1],re=arguments[2],de=arguments[3],le=arguments[4],K=arguments[5],ue=arguments[6],ce=arguments[7],ye=arguments[8]),zi(J=arguments[0])==="object"&&!x(J)&&"imageData"in J){var Se=J;J=Se.imageData,Z=Se.format||Z||n,re=Se.x||re||0,de=Se.y||de||0,le=Se.w||Se.width||le,K=Se.h||Se.height||K,ue=Se.alias||ue,ce=Se.compression||ce,ye=Se.rotation||Se.angle||ye}var V=this.internal.getFilters();if(ce===void 0&&V.indexOf("FlateEncode")!==-1&&(ce="SLOW"),isNaN(re)||isNaN(de))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var X=F.call(this,J,Z,ue,ce);return A.call(this,re,de,le,K,X,ye),this};var F=function(J,Z,re,de){var le,K,ue;if(typeof J=="string"&&a(J)===n){J=unescape(J);var ce=Y(J,!1);(ce!==""||(ce=t.loadFile(J,!0))!==void 0)&&(J=ce)}if(x(J)&&(J=v(J,Z)),Z=a(J,Z),!p(Z))throw new Error("addImage does not support files of type '"+Z+"', please ensure that a plugin for '"+Z+"' support is added.");if(((ue=re)==null||ue.length===0)&&(re=(function(ye){return typeof ye=="string"||U(ye)?D(ye):U(ye.data)?D(ye.data):null})(J)),(le=w.call(this,re))||(J instanceof Uint8Array||Z==="RGBA"||(K=J,J=$(J)),le=this["process"+Z.toUpperCase()](J,f.call(this),re,(function(ye){return ye&&typeof ye=="string"&&(ye=ye.toUpperCase()),ye in t.image_compression?ye:O.NONE})(de),K)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},Y=t.__addimage__.convertBase64ToBinaryString=function(J,Z){Z=typeof Z!="boolean"||Z;var re,de="";if(typeof J=="string"){var le;re=(le=Q(J))!==null&&le!==void 0?le:J;try{de=Sv(re)}catch(K){if(Z)throw M(re)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return de};t.getImageProperties=function(J){var Z,re,de="";if(x(J)&&(J=v(J)),typeof J=="string"&&a(J)===n&&((de=Y(J,!1))===""&&(de=t.loadFile(J)||""),J=de),re=a(J),!p(re))throw new Error("addImage does not support files of type '"+re+"', please ensure that a plugin for '"+re+"' support is added.");if(J instanceof Uint8Array||(J=$(J)),!(Z=this["process"+re.toUpperCase()](J)))throw new Error("An unknown error occurred whilst processing the image");return Z.fileType=re,Z}})(Br.API),(function(t){var r=function(n){if(n!==void 0&&n!="")return!0};Br.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var i,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,f=!1,p=0;p<d.length&&!f;p++)switch((i=d[p]).type){case"link":(r(i.options.url)||r(i.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var x=0;x<d.length;x++){i=d[x];var v=this.internal.pdfEscape,w=this.internal.getEncryptor(n.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var C=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),T=this.internal.getEncryptor(C.objId),O=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(i.bounds.x)+" "+l(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w)+" "+l(i.bounds.y)+"] ")+"/Contents ("+v(T(i.contents))+")",s+=" /Popup "+A.objId+" 0 R",s+=" /P "+u.objId+" 0 R",s+=" /T ("+v(T(O))+") >>",C.content=s;var D=C.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(i.bounds.x+30)+" "+l(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w+30)+" "+l(i.bounds.y)+"] ")+" /Parent "+D,i.open&&(s+=" /Open true"),s+=" >>",A.content=s,this.internal.write(C.objId,"0 R",A.objId,"0 R");break;case"freetext":a="/Rect ["+o(i.bounds.x)+" "+l(i.bounds.y)+" "+o(i.bounds.x+i.bounds.w)+" "+l(i.bounds.y+i.bounds.h)+"] ";var M=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+v(w(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var Q=this.annotations._nameMap[i.options.name];i.options.pageNumber=Q.page,i.options.top=Q.y}else i.options.top||(i.options.top=0);if(a="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+v(w(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var U=l(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+U+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var i=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":i.pageContext.annotations.push(n)}},t.link=function(n,i,a,s,o){var l=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:u(n),y:d(i),w:u(n+a),h:d(i+s)},options:o,type:"link"})},t.textWithLink=function(n,i,a,s){var o,l,u=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(d*f)}else l=u,o=d;return this.text(n,i,a,s),a+=.2*d,s.align==="center"&&(i-=u/2),s.align==="right"&&(i-=u),this.link(i,a-d,l,o,s),u},t.getTextWidth=function(n){var i=this.internal.getFontSize();return this.getStringUnitWidth(n)*i/this.internal.scaleFactor}})(Br.API),(function(t){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(C){return r[C.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(C){return typeof C=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(C)},l=t.__arabicParser__.isArabicEndLetter=function(C){return o(C)&&s(C)&&r[C.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(C){return o(C)&&a.indexOf(C.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(C){return o(C)&&s(C)&&r[C.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(C){return o(C)&&s(C)&&r[C.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(C){return o(C)&&s(C)&&r[C.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(C){return o(C)&&s(C)&&r[C.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(C){var A=0,T=n,O="",D=0;for(A=0;A<C.length;A+=1)T[C.charCodeAt(A)]!==void 0?(D++,typeof(T=T[C.charCodeAt(A)])=="number"&&(O+=String.fromCharCode(T),T=n,D=0),A===C.length-1&&(T=n,O+=C.charAt(A-(D-1)),A-=D-1,D=0)):(T=n,O+=C.charAt(A-D),A-=D,D=0);return O};t.__arabicParser__.isArabicDiacritic=function(C){return C!==void 0&&i[C.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(C,A,T){return o(C)?s(C)===!1?-1:!d(C)||!o(A)&&!o(T)||!o(T)&&l(A)||l(C)&&!o(A)||l(C)&&u(A)||l(C)&&l(A)?0:f(C)&&o(A)&&!l(A)&&o(T)&&d(T)?3:l(C)||!o(T)?1:2:-1},v=function(C){var A=0,T=0,O=0,D="",M="",Q="",U=(C=C||"").split("\\s+"),$=[];for(A=0;A<U.length;A+=1){for($.push(""),T=0;T<U[A].length;T+=1)D=U[A][T],M=U[A][T-1],Q=U[A][T+1],o(D)?(O=x(D,M,Q),$[A]+=O!==-1?String.fromCharCode(r[D.charCodeAt(0)][O]):D):$[A]+=D;$[A]=p($[A])}return $.join(" ")},w=t.__arabicParser__.processArabic=t.processArabic=function(){var C,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,T=[];if(Array.isArray(A)){var O=0;for(T=[],O=0;O<A.length;O+=1)Array.isArray(A[O])?T.push([v(A[O][0]),A[O][1],A[O][2]]):T.push([v(A[O])]);C=T}else C=v(A);return typeof arguments[0]=="string"?C:(arguments[0].text=C,arguments[0])};t.events.push(["preProcessText",w])})(Br.API),Br.API.autoPrint=function(t){var r;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(t){var r=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(n,i){var a;if((n=n||"2d")!=="2d")return null;for(a in i)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=i[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(Br.API),(function(t){var r={left:0,top:0,bottom:0,right:0},n=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(C){u=C}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(C){d=C}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(C){f=C}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(C){p=C}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(C){x=C}});var v=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return v},set:function(C){v=C}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(C){w=C}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return i.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,d){i.call(this);var f=(d=d||{}).fontSize||this.getFontSize(),p=d.font||this.getFont(),x=d.scaleFactor||this.internal.scaleFactor,v=0,w=0,C=0,A=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var T=d.maxWidth;T>0?typeof u=="string"?u=this.splitTextToSize(u,T):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(D,M){return D.concat(A.splitTextToSize(M,T))},[])):u=Array.isArray(u)?u:[u];for(var O=0;O<u.length;O++)v<(C=this.getStringUnitWidth(u[O],{font:p})*f)&&(v=C);return v!==0&&(w=u.length),{w:v/=x,h:Math.max((w*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var u=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new s(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var u;u=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i.call(this);var d=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||r,x=this.internal.__cell__.tableHeaderRow,v=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===u.lineNumber?(u.x=(d.x||0)+(d.width||0),u.y=d.y||0):d.y+d.height+u.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=p.top,v&&x&&(this.printHeaderRow(u.lineNumber,!0),u.y+=x[0].height)):u.y=d.y+d.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,n===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-f,u.y+f,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+f,{align:"center",baseline:"top",maxWidth:u.width-f-f}):this.text(u.text,u.x+f,u.y+f,{align:"left",baseline:"top",maxWidth:u.width-f-f})),this.internal.__cell__.lastCell=u,this};t.table=function(u,d,f,p,x){if(i.call(this),!f)throw new Error("No data for PDF table.");var v,w,C,A,T=[],O=[],D=[],M={},Q={},U=[],$=[],ee=(x=x||{}).autoSize||!1,F=x.printHeaders!==!1,Y=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,J=x.margins||Object.assign({width:this.getPageWidth()},r),Z=typeof x.padding=="number"?x.padding:3,re=x.headerBackgroundColor||"#c8c8c8",de=x.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=J,this.internal.__cell__.table_font_size=Y,this.internal.__cell__.padding=Z,this.internal.__cell__.headerBackgroundColor=re,this.internal.__cell__.headerTextColor=de,this.setFontSize(Y),p==null)O=T=Object.keys(f[0]),D=T.map(function(){return"left"});else if(Array.isArray(p)&&zi(p[0])==="object")for(T=p.map(function(Se){return Se.name}),O=p.map(function(Se){return Se.prompt||Se.name||""}),D=p.map(function(Se){return Se.align||"left"}),v=0;v<p.length;v+=1)Q[p[v].name]=.7499990551181103*p[v].width;else Array.isArray(p)&&typeof p[0]=="string"&&(O=T=p,D=T.map(function(){return"left"}));if(ee||Array.isArray(p)&&typeof p[0]=="string")for(v=0;v<T.length;v+=1){for(M[A=T[v]]=f.map(function(Se){return Se[A]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(O[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=M[A],this.setFont(void 0,"normal"),C=0;C<w.length;C+=1)U.push(this.getTextDimensions(w[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Q[A]=Math.max.apply(null,U)+Z+Z,U=[]}if(F){var le={};for(v=0;v<T.length;v+=1)le[T[v]]={},le[T[v]].text=O[v],le[T[v]].align=D[v];var K=l.call(this,le,Q);$=T.map(function(Se){return new s(u,d,Q[Se],K,le[Se].text,void 0,le[Se].align)}),this.setTableHeaderRow($),this.printHeaderRow(1,!1)}var ue=p.reduce(function(Se,V){return Se[V.name]=V.align,Se},{});for(v=0;v<f.length;v+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:v,data:f[v]},this);var ce=l.call(this,f[v],Q);for(C=0;C<T.length;C+=1){var ye=f[v][T[C]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:v,col:C,data:ye},this),o.call(this,new s(u,d,Q[T[C]],ce,ye,v+2,ue[T[C]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=d,this};var l=function(u,d){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(u).map(function(v){var w=u[v];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,d[v]-f-f)},this).map(function(v){return this.getLineHeightFactor()*v.length*p/x+f+f},this).reduce(function(v,w){return Math.max(v,w)},0)};t.setTableHeaderRow=function(u){i.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,d){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],v=0;v<this.internal.__cell__.tableHeaderRow.length;v+=1){f=this.internal.__cell__.tableHeaderRow[v].clone(),d&&(f.y=this.internal.__cell__.margins.top||0,x.push(f)),f.lineNumber=u;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(w)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),n=!1}})(Br.API);var nH={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},iH=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],fA=rH(iH),aH=[100,200,300,400,500,600,700,800,900],CCe=rH(aH);function uC(t){var r=t.family.replace(/"|'/g,"").toLowerCase(),n=(function(s){return nH[s=s||"normal"]?s:"normal"})(t.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(t.weight),a=(function(s){return typeof fA[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:r,style:n,weight:i,stretch:a,src:t.src||[],ref:t.ref||{name:r,style:[a,n,i].join(" ")}}}function q7(t,r,n,i){var a;for(a=n;a>=0&&a<r.length;a+=i)if(t[r[a]])return t[r[a]];for(a=n;a>=0&&a<r.length;a-=i)if(t[r[a]])return t[r[a]]}var NCe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},U7={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function W7(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function H7(t){return t.trimLeft()}function ACe(t,r){for(var n=0;n<t.length;){if(t.charAt(n)===r)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function ECe(t){var r=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],t.substring(r[0].length)]}var fp,ev,V7,$7,G7,hC=["times"];function K7(t,r,n,i,a){var s=4,o=Y7;switch(a){case Br.API.image_compression.FAST:s=1,o=Q7;break;case Br.API.image_compression.MEDIUM:s=6,o=Z7;break;case Br.API.image_compression.SLOW:s=9,o=X7}t=(function(u,d,f,p){for(var x,v=u.length/d,w=new Uint8Array(u.length+v),C=[_Ce,Q7,Y7,Z7,X7],A=0;A<v;A+=1){var T=A*d,O=u.subarray(T,T+d);if(p)w.set(p(O,f,x),T+A);else{for(var D=C.length,M=[],Q=0;Q<D;Q+=1)M[Q]=C[Q](O,f,x);var U=ICe(M.concat());w.set(M[U],T+A)}x=O}return w})(t,r,Math.ceil(n*i/8),o);var l=sA(t,{level:s});return Br.API.__addimage__.arrayBufferToBinaryString(l)}function _Ce(t){var r=Array.apply([],t);return r.unshift(0),r}function Q7(t,r){var n=t.length,i=[];i[0]=1;for(var a=0;a<n;a+=1){var s=t[a-r]||0;i[a+1]=t[a]-s+256&255}return i}function Y7(t,r,n){var i=t.length,a=[];a[0]=2;for(var s=0;s<i;s+=1){var o=n&&n[s]||0;a[s+1]=t[s]-o+256&255}return a}function Z7(t,r,n){var i=t.length,a=[];a[0]=3;for(var s=0;s<i;s+=1){var o=t[s-r]||0,l=n&&n[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function X7(t,r,n){var i=t.length,a=[];a[0]=4;for(var s=0;s<i;s+=1){var o=TCe(t[s-r]||0,n&&n[s]||0,n&&n[s-r]||0);a[s+1]=t[s]-o+256&255}return a}function TCe(t,r,n){if(t===r&&r===n)return t;var i=Math.abs(r-n),a=Math.abs(t-n),s=Math.abs(t+r-n-n);return i<=a&&i<=s?t:a<=s?r:n}function ICe(t){var r=t.map(function(n){return n.reduce(function(i,a){return i+Math.abs(a)},0)});return r.indexOf(Math.min.apply(null,r))}function fC(t,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1;return sH(t,a)>>s&o}function J7(t,r,n,i){var a=n*i,s=Math.floor(a/8),o=16-(a-8*s+i),l=(1<<i)-1,u=(r&l)<<o;(function(d,f,p){if(f+1<d.byteLength)d.setUint16(f,p,!1);else{var x=p>>8&255;d.setUint8(f,x)}})(t,s,sH(t,s)&~(l<<o)&65535|u)}function sH(t,r){return r+1<t.byteLength?t.getUint16(r,!1):t.getUint8(r)<<8}function OCe(t){var r=0;if(t[r++]!==71||t[r++]!==73||t[r++]!==70||t[r++]!==56||(t[r++]+1&253)!=56||t[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[r++]|t[r++]<<8,i=t[r++]|t[r++]<<8,a=t[r++],s=a>>7,o=1<<1+(7&a);t[r++],t[r++];var l=null,u=null;s&&(l=r,u=o,r+=3*o);var d=!0,f=[],p=0,x=null,v=0,w=null;for(this.width=n,this.height=i;d&&r<t.length;)switch(t[r++]){case 33:switch(t[r++]){case 255:if(t[r]!==11||t[r+1]==78&&t[r+2]==69&&t[r+3]==84&&t[r+4]==83&&t[r+5]==67&&t[r+6]==65&&t[r+7]==80&&t[r+8]==69&&t[r+9]==50&&t[r+10]==46&&t[r+11]==48&&t[r+12]==3&&t[r+13]==1&&t[r+16]==0)r+=14,w=t[r++]|t[r++]<<8,r++;else for(r+=12;;){if(!((J=t[r++])>=0))throw Error("Invalid block size");if(J===0)break;r+=J}break;case 249:if(t[r++]!==4||t[r+4]!==0)throw new Error("Invalid graphics extension block.");var C=t[r++];p=t[r++]|t[r++]<<8,x=t[r++],1&C||(x=null),v=C>>2&7,r++;break;case 254:for(;;){if(!((J=t[r++])>=0))throw Error("Invalid block size");if(J===0)break;r+=J}break;default:throw new Error("Unknown graphic control label: 0x"+t[r-1].toString(16))}break;case 44:var A=t[r++]|t[r++]<<8,T=t[r++]|t[r++]<<8,O=t[r++]|t[r++]<<8,D=t[r++]|t[r++]<<8,M=t[r++],Q=M>>6&1,U=1<<1+(7&M),$=l,ee=u,F=!1;M>>7&&(F=!0,$=r,ee=U,r+=3*U);var Y=r;for(r++;;){var J;if(!((J=t[r++])>=0))throw Error("Invalid block size");if(J===0)break;r+=J}f.push({x:A,y:T,width:O,height:D,has_local_palette:F,palette_offset:$,palette_size:ee,data_offset:Y,data_length:r-Y,transparent_index:x,interlaced:!!Q,delay:p,disposal:v});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[r-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return w},this.frameInfo=function(Z){if(Z<0||Z>=f.length)throw new Error("Frame index out of range.");return f[Z]},this.decodeAndBlitFrameBGRA=function(Z,re){var de=this.frameInfo(Z),le=de.width*de.height,K=new Uint8Array(le);eM(t,de.data_offset,K,le);var ue=de.palette_offset,ce=de.transparent_index;ce===null&&(ce=256);var ye=de.width,Se=n-ye,V=ye,X=4*(de.y*n+de.x),se=4*((de.y+de.height)*n+de.x),W=X,oe=4*Se;de.interlaced===!0&&(oe+=4*n*7);for(var ge=8,be=0,Le=K.length;be<Le;++be){var ke=K[be];if(V===0&&(V=ye,(W+=oe)>=se&&(oe=4*Se+4*n*(ge-1),W=X+(ye+Se)*(ge<<1),ge>>=1)),ke===ce)W+=4;else{var He=t[ue+3*ke],Je=t[ue+3*ke+1],Qe=t[ue+3*ke+2];re[W++]=Qe,re[W++]=Je,re[W++]=He,re[W++]=255}--V}},this.decodeAndBlitFrameRGBA=function(Z,re){var de=this.frameInfo(Z),le=de.width*de.height,K=new Uint8Array(le);eM(t,de.data_offset,K,le);var ue=de.palette_offset,ce=de.transparent_index;ce===null&&(ce=256);var ye=de.width,Se=n-ye,V=ye,X=4*(de.y*n+de.x),se=4*((de.y+de.height)*n+de.x),W=X,oe=4*Se;de.interlaced===!0&&(oe+=4*n*7);for(var ge=8,be=0,Le=K.length;be<Le;++be){var ke=K[be];if(V===0&&(V=ye,(W+=oe)>=se&&(oe=4*Se+4*n*(ge-1),W=X+(ye+Se)*(ge<<1),ge>>=1)),ke===ce)W+=4;else{var He=t[ue+3*ke],Je=t[ue+3*ke+1],Qe=t[ue+3*ke+2];re[W++]=He,re[W++]=Je,re[W++]=Qe,re[W++]=255}--V}}}function eM(t,r,n,i){for(var a=t[r++],s=1<<a,o=s+1,l=o+1,u=a+1,d=(1<<u)-1,f=0,p=0,x=0,v=t[r++],w=new Int32Array(4096),C=null;;){for(;f<16&&v!==0;)p|=t[r++]<<f,f+=8,v===1?v=t[r++]:--v;if(f<u)break;var A=p&d;if(p>>=u,f-=u,A!==s){if(A===o)break;for(var T=A<l?A:C,O=0,D=T;D>s;)D=w[D]>>8,++O;var M=D;if(x+O+(T!==A?1:0)>i)return void na.log("Warning, gif stream longer than expected.");n[x++]=M;var Q=x+=O;for(T!==A&&(n[x++]=M),D=T;O--;)D=w[D],n[--Q]=255&D,D>>=8;C!==null&&l<4096&&(w[l++]=C<<8|M,l>=d+1&&u<12&&(++u,d=d<<1|1)),C=A}else l=o+1,d=(1<<(u=a+1))-1,C=null}return x!==i&&na.log("Warning, gif stream shorter than expected."),n}function mC(t){var r,n,i,a,s,o=Math.floor,l=new Array(64),u=new Array(64),d=new Array(64),f=new Array(64),p=new Array(65535),x=new Array(65535),v=new Array(64),w=new Array(64),C=[],A=0,T=7,O=new Array(64),D=new Array(64),M=new Array(64),Q=new Array(256),U=new Array(2048),$=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ee=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],J=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Z=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],re=[0,1,2,3,4,5,6,7,8,9,10,11],de=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(X,se){for(var W=0,oe=0,ge=new Array,be=1;be<=16;be++){for(var Le=1;Le<=X[be];Le++)ge[se[oe]]=[],ge[se[oe]][0]=W,ge[se[oe]][1]=be,oe++,W++;W*=2}return ge}function ue(X){for(var se=X[0],W=X[1]-1;W>=0;)se&1<<W&&(A|=1<<T),W--,--T<0&&(A==255?(ce(255),ce(0)):ce(A),T=7,A=0)}function ce(X){C.push(X)}function ye(X){ce(X>>8&255),ce(255&X)}function Se(X,se,W,oe,ge){for(var be,Le=ge[0],ke=ge[240],He=(function(yt,rr){var St,xr,hr,zr,yn,Or,xn,Yr,tr,tn,fr=0;for(tr=0;tr<8;++tr){St=yt[fr],xr=yt[fr+1],hr=yt[fr+2],zr=yt[fr+3],yn=yt[fr+4],Or=yt[fr+5],xn=yt[fr+6];var Yi=St+(Yr=yt[fr+7]),Er=St-Yr,wt=xr+xn,sr=xr-xn,ur=hr+Or,Yt=hr-Or,Kn=zr+yn,Fr=zr-yn,Kr=Yi+Kn,Sr=Yi-Kn,Qr=wt+ur,_r=wt-ur;yt[fr]=Kr+Qr,yt[fr+4]=Kr-Qr;var On=.707106781*(_r+Sr);yt[fr+2]=Sr+On,yt[fr+6]=Sr-On;var Zi=.382683433*((Kr=Fr+Yt)-(_r=sr+Er)),Ia=.5411961*Kr+Zi,vi=1.306562965*_r+Zi,$a=.707106781*(Qr=Yt+sr),vr=Er+$a,Oa=Er-$a;yt[fr+5]=Oa+Ia,yt[fr+3]=Oa-Ia,yt[fr+1]=vr+vi,yt[fr+7]=vr-vi,fr+=8}for(fr=0,tr=0;tr<8;++tr){St=yt[fr],xr=yt[fr+8],hr=yt[fr+16],zr=yt[fr+24],yn=yt[fr+32],Or=yt[fr+40],xn=yt[fr+48];var ml=St+(Yr=yt[fr+56]),ga=St-Yr,Ds=xr+xn,Xr=xr-xn,$t=hr+Or,Qn=hr-Or,er=zr+yn,Xi=zr-yn,Yn=ml+er,vn=ml-er,Fi=Ds+$t,Ji=Ds-$t;yt[fr]=Yn+Fi,yt[fr+32]=Yn-Fi;var cs=.707106781*(Ji+vn);yt[fr+16]=vn+cs,yt[fr+48]=vn-cs;var ds=.382683433*((Yn=Xi+Qn)-(Ji=Xr+ga)),$o=.5411961*Yn+ds,Go=1.306562965*Ji+ds,Ga=.707106781*(Fi=Qn+Xr),fi=ga+Ga,kn=ga-Ga;yt[fr+40]=kn+$o,yt[fr+24]=kn-$o,yt[fr+8]=fi+Go,yt[fr+56]=fi-Go,fr++}for(tr=0;tr<64;++tr)tn=yt[tr]*rr[tr],v[tr]=tn>0?tn+.5|0:tn-.5|0;return v})(X,se),Je=0;Je<64;++Je)w[$[Je]]=He[Je];var Qe=w[0]-W;W=w[0],Qe==0?ue(oe[0]):(ue(oe[x[be=32767+Qe]]),ue(p[be]));for(var vt=63;vt>0&&w[vt]==0;)vt--;if(vt==0)return ue(Le),W;for(var Pt,Oe=1;Oe<=vt;){for(var st=Oe;w[Oe]==0&&Oe<=vt;)++Oe;var Wt=Oe-st;if(Wt>=16){Pt=Wt>>4;for(var Bt=1;Bt<=Pt;++Bt)ue(ke);Wt&=15}be=32767+w[Oe],ue(ge[(Wt<<4)+x[be]]),ue(p[be]),Oe++}return vt!=63&&ue(Le),W}function V(X){X=Math.min(Math.max(X,1),100),s!=X&&((function(se){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],oe=0;oe<64;oe++){var ge=o((W[oe]*se+50)/100);ge=Math.min(Math.max(ge,1),255),l[$[oe]]=ge}for(var be=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Le=0;Le<64;Le++){var ke=o((be[Le]*se+50)/100);ke=Math.min(Math.max(ke,1),255),u[$[Le]]=ke}for(var He=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Je=0,Qe=0;Qe<8;Qe++)for(var vt=0;vt<8;vt++)d[Je]=1/(l[$[Je]]*He[Qe]*He[vt]*8),f[Je]=1/(u[$[Je]]*He[Qe]*He[vt]*8),Je++})(X<50?Math.floor(5e3/X):Math.floor(200-2*X)),s=X)}this.encode=function(X,se){se&&V(se),C=new Array,A=0,T=7,ye(65496),ye(65504),ye(16),ce(74),ce(70),ce(73),ce(70),ce(0),ce(1),ce(1),ce(0),ye(1),ye(1),ce(0),ce(0),(function(){ye(65499),ye(132),ce(0);for(var xr=0;xr<64;xr++)ce(l[xr]);ce(1);for(var hr=0;hr<64;hr++)ce(u[hr])})(),(function(xr,hr){ye(65472),ye(17),ce(8),ye(hr),ye(xr),ce(3),ce(1),ce(17),ce(0),ce(2),ce(17),ce(1),ce(3),ce(17),ce(1)})(X.width,X.height),(function(){ye(65476),ye(418),ce(0);for(var xr=0;xr<16;xr++)ce(ee[xr+1]);for(var hr=0;hr<=11;hr++)ce(F[hr]);ce(16);for(var zr=0;zr<16;zr++)ce(Y[zr+1]);for(var yn=0;yn<=161;yn++)ce(J[yn]);ce(1);for(var Or=0;Or<16;Or++)ce(Z[Or+1]);for(var xn=0;xn<=11;xn++)ce(re[xn]);ce(17);for(var Yr=0;Yr<16;Yr++)ce(de[Yr+1]);for(var tr=0;tr<=161;tr++)ce(le[tr])})(),ye(65498),ye(12),ce(3),ce(1),ce(0),ce(2),ce(17),ce(3),ce(17),ce(0),ce(63),ce(0);var W=0,oe=0,ge=0;A=0,T=7,this.encode.displayName="_encode_";for(var be,Le,ke,He,Je,Qe,vt,Pt,Oe,st=X.data,Wt=X.width,Bt=X.height,yt=4*Wt,rr=0;rr<Bt;){for(be=0;be<yt;){for(Je=yt*rr+be,vt=-1,Pt=0,Oe=0;Oe<64;Oe++)Qe=Je+(Pt=Oe>>3)*yt+(vt=4*(7&Oe)),rr+Pt>=Bt&&(Qe-=yt*(rr+1+Pt-Bt)),be+vt>=yt&&(Qe-=be+vt-yt+4),Le=st[Qe++],ke=st[Qe++],He=st[Qe++],O[Oe]=(U[Le]+U[ke+256|0]+U[He+512|0]>>16)-128,D[Oe]=(U[Le+768|0]+U[ke+1024|0]+U[He+1280|0]>>16)-128,M[Oe]=(U[Le+1280|0]+U[ke+1536|0]+U[He+1792|0]>>16)-128;W=Se(O,d,W,r,i),oe=Se(D,f,oe,n,a),ge=Se(M,f,ge,n,a),be+=32}rr+=8}if(T>=0){var St=[];St[1]=T+1,St[0]=(1<<T+1)-1,ue(St)}return ye(65497),new Uint8Array(C)},t=t||50,(function(){for(var X=String.fromCharCode,se=0;se<256;se++)Q[se]=X(se)})(),r=K(ee,F),n=K(Z,re),i=K(Y,J),a=K(de,le),(function(){for(var X=1,se=2,W=1;W<=15;W++){for(var oe=X;oe<se;oe++)x[32767+oe]=W,p[32767+oe]=[],p[32767+oe][1]=W,p[32767+oe][0]=oe;for(var ge=-(se-1);ge<=-X;ge++)x[32767+ge]=W,p[32767+ge]=[],p[32767+ge][1]=W,p[32767+ge][0]=se-1+ge;X<<=1,se<<=1}})(),(function(){for(var X=0;X<256;X++)U[X]=19595*X,U[X+256|0]=38470*X,U[X+512|0]=7471*X+32768,U[X+768|0]=-11059*X,U[X+1024|0]=-21709*X,U[X+1280|0]=32768*X+8421375,U[X+1536|0]=-27439*X,U[X+1792|0]=-5329*X})(),V(t)}function jd(t,r){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function tM(t){function r(F){if(!F)throw Error("assert :P")}function n(F,Y,J){for(var Z=0;4>Z;Z++)if(F[Y+Z]!=J.charCodeAt(Z))return!0;return!1}function i(F,Y,J,Z,re){for(var de=0;de<re;de++)F[Y+de]=J[Z+de]}function a(F,Y,J,Z){for(var re=0;re<Z;re++)F[Y+re]=J}function s(F){return new Int32Array(F)}function o(F,Y){for(var J=[],Z=0;Z<F;Z++)J.push(new Y);return J}function l(F,Y){var J=[];return(function Z(re,de,le){for(var K=le[de],ue=0;ue<K&&(re.push(le.length>de+1?[]:new Y),!(le.length<de+1));ue++)Z(re[ue],de+1,le)})(J,0,F),J}var u=function(){var F=this;function Y(P,q){for(var ae=1<<q-1>>>0;P&ae;)ae>>>=1;return ae?(P&ae-1)+ae:P}function J(P,q,ae,fe,Ce){r(!(fe%ae));do P[q+(fe-=ae)]=Ce;while(0<fe)}function Z(P,q,ae,fe,Ce){if(r(2328>=Ce),512>=Ce)var Ae=s(512);else if((Ae=s(Ce))==null)return 0;return(function(_e,Ie,De,Be,Ge,dt){var ze,Ye,at=Ie,Et=1<<De,lt=s(16),Nt=s(16);for(r(Ge!=0),r(Be!=null),r(_e!=null),r(0<De),Ye=0;Ye<Ge;++Ye){if(15<Be[Ye])return 0;++lt[Be[Ye]]}if(lt[0]==Ge)return 0;for(Nt[1]=0,ze=1;15>ze;++ze){if(lt[ze]>1<<ze)return 0;Nt[ze+1]=Nt[ze]+lt[ze]}for(Ye=0;Ye<Ge;++Ye)ze=Be[Ye],0<Be[Ye]&&(dt[Nt[ze]++]=Ye);if(Nt[15]==1)return(Be=new re).g=0,Be.value=dt[0],J(_e,at,1,Et,Be),Et;var Ot,Ut=-1,zt=Et-1,Nr=0,cr=1,un=1,gr=1<<De;for(Ye=0,ze=1,Ge=2;ze<=De;++ze,Ge<<=1){if(cr+=un<<=1,0>(un-=lt[ze]))return 0;for(;0<lt[ze];--lt[ze])(Be=new re).g=ze,Be.value=dt[Ye++],J(_e,at+Nr,Ge,gr,Be),Nr=Y(Nr,ze)}for(ze=De+1,Ge=2;15>=ze;++ze,Ge<<=1){if(cr+=un<<=1,0>(un-=lt[ze]))return 0;for(;0<lt[ze];--lt[ze]){if(Be=new re,(Nr&zt)!=Ut){for(at+=gr,Ot=1<<(Ut=ze)-De;15>Ut&&!(0>=(Ot-=lt[Ut]));)++Ut,Ot<<=1;Et+=gr=1<<(Ot=Ut-De),_e[Ie+(Ut=Nr&zt)].g=Ot+De,_e[Ie+Ut].value=at-Ie-Ut}Be.g=ze-De,Be.value=dt[Ye++],J(_e,at+(Nr>>De),Ge,gr,Be),Nr=Y(Nr,ze)}}return cr!=2*Nt[15]-1?0:Et})(P,q,ae,fe,Ce,Ae)}function re(){this.value=this.g=0}function de(){this.value=this.g=0}function le(){this.G=o(5,re),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(da,de)}function K(P,q,ae,fe){r(P!=null),r(q!=null),r(2147483648>fe),P.Ca=254,P.I=0,P.b=-8,P.Ka=0,P.oa=q,P.pa=ae,P.Jd=q,P.Yc=ae+fe,P.Zc=4<=fe?ae+fe-4+1:ae,Le(P)}function ue(P,q){for(var ae=0;0<q--;)ae|=He(P,128)<<q;return ae}function ce(P,q){var ae=ue(P,q);return ke(P)?-ae:ae}function ye(P,q,ae,fe){var Ce,Ae=0;for(r(P!=null),r(q!=null),r(4294967288>fe),P.Sb=fe,P.Ra=0,P.u=0,P.h=0,4<fe&&(fe=4),Ce=0;Ce<fe;++Ce)Ae+=q[ae+Ce]<<8*Ce;P.Ra=Ae,P.bb=fe,P.oa=q,P.pa=ae}function Se(P){for(;8<=P.u&&P.bb<P.Sb;)P.Ra>>>=8,P.Ra+=P.oa[P.pa+P.bb]<<is-8>>>0,++P.bb,P.u-=8;oe(P)&&(P.h=1,P.u=0)}function V(P,q){if(r(0<=q),!P.h&&q<=_i){var ae=W(P)&Ys[q];return P.u+=q,Se(P),ae}return P.h=1,P.u=0}function X(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function se(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(P){return P.Ra>>>(P.u&is-1)>>>0}function oe(P){return r(P.bb<=P.Sb),P.h||P.bb==P.Sb&&P.u>is}function ge(P,q){P.u=q,P.h=oe(P)}function be(P){P.u>=ln&&(r(P.u>=ln),Se(P))}function Le(P){r(P!=null&&P.oa!=null),P.pa<P.Zc?(P.I=(P.oa[P.pa++]|P.I<<8)>>>0,P.b+=8):(r(P!=null&&P.oa!=null),P.pa<P.Yc?(P.b+=8,P.I=P.oa[P.pa++]|P.I<<8):P.Ka?P.b=0:(P.I<<=8,P.b+=8,P.Ka=1))}function ke(P){return ue(P,1)}function He(P,q){var ae=P.Ca;0>P.b&&Le(P);var fe=P.b,Ce=ae*q>>>8,Ae=(P.I>>>fe>Ce)+0;for(Ae?(ae-=Ce,P.I-=Ce+1<<fe>>>0):ae=Ce+1,fe=ae,Ce=0;256<=fe;)Ce+=8,fe>>=8;return fe=7^Ce+Zs[fe],P.b-=fe,P.Ca=(ae<<fe)-1,Ae}function Je(P,q,ae){P[q+0]=ae>>24&255,P[q+1]=ae>>16&255,P[q+2]=ae>>8&255,P[q+3]=255&ae}function Qe(P,q){return P[q+0]|P[q+1]<<8}function vt(P,q){return Qe(P,q)|P[q+2]<<16}function Pt(P,q){return Qe(P,q)|Qe(P,q+2)<<16}function Oe(P,q){var ae=1<<q;return r(P!=null),r(0<q),P.X=s(ae),P.X==null?0:(P.Mb=32-q,P.Xa=q,1)}function st(P,q){r(P!=null),r(q!=null),r(P.Xa==q.Xa),i(q.X,0,P.X,0,1<<q.Xa)}function Wt(){this.X=[],this.Xa=this.Mb=0}function Bt(P,q,ae,fe){r(ae!=null),r(fe!=null);var Ce=ae[0],Ae=fe[0];return Ce==0&&(Ce=(P*Ae+q/2)/q),Ae==0&&(Ae=(q*Ce+P/2)/P),0>=Ce||0>=Ae?0:(ae[0]=Ce,fe[0]=Ae,1)}function yt(P,q){return P+(1<<q)-1>>>q}function rr(P,q){return((4278255360&P)+(4278255360&q)>>>0&4278255360)+((16711935&P)+(16711935&q)>>>0&16711935)>>>0}function St(P,q){F[q]=function(ae,fe,Ce,Ae,_e,Ie,De){var Be;for(Be=0;Be<_e;++Be){var Ge=F[P](Ie[De+Be-1],Ce,Ae+Be);Ie[De+Be]=rr(ae[fe+Be],Ge)}}}function xr(){this.ud=this.hd=this.jd=0}function hr(P,q){return((4278124286&(P^q))>>>1)+(P&q)>>>0}function zr(P){return 0<=P&&256>P?P:0>P?0:255<P?255:void 0}function yn(P,q){return zr(P+(P-q+.5>>1))}function Or(P,q,ae){return Math.abs(q-ae)-Math.abs(P-ae)}function xn(P,q,ae,fe,Ce,Ae,_e){for(fe=Ae[_e-1],ae=0;ae<Ce;++ae)Ae[_e+ae]=fe=rr(P[q+ae],fe)}function Yr(P,q,ae,fe,Ce){var Ae;for(Ae=0;Ae<ae;++Ae){var _e=P[q+Ae],Ie=_e>>8&255,De=16711935&(De=(De=16711935&_e)+((Ie<<16)+Ie));fe[Ce+Ae]=(4278255360&_e)+De>>>0}}function tr(P,q){q.jd=255&P,q.hd=P>>8&255,q.ud=P>>16&255}function tn(P,q,ae,fe,Ce,Ae){var _e;for(_e=0;_e<fe;++_e){var Ie=q[ae+_e],De=Ie>>>8,Be=Ie,Ge=255&(Ge=(Ge=Ie>>>16)+((P.jd<<24>>24)*(De<<24>>24)>>>5));Be=255&(Be=(Be+=(P.hd<<24>>24)*(De<<24>>24)>>>5)+((P.ud<<24>>24)*(Ge<<24>>24)>>>5)),Ce[Ae+_e]=(4278255360&Ie)+(Ge<<16)+Be}}function fr(P,q,ae,fe,Ce){F[q]=function(Ae,_e,Ie,De,Be,Ge,dt,ze,Ye){for(De=dt;De<ze;++De)for(dt=0;dt<Ye;++dt)Be[Ge++]=Ce(Ie[fe(Ae[_e++])])},F[P]=function(Ae,_e,Ie,De,Be,Ge,dt){var ze=8>>Ae.b,Ye=Ae.Ea,at=Ae.K[0],Et=Ae.w;if(8>ze)for(Ae=(1<<Ae.b)-1,Et=(1<<ze)-1;_e<Ie;++_e){var lt,Nt=0;for(lt=0;lt<Ye;++lt)lt&Ae||(Nt=fe(De[Be++])),Ge[dt++]=Ce(at[Nt&Et]),Nt>>=ze}else F["VP8LMapColor"+ae](De,Be,at,Et,Ge,dt,_e,Ie,Ye)}}function Yi(P,q,ae,fe,Ce){for(ae=q+ae;q<ae;){var Ae=P[q++];fe[Ce++]=Ae>>16&255,fe[Ce++]=Ae>>8&255,fe[Ce++]=255&Ae}}function Er(P,q,ae,fe,Ce){for(ae=q+ae;q<ae;){var Ae=P[q++];fe[Ce++]=Ae>>16&255,fe[Ce++]=Ae>>8&255,fe[Ce++]=255&Ae,fe[Ce++]=Ae>>24&255}}function wt(P,q,ae,fe,Ce){for(ae=q+ae;q<ae;){var Ae=(_e=P[q++])>>16&240|_e>>12&15,_e=240&_e|_e>>28&15;fe[Ce++]=Ae,fe[Ce++]=_e}}function sr(P,q,ae,fe,Ce){for(ae=q+ae;q<ae;){var Ae=(_e=P[q++])>>16&248|_e>>13&7,_e=_e>>5&224|_e>>3&31;fe[Ce++]=Ae,fe[Ce++]=_e}}function ur(P,q,ae,fe,Ce){for(ae=q+ae;q<ae;){var Ae=P[q++];fe[Ce++]=255&Ae,fe[Ce++]=Ae>>8&255,fe[Ce++]=Ae>>16&255}}function Yt(P,q,ae,fe,Ce,Ae){if(Ae==0)for(ae=q+ae;q<ae;)Je(fe,((Ae=P[q++])[0]>>24|Ae[1]>>8&65280|Ae[2]<<8&16711680|Ae[3]<<24)>>>0),Ce+=32;else i(fe,Ce,P,q,ae)}function Kn(P,q){F[q][0]=F[P+"0"],F[q][1]=F[P+"1"],F[q][2]=F[P+"2"],F[q][3]=F[P+"3"],F[q][4]=F[P+"4"],F[q][5]=F[P+"5"],F[q][6]=F[P+"6"],F[q][7]=F[P+"7"],F[q][8]=F[P+"8"],F[q][9]=F[P+"9"],F[q][10]=F[P+"10"],F[q][11]=F[P+"11"],F[q][12]=F[P+"12"],F[q][13]=F[P+"13"],F[q][14]=F[P+"0"],F[q][15]=F[P+"0"]}function Fr(P){return P==Ld||P==Cu||P==zd||P==y}function Kr(){this.eb=[],this.size=this.A=this.fb=0}function Sr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Qr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Kr,this.f.kb=new Sr,this.sd=null}function _r(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function On(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Zi(P){return alert("todo:WebPSamplerProcessPlane"),P.T}function Ia(P,q){var ae=P.T,fe=q.ba.f.RGBA,Ce=fe.eb,Ae=fe.fb+P.ka*fe.A,_e=La[q.ba.S],Ie=P.y,De=P.O,Be=P.f,Ge=P.N,dt=P.ea,ze=P.W,Ye=q.cc,at=q.dc,Et=q.Mc,lt=q.Nc,Nt=P.ka,Ot=P.ka+P.T,Ut=P.U,zt=Ut+1>>1;for(Nt==0?_e(Ie,De,null,null,Be,Ge,dt,ze,Be,Ge,dt,ze,Ce,Ae,null,null,Ut):(_e(q.ec,q.fc,Ie,De,Ye,at,Et,lt,Be,Ge,dt,ze,Ce,Ae-fe.A,Ce,Ae,Ut),++ae);Nt+2<Ot;Nt+=2)Ye=Be,at=Ge,Et=dt,lt=ze,Ge+=P.Rc,ze+=P.Rc,Ae+=2*fe.A,_e(Ie,(De+=2*P.fa)-P.fa,Ie,De,Ye,at,Et,lt,Be,Ge,dt,ze,Ce,Ae-fe.A,Ce,Ae,Ut);return De+=P.fa,P.j+Ot<P.o?(i(q.ec,q.fc,Ie,De,Ut),i(q.cc,q.dc,Be,Ge,zt),i(q.Mc,q.Nc,dt,ze,zt),ae--):1&Ot||_e(Ie,De,null,null,Be,Ge,dt,ze,Be,Ge,dt,ze,Ce,Ae+fe.A,null,null,Ut),ae}function vi(P,q,ae){var fe=P.F,Ce=[P.J];if(fe!=null){var Ae=P.U,_e=q.ba.S,Ie=_e==Md||_e==zd;q=q.ba.f.RGBA;var De=[0],Be=P.ka;De[0]=P.T,P.Kb&&(Be==0?--De[0]:(--Be,Ce[0]-=P.width),P.j+P.ka+P.T==P.o&&(De[0]=P.o-P.j-Be));var Ge=q.eb;Be=q.fb+Be*q.A,P=Pd(fe,Ce[0],P.width,Ae,De,Ge,Be+(Ie?0:3),q.A),r(ae==De),P&&Fr(_e)&&Oo(Ge,Be,Ie,Ae,De,q.A)}return 0}function $a(P){var q=P.ma,ae=q.ba.S,fe=11>ae,Ce=ae==zs||ae==il||ae==Md||ae==hd||ae==12||Fr(ae);if(q.memory=null,q.Ib=null,q.Jb=null,q.Nd=null,!tl(q.Oa,P,Ce?11:12))return 0;if(Ce&&Fr(ae)&&Xo(),P.da)alert("todo:use_scaling");else{if(fe){if(q.Ib=Zi,P.Kb){if(ae=P.U+1>>1,q.memory=s(P.U+2*ae),q.memory==null)return 0;q.ec=q.memory,q.fc=0,q.cc=q.ec,q.dc=q.fc+P.U,q.Mc=q.cc,q.Nc=q.dc+ae,q.Ib=Ia,Xo()}}else alert("todo:EmitYUV");Ce&&(q.Jb=vi,fe&&ts())}if(fe&&!Wd){for(P=0;256>P;++P)ho[P]=89858*(P-128)+Ah>>Xl,oj[P]=-22014*(P-128)+Ah,Ky[P]=-45773*(P-128),Om[P]=113618*(P-128)+Ah>>Xl;for(P=Nu;P<Ud;++P)q=76283*(P-16)+Ah>>Xl,lj[P-Nu]=Jr(q,255),cj[P-Nu]=Jr(q+8>>4,15);Wd=1}return 1}function vr(P){var q=P.ma,ae=P.U,fe=P.T;return r(!(1&P.ka)),0>=ae||0>=fe?0:(ae=q.Ib(P,q),q.Jb!=null&&q.Jb(P,q,ae),q.Dc+=ae,1)}function Oa(P){P.ma.memory=null}function ml(P,q,ae,fe){return V(P,8)!=47?0:(q[0]=V(P,14)+1,ae[0]=V(P,14)+1,fe[0]=V(P,1),V(P,3)!=0?0:!P.h)}function ga(P,q){if(4>P)return P+1;var ae=P-2>>1;return(2+(1&P)<<ae)+V(q,ae)+1}function Ds(P,q){return 120<q?q-120:1<=(ae=((ae=Fe[q-1])>>4)*P+(8-(15&ae)))?ae:1;var ae}function Xr(P,q,ae){var fe=W(ae),Ce=P[q+=255&fe].g-8;return 0<Ce&&(ge(ae,ae.u+8),fe=W(ae),q+=P[q].value,q+=fe&(1<<Ce)-1),ge(ae,ae.u+P[q].g),P[q].value}function $t(P,q,ae){return ae.g+=P.g,ae.value+=P.value<<q>>>0,r(8>=ae.g),P.g}function Qn(P,q,ae){var fe=P.xc;return r((q=fe==0?0:P.vc[P.md*(ae>>fe)+(q>>fe)])<P.Wb),P.Ya[q]}function er(P,q,ae,fe){var Ce=P.ab,Ae=P.c*q,_e=P.C;q=_e+q;var Ie=ae,De=fe;for(fe=P.Ta,ae=P.Ua;0<Ce--;){var Be=P.gc[Ce],Ge=_e,dt=q,ze=Ie,Ye=De,at=(De=fe,Ie=ae,Be.Ea);switch(r(Ge<dt),r(dt<=Be.nc),Be.hc){case 2:g(ze,Ye,(dt-Ge)*at,De,Ie);break;case 0:var Et=Ge,lt=dt,Nt=De,Ot=Ie,Ut=(gr=Be).Ea;Et==0&&(je(ze,Ye,null,null,1,Nt,Ot),xn(ze,Ye+1,0,0,Ut-1,Nt,Ot+1),Ye+=Ut,Ot+=Ut,++Et);for(var zt=1<<gr.b,Nr=zt-1,cr=yt(Ut,gr.b),un=gr.K,gr=gr.w+(Et>>gr.b)*cr;Et<lt;){var Wn=un,ta=gr,bn=1;for(h(ze,Ye,Nt,Ot-Ut,1,Nt,Ot);bn<Ut;){var dr=(bn&~Nr)+zt;dr>Ut&&(dr=Ut),(0,R[Wn[ta++]>>8&15])(ze,Ye+ +bn,Nt,Ot+bn-Ut,dr-bn,Nt,Ot+bn),bn=dr}Ye+=Ut,Ot+=Ut,++Et&Nr||(gr+=cr)}dt!=Be.nc&&i(De,Ie-at,De,Ie+(dt-Ge-1)*at,at);break;case 1:for(at=ze,lt=Ye,Ut=(ze=Be.Ea)-(Ot=ze&~(Nt=(Ye=1<<Be.b)-1)),Et=yt(ze,Be.b),zt=Be.K,Be=Be.w+(Ge>>Be.b)*Et;Ge<dt;){for(Nr=zt,cr=Be,un=new xr,gr=lt+Ot,Wn=lt+ze;lt<gr;)tr(Nr[cr++],un),H(un,at,lt,Ye,De,Ie),lt+=Ye,Ie+=Ye;lt<Wn&&(tr(Nr[cr++],un),H(un,at,lt,Ut,De,Ie),lt+=Ut,Ie+=Ut),++Ge&Nt||(Be+=Et)}break;case 3:if(ze==De&&Ye==Ie&&0<Be.b){for(lt=De,ze=at=Ie+(dt-Ge)*at-(Ot=(dt-Ge)*yt(Be.Ea,Be.b)),Ye=De,Nt=Ie,Et=[],Ot=(Ut=Ot)-1;0<=Ot;--Ot)Et[Ot]=Ye[Nt+Ot];for(Ot=Ut-1;0<=Ot;--Ot)lt[ze+Ot]=Et[Ot];b(Be,Ge,dt,De,at,De,Ie)}else b(Be,Ge,dt,ze,Ye,De,Ie)}Ie=fe,De=ae}De!=ae&&i(fe,ae,Ie,De,Ae)}function Xi(P,q){var ae=P.V,fe=P.Ba+P.c*P.C,Ce=q-P.C;if(r(q<=P.l.o),r(16>=Ce),0<Ce){var Ae=P.l,_e=P.Ta,Ie=P.Ua,De=Ae.width;if(er(P,Ce,ae,fe),Ce=Ie=[Ie],r((ae=P.C)<(fe=q)),r(Ae.v<Ae.va),fe>Ae.o&&(fe=Ae.o),ae<Ae.j){var Be=Ae.j-ae;ae=Ae.j,Ce[0]+=Be*De}if(ae>=fe?ae=0:(Ce[0]+=4*Ae.v,Ae.ka=ae-Ae.j,Ae.U=Ae.va-Ae.v,Ae.T=fe-ae,ae=1),ae){if(Ie=Ie[0],11>(ae=P.ca).S){var Ge=ae.f.RGBA,dt=(fe=ae.S,Ce=Ae.U,Ae=Ae.T,Be=Ge.eb,Ge.A),ze=Ae;for(Ge=Ge.fb+P.Ma*Ge.A;0<ze--;){var Ye=_e,at=Ie,Et=Ce,lt=Be,Nt=Ge;switch(fe){case Ch:ne(Ye,at,Et,lt,Nt);break;case zs:he(Ye,at,Et,lt,Nt);break;case Ld:he(Ye,at,Et,lt,Nt),Oo(lt,Nt,0,Et,1,0);break;case Su:Me(Ye,at,Et,lt,Nt);break;case il:Yt(Ye,at,Et,lt,Nt,1);break;case Cu:Yt(Ye,at,Et,lt,Nt,1),Oo(lt,Nt,0,Et,1,0);break;case Md:Yt(Ye,at,Et,lt,Nt,0);break;case zd:Yt(Ye,at,Et,lt,Nt,0),Oo(lt,Nt,1,Et,1,0);break;case hd:ve(Ye,at,Et,lt,Nt);break;case y:ve(Ye,at,Et,lt,Nt),rl(lt,Nt,Et,1,0);break;case Uc:Ne(Ye,at,Et,lt,Nt);break;default:r(0)}Ie+=De,Ge+=dt}P.Ma+=Ae}else alert("todo:EmitRescaledRowsYUVA");r(P.Ma<=ae.height)}}P.C=q,r(P.C<=P.i)}function Yn(P){var q;if(0<P.ua)return 0;for(q=0;q<P.Wb;++q){var ae=P.Ya[q].G,fe=P.Ya[q].H;if(0<ae[1][fe[1]+0].g||0<ae[2][fe[2]+0].g||0<ae[3][fe[3]+0].g)return 0}return 1}function vn(P,q,ae,fe,Ce,Ae){if(P.Z!=0){var _e=P.qd,Ie=P.rd;for(r(pi[P.Z]!=null);q<ae;++q)pi[P.Z](_e,Ie,fe,Ce,fe,Ce,Ae),_e=fe,Ie=Ce,Ce+=Ae;P.qd=_e,P.rd=Ie}}function Fi(P,q){var ae=P.l.ma,fe=ae.Z==0||ae.Z==1?P.l.j:P.C;if(fe=P.C<fe?fe:P.C,r(q<=P.l.o),q>fe){var Ce=P.l.width,Ae=ae.ca,_e=ae.tb+Ce*fe,Ie=P.V,De=P.Ba+P.c*fe,Be=P.gc;r(P.ab==1),r(Be[0].hc==3),N(Be[0],fe,q,Ie,De,Ae,_e),vn(ae,fe,q,Ae,_e,Ce)}P.C=P.Ma=q}function Ji(P,q,ae,fe,Ce,Ae,_e){var Ie=P.$/fe,De=P.$%fe,Be=P.m,Ge=P.s,dt=ae+P.$,ze=dt;Ce=ae+fe*Ce;var Ye=ae+fe*Ae,at=280+Ge.ua,Et=P.Pb?Ie:16777216,lt=0<Ge.ua?Ge.Wa:null,Nt=Ge.wc,Ot=dt<Ye?Qn(Ge,De,Ie):null;r(P.C<Ae),r(Ye<=Ce);var Ut=!1;e:for(;;){for(;Ut||dt<Ye;){var zt=0;if(Ie>=Et){var Nr=dt-ae;r((Et=P).Pb),Et.wd=Et.m,Et.xd=Nr,0<Et.s.ua&&st(Et.s.Wa,Et.s.vb),Et=Ie+mt}if(De&Nt||(Ot=Qn(Ge,De,Ie)),r(Ot!=null),Ot.Qb&&(q[dt]=Ot.qb,Ut=!0),!Ut)if(be(Be),Ot.jc){zt=Be,Nr=q;var cr=dt,un=Ot.pd[W(zt)&da-1];r(Ot.jc),256>un.g?(ge(zt,zt.u+un.g),Nr[cr]=un.value,zt=0):(ge(zt,zt.u+un.g-256),r(256<=un.value),zt=un.value),zt==0&&(Ut=!0)}else zt=Xr(Ot.G[0],Ot.H[0],Be);if(Be.h)break;if(Ut||256>zt){if(!Ut)if(Ot.nd)q[dt]=(Ot.qb|zt<<8)>>>0;else{if(be(Be),Ut=Xr(Ot.G[1],Ot.H[1],Be),be(Be),Nr=Xr(Ot.G[2],Ot.H[2],Be),cr=Xr(Ot.G[3],Ot.H[3],Be),Be.h)break;q[dt]=(cr<<24|Ut<<16|zt<<8|Nr)>>>0}if(Ut=!1,++dt,++De>=fe&&(De=0,++Ie,_e!=null&&Ie<=Ae&&!(Ie%16)&&_e(P,Ie),lt!=null))for(;ze<dt;)zt=q[ze++],lt.X[(506832829*zt&4294967295)>>>lt.Mb]=zt}else if(280>zt){if(zt=ga(zt-256,Be),Nr=Xr(Ot.G[4],Ot.H[4],Be),be(Be),Nr=Ds(fe,Nr=ga(Nr,Be)),Be.h)break;if(dt-ae<Nr||Ce-dt<zt)break e;for(cr=0;cr<zt;++cr)q[dt+cr]=q[dt+cr-Nr];for(dt+=zt,De+=zt;De>=fe;)De-=fe,++Ie,_e!=null&&Ie<=Ae&&!(Ie%16)&&_e(P,Ie);if(r(dt<=Ce),De&Nt&&(Ot=Qn(Ge,De,Ie)),lt!=null)for(;ze<dt;)zt=q[ze++],lt.X[(506832829*zt&4294967295)>>>lt.Mb]=zt}else{if(!(zt<at))break e;for(Ut=zt-280,r(lt!=null);ze<dt;)zt=q[ze++],lt.X[(506832829*zt&4294967295)>>>lt.Mb]=zt;zt=dt,r(!(Ut>>>(Nr=lt).Xa)),q[zt]=Nr.X[Ut],Ut=!0}Ut||r(Be.h==oe(Be))}if(P.Pb&&Be.h&&dt<Ce)r(P.m.h),P.a=5,P.m=P.wd,P.$=P.xd,0<P.s.ua&&st(P.s.vb,P.s.Wa);else{if(Be.h)break e;_e?.(P,Ie>Ae?Ae:Ie),P.a=0,P.$=dt-ae}return 1}return P.a=3,0}function cs(P){r(P!=null),P.vc=null,P.yc=null,P.Ya=null;var q=P.Wa;q!=null&&(q.X=null),P.vb=null,r(P!=null)}function ds(){var P=new Ur;return P==null?null:(P.a=0,P.xb=Nh,Kn("Predictor","VP8LPredictors"),Kn("Predictor","VP8LPredictors_C"),Kn("PredictorAdd","VP8LPredictorsAdd"),Kn("PredictorAdd","VP8LPredictorsAdd_C"),g=Yr,H=tn,ne=Yi,he=Er,ve=wt,Ne=sr,Me=ur,F.VP8LMapColor32b=S,F.VP8LMapColor8b=I,P)}function $o(P,q,ae,fe,Ce){var Ae=1,_e=[P],Ie=[q],De=fe.m,Be=fe.s,Ge=null,dt=0;e:for(;;){if(ae)for(;Ae&&V(De,1);){var ze=_e,Ye=Ie,at=fe,Et=1,lt=at.m,Nt=at.gc[at.ab],Ot=V(lt,2);if(at.Oc&1<<Ot)Ae=0;else{switch(at.Oc|=1<<Ot,Nt.hc=Ot,Nt.Ea=ze[0],Nt.nc=Ye[0],Nt.K=[null],++at.ab,r(4>=at.ab),Ot){case 0:case 1:Nt.b=V(lt,3)+2,Et=$o(yt(Nt.Ea,Nt.b),yt(Nt.nc,Nt.b),0,at,Nt.K),Nt.K=Nt.K[0];break;case 3:var Ut,zt=V(lt,8)+1,Nr=16<zt?0:4<zt?1:2<zt?2:3;if(ze[0]=yt(Nt.Ea,Nr),Nt.b=Nr,Ut=Et=$o(zt,1,0,at,Nt.K)){var cr,un=zt,gr=Nt,Wn=1<<(8>>gr.b),ta=s(Wn);if(ta==null)Ut=0;else{var bn=gr.K[0],dr=gr.w;for(ta[0]=gr.K[0][0],cr=1;cr<1*un;++cr)ta[cr]=rr(bn[dr+cr],ta[cr-1]);for(;cr<4*Wn;++cr)ta[cr]=0;gr.K[0]=null,gr.K[0]=ta,Ut=1}}Et=Ut;break;case 2:break;default:r(0)}Ae=Et}}if(_e=_e[0],Ie=Ie[0],Ae&&V(De,1)&&!(Ae=1<=(dt=V(De,4))&&11>=dt)){fe.a=3;break e}var Jt;if(Jt=Ae)t:{var ja,en,Nn,Si=fe,Fs=_e,fo=Ie,Ui=dt,ys=ae,ko=Si.m,xs=Si.s,Dn=[null],si=1,wa=0,ui=tt[Ui];r:for(;;){if(ys&&V(ko,1)){var qs=V(ko,3)+2,Sa=yt(Fs,qs),oi=yt(fo,qs),ss=Sa*oi;if(!$o(Sa,oi,0,Si,Dn))break r;for(Dn=Dn[0],xs.xc=qs,ja=0;ja<ss;++ja){var Ci=Dn[ja]>>8&65535;Dn[ja]=Ci,Ci>=si&&(si=Ci+1)}}if(ko.h)break r;for(en=0;5>en;++en){var vs=ie[en];!en&&0<Ui&&(vs+=1<<Ui),wa<vs&&(wa=vs)}var bs=o(si*ui,re),Di=si,ti=o(Di,le);if(ti==null)var Do=null;else r(65536>=Di),Do=ti;var za=s(wa);if(Do==null||za==null||bs==null){Si.a=1;break r}var Wr=bs;for(ja=Nn=0;ja<si;++ja){var Vr=Do[ja],li=Vr.G,vl=Vr.H,Jl=0,sl=1,js=0;for(en=0;5>en;++en){vs=ie[en],li[en]=Wr,vl[en]=Nn,!en&&0<Ui&&(vs+=1<<Ui);i:{var Hd,Vd=vs,Dm=Si,Wi=za,v0=Wr,b0=Nn,Pm=0,md=Dm.m,dj=V(md,1);if(a(Wi,0,0,Vd),dj){var j0=V(md,1)+1,w0=V(md,1),Rm=V(md,w0==0?1:8);Wi[Rm]=1,j0==2&&(Wi[Rm=V(md,8)]=1);var Xs=1}else{var Ba=s(19),Sf=V(md,4)+4;if(19<Sf){Dm.a=3;var $d=0;break i}for(Hd=0;Hd<Sf;++Hd)Ba[Ee[Hd]]=V(md,3);var _h=void 0,Au=void 0,Hc=Dm,Mm=Ba,Th=Vd,Lm=Wi,zm=0,pd=Hc.m,S0=8,C0=o(128,re);n:for(;Z(C0,0,7,Mm,19);){if(V(pd,1)){var Qy=2+2*V(pd,3);if((_h=2+V(pd,Qy))>Th)break n}else _h=Th;for(Au=0;Au<Th&&_h--;){be(pd);var N0=C0[0+(127&W(pd))];ge(pd,pd.u+N0.g);var Gd=N0.value;if(16>Gd)Lm[Au++]=Gd,Gd!=0&&(S0=Gd);else{var Yy=Gd==16,Zy=Gd-16,Xy=z[Zy],A0=V(pd,E[Zy])+Xy;if(Au+A0>Th)break n;for(var Jy=Yy?S0:0;0<A0--;)Lm[Au++]=Jy}}zm=1;break n}zm||(Hc.a=3),Xs=zm}(Xs=Xs&&!md.h)&&(Pm=Z(v0,b0,8,Wi,Vd)),Xs&&Pm!=0?$d=Pm:(Dm.a=3,$d=0)}if($d==0)break r;if(sl&&me[en]==1&&(sl=Wr[Nn].g==0),Jl+=Wr[Nn].g,Nn+=$d,3>=en){var Eu,Bm=za[0];for(Eu=1;Eu<vs;++Eu)za[Eu]>Bm&&(Bm=za[Eu]);js+=Bm}}if(Vr.nd=sl,Vr.Qb=0,sl&&(Vr.qb=(li[3][vl[3]+0].value<<24|li[1][vl[1]+0].value<<16|li[2][vl[2]+0].value)>>>0,Jl==0&&256>li[0][vl[0]+0].value&&(Vr.Qb=1,Vr.qb+=li[0][vl[0]+0].value<<8)),Vr.jc=!Vr.Qb&&6>js,Vr.jc){var Cf,Vc=Vr;for(Cf=0;Cf<da;++Cf){var gd=Cf,yd=Vc.pd[gd],Fm=Vc.G[0][Vc.H[0]+gd];256<=Fm.value?(yd.g=Fm.g+256,yd.value=Fm.value):(yd.g=0,yd.value=0,gd>>=$t(Fm,8,yd),gd>>=$t(Vc.G[1][Vc.H[1]+gd],16,yd),gd>>=$t(Vc.G[2][Vc.H[2]+gd],0,yd),$t(Vc.G[3][Vc.H[3]+gd],24,yd))}}}xs.vc=Dn,xs.Wb=si,xs.Ya=Do,xs.yc=bs,Jt=1;break t}Jt=0}if(!(Ae=Jt)){fe.a=3;break e}if(0<dt){if(Be.ua=1<<dt,!Oe(Be.Wa,dt)){fe.a=1,Ae=0;break e}}else Be.ua=0;var qm=fe,_u=_e,ex=Ie,Ih=qm.s,Oh=Ih.xc;if(qm.c=_u,qm.i=ex,Ih.md=yt(_u,Oh),Ih.wc=Oh==0?-1:(1<<Oh)-1,ae){fe.xb=Wc;break e}if((Ge=s(_e*Ie))==null){fe.a=1,Ae=0;break e}Ae=(Ae=Ji(fe,Ge,0,_e,Ie,Ie,null))&&!De.h;break e}return Ae?(Ce!=null?Ce[0]=Ge:(r(Ge==null),r(ae)),fe.$=0,ae||cs(Be)):cs(Be),Ae}function Go(P,q){var ae=P.c*P.i,fe=ae+q+16*q;return r(P.c<=q),P.V=s(fe),P.V==null?(P.Ta=null,P.Ua=0,P.a=1,0):(P.Ta=P.V,P.Ua=P.Ba+ae+q,1)}function Ga(P,q){var ae=P.C,fe=q-ae,Ce=P.V,Ae=P.Ba+P.c*ae;for(r(q<=P.l.o);0<fe;){var _e=16<fe?16:fe,Ie=P.l.ma,De=P.l.width,Be=De*_e,Ge=Ie.ca,dt=Ie.tb+De*ae,ze=P.Ta,Ye=P.Ua;er(P,_e,Ce,Ae),nl(ze,Ye,Ge,dt,Be),vn(Ie,ae,ae+_e,Ge,dt,De),fe-=_e,Ce+=_e*P.c,ae+=_e}r(ae==q),P.C=P.Ma=q}function fi(){this.ub=this.yd=this.td=this.Rb=0}function kn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ko(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ka(){this.Yb=(function(){var P=[];return(function q(ae,fe,Ce){for(var Ae=Ce[fe],_e=0;_e<Ae&&(ae.push(Ce.length>fe+1?[]:0),!(Ce.length<fe+1));_e++)q(ae[_e],fe+1,Ce)})(P,0,[3,11]),P})()}function Oi(){this.jb=s(3),this.Wc=l([4,8],Ka),this.Xc=l([4,17],Ka)}function Rt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function io(){this.ld=this.La=this.dd=this.tc=0}function zn(){this.Na=this.la=0}function us(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function kl(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function _n(){this.uc=this.M=this.Nb=0,this.wa=Array(new io),this.Y=0,this.ya=Array(new kl),this.aa=0,this.l=new Rn}function An(){this.y=s(16),this.f=s(8),this.ea=s(8)}function on(){this.cb=this.a=0,this.sc="",this.m=new X,this.Od=new fi,this.Kc=new kn,this.ed=new Rt,this.Qa=new Ko,this.Ic=this.$c=this.Aa=0,this.D=new _n,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,X),this.ia=0,this.pb=o(4,us),this.Pa=new Oi,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new An),this.Hd=0,this.rb=Array(new zn),this.sb=0,this.wa=Array(new io),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new kl),this.L=this.aa=0,this.gd=l([4,2],io),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Jr(P,q){return 0>P?0:P>q?q:P}function Rn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function hs(){var P=new on;return P!=null&&(P.a=0,P.sc="OK",P.cb=0,P.Xb=0,br||(br=ir)),P}function Mr(P,q,ae){return P.a==0&&(P.a=q,P.sc=ae,P.cb=0),0}function Qa(P,q,ae){return 3<=ae&&P[q+0]==157&&P[q+1]==1&&P[q+2]==42}function No(P,q){if(P==null)return 0;if(P.a=0,P.sc="OK",q==null)return Mr(P,2,"null VP8Io passed to VP8GetHeaders()");var ae=q.data,fe=q.w,Ce=q.ha;if(4>Ce)return Mr(P,7,"Truncated header.");var Ae=ae[fe+0]|ae[fe+1]<<8|ae[fe+2]<<16,_e=P.Od;if(_e.Rb=!(1&Ae),_e.td=Ae>>1&7,_e.yd=Ae>>4&1,_e.ub=Ae>>5,3<_e.td)return Mr(P,3,"Incorrect keyframe parameters.");if(!_e.yd)return Mr(P,4,"Frame not displayable.");fe+=3,Ce-=3;var Ie=P.Kc;if(_e.Rb){if(7>Ce)return Mr(P,7,"cannot parse picture header");if(!Qa(ae,fe,Ce))return Mr(P,3,"Bad code word");Ie.c=16383&(ae[fe+4]<<8|ae[fe+3]),Ie.Td=ae[fe+4]>>6,Ie.i=16383&(ae[fe+6]<<8|ae[fe+5]),Ie.Ud=ae[fe+6]>>6,fe+=7,Ce-=7,P.za=Ie.c+15>>4,P.Ub=Ie.i+15>>4,q.width=Ie.c,q.height=Ie.i,q.Da=0,q.j=0,q.v=0,q.va=q.width,q.o=q.height,q.da=0,q.ib=q.width,q.hb=q.height,q.U=q.width,q.T=q.height,a((Ae=P.Pa).jb,0,255,Ae.jb.length),r((Ae=P.Qa)!=null),Ae.Cb=0,Ae.Bb=0,Ae.Fb=1,a(Ae.Zb,0,0,Ae.Zb.length),a(Ae.Lb,0,0,Ae.Lb)}if(_e.ub>Ce)return Mr(P,7,"bad partition length");K(Ae=P.m,ae,fe,_e.ub),fe+=_e.ub,Ce-=_e.ub,_e.Rb&&(Ie.Ld=ke(Ae),Ie.Kd=ke(Ae)),Ie=P.Qa;var De,Be=P.Pa;if(r(Ae!=null),r(Ie!=null),Ie.Cb=ke(Ae),Ie.Cb){if(Ie.Bb=ke(Ae),ke(Ae)){for(Ie.Fb=ke(Ae),De=0;4>De;++De)Ie.Zb[De]=ke(Ae)?ce(Ae,7):0;for(De=0;4>De;++De)Ie.Lb[De]=ke(Ae)?ce(Ae,6):0}if(Ie.Bb)for(De=0;3>De;++De)Be.jb[De]=ke(Ae)?ue(Ae,8):255}else Ie.Bb=0;if(Ae.Ka)return Mr(P,3,"cannot parse segment header");if((Ie=P.ed).zd=ke(Ae),Ie.Tb=ue(Ae,6),Ie.wb=ue(Ae,3),Ie.Pc=ke(Ae),Ie.Pc&&ke(Ae)){for(Be=0;4>Be;++Be)ke(Ae)&&(Ie.vd[Be]=ce(Ae,6));for(Be=0;4>Be;++Be)ke(Ae)&&(Ie.od[Be]=ce(Ae,6))}if(P.L=Ie.Tb==0?0:Ie.zd?1:2,Ae.Ka)return Mr(P,3,"cannot parse filter header");var Ge=Ce;if(Ce=De=fe,fe=De+Ge,Ie=Ge,P.Xb=(1<<ue(P.m,2))-1,Ge<3*(Be=P.Xb))ae=7;else{for(De+=3*Be,Ie-=3*Be,Ge=0;Ge<Be;++Ge){var dt=ae[Ce+0]|ae[Ce+1]<<8|ae[Ce+2]<<16;dt>Ie&&(dt=Ie),K(P.Jc[+Ge],ae,De,dt),De+=dt,Ie-=dt,Ce+=3}K(P.Jc[+Be],ae,De,Ie),ae=De<fe?0:5}if(ae!=0)return Mr(P,ae,"cannot parse partitions");for(ae=ue(De=P.m,7),Ce=ke(De)?ce(De,4):0,fe=ke(De)?ce(De,4):0,Ie=ke(De)?ce(De,4):0,Be=ke(De)?ce(De,4):0,De=ke(De)?ce(De,4):0,Ge=P.Qa,dt=0;4>dt;++dt){if(Ge.Cb){var ze=Ge.Zb[dt];Ge.Fb||(ze+=ae)}else{if(0<dt){P.pb[dt]=P.pb[0];continue}ze=ae}var Ye=P.pb[dt];Ye.Sc[0]=kt[Jr(ze+Ce,127)],Ye.Sc[1]=Kt[Jr(ze+0,127)],Ye.Eb[0]=2*kt[Jr(ze+fe,127)],Ye.Eb[1]=101581*Kt[Jr(ze+Ie,127)]>>16,8>Ye.Eb[1]&&(Ye.Eb[1]=8),Ye.Qc[0]=kt[Jr(ze+Be,117)],Ye.Qc[1]=Kt[Jr(ze+De,127)],Ye.lc=ze+De}if(!_e.Rb)return Mr(P,4,"Not a key frame.");for(ke(Ae),_e=P.Pa,ae=0;4>ae;++ae){for(Ce=0;8>Ce;++Ce)for(fe=0;3>fe;++fe)for(Ie=0;11>Ie;++Ie)Be=He(Ae,ai[ae][Ce][fe][Ie])?ue(Ae,8):al[ae][Ce][fe][Ie],_e.Wc[ae][Ce].Yb[fe][Ie]=Be;for(Ce=0;17>Ce;++Ce)_e.Xc[ae][Ce]=_e.Wc[ae][Ln[Ce]]}return P.kc=ke(Ae),P.kc&&(P.Bd=ue(Ae,8)),P.cb=1}function ir(P,q,ae,fe,Ce,Ae,_e){var Ie=q[Ce].Yb[ae];for(ae=0;16>Ce;++Ce){if(!He(P,Ie[ae+0]))return Ce;for(;!He(P,Ie[ae+1]);)if(Ie=q[++Ce].Yb[0],ae=0,Ce==16)return 16;var De=q[Ce+1].Yb;if(He(P,Ie[ae+2])){var Be=P,Ge=0;if(He(Be,(ze=Ie)[(dt=ae)+3]))if(He(Be,ze[dt+6])){for(Ie=0,dt=2*(Ge=He(Be,ze[dt+8]))+(ze=He(Be,ze[dt+9+Ge])),Ge=0,ze=Cn[dt];ze[Ie];++Ie)Ge+=Ge+He(Be,ze[Ie]);Ge+=3+(8<<dt)}else He(Be,ze[dt+7])?(Ge=7+2*He(Be,165),Ge+=He(Be,145)):Ge=5+He(Be,159);else Ge=He(Be,ze[dt+4])?3+He(Be,ze[dt+5]):2;Ie=De[2]}else Ge=1,Ie=De[1];De=_e+Bs[Ce],0>(Be=P).b&&Le(Be);var dt,ze=Be.b,Ye=(dt=Be.Ca>>1)-(Be.I>>ze)>>31;--Be.b,Be.Ca+=Ye,Be.Ca|=1,Be.I-=(dt+1&Ye)<<ze,Ae[De]=((Ge^Ye)-Ye)*fe[(0<Ce)+0]}return 16}function Bn(P){var q=P.rb[P.sb-1];q.la=0,q.Na=0,a(P.zc,0,0,P.zc.length),P.ja=0}function Ya(P,q,ae,fe,Ce){Ce=P[q+ae+32*fe]+(Ce>>3),P[q+ae+32*fe]=-256&Ce?0>Ce?0:255:Ce}function di(P,q,ae,fe,Ce,Ae){Ya(P,q,0,ae,fe+Ce),Ya(P,q,1,ae,fe+Ae),Ya(P,q,2,ae,fe-Ae),Ya(P,q,3,ae,fe-Ce)}function kr(P){return(20091*P>>16)+P}function ea(P,q,ae,fe){var Ce,Ae=0,_e=s(16);for(Ce=0;4>Ce;++Ce){var Ie=P[q+0]+P[q+8],De=P[q+0]-P[q+8],Be=(35468*P[q+4]>>16)-kr(P[q+12]),Ge=kr(P[q+4])+(35468*P[q+12]>>16);_e[Ae+0]=Ie+Ge,_e[Ae+1]=De+Be,_e[Ae+2]=De-Be,_e[Ae+3]=Ie-Ge,Ae+=4,q++}for(Ce=Ae=0;4>Ce;++Ce)Ie=(P=_e[Ae+0]+4)+_e[Ae+8],De=P-_e[Ae+8],Be=(35468*_e[Ae+4]>>16)-kr(_e[Ae+12]),Ya(ae,fe,0,0,Ie+(Ge=kr(_e[Ae+4])+(35468*_e[Ae+12]>>16))),Ya(ae,fe,1,0,De+Be),Ya(ae,fe,2,0,De-Be),Ya(ae,fe,3,0,Ie-Ge),Ae++,fe+=32}function it(P,q,ae,fe){var Ce=P[q+0]+4,Ae=35468*P[q+4]>>16,_e=kr(P[q+4]),Ie=35468*P[q+1]>>16;di(ae,fe,0,Ce+_e,P=kr(P[q+1]),Ie),di(ae,fe,1,Ce+Ae,P,Ie),di(ae,fe,2,Ce-Ae,P,Ie),di(ae,fe,3,Ce-_e,P,Ie)}function Pe(P,q,ae,fe,Ce){ea(P,q,ae,fe),Ce&&ea(P,q+16,ae,fe+4)}function Ht(P,q,ae,fe){$e(P,q+0,ae,fe,1),$e(P,q+32,ae,fe+128,1)}function ni(P,q,ae,fe){var Ce;for(P=P[q+0]+4,Ce=0;4>Ce;++Ce)for(q=0;4>q;++q)Ya(ae,fe,q,Ce,P)}function la(P,q,ae,fe){P[q+0]&&Tt(P,q+0,ae,fe),P[q+16]&&Tt(P,q+16,ae,fe+4),P[q+32]&&Tt(P,q+32,ae,fe+128),P[q+48]&&Tt(P,q+48,ae,fe+128+4)}function Ps(P,q,ae,fe){var Ce,Ae=s(16);for(Ce=0;4>Ce;++Ce){var _e=P[q+0+Ce]+P[q+12+Ce],Ie=P[q+4+Ce]+P[q+8+Ce],De=P[q+4+Ce]-P[q+8+Ce],Be=P[q+0+Ce]-P[q+12+Ce];Ae[0+Ce]=_e+Ie,Ae[8+Ce]=_e-Ie,Ae[4+Ce]=Be+De,Ae[12+Ce]=Be-De}for(Ce=0;4>Ce;++Ce)_e=(P=Ae[0+4*Ce]+3)+Ae[3+4*Ce],Ie=Ae[1+4*Ce]+Ae[2+4*Ce],De=Ae[1+4*Ce]-Ae[2+4*Ce],Be=P-Ae[3+4*Ce],ae[fe+0]=_e+Ie>>3,ae[fe+16]=Be+De>>3,ae[fe+32]=_e-Ie>>3,ae[fe+48]=Be-De>>3,fe+=64}function Qo(P,q,ae){var fe,Ce=q-32,Ae=Ls,_e=255-P[Ce-1];for(fe=0;fe<ae;++fe){var Ie,De=Ae,Be=_e+P[q-1];for(Ie=0;Ie<ae;++Ie)P[q+Ie]=De[Be+P[Ce+Ie]];q+=32}}function ya(P,q){Qo(P,q,4)}function Cr(P,q){Qo(P,q,8)}function Jn(P,q){Qo(P,q,16)}function Dl(P,q){var ae;for(ae=0;16>ae;++ae)i(P,q+32*ae,P,q-32,16)}function qc(P,q){var ae;for(ae=16;0<ae;--ae)a(P,q,P[q-1],16),q+=32}function ka(P,q,ae){var fe;for(fe=0;16>fe;++fe)a(q,ae+32*fe,P,16)}function Za(P,q){var ae,fe=16;for(ae=0;16>ae;++ae)fe+=P[q-1+32*ae]+P[q+ae-32];ka(fe>>5,P,q)}function Ao(P,q){var ae,fe=8;for(ae=0;16>ae;++ae)fe+=P[q-1+32*ae];ka(fe>>4,P,q)}function Pl(P,q){var ae,fe=8;for(ae=0;16>ae;++ae)fe+=P[q+ae-32];ka(fe>>4,P,q)}function bi(P,q){ka(128,P,q)}function qt(P,q,ae){return P+2*q+ae+2>>2}function ca(P,q){var ae,fe=q-32;for(fe=new Uint8Array([qt(P[fe-1],P[fe+0],P[fe+1]),qt(P[fe+0],P[fe+1],P[fe+2]),qt(P[fe+1],P[fe+2],P[fe+3]),qt(P[fe+2],P[fe+3],P[fe+4])]),ae=0;4>ae;++ae)i(P,q+32*ae,fe,0,fe.length)}function Zt(P,q){var ae=P[q-1],fe=P[q-1+32],Ce=P[q-1+64],Ae=P[q-1+96];Je(P,q+0,16843009*qt(P[q-1-32],ae,fe)),Je(P,q+32,16843009*qt(ae,fe,Ce)),Je(P,q+64,16843009*qt(fe,Ce,Ae)),Je(P,q+96,16843009*qt(Ce,Ae,Ae))}function ud(P,q){var ae,fe=4;for(ae=0;4>ae;++ae)fe+=P[q+ae-32]+P[q-1+32*ae];for(fe>>=3,ae=0;4>ae;++ae)a(P,q+32*ae,fe,4)}function Lr(P,q){var ae=P[q-1+0],fe=P[q-1+32],Ce=P[q-1+64],Ae=P[q-1-32],_e=P[q+0-32],Ie=P[q+1-32],De=P[q+2-32],Be=P[q+3-32];P[q+0+96]=qt(fe,Ce,P[q-1+96]),P[q+1+96]=P[q+0+64]=qt(ae,fe,Ce),P[q+2+96]=P[q+1+64]=P[q+0+32]=qt(Ae,ae,fe),P[q+3+96]=P[q+2+64]=P[q+1+32]=P[q+0+0]=qt(_e,Ae,ae),P[q+3+64]=P[q+2+32]=P[q+1+0]=qt(Ie,_e,Ae),P[q+3+32]=P[q+2+0]=qt(De,Ie,_e),P[q+3+0]=qt(Be,De,Ie)}function Tn(P,q){var ae=P[q+1-32],fe=P[q+2-32],Ce=P[q+3-32],Ae=P[q+4-32],_e=P[q+5-32],Ie=P[q+6-32],De=P[q+7-32];P[q+0+0]=qt(P[q+0-32],ae,fe),P[q+1+0]=P[q+0+32]=qt(ae,fe,Ce),P[q+2+0]=P[q+1+32]=P[q+0+64]=qt(fe,Ce,Ae),P[q+3+0]=P[q+2+32]=P[q+1+64]=P[q+0+96]=qt(Ce,Ae,_e),P[q+3+32]=P[q+2+64]=P[q+1+96]=qt(Ae,_e,Ie),P[q+3+64]=P[q+2+96]=qt(_e,Ie,De),P[q+3+96]=qt(Ie,De,De)}function gc(P,q){var ae=P[q-1+0],fe=P[q-1+32],Ce=P[q-1+64],Ae=P[q-1-32],_e=P[q+0-32],Ie=P[q+1-32],De=P[q+2-32],Be=P[q+3-32];P[q+0+0]=P[q+1+64]=Ae+_e+1>>1,P[q+1+0]=P[q+2+64]=_e+Ie+1>>1,P[q+2+0]=P[q+3+64]=Ie+De+1>>1,P[q+3+0]=De+Be+1>>1,P[q+0+96]=qt(Ce,fe,ae),P[q+0+64]=qt(fe,ae,Ae),P[q+0+32]=P[q+1+96]=qt(ae,Ae,_e),P[q+1+32]=P[q+2+96]=qt(Ae,_e,Ie),P[q+2+32]=P[q+3+96]=qt(_e,Ie,De),P[q+3+32]=qt(Ie,De,Be)}function Rs(P,q){var ae=P[q+0-32],fe=P[q+1-32],Ce=P[q+2-32],Ae=P[q+3-32],_e=P[q+4-32],Ie=P[q+5-32],De=P[q+6-32],Be=P[q+7-32];P[q+0+0]=ae+fe+1>>1,P[q+1+0]=P[q+0+64]=fe+Ce+1>>1,P[q+2+0]=P[q+1+64]=Ce+Ae+1>>1,P[q+3+0]=P[q+2+64]=Ae+_e+1>>1,P[q+0+32]=qt(ae,fe,Ce),P[q+1+32]=P[q+0+96]=qt(fe,Ce,Ae),P[q+2+32]=P[q+1+96]=qt(Ce,Ae,_e),P[q+3+32]=P[q+2+96]=qt(Ae,_e,Ie),P[q+3+64]=qt(_e,Ie,De),P[q+3+96]=qt(Ie,De,Be)}function fs(P,q){var ae=P[q-1+0],fe=P[q-1+32],Ce=P[q-1+64],Ae=P[q-1+96];P[q+0+0]=ae+fe+1>>1,P[q+2+0]=P[q+0+32]=fe+Ce+1>>1,P[q+2+32]=P[q+0+64]=Ce+Ae+1>>1,P[q+1+0]=qt(ae,fe,Ce),P[q+3+0]=P[q+1+32]=qt(fe,Ce,Ae),P[q+3+32]=P[q+1+64]=qt(Ce,Ae,Ae),P[q+3+64]=P[q+2+64]=P[q+0+96]=P[q+1+96]=P[q+2+96]=P[q+3+96]=Ae}function Xa(P,q){var ae=P[q-1+0],fe=P[q-1+32],Ce=P[q-1+64],Ae=P[q-1+96],_e=P[q-1-32],Ie=P[q+0-32],De=P[q+1-32],Be=P[q+2-32];P[q+0+0]=P[q+2+32]=ae+_e+1>>1,P[q+0+32]=P[q+2+64]=fe+ae+1>>1,P[q+0+64]=P[q+2+96]=Ce+fe+1>>1,P[q+0+96]=Ae+Ce+1>>1,P[q+3+0]=qt(Ie,De,Be),P[q+2+0]=qt(_e,Ie,De),P[q+1+0]=P[q+3+32]=qt(ae,_e,Ie),P[q+1+32]=P[q+3+64]=qt(fe,ae,_e),P[q+1+64]=P[q+3+96]=qt(Ce,fe,ae),P[q+1+96]=qt(Ae,Ce,fe)}function mi(P,q){var ae;for(ae=0;8>ae;++ae)i(P,q+32*ae,P,q-32,8)}function Ks(P,q){var ae;for(ae=0;8>ae;++ae)a(P,q,P[q-1],8),q+=32}function Ja(P,q,ae){var fe;for(fe=0;8>fe;++fe)a(q,ae+32*fe,P,8)}function Yo(P,q){var ae,fe=8;for(ae=0;8>ae;++ae)fe+=P[q+ae-32]+P[q-1+32*ae];Ja(fe>>4,P,q)}function yc(P,q){var ae,fe=4;for(ae=0;8>ae;++ae)fe+=P[q+ae-32];Ja(fe>>3,P,q)}function ki(P,q){var ae,fe=4;for(ae=0;8>ae;++ae)fe+=P[q-1+32*ae];Ja(fe>>3,P,q)}function ms(P,q){Ja(128,P,q)}function ji(P,q,ae){var fe=P[q-ae],Ce=P[q+0],Ae=3*(Ce-fe)+yl[1020+P[q-2*ae]-P[q+ae]],_e=bc[112+(Ae+4>>3)];P[q-ae]=Ls[255+fe+bc[112+(Ae+3>>3)]],P[q+0]=Ls[255+Ce-_e]}function Zo(P,q,ae,fe){var Ce=P[q+0],Ae=P[q+ae];return gs[255+P[q-2*ae]-P[q-ae]]>fe||gs[255+Ae-Ce]>fe}function mn(P,q,ae,fe){return 4*gs[255+P[q-ae]-P[q+0]]+gs[255+P[q-2*ae]-P[q+ae]]<=fe}function Gl(P,q,ae,fe,Ce){var Ae=P[q-3*ae],_e=P[q-2*ae],Ie=P[q-ae],De=P[q+0],Be=P[q+ae],Ge=P[q+2*ae],dt=P[q+3*ae];return 4*gs[255+Ie-De]+gs[255+_e-Be]>fe?0:gs[255+P[q-4*ae]-Ae]<=Ce&&gs[255+Ae-_e]<=Ce&&gs[255+_e-Ie]<=Ce&&gs[255+dt-Ge]<=Ce&&gs[255+Ge-Be]<=Ce&&gs[255+Be-De]<=Ce}function xa(P,q,ae,fe){var Ce=2*fe+1;for(fe=0;16>fe;++fe)mn(P,q+fe,ae,Ce)&&ji(P,q+fe,ae)}function ao(P,q,ae,fe){var Ce=2*fe+1;for(fe=0;16>fe;++fe)mn(P,q+fe*ae,1,Ce)&&ji(P,q+fe*ae,1)}function Kl(P,q,ae,fe){var Ce;for(Ce=3;0<Ce;--Ce)xa(P,q+=4*ae,ae,fe)}function Fn(P,q,ae,fe){var Ce;for(Ce=3;0<Ce;--Ce)ao(P,q+=4,ae,fe)}function Eo(P,q,ae,fe,Ce,Ae,_e,Ie){for(Ae=2*Ae+1;0<Ce--;){if(Gl(P,q,ae,Ae,_e))if(Zo(P,q,ae,Ie))ji(P,q,ae);else{var De=P,Be=q,Ge=ae,dt=De[Be-2*Ge],ze=De[Be-Ge],Ye=De[Be+0],at=De[Be+Ge],Et=De[Be+2*Ge],lt=27*(Ot=yl[1020+3*(Ye-ze)+yl[1020+dt-at]])+63>>7,Nt=18*Ot+63>>7,Ot=9*Ot+63>>7;De[Be-3*Ge]=Ls[255+De[Be-3*Ge]+Ot],De[Be-2*Ge]=Ls[255+dt+Nt],De[Be-Ge]=Ls[255+ze+lt],De[Be+0]=Ls[255+Ye-lt],De[Be+Ge]=Ls[255+at-Nt],De[Be+2*Ge]=Ls[255+Et-Ot]}q+=fe}}function _o(P,q,ae,fe,Ce,Ae,_e,Ie){for(Ae=2*Ae+1;0<Ce--;){if(Gl(P,q,ae,Ae,_e))if(Zo(P,q,ae,Ie))ji(P,q,ae);else{var De=P,Be=q,Ge=ae,dt=De[Be-Ge],ze=De[Be+0],Ye=De[Be+Ge],at=bc[112+(4+(Et=3*(ze-dt))>>3)],Et=bc[112+(Et+3>>3)],lt=at+1>>1;De[Be-2*Ge]=Ls[255+De[Be-2*Ge]+lt],De[Be-Ge]=Ls[255+dt+Et],De[Be+0]=Ls[255+ze-at],De[Be+Ge]=Ls[255+Ye-lt]}q+=fe}}function To(P,q,ae,fe,Ce,Ae){Eo(P,q,ae,1,16,fe,Ce,Ae)}function Rl(P,q,ae,fe,Ce,Ae){Eo(P,q,1,ae,16,fe,Ce,Ae)}function pt(P,q,ae,fe,Ce,Ae){var _e;for(_e=3;0<_e;--_e)_o(P,q+=4*ae,ae,1,16,fe,Ce,Ae)}function te(P,q,ae,fe,Ce,Ae){var _e;for(_e=3;0<_e;--_e)_o(P,q+=4,1,ae,16,fe,Ce,Ae)}function we(P,q,ae,fe,Ce,Ae,_e,Ie){Eo(P,q,Ce,1,8,Ae,_e,Ie),Eo(ae,fe,Ce,1,8,Ae,_e,Ie)}function Re(P,q,ae,fe,Ce,Ae,_e,Ie){Eo(P,q,1,Ce,8,Ae,_e,Ie),Eo(ae,fe,1,Ce,8,Ae,_e,Ie)}function We(P,q,ae,fe,Ce,Ae,_e,Ie){_o(P,q+4*Ce,Ce,1,8,Ae,_e,Ie),_o(ae,fe+4*Ce,Ce,1,8,Ae,_e,Ie)}function et(P,q,ae,fe,Ce,Ae,_e,Ie){_o(P,q+4,1,Ce,8,Ae,_e,Ie),_o(ae,fe+4,1,Ce,8,Ae,_e,Ie)}function Ct(){this.ba=new Qr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new On,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Lt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ar(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gt(){this.ua=0,this.Wa=new Wt,this.vb=new Wt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new le,this.yc=new re}function Ur(){this.xb=this.a=0,this.l=new Rn,this.ca=new Qr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new se,this.Pb=0,this.wd=new se,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gt,this.ab=0,this.gc=o(4,ar),this.Oc=0}function lr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Rn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Sn(P,q,ae,fe,Ce,Ae,_e){for(P=P==null?0:P[q+0],q=0;q<_e;++q)Ce[Ae+q]=P+ae[fe+q]&255,P=Ce[Ae+q]}function ei(P,q,ae,fe,Ce,Ae,_e){var Ie;if(P==null)Sn(null,null,ae,fe,Ce,Ae,_e);else for(Ie=0;Ie<_e;++Ie)Ce[Ae+Ie]=P[q+Ie]+ae[fe+Ie]&255}function Zr(P,q,ae,fe,Ce,Ae,_e){if(P==null)Sn(null,null,ae,fe,Ce,Ae,_e);else{var Ie,De=P[q+0],Be=De,Ge=De;for(Ie=0;Ie<_e;++Ie)Be=Ge+(De=P[q+Ie])-Be,Ge=ae[fe+Ie]+(-256&Be?0>Be?0:255:Be)&255,Be=De,Ce[Ae+Ie]=Ge}}function Xt(P,q,ae,fe){var Ce=q.width,Ae=q.o;if(r(P!=null&&q!=null),0>ae||0>=fe||ae+fe>Ae)return null;if(!P.Cc){if(P.ga==null){var _e;if(P.ga=new lr,(_e=P.ga==null)||(_e=q.width*q.o,r(P.Gb.length==0),P.Gb=s(_e),P.Uc=0,P.Gb==null?_e=0:(P.mb=P.Gb,P.nb=P.Uc,P.rc=null,_e=1),_e=!_e),!_e){_e=P.ga;var Ie=P.Fa,De=P.P,Be=P.qc,Ge=P.mb,dt=P.nb,ze=De+1,Ye=Be-1,at=_e.l;if(r(Ie!=null&&Ge!=null&&q!=null),pi[0]=null,pi[1]=Sn,pi[2]=ei,pi[3]=Zr,_e.ca=Ge,_e.tb=dt,_e.c=q.width,_e.i=q.height,r(0<_e.c&&0<_e.i),1>=Be)q=0;else if(_e.$a=3&Ie[De+0],_e.Z=Ie[De+0]>>2&3,_e.Lc=Ie[De+0]>>4&3,De=Ie[De+0]>>6&3,0>_e.$a||1<_e.$a||4<=_e.Z||1<_e.Lc||De)q=0;else if(at.put=vr,at.ac=$a,at.bc=Oa,at.ma=_e,at.width=q.width,at.height=q.height,at.Da=q.Da,at.v=q.v,at.va=q.va,at.j=q.j,at.o=q.o,_e.$a)e:{r(_e.$a==1),q=ds();t:for(;;){if(q==null){q=0;break e}if(r(_e!=null),_e.mc=q,q.c=_e.c,q.i=_e.i,q.l=_e.l,q.l.ma=_e,q.l.width=_e.c,q.l.height=_e.i,q.a=0,ye(q.m,Ie,ze,Ye),!$o(_e.c,_e.i,1,q,null)||(q.ab==1&&q.gc[0].hc==3&&Yn(q.s)?(_e.ic=1,Ie=q.c*q.i,q.Ta=null,q.Ua=0,q.V=s(Ie),q.Ba=0,q.V==null?(q.a=1,q=0):q=1):(_e.ic=0,q=Go(q,_e.c)),!q))break t;q=1;break e}_e.mc=null,q=0}else q=Ye>=_e.c*_e.i;_e=!q}if(_e)return null;P.ga.Lc!=1?P.Ga=0:fe=Ae-ae}r(P.ga!=null),r(ae+fe<=Ae);e:{if(q=(Ie=P.ga).c,Ae=Ie.l.o,Ie.$a==0){if(ze=P.rc,Ye=P.Vc,at=P.Fa,De=P.P+1+ae*q,Be=P.mb,Ge=P.nb+ae*q,r(De<=P.P+P.qc),Ie.Z!=0)for(r(pi[Ie.Z]!=null),_e=0;_e<fe;++_e)pi[Ie.Z](ze,Ye,at,De,Be,Ge,q),ze=Be,Ye=Ge,Ge+=q,De+=q;else for(_e=0;_e<fe;++_e)i(Be,Ge,at,De,q),ze=Be,Ye=Ge,Ge+=q,De+=q;P.rc=ze,P.Vc=Ye}else{if(r(Ie.mc!=null),q=ae+fe,r((_e=Ie.mc)!=null),r(q<=_e.i),_e.C>=q)q=1;else if(Ie.ic||ts(),Ie.ic){Ie=_e.V,ze=_e.Ba,Ye=_e.c;var Et=_e.i,lt=(at=1,De=_e.$/Ye,Be=_e.$%Ye,Ge=_e.m,dt=_e.s,_e.$),Nt=Ye*Et,Ot=Ye*q,Ut=dt.wc,zt=lt<Ot?Qn(dt,Be,De):null;r(lt<=Nt),r(q<=Et),r(Yn(dt));t:for(;;){for(;!Ge.h&&lt<Ot;){if(Be&Ut||(zt=Qn(dt,Be,De)),r(zt!=null),be(Ge),256>(Et=Xr(zt.G[0],zt.H[0],Ge)))Ie[ze+lt]=Et,++lt,++Be>=Ye&&(Be=0,++De<=q&&!(De%16)&&Fi(_e,De));else{if(!(280>Et)){at=0;break t}Et=ga(Et-256,Ge);var Nr,cr=Xr(zt.G[4],zt.H[4],Ge);if(be(Ge),!(lt>=(cr=Ds(Ye,cr=ga(cr,Ge)))&&Nt-lt>=Et)){at=0;break t}for(Nr=0;Nr<Et;++Nr)Ie[ze+lt+Nr]=Ie[ze+lt+Nr-cr];for(lt+=Et,Be+=Et;Be>=Ye;)Be-=Ye,++De<=q&&!(De%16)&&Fi(_e,De);lt<Ot&&Be&Ut&&(zt=Qn(dt,Be,De))}r(Ge.h==oe(Ge))}Fi(_e,De>q?q:De);break t}!at||Ge.h&&lt<Nt?(at=0,_e.a=Ge.h?5:3):_e.$=lt,q=at}else q=Ji(_e,_e.V,_e.Ba,_e.c,_e.i,q,Ga);if(!q){fe=0;break e}}ae+fe>=Ae&&(P.Cc=1),fe=1}if(!fe)return null;if(P.Cc&&((fe=P.ga)!=null&&(fe.mc=null),P.ga=null,0<P.Ga))return alert("todo:WebPDequantizeLevels"),null}return P.nb+ae*Ce}function va(P,q,ae,fe,Ce,Ae){for(;0<Ce--;){var _e,Ie=P,De=q+(ae?1:0),Be=P,Ge=q+(ae?0:3);for(_e=0;_e<fe;++_e){var dt=Be[Ge+4*_e];dt!=255&&(dt*=32897,Ie[De+4*_e+0]=Ie[De+4*_e+0]*dt>>23,Ie[De+4*_e+1]=Ie[De+4*_e+1]*dt>>23,Ie[De+4*_e+2]=Ie[De+4*_e+2]*dt>>23)}q+=Ae}}function rn(P,q,ae,fe,Ce){for(;0<fe--;){var Ae;for(Ae=0;Ae<ae;++Ae){var _e=P[q+2*Ae+0],Ie=15&(Be=P[q+2*Ae+1]),De=4369*Ie,Be=(240&Be|Be>>4)*De>>16;P[q+2*Ae+0]=(240&_e|_e>>4)*De>>16&240|(15&_e|_e<<4)*De>>16>>4&15,P[q+2*Ae+1]=240&Be|Ie}q+=Ce}}function Ei(P,q,ae,fe,Ce,Ae,_e,Ie){var De,Be,Ge=255;for(Be=0;Be<Ce;++Be){for(De=0;De<fe;++De){var dt=P[q+De];Ae[_e+4*De]=dt,Ge&=dt}q+=ae,_e+=Ie}return Ge!=255}function es(P,q,ae,fe,Ce){var Ae;for(Ae=0;Ae<Ce;++Ae)ae[fe+Ae]=P[q+Ae]>>8}function ts(){Oo=va,rl=rn,Pd=Ei,nl=es}function Da(P,q,ae){F[P]=function(fe,Ce,Ae,_e,Ie,De,Be,Ge,dt,ze,Ye,at,Et,lt,Nt,Ot,Ut){var zt,Nr=Ut-1>>1,cr=Ie[De+0]|Be[Ge+0]<<16,un=dt[ze+0]|Ye[at+0]<<16;r(fe!=null);var gr=3*cr+un+131074>>2;for(q(fe[Ce+0],255&gr,gr>>16,Et,lt),Ae!=null&&(gr=3*un+cr+131074>>2,q(Ae[_e+0],255&gr,gr>>16,Nt,Ot)),zt=1;zt<=Nr;++zt){var Wn=Ie[De+zt]|Be[Ge+zt]<<16,ta=dt[ze+zt]|Ye[at+zt]<<16,bn=cr+Wn+un+ta+524296,dr=bn+2*(Wn+un)>>3;gr=dr+cr>>1,cr=(bn=bn+2*(cr+ta)>>3)+Wn>>1,q(fe[Ce+2*zt-1],255&gr,gr>>16,Et,lt+(2*zt-1)*ae),q(fe[Ce+2*zt-0],255&cr,cr>>16,Et,lt+(2*zt-0)*ae),Ae!=null&&(gr=bn+un>>1,cr=dr+ta>>1,q(Ae[_e+2*zt-1],255&gr,gr>>16,Nt,Ot+(2*zt-1)*ae),q(Ae[_e+2*zt+0],255&cr,cr>>16,Nt,Ot+(2*zt+0)*ae)),cr=Wn,un=ta}1&Ut||(gr=3*cr+un+131074>>2,q(fe[Ce+Ut-1],255&gr,gr>>16,Et,lt+(Ut-1)*ae),Ae!=null&&(gr=3*un+cr+131074>>2,q(Ae[_e+Ut-1],255&gr,gr>>16,Nt,Ot+(Ut-1)*ae)))}}function Xo(){La[Ch]=fd,La[zs]=Bd,La[Su]=bf,La[il]=Fd,La[Md]=jc,La[hd]=Zl,La[Uc]=qd,La[Ld]=Bd,La[Cu]=Fd,La[zd]=jc,La[y]=Zl}function Pa(P){return P&-16384?0>P?0:255:P>>Im}function so(P,q){return Pa((19077*P>>8)+(26149*q>>8)-14234)}function oo(P,q,ae){return Pa((19077*P>>8)-(6419*q>>8)-(13320*ae>>8)+8708)}function Ql(P,q){return Pa((19077*P>>8)+(33050*q>>8)-17685)}function Jo(P,q,ae,fe,Ce){fe[Ce+0]=so(P,ae),fe[Ce+1]=oo(P,q,ae),fe[Ce+2]=Ql(P,q)}function wi(P,q,ae,fe,Ce){fe[Ce+0]=Ql(P,q),fe[Ce+1]=oo(P,q,ae),fe[Ce+2]=so(P,ae)}function pl(P,q,ae,fe,Ce){var Ae=oo(P,q,ae);q=Ae<<3&224|Ql(P,q)>>3,fe[Ce+0]=248&so(P,ae)|Ae>>5,fe[Ce+1]=q}function Yl(P,q,ae,fe,Ce){var Ae=240&Ql(P,q)|15;fe[Ce+0]=240&so(P,ae)|oo(P,q,ae)>>4,fe[Ce+1]=Ae}function el(P,q,ae,fe,Ce){fe[Ce+0]=255,Jo(P,q,ae,fe,Ce+1)}function gl(P,q,ae,fe,Ce){wi(P,q,ae,fe,Ce),fe[Ce+3]=255}function qn(P,q,ae,fe,Ce){Jo(P,q,ae,fe,Ce),fe[Ce+3]=255}function rs(P,q,ae){F[P]=function(fe,Ce,Ae,_e,Ie,De,Be,Ge,dt){for(var ze=Ge+(-2&dt)*ae;Ge!=ze;)q(fe[Ce+0],Ae[_e+0],Ie[De+0],Be,Ge),q(fe[Ce+1],Ae[_e+0],Ie[De+0],Be,Ge+ae),Ce+=2,++_e,++De,Ge+=2*ae;1&dt&&q(fe[Ce+0],Ae[_e+0],Ie[De+0],Be,Ge)}}function ns(P,q,ae){return ae==0?P==0?q==0?6:5:q==0?4:0:ae}function Qs(P,q,ae,fe,Ce){switch(P>>>30){case 3:$e(q,ae,fe,Ce,0);break;case 2:Xe(q,ae,fe,Ce);break;case 1:Tt(q,ae,fe,Ce)}}function qi(P,q){var ae,fe,Ce=q.M,Ae=q.Nb,_e=P.oc,Ie=P.pc+40,De=P.oc,Be=P.pc+584,Ge=P.oc,dt=P.pc+600;for(ae=0;16>ae;++ae)_e[Ie+32*ae-1]=129;for(ae=0;8>ae;++ae)De[Be+32*ae-1]=129,Ge[dt+32*ae-1]=129;for(0<Ce?_e[Ie-1-32]=De[Be-1-32]=Ge[dt-1-32]=129:(a(_e,Ie-32-1,127,21),a(De,Be-32-1,127,9),a(Ge,dt-32-1,127,9)),fe=0;fe<P.za;++fe){var ze=q.ya[q.aa+fe];if(0<fe){for(ae=-1;16>ae;++ae)i(_e,Ie+32*ae-4,_e,Ie+32*ae+12,4);for(ae=-1;8>ae;++ae)i(De,Be+32*ae-4,De,Be+32*ae+4,4),i(Ge,dt+32*ae-4,Ge,dt+32*ae+4,4)}var Ye=P.Gd,at=P.Hd+fe,Et=ze.ad,lt=ze.Hc;if(0<Ce&&(i(_e,Ie-32,Ye[at].y,0,16),i(De,Be-32,Ye[at].f,0,8),i(Ge,dt-32,Ye[at].ea,0,8)),ze.Za){var Nt=_e,Ot=Ie-32+16;for(0<Ce&&(fe>=P.za-1?a(Nt,Ot,Ye[at].y[15],4):i(Nt,Ot,Ye[at+1].y,0,4)),ae=0;4>ae;ae++)Nt[Ot+128+ae]=Nt[Ot+256+ae]=Nt[Ot+384+ae]=Nt[Ot+0+ae];for(ae=0;16>ae;++ae,lt<<=2)Nt=_e,Ot=Ie+as[ae],ha[ze.Ob[ae]](Nt,Ot),Qs(lt,Et,16*+ae,Nt,Ot)}else if(Nt=ns(fe,Ce,ze.Ob[0]),uo[Nt](_e,Ie),lt!=0)for(ae=0;16>ae;++ae,lt<<=2)Qs(lt,Et,16*+ae,_e,Ie+as[ae]);for(ae=ze.Gc,Nt=ns(fe,Ce,ze.Dd),xl[Nt](De,Be),xl[Nt](Ge,dt),lt=Et,Nt=De,Ot=Be,255&(ze=0|ae)&&(170&ze?ct(lt,256,Nt,Ot):_t(lt,256,Nt,Ot)),ze=Ge,lt=dt,255&(ae>>=8)&&(170&ae?ct(Et,320,ze,lt):_t(Et,320,ze,lt)),Ce<P.Ub-1&&(i(Ye[at].y,0,_e,Ie+480,16),i(Ye[at].f,0,De,Be+224,8),i(Ye[at].ea,0,Ge,dt+224,8)),ae=8*Ae*P.B,Ye=P.sa,at=P.ta+16*fe+16*Ae*P.R,Et=P.qa,ze=P.ra+8*fe+ae,lt=P.Ha,Nt=P.Ia+8*fe+ae,ae=0;16>ae;++ae)i(Ye,at+ae*P.R,_e,Ie+32*ae,16);for(ae=0;8>ae;++ae)i(Et,ze+ae*P.B,De,Be+32*ae,8),i(lt,Nt+ae*P.B,Ge,dt+32*ae,8)}}function ps(P,q,ae,fe,Ce,Ae,_e,Ie,De){var Be=[0],Ge=[0],dt=0,ze=De!=null?De.kd:0,Ye=De??new Lt;if(P==null||12>ae)return 7;Ye.data=P,Ye.w=q,Ye.ha=ae,q=[q],ae=[ae],Ye.gb=[Ye.gb];e:{var at=q,Et=ae,lt=Ye.gb;if(r(P!=null),r(Et!=null),r(lt!=null),lt[0]=0,12<=Et[0]&&!n(P,at[0],"RIFF")){if(n(P,at[0]+8,"WEBP")){lt=3;break e}var Nt=Pt(P,at[0]+4);if(12>Nt||4294967286<Nt){lt=3;break e}if(ze&&Nt>Et[0]-8){lt=7;break e}lt[0]=Nt,at[0]+=12,Et[0]-=12}lt=0}if(lt!=0)return lt;for(Nt=0<Ye.gb[0],ae=ae[0];;){e:{var Ot=P;Et=q,lt=ae;var Ut=Be,zt=Ge,Nr=at=[0];if((gr=dt=[dt])[0]=0,8>lt[0])lt=7;else{if(!n(Ot,Et[0],"VP8X")){if(Pt(Ot,Et[0]+4)!=10){lt=3;break e}if(18>lt[0]){lt=7;break e}var cr=Pt(Ot,Et[0]+8),un=1+vt(Ot,Et[0]+12);if(2147483648<=un*(Ot=1+vt(Ot,Et[0]+15))){lt=3;break e}Nr!=null&&(Nr[0]=cr),Ut!=null&&(Ut[0]=un),zt!=null&&(zt[0]=Ot),Et[0]+=18,lt[0]-=18,gr[0]=1}lt=0}}if(dt=dt[0],at=at[0],lt!=0)return lt;if(Et=!!(2&at),!Nt&&dt)return 3;if(Ae!=null&&(Ae[0]=!!(16&at)),_e!=null&&(_e[0]=Et),Ie!=null&&(Ie[0]=0),_e=Be[0],at=Ge[0],dt&&Et&&De==null){lt=0;break}if(4>ae){lt=7;break}if(Nt&&dt||!Nt&&!dt&&!n(P,q[0],"ALPH")){ae=[ae],Ye.na=[Ye.na],Ye.P=[Ye.P],Ye.Sa=[Ye.Sa];e:{cr=P,lt=q,Nt=ae;var gr=Ye.gb;Ut=Ye.na,zt=Ye.P,Nr=Ye.Sa,un=22,r(cr!=null),r(Nt!=null),Ot=lt[0];var Wn=Nt[0];for(r(Ut!=null),r(Nr!=null),Ut[0]=null,zt[0]=null,Nr[0]=0;;){if(lt[0]=Ot,Nt[0]=Wn,8>Wn){lt=7;break e}var ta=Pt(cr,Ot+4);if(4294967286<ta){lt=3;break e}var bn=8+ta+1&-2;if(un+=bn,0<gr&&un>gr){lt=3;break e}if(!n(cr,Ot,"VP8 ")||!n(cr,Ot,"VP8L")){lt=0;break e}if(Wn[0]<bn){lt=7;break e}n(cr,Ot,"ALPH")||(Ut[0]=cr,zt[0]=Ot+8,Nr[0]=ta),Ot+=bn,Wn-=bn}}if(ae=ae[0],Ye.na=Ye.na[0],Ye.P=Ye.P[0],Ye.Sa=Ye.Sa[0],lt!=0)break}ae=[ae],Ye.Ja=[Ye.Ja],Ye.xa=[Ye.xa];e:if(gr=P,lt=q,Nt=ae,Ut=Ye.gb[0],zt=Ye.Ja,Nr=Ye.xa,cr=lt[0],Ot=!n(gr,cr,"VP8 "),un=!n(gr,cr,"VP8L"),r(gr!=null),r(Nt!=null),r(zt!=null),r(Nr!=null),8>Nt[0])lt=7;else{if(Ot||un){if(gr=Pt(gr,cr+4),12<=Ut&&gr>Ut-12){lt=3;break e}if(ze&&gr>Nt[0]-8){lt=7;break e}zt[0]=gr,lt[0]+=8,Nt[0]-=8,Nr[0]=un}else Nr[0]=5<=Nt[0]&&gr[cr+0]==47&&!(gr[cr+4]>>5),zt[0]=Nt[0];lt=0}if(ae=ae[0],Ye.Ja=Ye.Ja[0],Ye.xa=Ye.xa[0],q=q[0],lt!=0)break;if(4294967286<Ye.Ja)return 3;if(Ie==null||Et||(Ie[0]=Ye.xa?2:1),_e=[_e],at=[at],Ye.xa){if(5>ae){lt=7;break}Ie=_e,ze=at,Et=Ae,P==null||5>ae?P=0:5<=ae&&P[q+0]==47&&!(P[q+4]>>5)?(Nt=[0],gr=[0],Ut=[0],ye(zt=new se,P,q,ae),ml(zt,Nt,gr,Ut)?(Ie!=null&&(Ie[0]=Nt[0]),ze!=null&&(ze[0]=gr[0]),Et!=null&&(Et[0]=Ut[0]),P=1):P=0):P=0}else{if(10>ae){lt=7;break}Ie=at,P==null||10>ae||!Qa(P,q+3,ae-3)?P=0:(ze=P[q+0]|P[q+1]<<8|P[q+2]<<16,Et=16383&(P[q+7]<<8|P[q+6]),P=16383&(P[q+9]<<8|P[q+8]),1&ze||3<(ze>>1&7)||!(ze>>4&1)||ze>>5>=Ye.Ja||!Et||!P?P=0:(_e&&(_e[0]=Et),Ie&&(Ie[0]=P),P=1))}if(!P||(_e=_e[0],at=at[0],dt&&(Be[0]!=_e||Ge[0]!=at)))return 3;De!=null&&(De[0]=Ye,De.offset=q-De.w,r(4294967286>q-De.w),r(De.offset==De.ha-ae));break}return lt==0||lt==7&&dt&&De==null?(Ae!=null&&(Ae[0]|=Ye.na!=null&&0<Ye.na.length),fe!=null&&(fe[0]=_e),Ce!=null&&(Ce[0]=at),0):lt}function tl(P,q,ae){var fe=q.width,Ce=q.height,Ae=0,_e=0,Ie=fe,De=Ce;if(q.Da=P!=null&&0<P.Da,q.Da&&(Ie=P.cd,De=P.bd,Ae=P.v,_e=P.j,11>ae||(Ae&=-2,_e&=-2),0>Ae||0>_e||0>=Ie||0>=De||Ae+Ie>fe||_e+De>Ce))return 0;if(q.v=Ae,q.j=_e,q.va=Ae+Ie,q.o=_e+De,q.U=Ie,q.T=De,q.da=P!=null&&0<P.da,q.da){if(!Bt(Ie,De,ae=[P.ib],Ae=[P.hb]))return 0;q.ib=ae[0],q.hb=Ae[0]}return q.ob=P!=null&&P.ob,q.Kb=P==null||!P.Sd,q.da&&(q.ob=q.ib<3*fe/4&&q.hb<3*Ce/4,q.Kb=0),1}function Ml(P){if(P==null)return 2;if(11>P.S){var q=P.f.RGBA;q.fb+=(P.height-1)*q.A,q.A=-q.A}else q=P.f.kb,P=P.height,q.O+=(P-1)*q.fa,q.fa=-q.fa,q.N+=(P-1>>1)*q.Ab,q.Ab=-q.Ab,q.W+=(P-1>>1)*q.Db,q.Db=-q.Db,q.F!=null&&(q.J+=(P-1)*q.lb,q.lb=-q.lb);return 0}function lo(P,q,ae,fe){if(fe==null||0>=P||0>=q)return 2;if(ae!=null){if(ae.Da){var Ce=ae.cd,Ae=ae.bd,_e=-2&ae.v,Ie=-2&ae.j;if(0>_e||0>Ie||0>=Ce||0>=Ae||_e+Ce>P||Ie+Ae>q)return 2;P=Ce,q=Ae}if(ae.da){if(!Bt(P,q,Ce=[ae.ib],Ae=[ae.hb]))return 2;P=Ce[0],q=Ae[0]}}fe.width=P,fe.height=q;e:{var De=fe.width,Be=fe.height;if(P=fe.S,0>=De||0>=Be||!(P>=Ch&&13>P))P=2;else{if(0>=fe.Rd&&fe.sd==null){_e=Ae=Ce=q=0;var Ge=(Ie=De*km[P])*Be;if(11>P||(Ae=(Be+1)/2*(q=(De+1)/2),P==12&&(_e=(Ce=De)*Be)),(Be=s(Ge+2*Ae+_e))==null){P=1;break e}fe.sd=Be,11>P?((De=fe.f.RGBA).eb=Be,De.fb=0,De.A=Ie,De.size=Ge):((De=fe.f.kb).y=Be,De.O=0,De.fa=Ie,De.Fd=Ge,De.f=Be,De.N=0+Ge,De.Ab=q,De.Cd=Ae,De.ea=Be,De.W=0+Ge+Ae,De.Db=q,De.Ed=Ae,P==12&&(De.F=Be,De.J=0+Ge+2*Ae),De.Tc=_e,De.lb=Ce)}if(q=1,Ce=fe.S,Ae=fe.width,_e=fe.height,Ce>=Ch&&13>Ce)if(11>Ce)P=fe.f.RGBA,q&=(Ie=Math.abs(P.A))*(_e-1)+Ae<=P.size,q&=Ie>=Ae*km[Ce],q&=P.eb!=null;else{P=fe.f.kb,Ie=(Ae+1)/2,Ge=(_e+1)/2,De=Math.abs(P.fa),Be=Math.abs(P.Ab);var dt=Math.abs(P.Db),ze=Math.abs(P.lb),Ye=ze*(_e-1)+Ae;q&=De*(_e-1)+Ae<=P.Fd,q&=Be*(Ge-1)+Ie<=P.Cd,q=(q&=dt*(Ge-1)+Ie<=P.Ed)&De>=Ae&Be>=Ie&dt>=Ie,q&=P.y!=null,q&=P.f!=null,q&=P.ea!=null,Ce==12&&(q&=ze>=Ae,q&=Ye<=P.Tc,q&=P.F!=null)}else q=0;P=q?0:2}}return P!=0||ae!=null&&ae.fd&&(P=Ml(fe)),P}var da=64,Ys=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],_i=24,is=32,ln=8,Zs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];St("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(P){return P},F.Predictor2=function(P,q,ae){return q[ae+0]},F.Predictor3=function(P,q,ae){return q[ae+1]},F.Predictor4=function(P,q,ae){return q[ae-1]},F.Predictor5=function(P,q,ae){return hr(hr(P,q[ae+1]),q[ae+0])},F.Predictor6=function(P,q,ae){return hr(P,q[ae-1])},F.Predictor7=function(P,q,ae){return hr(P,q[ae+0])},F.Predictor8=function(P,q,ae){return hr(q[ae-1],q[ae+0])},F.Predictor9=function(P,q,ae){return hr(q[ae+0],q[ae+1])},F.Predictor10=function(P,q,ae){return hr(hr(P,q[ae-1]),hr(q[ae+0],q[ae+1]))},F.Predictor11=function(P,q,ae){var fe=q[ae+0];return 0>=Or(fe>>24&255,P>>24&255,(q=q[ae-1])>>24&255)+Or(fe>>16&255,P>>16&255,q>>16&255)+Or(fe>>8&255,P>>8&255,q>>8&255)+Or(255&fe,255&P,255&q)?fe:P},F.Predictor12=function(P,q,ae){var fe=q[ae+0];return(zr((P>>24&255)+(fe>>24&255)-((q=q[ae-1])>>24&255))<<24|zr((P>>16&255)+(fe>>16&255)-(q>>16&255))<<16|zr((P>>8&255)+(fe>>8&255)-(q>>8&255))<<8|zr((255&P)+(255&fe)-(255&q)))>>>0},F.Predictor13=function(P,q,ae){var fe=q[ae-1];return(yn((P=hr(P,q[ae+0]))>>24&255,fe>>24&255)<<24|yn(P>>16&255,fe>>16&255)<<16|yn(P>>8&255,fe>>8&255)<<8|yn(255&P,255&fe))>>>0};var je=F.PredictorAdd0;F.PredictorAdd1=xn,St("Predictor2","PredictorAdd2"),St("Predictor3","PredictorAdd3"),St("Predictor4","PredictorAdd4"),St("Predictor5","PredictorAdd5"),St("Predictor6","PredictorAdd6"),St("Predictor7","PredictorAdd7"),St("Predictor8","PredictorAdd8"),St("Predictor9","PredictorAdd9"),St("Predictor10","PredictorAdd10"),St("Predictor11","PredictorAdd11"),St("Predictor12","PredictorAdd12"),St("Predictor13","PredictorAdd13");var h=F.PredictorAdd2;fr("ColorIndexInverseTransform","MapARGB","32b",function(P){return P>>8&255},function(P){return P}),fr("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(P){return P},function(P){return P>>8&255});var g,b=F.ColorIndexInverseTransform,S=F.MapARGB,N=F.VP8LColorIndexInverseTransformAlpha,I=F.MapAlpha,R=F.VP8LPredictorsAdd=[];R.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var H,ne,he,ve,Ne,Me,qe,$e,Xe,ct,Tt,_t,At,Tr,qr,Mn,ua,Ra,Un,Ma,Ms,xc,Io,ju,Oo,rl,Pd,nl,co=s(511),wu=s(2041),Rd=s(225),vc=s(767),Sh=0,yl=wu,bc=Rd,Ls=vc,gs=co,Ch=0,zs=1,Su=2,il=3,Md=4,hd=5,Uc=6,Ld=7,Cu=8,zd=9,y=10,E=[2,3,7],z=[3,3,11],ie=[280,256,256,256,40],me=[0,1,1,1,0],Ee=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Fe=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],tt=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],mt=8,kt=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Kt=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],br=null,Cn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Bs=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ba=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],al=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ii=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ai=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ln=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],uo=[],ha=[],xl=[],Wc=1,Nh=2,pi=[],La=[];Da("UpsampleRgbLinePair",Jo,3),Da("UpsampleBgrLinePair",wi,3),Da("UpsampleRgbaLinePair",qn,4),Da("UpsampleBgraLinePair",gl,4),Da("UpsampleArgbLinePair",el,4),Da("UpsampleRgba4444LinePair",Yl,2),Da("UpsampleRgb565LinePair",pl,2);var fd=F.UpsampleRgbLinePair,bf=F.UpsampleBgrLinePair,Bd=F.UpsampleRgbaLinePair,Fd=F.UpsampleBgraLinePair,jc=F.UpsampleArgbLinePair,Zl=F.UpsampleRgba4444LinePair,qd=F.UpsampleRgb565LinePair,Xl=16,Ah=1<<Xl-1,Nu=-227,Ud=482,Im=6,Wd=0,ho=s(256),Om=s(256),Ky=s(256),oj=s(256),lj=s(Ud-Nu),cj=s(Ud-Nu);rs("YuvToRgbRow",Jo,3),rs("YuvToBgrRow",wi,3),rs("YuvToRgbaRow",qn,4),rs("YuvToBgraRow",gl,4),rs("YuvToArgbRow",el,4),rs("YuvToRgba4444Row",Yl,2),rs("YuvToRgb565Row",pl,2);var as=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Eh=[0,2,8],jf=[8,7,6,4,4,2,2,2,1,1,1,1],wf=1;this.WebPDecodeRGBA=function(P,q,ae,fe,Ce){var Ae=zs,_e=new Ct,Ie=new Qr;_e.ba=Ie,Ie.S=Ae,Ie.width=[Ie.width],Ie.height=[Ie.height];var De=Ie.width,Be=Ie.height,Ge=new _r;if(Ge==null||P==null)var dt=2;else r(Ge!=null),dt=ps(P,q,ae,Ge.width,Ge.height,Ge.Pd,Ge.Qd,Ge.format,null);if(dt!=0?De=0:(De!=null&&(De[0]=Ge.width[0]),Be!=null&&(Be[0]=Ge.height[0]),De=1),De){Ie.width=Ie.width[0],Ie.height=Ie.height[0],fe!=null&&(fe[0]=Ie.width),Ce!=null&&(Ce[0]=Ie.height);e:{if(fe=new Rn,(Ce=new Lt).data=P,Ce.w=q,Ce.ha=ae,Ce.kd=1,q=[0],r(Ce!=null),((P=ps(Ce.data,Ce.w,Ce.ha,null,null,null,q,null,Ce))==0||P==7)&&q[0]&&(P=4),(q=P)==0){if(r(_e!=null),fe.data=Ce.data,fe.w=Ce.w+Ce.offset,fe.ha=Ce.ha-Ce.offset,fe.put=vr,fe.ac=$a,fe.bc=Oa,fe.ma=_e,Ce.xa){if((P=ds())==null){_e=1;break e}if((function(ze,Ye){var at=[0],Et=[0],lt=[0];t:for(;;){if(ze==null)return 0;if(Ye==null)return ze.a=2,0;if(ze.l=Ye,ze.a=0,ye(ze.m,Ye.data,Ye.w,Ye.ha),!ml(ze.m,at,Et,lt)){ze.a=3;break t}if(ze.xb=Nh,Ye.width=at[0],Ye.height=Et[0],!$o(at[0],Et[0],1,ze,null))break t;return 1}return r(ze.a!=0),0})(P,fe)){if(fe=(q=lo(fe.width,fe.height,_e.Oa,_e.ba))==0){t:{fe=P;r:for(;;){if(fe==null){fe=0;break t}if(r(fe.s.yc!=null),r(fe.s.Ya!=null),r(0<fe.s.Wb),r((ae=fe.l)!=null),r((Ce=ae.ma)!=null),fe.xb!=0){if(fe.ca=Ce.ba,fe.tb=Ce.tb,r(fe.ca!=null),!tl(Ce.Oa,ae,il)){fe.a=2;break r}if(!Go(fe,ae.width)||ae.da)break r;if((ae.da||Fr(fe.ca.S))&&ts(),11>fe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),fe.ca.f.kb.F!=null&&ts()),fe.Pb&&0<fe.s.ua&&fe.s.vb.X==null&&!Oe(fe.s.vb,fe.s.Wa.Xa)){fe.a=1;break r}fe.xb=0}if(!Ji(fe,fe.V,fe.Ba,fe.c,fe.i,ae.o,Xi))break r;Ce.Dc=fe.Ma,fe=1;break t}r(fe.a!=0),fe=0}fe=!fe}fe&&(q=P.a)}else q=P.a}else{if((P=new hs)==null){_e=1;break e}if(P.Fa=Ce.na,P.P=Ce.P,P.qc=Ce.Sa,No(P,fe)){if((q=lo(fe.width,fe.height,_e.Oa,_e.ba))==0){if(P.Aa=0,ae=_e.Oa,r((Ce=P)!=null),ae!=null){if(0<(De=0>(De=ae.Md)?0:100<De?255:255*De/100)){for(Be=Ge=0;4>Be;++Be)12>(dt=Ce.pb[Be]).lc&&(dt.ia=De*jf[0>dt.lc?0:dt.lc]>>3),Ge|=dt.ia;Ge&&(alert("todo:VP8InitRandom"),Ce.ia=1)}Ce.Ga=ae.Id,100<Ce.Ga?Ce.Ga=100:0>Ce.Ga&&(Ce.Ga=0)}(function(ze,Ye){if(ze==null)return 0;if(Ye==null)return Mr(ze,2,"NULL VP8Io parameter in VP8Decode().");if(!ze.cb&&!No(ze,Ye))return 0;if(r(ze.cb),Ye.ac==null||Ye.ac(Ye)){Ye.ob&&(ze.L=0);var at=Eh[ze.L];if(ze.L==2?(ze.yb=0,ze.zb=0):(ze.yb=Ye.v-at>>4,ze.zb=Ye.j-at>>4,0>ze.yb&&(ze.yb=0),0>ze.zb&&(ze.zb=0)),ze.Va=Ye.o+15+at>>4,ze.Hb=Ye.va+15+at>>4,ze.Hb>ze.za&&(ze.Hb=ze.za),ze.Va>ze.Ub&&(ze.Va=ze.Ub),0<ze.L){var Et=ze.ed;for(at=0;4>at;++at){var lt;if(ze.Qa.Cb){var Nt=ze.Qa.Lb[at];ze.Qa.Fb||(Nt+=Et.Tb)}else Nt=Et.Tb;for(lt=0;1>=lt;++lt){var Ot=ze.gd[at][lt],Ut=Nt;if(Et.Pc&&(Ut+=Et.vd[0],lt&&(Ut+=Et.od[0])),0<(Ut=0>Ut?0:63<Ut?63:Ut)){var zt=Ut;0<Et.wb&&(zt=4<Et.wb?zt>>2:zt>>1)>9-Et.wb&&(zt=9-Et.wb),1>zt&&(zt=1),Ot.dd=zt,Ot.tc=2*Ut+zt,Ot.ld=40<=Ut?2:15<=Ut?1:0}else Ot.tc=0;Ot.La=lt}}}at=0}else Mr(ze,6,"Frame setup failed"),at=ze.a;if(at=at==0){if(at){ze.$c=0,0<ze.Aa||(ze.Ic=wf);t:{at=ze.Ic,Et=4*(zt=ze.za);var Nr=32*zt,cr=zt+1,un=0<ze.L?zt*(0<ze.Aa?2:1):0,gr=(ze.Aa==2?2:1)*zt;if((Ot=Et+832+(lt=3*(16*at+Eh[ze.L])/2*Nr)+(Nt=ze.Fa!=null&&0<ze.Fa.length?ze.Kc.c*ze.Kc.i:0))!=Ot)at=0;else{if(Ot>ze.Vb){if(ze.Vb=0,ze.Ec=s(Ot),ze.Fc=0,ze.Ec==null){at=Mr(ze,1,"no memory during frame initialization.");break t}ze.Vb=Ot}Ot=ze.Ec,Ut=ze.Fc,ze.Ac=Ot,ze.Bc=Ut,Ut+=Et,ze.Gd=o(Nr,An),ze.Hd=0,ze.rb=o(cr+1,zn),ze.sb=1,ze.wa=un?o(un,io):null,ze.Y=0,ze.D.Nb=0,ze.D.wa=ze.wa,ze.D.Y=ze.Y,0<ze.Aa&&(ze.D.Y+=zt),r(!0),ze.oc=Ot,ze.pc=Ut,Ut+=832,ze.ya=o(gr,kl),ze.aa=0,ze.D.ya=ze.ya,ze.D.aa=ze.aa,ze.Aa==2&&(ze.D.aa+=zt),ze.R=16*zt,ze.B=8*zt,zt=(Nr=Eh[ze.L])*ze.R,Nr=Nr/2*ze.B,ze.sa=Ot,ze.ta=Ut+zt,ze.qa=ze.sa,ze.ra=ze.ta+16*at*ze.R+Nr,ze.Ha=ze.qa,ze.Ia=ze.ra+8*at*ze.B+Nr,ze.$c=0,Ut+=lt,ze.mb=Nt?Ot:null,ze.nb=Nt?Ut:null,r(Ut+Nt<=ze.Fc+ze.Vb),Bn(ze),a(ze.Ac,ze.Bc,0,Et),at=1}}if(at){if(Ye.ka=0,Ye.y=ze.sa,Ye.O=ze.ta,Ye.f=ze.qa,Ye.N=ze.ra,Ye.ea=ze.Ha,Ye.Vd=ze.Ia,Ye.fa=ze.R,Ye.Rc=ze.B,Ye.F=null,Ye.J=0,!Sh){for(at=-255;255>=at;++at)co[255+at]=0>at?-at:at;for(at=-1020;1020>=at;++at)wu[1020+at]=-128>at?-128:127<at?127:at;for(at=-112;112>=at;++at)Rd[112+at]=-16>at?-16:15<at?15:at;for(at=-255;510>=at;++at)vc[255+at]=0>at?0:255<at?255:at;Sh=1}qe=Ps,$e=Pe,ct=Ht,Tt=ni,_t=la,Xe=it,At=To,Tr=Rl,qr=we,Mn=Re,ua=pt,Ra=te,Un=We,Ma=et,Ms=xa,xc=ao,Io=Kl,ju=Fn,ha[0]=ud,ha[1]=ya,ha[2]=ca,ha[3]=Zt,ha[4]=Lr,ha[5]=gc,ha[6]=Tn,ha[7]=Rs,ha[8]=Xa,ha[9]=fs,uo[0]=Za,uo[1]=Jn,uo[2]=Dl,uo[3]=qc,uo[4]=Ao,uo[5]=Pl,uo[6]=bi,xl[0]=Yo,xl[1]=Cr,xl[2]=mi,xl[3]=Ks,xl[4]=ki,xl[5]=yc,xl[6]=ms,at=1}else at=0}at&&(at=(function(Wn,ta){for(Wn.M=0;Wn.M<Wn.Va;++Wn.M){var bn,dr=Wn.Jc[Wn.M&Wn.Xb],Jt=Wn.m,ja=Wn;for(bn=0;bn<ja.za;++bn){var en=Jt,Nn=ja,Si=Nn.Ac,Fs=Nn.Bc+4*bn,fo=Nn.zc,Ui=Nn.ya[Nn.aa+bn];if(Nn.Qa.Bb?Ui.$b=He(en,Nn.Pa.jb[0])?2+He(en,Nn.Pa.jb[2]):He(en,Nn.Pa.jb[1]):Ui.$b=0,Nn.kc&&(Ui.Ad=He(en,Nn.Bd)),Ui.Za=!He(en,145)+0,Ui.Za){var ys=Ui.Ob,ko=0;for(Nn=0;4>Nn;++Nn){var xs,Dn=fo[0+Nn];for(xs=0;4>xs;++xs){Dn=ii[Si[Fs+xs]][Dn];for(var si=ba[He(en,Dn[0])];0<si;)si=ba[2*si+He(en,Dn[si])];Dn=-si,Si[Fs+xs]=Dn}i(ys,ko,Si,Fs,4),ko+=4,fo[0+Nn]=Dn}}else Dn=He(en,156)?He(en,128)?1:3:He(en,163)?2:0,Ui.Ob[0]=Dn,a(Si,Fs,Dn,4),a(fo,0,Dn,4);Ui.Dd=He(en,142)?He(en,114)?He(en,183)?1:3:2:0}if(ja.m.Ka)return Mr(Wn,7,"Premature end-of-partition0 encountered.");for(;Wn.ja<Wn.za;++Wn.ja){if(ja=dr,en=(Jt=Wn).rb[Jt.sb-1],Si=Jt.rb[Jt.sb+Jt.ja],bn=Jt.ya[Jt.aa+Jt.ja],Fs=Jt.kc?bn.Ad:0)en.la=Si.la=0,bn.Za||(en.Na=Si.Na=0),bn.Hc=0,bn.Gc=0,bn.ia=0;else{var wa,ui;if(en=Si,Si=ja,Fs=Jt.Pa.Xc,fo=Jt.ya[Jt.aa+Jt.ja],Ui=Jt.pb[fo.$b],Nn=fo.ad,ys=0,ko=Jt.rb[Jt.sb-1],Dn=xs=0,a(Nn,ys,0,384),fo.Za)var qs=0,Sa=Fs[3];else{si=s(16);var oi=en.Na+ko.Na;if(oi=br(Si,Fs[1],oi,Ui.Eb,0,si,0),en.Na=ko.Na=(0<oi)+0,1<oi)qe(si,0,Nn,ys);else{var ss=si[0]+3>>3;for(si=0;256>si;si+=16)Nn[ys+si]=ss}qs=1,Sa=Fs[0]}var Ci=15&en.la,vs=15&ko.la;for(si=0;4>si;++si){var bs=1&vs;for(ss=ui=0;4>ss;++ss)Ci=Ci>>1|(bs=(oi=br(Si,Sa,oi=bs+(1&Ci),Ui.Sc,qs,Nn,ys))>qs)<<7,ui=ui<<2|(3<oi?3:1<oi?2:Nn[ys+0]!=0),ys+=16;Ci>>=4,vs=vs>>1|bs<<7,xs=(xs<<8|ui)>>>0}for(Sa=Ci,qs=vs>>4,wa=0;4>wa;wa+=2){for(ui=0,Ci=en.la>>4+wa,vs=ko.la>>4+wa,si=0;2>si;++si){for(bs=1&vs,ss=0;2>ss;++ss)oi=bs+(1&Ci),Ci=Ci>>1|(bs=0<(oi=br(Si,Fs[2],oi,Ui.Qc,0,Nn,ys)))<<3,ui=ui<<2|(3<oi?3:1<oi?2:Nn[ys+0]!=0),ys+=16;Ci>>=2,vs=vs>>1|bs<<5}Dn|=ui<<4*wa,Sa|=Ci<<4<<wa,qs|=(240&vs)<<wa}en.la=Sa,ko.la=qs,fo.Hc=xs,fo.Gc=Dn,fo.ia=43690&Dn?0:Ui.ia,Fs=!(xs|Dn)}if(0<Jt.L&&(Jt.wa[Jt.Y+Jt.ja]=Jt.gd[bn.$b][bn.Za],Jt.wa[Jt.Y+Jt.ja].La|=!Fs),ja.Ka)return Mr(Wn,7,"Premature end-of-file encountered.")}if(Bn(Wn),Jt=ta,ja=1,bn=(dr=Wn).D,en=0<dr.L&&dr.M>=dr.zb&&dr.M<=dr.Va,dr.Aa==0)t:{if(bn.M=dr.M,bn.uc=en,qi(dr,bn),ja=1,bn=(ui=dr.D).Nb,en=(Dn=Eh[dr.L])*dr.R,Si=Dn/2*dr.B,si=16*bn*dr.R,ss=8*bn*dr.B,Fs=dr.sa,fo=dr.ta-en+si,Ui=dr.qa,Nn=dr.ra-Si+ss,ys=dr.Ha,ko=dr.Ia-Si+ss,vs=(Ci=ui.M)==0,xs=Ci>=dr.Va-1,dr.Aa==2&&qi(dr,ui),ui.uc)for(bs=(oi=dr).D.M,r(oi.D.uc),ui=oi.yb;ui<oi.Hb;++ui){qs=ui,Sa=bs;var Di=(ti=(js=oi).D).Nb;wa=js.R;var ti=ti.wa[ti.Y+qs],Do=js.sa,za=js.ta+16*Di*wa+16*qs,Wr=ti.dd,Vr=ti.tc;if(Vr!=0)if(r(3<=Vr),js.L==1)0<qs&&xc(Do,za,wa,Vr+4),ti.La&&ju(Do,za,wa,Vr),0<Sa&&Ms(Do,za,wa,Vr+4),ti.La&&Io(Do,za,wa,Vr);else{var li=js.B,vl=js.qa,Jl=js.ra+8*Di*li+8*qs,sl=js.Ha,js=js.Ia+8*Di*li+8*qs;Di=ti.ld,0<qs&&(Tr(Do,za,wa,Vr+4,Wr,Di),Mn(vl,Jl,sl,js,li,Vr+4,Wr,Di)),ti.La&&(Ra(Do,za,wa,Vr,Wr,Di),Ma(vl,Jl,sl,js,li,Vr,Wr,Di)),0<Sa&&(At(Do,za,wa,Vr+4,Wr,Di),qr(vl,Jl,sl,js,li,Vr+4,Wr,Di)),ti.La&&(ua(Do,za,wa,Vr,Wr,Di),Un(vl,Jl,sl,js,li,Vr,Wr,Di))}}if(dr.ia&&alert("todo:DitherRow"),Jt.put!=null){if(ui=16*Ci,Ci=16*(Ci+1),vs?(Jt.y=dr.sa,Jt.O=dr.ta+si,Jt.f=dr.qa,Jt.N=dr.ra+ss,Jt.ea=dr.Ha,Jt.W=dr.Ia+ss):(ui-=Dn,Jt.y=Fs,Jt.O=fo,Jt.f=Ui,Jt.N=Nn,Jt.ea=ys,Jt.W=ko),xs||(Ci-=Dn),Ci>Jt.o&&(Ci=Jt.o),Jt.F=null,Jt.J=null,dr.Fa!=null&&0<dr.Fa.length&&ui<Ci&&(Jt.J=Xt(dr,Jt,ui,Ci-ui),Jt.F=dr.mb,Jt.F==null&&Jt.F.length==0)){ja=Mr(dr,3,"Could not decode alpha data.");break t}ui<Jt.j&&(Dn=Jt.j-ui,ui=Jt.j,r(!(1&Dn)),Jt.O+=dr.R*Dn,Jt.N+=dr.B*(Dn>>1),Jt.W+=dr.B*(Dn>>1),Jt.F!=null&&(Jt.J+=Jt.width*Dn)),ui<Ci&&(Jt.O+=Jt.v,Jt.N+=Jt.v>>1,Jt.W+=Jt.v>>1,Jt.F!=null&&(Jt.J+=Jt.v),Jt.ka=ui-Jt.j,Jt.U=Jt.va-Jt.v,Jt.T=Ci-ui,ja=Jt.put(Jt))}bn+1!=dr.Ic||xs||(i(dr.sa,dr.ta-en,Fs,fo+16*dr.R,en),i(dr.qa,dr.ra-Si,Ui,Nn+8*dr.B,Si),i(dr.Ha,dr.Ia-Si,ys,ko+8*dr.B,Si))}if(!ja)return Mr(Wn,6,"Output aborted.")}return 1})(ze,Ye)),Ye.bc!=null&&Ye.bc(Ye),at&=1}return at?(ze.cb=0,at):0})(P,fe)||(q=P.a)}}else q=P.a}q==0&&_e.Oa!=null&&_e.Oa.fd&&(q=Ml(_e.ba))}_e=q}Ae=_e!=0?null:11>Ae?Ie.f.RGBA.eb:Ie.f.kb.y}else Ae=null;return Ae};var km=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(F,Y){for(var J="",Z=0;Z<4;Z++)J+=String.fromCharCode(F[Y++]);return J}function f(F,Y){return F[Y+0]|F[Y+1]<<8}function p(F,Y){return(F[Y+0]|F[Y+1]<<8|F[Y+2]<<16)>>>0}function x(F,Y){return(F[Y+0]|F[Y+1]<<8|F[Y+2]<<16|F[Y+3]<<24)>>>0}new u;var v=[0],w=[0],C=[],A=new u,T=t,O=(function(F,Y){var J={},Z=0,re=!1,de=0,le=0;if(J.frames=[],!(function(X,se){for(var W=0;W<4;W++)if(X[se+W]!="RIFF".charCodeAt(W))return!0;return!1})(F,Y)){for(x(F,Y+=4),Y+=8;Y<F.length;){var K=d(F,Y),ue=x(F,Y+=4);Y+=4;var ce=ue+(1&ue);switch(K){case"VP8 ":case"VP8L":J.frames[Z]===void 0&&(J.frames[Z]={}),(V=J.frames[Z]).src_off=re?le:Y-8,V.src_size=de+ue+8,Z++,re&&(re=!1,de=0,le=0);break;case"VP8X":(V=J.header={}).feature_flags=F[Y];var ye=Y+4;V.canvas_width=1+p(F,ye),ye+=3,V.canvas_height=1+p(F,ye),ye+=3;break;case"ALPH":re=!0,de=ce+8,le=Y-8;break;case"ANIM":(V=J.header).bgcolor=x(F,Y),ye=Y+4,V.loop_count=f(F,ye),ye+=2;break;case"ANMF":var Se,V;(V=J.frames[Z]={}).offset_x=2*p(F,Y),Y+=3,V.offset_y=2*p(F,Y),Y+=3,V.width=1+p(F,Y),Y+=3,V.height=1+p(F,Y),Y+=3,V.duration=p(F,Y),Y+=3,Se=F[Y++],V.dispose=1&Se,V.blend=Se>>1&1}K!="ANMF"&&(Y+=ce)}return J}})(T,0);O.response=T,O.rgbaoutput=!0,O.dataurl=!1;var D=O.header?O.header:null,M=O.frames?O.frames:null;if(D){D.loop_counter=D.loop_count,v=[D.canvas_height],w=[D.canvas_width];for(var Q=0;Q<M.length&&M[Q].blend!=0;Q++);}var U=M[0],$=A.WebPDecodeRGBA(T,U.src_off,U.src_size,w,v);U.rgba=$,U.imgwidth=w[0],U.imgheight=v[0];for(var ee=0;ee<w[0]*v[0]*4;ee++)C[ee]=$[ee];return this.width=w,this.height=v,this.data=C,this}function kCe(){var t,r=this.internal.__metadata__.metadata,n=unescape(encodeURIComponent(r));t=this.internal.__metadata__.rawXml?n:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+t.length+" >>"),this.internal.write("stream"),this.internal.write(t),this.internal.write("endstream"),this.internal.write("endobj")}function DCe(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(t){var r,n,i,a,s,o,l,u,d,f=function(X){return X=X||{},this.isStrokeTransparent=X.isStrokeTransparent||!1,this.strokeOpacity=X.strokeOpacity||1,this.strokeStyle=X.strokeStyle||"#000000",this.fillStyle=X.fillStyle||"#000000",this.isFillTransparent=X.isFillTransparent||!1,this.fillOpacity=X.fillOpacity||1,this.font=X.font||"10px sans-serif",this.textBaseline=X.textBaseline||"alphabetic",this.textAlign=X.textAlign||"left",this.lineWidth=X.lineWidth||1,this.lineJoin=X.lineJoin||"miter",this.lineCap=X.lineCap||"butt",this.path=X.path||[],this.transform=X.transform!==void 0?X.transform.clone():new u,this.globalCompositeOperation=X.globalCompositeOperation||"normal",this.globalAlpha=X.globalAlpha||1,this.clip_path=X.clip_path||[],this.currentPoint=X.currentPoint||new o,this.miterLimit=X.miterLimit||10,this.lastPoint=X.lastPoint||new o,this.lineDashOffset=X.lineDashOffset||0,this.lineDash=X.lineDash||[],this.margin=X.margin||[0,0,0,0],this.prevPageLastElemOffset=X.prevPageLastElemOffset||0,this.ignoreClearRect=typeof X.ignoreClearRect!="boolean"||X.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),r=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,u=this.internal.Matrix,d=new f}]);var p=function(X){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var se=X;Object.defineProperty(this,"pdf",{get:function(){return se}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(Oe){W=!!Oe}});var oe=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return oe},set:function(Oe){oe=!!Oe}});var ge=0;Object.defineProperty(this,"posX",{get:function(){return ge},set:function(Oe){isNaN(Oe)||(ge=Oe)}});var be=0;Object.defineProperty(this,"posY",{get:function(){return be},set:function(Oe){isNaN(Oe)||(be=Oe)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Oe){var st;typeof Oe=="number"?st=[Oe,Oe,Oe,Oe]:((st=new Array(4))[0]=Oe[0],st[1]=Oe.length>=2?Oe[1]:st[0],st[2]=Oe.length>=3?Oe[2]:st[0],st[3]=Oe.length>=4?Oe[3]:st[1]),d.margin=st}});var Le=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Le},set:function(Oe){Le=Oe}});var ke=0;Object.defineProperty(this,"lastBreak",{get:function(){return ke},set:function(Oe){ke=Oe}});var He=[];Object.defineProperty(this,"pageBreaks",{get:function(){return He},set:function(Oe){He=Oe}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Oe){Oe instanceof f&&(d=Oe)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Oe){d.path=Oe}});var Je=[];Object.defineProperty(this,"ctxStack",{get:function(){return Je},set:function(Oe){Je=Oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Oe){var st;st=x(Oe),this.ctx.fillStyle=st.style,this.ctx.isFillTransparent=st.a===0,this.ctx.fillOpacity=st.a,this.pdf.setFillColor(st.r,st.g,st.b,{a:st.a}),this.pdf.setTextColor(st.r,st.g,st.b,{a:st.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Oe){var st=x(Oe);this.ctx.strokeStyle=st.style,this.ctx.isStrokeTransparent=st.a===0,this.ctx.strokeOpacity=st.a,st.a===0?this.pdf.setDrawColor(255,255,255):(st.a,this.pdf.setDrawColor(st.r,st.g,st.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Oe){["butt","round","square"].indexOf(Oe)!==-1&&(this.ctx.lineCap=Oe,this.pdf.setLineCap(Oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Oe){isNaN(Oe)||(this.ctx.lineWidth=Oe,this.pdf.setLineWidth(Oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Oe){["bevel","round","miter"].indexOf(Oe)!==-1&&(this.ctx.lineJoin=Oe,this.pdf.setLineJoin(Oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Oe){isNaN(Oe)||(this.ctx.miterLimit=Oe,this.pdf.setMiterLimit(Oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Oe){this.ctx.textBaseline=Oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Oe){["right","end","center","left","start"].indexOf(Oe)!==-1&&(this.ctx.textAlign=Oe)}});var Qe=null,vt=null,Pt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Pt},set:function(Oe){Qe=null,vt=null,Pt=Oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Oe){var st;if(this.ctx.font=Oe,(st=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Oe))!==null){var Wt=st[1];st[2];var Bt=st[3],yt=st[4];st[5];var rr=st[6],St=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(yt)[2];yt=Math.floor(St==="px"?parseFloat(yt)*this.pdf.internal.scaleFactor:St==="em"?parseFloat(yt)*this.pdf.getFontSize():parseFloat(yt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(yt);var xr=(function(fr){var Yi,Er,wt=[],sr=fr.trim();if(sr==="")return hC;if(sr in U7)return[U7[sr]];for(;sr!=="";){switch(Er=null,Yi=(sr=H7(sr)).charAt(0)){case'"':case"'":Er=ACe(sr.substring(1),Yi);break;default:Er=ECe(sr)}if(Er===null||(wt.push(Er[0]),(sr=H7(Er[1]))!==""&&sr.charAt(0)!==","))return hC;sr=sr.replace(/^,/,"")}return wt})(rr);if(this.fontFaces){var hr=(function(fr,Yi){var Er=fr.getFontList(),wt=JSON.stringify(Er);if(Qe===null||vt!==wt){var sr=(function(ur){var Yt=[];return Object.keys(ur).forEach(function(Kn){ur[Kn].forEach(function(Fr){var Kr=null;switch(Fr){case"bold":Kr={family:Kn,weight:"bold"};break;case"italic":Kr={family:Kn,style:"italic"};break;case"bolditalic":Kr={family:Kn,weight:"bold",style:"italic"};break;case"":case"normal":Kr={family:Kn}}Kr!==null&&(Kr.ref={name:Kn,style:Fr},Yt.push(Kr))})}),Yt})(Er);Qe=(function(ur){for(var Yt={},Kn=0;Kn<ur.length;++Kn){var Fr=uC(ur[Kn]),Kr=Fr.family,Sr=Fr.stretch,Qr=Fr.style,_r=Fr.weight;Yt[Kr]=Yt[Kr]||{},Yt[Kr][Sr]=Yt[Kr][Sr]||{},Yt[Kr][Sr][Qr]=Yt[Kr][Sr][Qr]||{},Yt[Kr][Sr][Qr][_r]=Fr}return Yt})(sr.concat(Yi)),vt=wt}return Qe})(this.pdf,this.fontFaces),zr=xr.map(function(fr){return{family:fr,stretch:"normal",weight:Bt,style:Wt}}),yn=(function(fr,Yi,Er){for(var wt=(Er=Er||{}).defaultFontFamily||"times",sr=Object.assign({},NCe,Er.genericFontFamilies||{}),ur=null,Yt=null,Kn=0;Kn<Yi.length;++Kn)if(sr[(ur=uC(Yi[Kn])).family]&&(ur.family=sr[ur.family]),fr.hasOwnProperty(ur.family)){Yt=fr[ur.family];break}if(!(Yt=Yt||fr[wt]))throw new Error("Could not find a font-family for the rule '"+W7(ur)+"' and default family '"+wt+"'.");if(Yt=(function(Fr,Kr){if(Kr[Fr])return Kr[Fr];var Sr=fA[Fr],Qr=Sr<=fA.normal?-1:1,_r=q7(Kr,iH,Sr,Qr);if(!_r)throw new Error("Could not find a matching font-stretch value for "+Fr);return _r})(ur.stretch,Yt),Yt=(function(Fr,Kr){if(Kr[Fr])return Kr[Fr];for(var Sr=nH[Fr],Qr=0;Qr<Sr.length;++Qr)if(Kr[Sr[Qr]])return Kr[Sr[Qr]];throw new Error("Could not find a matching font-style for "+Fr)})(ur.style,Yt),!(Yt=(function(Fr,Kr){if(Kr[Fr])return Kr[Fr];if(Fr===400&&Kr[500])return Kr[500];if(Fr===500&&Kr[400])return Kr[400];var Sr=CCe[Fr],Qr=q7(Kr,aH,Sr,Fr<400?-1:1);if(!Qr)throw new Error("Could not find a matching font-weight for value "+Fr);return Qr})(ur.weight,Yt)))throw new Error("Failed to resolve a font for the rule '"+W7(ur)+"'.");return Yt})(hr,zr);this.pdf.setFont(yn.ref.name,yn.ref.style)}else{var Or="";(Bt==="bold"||parseInt(Bt,10)>=700||Wt==="bold")&&(Or="bold"),Wt==="italic"&&(Or+="italic"),Or.length===0&&(Or="normal");for(var xn="",Yr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},tr=0;tr<xr.length;tr++){if(this.pdf.internal.getFont(xr[tr],Or,{noFallback:!0,disableWarning:!0})!==void 0){xn=xr[tr];break}if(Or==="bolditalic"&&this.pdf.internal.getFont(xr[tr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)xn=xr[tr],Or="bold";else if(this.pdf.internal.getFont(xr[tr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){xn=xr[tr],Or="normal";break}}if(xn===""){for(var tn=0;tn<xr.length;tn++)if(Yr[xr[tn]]){xn=Yr[xr[tn]];break}}xn=xn===""?"Times":xn,this.pdf.setFont(xn,Or)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Oe){this.ctx.globalCompositeOperation=Oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Oe){this.ctx.globalAlpha=Oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Oe){this.ctx.lineDashOffset=Oe,V.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Oe){this.ctx.lineDash=Oe,V.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Oe){this.ctx.ignoreClearRect=!!Oe}})};p.prototype.setLineDash=function(X){this.lineDash=X},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){M.call(this,"fill",!1)},p.prototype.stroke=function(){M.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(X,se){if(isNaN(X)||isNaN(se))throw na.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new o(X,se));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new o(X,se)},p.prototype.closePath=function(){var X=new o(0,0),se=0;for(se=this.path.length-1;se!==-1;se--)if(this.path[se].type==="begin"&&zi(this.path[se+1])==="object"&&typeof this.path[se+1].x=="number"){X=new o(this.path[se+1].x,this.path[se+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(X.x,X.y)},p.prototype.lineTo=function(X,se){if(isNaN(X)||isNaN(se))throw na.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new o(X,se));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},p.prototype.quadraticCurveTo=function(X,se,W,oe){if(isNaN(W)||isNaN(oe)||isNaN(X)||isNaN(se))throw na.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ge=this.ctx.transform.applyToPoint(new o(W,oe)),be=this.ctx.transform.applyToPoint(new o(X,se));this.path.push({type:"qct",x1:be.x,y1:be.y,x:ge.x,y:ge.y}),this.ctx.lastPoint=new o(ge.x,ge.y)},p.prototype.bezierCurveTo=function(X,se,W,oe,ge,be){if(isNaN(ge)||isNaN(be)||isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe))throw na.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Le=this.ctx.transform.applyToPoint(new o(ge,be)),ke=this.ctx.transform.applyToPoint(new o(X,se)),He=this.ctx.transform.applyToPoint(new o(W,oe));this.path.push({type:"bct",x1:ke.x,y1:ke.y,x2:He.x,y2:He.y,x:Le.x,y:Le.y}),this.ctx.lastPoint=new o(Le.x,Le.y)},p.prototype.arc=function(X,se,W,oe,ge,be){if(isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe)||isNaN(ge))throw na.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(be=!!be,!this.ctx.transform.isIdentity){var Le=this.ctx.transform.applyToPoint(new o(X,se));X=Le.x,se=Le.y;var ke=this.ctx.transform.applyToPoint(new o(0,W)),He=this.ctx.transform.applyToPoint(new o(0,0));W=Math.sqrt(Math.pow(ke.x-He.x,2)+Math.pow(ke.y-He.y,2))}Math.abs(ge-oe)>=2*Math.PI&&(oe=0,ge=2*Math.PI),this.path.push({type:"arc",x:X,y:se,radius:W,startAngle:oe,endAngle:ge,counterclockwise:be})},p.prototype.arcTo=function(X,se,W,oe,ge){throw new Error("arcTo not implemented.")},p.prototype.rect=function(X,se,W,oe){if(isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe))throw na.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(X,se),this.lineTo(X+W,se),this.lineTo(X+W,se+oe),this.lineTo(X,se+oe),this.lineTo(X,se),this.lineTo(X+W,se),this.lineTo(X,se)},p.prototype.fillRect=function(X,se,W,oe){if(isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe))throw na.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!v.call(this)){var ge={};this.lineCap!=="butt"&&(ge.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ge.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(X,se,W,oe),this.fill(),ge.hasOwnProperty("lineCap")&&(this.lineCap=ge.lineCap),ge.hasOwnProperty("lineJoin")&&(this.lineJoin=ge.lineJoin)}},p.prototype.strokeRect=function(X,se,W,oe){if(isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe))throw na.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(X,se,W,oe),this.stroke())},p.prototype.clearRect=function(X,se,W,oe){if(isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe))throw na.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(X,se,W,oe))},p.prototype.save=function(X){X=typeof X!="boolean"||X;for(var se=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(se),X){this.ctx.fontSize=this.pdf.internal.getFontSize();var oe=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=oe}},p.prototype.restore=function(X){X=typeof X!="boolean"||X;for(var se=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(se),X&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(X){var se,W,oe,ge;if(X.isCanvasGradient===!0&&(X=X.getColor()),!X)return{r:0,g:0,b:0,a:0,style:X};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(X))se=0,W=0,oe=0,ge=0;else{var be=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(X);if(be!==null)se=parseInt(be[1]),W=parseInt(be[2]),oe=parseInt(be[3]),ge=1;else if((be=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(X))!==null)se=parseInt(be[1]),W=parseInt(be[2]),oe=parseInt(be[3]),ge=parseFloat(be[4]);else{if(ge=1,typeof X=="string"&&X.charAt(0)!=="#"){var Le=new YW(X);X=Le.ok?Le.toHex():"#000000"}X.length===4?(se=X.substring(1,2),se+=se,W=X.substring(2,3),W+=W,oe=X.substring(3,4),oe+=oe):(se=X.substring(1,3),W=X.substring(3,5),oe=X.substring(5,7)),se=parseInt(se,16),W=parseInt(W,16),oe=parseInt(oe,16)}}return{r:se,g:W,b:oe,a:ge,style:X}},v=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(X,se,W,oe){if(isNaN(se)||isNaN(W)||typeof X!="string")throw na.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(oe=isNaN(oe)?void 0:oe,!v.call(this)){var ge=ce(this.ctx.transform.rotation),be=this.ctx.transform.scaleX;Z.call(this,{text:X,x:se,y:W,scale:be,angle:ge,align:this.textAlign,maxWidth:oe})}},p.prototype.strokeText=function(X,se,W,oe){if(isNaN(se)||isNaN(W)||typeof X!="string")throw na.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){oe=isNaN(oe)?void 0:oe;var ge=ce(this.ctx.transform.rotation),be=this.ctx.transform.scaleX;Z.call(this,{text:X,x:se,y:W,scale:be,renderingMode:"stroke",angle:ge,align:this.textAlign,maxWidth:oe})}},p.prototype.measureText=function(X){if(typeof X!="string")throw na.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var se=this.pdf,W=this.pdf.internal.scaleFactor,oe=se.internal.getFontSize(),ge=se.getStringUnitWidth(X)*oe/se.internal.scaleFactor;return new function(be){var Le=(be=be||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Le}}),this}({width:ge*=Math.round(96*W/72*1e4)/1e4})},p.prototype.scale=function(X,se){if(isNaN(X)||isNaN(se))throw na.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new u(X,0,0,se,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},p.prototype.rotate=function(X){if(isNaN(X))throw na.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var se=new u(Math.cos(X),Math.sin(X),-Math.sin(X),Math.cos(X),0,0);this.ctx.transform=this.ctx.transform.multiply(se)},p.prototype.translate=function(X,se){if(isNaN(X)||isNaN(se))throw na.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new u(1,0,0,1,X,se);this.ctx.transform=this.ctx.transform.multiply(W)},p.prototype.transform=function(X,se,W,oe,ge,be){if(isNaN(X)||isNaN(se)||isNaN(W)||isNaN(oe)||isNaN(ge)||isNaN(be))throw na.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Le=new u(X,se,W,oe,ge,be);this.ctx.transform=this.ctx.transform.multiply(Le)},p.prototype.setTransform=function(X,se,W,oe,ge,be){X=isNaN(X)?1:X,se=isNaN(se)?0:se,W=isNaN(W)?0:W,oe=isNaN(oe)?1:oe,ge=isNaN(ge)?0:ge,be=isNaN(be)?0:be,this.ctx.transform=new u(X,se,W,oe,ge,be)};var C=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(X,se,W,oe,ge,be,Le,ke,He){var Je=this.pdf.getImageProperties(X),Qe=1,vt=1,Pt=1,Oe=1;oe!==void 0&&ke!==void 0&&(Pt=ke/oe,Oe=He/ge,Qe=Je.width/oe*ke/oe,vt=Je.height/ge*He/ge),be===void 0&&(be=se,Le=W,se=0,W=0),oe!==void 0&&ke===void 0&&(ke=oe,He=ge),oe===void 0&&ke===void 0&&(ke=Je.width,He=Je.height);var st=this.ctx.transform.decompose(),Wt=ce(st.rotate.shx),Bt=new u,yt=(Bt=(Bt=(Bt=Bt.multiply(st.translate)).multiply(st.skew)).multiply(st.scale)).applyToRectangle(new l(be-se*Pt,Le-W*Oe,oe*Qe,ge*vt));if(this.autoPaging){for(var rr,St=A.call(this,yt),xr=[],hr=0;hr<St.length;hr+=1)xr.indexOf(St[hr])===-1&&xr.push(St[hr]);D(xr);for(var zr=xr[0],yn=xr[xr.length-1],Or=zr;Or<yn+1;Or++){this.pdf.setPage(Or);var xn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Yr=Or===1?this.posY+this.margin[0]:this.margin[0],tr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],fr=Or===1?0:tr+(Or-2)*tn;if(this.ctx.clip_path.length!==0){var Yi=this.path;rr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(rr,this.posX+this.margin[3],-fr+Yr+this.ctx.prevPageLastElemOffset),Q.call(this,"fill",!0),this.path=Yi}var Er=JSON.parse(JSON.stringify(yt));Er=O([Er],this.posX+this.margin[3],-fr+Yr+this.ctx.prevPageLastElemOffset)[0];var wt=(Or>zr||Or<yn)&&C.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xn,tn,null).clip().discardPath()),this.pdf.addImage(X,"JPEG",Er.x,Er.y,Er.w,Er.h,null,null,Wt),wt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(X,"JPEG",yt.x,yt.y,yt.w,yt.h,null,null,Wt)};var A=function(X,se,W){var oe=[];se=se||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ge=this.posY+this.ctx.prevPageLastElemOffset;switch(X.type){default:case"mt":case"lt":oe.push(Math.floor((X.y+ge)/W)+1);break;case"arc":oe.push(Math.floor((X.y+ge-X.radius)/W)+1),oe.push(Math.floor((X.y+ge+X.radius)/W)+1);break;case"qct":var be=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x,X.y);oe.push(Math.floor((be.y+ge)/W)+1),oe.push(Math.floor((be.y+be.h+ge)/W)+1);break;case"bct":var Le=Se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,X.x1,X.y1,X.x2,X.y2,X.x,X.y);oe.push(Math.floor((Le.y+ge)/W)+1),oe.push(Math.floor((Le.y+Le.h+ge)/W)+1);break;case"rect":oe.push(Math.floor((X.y+ge)/W)+1),oe.push(Math.floor((X.y+X.h+ge)/W)+1)}for(var ke=0;ke<oe.length;ke+=1)for(;this.pdf.internal.getNumberOfPages()<oe[ke];)T.call(this);return oe},T=function(){var X=this.fillStyle,se=this.strokeStyle,W=this.font,oe=this.lineCap,ge=this.lineWidth,be=this.lineJoin;this.pdf.addPage(),this.fillStyle=X,this.strokeStyle=se,this.font=W,this.lineCap=oe,this.lineWidth=ge,this.lineJoin=be},O=function(X,se,W){for(var oe=0;oe<X.length;oe++)switch(X[oe].type){case"bct":X[oe].x2+=se,X[oe].y2+=W;case"qct":X[oe].x1+=se,X[oe].y1+=W;default:X[oe].x+=se,X[oe].y+=W}return X},D=function(X){return X.sort(function(se,W){return se-W})},M=function(X,se){var W=this.fillStyle,oe=this.strokeStyle,ge=this.lineCap,be=this.lineWidth,Le=Math.abs(be*this.ctx.transform.scaleX),ke=this.lineJoin;if(this.autoPaging){for(var He,Je,Qe=JSON.parse(JSON.stringify(this.path)),vt=JSON.parse(JSON.stringify(this.path)),Pt=[],Oe=0;Oe<vt.length;Oe++)if(vt[Oe].x!==void 0)for(var st=A.call(this,vt[Oe]),Wt=0;Wt<st.length;Wt+=1)Pt.indexOf(st[Wt])===-1&&Pt.push(st[Wt]);for(var Bt=0;Bt<Pt.length;Bt++)for(;this.pdf.internal.getNumberOfPages()<Pt[Bt];)T.call(this);D(Pt);for(var yt=Pt[0],rr=Pt[Pt.length-1],St=yt;St<rr+1;St++){this.pdf.setPage(St),this.fillStyle=W,this.strokeStyle=oe,this.lineCap=ge,this.lineWidth=Le,this.lineJoin=ke;var xr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],hr=St===1?this.posY+this.margin[0]:this.margin[0],zr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Or=St===1?0:zr+(St-2)*yn;if(this.ctx.clip_path.length!==0){var xn=this.path;He=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(He,this.posX+this.margin[3],-Or+hr+this.ctx.prevPageLastElemOffset),Q.call(this,X,!0),this.path=xn}if(Je=JSON.parse(JSON.stringify(Qe)),this.path=O(Je,this.posX+this.margin[3],-Or+hr+this.ctx.prevPageLastElemOffset),se===!1||St===0){var Yr=(St>yt||St<rr)&&C.call(this);Yr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xr,yn,null).clip().discardPath()),Q.call(this,X,se),Yr&&this.pdf.restoreGraphicsState()}this.lineWidth=be}this.path=Qe}else this.lineWidth=Le,Q.call(this,X,se),this.lineWidth=be},Q=function(X,se){if((X!=="stroke"||se||!w.call(this))&&(X==="stroke"||se||!v.call(this))){for(var W,oe,ge=[],be=this.path,Le=0;Le<be.length;Le++){var ke=be[Le];switch(ke.type){case"begin":ge.push({begin:!0});break;case"close":ge.push({close:!0});break;case"mt":ge.push({start:ke,deltas:[],abs:[]});break;case"lt":var He=ge.length;if(be[Le-1]&&!isNaN(be[Le-1].x)&&(W=[ke.x-be[Le-1].x,ke.y-be[Le-1].y],He>0)){for(;He>=0;He--)if(ge[He-1].close!==!0&&ge[He-1].begin!==!0){ge[He-1].deltas.push(W),ge[He-1].abs.push(ke);break}}break;case"bct":W=[ke.x1-be[Le-1].x,ke.y1-be[Le-1].y,ke.x2-be[Le-1].x,ke.y2-be[Le-1].y,ke.x-be[Le-1].x,ke.y-be[Le-1].y],ge[ge.length-1].deltas.push(W);break;case"qct":var Je=be[Le-1].x+2/3*(ke.x1-be[Le-1].x),Qe=be[Le-1].y+2/3*(ke.y1-be[Le-1].y),vt=ke.x+2/3*(ke.x1-ke.x),Pt=ke.y+2/3*(ke.y1-ke.y),Oe=ke.x,st=ke.y;W=[Je-be[Le-1].x,Qe-be[Le-1].y,vt-be[Le-1].x,Pt-be[Le-1].y,Oe-be[Le-1].x,st-be[Le-1].y],ge[ge.length-1].deltas.push(W);break;case"arc":ge.push({deltas:[],abs:[],arc:!0}),Array.isArray(ge[ge.length-1].abs)&&ge[ge.length-1].abs.push(ke)}}oe=se?null:X==="stroke"?"stroke":"fill";for(var Wt=!1,Bt=0;Bt<ge.length;Bt++)if(ge[Bt].arc)for(var yt=ge[Bt].abs,rr=0;rr<yt.length;rr++){var St=yt[rr];St.type==="arc"?ee.call(this,St.x,St.y,St.radius,St.startAngle,St.endAngle,St.counterclockwise,void 0,se,!Wt):re.call(this,St.x,St.y),Wt=!0}else if(ge[Bt].close===!0)this.pdf.internal.out("h"),Wt=!1;else if(ge[Bt].begin!==!0){var xr=ge[Bt].start.x,hr=ge[Bt].start.y;de.call(this,ge[Bt].deltas,xr,hr),Wt=!0}oe&&F.call(this,oe),se&&Y.call(this)}},U=function(X){var se=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=se*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return X-W;case"top":return X+se-W;case"hanging":return X+se-2*W;case"middle":return X+se/2-W;default:return X}},$=function(X){return X+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var X=function(){};return X.colorStops=[],X.addColorStop=function(se,W){this.colorStops.push([se,W])},X.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},X.isCanvasGradient=!0,X},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ee=function(X,se,W,oe,ge,be,Le,ke,He){for(var Je=K.call(this,W,oe,ge,be),Qe=0;Qe<Je.length;Qe++){var vt=Je[Qe];Qe===0&&(He?J.call(this,vt.x1+X,vt.y1+se):re.call(this,vt.x1+X,vt.y1+se)),le.call(this,X,se,vt.x2,vt.y2,vt.x3,vt.y3,vt.x4,vt.y4)}ke?Y.call(this):F.call(this,Le)},F=function(X){switch(X){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Y=function(){this.pdf.clip(),this.pdf.discardPath()},J=function(X,se){this.pdf.internal.out(n(X)+" "+i(se)+" m")},Z=function(X){var se;switch(X.align){case"right":case"end":se="right";break;case"center":se="center";break;default:se="left"}var W,oe,ge,be=this.pdf.getTextDimensions(X.text),Le=U.call(this,X.y),ke=$.call(this,Le)-be.h,He=this.ctx.transform.applyToPoint(new o(X.x,Le));if(this.autoPaging){var Je=this.ctx.transform.decompose(),Qe=new u;Qe=(Qe=(Qe=Qe.multiply(Je.translate)).multiply(Je.skew)).multiply(Je.scale);for(var vt=this.ctx.transform.applyToRectangle(new l(X.x,Le,be.w,be.h)),Pt=Qe.applyToRectangle(new l(X.x,ke,be.w,be.h)),Oe=A.call(this,Pt),st=[],Wt=0;Wt<Oe.length;Wt+=1)st.indexOf(Oe[Wt])===-1&&st.push(Oe[Wt]);D(st);for(var Bt=st[0],yt=st[st.length-1],rr=Bt;rr<yt+1;rr++){this.pdf.setPage(rr);var St=rr===1?this.posY+this.margin[0]:this.margin[0],xr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],hr=this.pdf.internal.pageSize.height-this.margin[2],zr=hr-this.margin[0],yn=this.pdf.internal.pageSize.width-this.margin[1],Or=yn-this.margin[3],xn=rr===1?0:xr+(rr-2)*zr;if(this.ctx.clip_path.length!==0){var Yr=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(W,this.posX+this.margin[3],-1*xn+St),Q.call(this,"fill",!0),this.path=Yr}var tr=O([JSON.parse(JSON.stringify(Pt))],this.posX+this.margin[3],-xn+St+this.ctx.prevPageLastElemOffset)[0];X.scale>=.01&&(oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(oe*X.scale),ge=this.lineWidth,this.lineWidth=ge*X.scale);var tn=this.autoPaging!=="text";if(tn||tr.y+tr.h<=hr){if(tn||tr.y>=St&&tr.x<=yn){var fr=tn?X.text:this.pdf.splitTextToSize(X.text,X.maxWidth||yn-tr.x)[0],Yi=O([JSON.parse(JSON.stringify(vt))],this.posX+this.margin[3],-xn+St+this.ctx.prevPageLastElemOffset)[0],Er=tn&&(rr>Bt||rr<yt)&&C.call(this);Er&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Or,zr,null).clip().discardPath()),this.pdf.text(fr,Yi.x,Yi.y,{angle:X.angle,align:se,renderingMode:X.renderingMode}),Er&&this.pdf.restoreGraphicsState()}}else tr.y<hr&&(this.ctx.prevPageLastElemOffset+=hr-tr.y);X.scale>=.01&&(this.pdf.setFontSize(oe),this.lineWidth=ge)}}else X.scale>=.01&&(oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(oe*X.scale),ge=this.lineWidth,this.lineWidth=ge*X.scale),this.pdf.text(X.text,He.x+this.posX,He.y+this.posY,{angle:X.angle,align:se,renderingMode:X.renderingMode,maxWidth:X.maxWidth}),X.scale>=.01&&(this.pdf.setFontSize(oe),this.lineWidth=ge)},re=function(X,se,W,oe){W=W||0,oe=oe||0,this.pdf.internal.out(n(X+W)+" "+i(se+oe)+" l")},de=function(X,se,W){return this.pdf.lines(X,se,W,null,null)},le=function(X,se,W,oe,ge,be,Le,ke){this.pdf.internal.out([r(a(W+X)),r(s(oe+se)),r(a(ge+X)),r(s(be+se)),r(a(Le+X)),r(s(ke+se)),"c"].join(" "))},K=function(X,se,W,oe){for(var ge=2*Math.PI,be=Math.PI/2;se>W;)se-=ge;var Le=Math.abs(W-se);Le<ge&&oe&&(Le=ge-Le);for(var ke=[],He=oe?-1:1,Je=se;Le>1e-5;){var Qe=Je+He*Math.min(Le,be);ke.push(ue.call(this,X,Je,Qe)),Le-=Math.abs(Qe-Je),Je=Qe}return ke},ue=function(X,se,W){var oe=(W-se)/2,ge=X*Math.cos(oe),be=X*Math.sin(oe),Le=ge,ke=-be,He=Le*Le+ke*ke,Je=He+Le*ge+ke*be,Qe=4/3*(Math.sqrt(2*He*Je)-Je)/(Le*be-ke*ge),vt=Le-Qe*ke,Pt=ke+Qe*Le,Oe=vt,st=-Pt,Wt=oe+se,Bt=Math.cos(Wt),yt=Math.sin(Wt);return{x1:X*Math.cos(se),y1:X*Math.sin(se),x2:vt*Bt-Pt*yt,y2:vt*yt+Pt*Bt,x3:Oe*Bt-st*yt,y3:Oe*yt+st*Bt,x4:X*Math.cos(W),y4:X*Math.sin(W)}},ce=function(X){return 180*X/Math.PI},ye=function(X,se,W,oe,ge,be){var Le=X+.5*(W-X),ke=se+.5*(oe-se),He=ge+.5*(W-ge),Je=be+.5*(oe-be),Qe=Math.min(X,ge,Le,He),vt=Math.max(X,ge,Le,He),Pt=Math.min(se,be,ke,Je),Oe=Math.max(se,be,ke,Je);return new l(Qe,Pt,vt-Qe,Oe-Pt)},Se=function(X,se,W,oe,ge,be,Le,ke){var He,Je,Qe,vt,Pt,Oe,st,Wt,Bt,yt,rr,St,xr,hr,zr=W-X,yn=oe-se,Or=ge-W,xn=be-oe,Yr=Le-ge,tr=ke-be;for(Je=0;Je<41;Je++)Bt=(st=(Qe=X+(He=Je/40)*zr)+He*((Pt=W+He*Or)-Qe))+He*(Pt+He*(ge+He*Yr-Pt)-st),yt=(Wt=(vt=se+He*yn)+He*((Oe=oe+He*xn)-vt))+He*(Oe+He*(be+He*tr-Oe)-Wt),Je==0?(rr=Bt,St=yt,xr=Bt,hr=yt):(rr=Math.min(rr,Bt),St=Math.min(St,yt),xr=Math.max(xr,Bt),hr=Math.max(hr,yt));return new l(Math.round(rr),Math.round(St),Math.round(xr-rr),Math.round(hr-St))},V=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var X,se,W=(X=this.ctx.lineDash,se=this.ctx.lineDashOffset,JSON.stringify({lineDash:X,lineDashOffset:se}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(Br.API),(function(t){var r=function(o){var l,u,d,f,p,x,v,w,C,A;for(u=[],d=0,f=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;f>d;d+=4)(p=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(x=(p=((p=((p=((p=(p-(A=p%85))/85)-(C=p%85))/85)-(w=p%85))/85)-(v=p%85))/85)%85,u.push(x+33,v+33,w+33,C+33,A+33)):u.push(122);return(function(T,O){for(var D=O;D>0;D--)T.pop()})(u,l.length),String.fromCharCode.apply(String,u)+"~>"},n=function(o){var l,u,d,f,p,x=String,v="length",w=255,C="charCodeAt",A="slice",T="replace";for(o[A](-2),o=o[A](0,-2)[T](/\s/g,"")[T]("z","!!!!!"),d=[],f=0,p=(o+=l="uuuuu"[A](o[v]%5||5))[v];p>f;f+=5)u=52200625*(o[C](f)-33)+614125*(o[C](f+1)-33)+7225*(o[C](f+2)-33)+85*(o[C](f+3)-33)+(o[C](f+4)-33),d.push(w&u>>24,w&u>>16,w&u>>8,w&u);return(function(O,D){for(var M=D;M>0;M--)O.pop()})(d,l[v]),x.fromCharCode.apply(x,d)},i=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var u="",d=0;d<o.length;d+=2)u+=String.fromCharCode("0x"+(o[d]+o[d+1]));return u},s=function(o){for(var l=new Uint8Array(o.length),u=o.length;u--;)l[u]=o.charCodeAt(u);return(l=sA(l)).reduce(function(d,f){return d+String.fromCharCode(f)},"")};t.processDataByFilters=function(o,l){var u=0,d=o||"",f=[];for(typeof(l=l||[])=="string"&&(l=[l]),u=0;u<l.length;u+=1)switch(l[u]){case"ASCII85Decode":case"/ASCII85Decode":d=n(d),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=r(d),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=i(d),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=s(d),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[u]+'" is not implemented')}return{data:d,reverseChain:f.reverse().join(" ")}}})(Br.API),(function(t){t.loadFile=function(r,n,i){return(function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=(function(u,d,f){var p=new XMLHttpRequest,x=0,v=function(w){var C=w.length,A=[],T=String.fromCharCode;for(x=0;x<C;x+=1)A.push(T(255&w.charCodeAt(x)));return A.join("")};if(p.open("GET",u,!d),p.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(p.onload=function(){p.status===200?f(v(this.responseText)):f(void 0)}),p.send(null),d&&p.status===200)return v(p.responseText)})(a,s,o)}catch{}return l})(r,n,i)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(Br.API),(function(t){function r(){return(hn.html2canvas?Promise.resolve(hn.html2canvas):jv(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function n(){return(hn.DOMPurify?Promise.resolve(hn.DOMPurify):jv(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var i=function(l){var u=zi(l);return u==="undefined"?"undefined":u==="string"||l instanceof String?"string":u==="number"||l instanceof Number?"number":u==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":u==="object"?"object":"unknown"},a=function(l,u){var d=document.createElement(l);for(var f in u.className&&(d.className=u.className),u.innerHTML&&u.dompurify&&(d.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)d.style[f]=u.style[f];return d},s=function l(u,d){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),p=u.firstChild;p;p=p.nextSibling)d!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(l(p,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft},!0)),f},o=function l(u){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),f=l.convert(Promise.resolve(),d);return(f=f.setProgress(1,l,1,[l])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,u){return l.__proto__=u||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,u){return this.then(function(){switch(u=u||(function(d){switch(i(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l),u){case"string":return this.then(n).then(function(d){return this.set({src:a("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(u){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,u(this.prop.container,d)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(r).then(function(u){var d=this.opt.jsPDF,f=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=f,f)for(var v=0;v<f.length;++v){var w=f[v],C=w.src.find(function(A){return A.format==="truetype"});C&&d.addFont(C.url,w.ref.name,w.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,d.context2d.save(!0),u(this.prop.container,x)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,u,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,u):this.outputPdf(l,u)},o.prototype.outputPdf=function(l,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,u)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(i(l)!=="object")return this;var u=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(l,u){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return u?u(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(i(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function u(d,f){return Math.floor(d*f/72*96)}return this.then(function(){(l=l||Br.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:u(l.inner.width,l.k),height:u(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,u,d,f){return l!=null&&(this.progress.val=l),u!=null&&(this.progress.state=u),d!=null&&(this.progress.n=d),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,u,d,f){return this.setProgress(l?this.progress.val+l:null,u||null,d?this.progress.n+d:null,f?this.progress.stack.concat(f):null)},o.prototype.then=function(l,u){var d=this;return this.thenCore(l,u,function(f,p){return d.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(x){return d.updateProgress(null,f),x}).then(f,p).then(function(x){return d.updateProgress(1),x})})},o.prototype.thenCore=function(l,u,d){d=d||Promise.prototype.then;var f=this;l&&(l=l.bind(f)),u&&(u=u.bind(f));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:o.convert(Object.assign({},f),Promise.prototype),x=d.call(p,l,u);return o.convert(x,f.__proto__)},o.prototype.thenExternal=function(l,u){return Promise.prototype.then.call(this,l,u)},o.prototype.thenList=function(l){var u=this;return l.forEach(function(d){u=u.thenCore(d)}),u},o.prototype.catch=function(l){l&&(l=l.bind(this));var u=Promise.prototype.catch.call(this,l);return o.convert(u,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Br.getPageSize=function(l,u,d){if(zi(l)==="object"){var f=l;l=f.orientation,u=f.unit||u,d=f.format||d}u=u||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var p,x=(""+d).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+u}var w,C=0,A=0;if(v.hasOwnProperty(x))C=v[x][1]/p,A=v[x][0]/p;else try{C=d[1],A=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",A>C&&(w=A,A=C,C=w);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",C>A&&(w=A,A=C,C=w)}return{width:A,height:C,unit:u,k:p,orientation:l}},t.html=function(l,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(uC):null;var d=new o(u);return u.worker?d:d.from(l).doCallback()}})(Br.API),Br.API.addJS=function(t){var r,n,i=t;return this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(r+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+i+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){r!==void 0&&n!==void 0&&this.internal.out("/Names <</JavaScript "+r+" 0 R>>")}),this},(function(t){var r;t.events.push(["postPutResources",function(){var n=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=n.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=i.exec(o);if(l!=null){var u=l[1];n.internal.newObjectDeferredBegin(u,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,f=[];for(s=0;s<d;s++){var p=n.internal.newObject();f.push(p);var x=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var v=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<f.length;s++)n.internal.write("(page_"+(s+1)+")"+f[s]+" 0 R");n.internal.write(" ] >>","endobj"),r=n.internal.newObject(),n.internal.write("<< /Dests "+v+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+r+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(i,a,s){var o={title:a,options:s,children:[]};return i==null&&(i=this.root),i.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(i){i.id=n.internal.newObjectDeferred();for(var a=0;a<i.children.length;a++)this.genIds_r(i.children[a])},n.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},n.outline.renderItems=function(i){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var o=i.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var u=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var d=0;d<i.children.length;d++)this.renderItems(i.children[d])},n.outline.line=function(i){this.ctx.val+=i+`\r
`},n.outline.makeRef=function(i){return i.id+" 0 R"},n.outline.makeString=function(i){return"("+n.internal.pdfEscape(i)+")"},n.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(i,a){for(var s=0;s<a.children.length;s++)i.count++,this.count_r(i,a.children[s]);return i.count}}])})(Br.API),(function(t){var r=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,i,a,s,o,l){var u,d=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,u=(function(p){for(var x,v=256*p.charCodeAt(4)+p.charCodeAt(5),w=p.length,C={width:0,height:0,numcomponents:1},A=4;A<w;A+=2){if(A+=v,r.indexOf(p.charCodeAt(A+1))!==-1){x=256*p.charCodeAt(A+5)+p.charCodeAt(A+6),C={width:256*p.charCodeAt(A+7)+p.charCodeAt(A+8),height:x,numcomponents:p.charCodeAt(A+9)};break}v=256*p.charCodeAt(A+2)+p.charCodeAt(A+3)}return C})(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),u.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:u.width,height:u.height,colorSpace:l,bitsPerComponent:8,filter:d,index:i,alias:a}}return f}})(Br.API),Br.API.processPNG=function(t,r,n,i){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=dCe(t,{checkCrc:!0}),o=s.width,l=s.height,u=s.channels,d=s.palette,f=s.depth;a=d&&u===1?(function(ee){for(var F=ee.width,Y=ee.height,J=ee.data,Z=ee.palette,re=ee.depth,de=!1,le=[],K=[],ue=void 0,ce=!1,ye=0,Se=0;Se<Z.length;Se++){var V=YR(Z[Se],4),X=V[0],se=V[1],W=V[2],oe=V[3];le.push(X,se,W),oe!=null&&(oe===0?(ye++,K.length<1&&K.push(Se)):oe<255&&(ce=!0))}if(ce||ye>1){de=!0,K=void 0;var ge=F*Y;ue=new Uint8Array(ge);for(var be=new DataView(J.buffer),Le=0;Le<ge;Le++){var ke=fC(be,Le,re),He=YR(Z[ke],4)[3];ue[Le]=He}}else ye===0&&(K=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:de?8:void 0,colorBytes:J,alphaBytes:ue,needSMask:de,palette:le,mask:K}})(s):u===2||u===4?(function(ee){for(var F=ee.data,Y=ee.width,J=ee.height,Z=ee.channels,re=ee.depth,de=Z===2?"DeviceGray":"DeviceRGB",le=Z-1,K=Y*J,ue=le,ce=K*ue,ye=1*K,Se=Math.ceil(ce*re/8),V=Math.ceil(ye*re/8),X=new Uint8Array(Se),se=new Uint8Array(V),W=new DataView(F.buffer),oe=new DataView(X.buffer),ge=new DataView(se.buffer),be=!1,Le=0;Le<K;Le++){for(var ke=Le*Z,He=0;He<ue;He++)J7(oe,fC(W,ke+He,re),Le*ue+He,re);var Je=fC(W,ke+ue,re);Je<(1<<re)-1&&(be=!0),J7(ge,Je,1*Le,re)}return{colorSpace:de,colorsPerPixel:le,sMaskBitsPerComponent:be?re:void 0,colorBytes:X,alphaBytes:se,needSMask:be}})(s):(function(ee){var F=ee.data,Y=ee.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Y,colorsPerPixel:Y==="DeviceGray"?1:3,colorBytes:F instanceof Uint16Array?(function(J){for(var Z=J.length,re=new Uint8Array(2*Z),de=new DataView(re.buffer,re.byteOffset,re.byteLength),le=0;le<Z;le++)de.setUint16(2*le,J[le],!1);return re})(F):F,needSMask:!1}})(s);var p,x,v,w=a,C=w.colorSpace,A=w.colorsPerPixel,T=w.sMaskBitsPerComponent,O=w.colorBytes,D=w.alphaBytes,M=w.needSMask,Q=w.palette,U=w.mask,$=null;return i!==Br.API.image_compression.NONE&&typeof sA=="function"?($=(function(ee){var F;switch(ee){case Br.API.image_compression.FAST:F=11;break;case Br.API.image_compression.MEDIUM:F=13;break;case Br.API.image_compression.SLOW:F=14;break;default:F=12}return F})(i),p=this.decode.FLATE_DECODE,x="/Predictor ".concat($," /Colors ").concat(A," /BitsPerComponent ").concat(f," /Columns ").concat(o),t=K7(O,Math.ceil(o*A*f/8),A,f,i),M&&(v=K7(D,Math.ceil(o*T/8),1,T,i))):(p=void 0,x=void 0,t=O,M&&(v=D)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(v&&this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),{alias:n,data:t,index:r,filter:p,decodeParameters:x,transparency:U,palette:Q,sMask:v,predictor:$,width:o,height:l,bitsPerComponent:f,sMaskBitsPerComponent:T,colorSpace:C}}},(function(t){t.processGIF89A=function(r,n,i,a){var s=new OCe(r),o=s.width,l=s.height,u=[];s.decodeAndBlitFrameRGBA(0,u);var d={data:u,width:o,height:l},f=new mC(100).encode(d,100);return t.processJPEG.call(this,f,n,i,a)},t.processGIF87A=t.processGIF89A})(Br.API),jd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var r=0;r<t;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:a,green:i,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},jd.prototype.parseBGR=function(){this.pos=this.offset;var t="bit"+this.bitPP,r=this.width*this.height*4;if(r>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(r);try{this[t]()}catch(n){na.log("bit decode error:"+n)}},jd.prototype.bit1=function(){var t,r=Math.ceil(this.width/8),n=r%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,a=0;a<r;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var u=this.palette[s>>7-l&1];this.data[o+4*l]=u.blue,this.data[o+4*l+1]=u.green,this.data[o+4*l+2]=u.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},jd.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),r=t%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+2*a*4,l=s>>4,u=15&s,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*a+1>=this.width)break;d=this.palette[u],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}r!==0&&(this.pos+=4-r)}},jd.prototype.bit8=function(){for(var t=this.width%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*i;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},jd.prototype.bit15=function(){for(var t=this.width%3,r=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&r)/r*255|0,l=(s>>5&r)/r*255|0,u=(s>>10&r)/r*255|0,d=s>>15?255:0,f=i*this.width*4+4*a;this.data[f]=u,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=d}this.pos+=t}},jd.prototype.bit16=function(){for(var t=this.width%3,r=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var a=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&r)/r*255|0,u=(o>>5&n)/n*255|0,d=(o>>11)/r*255|0,f=a*this.width*4+4*s;this.data[f]=d,this.data[f+1]=u,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},jd.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=i,this.data[o+3]=255}this.pos+=this.width%4}},jd.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+4*n;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=i,this.data[l+3]=o}},jd.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(r,n,i,a){var s=new jd(r,!1),o=s.width,l=s.height,u={data:s.getData(),width:o,height:l},d=new mC(100).encode(u,100);return t.processJPEG.call(this,d,n,i,a)}})(Br.API),tM.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(r,n,i,a){var s=new tM(r),o=s.width,l=s.height,u={data:s.getData(),width:o,height:l},d=new mC(100).encode(u,100);return t.processJPEG.call(this,d,n,i,a)}})(Br.API),Br.API.processRGBA=function(t,r,n){for(var i=t.data,a=i.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,u=0,d=0;d<a;d+=4){var f=i[d],p=i[d+1],x=i[d+2],v=i[d+3];s[l++]=f,s[l++]=p,s[l++]=x,o[u++]=v}var w=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:w,index:r,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Br.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},fp=Br.API,ev=fp.getCharWidthsArray=function(t,r){var n,i,a=(r=r||{}).font||this.internal.getFont(),s=r.fontSize||this.internal.getFontSize(),o=r.charSpace||this.internal.getCharSpace(),l=r.widths?r.widths:a.metadata.Unicode.widths,u=l.fof?l.fof:1,d=r.kerning?r.kerning:a.metadata.Unicode.kerning,f=d.fof?d.fof:1,p=r.doKerning!==!1,x=0,v=t.length,w=0,C=l[0]||u,A=[];for(n=0;n<v;n++)i=t.charCodeAt(n),typeof a.metadata.widthOfString=="function"?A.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(i))+o*(1e3/s)||0)/1e3):(x=p&&zi(d[i])==="object"&&!isNaN(parseInt(d[i][w],10))?d[i][w]/f:0,A.push((l[i]||C)/u+x)),w=i;return A},V7=fp.getStringUnitWidth=function(t,r){var n=(r=r||{}).fontSize||this.internal.getFontSize(),i=r.font||this.internal.getFont(),a=r.charSpace||this.internal.getCharSpace();return fp.processArabic&&(t=fp.processArabic(t)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(t,n,a)/n:ev.apply(this,arguments).reduce(function(s,o){return s+o},0)},$7=function(t,r,n,i){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+r[s]<n;)l+=r[s],s++;a.push(t.slice(0,s));var u=s;for(l=0;s!==o;)l+r[s]>i&&(a.push(t.slice(u,s)),l=0,u=s),l+=r[s],s++;return u!==s&&a.push(t.slice(u,s)),a},G7=function(t,r,n){n||(n={});var i,a,s,o,l,u,d,f=[],p=[f],x=n.textIndent||0,v=0,w=0,C=t.split(" "),A=ev.apply(this,[" ",n])[0];if(u=n.lineIndent===-1?C[0].length+2:n.lineIndent||0){var T=Array(u).join(" "),O=[];C.map(function(M){(M=M.split(/\s*\n/)).length>1?O=O.concat(M.map(function(Q,U){return(U&&Q.length?`
`:"")+Q})):O.push(M[0])}),C=O,u=V7.apply(this,[T,n])}for(s=0,o=C.length;s<o;s++){var D=0;if(i=C[s],u&&i[0]==`
`&&(i=i.substr(1),D=1),x+v+(w=(a=ev.apply(this,[i,n])).reduce(function(M,Q){return M+Q},0))>r||D){if(w>r){for(l=$7.apply(this,[i,a,r-(x+v),r]),f.push(l.shift()),f=[l.pop()];l.length;)p.push([l.shift()]);w=a.slice(i.length-(f[0]?f[0].length:0)).reduce(function(M,Q){return M+Q},0)}else f=[i];p.push(f),x=w+u,v=A}else f.push(i),x+=v+w,v=A}return d=u?function(M,Q){return(Q?T:"")+M.join(" ")}:function(M){return M.join(" ")},p.map(d)},fp.splitTextToSize=function(t,r,n){var i,a=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle),x="Unicode";return p.metadata[x]?{widths:p.metadata[x].widths||{0:1},kerning:p.metadata[x].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*r/a;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=n.lineIndent;var l,u,d=[];for(l=0,u=i.length;l<u;l++)d=d.concat(G7.apply(this,[i[l],o,s]));return d},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var r="0123456789abcdef",n="klmnopqrstuvwxyz",i={},a={},s=0;s<16;s++)i[n[s]]=r[s],a[r[s]]=n[s];var o=function(x){return"0x"+parseInt(x,10).toString(16)},l=t.__fontmetrics__.compress=function(x){var v,w,C,A,T=["{"];for(var O in x){if(v=x[O],isNaN(parseInt(O,10))?w="'"+O+"'":(O=parseInt(O,10),w=(w=o(O).slice(2)).slice(0,-1)+a[w.slice(-1)]),typeof v=="number")v<0?(C=o(v).slice(3),A="-"):(C=o(v).slice(2),A=""),C=A+C.slice(0,-1)+a[C.slice(-1)];else{if(zi(v)!=="object")throw new Error("Don't know what to do with value type "+zi(v)+".");C=l(v)}T.push(w+C)}return T.push("}"),T.join("")},u=t.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,w,C,A,T={},O=1,D=T,M=[],Q="",U="",$=x.length-1,ee=1;ee<$;ee+=1)(A=x[ee])=="'"?v?(C=v.join(""),v=void 0):v=[]:v?v.push(A):A=="{"?(M.push([D,C]),D={},C=void 0):A=="}"?((w=M.pop())[0][w[1]]=D,C=void 0,D=w[0]):A=="-"?O=-1:C===void 0?i.hasOwnProperty(A)?(Q+=i[A],C=parseInt(Q,16)*O,O=1,Q=""):Q+=A:i.hasOwnProperty(A)?(U+=i[A],D[C]=parseInt(U,16)*O,O=1,C=void 0,U=""):U+=A;return T},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},p={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(x){var v=x.font,w=p.Unicode[v.postScriptName];w&&(v.metadata.Unicode={},v.metadata.Unicode.widths=w.widths,v.metadata.Unicode.kerning=w.kerning);var C=f.Unicode[v.postScriptName];C&&(v.metadata.Unicode.encoding=C,v.encoding=C.codePages[0])}])})(Br.API),(function(t){var r=function(n){for(var i=n.length,a=new Uint8Array(i),s=0;s<i;s++)a[s]=n.charCodeAt(s);return a};t.API.events.push(["addFont",function(n){var i=void 0,a=n.font,s=n.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(i=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?r(l):r(Sv(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,i)}}])})(Br),Br.API.addSvgAsImage=function(t,r,n,i,a,s,o,l){if(isNaN(r)||isNaN(n))throw na.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(a))throw na.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=a;var d=u.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(hn.canvg?Promise.resolve(hn.canvg):jv(()=>import("./index.es-Cwzap0jS.js"),[])).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(d,t,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(f)}).then(function(){p.addImage(u.toDataURL("image/jpeg",1),r,n,i,a,o,l)})},Br.API.putTotalPages=function(t){var r,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var a=0;a<this.internal.pages[i].length;a++)this.internal.pages[i][a]=this.internal.pages[i][a].replace(r,n);return this},Br.API.viewerPreferences=function(t,r){var n;t=t||{},r=r||!1;var i,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),u=[],d=0,f=0,p=0;function x(w,C){var A,T=!1;for(A=0;A<w.length;A+=1)w[A]===C&&(T=!0);return T}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||r===!0){var v=l.length;for(p=0;p<v;p+=1)n[l[p]].value=n[l[p]].defaultValue,n[l[p]].explicitSet=!1}if(zi(t)==="object"){for(a in t)if(s=t[a],x(l,a)&&s!==void 0){if(n[a].type==="boolean"&&typeof s=="boolean")n[a].value=s;else if(n[a].type==="name"&&x(n[a].valueSet,s))n[a].value=s;else if(n[a].type==="integer"&&Number.isInteger(s))n[a].value=s;else if(n[a].type==="array"){for(d=0;d<s.length;d+=1)if(i=!0,s[d].length===1&&typeof s[d][0]=="number")u.push(String(s[d]-1));else if(s[d].length>1){for(f=0;f<s[d].length;f+=1)typeof s[d][f]!="number"&&(i=!1);i===!0&&u.push([s[d][0]-1,s[d][1]-1].join(" "))}n[a].value="["+u.join(" ")+"]"}else n[a].value=n[a].defaultValue;n[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,C=[];for(w in n)n[w].explicitSet===!0&&(n[w].type==="name"?C.push("/"+w+" /"+n[w].value):C.push("/"+w+" "+n[w].value));C.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+C.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},Br.API.addMetadata=function(t,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t,namespaceUri:r??"http://jspdf.default.namespaceuri/",rawXml:typeof r=="boolean"&&r},this.internal.events.subscribe("putCatalog",DCe),this.internal.events.subscribe("postPutResources",kCe)),this},(function(t){var r=t.API,n=r.pdfEscape16=function(s,o){for(var l,u=o.metadata.Unicode.widths,d=["","0","00","000","0000"],f=[""],p=0,x=s.length;p<x;++p){if(l=o.metadata.characterToGlyph(s.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(p),u.indexOf(l)==-1&&(u.push(l),u.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(d[4-l.length],l)}return f.join("")},i=function(s){var o,l,u,d,f,p,x;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],p=0,x=(l=Object.keys(s).sort(function(v,w){return v-w})).length;p<x;p++)o=l[p],u.length>=100&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(d=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+d+">"));return u.length&&(f+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(s){(function(o){var l=o.font,u=o.out,d=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,x=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),v="",w=0;w<x.length;w++)v+=String.fromCharCode(x[w]);var C=d();f({data:v,addLength1:!0,objectId:C}),u("endobj");var A=d();f({data:i(l.metadata.toUnicode),addLength1:!0,objectId:A}),u("endobj");var T=d();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+xp(l.fontName)),u("/FontFile2 "+C+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),u("/Flags "+l.metadata.flags),u("/StemV "+l.metadata.stemV),u("/ItalicAngle "+l.metadata.italicAngle),u("/Ascent "+l.metadata.ascender),u("/Descent "+l.metadata.decender),u("/CapHeight "+l.metadata.capHeight),u(">>"),u("endobj");var O=d();u("<<"),u("/Type /Font"),u("/BaseFont /"+xp(l.fontName)),u("/FontDescriptor "+T+" 0 R"),u("/W "+t.API.PDFObject.convert(p)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+l.encoding+")"),u(">>"),u(">>"),u("endobj"),l.objectNumber=d(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+A+" 0 R"),u("/BaseFont /"+xp(l.fontName)),u("/Encoding /"+l.encoding),u("/DescendantFonts ["+O+" 0 R]"),u(">>"),u("endobj"),l.isAlreadyPutted=!0}})(s)}]),r.events.push(["putFont",function(s){(function(o){var l=o.font,u=o.out,d=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,x="",v=0;v<p.length;v++)x+=String.fromCharCode(p[v]);var w=d();f({data:x,addLength1:!0,objectId:w}),u("endobj");var C=d();f({data:i(l.metadata.toUnicode),addLength1:!0,objectId:C}),u("endobj");var A=d();u("<<"),u("/Descent "+l.metadata.decender),u("/CapHeight "+l.metadata.capHeight),u("/StemV "+l.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+w+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),u("/FontName /"+xp(l.fontName)),u("/ItalicAngle "+l.metadata.italicAngle),u("/Ascent "+l.metadata.ascender),u(">>"),u("endobj"),l.objectNumber=d();for(var T=0;T<l.metadata.hmtx.widths.length;T++)l.metadata.hmtx.widths[T]=parseInt(l.metadata.hmtx.widths[T]*(1e3/l.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+C+" 0 R/BaseFont/"+xp(l.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),u("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",u=s.x,d=s.y,f=s.options||{},p=s.mutex||{},x=p.pdfEscape,v=p.activeFontKey,w=p.fonts,C=v,A="",T=0,O="",D=w[C].encoding;if(w[C].encoding!=="Identity-H")return{text:l,x:u,y:d,options:f,mutex:p};for(O=l,C=v,Array.isArray(l)&&(O=l[0]),T=0;T<O.length;T+=1)w[C].metadata.hasOwnProperty("cmap")&&(o=w[C].metadata.cmap.unicode.codeMap[O[T].charCodeAt(0)]),o||O[T].charCodeAt(0)<256&&w[C].metadata.hasOwnProperty("Unicode")?A+=O[T]:A+="";var M="";return parseInt(C.slice(1))<14||D==="WinAnsiEncoding"?M=x(A,C).split("").map(function(Q){return Q.charCodeAt(0).toString(16)}).join(""):D==="Identity-H"&&(M=n(A,w[C])),p.isHex=!0,{text:M,x:u,y:d,options:f,mutex:p}};r.events.push(["postProcessText",function(s){var o=s.text||"",l=[],u={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([a(Object.assign({},u,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(a(Object.assign({},u,{text:o[d]})).text);s.text=l}else s.text=a(Object.assign({},u,{text:o})).text}])})(Br),(function(t){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return r.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,i){return r.call(this),this.internal.vFS[n]=i,this},t.getFileFromVFS=function(n){return r.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}})(Br.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(i){var a,s,o,l,u,d,f,p=r,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],v=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},C={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],T=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),O=!1,D=0;this.__bidiEngine__={};var M=function(J){var Z=J.charCodeAt(),re=Z>>8,de=C[re];return de!==void 0?p[256*de+(255&Z)]:re===252||re===253?"AL":T.test(re)?"L":re===8?"R":"N"},Q=function(J){for(var Z,re=0;re<J.length;re++){if((Z=M(J.charAt(re)))==="L")return!1;if(Z==="R")return!0}return!1},U=function(J,Z,re,de){var le,K,ue,ce,ye=Z[de];switch(ye){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":O=!1;break;case"N":case"AN":break;case"EN":O&&(ye="AN");break;case"AL":O=!0,ye="R";break;case"WS":case"BN":ye="N";break;case"CS":de<1||de+1>=Z.length||(le=re[de-1])!=="EN"&&le!=="AN"||(K=Z[de+1])!=="EN"&&K!=="AN"?ye="N":O&&(K="AN"),ye=K===le?K:"N";break;case"ES":ye=(le=de>0?re[de-1]:"B")==="EN"&&de+1<Z.length&&Z[de+1]==="EN"?"EN":"N";break;case"ET":if(de>0&&re[de-1]==="EN"){ye="EN";break}if(O){ye="N";break}for(ue=de+1,ce=Z.length;ue<ce&&Z[ue]==="ET";)ue++;ye=ue<ce&&Z[ue]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(ce=Z.length,ue=de+1;ue<ce&&Z[ue]==="NSM";)ue++;if(ue<ce){var Se=J[de],V=Se>=1425&&Se<=2303||Se===64286;if(le=Z[ue],V&&(le==="R"||le==="AL")){ye="R";break}}}ye=de<1||(le=Z[de-1])==="B"?"N":re[de-1];break;case"B":O=!1,a=!0,ye=D;break;case"S":s=!0,ye="N"}return ye},$=function(J,Z,re){var de=J.split("");return re&&ee(de,re,{hiLevel:D}),de.reverse(),Z&&Z.reverse(),de.join("")},ee=function(J,Z,re){var de,le,K,ue,ce,ye=-1,Se=J.length,V=0,X=[],se=D?v:x,W=[];for(O=!1,a=!1,s=!1,le=0;le<Se;le++)W[le]=M(J[le]);for(K=0;K<Se;K++){if(ce=V,X[K]=U(J,W,X,K),de=240&(V=se[ce][w[X[K]]]),V&=15,Z[K]=ue=se[V][5],de>0)if(de===16){for(le=ye;le<K;le++)Z[le]=1;ye=-1}else ye=-1;if(se[V][6])ye===-1&&(ye=K);else if(ye>-1){for(le=ye;le<K;le++)Z[le]=ue;ye=-1}W[K]==="B"&&(Z[K]=0),re.hiLevel|=ue}s&&(function(oe,ge,be){for(var Le=0;Le<be;Le++)if(oe[Le]==="S"){ge[Le]=D;for(var ke=Le-1;ke>=0&&oe[ke]==="WS";ke--)ge[ke]=D}})(W,Z,Se)},F=function(J,Z,re,de,le){if(!(le.hiLevel<J)){if(J===1&&D===1&&!a)return Z.reverse(),void(re&&re.reverse());for(var K,ue,ce,ye,Se=Z.length,V=0;V<Se;){if(de[V]>=J){for(ce=V+1;ce<Se&&de[ce]>=J;)ce++;for(ye=V,ue=ce-1;ye<ue;ye++,ue--)K=Z[ye],Z[ye]=Z[ue],Z[ue]=K,re&&(K=re[ye],re[ye]=re[ue],re[ue]=K);V=ce}V++}}},Y=function(J,Z,re){var de=J.split(""),le={hiLevel:D};return re||(re=[]),ee(de,re,le),(function(K,ue,ce){if(ce.hiLevel!==0&&f)for(var ye,Se=0;Se<K.length;Se++)ue[Se]===1&&(ye=A.indexOf(K[Se]))>=0&&(K[Se]=A[ye+1])})(de,re,le),F(2,de,Z,re,le),F(1,de,Z,re,le),de.join("")};return this.__bidiEngine__.doBidiReorder=function(J,Z,re){if((function(le,K){if(K)for(var ue=0;ue<le.length;ue++)K[ue]=ue;l===void 0&&(l=Q(le)),d===void 0&&(d=Q(le))})(J,Z),o||!u||d)if(o&&u&&l^d)D=l?1:0,J=$(J,Z,re);else if(!o&&u&&d)D=l?1:0,J=Y(J,Z,re),J=$(J,Z);else if(!o||l||u||d){if(o&&!u&&l^d)J=$(J,Z),l?(D=0,J=Y(J,Z,re)):(D=1,J=Y(J,Z,re),J=$(J,Z));else if(o&&l&&!u&&d)D=1,J=Y(J,Z,re),J=$(J,Z);else if(!o&&!u&&l^d){var de=f;l?(D=1,J=Y(J,Z,re),D=0,f=!1,J=Y(J,Z,re),f=de):(D=0,J=Y(J,Z,re),J=$(J,Z),D=1,f=!1,J=Y(J,Z,re),f=de,J=$(J,Z))}}else D=0,J=Y(J,Z,re);else D=l?1:0,J=Y(J,Z,re);return J},this.__bidiEngine__.setOptions=function(J){J&&(o=J.isInputVisual,u=J.isOutputVisual,l=J.isInputRtl,d=J.isOutputRtl,f=J.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(i){var a=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([n.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([n.doBidiReorder(a[l])]);i.text=o}else i.text=n.doBidiReorder(a);n.setOptions({isInputVisual:!0})}])})(Br),Br.API.TTFFont=(function(){function t(r){var n;if(this.rawData=r,n=this.contents=new mf(r),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new KCe(this),this.registerTTF()}return t.open=function(r){return new t(r)},t.prototype.parse=function(){return this.directory=new PCe(this.contents),this.head=new MCe(this),this.name=new qCe(this),this.cmap=new oH(this),this.toUnicode={},this.hhea=new LCe(this),this.maxp=new UCe(this),this.hmtx=new WCe(this),this.post=new BCe(this),this.os2=new zCe(this),this.loca=new GCe(this),this.glyf=new HCe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var r,n,i,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,u,d;for(d=[],o=0,l=(u=this.bbox).length;o<l;o++)r=u[o],d.push(Math.round(r*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(i=255&(a=this.post.italic_angle),32768&(n=a>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(r){var n;return((n=this.cmap.unicode)!=null?n.codeMap[r]:void 0)||0},t.prototype.widthOfGlyph=function(r){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*n},t.prototype.widthOfString=function(r,n,i){var a,s,o,l;for(o=0,s=0,l=(r=""+r).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=r.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+i*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(r,n){var i;return n==null&&(n=!1),i=n?this.lineGap:0,(this.ascender+i-this.decender)/1e3*r},t})();var Dd,mf=(function(){function t(r){this.data=r??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(r){return this.data[this.pos++]=r},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},t.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},t.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},t.prototype.readString=function(r){var n,i;for(i=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)i[n]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(r){var n,i,a;for(a=[],n=0,i=r.length;0<=i?n<i:n>i;n=0<=i?++n:--n)a.push(this.writeByte(r.charCodeAt(n)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(r){return this.writeInt16(r)},t.prototype.readLongLong=function(){var r,n,i,a,s,o,l,u;return r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),u=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^n)+1099511627776*(255^i)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^u)+1):72057594037927940*r+281474976710656*n+1099511627776*i+4294967296*a+16777216*s+65536*o+256*l+u},t.prototype.writeLongLong=function(r){var n,i;return n=Math.floor(r/4294967296),i=4294967295&r,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(r){return this.writeInt32(r)},t.prototype.read=function(r){var n,i;for(n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push(this.readByte());return n},t.prototype.write=function(r){var n,i,a,s;for(s=[],i=0,a=r.length;i<a;i++)n=r[i],s.push(this.writeByte(n));return s},t})(),PCe=(function(){var t;function r(n){var i,a,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)i={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[i.tag]=i}return r.prototype.encode=function(n){var i,a,s,o,l,u,d,f,p,x,v,w,C;for(C in v=Object.keys(n).length,u=Math.log(2),p=16*Math.floor(Math.log(v)/u),o=Math.floor(p/u),f=16*v-p,(a=new mf).writeInt(this.scalarType),a.writeShort(v),a.writeShort(p),a.writeShort(o),a.writeShort(f),s=16*v,d=a.pos+s,l=null,w=[],n)for(x=n[C],a.writeString(C),a.writeInt(t(x)),a.writeInt(d),a.writeInt(x.length),w=w.concat(x),C==="head"&&(l=d),d+=x.length;d%4;)w.push(0),d++;return a.write(w),i=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(i),a.data},t=function(n){var i,a,s,o;for(n=lH.call(n);n.length%4;)n.push(0);for(s=new mf(n),a=0,i=0,o=n.length;i<o;i=i+=4)a+=s.readUInt32();return 4294967295&a},r})(),RCe={}.hasOwnProperty,bu=function(t,r){for(var n in r)RCe.call(r,n)&&(t[n]=r[n]);function i(){this.constructor=t}return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t};Dd=(function(){function t(r){var n;this.file=r,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var MCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new mf).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t})(),rM=(function(){function t(r,n){var i,a,s,o,l,u,d,f,p,x,v,w,C,A,T,O,D;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=n+r.readInt(),p=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=r.readByte();break;case 4:for(v=r.readUInt16(),x=v/2,r.pos+=6,s=(function(){var M,Q;for(Q=[],u=M=0;0<=x?M<x:M>x;u=0<=x?++M:--M)Q.push(r.readUInt16());return Q})(),r.pos+=2,C=(function(){var M,Q;for(Q=[],u=M=0;0<=x?M<x:M>x;u=0<=x?++M:--M)Q.push(r.readUInt16());return Q})(),d=(function(){var M,Q;for(Q=[],u=M=0;0<=x?M<x:M>x;u=0<=x?++M:--M)Q.push(r.readUInt16());return Q})(),f=(function(){var M,Q;for(Q=[],u=M=0;0<=x?M<x:M>x;u=0<=x?++M:--M)Q.push(r.readUInt16());return Q})(),a=(this.length-r.pos+this.offset)/2,l=(function(){var M,Q;for(Q=[],u=M=0;0<=a?M<a:M>a;u=0<=a?++M:--M)Q.push(r.readUInt16());return Q})(),u=T=0,D=s.length;T<D;u=++T)for(A=s[u],i=O=w=C[u];w<=A?O<=A:O>=A;i=w<=A?++O:--O)f[u]===0?o=i+d[u]:(o=l[f[u]/2+(i-w)-(x-u)]||0)!==0&&(o+=d[u]),this.codeMap[i]=65535&o}r.pos=p}return t.encode=function(r,n){var i,a,s,o,l,u,d,f,p,x,v,w,C,A,T,O,D,M,Q,U,$,ee,F,Y,J,Z,re,de,le,K,ue,ce,ye,Se,V,X,se,W,oe,ge,be,Le,ke,He,Je,Qe;switch(de=new mf,o=Object.keys(r).sort(function(vt,Pt){return vt-Pt}),n){case"macroman":for(C=0,A=(function(){var vt=[];for(w=0;w<256;++w)vt.push(0);return vt})(),O={0:0},s={},le=0,ye=o.length;le<ye;le++)O[ke=r[a=o[le]]]==null&&(O[ke]=++C),s[a]={old:r[a],new:O[r[a]]},A[a]=O[r[a]];return de.writeUInt16(1),de.writeUInt16(0),de.writeUInt32(12),de.writeUInt16(0),de.writeUInt16(262),de.writeUInt16(0),de.write(A),{charMap:s,subtable:de.data,maxGlyphID:C+1};case"unicode":for(Z=[],p=[],D=0,O={},i={},T=d=null,K=0,Se=o.length;K<Se;K++)O[Q=r[a=o[K]]]==null&&(O[Q]=++D),i[a]={old:Q,new:O[Q]},l=O[Q]-a,T!=null&&l===d||(T&&p.push(T),Z.push(a),d=l),T=a;for(T&&p.push(T),p.push(65535),Z.push(65535),Y=2*(F=Z.length),ee=2*Math.pow(Math.log(F)/Math.LN2,2),x=Math.log(ee/2)/Math.LN2,$=2*F-ee,u=[],U=[],v=[],w=ue=0,V=Z.length;ue<V;w=++ue){if(J=Z[w],f=p[w],J===65535){u.push(0),U.push(0);break}if(J-(re=i[J].new)>=32768)for(u.push(0),U.push(2*(v.length+F-w)),a=ce=J;J<=f?ce<=f:ce>=f;a=J<=f?++ce:--ce)v.push(i[a].new);else u.push(re-J),U.push(0)}for(de.writeUInt16(3),de.writeUInt16(1),de.writeUInt32(12),de.writeUInt16(4),de.writeUInt16(16+8*F+2*v.length),de.writeUInt16(0),de.writeUInt16(Y),de.writeUInt16(ee),de.writeUInt16(x),de.writeUInt16($),be=0,X=p.length;be<X;be++)a=p[be],de.writeUInt16(a);for(de.writeUInt16(0),Le=0,se=Z.length;Le<se;Le++)a=Z[Le],de.writeUInt16(a);for(He=0,W=u.length;He<W;He++)l=u[He],de.writeUInt16(l);for(Je=0,oe=U.length;Je<oe;Je++)M=U[Je],de.writeUInt16(M);for(Qe=0,ge=v.length;Qe<ge;Qe++)C=v[Qe],de.writeUInt16(C);return{charMap:i,subtable:de.data,maxGlyphID:D+1}}},t})(),oH=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,i,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)n=new rM(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var i,a;return n==null&&(n="macroman"),i=rM.encode(r,n),(a=new mf).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},t})(),LCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t})(),zCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i})(),this.charRange=(function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t})(),BCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="post",t.prototype.parse=function(r){var n,i,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)n=r.readByte(),a.push(this.names.push(r.readString(n)));return a;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 262144:return this.map=(function(){var o,l,u;for(u=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)u.push(r.readUInt32());return u}).call(this)}},t})(),FCe=function(t,r){this.raw=t,this.length=t.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},qCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="name",t.prototype.parse=function(r){var n,i,a,s,o,l,u,d,f,p,x;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(u={},s=f=0,p=i.length;f<p;s=++f)a=i[s],r.pos=a.offset,d=r.readString(a.length),o=new FCe(d,a),u[x=a.nameID]==null&&(u[x]=[]),u[a.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t})(),UCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t})(),WCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,i,a,s,o,l,u;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var d,f;for(f=[],n=d=0;0<=a?d<a:d>a;n=0<=a?++d:--d)f.push(r.readInt16());return f})(),this.widths=(function(){var d,f,p,x;for(x=[],d=0,f=(p=this.metrics).length;d<f;d++)s=p[d],x.push(s.advance);return x}).call(this),i=this.widths[this.widths.length-1],u=[],n=o=0;0<=a?o<a:o>a;n=0<=a?++o:--o)u.push(this.widths.push(i));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t})(),lH=[].slice,HCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,i,a,s,o,l,u,d,f,p;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(a=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,o=(l=new mf(n.read(a))).readShort(),d=l.readShort(),p=l.readShort(),u=l.readShort(),f=l.readShort(),this.cache[r]=o===-1?new $Ce(l,d,p,u,f):new VCe(l,o,d,p,u,f),this.cache[r]))},t.prototype.encode=function(r,n,i){var a,s,o,l,u;for(o=[],s=[],l=0,u=n.length;l<u;l++)a=r[n[l]],s.push(o.length),a&&(o=o.concat(a.encode(i)));return s.push(o.length),{table:o,offsets:s}},t})(),VCe=(function(){function t(r,n,i,a,s,o){this.raw=r,this.numberOfContours=n,this.xMin=i,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),$Ce=(function(){function t(r,n,i,a,s){var o,l;for(this.raw=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var r,n,i;for(n=new mf(lH.call(this.raw.data)),r=0,i=this.glyphIDs.length;r<i;++r)n.pos=this.glyphOffsets[r];return n.data},t})(),GCe=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return bu(t,Dd),t.prototype.tag="loca",t.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,s;for(s=[],i=0,a=this.length;i<a;i+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],i=0,a=this.length;i<a;i+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<i.length;++o)if(i[o]=a,s<n.length&&n[s]==o){++s,i[o]=a;var l=this.offsets[o],u=this.offsets[o+1]-l;u>0&&(a+=u)}for(var d=new Array(4*i.length),f=0;f<i.length;++f)d[4*f+3]=255&i[f],d[4*f+2]=(65280&i[f])>>8,d[4*f+1]=(16711680&i[f])>>16,d[4*f]=(4278190080&i[f])>>24;return d},t})(),KCe=(function(){function t(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var r,n,i,a,s;for(n in a=this.font.cmap.tables[0].codeMap,r={},s=this.subset)i=s[n],r[n]=a[i];return r},t.prototype.glyphsFor=function(r){var n,i,a,s,o,l,u;for(a={},o=0,l=r.length;o<l;o++)a[s=r[o]]=this.font.glyf.glyphFor(s);for(s in n=[],a)(i=a[s])!=null&&i.compound&&n.push.apply(n,i.glyphIDs);if(n.length>0)for(s in u=this.glyphsFor(n))i=u[s],a[s]=i;return a},t.prototype.encode=function(r,n){var i,a,s,o,l,u,d,f,p,x,v,w,C,A,T;for(a in i=oH.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(r),v={0:0},T=i.charMap)v[(u=T[a]).old]=u.new;for(w in x=i.maxGlyphID,o)w in v||(v[w]=x++);return f=(function(O){var D,M;for(D in M={},O)M[O[D]]=D;return M})(v),p=Object.keys(f).sort(function(O,D){return O-D}),C=(function(){var O,D,M;for(M=[],O=0,D=p.length;O<D;O++)l=p[O],M.push(f[l]);return M})(),s=this.font.glyf.encode(o,C,v),d=this.font.loca.encode(s.offsets,C),A={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},t})();Br.API.PDFObject=(function(){var t;function r(){}return t=function(n,i){return(Array(i+1).join("0")+n).slice(-i)},r.convert=function(n){var i,a,s,o;if(Array.isArray(n))return"["+(function(){var l,u,d;for(d=[],l=0,u=n.length;l<u;l++)i=n[l],d.push(r.convert(i));return d})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n?.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(a in s=["<<"],n)o=n[a],s.push("/"+a+" "+r.convert(o));return s.push(">>"),s.join(`
`)}return""+n},r})();function QCe(t,r,n){const i=new Date(t.invoiceDate).toISOString(),a=t.totalAmount.toFixed(2),s=t.taxAmount.toFixed(2),o=[{tag:1,value:r},{tag:2,value:n},{tag:3,value:i},{tag:4,value:a},{tag:5,value:s}];let l=[];return o.forEach(d=>{const f=new TextEncoder().encode(d.value);l.push(d.tag),l.push(f.length),l.push(...f)}),btoa(String.fromCharCode(...l))}function YCe(){const[t,r]=k.useState(null),[n,i]=k.useState(!1),[a,s]=k.useState(null),[o,l]=k.useState(""),[u,d]=k.useState("details"),[f,p]=k.useState(!1),x=pr(),{formatDateOnly:v}=ph(),{data:w,isLoading:C}=Ve({queryKey:["invoices",o],queryFn:async()=>{const ye={};o&&(ye.status=o);const{data:Se}=await xe.get("/invoices",{params:ye});return Se}}),{data:A}=Ve({queryKey:["invoices","stats"],queryFn:async()=>{const{data:ye}=await xe.get("/invoices/stats");return ye}}),{data:T}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:ye}=await xe.get("/customers");return ye}}),{data:O}=Ve({queryKey:["orders","DELIVERED"],queryFn:async()=>{const{data:ye}=await xe.get("/orders",{params:{status:"DELIVERED"}});return ye}}),[D,M]=k.useState({amount:"",paymentMethod:"BANK_TRANSFER",referenceNumber:"",notes:""}),Q=ot({mutationFn:async ye=>xe.put(`/invoices/${ye}/submit-for-approval`),onSuccess:()=>{x.invalidateQueries({queryKey:["invoices"]})}}),U=ot({mutationFn:async ye=>xe.put(`/invoices/${ye}/approve-post`),onSuccess:()=>{x.invalidateQueries({queryKey:["invoices"]})}});ot({mutationFn:async ye=>xe.put(`/invoices/${ye}/close`),onSuccess:()=>{x.invalidateQueries({queryKey:["invoices"]})}});const $=ot({mutationFn:async({id:ye,...Se})=>xe.post(`/invoices/${ye}/payments`,Se),onSuccess:()=>{x.invalidateQueries({queryKey:["invoices"]}),s(null),M({amount:"",paymentMethod:"BANK_TRANSFER",referenceNumber:"",notes:""})}});ot({mutationFn:async({id:ye,reason:Se})=>xe.put(`/invoices/${ye}/void`,{reason:Se}),onSuccess:()=>{x.invalidateQueries({queryKey:["invoices"]})}});const ee=ot({mutationFn:async ye=>xe.post("/invoices/generate-from-orders",ye),onSuccess:()=>{x.invalidateQueries({queryKey:["invoices"]}),i(!1)}}),[F,Y]=k.useState({customerId:"",selectedOrders:[],taxRate:15}),J=ye=>({DRAFT:"default",PENDING_APPROVAL:"warning",ISSUED_POSTED:"info",PAID:"success",PARTIALLY_PAID:"warning",CLOSED_ARCHIVED:"success",CANCELLED_VOIDED:"danger",OVERDUE:"danger",DISPUTED:"danger"})[ye]||"default",Z=()=>{!a||!D.amount||$.mutate({id:a.id,amount:parseFloat(D.amount),paymentMethod:D.paymentMethod,referenceNumber:D.referenceNumber||void 0,notes:D.notes||void 0})},re=()=>{!F.customerId||F.selectedOrders.length===0||ee.mutate({customerId:F.customerId,orderIds:F.selectedOrders,taxRate:F.taxRate})},de=k.useCallback(async ye=>{p(!0);try{const Se=new Br({orientation:"portrait",unit:"mm",format:"a4"}),V=210,X=297,se=20,W=V-se*2,oe="RadioPharma Manufacturing Co.",ge="300000000000003",be=QCe(ye,oe,ge);let Le="";try{Le=await yW.toDataURL(be,{width:100,margin:1,errorCorrectionLevel:"M"})}catch(vt){console.error("QR generation error:",vt)}Se.setFillColor(30,58,95),Se.rect(0,0,V,45,"F"),Se.setTextColor(255,255,255),Se.setFontSize(24),Se.setFont("helvetica","bold"),Se.text("INVOICE",se,25),Se.setFontSize(10),Se.setFont("helvetica","normal"),Se.text(ye.invoiceNumber,se,35),Se.setFontSize(12),Se.setFont("helvetica","bold"),Se.text(oe,V-se,20,{align:"right"}),Se.setFontSize(9),Se.setFont("helvetica","normal"),Se.text("Riyadh, Saudi Arabia",V-se,27,{align:"right"}),Se.text(`VAT: ${ge}`,V-se,34,{align:"right"});let ke=60;Se.setTextColor(100,100,100),Se.setFontSize(9),Se.text("BILL TO",se,ke),Se.setTextColor(0,0,0),Se.setFontSize(12),Se.setFont("helvetica","bold"),Se.text(ye.customer?.name||"Customer",se,ke+7),Se.setFont("helvetica","normal"),Se.setFontSize(10),ye.customer?.address&&Se.text(ye.customer.address,se,ke+14);const He=v(ye.invoiceDate),Je=v(ye.dueDate);Se.setTextColor(100,100,100),Se.setFontSize(9),Se.text("INVOICE DATE",V-se-50,ke,{align:"left"}),Se.text("DUE DATE",V-se-50,ke+15,{align:"left"}),Se.setTextColor(0,0,0),Se.setFontSize(10),Se.text(He,V-se-50,ke+6),Se.text(Je,V-se-50,ke+21),ke=105,Se.setFillColor(245,247,250),Se.rect(se,ke,W,10,"F"),Se.setTextColor(100,100,100),Se.setFontSize(8),Se.setFont("helvetica","bold"),Se.text("DESCRIPTION",se+3,ke+7),Se.text("QTY",se+95,ke+7),Se.text("UNIT PRICE",se+115,ke+7),Se.text("TOTAL",se+W-3,ke+7,{align:"right"}),ke+=15,Se.setFont("helvetica","normal"),Se.setTextColor(0,0,0),Se.setFontSize(10),ye.items&&ye.items.length>0&&ye.items.forEach(vt=>{Se.text(vt.description||"Item",se+3,ke),Se.text(vt.quantity?.toString()||"1",se+95,ke),Se.text(`${Xc} ${vt.unitPrice?.toFixed(2)||"0.00"}`,se+115,ke),Se.text(`${Xc} ${vt.lineTotal?.toFixed(2)||"0.00"}`,se+W-3,ke,{align:"right"}),Se.setDrawColor(230,230,230),Se.line(se,ke+3,se+W,ke+3),ke+=10}),ke+=10;const Qe=se+100;if(Se.setFontSize(10),Se.setTextColor(100,100,100),Se.text("Subtotal:",Qe,ke),Se.setTextColor(0,0,0),Se.text(`${Xc} ${ye.subtotal?.toFixed(2)||"0.00"}`,se+W-3,ke,{align:"right"}),ke+=8,Se.setTextColor(100,100,100),Se.text(`VAT (${ye.taxRate||15}%):`,Qe,ke),Se.setTextColor(0,0,0),Se.text(`${Xc} ${ye.taxAmount?.toFixed(2)||"0.00"}`,se+W-3,ke,{align:"right"}),ke+=10,Se.setFillColor(30,58,95),Se.rect(Qe-5,ke-5,W-Qe+se+5,12,"F"),Se.setTextColor(255,255,255),Se.setFont("helvetica","bold"),Se.setFontSize(11),Se.text("TOTAL:",Qe,ke+3),Se.text(`${Xc} ${ye.totalAmount?.toFixed(2)||"0.00"}`,se+W-3,ke+3,{align:"right"}),ye.paidAmount>0){ke+=18,Se.setTextColor(34,197,94),Se.setFontSize(10),Se.text(`Paid: ${Xc} ${ye.paidAmount?.toFixed(2)}`,Qe,ke);const vt=ye.totalAmount-ye.paidAmount;vt>0&&(ke+=8,Se.setTextColor(239,68,68),Se.text(`Balance Due: ${Xc} ${vt.toFixed(2)}`,Qe,ke))}Le&&(Se.addImage(Le,"PNG",se,X-se-30-15,30,30),Se.setTextColor(100,100,100),Se.setFontSize(7),Se.text("ZATCA E-Invoice QR Code",se,X-se-12)),Se.setTextColor(100,100,100),Se.setFontSize(8),Se.setFont("helvetica","normal"),Se.text("Thank you for your business!",V/2,X-se-5,{align:"center"}),Se.setDrawColor(200,200,200),Se.line(se,X-se-20,V-se,X-se-20),Se.save(`Invoice_${ye.invoiceNumber}.pdf`)}catch(Se){console.error("PDF generation error:",Se),alert("Failed to generate PDF. Please try again.")}finally{p(!1)}},[]),le=O?.filter(ye=>ye.customerId===F.customerId)||[],K=w?.filter(ye=>ye.status==="PAID"||ye.status==="CLOSED_ARCHIVED").length||0,ue=w?.filter(ye=>ye.status==="ISSUED_POSTED").length||0;w?.filter(ye=>ye.status==="DRAFT").length;const ce=w?.filter(ye=>ye.status==="PENDING_APPROVAL").length||0;return C?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Invoicing"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Generate invoices from delivered orders and track payments"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"140px"},value:o,onChange:ye=>l(ye.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"PENDING_APPROVAL",children:"Pending Approval"}),e.jsx("option",{value:"ISSUED_POSTED",children:"Issued"}),e.jsx("option",{value:"PARTIALLY_PAID",children:"Partially Paid"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"CLOSED_ARCHIVED",children:"Closed"}),e.jsx("option",{value:"CANCELLED_VOIDED",children:"Voided"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>i(!0),children:[e.jsx(cn,{size:16})," Generate Invoice"]})]})]}),A&&e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Pending Approval",value:A.pendingApproval||ce,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>l("PENDING_APPROVAL"),selected:o==="PENDING_APPROVAL"}),e.jsx(nt,{title:"Issued",value:A.issued||ue,icon:e.jsx(Qi,{size:20}),color:"info",onClick:()=>l("ISSUED_POSTED"),selected:o==="ISSUED_POSTED"}),e.jsx(nt,{title:"Outstanding",value:`${Xc} ${((A.outstanding||0)/1e3).toFixed(1)}k`,icon:e.jsx(PA,{size:20}),color:"primary",onClick:()=>l(""),selected:!o}),e.jsx(nt,{title:"Paid",value:A.paid||K,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>l("PAID"),selected:o==="PAID"}),e.jsx(nt,{title:"Overdue",value:A.overdue||0,icon:e.jsx(sn,{size:20}),color:"danger",onClick:()=>l("OVERDUE"),selected:o==="OVERDUE"})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:t?"1fr 440px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{className:"card",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"140px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[w?.map(ye=>{const Se=["SENT","PARTIALLY_PAID"].includes(ye.status)&&new Date(ye.dueDate)<new Date,V=ye.totalAmount-ye.paidAmount;return e.jsxs("tr",{style:{cursor:"pointer",backgroundColor:t?.id===ye.id?"var(--bg-secondary)":void 0},onClick:()=>{r(ye),d("details")},children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.125rem"},children:ye.invoiceNumber}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Due: ",v(ye.dueDate)]})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ts,{size:16,style:{color:"var(--text-muted)"}})}),e.jsx("span",{style:{fontWeight:500},children:ye.customer?.name})]})}),e.jsx("td",{children:e.jsx("div",{style:{fontSize:"0.875rem"},children:v(ye.invoiceDate)})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:"1rem",fontFamily:"var(--font-mono, monospace)"},children:ci(ye.totalAmount)}),ye.paidAmount>0&&ye.paidAmount<ye.totalAmount&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--success)"},children:["Paid: ",ci(ye.paidAmount)]})]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${Se?"danger":J(ye.status)}`,children:Se?"OVERDUE":ye.status.replace("_"," ")})}),e.jsx("td",{onClick:X=>X.stopPropagation(),children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>de(ye),disabled:f,title:"Download PDF",children:e.jsx(Jp,{size:14})}),ye.status==="DRAFT"&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>Q.mutate(ye.id),disabled:Q.isPending,title:"Submit for Approval",children:e.jsx(Qi,{size:14})}),ye.status==="PENDING_APPROVAL"&&e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>U.mutate(ye.id),disabled:U.isPending,title:"Approve & Post",children:e.jsx(Ft,{size:14})}),["ISSUED_POSTED","PARTIALLY_PAID"].includes(ye.status)&&e.jsx("button",{className:"btn btn-sm btn-secondary",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--success)",border:"none"},onClick:()=>{M({...D,amount:V.toFixed(2)}),s(ye)},title:"Record Payment",children:e.jsx(Ul,{size:14})})]})})]},ye.id)}),(!w||w.length===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,style:{textAlign:"center",color:"var(--text-muted)",padding:"3rem"},children:[e.jsx(td,{size:40,style:{opacity:.2,marginBottom:"0.75rem"}}),e.jsx("div",{children:"No invoices found"})]})})]})]})}),t&&e.jsxs("div",{className:"card",style:{padding:0},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:e.jsx("span",{className:`badge badge-${J(t.status)}`,children:t.status.replace("_"," ")})}),e.jsxs("h3",{style:{fontWeight:600,fontSize:"1.125rem",marginBottom:"0.25rem"},children:["Invoice ",t.invoiceNumber]}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:t.customer?.name})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>de(t),disabled:f,title:"Download PDF",children:e.jsx(wm,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>r(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})]})}),e.jsx("div",{style:{borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",padding:"0 1rem"},children:[e.jsx("button",{style:{padding:"0.75rem 1rem",background:"none",border:"none",borderBottom:u==="details"?"2px solid var(--primary)":"2px solid transparent",color:u==="details"?"var(--primary)":"var(--text-muted)",fontWeight:500,cursor:"pointer",fontSize:"0.875rem"},onClick:()=>d("details"),children:"Invoice Details"}),e.jsxs("button",{style:{padding:"0.75rem 1rem",background:"none",border:"none",borderBottom:u==="payments"?"2px solid var(--primary)":"2px solid transparent",color:u==="payments"?"var(--primary)":"var(--text-muted)",fontWeight:500,cursor:"pointer",fontSize:"0.875rem"},onClick:()=>d("payments"),children:["Payments (",t.payments?.length||0,")"]}),e.jsxs("button",{style:{padding:"0.75rem 1rem",background:"none",border:"none",borderBottom:u==="attachments"?"2px solid var(--primary)":"2px solid transparent",color:u==="attachments"?"var(--primary)":"var(--text-muted)",fontWeight:500,cursor:"pointer",fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.375rem"},onClick:()=>d("attachments"),children:[e.jsx(ah,{size:14})," Documents"]})]})}),e.jsxs("div",{style:{padding:"1.25rem"},children:[u==="details"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{padding:"0.875rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx($n,{size:18,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase"},children:"Invoice Date"}),e.jsx("div",{style:{fontWeight:500},children:v(t.invoiceDate)})]})]}),e.jsxs("div",{style:{padding:"0.875rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Qt,{size:18,style:{color:new Date(t.dueDate)<new Date?"var(--danger)":"var(--warning)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase"},children:"Due Date"}),e.jsx("div",{style:{fontWeight:500,color:new Date(t.dueDate)<new Date?"var(--danger)":void 0},children:v(t.dueDate)})]})]})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, var(--primary) 0%, #1e40af 100%)",color:"white",padding:"1.25rem",borderRadius:"var(--radius)",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.8,marginBottom:"0.25rem"},children:"Total Amount"}),e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700},children:ci(t.totalAmount)})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.8,marginBottom:"0.25rem"},children:"Paid"}),e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600},children:ci(t.paidAmount)})]})]}),t.totalAmount-t.paidAmount>0&&e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid rgba(255,255,255,0.2)",display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontSize:"0.875rem",opacity:.8},children:"Balance Due"}),e.jsx("span",{style:{fontWeight:600},children:ci(t.totalAmount-t.paidAmount)})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.75rem"},children:"Line Items"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.items?.map(ye=>e.jsxs("div",{style:{padding:"0.875rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.125rem"},children:ye.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[ye.quantity," x ",ci(ye.unitPrice)]})]}),e.jsx("div",{style:{fontWeight:600,color:"var(--primary)"},children:ci(ye.lineTotal)})]},ye.id))})]}),e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Subtotal"}),e.jsx("span",{children:ci(t.subtotal)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsxs("span",{style:{color:"var(--text-muted)"},children:["VAT (",t.taxRate||15,"%)"]}),e.jsx("span",{children:ci(t.taxAmount)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"0.5rem",borderTop:"1px solid var(--border)",fontWeight:600},children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:ci(t.totalAmount)})]})]})]}),u==="payments"&&e.jsxs(e.Fragment,{children:[t.payments?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.payments.map(ye=>e.jsxs("div",{style:{padding:"1rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(34, 197, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ft,{size:20,style:{color:"var(--success)"}})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--success)",marginBottom:"0.125rem"},children:ci(ye.amount)}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[v(ye.paymentDate)," via ",ye.paymentMethod.replace("_"," ")]})]}),ye.referenceNumber&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",fontFamily:"monospace"},children:["#",ye.referenceNumber]})]},ye.id))}):e.jsxs("div",{style:{textAlign:"center",padding:"2.5rem 1rem",color:"var(--text-muted)",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(Ul,{size:32,style:{opacity:.3,marginBottom:"0.75rem"}}),e.jsx("div",{style:{marginBottom:"0.25rem"},children:"No payments recorded"}),e.jsx("div",{style:{fontSize:"0.75rem"},children:"Payments will appear here once recorded"})]}),["SENT","PARTIALLY_PAID"].includes(t.status)&&e.jsxs("button",{className:"btn btn-primary",style:{width:"100%",marginTop:"1rem"},onClick:()=>{const ye=t.totalAmount-t.paidAmount;M({...D,amount:ye.toFixed(2)}),s(t)},children:[e.jsx(Ul,{size:18})," Record Payment"]})]}),u==="attachments"&&e.jsx(mc,{entityType:"INVOICE",entityId:t.id,title:"Invoice Documents"})]})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"560px"},onClick:ye=>ye.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Generate Invoice"}),e.jsx("button",{onClick:()=>i(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Select delivered orders to include in the invoice"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Customer *"}),e.jsxs("select",{className:"form-select",value:F.customerId,onChange:ye=>Y({...F,customerId:ye.target.value,selectedOrders:[]}),children:[e.jsx("option",{value:"",children:"Select a customer"}),T?.map(ye=>e.jsx("option",{value:ye.id,children:ye.name},ye.id))]})]}),F.customerId&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Select Delivered Orders *"}),e.jsx("div",{style:{maxHeight:"200px",overflow:"auto",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:le.length>0?le.map(ye=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",cursor:"pointer",borderBottom:"1px solid var(--border)",backgroundColor:F.selectedOrders.includes(ye.id)?"rgba(59, 130, 246, 0.1)":void 0},children:[e.jsx("input",{type:"checkbox",checked:F.selectedOrders.includes(ye.id),onChange:Se=>{Se.target.checked?Y({...F,selectedOrders:[...F.selectedOrders,ye.id]}):Y({...F,selectedOrders:F.selectedOrders.filter(V=>V!==ye.id)})},style:{width:"16px",height:"16px"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem"},children:ye.orderNumber}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[ye.product?.name," - ",ye.requestedActivity," ",ye.activityUnit]})]})]},ye.id)):e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center",padding:"2rem"},children:"No delivered orders for this customer"})}),F.selectedOrders.length>0&&e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--primary)"},children:[F.selectedOrders.length," order(s) selected"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"VAT Rate (%)"}),e.jsx("input",{type:"number",className:"form-input",value:F.taxRate,onChange:ye=>Y({...F,taxRate:parseFloat(ye.target.value)||0}),min:"0",max:"100",step:"0.5"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Saudi Arabia standard VAT is 15%"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:re,disabled:ee.isPending||F.selectedOrders.length===0,children:ee.isPending?"Generating...":"Generate Invoice"})]})]})}),a&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(null),children:e.jsxs("div",{className:"modal",style:{maxWidth:"440px"},onClick:ye=>ye.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Record Payment"}),e.jsx("button",{onClick:()=>s(null),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Invoice"}),e.jsx("span",{style:{fontWeight:500},children:a.invoiceNumber})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Outstanding"}),e.jsx("span",{style:{fontWeight:600,color:"var(--danger)"},children:ci(a.totalAmount-a.paidAmount)})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Amount *"}),e.jsx("input",{type:"number",className:"form-input",value:D.amount,onChange:ye=>M({...D,amount:ye.target.value}),step:"0.01",placeholder:"Enter payment amount"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Payment Method"}),e.jsxs("select",{className:"form-select",value:D.paymentMethod,onChange:ye=>M({...D,paymentMethod:ye.target.value}),children:[e.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer"}),e.jsx("option",{value:"CHECK",children:"Check"}),e.jsx("option",{value:"CREDIT_CARD",children:"Credit Card"}),e.jsx("option",{value:"CASH",children:"Cash"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Reference Number"}),e.jsx("input",{type:"text",className:"form-input",value:D.referenceNumber,onChange:ye=>M({...D,referenceNumber:ye.target.value}),placeholder:"e.g., Check #, Transaction ID"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-input",value:D.notes,onChange:ye=>M({...D,notes:ye.target.value}),rows:2,placeholder:"Optional notes"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>s(null),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:Z,disabled:$.isPending||!D.amount,children:$.isPending?"Recording...":"Record Payment"})]})]})})]})}const nM=[{key:"SUBMITTED",label:"Submitted",icon:Ir},{key:"VALIDATED",label:"Validated",icon:Ft},{key:"SCHEDULED",label:"Scheduled",icon:$n},{key:"IN_PRODUCTION",label:"Production",icon:Bi},{key:"QC_PENDING",label:"QC",icon:gu},{key:"RELEASED",label:"Released",icon:aa},{key:"DISPATCHED",label:"Dispatched",icon:dn},{key:"DELIVERED",label:"Delivered",icon:Rr}],iM={DRAFT:{color:"#94a3b8",badge:"default",description:"Order created, awaiting submission"},SUBMITTED:{color:"#3b82f6",badge:"info",description:"Order submitted for validation"},VALIDATED:{color:"#06b6d4",badge:"info",description:"Order validated and approved"},SCHEDULED:{color:"#8b5cf6",badge:"info",description:"Scheduled for production"},IN_PRODUCTION:{color:"#f59e0b",badge:"warning",description:"Radiopharmaceutical being manufactured"},QC_PENDING:{color:"#f59e0b",badge:"warning",description:"Quality control in progress"},RELEASED:{color:"#22c55e",badge:"success",description:"Released by Qualified Person"},DISPATCHED:{color:"#3b82f6",badge:"info",description:"Shipped to customer"},DELIVERED:{color:"#22c55e",badge:"success",description:"Delivered successfully"},CANCELLED:{color:"#ef4444",badge:"danger",description:"Order cancelled"},REJECTED:{color:"#ef4444",badge:"danger",description:"Order rejected during validation"},FAILED_QC:{color:"#ef4444",badge:"danger",description:"Quality control failed"},REWORK:{color:"#f59e0b",badge:"warning",description:"Order being reworked"}},ZCe={DRAFT:{action:"Submit Order",role:"Sales / Customer",description:"Review order details and submit for processing",link:"/orders"},SUBMITTED:{action:"Validate Order",role:"Sales Team",description:"Verify customer license, product permissions, and feasibility",link:"/orders"},VALIDATED:{action:"Schedule Production",role:"Production Planner",description:"Assign to production batch and schedule manufacturing",link:"/planner"},SCHEDULED:{action:"Start Production",role:"Production Team",description:"Begin radiopharmaceutical synthesis",link:"/batches"},IN_PRODUCTION:{action:"Complete Production",role:"Production Team",description:"Finish manufacturing and send to QC",link:"/batches"},QC_PENDING:{action:"Complete QC Testing",role:"QC Analyst",description:"Perform quality control tests on batch",link:"/qc"},RELEASED:{action:"Dispatch Shipment",role:"Logistics",description:"Create shipment and dispatch to customer",link:"/shipments"},DISPATCHED:{action:"Confirm Delivery",role:"Logistics / Customer",description:"Confirm order was received by customer",link:"/shipments"},DELIVERED:{action:"Complete",role:"-",description:"Order successfully completed"}};function If(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}function XCe(){const{id:t}=fl(),r=Gr(),n=gn(),i=pr(),{user:a}=Il(),[s,o]=k.useState(!1),{data:l,isLoading:u}=Ve({queryKey:["order",t],queryFn:async()=>{const{data:T}=await xe.get(`/orders/${t}`);return T},enabled:!!t}),{data:d}=Ve({queryKey:["order-events",t],queryFn:async()=>{const{data:T}=await xe.get(`/orders/${t}/events`);return T},enabled:!!t});if(ot({mutationFn:async({status:T,comment:O})=>xe.post(`/orders/${t}/transition`,{status:T,comment:O}),onSuccess:(T,O)=>{i.invalidateQueries({queryKey:["order",t]}),i.invalidateQueries({queryKey:["order-events",t]}),n.success("Status Updated",`Order moved to ${O.status.replace("_"," ")}`)},onError:T=>{const O=an(T);n.error("Update Failed",O?.userMessage||"Failed to update order status")}}),u)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!l)return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>r("/orders"),className:"btn btn-secondary",style:{marginBottom:"1rem"},children:[e.jsx(sa,{size:18})," Back to Orders"]}),e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h3",{children:"Order Not Found"})]})]});const f=nM.findIndex(T=>T.key===l.status),p=["CANCELLED","REJECTED","FAILED_QC","DELIVERED"].includes(l.status),x=ZCe[l.status],v=iM[l.status]||iM.DRAFT,w=(T,O)=>p&&l.status!=="DELIVERED"?"skipped":l.status===T?"current":f>=0&&O<f?"completed":(l.status==="DRAFT"&&O===0||f>=0&&O>f,"pending"),C=T=>T.toStatus==="DELIVERED"?e.jsx(Rr,{size:16}):T.toStatus==="DISPATCHED"?e.jsx(dn,{size:16}):T.toStatus==="RELEASED"?e.jsx(aa,{size:16}):T.toStatus?.includes("QC")?e.jsx(gu,{size:16}):T.toStatus==="IN_PRODUCTION"?e.jsx(Bi,{size:16}):T.toStatus==="SCHEDULED"?e.jsx($n,{size:16}):e.jsx(Qt,{size:16}),A=s?d:d?.slice(0,5);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("button",{onClick:()=>r("/orders"),className:"btn btn-secondary",children:[e.jsx(sa,{size:18})," Back to Orders"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs(nr,{to:`/orders/${t}`,className:"btn btn-secondary",children:[e.jsx(Ir,{size:18})," Edit Order"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>window.print(),children:[e.jsx(wm,{size:18})," Print"]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:l.orderNumber}),e.jsx("span",{className:`badge badge-${v.badge}`,style:{fontSize:"0.875rem"},children:l.status.replace("_"," ")})]}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:v.description})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Delivery"}),e.jsx("div",{style:{fontWeight:600},children:If(l.deliveryDate,"MMM dd, yyyy")}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[If(l.deliveryTimeStart,"HH:mm")," - ",If(l.deliveryTimeEnd,"HH:mm")]})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",padding:"1rem 1.5rem",backgroundColor:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Ts,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Customer"}),e.jsx("div",{style:{fontWeight:500},children:l.customer?.name})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Rr,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Product"}),e.jsx("div",{style:{fontWeight:500},children:l.product?.name})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Mc,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Activity"}),e.jsxs("div",{style:{fontWeight:500},children:[l.requestedActivity," ",l.activityUnit]})]})]}),l.numberOfDoses&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Bi,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Doses"}),e.jsx("div",{style:{fontWeight:500},children:l.numberOfDoses})]})]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1.5rem"},children:"Order Journey"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",position:"relative",marginBottom:"1rem"},children:[e.jsx("div",{style:{position:"absolute",top:"20px",left:"40px",right:"40px",height:"2px",backgroundColor:"var(--border)",zIndex:0}}),nM.map((T,O)=>{const D=w(T.key,O),M=T.icon,Q=d?.find(U=>U.toStatus===T.key);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",zIndex:1,flex:1},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:D==="completed"?"var(--success)":D==="current"?"var(--primary)":"var(--bg-tertiary)",color:D==="completed"||D==="current"?"white":"var(--text-muted)",border:D==="current"?"3px solid rgba(37, 99, 235, 0.3)":"none",transition:"all 0.2s"},children:D==="completed"?e.jsx(Ft,{size:20}):e.jsx(M,{size:20})}),e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",fontWeight:D==="current"?600:400,color:D==="pending"?"var(--text-muted)":"var(--text-primary)",textAlign:"center"},children:T.label}),Q&&e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:If(Q.createdAt,"MMM dd HH:mm")})]},T.key)})]})]}),x&&!p&&e.jsx("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.25rem",borderLeft:"4px solid var(--primary)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"WHAT HAPPENS NEXT"}),e.jsx("div",{style:{fontSize:"1.125rem",fontWeight:600,marginBottom:"0.25rem"},children:x.action}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:x.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:[e.jsx(Uo,{size:12,style:{display:"inline",marginRight:"0.25rem"}}),"Responsible: ",e.jsx("strong",{children:x.role})]})]}),x.link&&l.status!=="DELIVERED"&&e.jsxs(nr,{to:x.link,className:"btn btn-primary",children:["Go to ",x.action.split(" ")[0]," ",e.jsx(lc,{size:16})]})]})}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:"Timeline"}),d?.length>5&&e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>o(!s),children:[s?e.jsx(nh,{size:14}):e.jsx(qo,{size:14}),s?"Show Less":`Show All (${d.length})`]})]}),e.jsx("div",{style:{padding:"1rem 1.5rem"},children:A?.length>0?e.jsxs("div",{style:{position:"relative",paddingLeft:"2rem"},children:[e.jsx("div",{style:{position:"absolute",left:"11px",top:"8px",bottom:"8px",width:"2px",backgroundColor:"var(--border)"}}),A.map((T,O)=>e.jsxs("div",{style:{position:"relative",paddingBottom:O<A.length-1?"1.25rem":0},children:[e.jsx("div",{style:{position:"absolute",left:"-2rem",top:"4px",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:O===0?"var(--primary)":"var(--bg-tertiary)",color:O===0?"white":"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid var(--bg-primary)"},children:C(T)}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsxs("span",{style:{fontWeight:500},children:[T.fromStatus?`${T.fromStatus.replace("_"," ")}  `:"",T.toStatus.replace("_"," ")]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:If(T.createdAt,"MMM dd, yyyy HH:mm")})]}),T.changedByUser&&e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:["by ",T.changedByUser.firstName," ",T.changedByUser.lastName,T.role&&e.jsxs("span",{style:{color:"var(--text-muted)"},children:[" (",T.role,")"]})]}),T.changeNotes&&e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem",fontStyle:"italic"},children:['"',T.changeNotes,'"']})]})]},T.id))]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:"No timeline events yet"})})]}),l.batch&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:"Production & QC"})}),e.jsxs("div",{style:{padding:"1rem 1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Batch Number"}),e.jsx("div",{style:{fontWeight:500},children:l.batch.batchNumber})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Batch Status"}),e.jsx("span",{className:`badge badge-${l.batch.status==="RELEASED"?"success":"info"}`,children:l.batch.status.replace("_"," ")})]}),l.batch.qcResults?.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"QC Tests"}),e.jsxs("div",{style:{fontWeight:500},children:[l.batch.qcResults.filter(T=>T.status==="PASSED").length," / ",l.batch.qcResults.length," Passed"]})]})]}),e.jsx("div",{style:{marginTop:"1rem"},children:e.jsxs(nr,{to:"/batches",className:"btn btn-secondary btn-sm",children:["View Batch Details ",e.jsx(lc,{size:14})]})})]})]}),l.shipment&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:"Shipment"})}),e.jsxs("div",{style:{padding:"1rem 1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Shipment Number"}),e.jsx("div",{style:{fontWeight:500},children:l.shipment.shipmentNumber})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Status"}),e.jsx("span",{className:`badge badge-${l.shipment.status==="DELIVERED"?"success":"info"}`,children:l.shipment.status})]}),l.shipment.dispatchedAt&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Dispatched At"}),e.jsx("div",{style:{fontWeight:500},children:If(l.shipment.dispatchedAt,"MMM dd HH:mm")})]})]}),e.jsx("div",{style:{marginTop:"1rem"},children:e.jsxs(nr,{to:"/shipments",className:"btn btn-secondary btn-sm",children:["View Shipment Details ",e.jsx(lc,{size:14})]})})]})]}),t&&e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsx(mc,{entityType:"ORDER",entityId:t,title:"Order Attachments"})}),a?.role==="Admin"&&e.jsx("div",{className:"card",style:{marginBottom:"1.5rem",backgroundColor:"var(--bg-tertiary)"},children:e.jsxs("div",{style:{padding:"1rem 1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:"ADMIN INFO"}),e.jsxs("div",{style:{fontSize:"0.8125rem"},children:[e.jsx("strong",{children:"Order ID:"})," ",l.id]}),e.jsxs("div",{style:{fontSize:"0.8125rem",marginTop:"0.25rem"},children:[e.jsx("strong",{children:"Created:"})," ",If(l.createdAt,"MMM dd, yyyy HH:mm:ss")]}),e.jsx("div",{style:{marginTop:"0.5rem"},children:e.jsx(nr,{to:"/audit",className:"btn btn-secondary btn-sm",children:"View Audit Log"})})]})})]})}const aM=[{key:"PLANNED",label:"Planned",icon:$n,includes:["PLANNED","SCHEDULED"]},{key:"IN_PRODUCTION",label:"Production",icon:Bi,includes:["IN_PRODUCTION","PRODUCTION_COMPLETE"]},{key:"QC_PENDING",label:"QC",icon:Wl,includes:["QC_PENDING","QC_IN_PROGRESS","QC_PASSED"]},{key:"QP_REVIEW",label:"QP Review",icon:aa,includes:["QP_REVIEW"]},{key:"RELEASED",label:"Released",icon:Ft,includes:["RELEASED"]},{key:"DISPENSING_IN_PROGRESS",label:"Dispensing",icon:Tg,includes:["DISPENSING_IN_PROGRESS","DISPENSED"]},{key:"PACKED",label:"Packed",icon:rh,includes:["PACKED"]},{key:"DISPATCHED",label:"Dispatched",icon:dn,includes:["DISPATCHED","CLOSED"]}],JCe=["PLANNED","SCHEDULED","IN_PRODUCTION","PRODUCTION_COMPLETE","QC_PENDING","QC_IN_PROGRESS","QC_PASSED","QP_REVIEW","RELEASED","DISPENSING_IN_PROGRESS","DISPENSED","PACKED","DISPATCHED","CLOSED"],sM={PLANNED:{color:"#94a3b8",badge:"default",description:"Batch is planned and awaiting production start"},SCHEDULED:{color:"#64748b",badge:"secondary",description:"Batch is scheduled for production"},IN_PRODUCTION:{color:"#3b82f6",badge:"info",description:"Radiopharmaceutical synthesis in progress"},PRODUCTION_COMPLETE:{color:"#3b82f6",badge:"info",description:"Production completed, ready for QC"},QC_PENDING:{color:"#f59e0b",badge:"warning",description:"Awaiting quality control testing"},QC_IN_PROGRESS:{color:"#f59e0b",badge:"warning",description:"Quality control tests in progress"},QC_PASSED:{color:"#eab308",badge:"qc-passed",description:"All QC tests passed"},QP_REVIEW:{color:"#f97316",badge:"qp-passed",description:"Awaiting Qualified Person review"},RELEASED:{color:"#22c55e",badge:"released",description:"Released by QP for dispensing"},DISPENSING_IN_PROGRESS:{color:"#14b8a6",badge:"teal",description:"Dose units being dispensed"},DISPENSED:{color:"#14b8a6",badge:"teal",description:"All doses dispensed"},PACKED:{color:"#3b82f6",badge:"info",description:"Packaged and ready for dispatch"},DISPATCHED:{color:"#3b82f6",badge:"info",description:"Shipped to customer"},CLOSED:{color:"#dc2626",badge:"closed",description:"Batch completed"},ON_HOLD:{color:"#f59e0b",badge:"warning",description:"Batch on hold - requires investigation"},REJECTED:{color:"#ef4444",badge:"danger",description:"Batch rejected by QP"},FAILED_QC:{color:"#ef4444",badge:"danger",description:"Quality control failed"},CANCELLED:{color:"#ef4444",badge:"danger",description:"Batch cancelled"},DEVIATION_OPEN:{color:"#f59e0b",badge:"warning",description:"Deviation investigation in progress"}},eNe={PLANNED:{action:"Start Production",role:"Production",description:"Begin radiopharmaceutical synthesis",nextStatus:"IN_PRODUCTION"},SCHEDULED:{action:"Start Production",role:"Production",description:"Begin radiopharmaceutical synthesis",nextStatus:"IN_PRODUCTION"},IN_PRODUCTION:{action:"Complete Production",role:"Production",description:"Mark synthesis as complete",nextStatus:"PRODUCTION_COMPLETE"},PRODUCTION_COMPLETE:{action:"Start QC",role:"QC Analyst",description:"Begin quality control testing",nextStatus:"QC_PENDING"},QC_PENDING:{action:"Enter QC Results",role:"QC Analyst",description:"Perform and record QC test results",nextStatus:"QC_IN_PROGRESS"},QC_IN_PROGRESS:{action:"Complete QC",role:"QC Analyst",description:"Finalize QC testing",nextStatus:"QC_PASSED"},QC_PASSED:{action:"Submit for QP Review",role:"QC Analyst",description:"Send batch for QP approval",nextStatus:"QP_REVIEW"},QP_REVIEW:{action:"Release Batch",role:"Qualified Person",description:"Review and release batch with e-signature",nextStatus:"RELEASED"},RELEASED:{action:"Start Dispensing",role:"Dispensing",description:"Begin creating dose units",nextStatus:"DISPENSING_IN_PROGRESS"},DISPENSING_IN_PROGRESS:{action:"Complete Dispensing",role:"Dispensing",description:"Finish dispensing all doses",nextStatus:"DISPENSED"},DISPENSED:{action:"Pack for Shipment",role:"Logistics",description:"Package doses for transport",nextStatus:"PACKED"},PACKED:{action:"Dispatch",role:"Logistics",description:"Ship batch to customer",nextStatus:"DISPATCHED"},DISPATCHED:{action:"Close Batch",role:"Admin",description:"Close batch after delivery confirmation",nextStatus:"CLOSED"},CLOSED:{action:"Complete",role:"-",description:"Batch lifecycle complete"}};function Of(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}function tNe(){const{id:t}=fl(),r=Gr(),n=gn(),i=pr(),{user:a}=Il(),[s,o]=k.useState(!1),[l,u]=k.useState("overview"),{data:d,isLoading:f}=Ve({queryKey:["batch",t],queryFn:async()=>{const{data:$}=await xe.get(`/batches/${t}`);return $},enabled:!!t}),{data:p}=Ve({queryKey:["batch-events",t],queryFn:async()=>{const{data:$}=await xe.get(`/batches/${t}/events`);return $},enabled:!!t}),x=ot({mutationFn:async({status:$,note:ee})=>xe.post(`/batches/${t}/transition`,{status:$,note:ee}),onSuccess:($,ee)=>{i.invalidateQueries({queryKey:["batch",t]}),i.invalidateQueries({queryKey:["batch-events",t]}),n.success("Status Updated",`Batch moved to ${ee.status.replace(/_/g," ")}`)},onError:$=>{const ee=an($);n.error("Update Failed",ee?.userMessage||"Failed to update batch status")}});if(f)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!d)return e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>r("/batches"),className:"btn btn-secondary",style:{marginBottom:"1rem"},children:[e.jsx(sa,{size:18})," Back to Batches"]}),e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h3",{children:"Batch Not Found"})]})]});const v=aM.findIndex($=>$.includes?.includes(d.status)||$.key===d.status);JCe.indexOf(d.status);const w=["ON_HOLD","REJECTED","FAILED_QC","CANCELLED","DEVIATION_OPEN"].includes(d.status),C=["CLOSED","CANCELLED"].includes(d.status),A=eNe[d.status],T=sM[d.status]||sM.PLANNED,O=($,ee)=>w?ee<=v?"completed":"skipped":$.includes?.includes(d.status)?"current":d.status==="CLOSED"&&$.key==="DISPATCHED"||v>=0&&ee<v?"completed":(v>=0&&ee>v,"pending"),D=$=>$.toStatus==="DISPATCHED"?e.jsx(dn,{size:16}):$.toStatus==="RELEASED"?e.jsx(aa,{size:16}):$.toStatus?.includes("QC")||$.toStatus?.includes("QP")?e.jsx(Wl,{size:16}):$.toStatus==="IN_PRODUCTION"?e.jsx(Bi,{size:16}):$.toStatus?.includes("DISPENS")?e.jsx(Tg,{size:16}):$.toStatus==="PACKED"?e.jsx(rh,{size:16}):$.eventType==="MATERIAL_ADDED"?e.jsx(Rr,{size:16}):e.jsx(Qt,{size:16}),M=s?p:p?.slice(0,5),Q=d.doseUnits?.length||0,U=d.doseUnits?.filter($=>$.status==="DISPENSED").length||0;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[e.jsxs("button",{onClick:()=>r("/batches"),className:"btn btn-secondary",children:[e.jsx(sa,{size:18})," Back to Batches"]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:e.jsxs("button",{className:"btn btn-secondary",onClick:()=>window.print(),children:[e.jsx(wm,{size:18})," Print"]})})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:d.batchNumber}),e.jsx("span",{className:`badge badge-${T.badge}`,style:{fontSize:"0.875rem"},children:d.status.replace(/_/g," ")}),w&&e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Hr,{size:12})," Exception"]})]}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:T.description})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Planned Start"}),e.jsx("div",{style:{fontWeight:600},children:Of(d.plannedStartTime,"MMM dd, yyyy HH:mm")})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",padding:"1rem 1.5rem",backgroundColor:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Rr,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Product"}),e.jsx("div",{style:{fontWeight:500},children:d.product?.name})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Mc,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Target Activity"}),e.jsxs("div",{style:{fontWeight:500},children:[d.targetActivity," ",d.activityUnit]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(JL,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Orders"}),e.jsx("div",{style:{fontWeight:500},children:d.orders?.length||0})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Tg,{size:20,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Doses"}),e.jsxs("div",{style:{fontWeight:500},children:[U," / ",Q]})]})]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",borderBottom:"1px solid var(--border)"},children:["overview","orders","doses","qc","release","logistics"].map($=>e.jsx("button",{onClick:()=>u($),className:"btn",style:{borderRadius:0,borderBottom:l===$?"2px solid var(--primary)":"2px solid transparent",fontWeight:l===$?600:400,padding:"0.75rem 1rem",background:"transparent"},children:$.charAt(0).toUpperCase()+$.slice(1)},$))}),l==="overview"&&e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1.5rem"},children:"Batch Journey"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",position:"relative",marginBottom:"2rem"},children:[e.jsx("div",{style:{position:"absolute",top:"20px",left:"40px",right:"40px",height:"2px",backgroundColor:"var(--border)",zIndex:0}}),aM.map(($,ee)=>{const F=O($,ee),Y=$.icon,J=p?.find(Z=>$.includes?.includes(Z.toStatus)||Z.toStatus===$.key);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",zIndex:1,flex:1},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:F==="completed"?"var(--success)":F==="current"?"var(--primary)":F==="skipped"?"var(--danger-light, #fecaca)":"var(--bg-tertiary)",color:F==="completed"||F==="current"?"white":F==="skipped"?"var(--danger)":"var(--text-muted)",border:F==="current"?"3px solid rgba(37, 99, 235, 0.3)":"none",transition:"all 0.2s"},children:F==="completed"?e.jsx(Ft,{size:20}):F==="skipped"?e.jsx(BC,{size:16}):e.jsx(Y,{size:20})}),e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",fontWeight:F==="current"?600:400,color:F==="pending"||F==="skipped"?"var(--text-muted)":"var(--text-primary)",textAlign:"center"},children:$.label}),J&&e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:Of(J.createdAt,"MMM dd HH:mm")})]},$.key)})]}),A&&!C&&e.jsx("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.25rem",borderLeft:`4px solid ${w?"var(--danger)":"var(--primary)"}`,background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:w?"BATCH BLOCKED":"WHAT HAPPENS NEXT"}),e.jsx("div",{style:{fontSize:"1.125rem",fontWeight:600,marginBottom:"0.25rem"},children:A.action}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:A.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:[e.jsx(Uo,{size:12,style:{display:"inline",marginRight:"0.25rem"}}),"Responsible: ",e.jsx("strong",{children:A.role})]})]}),A.nextStatus&&!w&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>x.mutate({status:A.nextStatus}),disabled:x.isPending,children:[e.jsx(yo,{size:16})," ",A.action]})]})}),e.jsxs("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Timeline",p?.length>5&&e.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:()=>o(!s),children:[s?e.jsx(nh,{size:14}):e.jsx(qo,{size:14}),s?"Show Less":`Show All (${p.length})`]})]}),M?.length>0?e.jsxs("div",{style:{position:"relative",paddingLeft:"2rem"},children:[e.jsx("div",{style:{position:"absolute",left:"11px",top:"8px",bottom:"8px",width:"2px",backgroundColor:"var(--border)"}}),M.map(($,ee)=>e.jsxs("div",{style:{position:"relative",paddingBottom:ee<M.length-1?"1.25rem":0},children:[e.jsx("div",{style:{position:"absolute",left:"-2rem",top:"4px",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:ee===0?"var(--primary)":"var(--bg-tertiary)",color:ee===0?"white":"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid var(--bg-primary)"},children:D($)}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[e.jsxs("span",{style:{fontWeight:500},children:[$.fromStatus?`${$.fromStatus.replace(/_/g," ")}  `:"",$.toStatus?.replace(/_/g," ")||$.eventType.replace(/_/g," ")]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Of($.createdAt,"MMM dd, yyyy HH:mm")})]}),$.actor&&e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:["by ",$.actor.firstName," ",$.actor.lastName,$.actorRole&&e.jsxs("span",{style:{color:"var(--text-muted)"},children:[" (",$.actorRole,")"]})]}),$.note&&e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem",fontStyle:"italic"},children:['"',$.note,'"']})]})]},$.id))]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:"No timeline events yet"})]}),l==="orders"&&e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Linked Orders"}),d.orders?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Delivery"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.orders.map($=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:$.orderNumber})}),e.jsx("td",{children:$.customer?.name}),e.jsxs("td",{children:[$.requestedActivity," ",$.activityUnit]}),e.jsx("td",{children:Of($.deliveryDate,"MMM dd")}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:$.status})}),e.jsx("td",{children:e.jsx(nr,{to:`/orders/${$.id}/journey`,className:"btn btn-secondary btn-sm",children:"View Journey"})})]},$.id))})]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No orders linked to this batch"})]}),l==="doses"&&e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Dose Units"}),d.doseUnits?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dose ID"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Patient Ref"}),e.jsx("th",{children:"Dispensed At"})]})}),e.jsx("tbody",{children:d.doseUnits.map($=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:$.doseNumber||$.id.slice(0,8)})}),e.jsxs("td",{children:[$.activity," ",$.activityUnit]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${$.status==="DISPENSED"?"success":"default"}`,children:$.status})}),e.jsx("td",{children:$.patientReference||"-"}),e.jsx("td",{children:$.dispensedAt?Of($.dispensedAt,"MMM dd HH:mm"):"-"})]},$.id))})]}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:[e.jsx(Tg,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:"No dose units created yet"}),d.status==="RELEASED"&&e.jsx(nr,{to:"/dispensing",className:"btn btn-primary",children:"Create Dose Units"})]})]}),l==="qc"&&e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"QC Results"}),d.qcResults?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Test"}),e.jsx("th",{children:"Result"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Tested By"}),e.jsx("th",{children:"Tested At"})]})}),e.jsx("tbody",{children:d.qcResults.map($=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:$.template?.testName})}),e.jsx("td",{children:$.numericResult||$.textResult||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${$.passed?"success":$.passed===!1?"danger":"default"}`,children:$.passed?"PASSED":$.passed===!1?"FAILED":"PENDING"})}),e.jsx("td",{children:$.testedBy?`${$.testedBy.firstName} ${$.testedBy.lastName}`:"-"}),e.jsx("td",{children:$.testedAt?Of($.testedAt,"MMM dd HH:mm"):"-"})]},$.id))})]}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:[e.jsx(Wl,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:"No QC results yet"}),["QC_PENDING","QC_IN_PROGRESS"].includes(d.status)&&e.jsx(nr,{to:"/qc",className:"btn btn-primary",children:"Enter QC Results"})]})]}),l==="release"&&e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"QP Release"}),d.batchReleases?.length>0?e.jsx("div",{children:d.batchReleases.map($=>e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem",borderLeft:"4px solid var(--success)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:["Released by ",$.releasedBy?.firstName," ",$.releasedBy?.lastName]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:Of($.signatureTimestamp,"MMM dd, yyyy HH:mm:ss")}),$.reason&&e.jsx("div",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:$.reason})]}),e.jsx("div",{children:e.jsx("span",{className:"badge badge-success",children:$.releaseType})})]})},$.id))}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:[e.jsx(aa,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:"Batch not yet released"}),d.status==="QP_REVIEW"&&e.jsx(nr,{to:"/release",className:"btn btn-primary",children:"Go to QP Release"})]})]}),l==="logistics"&&e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Logistics & Shipment"}),d.orders?.some($=>$.shipmentId)?e.jsx("div",{children:d.orders.filter($=>$.shipmentId).map($=>e.jsxs("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{fontWeight:600},children:["Order: ",$.orderNumber]}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:["Shipment ID: ",$.shipmentId]}),e.jsx(nr,{to:"/shipments",className:"btn btn-secondary btn-sm",style:{marginTop:"0.5rem"},children:"View Shipment"})]},$.id))}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:[e.jsx(dn,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:"No shipments created yet"}),["DISPENSED","PACKED"].includes(d.status)&&e.jsx(nr,{to:"/shipments",className:"btn btn-primary",children:"Create Shipment"})]})]}),t&&e.jsx(mc,{entityType:"BATCH",entityId:t,title:"Batch Attachments"})]})]})}const pC=[{id:"creation",title:"Order Creation",description:"Customer places order through portal or internal order desk",icon:Fo,color:"#3b82f6",status:"DRAFT",substeps:[{title:"Customer Portal",description:"Book capacity and submit order request"},{title:"Order Desk",description:"Create order manually for walk-in customers"},{title:"Capacity Reservation",description:"Reserve delivery window slot"}]},{id:"approval",title:"Order Approval",description:"Multi-level approval workflow for order validation",icon:sf,color:"#8b5cf6",status:"PENDING_APPROVAL  APPROVED",substeps:[{title:"Order Desk Review",description:"Validate order details and availability"},{title:"Manager Approval",description:"Approve high-value or special orders"},{title:"Customer Notification",description:"Notify customer of approval status"}]},{id:"planning",title:"Production Planning",description:"Schedule production based on delivery time and product half-life",icon:$n,color:"#06b6d4",status:"SCHEDULED",substeps:[{title:"Backward Scheduling",description:"Calculate production start based on decay"},{title:"Batch Creation",description:"Create batch with recipe/BOM assignment"},{title:"Equipment Allocation",description:"Reserve equipment and resources"},{title:"eBR Generation",description:"Generate electronic batch record"}]},{id:"manufacturing",title:"Manufacturing",description:"Execute production following GMP-compliant batch record",icon:lu,color:"#f59e0b",status:"IN_PRODUCTION",substeps:[{title:"Material Consumption",description:"Consume raw materials from inventory"},{title:"Step Execution",description:"Follow eBR steps with electronic signatures"},{title:"Deviation Recording",description:"Document any process deviations"},{title:"Production Complete",description:"Mark batch ready for QC"}]},{id:"quality",title:"Quality Control",description:"Test product quality and obtain QP release",icon:Bi,color:"#10b981",status:"QC_PENDING  QC_PASSED  RELEASED",substeps:[{title:"QC Testing",description:"Run product-specific quality tests"},{title:"Auto-Evaluation",description:"Automatic pass/fail determination"},{title:"OOS Investigation",description:"Investigate out-of-spec results"},{title:"QP Release",description:"Qualified Person batch release"}]},{id:"dispensing",title:"Dose Dispensing",description:"Dispense individual doses with decay-corrected activity",icon:Bf,color:"#ec4899",status:"DISPENSED",substeps:[{title:"Activity Calculation",description:"Calculate decay-corrected activity"},{title:"Dose Dispensing",description:"Dispense patient-specific doses"},{title:"Label Printing",description:"Print dose labels with QR codes"},{title:"Packaging",description:"Package doses for delivery"}]},{id:"logistics",title:"Logistics & Delivery",description:"Ship doses to customer with real-time tracking",icon:dn,color:"#6366f1",status:"SHIPPED  DELIVERED",substeps:[{title:"Shipment Creation",description:"Create shipment with assigned driver"},{title:"Driver Pickup",description:"Driver collects package from facility"},{title:"In Transit",description:"Real-time GPS tracking"},{title:"Delivery Confirmation",description:"Customer signature and POD"}]},{id:"invoicing",title:"Invoicing & Payment",description:"Generate ZATCA-compliant invoice and process payment",icon:td,color:"#f97316",status:"INVOICED  PAID",substeps:[{title:"Invoice Generation",description:"Apply contract pricing and generate invoice"},{title:"ZATCA QR Code",description:"Generate compliant QR code"},{title:"Payment Submission",description:"Customer submits payment with proof"},{title:"Payment Confirmation",description:"Finance confirms and generates receipt"}]},{id:"complete",title:"Order Complete",description:"Full audit trail and analytics updated",icon:uY,color:"#22c55e",status:"COMPLETED",substeps:[{title:"Audit Trail",description:"Complete history of all actions"},{title:"Reports Update",description:"Analytics and KPIs updated"},{title:"Customer Feedback",description:"Optional satisfaction survey"}]}];function rNe(){const[t,r]=k.useState(["creation"]),n=s=>{r(o=>o.includes(s)?o.filter(l=>l!==s):[...o,s])},i=()=>r(pC.map(s=>s.id)),a=()=>r([]);return e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Order Journey"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:"Complete lifecycle of an order from creation to completion"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-outline btn-sm",onClick:i,children:"Expand All"}),e.jsx("button",{className:"btn btn-outline btn-sm",onClick:a,children:"Collapse All"})]})]}),e.jsxs("div",{className:"card",style:{padding:"2rem"},children:[e.jsx("div",{style:{position:"relative"},children:pC.map((s,o)=>{const l=t.includes(s.id),u=s.icon,d=o===pC.length-1;return e.jsxs("div",{style:{position:"relative"},children:[!d&&e.jsx("div",{style:{position:"absolute",left:"24px",top:"48px",bottom:l?"0":"-24px",width:"2px",backgroundColor:"var(--border)",zIndex:0}}),e.jsxs("div",{onClick:()=>n(s.id),style:{display:"flex",alignItems:"flex-start",gap:"1rem",cursor:"pointer",padding:"0.75rem",borderRadius:"0.5rem",transition:"background-color 0.2s",position:"relative",zIndex:1},className:"hover-bg",children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:s.color,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(u,{size:24,color:"white"})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("h3",{style:{margin:0,fontSize:"1.125rem",fontWeight:600},children:[o+1,". ",s.title]}),l?e.jsx(qo,{size:18}):e.jsx(bo,{size:18})]}),e.jsx("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)",fontSize:"0.875rem"},children:s.description}),s.status&&e.jsxs("div",{style:{marginTop:"0.5rem",display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem 0.5rem",backgroundColor:`${s.color}15`,borderRadius:"0.25rem",fontSize:"0.75rem",fontFamily:"monospace",color:s.color},children:[e.jsx(Qt,{size:12}),s.status]})]})]}),l&&s.substeps&&e.jsx("div",{style:{marginLeft:"72px",marginTop:"0.5rem",marginBottom:"1.5rem",paddingLeft:"1rem",borderLeft:`2px solid ${s.color}40`},children:s.substeps.map((f,p)=>e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",padding:"0.5rem 0"},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:`${s.color}20`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:600,color:s.color,flexShrink:0},children:String.fromCharCode(97+p)}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.875rem"},children:f.title}),f.description&&e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:f.description})]})]},p))}),!d&&!l&&e.jsx("div",{style:{height:"1rem"}})]},s.id)})}),e.jsxs("div",{style:{marginTop:"2rem",padding:"1.5rem",backgroundColor:"var(--background-secondary)",borderRadius:"0.75rem"},children:[e.jsxs("h4",{style:{margin:"0 0 1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(e2,{size:20}),"Status Flow Summary"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",fontSize:"0.8125rem",fontFamily:"monospace"},children:["DRAFT","PENDING_APPROVAL","APPROVED","SCHEDULED","IN_PRODUCTION","QC_PENDING","QC_PASSED","RELEASED","DISPENSED","SHIPPED","DELIVERED","INVOICED","PAID","COMPLETED"].map((s,o,l)=>e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"var(--background)",borderRadius:"0.25rem",border:"1px solid var(--border)"},children:s}),o<l.length-1&&e.jsx("span",{style:{color:"var(--text-muted)"},children:""})]},s))})]}),e.jsxs("div",{style:{marginTop:"1.5rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"rgba(59, 130, 246, 0.1)",borderRadius:"0.5rem",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(dc,{size:18,color:"#3b82f6"}),e.jsx("span",{style:{fontWeight:600,color:"#3b82f6"},children:"Key Roles"})]}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Customer, Order Desk, Planner, Production, QC, QP, Logistics, Driver, Finance"})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"rgba(16, 185, 129, 0.1)",borderRadius:"0.5rem",border:"1px solid rgba(16, 185, 129, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Ir,{size:18,color:"#10b981"}),e.jsx("span",{style:{fontWeight:600,color:"#10b981"},children:"Documents"})]}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Order Form, eBR, QC Report, Release Certificate, Invoice, Receipt"})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"rgba(245, 158, 11, 0.1)",borderRadius:"0.5rem",border:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Qt,{size:18,color:"#f59e0b"}),e.jsx("span",{style:{fontWeight:600,color:"#f59e0b"},children:"Time-Critical"})]}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Radioactive decay requires precise scheduling and delivery timing"})]})]})]})]})}function nNe(){const{user:t}=Il(),r=Gr(),{data:n,isLoading:i,isError:a,error:s,refetch:o,isFetching:l}=Ve({queryKey:["portal-orders"],queryFn:async()=>{const{data:w}=await xe.get("/orders",{params:{limit:20}});return w}}),{data:u}=Ve({queryKey:["portal-invoices"],queryFn:async()=>{const{data:w}=await xe.get("/invoices",{params:{limit:5}});return w}});if(a)return e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(Hr,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Failed to load dashboard"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:s instanceof Error?s.message:"An error occurred while loading your dashboard."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>o(),children:"Try Again"})]});if(i)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[1,2,3,4].map(w=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},w))}),e.jsx("div",{className:"card skeleton",style:{height:"120px",marginBottom:"1.5rem"}}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[1,2].map(w=>e.jsx("div",{className:"card skeleton",style:{height:"300px"}},w))})]});const d={totalOrders:n?.length||0,activeOrders:n?.filter(w=>!["DELIVERED","CANCELLED","REJECTED"].includes(w.status)).length||0,deliveredOrders:n?.filter(w=>w.status==="DELIVERED").length||0,pendingInvoices:u?.filter(w=>["SENT","PARTIALLY_PAID"].includes(w.status)).length||0},f=(n||[]).reduce((w,C)=>(w[C.status]=(w[C.status]||0)+1,w),{}),p=[{id:"submitted",label:"Submitted",count:f.SUBMITTED||0,color:"blue",linkTo:"/portal/orders?status=SUBMITTED"},{id:"confirmed",label:"Confirmed",count:f.VALIDATED||0,color:"blue",linkTo:"/portal/orders?status=VALIDATED"},{id:"scheduled",label:"Scheduled",count:f.SCHEDULED||0,color:"blue",linkTo:"/portal/orders?status=SCHEDULED"},{id:"in_production",label:"In Production",count:f.IN_PRODUCTION||0,color:"yellow",linkTo:"/portal/orders?status=IN_PRODUCTION"},{id:"dispatched",label:"Dispatched",count:f.DISPATCHED||0,color:"teal",linkTo:"/portal/orders?status=DISPATCHED"},{id:"delivered",label:"Delivered",count:f.DELIVERED||0,color:"green",linkTo:"/portal/orders?status=DELIVERED"}],x=(n||[]).filter(w=>{const C=new Date(w.deliveryDate),A=new Date;return C.toDateString()===A.toDateString()&&!["DELIVERED","CANCELLED"].includes(w.status)}).map(w=>({id:w.id,identifier:w.orderNumber,title:w.product?.name||"Unknown Product",eta:w.deliveryDate,status:w.status,nextAction:"Track",linkTo:`/portal/orders/${w.id}/journey`})),v=(n||[]).filter(w=>w.status==="DISPATCHED").map(w=>({id:w.id,identifier:w.orderNumber,title:w.product?.name||"Unknown Product",subtitle:"In Transit",eta:w.deliveryDate,status:w.status,nextAction:"Track Shipment",linkTo:`/portal/orders/${w.id}/journey`}));return e.jsxs("div",{children:[e.jsx(s0,{title:`Welcome back, ${t?.firstName}!`,subtitle:"Manage your radiopharmaceutical orders and track deliveries",lastRefreshed:new Date,onRefresh:()=>o(),isRefreshing:l,actions:e.jsxs(nr,{to:"/portal/orders/new",className:"btn btn-primary",style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(cn,{size:18})," Place New Order"]})}),t?.customerName&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",backgroundColor:"rgba(13, 148, 136, 0.1)",borderRadius:"0.5rem",marginBottom:"1.5rem",border:"1px solid rgba(13, 148, 136, 0.2)"},children:[e.jsx(Ts,{size:18,style:{color:"#0d9488"}}),e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Viewing portal for: "}),e.jsx("span",{style:{fontWeight:600,color:"#0d9488"},children:t.customerName})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Orders",value:d.totalOrders,icon:e.jsx(Fo,{size:20}),color:"primary",linkTo:"/portal/orders"}),e.jsx(nt,{title:"In Progress",value:d.activeOrders,icon:e.jsx(Qt,{size:20}),color:"warning",linkTo:"/portal/orders?active=true"}),e.jsx(nt,{title:"Delivered",value:d.deliveredOrders,icon:e.jsx(Ft,{size:20}),color:"success",linkTo:"/portal/orders?status=DELIVERED"}),e.jsx(nt,{title:"Pending Invoices",value:d.pendingInvoices,icon:e.jsx(td,{size:20}),color:d.pendingInvoices>0?"danger":"info",linkTo:"/portal/invoices"})]}),e.jsx(Hz,{title:"My Orders Journey",stages:p}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(Tc,{title:"Arriving Today",items:x,viewAllLink:"/portal/orders?due=today",maxItems:5,icon:e.jsx(Rr,{size:18,style:{color:"#0d9488"}}),accentColor:"#0d9488",emptyMessage:"No orders arriving today"}),e.jsx(Tc,{title:"In Transit",items:v,viewAllLink:"/portal/orders?status=DISPATCHED",maxItems:5,icon:e.jsx(dn,{size:18,style:{color:"#0891b2"}}),accentColor:"#0891b2",emptyMessage:"No orders in transit"})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"Recent Orders"}),e.jsx(nr,{to:"/portal/orders",className:"btn btn-sm btn-secondary",children:"View All"})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Delivery"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[n?.slice(0,5).map(w=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>r(`/portal/orders/${w.id}/journey`),children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:w.orderNumber}),e.jsx("td",{children:w.product?.name}),e.jsx("td",{style:{fontSize:"0.875rem"},children:Ze(new Date(w.deliveryDate),"MMM d")}),e.jsx("td",{children:e.jsx(Pn,{status:w.status,size:"sm"})})]},w.id)),(!n||n.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No orders yet. Place your first order!"})})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"Recent Invoices"}),e.jsx(nr,{to:"/portal/invoices",className:"btn btn-sm btn-secondary",children:"View All"})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice #"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[u?.slice(0,5).map(w=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.8125rem"},children:w.invoiceNumber}),e.jsx("td",{style:{fontSize:"0.875rem"},children:Ze(new Date(w.invoiceDate),"MMM d, yyyy")}),e.jsx("td",{style:{fontWeight:500},children:ci(w.totalAmount)}),e.jsx("td",{children:e.jsx(Pn,{status:w.status,size:"sm"})})]},w.id)),(!u||u.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No invoices yet"})})]})]})]})]})]})}function iNe(){const[t,r]=k.useState(""),{data:n,isLoading:i}=Ve({queryKey:["portal-orders",t],queryFn:async()=>{const o={};t&&(o.status=t);const{data:l}=await xe.get("/orders",{params:o});return l}}),a=o=>({DRAFT:"default",SUBMITTED:"info",VALIDATED:"info",SCHEDULED:"info",IN_PRODUCTION:"warning",QC_PENDING:"warning",RELEASED:"success",DISPATCHED:"info",DELIVERED:"success",CANCELLED:"danger",REJECTED:"danger"})[o]||"default",s=o=>{switch(o){case"DELIVERED":return e.jsx(Ft,{size:16,style:{color:"var(--success)"}});case"DISPATCHED":return e.jsx(dn,{size:16,style:{color:"var(--primary)"}});case"CANCELLED":case"REJECTED":return e.jsx(ri,{size:16,style:{color:"var(--danger)"}});default:return e.jsx(Qt,{size:16,style:{color:"var(--warning)"}})}};return i?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem"},children:"My Orders"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"View and track all your radiopharmaceutical orders"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("select",{className:"form-select",style:{width:"auto"},value:t,onChange:o=>r(o.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"VALIDATED",children:"Validated"}),e.jsx("option",{value:"SCHEDULED",children:"Scheduled"}),e.jsx("option",{value:"IN_PRODUCTION",children:"In Production"}),e.jsx("option",{value:"RELEASED",children:"Released"}),e.jsx("option",{value:"DISPATCHED",children:"Dispatched"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"})]}),e.jsxs(nr,{to:"/portal/orders/new",className:"btn btn-primary",children:[e.jsx(cn,{size:18})," Place Order"]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Delivery Date"}),e.jsx("th",{children:"Delivery Time"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{style:{width:"80px"},children:"Track"})]})}),e.jsxs("tbody",{children:[n?.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Rr,{size:16,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontFamily:"monospace",fontWeight:500},children:o.orderNumber})]})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:o.product?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:o.product?.radionuclide})]}),e.jsxs("td",{style:{fontWeight:500},children:[o.requestedActivity," ",o.activityUnit]}),e.jsx("td",{children:Ze(new Date(o.deliveryDate),"MMM d, yyyy")}),e.jsxs("td",{children:[Ze(new Date(o.deliveryTimeStart),"HH:mm")," - ",Ze(new Date(o.deliveryTimeEnd),"HH:mm")]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s(o.status),e.jsx("span",{className:`badge badge-${a(o.status)}`,children:o.status.replace("_"," ")})]})}),e.jsx("td",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:Ze(new Date(o.createdAt),"MMM d, yyyy")}),e.jsx("td",{children:e.jsx(nr,{to:`/portal/orders/${o.id}/journey`,className:"btn btn-sm btn-outline",title:"Track Order",children:e.jsx(_a,{size:14})})})]},o.id)),(!n||n.length===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:8,style:{textAlign:"center",padding:"3rem"},children:[e.jsx(Rr,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"No orders found"}),e.jsxs(nr,{to:"/portal/orders/new",className:"btn btn-primary",children:[e.jsx(cn,{size:16})," Place Your First Order"]})]})})]})]})})]})}function aNe(){const t=Gr(),r=pr(),{user:n}=Il(),[i,a]=k.useState(1),[s,o]=k.useState({productId:"",requestedActivity:"",activityUnit:"mCi",deliveryDate:Ze(hl(new Date,2),"yyyy-MM-dd"),deliveryTimeStart:"09:00",deliveryTimeEnd:"10:00",priority:"NORMAL",notes:""}),[l,u]=k.useState(""),[d,f]=k.useState(!1),{data:p}=Ve({queryKey:["portal-profile"],queryFn:async()=>{const{data:T}=await xe.get("/portal/profile");return T}}),{data:x}=Ve({queryKey:["products"],queryFn:async()=>{const{data:T}=await xe.get("/products");return T}}),v=x?.find(T=>T.id===s.productId),w=ot({mutationFn:async T=>xe.post("/orders",T),onSuccess:()=>{r.invalidateQueries({queryKey:["portal-orders"]}),f(!0),setTimeout(()=>{t("/portal/orders")},2e3)},onError:T=>{u(T.response?.data?.error||"Failed to create order")}}),C=()=>{if(!s.productId||!s.requestedActivity){u("Please fill in all required fields");return}const T=new Date(s.deliveryDate);w.mutate({productId:s.productId,requestedActivity:parseFloat(s.requestedActivity),activityUnit:s.activityUnit,deliveryDate:T.toISOString(),deliveryTimeStart:new Date(`${s.deliveryDate}T${s.deliveryTimeStart}`).toISOString(),deliveryTimeEnd:new Date(`${s.deliveryDate}T${s.deliveryTimeEnd}`).toISOString(),priority:s.priority,notes:s.notes||void 0})};if(d)return e.jsx("div",{style:{maxWidth:"600px",margin:"4rem auto",textAlign:"center"},children:e.jsxs("div",{className:"card",style:{padding:"3rem"},children:[e.jsx(Ft,{size:64,style:{color:"var(--success)",marginBottom:"1.5rem"}}),e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.5rem"},children:"Order Submitted!"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Your order has been submitted successfully and is pending approval."}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Redirecting to your orders..."})]})});const A=p?.nameEn||p?.name||n?.customerName||"Your Facility";return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem"},children:"Place New Order"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"Order radiopharmaceuticals for your facility"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"1rem 1.25rem",backgroundColor:"rgba(13, 148, 136, 0.1)",borderRadius:"0.5rem",marginBottom:"1.5rem",border:"1px solid rgba(13, 148, 136, 0.2)"},children:[e.jsx(Ts,{size:20,style:{color:"#0d9488"}}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Ordering as: "}),e.jsx("span",{style:{fontWeight:600,color:"#0d9488"},children:A})]})]}),e.jsx("div",{style:{display:"flex",marginBottom:"2rem",gap:"0.5rem"},children:[1,2,3].map(T=>e.jsx("div",{style:{flex:1,height:"4px",borderRadius:"2px",backgroundColor:i>=T?"#0d9488":"var(--border)",transition:"background-color 0.3s"}},T))}),l&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"0.5rem",marginBottom:"1.5rem",color:"var(--danger)"},children:[e.jsx(sn,{size:20}),l]}),e.jsxs("div",{className:"card",style:{padding:"2rem"},children:[i===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1.5rem"},children:[e.jsx(Rr,{size:24,style:{color:"#0d9488"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem"},children:"Select Product"})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Product *"}),e.jsxs("select",{className:"form-select",value:s.productId,onChange:T=>o({...s,productId:T.target.value}),style:{fontSize:"1rem",padding:"0.875rem"},children:[e.jsx("option",{value:"",children:"Choose a radiopharmaceutical..."}),x?.map(T=>e.jsxs("option",{value:T.id,children:[T.name," (",T.radionuclide,")"]},T.id))]})]}),v&&e.jsx("div",{style:{backgroundColor:"var(--background-secondary)",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Type"}),e.jsx("div",{style:{fontWeight:500},children:v.productType})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Half-Life"}),e.jsxs("div",{style:{fontWeight:500},children:[v.halfLifeMinutes," min"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Standard Dose"}),e.jsxs("div",{style:{fontWeight:500},children:[v.standardDose," ",v.doseUnit]})]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"2fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Requested Activity *"}),e.jsx("input",{type:"number",className:"form-input",value:s.requestedActivity,onChange:T=>o({...s,requestedActivity:T.target.value}),placeholder:"e.g., 10",step:"0.1",style:{fontSize:"1rem",padding:"0.875rem"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Unit"}),e.jsxs("select",{className:"form-select",value:s.activityUnit,onChange:T=>o({...s,activityUnit:T.target.value}),style:{fontSize:"1rem",padding:"0.875rem"},children:[e.jsx("option",{value:"mCi",children:"mCi"}),e.jsx("option",{value:"MBq",children:"MBq"}),e.jsx("option",{value:"GBq",children:"GBq"})]})]})]})]}),i===2&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1.5rem"},children:[e.jsx($n,{size:24,style:{color:"#0d9488"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem"},children:"Delivery Schedule"})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Delivery Date *"}),e.jsx("input",{type:"date",className:"form-input",value:s.deliveryDate,onChange:T=>o({...s,deliveryDate:T.target.value}),min:Ze(hl(new Date,1),"yyyy-MM-dd"),style:{fontSize:"1rem",padding:"0.875rem"}})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Delivery Window Start *"}),e.jsx("input",{type:"time",className:"form-input",value:s.deliveryTimeStart,onChange:T=>o({...s,deliveryTimeStart:T.target.value}),style:{fontSize:"1rem",padding:"0.875rem"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Delivery Window End *"}),e.jsx("input",{type:"time",className:"form-input",value:s.deliveryTimeEnd,onChange:T=>o({...s,deliveryTimeEnd:T.target.value}),style:{fontSize:"1rem",padding:"0.875rem"}})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{className:"form-select",value:s.priority,onChange:T=>o({...s,priority:T.target.value}),style:{fontSize:"1rem",padding:"0.875rem"},children:[e.jsx("option",{value:"NORMAL",children:"Normal"}),e.jsx("option",{value:"URGENT",children:"Urgent"}),e.jsx("option",{value:"STAT",children:"STAT (Emergency)"})]})]})]}),i===3&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1.5rem"},children:[e.jsx(Ft,{size:24,style:{color:"#0d9488"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem"},children:"Review & Submit"})]}),e.jsxs("div",{style:{backgroundColor:"var(--background-secondary)",padding:"1.5rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{fontWeight:600,marginBottom:"1rem"},children:"Order Summary"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Product"}),e.jsx("div",{style:{fontWeight:500},children:v?.name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Activity"}),e.jsxs("div",{style:{fontWeight:500},children:[s.requestedActivity," ",s.activityUnit]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Delivery Date"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(s.deliveryDate),"MMMM d, yyyy")})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Delivery Time"}),e.jsxs("div",{style:{fontWeight:500},children:[s.deliveryTimeStart," - ",s.deliveryTimeEnd]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Priority"}),e.jsx("div",{style:{fontWeight:500},children:s.priority})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Special Instructions (Optional)"}),e.jsx("textarea",{className:"form-input",value:s.notes,onChange:T=>o({...s,notes:T.target.value}),rows:3,placeholder:"Any special delivery instructions or patient-specific requirements...",style:{fontSize:"1rem",padding:"0.875rem"}})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"2rem",paddingTop:"1.5rem",borderTop:"1px solid var(--border)"},children:[i>1?e.jsx("button",{className:"btn btn-outline",onClick:()=>a(i-1),style:{padding:"0.75rem 1.5rem"},children:"Back"}):e.jsx("button",{className:"btn btn-outline",onClick:()=>t("/portal/orders"),style:{padding:"0.75rem 1.5rem"},children:"Cancel"}),i<3?e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(u(""),i===1&&(!s.productId||!s.requestedActivity)){u("Please select a product and enter activity");return}a(i+1)},style:{padding:"0.75rem 1.5rem",backgroundColor:"#0d9488"},children:"Continue"}):e.jsx("button",{className:"btn btn-primary",onClick:C,disabled:w.isPending,style:{padding:"0.75rem 1.5rem",backgroundColor:"#0d9488"},children:w.isPending?"Submitting...":"Submit Order"})]})]})]})}function sNe(){const t=pr(),[r,n]=k.useState(null),[i,a]=k.useState(""),[s,o]=k.useState(!1),[l,u]=k.useState({amount:"",paymentMethod:"BANK_TRANSFER",reference:"",notes:"",proofFile:null}),d=k.useRef(null),{data:f,isLoading:p}=Ve({queryKey:["portal-invoices",i],queryFn:async()=>{const Q={};i&&(Q.status=i);const{data:U}=await xe.get("/portal/invoices",{params:Q});return U}}),{data:x,refetch:v}=Ve({queryKey:["portal-invoice-detail",r?.id],queryFn:async()=>{if(!r?.id)return null;const{data:Q}=await xe.get(`/portal/invoices/${r.id}`);return Q},enabled:!!r?.id}),w=ot({mutationFn:async Q=>{const{data:U}=await xe.post("/portal/payments",Q,{headers:{"Content-Type":"multipart/form-data"}});return U},onSuccess:()=>{Ki.success("Payment submitted successfully! Awaiting confirmation."),t.invalidateQueries({queryKey:["portal-invoices"]}),v(),o(!1),u({amount:"",paymentMethod:"BANK_TRANSFER",reference:"",notes:"",proofFile:null})},onError:Q=>{Ki.error(Q.response?.data?.error||"Failed to submit payment")}}),C=()=>{if(!r||!l.amount){Ki.error("Please enter payment amount");return}if(!l.proofFile){Ki.error("Payment proof is required");return}const Q=new FormData;Q.append("invoiceId",r.id),Q.append("amount",l.amount),Q.append("paymentMethod",l.paymentMethod),Q.append("reference",l.reference),Q.append("notes",l.notes),Q.append("proofFile",l.proofFile),w.mutate(Q)},A={total:f?.reduce((Q,U)=>Q+U.totalAmount,0)||0,paid:f?.reduce((Q,U)=>Q+U.paidAmount,0)||0,outstanding:f?.reduce((Q,U)=>Q+(U.totalAmount-U.paidAmount),0)||0,overdue:f?.filter(Q=>Q.status==="OVERDUE"||["SENT","PARTIALLY_PAID"].includes(Q.status)&&new Date(Q.dueDate)<new Date).length||0},T=(Q,U)=>["SENT","PARTIALLY_PAID"].includes(Q)&&new Date(U)<new Date?"danger":{DRAFT:"default",SENT:"warning",PAID:"success",PARTIALLY_PAID:"warning",OVERDUE:"danger",CANCELLED:"danger"}[Q]||"default",O=Q=>{const U={PENDING:{color:"warning",icon:Qt},CONFIRMED:{color:"success",icon:Ft},REJECTED:{color:"danger",icon:ri}},{color:$,icon:ee}=U[Q]||{color:"default",icon:Qt};return e.jsxs("span",{className:`badge badge-${$}`,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ee,{size:12}),Q]})},D=r?r.totalAmount-r.paidAmount:0,M=r&&["SENT","ISSUED_POSTED","PARTIALLY_PAID","OVERDUE"].includes(r.status)&&D>0;return p?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem"},children:"Invoices"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"View and manage your billing history"})]}),e.jsxs("select",{className:"form-select",style:{width:"auto"},value:i,onChange:Q=>a(Q.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"SENT",children:"Pending"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"PARTIALLY_PAID",children:"Partially Paid"}),e.jsx("option",{value:"OVERDUE",children:"Overdue"})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{className:"card",style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(13, 148, 136, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(td,{size:20,style:{color:"#0d9488"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600},children:ci(A.total)}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Total Billed"})]})]})}),e.jsx("div",{className:"card",style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(34, 197, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ft,{size:20,style:{color:"var(--success)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--success)"},children:ci(A.paid)}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Paid"})]})]})}),e.jsx("div",{className:"card",style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(234, 179, 8, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ul,{size:20,style:{color:"var(--warning)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--warning)"},children:ci(A.outstanding)}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Outstanding"})]})]})}),e.jsx("div",{className:"card",style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(239, 68, 68, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(sn,{size:20,style:{color:"var(--danger)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--danger)"},children:A.overdue}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Overdue"})]})]})})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:r?"1fr 420px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{className:"card",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice #"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Paid"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"60px"},children:"View"})]})}),e.jsxs("tbody",{children:[f?.map(Q=>{const U=["SENT","PARTIALLY_PAID"].includes(Q.status)&&new Date(Q.dueDate)<new Date;return e.jsxs("tr",{style:{cursor:"pointer",backgroundColor:r?.id===Q.id?"var(--background-secondary)":void 0},onClick:()=>n(Q),children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:Q.invoiceNumber}),e.jsx("td",{children:Ze(new Date(Q.invoiceDate),"MMM d, yyyy")}),e.jsx("td",{style:{color:U?"var(--danger)":void 0},children:Ze(new Date(Q.dueDate),"MMM d, yyyy")}),e.jsx("td",{style:{fontWeight:500},children:ci(Q.totalAmount)}),e.jsx("td",{style:{color:Q.paidAmount>0?"var(--success)":"var(--text-muted)"},children:ci(Q.paidAmount)}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${T(Q.status,Q.dueDate)}`,children:U?"OVERDUE":Q.status})}),e.jsx("td",{onClick:$=>$.stopPropagation(),children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>n(Q),children:e.jsx(os,{size:14})})})]},Q.id)}),(!f||f.length===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:7,style:{textAlign:"center",padding:"3rem"},children:[e.jsx(td,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"No invoices found"})]})})]})]})}),r&&e.jsxs("div",{className:"card",style:{padding:0,maxHeight:"calc(100vh - 240px)",overflowY:"auto",width:"380px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Invoice Details"}),e.jsx("button",{onClick:()=>n(null),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem"},children:e.jsx(Dr,{size:18,style:{color:"var(--text-muted)"}})})]}),e.jsxs("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(13, 148, 136, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(td,{size:20,style:{color:"#0d9488"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:r.invoiceNumber}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:600},children:Ze(new Date(r.invoiceDate),"MMMM d, yyyy")})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.625rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Status"}),e.jsx("span",{className:`badge badge-${T(r.status,r.dueDate)}`,children:r.status.replace(/_/g," ")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Due Date"}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500},children:Ze(new Date(r.dueDate),"MMM d, yyyy")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Total Amount"}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:600,color:"#0d9488"},children:ci(r.totalAmount)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Paid"}),e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--success)"},children:ci(r.paidAmount)})]}),D>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Balance Due"}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:600,color:"var(--danger)"},children:ci(D)})]})]})]}),e.jsxs("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h4",{style:{fontSize:"0.8125rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Line Items"}),(x?.items||r.items)?.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:(x?.items||r.items)?.map(Q=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"0.875rem"},children:Q.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Qty: ",Q.quantity]})]}),e.jsx("span",{style:{fontWeight:500,fontSize:"0.875rem"},children:ci(Q.lineTotal)})]},Q.id))}):e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",textAlign:"center",padding:"1rem"},children:"No line items"}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:"Subtotal"}),e.jsx("span",{style:{fontSize:"0.875rem"},children:ci(x?.vatBreakdown?.subtotal||r.subtotal)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:["VAT (",x?.vatBreakdown?.vatRate||15,"%)"]}),e.jsx("span",{style:{fontSize:"0.875rem"},children:ci(x?.vatBreakdown?.vatAmount||r.taxAmount)})]}),(x?.vatBreakdown?.discount>0||r.discountAmount>0)&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8125rem",color:"var(--success)"},children:"Discount"}),e.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--success)"},children:["- ",ci(x?.vatBreakdown?.discount||r.discountAmount)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"0.5rem",borderTop:"1px solid var(--border)",marginTop:"0.25rem"},children:[e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:600},children:"Grand Total"}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:700,color:"#0d9488"},children:ci(x?.vatBreakdown?.grandTotal||r.totalAmount)})]})]})]}),e.jsx("div",{style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn",style:{flex:1,background:"var(--bg-secondary)",border:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.875rem"},onClick:async()=>{try{const Q=await xe.get(`/invoice-pdf/${r.id}`,{responseType:"blob"}),U=new Blob([Q.data],{type:"application/pdf"}),$=window.URL.createObjectURL(U),ee=document.createElement("a");ee.href=$,ee.download=`Invoice-${r.invoiceNumber}.pdf`,document.body.appendChild(ee),ee.click(),window.URL.revokeObjectURL($),document.body.removeChild(ee)}catch{Ki.error("Failed to download PDF")}},children:[e.jsx(BY,{size:16}),"Download PDF"]}),M&&e.jsxs("button",{className:"btn",style:{flex:1,background:"#0d9488",borderColor:"#0d9488",color:"white",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.875rem"},onClick:()=>{u(Q=>({...Q,amount:D.toString()})),o(!0)},children:[e.jsx(Ul,{size:16}),"Pay Now"]})]})}),x?.paymentRequests?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{fontWeight:600,marginTop:"1.5rem",marginBottom:"0.75rem",fontSize:"0.875rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)"},children:"Payment Requests"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:x.paymentRequests.map(Q=>e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--background-secondary)",borderRadius:"0.5rem",borderLeft:`3px solid ${Q.status==="CONFIRMED"?"var(--success)":Q.status==="REJECTED"?"var(--danger)":"var(--warning)"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[e.jsx("span",{style:{fontWeight:500},children:ci(Q.amount)}),O(Q.status)]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[Ze(new Date(Q.submittedAt),"MMM d, yyyy HH:mm")," via ",Q.paymentMethod.replace("_"," ")]}),Q.reference&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Ref: ",Q.reference]}),Q.status==="REJECTED"&&Q.rejectReason&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--danger)",marginTop:"0.25rem"},children:["Reason: ",Q.rejectReason]})]},Q.id))})]}),(x?.payments?.length>0||r.payments?.length>0)&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{fontWeight:600,marginTop:"1.5rem",marginBottom:"0.75rem",fontSize:"0.875rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)"},children:"Confirmed Payments"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Method"}),e.jsx("th",{children:"Amount"})]})}),e.jsx("tbody",{children:(x?.payments||r.payments).map(Q=>e.jsxs("tr",{children:[e.jsx("td",{children:Ze(new Date(Q.paymentDate),"MMM d, yyyy")}),e.jsx("td",{children:Q.paymentMethod.replace("_"," ")}),e.jsx("td",{style:{fontWeight:500,color:"var(--success)"},children:ci(Q.amount)})]},Q.id))})]})]})]})]}),s&&e.jsx("div",{className:"modal-overlay",onClick:()=>o(!1),children:e.jsxs("div",{className:"modal",onClick:Q=>Q.stopPropagation(),style:{maxWidth:"480px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:"Submit Payment"}),e.jsx("button",{className:"modal-close",onClick:()=>o(!1),children:e.jsx(Dr,{size:20})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{backgroundColor:"var(--background-secondary)",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Invoice"}),e.jsx("div",{style:{fontWeight:600},children:r?.invoiceNumber}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Balance Due: ",ci(D)]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Payment Amount (SAR) *"}),e.jsx("input",{type:"number",className:"form-input",value:l.amount,onChange:Q=>u(U=>({...U,amount:Q.target.value})),max:D,step:"0.01"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Payment Method *"}),e.jsxs("select",{className:"form-select",value:l.paymentMethod,onChange:Q=>u(U=>({...U,paymentMethod:Q.target.value})),children:[e.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer"}),e.jsx("option",{value:"CREDIT_CARD",children:"Credit Card"}),e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Transaction Reference"}),e.jsx("input",{type:"text",className:"form-input",value:l.reference,onChange:Q=>u(U=>({...U,reference:Q.target.value})),placeholder:"e.g., Bank transfer reference number"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Payment Proof ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"file",ref:d,style:{display:"none"},accept:".png,.jpg,.jpeg,.pdf",onChange:Q=>{const U=Q.target.files?.[0];if(U){if(U.size>10*1024*1024){Ki.error("File size must be less than 10MB");return}u($=>({...$,proofFile:U}))}}}),e.jsx("div",{onClick:()=>d.current?.click(),style:{border:"2px dashed var(--border)",borderRadius:"0.5rem",padding:"1.5rem",textAlign:"center",cursor:"pointer",backgroundColor:l.proofFile?"rgba(13, 148, 136, 0.05)":void 0},children:l.proofFile?e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[e.jsx(Ir,{size:20,style:{color:"#0d9488"}}),e.jsx("span",{children:l.proofFile.name}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:Q=>{Q.stopPropagation(),u(U=>({...U,proofFile:null}))},children:e.jsx(Dr,{size:14})})]}):e.jsxs(e.Fragment,{children:[e.jsx(om,{size:24,style:{color:"var(--text-muted)",marginBottom:"0.5rem"}}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:["Click to upload payment proof",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.75rem"},children:"PNG, JPG or PDF up to 10MB"})]})]})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-textarea",value:l.notes,onChange:Q=>u(U=>({...U,notes:Q.target.value})),placeholder:"Any additional notes for finance team",rows:2})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:C,disabled:w.isPending||!l.amount||!l.proofFile,children:w.isPending?"Submitting...":"Submit Payment"})]})]})})]})}function oNe(){const{id:t}=fl(),{data:r,isLoading:n,error:i}=Ve({queryKey:["portal-order-journey",t],queryFn:async()=>{const{data:w}=await xe.get(`/journey/orders/${t}/journey`);return w},enabled:!!t});if(n)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(i||!r)return e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"3rem"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h3",{style:{marginBottom:"0.5rem"},children:"Order Not Found"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"The order you're looking for doesn't exist or you don't have access to it."}),e.jsx(nr,{to:"/portal/orders",className:"btn btn-primary",children:"Back to Orders"})]});const{order:a,events:s,milestones:o}=r,l=s.filter(w=>!["QC_TEST_ENTERED","BATCH_ASSIGNED"].includes(w.type)&&w.actorRole!=="QC Analyst").map(w=>({...w,actor:void 0,actorRole:void 0})),u=o.filter(w=>["SUBMITTED","SCHEDULED","IN_PRODUCTION","RELEASED","DISPATCHED","DELIVERED"].includes(w.key)).map(w=>({...w,label:w.key==="IN_PRODUCTION"?"Processing":w.label})),d=()=>u.map(w=>({key:w.key,label:w.label,completed:w.completed})),f=()=>{const w=d();for(let C=w.length-1;C>=0;C--)if(w[C].completed)return w[C].key;return w[0]?.key||"SUBMITTED"},p=()=>l.map(w=>{let C=w.title;return w.type==="STATUS_CHANGE"&&w.toStatus&&(C={SUBMITTED:"Order submitted",VALIDATED:"Order validated",SCHEDULED:"Production scheduled",IN_PRODUCTION:"Processing started",QC_PENDING:"Quality check in progress",QC_PASSED:"Quality check passed",QP_REVIEW:"Final review in progress",RELEASED:"Order ready for dispatch",DISPATCHED:"Order dispatched",IN_TRANSIT:"In transit",DELIVERED:"Delivered"}[w.toStatus]||w.title),{id:w.id,type:w.type,title:C,description:w.type==="CREATED"?`Order ${a.orderNumber}`:void 0,timestamp:w.timestamp,severity:w.severity}}),v=(()=>{const w=s.filter(T=>T.entityType==="shipment");if(w.length===0)return null;const C=w.find(T=>T.type==="DISPATCHED"),A=w.find(T=>T.type==="DELIVERED");return{dispatched:C,delivered:A}})();return e.jsxs("div",{children:[e.jsxs(nr,{to:"/portal/orders",style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",textDecoration:"none",marginBottom:"1rem",fontSize:"0.875rem"},children:[e.jsx(sa,{size:16})," Back to Orders"]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"1.5rem"},children:e.jsxs("div",{children:[e.jsxs("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:["Order ",a.orderNumber,e.jsx(Pn,{status:a.status})]}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Track the progress of your order"})]})}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.5rem"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",marginBottom:"1.25rem"},children:"Order Progress"}),e.jsx(Uz,{steps:d(),currentStep:f()})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 320px",gap:"1.5rem"},children:[e.jsx("div",{children:e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Timeline"})}),e.jsx("div",{style:{padding:"1.5rem"},children:e.jsx(Wz,{events:p(),maxVisible:20})})]})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{className:"card",style:{padding:0},children:[e.jsx("div",{style:{padding:"0.875rem 1rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,fontSize:"0.9375rem",margin:0},children:"Order Details"})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(13, 148, 136, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Rr,{size:20,style:{color:"#0d9488"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:a.productCode||"Product"}),e.jsx("div",{style:{fontSize:"0.9375rem",fontWeight:600},children:a.product})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(MA,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Doses"})]}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:600},children:a.numberOfDoses||1})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Mc,{size:12,style:{color:"#0d9488"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Activity"})]}),e.jsxs("span",{style:{fontSize:"0.8125rem",fontWeight:600,color:"#0d9488"},children:[a.requestedActivity," ",a.activityUnit||"mCi"]})]}),a.hospitalOrderReference&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Ts,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Reference"})]}),e.jsx("span",{style:{fontSize:"0.8125rem"},children:a.hospitalOrderReference})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx($n,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivery Window"})]}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:a.deliveryTimeStart&&a.deliveryTimeEnd?`${Ze(new Date(a.deliveryTimeStart),"HH:mm")} - ${Ze(new Date(a.deliveryTimeEnd),"HH:mm")}`:a.deliveryTime?Ze(new Date(a.deliveryTime),"HH:mm"):"N/A"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx($n,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivery Date"})]}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:500},children:a.deliveryDate?Ze(new Date(a.deliveryDate),"MMM d, yyyy"):"N/A"})]}),a.estimatedDispatchTime&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(dn,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Est. Dispatch"})]}),e.jsx("span",{style:{fontSize:"0.8125rem"},children:Ze(new Date(a.estimatedDispatchTime),"MMM d, HH:mm")})]}),a.estimatedDeliveryTime&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(_a,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Est. Arrival"})]}),e.jsx("span",{style:{fontSize:"0.8125rem"},children:Ze(new Date(a.estimatedDeliveryTime),"MMM d, HH:mm")})]})]}),a.specialNotes&&e.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"6px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Ir,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Special Notes"})]}),e.jsx("p",{style:{fontSize:"0.8125rem",margin:0,color:"var(--text-secondary)"},children:a.specialNotes})]})]})]}),v&&e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(dn,{size:18,style:{color:"var(--primary)"}}),"Shipment Tracking"]})}),e.jsx("div",{style:{padding:"1rem 1.5rem"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[v.dispatched&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Ft,{size:18,style:{color:"var(--success)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Dispatched"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(v.dispatched.timestamp),"MMM d, yyyy HH:mm")})]})]}),v.delivered?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Ft,{size:18,style:{color:"var(--success)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivered"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(v.delivered.timestamp),"MMM d, yyyy HH:mm")})]})]}):v.dispatched?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",backgroundColor:"rgba(234, 179, 8, 0.1)",borderRadius:"var(--radius)"},children:[e.jsx(Qt,{size:18,style:{color:"var(--warning)"}}),e.jsx("div",{style:{fontWeight:500,color:"var(--warning)"},children:"In Transit"})]}):null]})})]}),e.jsxs("div",{className:"card",style:{padding:0},children:[e.jsx("div",{style:{padding:"0.875rem 1rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"0.9375rem",margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(e0,{size:16,style:{color:"#0d9488"}}),"Communication"]})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",margin:"0 0 0.75rem 0"},children:"Have questions about this order? Open a support ticket to communicate with our team."}),e.jsxs(nr,{to:`/portal/helpdesk/new?subject=Order ${a.orderNumber}&orderId=${a.id}`,className:"btn",style:{width:"100%",boxSizing:"border-box",background:"#0d9488",borderColor:"#0d9488",color:"white",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.625rem 1rem",fontSize:"0.8125rem",fontWeight:600,textDecoration:"none"},children:[e.jsx(Qi,{size:14}),"Contact Support"]})]})]})]})]})]})}var Sg={exports:{}};var lNe=Sg.exports,oM;function cNe(){return oM||(oM=1,(function(t,r){(function(n,i){i(r)})(lNe,(function(n){var i="1.9.4";function a(y){var E,z,ie,me;for(z=1,ie=arguments.length;z<ie;z++){me=arguments[z];for(E in me)y[E]=me[E]}return y}var s=Object.create||(function(){function y(){}return function(E){return y.prototype=E,new y}})();function o(y,E){var z=Array.prototype.slice;if(y.bind)return y.bind.apply(y,z.call(arguments,1));var ie=z.call(arguments,2);return function(){return y.apply(E,ie.length?ie.concat(z.call(arguments)):arguments)}}var l=0;function u(y){return"_leaflet_id"in y||(y._leaflet_id=++l),y._leaflet_id}function d(y,E,z){var ie,me,Ee,Fe;return Fe=function(){ie=!1,me&&(Ee.apply(z,me),me=!1)},Ee=function(){ie?me=arguments:(y.apply(z,arguments),setTimeout(Fe,E),ie=!0)},Ee}function f(y,E,z){var ie=E[1],me=E[0],Ee=ie-me;return y===ie&&z?y:((y-me)%Ee+Ee)%Ee+me}function p(){return!1}function x(y,E){if(E===!1)return y;var z=Math.pow(10,E===void 0?6:E);return Math.round(y*z)/z}function v(y){return y.trim?y.trim():y.replace(/^\s+|\s+$/g,"")}function w(y){return v(y).split(/\s+/)}function C(y,E){Object.prototype.hasOwnProperty.call(y,"options")||(y.options=y.options?s(y.options):{});for(var z in E)y.options[z]=E[z];return y.options}function A(y,E,z){var ie=[];for(var me in y)ie.push(encodeURIComponent(z?me.toUpperCase():me)+"="+encodeURIComponent(y[me]));return(!E||E.indexOf("?")===-1?"?":"&")+ie.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function O(y,E){return y.replace(T,function(z,ie){var me=E[ie];if(me===void 0)throw new Error("No value provided for variable "+z);return typeof me=="function"&&(me=me(E)),me})}var D=Array.isArray||function(y){return Object.prototype.toString.call(y)==="[object Array]"};function M(y,E){for(var z=0;z<y.length;z++)if(y[z]===E)return z;return-1}var Q="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(y){return window["webkit"+y]||window["moz"+y]||window["ms"+y]}var $=0;function ee(y){var E=+new Date,z=Math.max(0,16-(E-$));return $=E+z,window.setTimeout(y,z)}var F=window.requestAnimationFrame||U("RequestAnimationFrame")||ee,Y=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(y){window.clearTimeout(y)};function J(y,E,z){if(z&&F===ee)y.call(E);else return F.call(window,o(y,E))}function Z(y){y&&Y.call(window,y)}var re={__proto__:null,extend:a,create:s,bind:o,get lastId(){return l},stamp:u,throttle:d,wrapNum:f,falseFn:p,formatNum:x,trim:v,splitWords:w,setOptions:C,getParamString:A,template:O,isArray:D,indexOf:M,emptyImageUrl:Q,requestFn:F,cancelFn:Y,requestAnimFrame:J,cancelAnimFrame:Z};function de(){}de.extend=function(y){var E=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},z=E.__super__=this.prototype,ie=s(z);ie.constructor=E,E.prototype=ie;for(var me in this)Object.prototype.hasOwnProperty.call(this,me)&&me!=="prototype"&&me!=="__super__"&&(E[me]=this[me]);return y.statics&&a(E,y.statics),y.includes&&(le(y.includes),a.apply(null,[ie].concat(y.includes))),a(ie,y),delete ie.statics,delete ie.includes,ie.options&&(ie.options=z.options?s(z.options):{},a(ie.options,y.options)),ie._initHooks=[],ie.callInitHooks=function(){if(!this._initHooksCalled){z.callInitHooks&&z.callInitHooks.call(this),this._initHooksCalled=!0;for(var Ee=0,Fe=ie._initHooks.length;Ee<Fe;Ee++)ie._initHooks[Ee].call(this)}},E},de.include=function(y){var E=this.prototype.options;return a(this.prototype,y),y.options&&(this.prototype.options=E,this.mergeOptions(y.options)),this},de.mergeOptions=function(y){return a(this.prototype.options,y),this},de.addInitHook=function(y){var E=Array.prototype.slice.call(arguments,1),z=typeof y=="function"?y:function(){this[y].apply(this,E)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(z),this};function le(y){if(!(typeof L>"u"||!L||!L.Mixin)){y=D(y)?y:[y];for(var E=0;E<y.length;E++)y[E]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(y,E,z){if(typeof y=="object")for(var ie in y)this._on(ie,y[ie],E);else{y=w(y);for(var me=0,Ee=y.length;me<Ee;me++)this._on(y[me],E,z)}return this},off:function(y,E,z){if(!arguments.length)delete this._events;else if(typeof y=="object")for(var ie in y)this._off(ie,y[ie],E);else{y=w(y);for(var me=arguments.length===1,Ee=0,Fe=y.length;Ee<Fe;Ee++)me?this._off(y[Ee]):this._off(y[Ee],E,z)}return this},_on:function(y,E,z,ie){if(typeof E!="function"){console.warn("wrong listener type: "+typeof E);return}if(this._listens(y,E,z)===!1){z===this&&(z=void 0);var me={fn:E,ctx:z};ie&&(me.once=!0),this._events=this._events||{},this._events[y]=this._events[y]||[],this._events[y].push(me)}},_off:function(y,E,z){var ie,me,Ee;if(this._events&&(ie=this._events[y],!!ie)){if(arguments.length===1){if(this._firingCount)for(me=0,Ee=ie.length;me<Ee;me++)ie[me].fn=p;delete this._events[y];return}if(typeof E!="function"){console.warn("wrong listener type: "+typeof E);return}var Fe=this._listens(y,E,z);if(Fe!==!1){var tt=ie[Fe];this._firingCount&&(tt.fn=p,this._events[y]=ie=ie.slice()),ie.splice(Fe,1)}}},fire:function(y,E,z){if(!this.listens(y,z))return this;var ie=a({},E,{type:y,target:this,sourceTarget:E&&E.sourceTarget||this});if(this._events){var me=this._events[y];if(me){this._firingCount=this._firingCount+1||1;for(var Ee=0,Fe=me.length;Ee<Fe;Ee++){var tt=me[Ee],mt=tt.fn;tt.once&&this.off(y,mt,tt.ctx),mt.call(tt.ctx||this,ie)}this._firingCount--}}return z&&this._propagateEvent(ie),this},listens:function(y,E,z,ie){typeof y!="string"&&console.warn('"string" type argument expected');var me=E;typeof E!="function"&&(ie=!!E,me=void 0,z=void 0);var Ee=this._events&&this._events[y];if(Ee&&Ee.length&&this._listens(y,me,z)!==!1)return!0;if(ie){for(var Fe in this._eventParents)if(this._eventParents[Fe].listens(y,E,z,ie))return!0}return!1},_listens:function(y,E,z){if(!this._events)return!1;var ie=this._events[y]||[];if(!E)return!!ie.length;z===this&&(z=void 0);for(var me=0,Ee=ie.length;me<Ee;me++)if(ie[me].fn===E&&ie[me].ctx===z)return me;return!1},once:function(y,E,z){if(typeof y=="object")for(var ie in y)this._on(ie,y[ie],E,!0);else{y=w(y);for(var me=0,Ee=y.length;me<Ee;me++)this._on(y[me],E,z,!0)}return this},addEventParent:function(y){return this._eventParents=this._eventParents||{},this._eventParents[u(y)]=y,this},removeEventParent:function(y){return this._eventParents&&delete this._eventParents[u(y)],this},_propagateEvent:function(y){for(var E in this._eventParents)this._eventParents[E].fire(y.type,a({layer:y.target,propagatedFrom:y.target},y),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var ue=de.extend(K);function ce(y,E,z){this.x=z?Math.round(y):y,this.y=z?Math.round(E):E}var ye=Math.trunc||function(y){return y>0?Math.floor(y):Math.ceil(y)};ce.prototype={clone:function(){return new ce(this.x,this.y)},add:function(y){return this.clone()._add(Se(y))},_add:function(y){return this.x+=y.x,this.y+=y.y,this},subtract:function(y){return this.clone()._subtract(Se(y))},_subtract:function(y){return this.x-=y.x,this.y-=y.y,this},divideBy:function(y){return this.clone()._divideBy(y)},_divideBy:function(y){return this.x/=y,this.y/=y,this},multiplyBy:function(y){return this.clone()._multiplyBy(y)},_multiplyBy:function(y){return this.x*=y,this.y*=y,this},scaleBy:function(y){return new ce(this.x*y.x,this.y*y.y)},unscaleBy:function(y){return new ce(this.x/y.x,this.y/y.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ye(this.x),this.y=ye(this.y),this},distanceTo:function(y){y=Se(y);var E=y.x-this.x,z=y.y-this.y;return Math.sqrt(E*E+z*z)},equals:function(y){return y=Se(y),y.x===this.x&&y.y===this.y},contains:function(y){return y=Se(y),Math.abs(y.x)<=Math.abs(this.x)&&Math.abs(y.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function Se(y,E,z){return y instanceof ce?y:D(y)?new ce(y[0],y[1]):y==null?y:typeof y=="object"&&"x"in y&&"y"in y?new ce(y.x,y.y):new ce(y,E,z)}function V(y,E){if(y)for(var z=E?[y,E]:y,ie=0,me=z.length;ie<me;ie++)this.extend(z[ie])}V.prototype={extend:function(y){var E,z;if(!y)return this;if(y instanceof ce||typeof y[0]=="number"||"x"in y)E=z=Se(y);else if(y=X(y),E=y.min,z=y.max,!E||!z)return this;return!this.min&&!this.max?(this.min=E.clone(),this.max=z.clone()):(this.min.x=Math.min(E.x,this.min.x),this.max.x=Math.max(z.x,this.max.x),this.min.y=Math.min(E.y,this.min.y),this.max.y=Math.max(z.y,this.max.y)),this},getCenter:function(y){return Se((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,y)},getBottomLeft:function(){return Se(this.min.x,this.max.y)},getTopRight:function(){return Se(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(y){var E,z;return typeof y[0]=="number"||y instanceof ce?y=Se(y):y=X(y),y instanceof V?(E=y.min,z=y.max):E=z=y,E.x>=this.min.x&&z.x<=this.max.x&&E.y>=this.min.y&&z.y<=this.max.y},intersects:function(y){y=X(y);var E=this.min,z=this.max,ie=y.min,me=y.max,Ee=me.x>=E.x&&ie.x<=z.x,Fe=me.y>=E.y&&ie.y<=z.y;return Ee&&Fe},overlaps:function(y){y=X(y);var E=this.min,z=this.max,ie=y.min,me=y.max,Ee=me.x>E.x&&ie.x<z.x,Fe=me.y>E.y&&ie.y<z.y;return Ee&&Fe},isValid:function(){return!!(this.min&&this.max)},pad:function(y){var E=this.min,z=this.max,ie=Math.abs(E.x-z.x)*y,me=Math.abs(E.y-z.y)*y;return X(Se(E.x-ie,E.y-me),Se(z.x+ie,z.y+me))},equals:function(y){return y?(y=X(y),this.min.equals(y.getTopLeft())&&this.max.equals(y.getBottomRight())):!1}};function X(y,E){return!y||y instanceof V?y:new V(y,E)}function se(y,E){if(y)for(var z=E?[y,E]:y,ie=0,me=z.length;ie<me;ie++)this.extend(z[ie])}se.prototype={extend:function(y){var E=this._southWest,z=this._northEast,ie,me;if(y instanceof oe)ie=y,me=y;else if(y instanceof se){if(ie=y._southWest,me=y._northEast,!ie||!me)return this}else return y?this.extend(ge(y)||W(y)):this;return!E&&!z?(this._southWest=new oe(ie.lat,ie.lng),this._northEast=new oe(me.lat,me.lng)):(E.lat=Math.min(ie.lat,E.lat),E.lng=Math.min(ie.lng,E.lng),z.lat=Math.max(me.lat,z.lat),z.lng=Math.max(me.lng,z.lng)),this},pad:function(y){var E=this._southWest,z=this._northEast,ie=Math.abs(E.lat-z.lat)*y,me=Math.abs(E.lng-z.lng)*y;return new se(new oe(E.lat-ie,E.lng-me),new oe(z.lat+ie,z.lng+me))},getCenter:function(){return new oe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new oe(this.getNorth(),this.getWest())},getSouthEast:function(){return new oe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(y){typeof y[0]=="number"||y instanceof oe||"lat"in y?y=ge(y):y=W(y);var E=this._southWest,z=this._northEast,ie,me;return y instanceof se?(ie=y.getSouthWest(),me=y.getNorthEast()):ie=me=y,ie.lat>=E.lat&&me.lat<=z.lat&&ie.lng>=E.lng&&me.lng<=z.lng},intersects:function(y){y=W(y);var E=this._southWest,z=this._northEast,ie=y.getSouthWest(),me=y.getNorthEast(),Ee=me.lat>=E.lat&&ie.lat<=z.lat,Fe=me.lng>=E.lng&&ie.lng<=z.lng;return Ee&&Fe},overlaps:function(y){y=W(y);var E=this._southWest,z=this._northEast,ie=y.getSouthWest(),me=y.getNorthEast(),Ee=me.lat>E.lat&&ie.lat<z.lat,Fe=me.lng>E.lng&&ie.lng<z.lng;return Ee&&Fe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(y,E){return y?(y=W(y),this._southWest.equals(y.getSouthWest(),E)&&this._northEast.equals(y.getNorthEast(),E)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function W(y,E){return y instanceof se?y:new se(y,E)}function oe(y,E,z){if(isNaN(y)||isNaN(E))throw new Error("Invalid LatLng object: ("+y+", "+E+")");this.lat=+y,this.lng=+E,z!==void 0&&(this.alt=+z)}oe.prototype={equals:function(y,E){if(!y)return!1;y=ge(y);var z=Math.max(Math.abs(this.lat-y.lat),Math.abs(this.lng-y.lng));return z<=(E===void 0?1e-9:E)},toString:function(y){return"LatLng("+x(this.lat,y)+", "+x(this.lng,y)+")"},distanceTo:function(y){return Le.distance(this,ge(y))},wrap:function(){return Le.wrapLatLng(this)},toBounds:function(y){var E=180*y/40075017,z=E/Math.cos(Math.PI/180*this.lat);return W([this.lat-E,this.lng-z],[this.lat+E,this.lng+z])},clone:function(){return new oe(this.lat,this.lng,this.alt)}};function ge(y,E,z){return y instanceof oe?y:D(y)&&typeof y[0]!="object"?y.length===3?new oe(y[0],y[1],y[2]):y.length===2?new oe(y[0],y[1]):null:y==null?y:typeof y=="object"&&"lat"in y?new oe(y.lat,"lng"in y?y.lng:y.lon,y.alt):E===void 0?null:new oe(y,E,z)}var be={latLngToPoint:function(y,E){var z=this.projection.project(y),ie=this.scale(E);return this.transformation._transform(z,ie)},pointToLatLng:function(y,E){var z=this.scale(E),ie=this.transformation.untransform(y,z);return this.projection.unproject(ie)},project:function(y){return this.projection.project(y)},unproject:function(y){return this.projection.unproject(y)},scale:function(y){return 256*Math.pow(2,y)},zoom:function(y){return Math.log(y/256)/Math.LN2},getProjectedBounds:function(y){if(this.infinite)return null;var E=this.projection.bounds,z=this.scale(y),ie=this.transformation.transform(E.min,z),me=this.transformation.transform(E.max,z);return new V(ie,me)},infinite:!1,wrapLatLng:function(y){var E=this.wrapLng?f(y.lng,this.wrapLng,!0):y.lng,z=this.wrapLat?f(y.lat,this.wrapLat,!0):y.lat,ie=y.alt;return new oe(z,E,ie)},wrapLatLngBounds:function(y){var E=y.getCenter(),z=this.wrapLatLng(E),ie=E.lat-z.lat,me=E.lng-z.lng;if(ie===0&&me===0)return y;var Ee=y.getSouthWest(),Fe=y.getNorthEast(),tt=new oe(Ee.lat-ie,Ee.lng-me),mt=new oe(Fe.lat-ie,Fe.lng-me);return new se(tt,mt)}},Le=a({},be,{wrapLng:[-180,180],R:6371e3,distance:function(y,E){var z=Math.PI/180,ie=y.lat*z,me=E.lat*z,Ee=Math.sin((E.lat-y.lat)*z/2),Fe=Math.sin((E.lng-y.lng)*z/2),tt=Ee*Ee+Math.cos(ie)*Math.cos(me)*Fe*Fe,mt=2*Math.atan2(Math.sqrt(tt),Math.sqrt(1-tt));return this.R*mt}}),ke=6378137,He={R:ke,MAX_LATITUDE:85.0511287798,project:function(y){var E=Math.PI/180,z=this.MAX_LATITUDE,ie=Math.max(Math.min(z,y.lat),-z),me=Math.sin(ie*E);return new ce(this.R*y.lng*E,this.R*Math.log((1+me)/(1-me))/2)},unproject:function(y){var E=180/Math.PI;return new oe((2*Math.atan(Math.exp(y.y/this.R))-Math.PI/2)*E,y.x*E/this.R)},bounds:(function(){var y=ke*Math.PI;return new V([-y,-y],[y,y])})()};function Je(y,E,z,ie){if(D(y)){this._a=y[0],this._b=y[1],this._c=y[2],this._d=y[3];return}this._a=y,this._b=E,this._c=z,this._d=ie}Je.prototype={transform:function(y,E){return this._transform(y.clone(),E)},_transform:function(y,E){return E=E||1,y.x=E*(this._a*y.x+this._b),y.y=E*(this._c*y.y+this._d),y},untransform:function(y,E){return E=E||1,new ce((y.x/E-this._b)/this._a,(y.y/E-this._d)/this._c)}};function Qe(y,E,z,ie){return new Je(y,E,z,ie)}var vt=a({},Le,{code:"EPSG:3857",projection:He,transformation:(function(){var y=.5/(Math.PI*He.R);return Qe(y,.5,-y,.5)})()}),Pt=a({},vt,{code:"EPSG:900913"});function Oe(y){return document.createElementNS("http://www.w3.org/2000/svg",y)}function st(y,E){var z="",ie,me,Ee,Fe,tt,mt;for(ie=0,Ee=y.length;ie<Ee;ie++){for(tt=y[ie],me=0,Fe=tt.length;me<Fe;me++)mt=tt[me],z+=(me?"L":"M")+mt.x+" "+mt.y;z+=E?$t.svg?"z":"x":""}return z||"M0 0"}var Wt=document.documentElement.style,Bt="ActiveXObject"in window,yt=Bt&&!document.addEventListener,rr="msLaunchUri"in navigator&&!("documentMode"in document),St=Xr("webkit"),xr=Xr("android"),hr=Xr("android 2")||Xr("android 3"),zr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),yn=xr&&Xr("Google")&&zr<537&&!("AudioNode"in window),Or=!!window.opera,xn=!rr&&Xr("chrome"),Yr=Xr("gecko")&&!St&&!Or&&!Bt,tr=!xn&&Xr("safari"),tn=Xr("phantom"),fr="OTransition"in Wt,Yi=navigator.platform.indexOf("Win")===0,Er=Bt&&"transition"in Wt,wt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!hr,sr="MozPerspective"in Wt,ur=!window.L_DISABLE_3D&&(Er||wt||sr)&&!fr&&!tn,Yt=typeof orientation<"u"||Xr("mobile"),Kn=Yt&&St,Fr=Yt&&wt,Kr=!window.PointerEvent&&window.MSPointerEvent,Sr=!!(window.PointerEvent||Kr),Qr="ontouchstart"in window||!!window.TouchEvent,_r=!window.L_NO_TOUCH&&(Qr||Sr),On=Yt&&Or,Zi=Yt&&Yr,Ia=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,vi=(function(){var y=!1;try{var E=Object.defineProperty({},"passive",{get:function(){y=!0}});window.addEventListener("testPassiveEventSupport",p,E),window.removeEventListener("testPassiveEventSupport",p,E)}catch{}return y})(),$a=(function(){return!!document.createElement("canvas").getContext})(),vr=!!(document.createElementNS&&Oe("svg").createSVGRect),Oa=!!vr&&(function(){var y=document.createElement("div");return y.innerHTML="<svg/>",(y.firstChild&&y.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ml=!vr&&(function(){try{var y=document.createElement("div");y.innerHTML='<v:shape adj="1"/>';var E=y.firstChild;return E.style.behavior="url(#default#VML)",E&&typeof E.adj=="object"}catch{return!1}})(),ga=navigator.platform.indexOf("Mac")===0,Ds=navigator.platform.indexOf("Linux")===0;function Xr(y){return navigator.userAgent.toLowerCase().indexOf(y)>=0}var $t={ie:Bt,ielt9:yt,edge:rr,webkit:St,android:xr,android23:hr,androidStock:yn,opera:Or,chrome:xn,gecko:Yr,safari:tr,phantom:tn,opera12:fr,win:Yi,ie3d:Er,webkit3d:wt,gecko3d:sr,any3d:ur,mobile:Yt,mobileWebkit:Kn,mobileWebkit3d:Fr,msPointer:Kr,pointer:Sr,touch:_r,touchNative:Qr,mobileOpera:On,mobileGecko:Zi,retina:Ia,passiveEvents:vi,canvas:$a,svg:vr,vml:ml,inlineSvg:Oa,mac:ga,linux:Ds},Qn=$t.msPointer?"MSPointerDown":"pointerdown",er=$t.msPointer?"MSPointerMove":"pointermove",Xi=$t.msPointer?"MSPointerUp":"pointerup",Yn=$t.msPointer?"MSPointerCancel":"pointercancel",vn={touchstart:Qn,touchmove:er,touchend:Xi,touchcancel:Yn},Fi={touchstart:Ka,touchmove:Ko,touchend:Ko,touchcancel:Ko},Ji={},cs=!1;function ds(y,E,z){return E==="touchstart"&&kn(),Fi[E]?(z=Fi[E].bind(this,z),y.addEventListener(vn[E],z,!1),z):(console.warn("wrong event specified:",E),p)}function $o(y,E,z){if(!vn[E]){console.warn("wrong event specified:",E);return}y.removeEventListener(vn[E],z,!1)}function Go(y){Ji[y.pointerId]=y}function Ga(y){Ji[y.pointerId]&&(Ji[y.pointerId]=y)}function fi(y){delete Ji[y.pointerId]}function kn(){cs||(document.addEventListener(Qn,Go,!0),document.addEventListener(er,Ga,!0),document.addEventListener(Xi,fi,!0),document.addEventListener(Yn,fi,!0),cs=!0)}function Ko(y,E){if(E.pointerType!==(E.MSPOINTER_TYPE_MOUSE||"mouse")){E.touches=[];for(var z in Ji)E.touches.push(Ji[z]);E.changedTouches=[E],y(E)}}function Ka(y,E){E.MSPOINTER_TYPE_TOUCH&&E.pointerType===E.MSPOINTER_TYPE_TOUCH&&mi(E),Ko(y,E)}function Oi(y){var E={},z,ie;for(ie in y)z=y[ie],E[ie]=z&&z.bind?z.bind(y):z;return y=E,E.type="dblclick",E.detail=2,E.isTrusted=!1,E._simulated=!0,E}var Rt=200;function io(y,E){y.addEventListener("dblclick",E);var z=0,ie;function me(Ee){if(Ee.detail!==1){ie=Ee.detail;return}if(!(Ee.pointerType==="mouse"||Ee.sourceCapabilities&&!Ee.sourceCapabilities.firesTouchEvents)){var Fe=Ja(Ee);if(!(Fe.some(function(mt){return mt instanceof HTMLLabelElement&&mt.attributes.for})&&!Fe.some(function(mt){return mt instanceof HTMLInputElement||mt instanceof HTMLSelectElement}))){var tt=Date.now();tt-z<=Rt?(ie++,ie===2&&E(Oi(Ee))):ie=1,z=tt}}}return y.addEventListener("click",me),{dblclick:E,simDblclick:me}}function zn(y,E){y.removeEventListener("dblclick",E.dblclick),y.removeEventListener("click",E.simDblclick)}var us=it(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),kl=it(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),_n=kl==="webkitTransition"||kl==="OTransition"?kl+"End":"transitionend";function An(y){return typeof y=="string"?document.getElementById(y):y}function on(y,E){var z=y.style[E]||y.currentStyle&&y.currentStyle[E];if((!z||z==="auto")&&document.defaultView){var ie=document.defaultView.getComputedStyle(y,null);z=ie?ie[E]:null}return z==="auto"?null:z}function Jr(y,E,z){var ie=document.createElement(y);return ie.className=E||"",z&&z.appendChild(ie),ie}function Rn(y){var E=y.parentNode;E&&E.removeChild(y)}function hs(y){for(;y.firstChild;)y.removeChild(y.firstChild)}function Mr(y){var E=y.parentNode;E&&E.lastChild!==y&&E.appendChild(y)}function Qa(y){var E=y.parentNode;E&&E.firstChild!==y&&E.insertBefore(y,E.firstChild)}function No(y,E){if(y.classList!==void 0)return y.classList.contains(E);var z=di(y);return z.length>0&&new RegExp("(^|\\s)"+E+"(\\s|$)").test(z)}function ir(y,E){if(y.classList!==void 0)for(var z=w(E),ie=0,me=z.length;ie<me;ie++)y.classList.add(z[ie]);else if(!No(y,E)){var Ee=di(y);Ya(y,(Ee?Ee+" ":"")+E)}}function Bn(y,E){y.classList!==void 0?y.classList.remove(E):Ya(y,v((" "+di(y)+" ").replace(" "+E+" "," ")))}function Ya(y,E){y.className.baseVal===void 0?y.className=E:y.className.baseVal=E}function di(y){return y.correspondingElement&&(y=y.correspondingElement),y.className.baseVal===void 0?y.className:y.className.baseVal}function kr(y,E){"opacity"in y.style?y.style.opacity=E:"filter"in y.style&&ea(y,E)}function ea(y,E){var z=!1,ie="DXImageTransform.Microsoft.Alpha";try{z=y.filters.item(ie)}catch{if(E===1)return}E=Math.round(E*100),z?(z.Enabled=E!==100,z.Opacity=E):y.style.filter+=" progid:"+ie+"(opacity="+E+")"}function it(y){for(var E=document.documentElement.style,z=0;z<y.length;z++)if(y[z]in E)return y[z];return!1}function Pe(y,E,z){var ie=E||new ce(0,0);y.style[us]=($t.ie3d?"translate("+ie.x+"px,"+ie.y+"px)":"translate3d("+ie.x+"px,"+ie.y+"px,0)")+(z?" scale("+z+")":"")}function Ht(y,E){y._leaflet_pos=E,$t.any3d?Pe(y,E):(y.style.left=E.x+"px",y.style.top=E.y+"px")}function ni(y){return y._leaflet_pos||new ce(0,0)}var la,Ps,Qo;if("onselectstart"in document)la=function(){qt(window,"selectstart",mi)},Ps=function(){Zt(window,"selectstart",mi)};else{var ya=it(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);la=function(){if(ya){var y=document.documentElement.style;Qo=y[ya],y[ya]="none"}},Ps=function(){ya&&(document.documentElement.style[ya]=Qo,Qo=void 0)}}function Cr(){qt(window,"dragstart",mi)}function Jn(){Zt(window,"dragstart",mi)}var Dl,qc;function ka(y){for(;y.tabIndex===-1;)y=y.parentNode;y.style&&(Za(),Dl=y,qc=y.style.outlineStyle,y.style.outlineStyle="none",qt(window,"keydown",Za))}function Za(){Dl&&(Dl.style.outlineStyle=qc,Dl=void 0,qc=void 0,Zt(window,"keydown",Za))}function Ao(y){do y=y.parentNode;while((!y.offsetWidth||!y.offsetHeight)&&y!==document.body);return y}function Pl(y){var E=y.getBoundingClientRect();return{x:E.width/y.offsetWidth||1,y:E.height/y.offsetHeight||1,boundingClientRect:E}}var bi={__proto__:null,TRANSFORM:us,TRANSITION:kl,TRANSITION_END:_n,get:An,getStyle:on,create:Jr,remove:Rn,empty:hs,toFront:Mr,toBack:Qa,hasClass:No,addClass:ir,removeClass:Bn,setClass:Ya,getClass:di,setOpacity:kr,testProp:it,setTransform:Pe,setPosition:Ht,getPosition:ni,get disableTextSelection(){return la},get enableTextSelection(){return Ps},disableImageDrag:Cr,enableImageDrag:Jn,preventOutline:ka,restoreOutline:Za,getSizedParentNode:Ao,getScale:Pl};function qt(y,E,z,ie){if(E&&typeof E=="object")for(var me in E)Tn(y,me,E[me],z);else{E=w(E);for(var Ee=0,Fe=E.length;Ee<Fe;Ee++)Tn(y,E[Ee],z,ie)}return this}var ca="_leaflet_events";function Zt(y,E,z,ie){if(arguments.length===1)ud(y),delete y[ca];else if(E&&typeof E=="object")for(var me in E)gc(y,me,E[me],z);else if(E=w(E),arguments.length===2)ud(y,function(tt){return M(E,tt)!==-1});else for(var Ee=0,Fe=E.length;Ee<Fe;Ee++)gc(y,E[Ee],z,ie);return this}function ud(y,E){for(var z in y[ca]){var ie=z.split(/\d/)[0];(!E||E(ie))&&gc(y,ie,null,null,z)}}var Lr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Tn(y,E,z,ie){var me=E+u(z)+(ie?"_"+u(ie):"");if(y[ca]&&y[ca][me])return this;var Ee=function(tt){return z.call(ie||y,tt||window.event)},Fe=Ee;!$t.touchNative&&$t.pointer&&E.indexOf("touch")===0?Ee=ds(y,E,Ee):$t.touch&&E==="dblclick"?Ee=io(y,Ee):"addEventListener"in y?E==="touchstart"||E==="touchmove"||E==="wheel"||E==="mousewheel"?y.addEventListener(Lr[E]||E,Ee,$t.passiveEvents?{passive:!1}:!1):E==="mouseenter"||E==="mouseleave"?(Ee=function(tt){tt=tt||window.event,ms(y,tt)&&Fe(tt)},y.addEventListener(Lr[E],Ee,!1)):y.addEventListener(E,Fe,!1):y.attachEvent("on"+E,Ee),y[ca]=y[ca]||{},y[ca][me]=Ee}function gc(y,E,z,ie,me){me=me||E+u(z)+(ie?"_"+u(ie):"");var Ee=y[ca]&&y[ca][me];if(!Ee)return this;!$t.touchNative&&$t.pointer&&E.indexOf("touch")===0?$o(y,E,Ee):$t.touch&&E==="dblclick"?zn(y,Ee):"removeEventListener"in y?y.removeEventListener(Lr[E]||E,Ee,!1):y.detachEvent("on"+E,Ee),y[ca][me]=null}function Rs(y){return y.stopPropagation?y.stopPropagation():y.originalEvent?y.originalEvent._stopped=!0:y.cancelBubble=!0,this}function fs(y){return Tn(y,"wheel",Rs),this}function Xa(y){return qt(y,"mousedown touchstart dblclick contextmenu",Rs),y._leaflet_disable_click=!0,this}function mi(y){return y.preventDefault?y.preventDefault():y.returnValue=!1,this}function Ks(y){return mi(y),Rs(y),this}function Ja(y){if(y.composedPath)return y.composedPath();for(var E=[],z=y.target;z;)E.push(z),z=z.parentNode;return E}function Yo(y,E){if(!E)return new ce(y.clientX,y.clientY);var z=Pl(E),ie=z.boundingClientRect;return new ce((y.clientX-ie.left)/z.x-E.clientLeft,(y.clientY-ie.top)/z.y-E.clientTop)}var yc=$t.linux&&$t.chrome?window.devicePixelRatio:$t.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ki(y){return $t.edge?y.wheelDeltaY/2:y.deltaY&&y.deltaMode===0?-y.deltaY/yc:y.deltaY&&y.deltaMode===1?-y.deltaY*20:y.deltaY&&y.deltaMode===2?-y.deltaY*60:y.deltaX||y.deltaZ?0:y.wheelDelta?(y.wheelDeltaY||y.wheelDelta)/2:y.detail&&Math.abs(y.detail)<32765?-y.detail*20:y.detail?y.detail/-32765*60:0}function ms(y,E){var z=E.relatedTarget;if(!z)return!0;try{for(;z&&z!==y;)z=z.parentNode}catch{return!1}return z!==y}var ji={__proto__:null,on:qt,off:Zt,stopPropagation:Rs,disableScrollPropagation:fs,disableClickPropagation:Xa,preventDefault:mi,stop:Ks,getPropagationPath:Ja,getMousePosition:Yo,getWheelDelta:ki,isExternalTarget:ms,addListener:qt,removeListener:Zt},Zo=ue.extend({run:function(y,E,z,ie){this.stop(),this._el=y,this._inProgress=!0,this._duration=z||.25,this._easeOutPower=1/Math.max(ie||.5,.2),this._startPos=ni(y),this._offset=E.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=J(this._animate,this),this._step()},_step:function(y){var E=+new Date-this._startTime,z=this._duration*1e3;E<z?this._runFrame(this._easeOut(E/z),y):(this._runFrame(1),this._complete())},_runFrame:function(y,E){var z=this._startPos.add(this._offset.multiplyBy(y));E&&z._round(),Ht(this._el,z),this.fire("step")},_complete:function(){Z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(y){return 1-Math.pow(1-y,this._easeOutPower)}}),mn=ue.extend({options:{crs:vt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(y,E){E=C(this,E),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(y),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),E.maxBounds&&this.setMaxBounds(E.maxBounds),E.zoom!==void 0&&(this._zoom=this._limitZoom(E.zoom)),E.center&&E.zoom!==void 0&&this.setView(ge(E.center),E.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=kl&&$t.any3d&&!$t.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),qt(this._proxy,_n,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(y,E,z){if(E=E===void 0?this._zoom:this._limitZoom(E),y=this._limitCenter(ge(y),E,this.options.maxBounds),z=z||{},this._stop(),this._loaded&&!z.reset&&z!==!0){z.animate!==void 0&&(z.zoom=a({animate:z.animate},z.zoom),z.pan=a({animate:z.animate,duration:z.duration},z.pan));var ie=this._zoom!==E?this._tryAnimatedZoom&&this._tryAnimatedZoom(y,E,z.zoom):this._tryAnimatedPan(y,z.pan);if(ie)return clearTimeout(this._sizeTimer),this}return this._resetView(y,E,z.pan&&z.pan.noMoveStart),this},setZoom:function(y,E){return this._loaded?this.setView(this.getCenter(),y,{zoom:E}):(this._zoom=y,this)},zoomIn:function(y,E){return y=y||($t.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+y,E)},zoomOut:function(y,E){return y=y||($t.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-y,E)},setZoomAround:function(y,E,z){var ie=this.getZoomScale(E),me=this.getSize().divideBy(2),Ee=y instanceof ce?y:this.latLngToContainerPoint(y),Fe=Ee.subtract(me).multiplyBy(1-1/ie),tt=this.containerPointToLatLng(me.add(Fe));return this.setView(tt,E,{zoom:z})},_getBoundsCenterZoom:function(y,E){E=E||{},y=y.getBounds?y.getBounds():W(y);var z=Se(E.paddingTopLeft||E.padding||[0,0]),ie=Se(E.paddingBottomRight||E.padding||[0,0]),me=this.getBoundsZoom(y,!1,z.add(ie));if(me=typeof E.maxZoom=="number"?Math.min(E.maxZoom,me):me,me===1/0)return{center:y.getCenter(),zoom:me};var Ee=ie.subtract(z).divideBy(2),Fe=this.project(y.getSouthWest(),me),tt=this.project(y.getNorthEast(),me),mt=this.unproject(Fe.add(tt).divideBy(2).add(Ee),me);return{center:mt,zoom:me}},fitBounds:function(y,E){if(y=W(y),!y.isValid())throw new Error("Bounds are not valid.");var z=this._getBoundsCenterZoom(y,E);return this.setView(z.center,z.zoom,E)},fitWorld:function(y){return this.fitBounds([[-90,-180],[90,180]],y)},panTo:function(y,E){return this.setView(y,this._zoom,{pan:E})},panBy:function(y,E){if(y=Se(y).round(),E=E||{},!y.x&&!y.y)return this.fire("moveend");if(E.animate!==!0&&!this.getSize().contains(y))return this._resetView(this.unproject(this.project(this.getCenter()).add(y)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Zo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),E.noMoveStart||this.fire("movestart"),E.animate!==!1){ir(this._mapPane,"leaflet-pan-anim");var z=this._getMapPanePos().subtract(y).round();this._panAnim.run(this._mapPane,z,E.duration||.25,E.easeLinearity)}else this._rawPanBy(y),this.fire("move").fire("moveend");return this},flyTo:function(y,E,z){if(z=z||{},z.animate===!1||!$t.any3d)return this.setView(y,E,z);this._stop();var ie=this.project(this.getCenter()),me=this.project(y),Ee=this.getSize(),Fe=this._zoom;y=ge(y),E=E===void 0?Fe:E;var tt=Math.max(Ee.x,Ee.y),mt=tt*this.getZoomScale(Fe,E),kt=me.distanceTo(ie)||1,Kt=1.42,br=Kt*Kt;function Cn(pi){var La=pi?-1:1,fd=pi?mt:tt,bf=mt*mt-tt*tt+La*br*br*kt*kt,Bd=2*fd*br*kt,Fd=bf/Bd,jc=Math.sqrt(Fd*Fd+1)-Fd,Zl=jc<1e-9?-18:Math.log(jc);return Zl}function Bs(pi){return(Math.exp(pi)-Math.exp(-pi))/2}function ba(pi){return(Math.exp(pi)+Math.exp(-pi))/2}function al(pi){return Bs(pi)/ba(pi)}var ii=Cn(0);function ai(pi){return tt*(ba(ii)/ba(ii+Kt*pi))}function Ln(pi){return tt*(ba(ii)*al(ii+Kt*pi)-Bs(ii))/br}function uo(pi){return 1-Math.pow(1-pi,1.5)}var ha=Date.now(),xl=(Cn(1)-ii)/Kt,Wc=z.duration?1e3*z.duration:1e3*xl*.8;function Nh(){var pi=(Date.now()-ha)/Wc,La=uo(pi)*xl;pi<=1?(this._flyToFrame=J(Nh,this),this._move(this.unproject(ie.add(me.subtract(ie).multiplyBy(Ln(La)/kt)),Fe),this.getScaleZoom(tt/ai(La),Fe),{flyTo:!0})):this._move(y,E)._moveEnd(!0)}return this._moveStart(!0,z.noMoveStart),Nh.call(this),this},flyToBounds:function(y,E){var z=this._getBoundsCenterZoom(y,E);return this.flyTo(z.center,z.zoom,E)},setMaxBounds:function(y){return y=W(y),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),y.isValid()?(this.options.maxBounds=y,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(y){var E=this.options.minZoom;return this.options.minZoom=y,this._loaded&&E!==y&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(y):this},setMaxZoom:function(y){var E=this.options.maxZoom;return this.options.maxZoom=y,this._loaded&&E!==y&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(y):this},panInsideBounds:function(y,E){this._enforcingBounds=!0;var z=this.getCenter(),ie=this._limitCenter(z,this._zoom,W(y));return z.equals(ie)||this.panTo(ie,E),this._enforcingBounds=!1,this},panInside:function(y,E){E=E||{};var z=Se(E.paddingTopLeft||E.padding||[0,0]),ie=Se(E.paddingBottomRight||E.padding||[0,0]),me=this.project(this.getCenter()),Ee=this.project(y),Fe=this.getPixelBounds(),tt=X([Fe.min.add(z),Fe.max.subtract(ie)]),mt=tt.getSize();if(!tt.contains(Ee)){this._enforcingBounds=!0;var kt=Ee.subtract(tt.getCenter()),Kt=tt.extend(Ee).getSize().subtract(mt);me.x+=kt.x<0?-Kt.x:Kt.x,me.y+=kt.y<0?-Kt.y:Kt.y,this.panTo(this.unproject(me),E),this._enforcingBounds=!1}return this},invalidateSize:function(y){if(!this._loaded)return this;y=a({animate:!1,pan:!0},y===!0?{animate:!0}:y);var E=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var z=this.getSize(),ie=E.divideBy(2).round(),me=z.divideBy(2).round(),Ee=ie.subtract(me);return!Ee.x&&!Ee.y?this:(y.animate&&y.pan?this.panBy(Ee):(y.pan&&this._rawPanBy(Ee),this.fire("move"),y.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:E,newSize:z}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(y){if(y=this._locateOptions=a({timeout:1e4,watch:!1},y),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var E=o(this._handleGeolocationResponse,this),z=o(this._handleGeolocationError,this);return y.watch?this._locationWatchId=navigator.geolocation.watchPosition(E,z,y):navigator.geolocation.getCurrentPosition(E,z,y),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(y){if(this._container._leaflet_id){var E=y.code,z=y.message||(E===1?"permission denied":E===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:E,message:"Geolocation error: "+z+"."})}},_handleGeolocationResponse:function(y){if(this._container._leaflet_id){var E=y.coords.latitude,z=y.coords.longitude,ie=new oe(E,z),me=ie.toBounds(y.coords.accuracy*2),Ee=this._locateOptions;if(Ee.setView){var Fe=this.getBoundsZoom(me);this.setView(ie,Ee.maxZoom?Math.min(Fe,Ee.maxZoom):Fe)}var tt={latlng:ie,bounds:me,timestamp:y.timestamp};for(var mt in y.coords)typeof y.coords[mt]=="number"&&(tt[mt]=y.coords[mt]);this.fire("locationfound",tt)}},addHandler:function(y,E){if(!E)return this;var z=this[y]=new E(this);return this._handlers.push(z),this.options[y]&&z.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Rn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var y;for(y in this._layers)this._layers[y].remove();for(y in this._panes)Rn(this._panes[y]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(y,E){var z="leaflet-pane"+(y?" leaflet-"+y.replace("Pane","")+"-pane":""),ie=Jr("div",z,E||this._mapPane);return y&&(this._panes[y]=ie),ie},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var y=this.getPixelBounds(),E=this.unproject(y.getBottomLeft()),z=this.unproject(y.getTopRight());return new se(E,z)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(y,E,z){y=W(y),z=Se(z||[0,0]);var ie=this.getZoom()||0,me=this.getMinZoom(),Ee=this.getMaxZoom(),Fe=y.getNorthWest(),tt=y.getSouthEast(),mt=this.getSize().subtract(z),kt=X(this.project(tt,ie),this.project(Fe,ie)).getSize(),Kt=$t.any3d?this.options.zoomSnap:1,br=mt.x/kt.x,Cn=mt.y/kt.y,Bs=E?Math.max(br,Cn):Math.min(br,Cn);return ie=this.getScaleZoom(Bs,ie),Kt&&(ie=Math.round(ie/(Kt/100))*(Kt/100),ie=E?Math.ceil(ie/Kt)*Kt:Math.floor(ie/Kt)*Kt),Math.max(me,Math.min(Ee,ie))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ce(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(y,E){var z=this._getTopLeftPoint(y,E);return new V(z,z.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(y){return this.options.crs.getProjectedBounds(y===void 0?this.getZoom():y)},getPane:function(y){return typeof y=="string"?this._panes[y]:y},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(y,E){var z=this.options.crs;return E=E===void 0?this._zoom:E,z.scale(y)/z.scale(E)},getScaleZoom:function(y,E){var z=this.options.crs;E=E===void 0?this._zoom:E;var ie=z.zoom(y*z.scale(E));return isNaN(ie)?1/0:ie},project:function(y,E){return E=E===void 0?this._zoom:E,this.options.crs.latLngToPoint(ge(y),E)},unproject:function(y,E){return E=E===void 0?this._zoom:E,this.options.crs.pointToLatLng(Se(y),E)},layerPointToLatLng:function(y){var E=Se(y).add(this.getPixelOrigin());return this.unproject(E)},latLngToLayerPoint:function(y){var E=this.project(ge(y))._round();return E._subtract(this.getPixelOrigin())},wrapLatLng:function(y){return this.options.crs.wrapLatLng(ge(y))},wrapLatLngBounds:function(y){return this.options.crs.wrapLatLngBounds(W(y))},distance:function(y,E){return this.options.crs.distance(ge(y),ge(E))},containerPointToLayerPoint:function(y){return Se(y).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(y){return Se(y).add(this._getMapPanePos())},containerPointToLatLng:function(y){var E=this.containerPointToLayerPoint(Se(y));return this.layerPointToLatLng(E)},latLngToContainerPoint:function(y){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ge(y)))},mouseEventToContainerPoint:function(y){return Yo(y,this._container)},mouseEventToLayerPoint:function(y){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(y))},mouseEventToLatLng:function(y){return this.layerPointToLatLng(this.mouseEventToLayerPoint(y))},_initContainer:function(y){var E=this._container=An(y);if(E){if(E._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");qt(E,"scroll",this._onScroll,this),this._containerId=u(E)},_initLayout:function(){var y=this._container;this._fadeAnimated=this.options.fadeAnimation&&$t.any3d,ir(y,"leaflet-container"+($t.touch?" leaflet-touch":"")+($t.retina?" leaflet-retina":"")+($t.ielt9?" leaflet-oldie":"")+($t.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var E=on(y,"position");E!=="absolute"&&E!=="relative"&&E!=="fixed"&&E!=="sticky"&&(y.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var y=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ht(this._mapPane,new ce(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ir(y.markerPane,"leaflet-zoom-hide"),ir(y.shadowPane,"leaflet-zoom-hide"))},_resetView:function(y,E,z){Ht(this._mapPane,new ce(0,0));var ie=!this._loaded;this._loaded=!0,E=this._limitZoom(E),this.fire("viewprereset");var me=this._zoom!==E;this._moveStart(me,z)._move(y,E)._moveEnd(me),this.fire("viewreset"),ie&&this.fire("load")},_moveStart:function(y,E){return y&&this.fire("zoomstart"),E||this.fire("movestart"),this},_move:function(y,E,z,ie){E===void 0&&(E=this._zoom);var me=this._zoom!==E;return this._zoom=E,this._lastCenter=y,this._pixelOrigin=this._getNewPixelOrigin(y),ie?z&&z.pinch&&this.fire("zoom",z):((me||z&&z.pinch)&&this.fire("zoom",z),this.fire("move",z)),this},_moveEnd:function(y){return y&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(y){Ht(this._mapPane,this._getMapPanePos().subtract(y))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(y){this._targets={},this._targets[u(this._container)]=this;var E=y?Zt:qt;E(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&E(window,"resize",this._onResize,this),$t.any3d&&this.options.transform3DLimit&&(y?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Z(this._resizeRequest),this._resizeRequest=J(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var y=this._getMapPanePos();Math.max(Math.abs(y.x),Math.abs(y.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(y,E){for(var z=[],ie,me=E==="mouseout"||E==="mouseover",Ee=y.target||y.srcElement,Fe=!1;Ee;){if(ie=this._targets[u(Ee)],ie&&(E==="click"||E==="preclick")&&this._draggableMoved(ie)){Fe=!0;break}if(ie&&ie.listens(E,!0)&&(me&&!ms(Ee,y)||(z.push(ie),me))||Ee===this._container)break;Ee=Ee.parentNode}return!z.length&&!Fe&&!me&&this.listens(E,!0)&&(z=[this]),z},_isClickDisabled:function(y){for(;y&&y!==this._container;){if(y._leaflet_disable_click)return!0;y=y.parentNode}},_handleDOMEvent:function(y){var E=y.target||y.srcElement;if(!(!this._loaded||E._leaflet_disable_events||y.type==="click"&&this._isClickDisabled(E))){var z=y.type;z==="mousedown"&&ka(E),this._fireDOMEvent(y,z)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(y,E,z){if(y.type==="click"){var ie=a({},y);ie.type="preclick",this._fireDOMEvent(ie,ie.type,z)}var me=this._findEventTargets(y,E);if(z){for(var Ee=[],Fe=0;Fe<z.length;Fe++)z[Fe].listens(E,!0)&&Ee.push(z[Fe]);me=Ee.concat(me)}if(me.length){E==="contextmenu"&&mi(y);var tt=me[0],mt={originalEvent:y};if(y.type!=="keypress"&&y.type!=="keydown"&&y.type!=="keyup"){var kt=tt.getLatLng&&(!tt._radius||tt._radius<=10);mt.containerPoint=kt?this.latLngToContainerPoint(tt.getLatLng()):this.mouseEventToContainerPoint(y),mt.layerPoint=this.containerPointToLayerPoint(mt.containerPoint),mt.latlng=kt?tt.getLatLng():this.layerPointToLatLng(mt.layerPoint)}for(Fe=0;Fe<me.length;Fe++)if(me[Fe].fire(E,mt,!0),mt.originalEvent._stopped||me[Fe].options.bubblingMouseEvents===!1&&M(this._mouseEvents,E)!==-1)return}},_draggableMoved:function(y){return y=y.dragging&&y.dragging.enabled()?y:this,y.dragging&&y.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var y=0,E=this._handlers.length;y<E;y++)this._handlers[y].disable()},whenReady:function(y,E){return this._loaded?y.call(E||this,{target:this}):this.on("load",y,E),this},_getMapPanePos:function(){return ni(this._mapPane)||new ce(0,0)},_moved:function(){var y=this._getMapPanePos();return y&&!y.equals([0,0])},_getTopLeftPoint:function(y,E){var z=y&&E!==void 0?this._getNewPixelOrigin(y,E):this.getPixelOrigin();return z.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(y,E){var z=this.getSize()._divideBy(2);return this.project(y,E)._subtract(z)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(y,E,z){var ie=this._getNewPixelOrigin(z,E);return this.project(y,E)._subtract(ie)},_latLngBoundsToNewLayerBounds:function(y,E,z){var ie=this._getNewPixelOrigin(z,E);return X([this.project(y.getSouthWest(),E)._subtract(ie),this.project(y.getNorthWest(),E)._subtract(ie),this.project(y.getSouthEast(),E)._subtract(ie),this.project(y.getNorthEast(),E)._subtract(ie)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(y){return this.latLngToLayerPoint(y).subtract(this._getCenterLayerPoint())},_limitCenter:function(y,E,z){if(!z)return y;var ie=this.project(y,E),me=this.getSize().divideBy(2),Ee=new V(ie.subtract(me),ie.add(me)),Fe=this._getBoundsOffset(Ee,z,E);return Math.abs(Fe.x)<=1&&Math.abs(Fe.y)<=1?y:this.unproject(ie.add(Fe),E)},_limitOffset:function(y,E){if(!E)return y;var z=this.getPixelBounds(),ie=new V(z.min.add(y),z.max.add(y));return y.add(this._getBoundsOffset(ie,E))},_getBoundsOffset:function(y,E,z){var ie=X(this.project(E.getNorthEast(),z),this.project(E.getSouthWest(),z)),me=ie.min.subtract(y.min),Ee=ie.max.subtract(y.max),Fe=this._rebound(me.x,-Ee.x),tt=this._rebound(me.y,-Ee.y);return new ce(Fe,tt)},_rebound:function(y,E){return y+E>0?Math.round(y-E)/2:Math.max(0,Math.ceil(y))-Math.max(0,Math.floor(E))},_limitZoom:function(y){var E=this.getMinZoom(),z=this.getMaxZoom(),ie=$t.any3d?this.options.zoomSnap:1;return ie&&(y=Math.round(y/ie)*ie),Math.max(E,Math.min(z,y))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Bn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(y,E){var z=this._getCenterOffset(y)._trunc();return(E&&E.animate)!==!0&&!this.getSize().contains(z)?!1:(this.panBy(z,E),!0)},_createAnimProxy:function(){var y=this._proxy=Jr("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(y),this.on("zoomanim",function(E){var z=us,ie=this._proxy.style[z];Pe(this._proxy,this.project(E.center,E.zoom),this.getZoomScale(E.zoom,1)),ie===this._proxy.style[z]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Rn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var y=this.getCenter(),E=this.getZoom();Pe(this._proxy,this.project(y,E),this.getZoomScale(E,1))},_catchTransitionEnd:function(y){this._animatingZoom&&y.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(y,E,z){if(this._animatingZoom)return!0;if(z=z||{},!this._zoomAnimated||z.animate===!1||this._nothingToAnimate()||Math.abs(E-this._zoom)>this.options.zoomAnimationThreshold)return!1;var ie=this.getZoomScale(E),me=this._getCenterOffset(y)._divideBy(1-1/ie);return z.animate!==!0&&!this.getSize().contains(me)?!1:(J(function(){this._moveStart(!0,z.noMoveStart||!1)._animateZoom(y,E,!0)},this),!0)},_animateZoom:function(y,E,z,ie){this._mapPane&&(z&&(this._animatingZoom=!0,this._animateToCenter=y,this._animateToZoom=E,ir(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:y,zoom:E,noUpdate:ie}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Bn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Gl(y,E){return new mn(y,E)}var xa=de.extend({options:{position:"topright"},initialize:function(y){C(this,y)},getPosition:function(){return this.options.position},setPosition:function(y){var E=this._map;return E&&E.removeControl(this),this.options.position=y,E&&E.addControl(this),this},getContainer:function(){return this._container},addTo:function(y){this.remove(),this._map=y;var E=this._container=this.onAdd(y),z=this.getPosition(),ie=y._controlCorners[z];return ir(E,"leaflet-control"),z.indexOf("bottom")!==-1?ie.insertBefore(E,ie.firstChild):ie.appendChild(E),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Rn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(y){this._map&&y&&y.screenX>0&&y.screenY>0&&this._map.getContainer().focus()}}),ao=function(y){return new xa(y)};mn.include({addControl:function(y){return y.addTo(this),this},removeControl:function(y){return y.remove(),this},_initControlPos:function(){var y=this._controlCorners={},E="leaflet-",z=this._controlContainer=Jr("div",E+"control-container",this._container);function ie(me,Ee){var Fe=E+me+" "+E+Ee;y[me+Ee]=Jr("div",Fe,z)}ie("top","left"),ie("top","right"),ie("bottom","left"),ie("bottom","right")},_clearControlPos:function(){for(var y in this._controlCorners)Rn(this._controlCorners[y]);Rn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Kl=xa.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(y,E,z,ie){return z<ie?-1:ie<z?1:0}},initialize:function(y,E,z){C(this,z),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var ie in y)this._addLayer(y[ie],ie);for(ie in E)this._addLayer(E[ie],ie,!0)},onAdd:function(y){this._initLayout(),this._update(),this._map=y,y.on("zoomend",this._checkDisabledLayers,this);for(var E=0;E<this._layers.length;E++)this._layers[E].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(y){return xa.prototype.addTo.call(this,y),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(y,E){return this._addLayer(y,E),this._map?this._update():this},addOverlay:function(y,E){return this._addLayer(y,E,!0),this._map?this._update():this},removeLayer:function(y){y.off("add remove",this._onLayerChange,this);var E=this._getLayer(u(y));return E&&this._layers.splice(this._layers.indexOf(E),1),this._map?this._update():this},expand:function(){ir(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var y=this._map.getSize().y-(this._container.offsetTop+50);return y<this._section.clientHeight?(ir(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=y+"px"):Bn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Bn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var y="leaflet-control-layers",E=this._container=Jr("div",y),z=this.options.collapsed;E.setAttribute("aria-haspopup",!0),Xa(E),fs(E);var ie=this._section=Jr("section",y+"-list");z&&(this._map.on("click",this.collapse,this),qt(E,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var me=this._layersLink=Jr("a",y+"-toggle",E);me.href="#",me.title="Layers",me.setAttribute("role","button"),qt(me,{keydown:function(Ee){Ee.keyCode===13&&this._expandSafely()},click:function(Ee){mi(Ee),this._expandSafely()}},this),z||this.expand(),this._baseLayersList=Jr("div",y+"-base",ie),this._separator=Jr("div",y+"-separator",ie),this._overlaysList=Jr("div",y+"-overlays",ie),E.appendChild(ie)},_getLayer:function(y){for(var E=0;E<this._layers.length;E++)if(this._layers[E]&&u(this._layers[E].layer)===y)return this._layers[E]},_addLayer:function(y,E,z){this._map&&y.on("add remove",this._onLayerChange,this),this._layers.push({layer:y,name:E,overlay:z}),this.options.sortLayers&&this._layers.sort(o(function(ie,me){return this.options.sortFunction(ie.layer,me.layer,ie.name,me.name)},this)),this.options.autoZIndex&&y.setZIndex&&(this._lastZIndex++,y.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;hs(this._baseLayersList),hs(this._overlaysList),this._layerControlInputs=[];var y,E,z,ie,me=0;for(z=0;z<this._layers.length;z++)ie=this._layers[z],this._addItem(ie),E=E||ie.overlay,y=y||!ie.overlay,me+=ie.overlay?0:1;return this.options.hideSingleBase&&(y=y&&me>1,this._baseLayersList.style.display=y?"":"none"),this._separator.style.display=E&&y?"":"none",this},_onLayerChange:function(y){this._handlingClick||this._update();var E=this._getLayer(u(y.target)),z=E.overlay?y.type==="add"?"overlayadd":"overlayremove":y.type==="add"?"baselayerchange":null;z&&this._map.fire(z,E)},_createRadioElement:function(y,E){var z='<input type="radio" class="leaflet-control-layers-selector" name="'+y+'"'+(E?' checked="checked"':"")+"/>",ie=document.createElement("div");return ie.innerHTML=z,ie.firstChild},_addItem:function(y){var E=document.createElement("label"),z=this._map.hasLayer(y.layer),ie;y.overlay?(ie=document.createElement("input"),ie.type="checkbox",ie.className="leaflet-control-layers-selector",ie.defaultChecked=z):ie=this._createRadioElement("leaflet-base-layers_"+u(this),z),this._layerControlInputs.push(ie),ie.layerId=u(y.layer),qt(ie,"click",this._onInputClick,this);var me=document.createElement("span");me.innerHTML=" "+y.name;var Ee=document.createElement("span");E.appendChild(Ee),Ee.appendChild(ie),Ee.appendChild(me);var Fe=y.overlay?this._overlaysList:this._baseLayersList;return Fe.appendChild(E),this._checkDisabledLayers(),E},_onInputClick:function(){if(!this._preventClick){var y=this._layerControlInputs,E,z,ie=[],me=[];this._handlingClick=!0;for(var Ee=y.length-1;Ee>=0;Ee--)E=y[Ee],z=this._getLayer(E.layerId).layer,E.checked?ie.push(z):E.checked||me.push(z);for(Ee=0;Ee<me.length;Ee++)this._map.hasLayer(me[Ee])&&this._map.removeLayer(me[Ee]);for(Ee=0;Ee<ie.length;Ee++)this._map.hasLayer(ie[Ee])||this._map.addLayer(ie[Ee]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var y=this._layerControlInputs,E,z,ie=this._map.getZoom(),me=y.length-1;me>=0;me--)E=y[me],z=this._getLayer(E.layerId).layer,E.disabled=z.options.minZoom!==void 0&&ie<z.options.minZoom||z.options.maxZoom!==void 0&&ie>z.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var y=this._section;this._preventClick=!0,qt(y,"click",mi),this.expand();var E=this;setTimeout(function(){Zt(y,"click",mi),E._preventClick=!1})}}),Fn=function(y,E,z){return new Kl(y,E,z)},Eo=xa.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(y){var E="leaflet-control-zoom",z=Jr("div",E+" leaflet-bar"),ie=this.options;return this._zoomInButton=this._createButton(ie.zoomInText,ie.zoomInTitle,E+"-in",z,this._zoomIn),this._zoomOutButton=this._createButton(ie.zoomOutText,ie.zoomOutTitle,E+"-out",z,this._zoomOut),this._updateDisabled(),y.on("zoomend zoomlevelschange",this._updateDisabled,this),z},onRemove:function(y){y.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(y){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(y.shiftKey?3:1))},_zoomOut:function(y){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(y.shiftKey?3:1))},_createButton:function(y,E,z,ie,me){var Ee=Jr("a",z,ie);return Ee.innerHTML=y,Ee.href="#",Ee.title=E,Ee.setAttribute("role","button"),Ee.setAttribute("aria-label",E),Xa(Ee),qt(Ee,"click",Ks),qt(Ee,"click",me,this),qt(Ee,"click",this._refocusOnMap,this),Ee},_updateDisabled:function(){var y=this._map,E="leaflet-disabled";Bn(this._zoomInButton,E),Bn(this._zoomOutButton,E),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||y._zoom===y.getMinZoom())&&(ir(this._zoomOutButton,E),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||y._zoom===y.getMaxZoom())&&(ir(this._zoomInButton,E),this._zoomInButton.setAttribute("aria-disabled","true"))}});mn.mergeOptions({zoomControl:!0}),mn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Eo,this.addControl(this.zoomControl))});var _o=function(y){return new Eo(y)},To=xa.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(y){var E="leaflet-control-scale",z=Jr("div",E),ie=this.options;return this._addScales(ie,E+"-line",z),y.on(ie.updateWhenIdle?"moveend":"move",this._update,this),y.whenReady(this._update,this),z},onRemove:function(y){y.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(y,E,z){y.metric&&(this._mScale=Jr("div",E,z)),y.imperial&&(this._iScale=Jr("div",E,z))},_update:function(){var y=this._map,E=y.getSize().y/2,z=y.distance(y.containerPointToLatLng([0,E]),y.containerPointToLatLng([this.options.maxWidth,E]));this._updateScales(z)},_updateScales:function(y){this.options.metric&&y&&this._updateMetric(y),this.options.imperial&&y&&this._updateImperial(y)},_updateMetric:function(y){var E=this._getRoundNum(y),z=E<1e3?E+" m":E/1e3+" km";this._updateScale(this._mScale,z,E/y)},_updateImperial:function(y){var E=y*3.2808399,z,ie,me;E>5280?(z=E/5280,ie=this._getRoundNum(z),this._updateScale(this._iScale,ie+" mi",ie/z)):(me=this._getRoundNum(E),this._updateScale(this._iScale,me+" ft",me/E))},_updateScale:function(y,E,z){y.style.width=Math.round(this.options.maxWidth*z)+"px",y.innerHTML=E},_getRoundNum:function(y){var E=Math.pow(10,(Math.floor(y)+"").length-1),z=y/E;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:1,E*z}}),Rl=function(y){return new To(y)},pt='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',te=xa.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+($t.inlineSvg?pt+" ":"")+"Leaflet</a>"},initialize:function(y){C(this,y),this._attributions={}},onAdd:function(y){y.attributionControl=this,this._container=Jr("div","leaflet-control-attribution"),Xa(this._container);for(var E in y._layers)y._layers[E].getAttribution&&this.addAttribution(y._layers[E].getAttribution());return this._update(),y.on("layeradd",this._addAttribution,this),this._container},onRemove:function(y){y.off("layeradd",this._addAttribution,this)},_addAttribution:function(y){y.layer.getAttribution&&(this.addAttribution(y.layer.getAttribution()),y.layer.once("remove",function(){this.removeAttribution(y.layer.getAttribution())},this))},setPrefix:function(y){return this.options.prefix=y,this._update(),this},addAttribution:function(y){return y?(this._attributions[y]||(this._attributions[y]=0),this._attributions[y]++,this._update(),this):this},removeAttribution:function(y){return y?(this._attributions[y]&&(this._attributions[y]--,this._update()),this):this},_update:function(){if(this._map){var y=[];for(var E in this._attributions)this._attributions[E]&&y.push(E);var z=[];this.options.prefix&&z.push(this.options.prefix),y.length&&z.push(y.join(", ")),this._container.innerHTML=z.join(' <span aria-hidden="true">|</span> ')}}});mn.mergeOptions({attributionControl:!0}),mn.addInitHook(function(){this.options.attributionControl&&new te().addTo(this)});var we=function(y){return new te(y)};xa.Layers=Kl,xa.Zoom=Eo,xa.Scale=To,xa.Attribution=te,ao.layers=Fn,ao.zoom=_o,ao.scale=Rl,ao.attribution=we;var Re=de.extend({initialize:function(y){this._map=y},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Re.addTo=function(y,E){return y.addHandler(E,this),this};var We={Events:K},et=$t.touch?"touchstart mousedown":"mousedown",Ct=ue.extend({options:{clickTolerance:3},initialize:function(y,E,z,ie){C(this,ie),this._element=y,this._dragStartTarget=E||y,this._preventOutline=z},enable:function(){this._enabled||(qt(this._dragStartTarget,et,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ct._dragging===this&&this.finishDrag(!0),Zt(this._dragStartTarget,et,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(y){if(this._enabled&&(this._moved=!1,!No(this._element,"leaflet-zoom-anim"))){if(y.touches&&y.touches.length!==1){Ct._dragging===this&&this.finishDrag();return}if(!(Ct._dragging||y.shiftKey||y.which!==1&&y.button!==1&&!y.touches)&&(Ct._dragging=this,this._preventOutline&&ka(this._element),Cr(),la(),!this._moving)){this.fire("down");var E=y.touches?y.touches[0]:y,z=Ao(this._element);this._startPoint=new ce(E.clientX,E.clientY),this._startPos=ni(this._element),this._parentScale=Pl(z);var ie=y.type==="mousedown";qt(document,ie?"mousemove":"touchmove",this._onMove,this),qt(document,ie?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(y){if(this._enabled){if(y.touches&&y.touches.length>1){this._moved=!0;return}var E=y.touches&&y.touches.length===1?y.touches[0]:y,z=new ce(E.clientX,E.clientY)._subtract(this._startPoint);!z.x&&!z.y||Math.abs(z.x)+Math.abs(z.y)<this.options.clickTolerance||(z.x/=this._parentScale.x,z.y/=this._parentScale.y,mi(y),this._moved||(this.fire("dragstart"),this._moved=!0,ir(document.body,"leaflet-dragging"),this._lastTarget=y.target||y.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ir(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(z),this._moving=!0,this._lastEvent=y,this._updatePosition())}},_updatePosition:function(){var y={originalEvent:this._lastEvent};this.fire("predrag",y),Ht(this._element,this._newPos),this.fire("drag",y)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(y){Bn(document.body,"leaflet-dragging"),this._lastTarget&&(Bn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Zt(document,"mousemove touchmove",this._onMove,this),Zt(document,"mouseup touchend touchcancel",this._onUp,this),Jn(),Ps();var E=this._moved&&this._moving;this._moving=!1,Ct._dragging=!1,E&&this.fire("dragend",{noInertia:y,distance:this._newPos.distanceTo(this._startPos)})}});function Lt(y,E,z){var ie,me=[1,4,2,8],Ee,Fe,tt,mt,kt,Kt,br,Cn;for(Ee=0,Kt=y.length;Ee<Kt;Ee++)y[Ee]._code=ts(y[Ee],E);for(tt=0;tt<4;tt++){for(br=me[tt],ie=[],Ee=0,Kt=y.length,Fe=Kt-1;Ee<Kt;Fe=Ee++)mt=y[Ee],kt=y[Fe],mt._code&br?kt._code&br||(Cn=es(kt,mt,br,E,z),Cn._code=ts(Cn,E),ie.push(Cn)):(kt._code&br&&(Cn=es(kt,mt,br,E,z),Cn._code=ts(Cn,E),ie.push(Cn)),ie.push(mt));y=ie}return y}function ar(y,E){var z,ie,me,Ee,Fe,tt,mt,kt,Kt;if(!y||y.length===0)throw new Error("latlngs not passed");Pa(y)||(console.warn("latlngs are not flat! Only the first ring will be used"),y=y[0]);var br=ge([0,0]),Cn=W(y),Bs=Cn.getNorthWest().distanceTo(Cn.getSouthWest())*Cn.getNorthEast().distanceTo(Cn.getNorthWest());Bs<1700&&(br=Gt(y));var ba=y.length,al=[];for(z=0;z<ba;z++){var ii=ge(y[z]);al.push(E.project(ge([ii.lat-br.lat,ii.lng-br.lng])))}for(tt=mt=kt=0,z=0,ie=ba-1;z<ba;ie=z++)me=al[z],Ee=al[ie],Fe=me.y*Ee.x-Ee.y*me.x,mt+=(me.x+Ee.x)*Fe,kt+=(me.y+Ee.y)*Fe,tt+=Fe*3;tt===0?Kt=al[0]:Kt=[mt/tt,kt/tt];var ai=E.unproject(Se(Kt));return ge([ai.lat+br.lat,ai.lng+br.lng])}function Gt(y){for(var E=0,z=0,ie=0,me=0;me<y.length;me++){var Ee=ge(y[me]);E+=Ee.lat,z+=Ee.lng,ie++}return ge([E/ie,z/ie])}var Ur={__proto__:null,clipPolygon:Lt,polygonCenter:ar,centroid:Gt};function lr(y,E){if(!E||!y.length)return y.slice();var z=E*E;return y=va(y,z),y=Zr(y,z),y}function Sn(y,E,z){return Math.sqrt(Xo(y,E,z,!0))}function ei(y,E,z){return Xo(y,E,z)}function Zr(y,E){var z=y.length,ie=typeof Uint8Array<"u"?Uint8Array:Array,me=new ie(z);me[0]=me[z-1]=1,Xt(y,me,E,0,z-1);var Ee,Fe=[];for(Ee=0;Ee<z;Ee++)me[Ee]&&Fe.push(y[Ee]);return Fe}function Xt(y,E,z,ie,me){var Ee=0,Fe,tt,mt;for(tt=ie+1;tt<=me-1;tt++)mt=Xo(y[tt],y[ie],y[me],!0),mt>Ee&&(Fe=tt,Ee=mt);Ee>z&&(E[Fe]=1,Xt(y,E,z,ie,Fe),Xt(y,E,z,Fe,me))}function va(y,E){for(var z=[y[0]],ie=1,me=0,Ee=y.length;ie<Ee;ie++)Da(y[ie],y[me])>E&&(z.push(y[ie]),me=ie);return me<Ee-1&&z.push(y[Ee-1]),z}var rn;function Ei(y,E,z,ie,me){var Ee=ie?rn:ts(y,z),Fe=ts(E,z),tt,mt,kt;for(rn=Fe;;){if(!(Ee|Fe))return[y,E];if(Ee&Fe)return!1;tt=Ee||Fe,mt=es(y,E,tt,z,me),kt=ts(mt,z),tt===Ee?(y=mt,Ee=kt):(E=mt,Fe=kt)}}function es(y,E,z,ie,me){var Ee=E.x-y.x,Fe=E.y-y.y,tt=ie.min,mt=ie.max,kt,Kt;return z&8?(kt=y.x+Ee*(mt.y-y.y)/Fe,Kt=mt.y):z&4?(kt=y.x+Ee*(tt.y-y.y)/Fe,Kt=tt.y):z&2?(kt=mt.x,Kt=y.y+Fe*(mt.x-y.x)/Ee):z&1&&(kt=tt.x,Kt=y.y+Fe*(tt.x-y.x)/Ee),new ce(kt,Kt,me)}function ts(y,E){var z=0;return y.x<E.min.x?z|=1:y.x>E.max.x&&(z|=2),y.y<E.min.y?z|=4:y.y>E.max.y&&(z|=8),z}function Da(y,E){var z=E.x-y.x,ie=E.y-y.y;return z*z+ie*ie}function Xo(y,E,z,ie){var me=E.x,Ee=E.y,Fe=z.x-me,tt=z.y-Ee,mt=Fe*Fe+tt*tt,kt;return mt>0&&(kt=((y.x-me)*Fe+(y.y-Ee)*tt)/mt,kt>1?(me=z.x,Ee=z.y):kt>0&&(me+=Fe*kt,Ee+=tt*kt)),Fe=y.x-me,tt=y.y-Ee,ie?Fe*Fe+tt*tt:new ce(me,Ee)}function Pa(y){return!D(y[0])||typeof y[0][0]!="object"&&typeof y[0][0]<"u"}function so(y){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Pa(y)}function oo(y,E){var z,ie,me,Ee,Fe,tt,mt,kt;if(!y||y.length===0)throw new Error("latlngs not passed");Pa(y)||(console.warn("latlngs are not flat! Only the first ring will be used"),y=y[0]);var Kt=ge([0,0]),br=W(y),Cn=br.getNorthWest().distanceTo(br.getSouthWest())*br.getNorthEast().distanceTo(br.getNorthWest());Cn<1700&&(Kt=Gt(y));var Bs=y.length,ba=[];for(z=0;z<Bs;z++){var al=ge(y[z]);ba.push(E.project(ge([al.lat-Kt.lat,al.lng-Kt.lng])))}for(z=0,ie=0;z<Bs-1;z++)ie+=ba[z].distanceTo(ba[z+1])/2;if(ie===0)kt=ba[0];else for(z=0,Ee=0;z<Bs-1;z++)if(Fe=ba[z],tt=ba[z+1],me=Fe.distanceTo(tt),Ee+=me,Ee>ie){mt=(Ee-ie)/me,kt=[tt.x-mt*(tt.x-Fe.x),tt.y-mt*(tt.y-Fe.y)];break}var ii=E.unproject(Se(kt));return ge([ii.lat+Kt.lat,ii.lng+Kt.lng])}var Ql={__proto__:null,simplify:lr,pointToSegmentDistance:Sn,closestPointOnSegment:ei,clipSegment:Ei,_getEdgeIntersection:es,_getBitCode:ts,_sqClosestPointOnSegment:Xo,isFlat:Pa,_flat:so,polylineCenter:oo},Jo={project:function(y){return new ce(y.lng,y.lat)},unproject:function(y){return new oe(y.y,y.x)},bounds:new V([-180,-90],[180,90])},wi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new V([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(y){var E=Math.PI/180,z=this.R,ie=y.lat*E,me=this.R_MINOR/z,Ee=Math.sqrt(1-me*me),Fe=Ee*Math.sin(ie),tt=Math.tan(Math.PI/4-ie/2)/Math.pow((1-Fe)/(1+Fe),Ee/2);return ie=-z*Math.log(Math.max(tt,1e-10)),new ce(y.lng*E*z,ie)},unproject:function(y){for(var E=180/Math.PI,z=this.R,ie=this.R_MINOR/z,me=Math.sqrt(1-ie*ie),Ee=Math.exp(-y.y/z),Fe=Math.PI/2-2*Math.atan(Ee),tt=0,mt=.1,kt;tt<15&&Math.abs(mt)>1e-7;tt++)kt=me*Math.sin(Fe),kt=Math.pow((1-kt)/(1+kt),me/2),mt=Math.PI/2-2*Math.atan(Ee*kt)-Fe,Fe+=mt;return new oe(Fe*E,y.x*E/z)}},pl={__proto__:null,LonLat:Jo,Mercator:wi,SphericalMercator:He},Yl=a({},Le,{code:"EPSG:3395",projection:wi,transformation:(function(){var y=.5/(Math.PI*wi.R);return Qe(y,.5,-y,.5)})()}),el=a({},Le,{code:"EPSG:4326",projection:Jo,transformation:Qe(1/180,1,-1/180,.5)}),gl=a({},be,{projection:Jo,transformation:Qe(1,0,-1,0),scale:function(y){return Math.pow(2,y)},zoom:function(y){return Math.log(y)/Math.LN2},distance:function(y,E){var z=E.lng-y.lng,ie=E.lat-y.lat;return Math.sqrt(z*z+ie*ie)},infinite:!0});be.Earth=Le,be.EPSG3395=Yl,be.EPSG3857=vt,be.EPSG900913=Pt,be.EPSG4326=el,be.Simple=gl;var qn=ue.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(y){return y.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(y){return y&&y.removeLayer(this),this},getPane:function(y){return this._map.getPane(y?this.options[y]||y:this.options.pane)},addInteractiveTarget:function(y){return this._map._targets[u(y)]=this,this},removeInteractiveTarget:function(y){return delete this._map._targets[u(y)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(y){var E=y.target;if(E.hasLayer(this)){if(this._map=E,this._zoomAnimated=E._zoomAnimated,this.getEvents){var z=this.getEvents();E.on(z,this),this.once("remove",function(){E.off(z,this)},this)}this.onAdd(E),this.fire("add"),E.fire("layeradd",{layer:this})}}});mn.include({addLayer:function(y){if(!y._layerAdd)throw new Error("The provided object is not a Layer.");var E=u(y);return this._layers[E]?this:(this._layers[E]=y,y._mapToAdd=this,y.beforeAdd&&y.beforeAdd(this),this.whenReady(y._layerAdd,y),this)},removeLayer:function(y){var E=u(y);return this._layers[E]?(this._loaded&&y.onRemove(this),delete this._layers[E],this._loaded&&(this.fire("layerremove",{layer:y}),y.fire("remove")),y._map=y._mapToAdd=null,this):this},hasLayer:function(y){return u(y)in this._layers},eachLayer:function(y,E){for(var z in this._layers)y.call(E,this._layers[z]);return this},_addLayers:function(y){y=y?D(y)?y:[y]:[];for(var E=0,z=y.length;E<z;E++)this.addLayer(y[E])},_addZoomLimit:function(y){(!isNaN(y.options.maxZoom)||!isNaN(y.options.minZoom))&&(this._zoomBoundLayers[u(y)]=y,this._updateZoomLevels())},_removeZoomLimit:function(y){var E=u(y);this._zoomBoundLayers[E]&&(delete this._zoomBoundLayers[E],this._updateZoomLevels())},_updateZoomLevels:function(){var y=1/0,E=-1/0,z=this._getZoomSpan();for(var ie in this._zoomBoundLayers){var me=this._zoomBoundLayers[ie].options;y=me.minZoom===void 0?y:Math.min(y,me.minZoom),E=me.maxZoom===void 0?E:Math.max(E,me.maxZoom)}this._layersMaxZoom=E===-1/0?void 0:E,this._layersMinZoom=y===1/0?void 0:y,z!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var rs=qn.extend({initialize:function(y,E){C(this,E),this._layers={};var z,ie;if(y)for(z=0,ie=y.length;z<ie;z++)this.addLayer(y[z])},addLayer:function(y){var E=this.getLayerId(y);return this._layers[E]=y,this._map&&this._map.addLayer(y),this},removeLayer:function(y){var E=y in this._layers?y:this.getLayerId(y);return this._map&&this._layers[E]&&this._map.removeLayer(this._layers[E]),delete this._layers[E],this},hasLayer:function(y){var E=typeof y=="number"?y:this.getLayerId(y);return E in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(y){var E=Array.prototype.slice.call(arguments,1),z,ie;for(z in this._layers)ie=this._layers[z],ie[y]&&ie[y].apply(ie,E);return this},onAdd:function(y){this.eachLayer(y.addLayer,y)},onRemove:function(y){this.eachLayer(y.removeLayer,y)},eachLayer:function(y,E){for(var z in this._layers)y.call(E,this._layers[z]);return this},getLayer:function(y){return this._layers[y]},getLayers:function(){var y=[];return this.eachLayer(y.push,y),y},setZIndex:function(y){return this.invoke("setZIndex",y)},getLayerId:function(y){return u(y)}}),ns=function(y,E){return new rs(y,E)},Qs=rs.extend({addLayer:function(y){return this.hasLayer(y)?this:(y.addEventParent(this),rs.prototype.addLayer.call(this,y),this.fire("layeradd",{layer:y}))},removeLayer:function(y){return this.hasLayer(y)?(y in this._layers&&(y=this._layers[y]),y.removeEventParent(this),rs.prototype.removeLayer.call(this,y),this.fire("layerremove",{layer:y})):this},setStyle:function(y){return this.invoke("setStyle",y)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var y=new se;for(var E in this._layers){var z=this._layers[E];y.extend(z.getBounds?z.getBounds():z.getLatLng())}return y}}),qi=function(y,E){return new Qs(y,E)},ps=de.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(y){C(this,y)},createIcon:function(y){return this._createIcon("icon",y)},createShadow:function(y){return this._createIcon("shadow",y)},_createIcon:function(y,E){var z=this._getIconUrl(y);if(!z){if(y==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var ie=this._createImg(z,E&&E.tagName==="IMG"?E:null);return this._setIconStyles(ie,y),(this.options.crossOrigin||this.options.crossOrigin==="")&&(ie.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),ie},_setIconStyles:function(y,E){var z=this.options,ie=z[E+"Size"];typeof ie=="number"&&(ie=[ie,ie]);var me=Se(ie),Ee=Se(E==="shadow"&&z.shadowAnchor||z.iconAnchor||me&&me.divideBy(2,!0));y.className="leaflet-marker-"+E+" "+(z.className||""),Ee&&(y.style.marginLeft=-Ee.x+"px",y.style.marginTop=-Ee.y+"px"),me&&(y.style.width=me.x+"px",y.style.height=me.y+"px")},_createImg:function(y,E){return E=E||document.createElement("img"),E.src=y,E},_getIconUrl:function(y){return $t.retina&&this.options[y+"RetinaUrl"]||this.options[y+"Url"]}});function tl(y){return new ps(y)}var Ml=ps.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(y){return typeof Ml.imagePath!="string"&&(Ml.imagePath=this._detectIconPath()),(this.options.imagePath||Ml.imagePath)+ps.prototype._getIconUrl.call(this,y)},_stripUrl:function(y){var E=function(z,ie,me){var Ee=ie.exec(z);return Ee&&Ee[me]};return y=E(y,/^url\((['"])?(.+)\1\)$/,2),y&&E(y,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var y=Jr("div","leaflet-default-icon-path",document.body),E=on(y,"background-image")||on(y,"backgroundImage");if(document.body.removeChild(y),E=this._stripUrl(E),E)return E;var z=document.querySelector('link[href$="leaflet.css"]');return z?z.href.substring(0,z.href.length-11-1):""}}),lo=Re.extend({initialize:function(y){this._marker=y},addHooks:function(){var y=this._marker._icon;this._draggable||(this._draggable=new Ct(y,y,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ir(y,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Bn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(y){var E=this._marker,z=E._map,ie=this._marker.options.autoPanSpeed,me=this._marker.options.autoPanPadding,Ee=ni(E._icon),Fe=z.getPixelBounds(),tt=z.getPixelOrigin(),mt=X(Fe.min._subtract(tt).add(me),Fe.max._subtract(tt).subtract(me));if(!mt.contains(Ee)){var kt=Se((Math.max(mt.max.x,Ee.x)-mt.max.x)/(Fe.max.x-mt.max.x)-(Math.min(mt.min.x,Ee.x)-mt.min.x)/(Fe.min.x-mt.min.x),(Math.max(mt.max.y,Ee.y)-mt.max.y)/(Fe.max.y-mt.max.y)-(Math.min(mt.min.y,Ee.y)-mt.min.y)/(Fe.min.y-mt.min.y)).multiplyBy(ie);z.panBy(kt,{animate:!1}),this._draggable._newPos._add(kt),this._draggable._startPos._add(kt),Ht(E._icon,this._draggable._newPos),this._onDrag(y),this._panRequest=J(this._adjustPan.bind(this,y))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(y){this._marker.options.autoPan&&(Z(this._panRequest),this._panRequest=J(this._adjustPan.bind(this,y)))},_onDrag:function(y){var E=this._marker,z=E._shadow,ie=ni(E._icon),me=E._map.layerPointToLatLng(ie);z&&Ht(z,ie),E._latlng=me,y.latlng=me,y.oldLatLng=this._oldLatLng,E.fire("move",y).fire("drag",y)},_onDragEnd:function(y){Z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",y)}}),da=qn.extend({options:{icon:new Ml,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(y,E){C(this,E),this._latlng=ge(y)},onAdd:function(y){this._zoomAnimated=this._zoomAnimated&&y.options.markerZoomAnimation,this._zoomAnimated&&y.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(y){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&y.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(y){var E=this._latlng;return this._latlng=ge(y),this.update(),this.fire("move",{oldLatLng:E,latlng:this._latlng})},setZIndexOffset:function(y){return this.options.zIndexOffset=y,this.update()},getIcon:function(){return this.options.icon},setIcon:function(y){return this.options.icon=y,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var y=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(y)}return this},_initIcon:function(){var y=this.options,E="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),z=y.icon.createIcon(this._icon),ie=!1;z!==this._icon&&(this._icon&&this._removeIcon(),ie=!0,y.title&&(z.title=y.title),z.tagName==="IMG"&&(z.alt=y.alt||"")),ir(z,E),y.keyboard&&(z.tabIndex="0",z.setAttribute("role","button")),this._icon=z,y.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&qt(z,"focus",this._panOnFocus,this);var me=y.icon.createShadow(this._shadow),Ee=!1;me!==this._shadow&&(this._removeShadow(),Ee=!0),me&&(ir(me,E),me.alt=""),this._shadow=me,y.opacity<1&&this._updateOpacity(),ie&&this.getPane().appendChild(this._icon),this._initInteraction(),me&&Ee&&this.getPane(y.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Zt(this._icon,"focus",this._panOnFocus,this),Rn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Rn(this._shadow),this._shadow=null},_setPos:function(y){this._icon&&Ht(this._icon,y),this._shadow&&Ht(this._shadow,y),this._zIndex=y.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(y){this._icon&&(this._icon.style.zIndex=this._zIndex+y)},_animateZoom:function(y){var E=this._map._latLngToNewLayerPoint(this._latlng,y.zoom,y.center).round();this._setPos(E)},_initInteraction:function(){if(this.options.interactive&&(ir(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),lo)){var y=this.options.draggable;this.dragging&&(y=this.dragging.enabled(),this.dragging.disable()),this.dragging=new lo(this),y&&this.dragging.enable()}},setOpacity:function(y){return this.options.opacity=y,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var y=this.options.opacity;this._icon&&kr(this._icon,y),this._shadow&&kr(this._shadow,y)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var y=this._map;if(y){var E=this.options.icon.options,z=E.iconSize?Se(E.iconSize):Se(0,0),ie=E.iconAnchor?Se(E.iconAnchor):Se(0,0);y.panInside(this._latlng,{paddingTopLeft:ie,paddingBottomRight:z.subtract(ie)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ys(y,E){return new da(y,E)}var _i=qn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(y){this._renderer=y.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(y){return C(this,y),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&y&&Object.prototype.hasOwnProperty.call(y,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),is=_i.extend({options:{fill:!0,radius:10},initialize:function(y,E){C(this,E),this._latlng=ge(y),this._radius=this.options.radius},setLatLng:function(y){var E=this._latlng;return this._latlng=ge(y),this.redraw(),this.fire("move",{oldLatLng:E,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(y){return this.options.radius=this._radius=y,this.redraw()},getRadius:function(){return this._radius},setStyle:function(y){var E=y&&y.radius||this._radius;return _i.prototype.setStyle.call(this,y),this.setRadius(E),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var y=this._radius,E=this._radiusY||y,z=this._clickTolerance(),ie=[y+z,E+z];this._pxBounds=new V(this._point.subtract(ie),this._point.add(ie))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(y){return y.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ln(y,E){return new is(y,E)}var Zs=is.extend({initialize:function(y,E,z){if(typeof E=="number"&&(E=a({},z,{radius:E})),C(this,E),this._latlng=ge(y),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(y){return this._mRadius=y,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var y=[this._radius,this._radiusY||this._radius];return new se(this._map.layerPointToLatLng(this._point.subtract(y)),this._map.layerPointToLatLng(this._point.add(y)))},setStyle:_i.prototype.setStyle,_project:function(){var y=this._latlng.lng,E=this._latlng.lat,z=this._map,ie=z.options.crs;if(ie.distance===Le.distance){var me=Math.PI/180,Ee=this._mRadius/Le.R/me,Fe=z.project([E+Ee,y]),tt=z.project([E-Ee,y]),mt=Fe.add(tt).divideBy(2),kt=z.unproject(mt).lat,Kt=Math.acos((Math.cos(Ee*me)-Math.sin(E*me)*Math.sin(kt*me))/(Math.cos(E*me)*Math.cos(kt*me)))/me;(isNaN(Kt)||Kt===0)&&(Kt=Ee/Math.cos(Math.PI/180*E)),this._point=mt.subtract(z.getPixelOrigin()),this._radius=isNaN(Kt)?0:mt.x-z.project([kt,y-Kt]).x,this._radiusY=mt.y-Fe.y}else{var br=ie.unproject(ie.project(this._latlng).subtract([this._mRadius,0]));this._point=z.latLngToLayerPoint(this._latlng),this._radius=this._point.x-z.latLngToLayerPoint(br).x}this._updateBounds()}});function je(y,E,z){return new Zs(y,E,z)}var h=_i.extend({options:{smoothFactor:1,noClip:!1},initialize:function(y,E){C(this,E),this._setLatLngs(y)},getLatLngs:function(){return this._latlngs},setLatLngs:function(y){return this._setLatLngs(y),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(y){for(var E=1/0,z=null,ie=Xo,me,Ee,Fe=0,tt=this._parts.length;Fe<tt;Fe++)for(var mt=this._parts[Fe],kt=1,Kt=mt.length;kt<Kt;kt++){me=mt[kt-1],Ee=mt[kt];var br=ie(y,me,Ee,!0);br<E&&(E=br,z=ie(y,me,Ee))}return z&&(z.distance=Math.sqrt(E)),z},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return oo(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(y,E){return E=E||this._defaultShape(),y=ge(y),E.push(y),this._bounds.extend(y),this.redraw()},_setLatLngs:function(y){this._bounds=new se,this._latlngs=this._convertLatLngs(y)},_defaultShape:function(){return Pa(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(y){for(var E=[],z=Pa(y),ie=0,me=y.length;ie<me;ie++)z?(E[ie]=ge(y[ie]),this._bounds.extend(E[ie])):E[ie]=this._convertLatLngs(y[ie]);return E},_project:function(){var y=new V;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,y),this._bounds.isValid()&&y.isValid()&&(this._rawPxBounds=y,this._updateBounds())},_updateBounds:function(){var y=this._clickTolerance(),E=new ce(y,y);this._rawPxBounds&&(this._pxBounds=new V([this._rawPxBounds.min.subtract(E),this._rawPxBounds.max.add(E)]))},_projectLatlngs:function(y,E,z){var ie=y[0]instanceof oe,me=y.length,Ee,Fe;if(ie){for(Fe=[],Ee=0;Ee<me;Ee++)Fe[Ee]=this._map.latLngToLayerPoint(y[Ee]),z.extend(Fe[Ee]);E.push(Fe)}else for(Ee=0;Ee<me;Ee++)this._projectLatlngs(y[Ee],E,z)},_clipPoints:function(){var y=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(y))){if(this.options.noClip){this._parts=this._rings;return}var E=this._parts,z,ie,me,Ee,Fe,tt,mt;for(z=0,me=0,Ee=this._rings.length;z<Ee;z++)for(mt=this._rings[z],ie=0,Fe=mt.length;ie<Fe-1;ie++)tt=Ei(mt[ie],mt[ie+1],y,ie,!0),tt&&(E[me]=E[me]||[],E[me].push(tt[0]),(tt[1]!==mt[ie+1]||ie===Fe-2)&&(E[me].push(tt[1]),me++))}},_simplifyPoints:function(){for(var y=this._parts,E=this.options.smoothFactor,z=0,ie=y.length;z<ie;z++)y[z]=lr(y[z],E)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(y,E){var z,ie,me,Ee,Fe,tt,mt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(y))return!1;for(z=0,Ee=this._parts.length;z<Ee;z++)for(tt=this._parts[z],ie=0,Fe=tt.length,me=Fe-1;ie<Fe;me=ie++)if(!(!E&&ie===0)&&Sn(y,tt[me],tt[ie])<=mt)return!0;return!1}});function g(y,E){return new h(y,E)}h._flat=so;var b=h.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ar(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(y){var E=h.prototype._convertLatLngs.call(this,y),z=E.length;return z>=2&&E[0]instanceof oe&&E[0].equals(E[z-1])&&E.pop(),E},_setLatLngs:function(y){h.prototype._setLatLngs.call(this,y),Pa(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Pa(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var y=this._renderer._bounds,E=this.options.weight,z=new ce(E,E);if(y=new V(y.min.subtract(z),y.max.add(z)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(y))){if(this.options.noClip){this._parts=this._rings;return}for(var ie=0,me=this._rings.length,Ee;ie<me;ie++)Ee=Lt(this._rings[ie],y,!0),Ee.length&&this._parts.push(Ee)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(y){var E=!1,z,ie,me,Ee,Fe,tt,mt,kt;if(!this._pxBounds||!this._pxBounds.contains(y))return!1;for(Ee=0,mt=this._parts.length;Ee<mt;Ee++)for(z=this._parts[Ee],Fe=0,kt=z.length,tt=kt-1;Fe<kt;tt=Fe++)ie=z[Fe],me=z[tt],ie.y>y.y!=me.y>y.y&&y.x<(me.x-ie.x)*(y.y-ie.y)/(me.y-ie.y)+ie.x&&(E=!E);return E||h.prototype._containsPoint.call(this,y,!0)}});function S(y,E){return new b(y,E)}var N=Qs.extend({initialize:function(y,E){C(this,E),this._layers={},y&&this.addData(y)},addData:function(y){var E=D(y)?y:y.features,z,ie,me;if(E){for(z=0,ie=E.length;z<ie;z++)me=E[z],(me.geometries||me.geometry||me.features||me.coordinates)&&this.addData(me);return this}var Ee=this.options;if(Ee.filter&&!Ee.filter(y))return this;var Fe=I(y,Ee);return Fe?(Fe.feature=Me(y),Fe.defaultOptions=Fe.options,this.resetStyle(Fe),Ee.onEachFeature&&Ee.onEachFeature(y,Fe),this.addLayer(Fe)):this},resetStyle:function(y){return y===void 0?this.eachLayer(this.resetStyle,this):(y.options=a({},y.defaultOptions),this._setLayerStyle(y,this.options.style),this)},setStyle:function(y){return this.eachLayer(function(E){this._setLayerStyle(E,y)},this)},_setLayerStyle:function(y,E){y.setStyle&&(typeof E=="function"&&(E=E(y.feature)),y.setStyle(E))}});function I(y,E){var z=y.type==="Feature"?y.geometry:y,ie=z?z.coordinates:null,me=[],Ee=E&&E.pointToLayer,Fe=E&&E.coordsToLatLng||H,tt,mt,kt,Kt;if(!ie&&!z)return null;switch(z.type){case"Point":return tt=Fe(ie),R(Ee,y,tt,E);case"MultiPoint":for(kt=0,Kt=ie.length;kt<Kt;kt++)tt=Fe(ie[kt]),me.push(R(Ee,y,tt,E));return new Qs(me);case"LineString":case"MultiLineString":return mt=ne(ie,z.type==="LineString"?0:1,Fe),new h(mt,E);case"Polygon":case"MultiPolygon":return mt=ne(ie,z.type==="Polygon"?1:2,Fe),new b(mt,E);case"GeometryCollection":for(kt=0,Kt=z.geometries.length;kt<Kt;kt++){var br=I({geometry:z.geometries[kt],type:"Feature",properties:y.properties},E);br&&me.push(br)}return new Qs(me);case"FeatureCollection":for(kt=0,Kt=z.features.length;kt<Kt;kt++){var Cn=I(z.features[kt],E);Cn&&me.push(Cn)}return new Qs(me);default:throw new Error("Invalid GeoJSON object.")}}function R(y,E,z,ie){return y?y(E,z):new da(z,ie&&ie.markersInheritOptions&&ie)}function H(y){return new oe(y[1],y[0],y[2])}function ne(y,E,z){for(var ie=[],me=0,Ee=y.length,Fe;me<Ee;me++)Fe=E?ne(y[me],E-1,z):(z||H)(y[me]),ie.push(Fe);return ie}function he(y,E){return y=ge(y),y.alt!==void 0?[x(y.lng,E),x(y.lat,E),x(y.alt,E)]:[x(y.lng,E),x(y.lat,E)]}function ve(y,E,z,ie){for(var me=[],Ee=0,Fe=y.length;Ee<Fe;Ee++)me.push(E?ve(y[Ee],Pa(y[Ee])?0:E-1,z,ie):he(y[Ee],ie));return!E&&z&&me.length>0&&me.push(me[0].slice()),me}function Ne(y,E){return y.feature?a({},y.feature,{geometry:E}):Me(E)}function Me(y){return y.type==="Feature"||y.type==="FeatureCollection"?y:{type:"Feature",properties:{},geometry:y}}var qe={toGeoJSON:function(y){return Ne(this,{type:"Point",coordinates:he(this.getLatLng(),y)})}};da.include(qe),Zs.include(qe),is.include(qe),h.include({toGeoJSON:function(y){var E=!Pa(this._latlngs),z=ve(this._latlngs,E?1:0,!1,y);return Ne(this,{type:(E?"Multi":"")+"LineString",coordinates:z})}}),b.include({toGeoJSON:function(y){var E=!Pa(this._latlngs),z=E&&!Pa(this._latlngs[0]),ie=ve(this._latlngs,z?2:E?1:0,!0,y);return E||(ie=[ie]),Ne(this,{type:(z?"Multi":"")+"Polygon",coordinates:ie})}}),rs.include({toMultiPoint:function(y){var E=[];return this.eachLayer(function(z){E.push(z.toGeoJSON(y).geometry.coordinates)}),Ne(this,{type:"MultiPoint",coordinates:E})},toGeoJSON:function(y){var E=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(E==="MultiPoint")return this.toMultiPoint(y);var z=E==="GeometryCollection",ie=[];return this.eachLayer(function(me){if(me.toGeoJSON){var Ee=me.toGeoJSON(y);if(z)ie.push(Ee.geometry);else{var Fe=Me(Ee);Fe.type==="FeatureCollection"?ie.push.apply(ie,Fe.features):ie.push(Fe)}}}),z?Ne(this,{geometries:ie,type:"GeometryCollection"}):{type:"FeatureCollection",features:ie}}});function $e(y,E){return new N(y,E)}var Xe=$e,ct=qn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(y,E,z){this._url=y,this._bounds=W(E),C(this,z)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ir(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Rn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(y){return this.options.opacity=y,this._image&&this._updateOpacity(),this},setStyle:function(y){return y.opacity&&this.setOpacity(y.opacity),this},bringToFront:function(){return this._map&&Mr(this._image),this},bringToBack:function(){return this._map&&Qa(this._image),this},setUrl:function(y){return this._url=y,this._image&&(this._image.src=y),this},setBounds:function(y){return this._bounds=W(y),this._map&&this._reset(),this},getEvents:function(){var y={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(y.zoomanim=this._animateZoom),y},setZIndex:function(y){return this.options.zIndex=y,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var y=this._url.tagName==="IMG",E=this._image=y?this._url:Jr("img");if(ir(E,"leaflet-image-layer"),this._zoomAnimated&&ir(E,"leaflet-zoom-animated"),this.options.className&&ir(E,this.options.className),E.onselectstart=p,E.onmousemove=p,E.onload=o(this.fire,this,"load"),E.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(E.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),y){this._url=E.src;return}E.src=this._url,E.alt=this.options.alt},_animateZoom:function(y){var E=this._map.getZoomScale(y.zoom),z=this._map._latLngBoundsToNewLayerBounds(this._bounds,y.zoom,y.center).min;Pe(this._image,z,E)},_reset:function(){var y=this._image,E=new V(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),z=E.getSize();Ht(y,E.min),y.style.width=z.x+"px",y.style.height=z.y+"px"},_updateOpacity:function(){kr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var y=this.options.errorOverlayUrl;y&&this._url!==y&&(this._url=y,this._image.src=y)},getCenter:function(){return this._bounds.getCenter()}}),Tt=function(y,E,z){return new ct(y,E,z)},_t=ct.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var y=this._url.tagName==="VIDEO",E=this._image=y?this._url:Jr("video");if(ir(E,"leaflet-image-layer"),this._zoomAnimated&&ir(E,"leaflet-zoom-animated"),this.options.className&&ir(E,this.options.className),E.onselectstart=p,E.onmousemove=p,E.onloadeddata=o(this.fire,this,"load"),y){for(var z=E.getElementsByTagName("source"),ie=[],me=0;me<z.length;me++)ie.push(z[me].src);this._url=z.length>0?ie:[E.src];return}D(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(E.style,"objectFit")&&(E.style.objectFit="fill"),E.autoplay=!!this.options.autoplay,E.loop=!!this.options.loop,E.muted=!!this.options.muted,E.playsInline=!!this.options.playsInline;for(var Ee=0;Ee<this._url.length;Ee++){var Fe=Jr("source");Fe.src=this._url[Ee],E.appendChild(Fe)}}});function At(y,E,z){return new _t(y,E,z)}var Tr=ct.extend({_initImage:function(){var y=this._image=this._url;ir(y,"leaflet-image-layer"),this._zoomAnimated&&ir(y,"leaflet-zoom-animated"),this.options.className&&ir(y,this.options.className),y.onselectstart=p,y.onmousemove=p}});function qr(y,E,z){return new Tr(y,E,z)}var Mn=qn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(y,E){y&&(y instanceof oe||D(y))?(this._latlng=ge(y),C(this,E)):(C(this,y),this._source=E),this.options.content&&(this._content=this.options.content)},openOn:function(y){return y=arguments.length?y:this._source._map,y.hasLayer(this)||y.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(y){return this._map?this.close():(arguments.length?this._source=y:y=this._source,this._prepareOpen(),this.openOn(y._map)),this},onAdd:function(y){this._zoomAnimated=y._zoomAnimated,this._container||this._initLayout(),y._fadeAnimated&&kr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),y._fadeAnimated&&kr(this._container,1),this.bringToFront(),this.options.interactive&&(ir(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(y){y._fadeAnimated?(kr(this._container,0),this._removeTimeout=setTimeout(o(Rn,void 0,this._container),200)):Rn(this._container),this.options.interactive&&(Bn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(y){return this._latlng=ge(y),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(y){return this._content=y,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var y={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(y.zoomanim=this._animateZoom),y},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Mr(this._container),this},bringToBack:function(){return this._map&&Qa(this._container),this},_prepareOpen:function(y){var E=this._source;if(!E._map)return!1;if(E instanceof Qs){E=null;var z=this._source._layers;for(var ie in z)if(z[ie]._map){E=z[ie];break}if(!E)return!1;this._source=E}if(!y)if(E.getCenter)y=E.getCenter();else if(E.getLatLng)y=E.getLatLng();else if(E.getBounds)y=E.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(y),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var y=this._contentNode,E=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof E=="string")y.innerHTML=E;else{for(;y.hasChildNodes();)y.removeChild(y.firstChild);y.appendChild(E)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var y=this._map.latLngToLayerPoint(this._latlng),E=Se(this.options.offset),z=this._getAnchor();this._zoomAnimated?Ht(this._container,y.add(z)):E=E.add(y).add(z);var ie=this._containerBottom=-E.y,me=this._containerLeft=-Math.round(this._containerWidth/2)+E.x;this._container.style.bottom=ie+"px",this._container.style.left=me+"px"}},_getAnchor:function(){return[0,0]}});mn.include({_initOverlay:function(y,E,z,ie){var me=E;return me instanceof y||(me=new y(ie).setContent(E)),z&&me.setLatLng(z),me}}),qn.include({_initOverlay:function(y,E,z,ie){var me=z;return me instanceof y?(C(me,ie),me._source=this):(me=E&&!ie?E:new y(ie,this),me.setContent(z)),me}});var ua=Mn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(y){return y=arguments.length?y:this._source._map,!y.hasLayer(this)&&y._popup&&y._popup.options.autoClose&&y.removeLayer(y._popup),y._popup=this,Mn.prototype.openOn.call(this,y)},onAdd:function(y){Mn.prototype.onAdd.call(this,y),y.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _i||this._source.on("preclick",Rs))},onRemove:function(y){Mn.prototype.onRemove.call(this,y),y.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _i||this._source.off("preclick",Rs))},getEvents:function(){var y=Mn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(y.preclick=this.close),this.options.keepInView&&(y.moveend=this._adjustPan),y},_initLayout:function(){var y="leaflet-popup",E=this._container=Jr("div",y+" "+(this.options.className||"")+" leaflet-zoom-animated"),z=this._wrapper=Jr("div",y+"-content-wrapper",E);if(this._contentNode=Jr("div",y+"-content",z),Xa(E),fs(this._contentNode),qt(E,"contextmenu",Rs),this._tipContainer=Jr("div",y+"-tip-container",E),this._tip=Jr("div",y+"-tip",this._tipContainer),this.options.closeButton){var ie=this._closeButton=Jr("a",y+"-close-button",E);ie.setAttribute("role","button"),ie.setAttribute("aria-label","Close popup"),ie.href="#close",ie.innerHTML='<span aria-hidden="true">&#215;</span>',qt(ie,"click",function(me){mi(me),this.close()},this)}},_updateLayout:function(){var y=this._contentNode,E=y.style;E.width="",E.whiteSpace="nowrap";var z=y.offsetWidth;z=Math.min(z,this.options.maxWidth),z=Math.max(z,this.options.minWidth),E.width=z+1+"px",E.whiteSpace="",E.height="";var ie=y.offsetHeight,me=this.options.maxHeight,Ee="leaflet-popup-scrolled";me&&ie>me?(E.height=me+"px",ir(y,Ee)):Bn(y,Ee),this._containerWidth=this._container.offsetWidth},_animateZoom:function(y){var E=this._map._latLngToNewLayerPoint(this._latlng,y.zoom,y.center),z=this._getAnchor();Ht(this._container,E.add(z))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var y=this._map,E=parseInt(on(this._container,"marginBottom"),10)||0,z=this._container.offsetHeight+E,ie=this._containerWidth,me=new ce(this._containerLeft,-z-this._containerBottom);me._add(ni(this._container));var Ee=y.layerPointToContainerPoint(me),Fe=Se(this.options.autoPanPadding),tt=Se(this.options.autoPanPaddingTopLeft||Fe),mt=Se(this.options.autoPanPaddingBottomRight||Fe),kt=y.getSize(),Kt=0,br=0;Ee.x+ie+mt.x>kt.x&&(Kt=Ee.x+ie-kt.x+mt.x),Ee.x-Kt-tt.x<0&&(Kt=Ee.x-tt.x),Ee.y+z+mt.y>kt.y&&(br=Ee.y+z-kt.y+mt.y),Ee.y-br-tt.y<0&&(br=Ee.y-tt.y),(Kt||br)&&(this.options.keepInView&&(this._autopanning=!0),y.fire("autopanstart").panBy([Kt,br]))}},_getAnchor:function(){return Se(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ra=function(y,E){return new ua(y,E)};mn.mergeOptions({closePopupOnClick:!0}),mn.include({openPopup:function(y,E,z){return this._initOverlay(ua,y,E,z).openOn(this),this},closePopup:function(y){return y=arguments.length?y:this._popup,y&&y.close(),this}}),qn.include({bindPopup:function(y,E){return this._popup=this._initOverlay(ua,this._popup,y,E),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(y){return this._popup&&(this instanceof Qs||(this._popup._source=this),this._popup._prepareOpen(y||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(y){return this._popup&&this._popup.setContent(y),this},getPopup:function(){return this._popup},_openPopup:function(y){if(!(!this._popup||!this._map)){Ks(y);var E=y.layer||y.target;if(this._popup._source===E&&!(E instanceof _i)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(y.latlng);return}this._popup._source=E,this.openPopup(y.latlng)}},_movePopup:function(y){this._popup.setLatLng(y.latlng)},_onKeyPress:function(y){y.originalEvent.keyCode===13&&this._openPopup(y)}});var Un=Mn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(y){Mn.prototype.onAdd.call(this,y),this.setOpacity(this.options.opacity),y.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(y){Mn.prototype.onRemove.call(this,y),y.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var y=Mn.prototype.getEvents.call(this);return this.options.permanent||(y.preclick=this.close),y},_initLayout:function(){var y="leaflet-tooltip",E=y+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Jr("div",E),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(y){var E,z,ie=this._map,me=this._container,Ee=ie.latLngToContainerPoint(ie.getCenter()),Fe=ie.layerPointToContainerPoint(y),tt=this.options.direction,mt=me.offsetWidth,kt=me.offsetHeight,Kt=Se(this.options.offset),br=this._getAnchor();tt==="top"?(E=mt/2,z=kt):tt==="bottom"?(E=mt/2,z=0):tt==="center"?(E=mt/2,z=kt/2):tt==="right"?(E=0,z=kt/2):tt==="left"?(E=mt,z=kt/2):Fe.x<Ee.x?(tt="right",E=0,z=kt/2):(tt="left",E=mt+(Kt.x+br.x)*2,z=kt/2),y=y.subtract(Se(E,z,!0)).add(Kt).add(br),Bn(me,"leaflet-tooltip-right"),Bn(me,"leaflet-tooltip-left"),Bn(me,"leaflet-tooltip-top"),Bn(me,"leaflet-tooltip-bottom"),ir(me,"leaflet-tooltip-"+tt),Ht(me,y)},_updatePosition:function(){var y=this._map.latLngToLayerPoint(this._latlng);this._setPosition(y)},setOpacity:function(y){this.options.opacity=y,this._container&&kr(this._container,y)},_animateZoom:function(y){var E=this._map._latLngToNewLayerPoint(this._latlng,y.zoom,y.center);this._setPosition(E)},_getAnchor:function(){return Se(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ma=function(y,E){return new Un(y,E)};mn.include({openTooltip:function(y,E,z){return this._initOverlay(Un,y,E,z).openOn(this),this},closeTooltip:function(y){return y.close(),this}}),qn.include({bindTooltip:function(y,E){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Un,this._tooltip,y,E),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(y){if(!(!y&&this._tooltipHandlersAdded)){var E=y?"off":"on",z={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?z.add=this._openTooltip:(z.mouseover=this._openTooltip,z.mouseout=this.closeTooltip,z.click=this._openTooltip,this._map?this._addFocusListeners():z.add=this._addFocusListeners),this._tooltip.options.sticky&&(z.mousemove=this._moveTooltip),this[E](z),this._tooltipHandlersAdded=!y}},openTooltip:function(y){return this._tooltip&&(this instanceof Qs||(this._tooltip._source=this),this._tooltip._prepareOpen(y)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(y){return this._tooltip&&this._tooltip.setContent(y),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(y){var E=typeof y.getElement=="function"&&y.getElement();E&&(qt(E,"focus",function(){this._tooltip._source=y,this.openTooltip()},this),qt(E,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(y){var E=typeof y.getElement=="function"&&y.getElement();E&&E.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(y){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var E=this;this._map.once("moveend",function(){E._openOnceFlag=!1,E._openTooltip(y)});return}this._tooltip._source=y.layer||y.target,this.openTooltip(this._tooltip.options.sticky?y.latlng:void 0)}},_moveTooltip:function(y){var E=y.latlng,z,ie;this._tooltip.options.sticky&&y.originalEvent&&(z=this._map.mouseEventToContainerPoint(y.originalEvent),ie=this._map.containerPointToLayerPoint(z),E=this._map.layerPointToLatLng(ie)),this._tooltip.setLatLng(E)}});var Ms=ps.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(y){var E=y&&y.tagName==="DIV"?y:document.createElement("div"),z=this.options;if(z.html instanceof Element?(hs(E),E.appendChild(z.html)):E.innerHTML=z.html!==!1?z.html:"",z.bgPos){var ie=Se(z.bgPos);E.style.backgroundPosition=-ie.x+"px "+-ie.y+"px"}return this._setIconStyles(E,"icon"),E},createShadow:function(){return null}});function xc(y){return new Ms(y)}ps.Default=Ml;var Io=qn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:$t.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(y){C(this,y)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(y){y._addZoomLimit(this)},onRemove:function(y){this._removeAllTiles(),Rn(this._container),y._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Mr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Qa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(y){return this.options.opacity=y,this._updateOpacity(),this},setZIndex:function(y){return this.options.zIndex=y,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var y=this._clampZoom(this._map.getZoom());y!==this._tileZoom&&(this._tileZoom=y,this._updateLevels()),this._update()}return this},getEvents:function(){var y={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),y.move=this._onMove),this._zoomAnimated&&(y.zoomanim=this._animateZoom),y},createTile:function(){return document.createElement("div")},getTileSize:function(){var y=this.options.tileSize;return y instanceof ce?y:new ce(y,y)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(y){for(var E=this.getPane().children,z=-y(-1/0,1/0),ie=0,me=E.length,Ee;ie<me;ie++)Ee=E[ie].style.zIndex,E[ie]!==this._container&&Ee&&(z=y(z,+Ee));isFinite(z)&&(this.options.zIndex=z+y(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!$t.ielt9){kr(this._container,this.options.opacity);var y=+new Date,E=!1,z=!1;for(var ie in this._tiles){var me=this._tiles[ie];if(!(!me.current||!me.loaded)){var Ee=Math.min(1,(y-me.loaded)/200);kr(me.el,Ee),Ee<1?E=!0:(me.active?z=!0:this._onOpaqueTile(me),me.active=!0)}}z&&!this._noPrune&&this._pruneTiles(),E&&(Z(this._fadeFrame),this._fadeFrame=J(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Jr("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var y=this._tileZoom,E=this.options.maxZoom;if(y!==void 0){for(var z in this._levels)z=Number(z),this._levels[z].el.children.length||z===y?(this._levels[z].el.style.zIndex=E-Math.abs(y-z),this._onUpdateLevel(z)):(Rn(this._levels[z].el),this._removeTilesAtZoom(z),this._onRemoveLevel(z),delete this._levels[z]);var ie=this._levels[y],me=this._map;return ie||(ie=this._levels[y]={},ie.el=Jr("div","leaflet-tile-container leaflet-zoom-animated",this._container),ie.el.style.zIndex=E,ie.origin=me.project(me.unproject(me.getPixelOrigin()),y).round(),ie.zoom=y,this._setZoomTransform(ie,me.getCenter(),me.getZoom()),p(ie.el.offsetWidth),this._onCreateLevel(ie)),this._level=ie,ie}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var y,E,z=this._map.getZoom();if(z>this.options.maxZoom||z<this.options.minZoom){this._removeAllTiles();return}for(y in this._tiles)E=this._tiles[y],E.retain=E.current;for(y in this._tiles)if(E=this._tiles[y],E.current&&!E.active){var ie=E.coords;this._retainParent(ie.x,ie.y,ie.z,ie.z-5)||this._retainChildren(ie.x,ie.y,ie.z,ie.z+2)}for(y in this._tiles)this._tiles[y].retain||this._removeTile(y)}},_removeTilesAtZoom:function(y){for(var E in this._tiles)this._tiles[E].coords.z===y&&this._removeTile(E)},_removeAllTiles:function(){for(var y in this._tiles)this._removeTile(y)},_invalidateAll:function(){for(var y in this._levels)Rn(this._levels[y].el),this._onRemoveLevel(Number(y)),delete this._levels[y];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(y,E,z,ie){var me=Math.floor(y/2),Ee=Math.floor(E/2),Fe=z-1,tt=new ce(+me,+Ee);tt.z=+Fe;var mt=this._tileCoordsToKey(tt),kt=this._tiles[mt];return kt&&kt.active?(kt.retain=!0,!0):(kt&&kt.loaded&&(kt.retain=!0),Fe>ie?this._retainParent(me,Ee,Fe,ie):!1)},_retainChildren:function(y,E,z,ie){for(var me=2*y;me<2*y+2;me++)for(var Ee=2*E;Ee<2*E+2;Ee++){var Fe=new ce(me,Ee);Fe.z=z+1;var tt=this._tileCoordsToKey(Fe),mt=this._tiles[tt];if(mt&&mt.active){mt.retain=!0;continue}else mt&&mt.loaded&&(mt.retain=!0);z+1<ie&&this._retainChildren(me,Ee,z+1,ie)}},_resetView:function(y){var E=y&&(y.pinch||y.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),E,E)},_animateZoom:function(y){this._setView(y.center,y.zoom,!0,y.noUpdate)},_clampZoom:function(y){var E=this.options;return E.minNativeZoom!==void 0&&y<E.minNativeZoom?E.minNativeZoom:E.maxNativeZoom!==void 0&&E.maxNativeZoom<y?E.maxNativeZoom:y},_setView:function(y,E,z,ie){var me=Math.round(E);this.options.maxZoom!==void 0&&me>this.options.maxZoom||this.options.minZoom!==void 0&&me<this.options.minZoom?me=void 0:me=this._clampZoom(me);var Ee=this.options.updateWhenZooming&&me!==this._tileZoom;(!ie||Ee)&&(this._tileZoom=me,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),me!==void 0&&this._update(y),z||this._pruneTiles(),this._noPrune=!!z),this._setZoomTransforms(y,E)},_setZoomTransforms:function(y,E){for(var z in this._levels)this._setZoomTransform(this._levels[z],y,E)},_setZoomTransform:function(y,E,z){var ie=this._map.getZoomScale(z,y.zoom),me=y.origin.multiplyBy(ie).subtract(this._map._getNewPixelOrigin(E,z)).round();$t.any3d?Pe(y.el,me,ie):Ht(y.el,me)},_resetGrid:function(){var y=this._map,E=y.options.crs,z=this._tileSize=this.getTileSize(),ie=this._tileZoom,me=this._map.getPixelWorldBounds(this._tileZoom);me&&(this._globalTileRange=this._pxBoundsToTileRange(me)),this._wrapX=E.wrapLng&&!this.options.noWrap&&[Math.floor(y.project([0,E.wrapLng[0]],ie).x/z.x),Math.ceil(y.project([0,E.wrapLng[1]],ie).x/z.y)],this._wrapY=E.wrapLat&&!this.options.noWrap&&[Math.floor(y.project([E.wrapLat[0],0],ie).y/z.x),Math.ceil(y.project([E.wrapLat[1],0],ie).y/z.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(y){var E=this._map,z=E._animatingZoom?Math.max(E._animateToZoom,E.getZoom()):E.getZoom(),ie=E.getZoomScale(z,this._tileZoom),me=E.project(y,this._tileZoom).floor(),Ee=E.getSize().divideBy(ie*2);return new V(me.subtract(Ee),me.add(Ee))},_update:function(y){var E=this._map;if(E){var z=this._clampZoom(E.getZoom());if(y===void 0&&(y=E.getCenter()),this._tileZoom!==void 0){var ie=this._getTiledPixelBounds(y),me=this._pxBoundsToTileRange(ie),Ee=me.getCenter(),Fe=[],tt=this.options.keepBuffer,mt=new V(me.getBottomLeft().subtract([tt,-tt]),me.getTopRight().add([tt,-tt]));if(!(isFinite(me.min.x)&&isFinite(me.min.y)&&isFinite(me.max.x)&&isFinite(me.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var kt in this._tiles){var Kt=this._tiles[kt].coords;(Kt.z!==this._tileZoom||!mt.contains(new ce(Kt.x,Kt.y)))&&(this._tiles[kt].current=!1)}if(Math.abs(z-this._tileZoom)>1){this._setView(y,z);return}for(var br=me.min.y;br<=me.max.y;br++)for(var Cn=me.min.x;Cn<=me.max.x;Cn++){var Bs=new ce(Cn,br);if(Bs.z=this._tileZoom,!!this._isValidTile(Bs)){var ba=this._tiles[this._tileCoordsToKey(Bs)];ba?ba.current=!0:Fe.push(Bs)}}if(Fe.sort(function(ii,ai){return ii.distanceTo(Ee)-ai.distanceTo(Ee)}),Fe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var al=document.createDocumentFragment();for(Cn=0;Cn<Fe.length;Cn++)this._addTile(Fe[Cn],al);this._level.el.appendChild(al)}}}},_isValidTile:function(y){var E=this._map.options.crs;if(!E.infinite){var z=this._globalTileRange;if(!E.wrapLng&&(y.x<z.min.x||y.x>z.max.x)||!E.wrapLat&&(y.y<z.min.y||y.y>z.max.y))return!1}if(!this.options.bounds)return!0;var ie=this._tileCoordsToBounds(y);return W(this.options.bounds).overlaps(ie)},_keyToBounds:function(y){return this._tileCoordsToBounds(this._keyToTileCoords(y))},_tileCoordsToNwSe:function(y){var E=this._map,z=this.getTileSize(),ie=y.scaleBy(z),me=ie.add(z),Ee=E.unproject(ie,y.z),Fe=E.unproject(me,y.z);return[Ee,Fe]},_tileCoordsToBounds:function(y){var E=this._tileCoordsToNwSe(y),z=new se(E[0],E[1]);return this.options.noWrap||(z=this._map.wrapLatLngBounds(z)),z},_tileCoordsToKey:function(y){return y.x+":"+y.y+":"+y.z},_keyToTileCoords:function(y){var E=y.split(":"),z=new ce(+E[0],+E[1]);return z.z=+E[2],z},_removeTile:function(y){var E=this._tiles[y];E&&(Rn(E.el),delete this._tiles[y],this.fire("tileunload",{tile:E.el,coords:this._keyToTileCoords(y)}))},_initTile:function(y){ir(y,"leaflet-tile");var E=this.getTileSize();y.style.width=E.x+"px",y.style.height=E.y+"px",y.onselectstart=p,y.onmousemove=p,$t.ielt9&&this.options.opacity<1&&kr(y,this.options.opacity)},_addTile:function(y,E){var z=this._getTilePos(y),ie=this._tileCoordsToKey(y),me=this.createTile(this._wrapCoords(y),o(this._tileReady,this,y));this._initTile(me),this.createTile.length<2&&J(o(this._tileReady,this,y,null,me)),Ht(me,z),this._tiles[ie]={el:me,coords:y,current:!0},E.appendChild(me),this.fire("tileloadstart",{tile:me,coords:y})},_tileReady:function(y,E,z){E&&this.fire("tileerror",{error:E,tile:z,coords:y});var ie=this._tileCoordsToKey(y);z=this._tiles[ie],z&&(z.loaded=+new Date,this._map._fadeAnimated?(kr(z.el,0),Z(this._fadeFrame),this._fadeFrame=J(this._updateOpacity,this)):(z.active=!0,this._pruneTiles()),E||(ir(z.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:z.el,coords:y})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),$t.ielt9||!this._map._fadeAnimated?J(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(y){return y.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(y){var E=new ce(this._wrapX?f(y.x,this._wrapX):y.x,this._wrapY?f(y.y,this._wrapY):y.y);return E.z=y.z,E},_pxBoundsToTileRange:function(y){var E=this.getTileSize();return new V(y.min.unscaleBy(E).floor(),y.max.unscaleBy(E).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var y in this._tiles)if(!this._tiles[y].loaded)return!1;return!0}});function ju(y){return new Io(y)}var Oo=Io.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(y,E){this._url=y,E=C(this,E),E.detectRetina&&$t.retina&&E.maxZoom>0?(E.tileSize=Math.floor(E.tileSize/2),E.zoomReverse?(E.zoomOffset--,E.minZoom=Math.min(E.maxZoom,E.minZoom+1)):(E.zoomOffset++,E.maxZoom=Math.max(E.minZoom,E.maxZoom-1)),E.minZoom=Math.max(0,E.minZoom)):E.zoomReverse?E.minZoom=Math.min(E.maxZoom,E.minZoom):E.maxZoom=Math.max(E.minZoom,E.maxZoom),typeof E.subdomains=="string"&&(E.subdomains=E.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(y,E){return this._url===y&&E===void 0&&(E=!0),this._url=y,E||this.redraw(),this},createTile:function(y,E){var z=document.createElement("img");return qt(z,"load",o(this._tileOnLoad,this,E,z)),qt(z,"error",o(this._tileOnError,this,E,z)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(z.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(z.referrerPolicy=this.options.referrerPolicy),z.alt="",z.src=this.getTileUrl(y),z},getTileUrl:function(y){var E={r:$t.retina?"@2x":"",s:this._getSubdomain(y),x:y.x,y:y.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var z=this._globalTileRange.max.y-y.y;this.options.tms&&(E.y=z),E["-y"]=z}return O(this._url,a(E,this.options))},_tileOnLoad:function(y,E){$t.ielt9?setTimeout(o(y,this,null,E),0):y(null,E)},_tileOnError:function(y,E,z){var ie=this.options.errorTileUrl;ie&&E.getAttribute("src")!==ie&&(E.src=ie),y(z,E)},_onTileRemove:function(y){y.tile.onload=null},_getZoomForUrl:function(){var y=this._tileZoom,E=this.options.maxZoom,z=this.options.zoomReverse,ie=this.options.zoomOffset;return z&&(y=E-y),y+ie},_getSubdomain:function(y){var E=Math.abs(y.x+y.y)%this.options.subdomains.length;return this.options.subdomains[E]},_abortLoading:function(){var y,E;for(y in this._tiles)if(this._tiles[y].coords.z!==this._tileZoom&&(E=this._tiles[y].el,E.onload=p,E.onerror=p,!E.complete)){E.src=Q;var z=this._tiles[y].coords;Rn(E),delete this._tiles[y],this.fire("tileabort",{tile:E,coords:z})}},_removeTile:function(y){var E=this._tiles[y];if(E)return E.el.setAttribute("src",Q),Io.prototype._removeTile.call(this,y)},_tileReady:function(y,E,z){if(!(!this._map||z&&z.getAttribute("src")===Q))return Io.prototype._tileReady.call(this,y,E,z)}});function rl(y,E){return new Oo(y,E)}var Pd=Oo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(y,E){this._url=y;var z=a({},this.defaultWmsParams);for(var ie in E)ie in this.options||(z[ie]=E[ie]);E=C(this,E);var me=E.detectRetina&&$t.retina?2:1,Ee=this.getTileSize();z.width=Ee.x*me,z.height=Ee.y*me,this.wmsParams=z},onAdd:function(y){this._crs=this.options.crs||y.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var E=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[E]=this._crs.code,Oo.prototype.onAdd.call(this,y)},getTileUrl:function(y){var E=this._tileCoordsToNwSe(y),z=this._crs,ie=X(z.project(E[0]),z.project(E[1])),me=ie.min,Ee=ie.max,Fe=(this._wmsVersion>=1.3&&this._crs===el?[me.y,me.x,Ee.y,Ee.x]:[me.x,me.y,Ee.x,Ee.y]).join(","),tt=Oo.prototype.getTileUrl.call(this,y);return tt+A(this.wmsParams,tt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Fe},setParams:function(y,E){return a(this.wmsParams,y),E||this.redraw(),this}});function nl(y,E){return new Pd(y,E)}Oo.WMS=Pd,rl.wms=nl;var co=qn.extend({options:{padding:.1},initialize:function(y){C(this,y),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ir(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var y={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(y.zoomanim=this._onAnimZoom),y},_onAnimZoom:function(y){this._updateTransform(y.center,y.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(y,E){var z=this._map.getZoomScale(E,this._zoom),ie=this._map.getSize().multiplyBy(.5+this.options.padding),me=this._map.project(this._center,E),Ee=ie.multiplyBy(-z).add(me).subtract(this._map._getNewPixelOrigin(y,E));$t.any3d?Pe(this._container,Ee,z):Ht(this._container,Ee)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var y in this._layers)this._layers[y]._reset()},_onZoomEnd:function(){for(var y in this._layers)this._layers[y]._project()},_updatePaths:function(){for(var y in this._layers)this._layers[y]._update()},_update:function(){var y=this.options.padding,E=this._map.getSize(),z=this._map.containerPointToLayerPoint(E.multiplyBy(-y)).round();this._bounds=new V(z,z.add(E.multiplyBy(1+y*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),wu=co.extend({options:{tolerance:0},getEvents:function(){var y=co.prototype.getEvents.call(this);return y.viewprereset=this._onViewPreReset,y},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){co.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var y=this._container=document.createElement("canvas");qt(y,"mousemove",this._onMouseMove,this),qt(y,"click dblclick mousedown mouseup contextmenu",this._onClick,this),qt(y,"mouseout",this._handleMouseOut,this),y._leaflet_disable_events=!0,this._ctx=y.getContext("2d")},_destroyContainer:function(){Z(this._redrawRequest),delete this._ctx,Rn(this._container),Zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var y;this._redrawBounds=null;for(var E in this._layers)y=this._layers[E],y._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){co.prototype._update.call(this);var y=this._bounds,E=this._container,z=y.getSize(),ie=$t.retina?2:1;Ht(E,y.min),E.width=ie*z.x,E.height=ie*z.y,E.style.width=z.x+"px",E.style.height=z.y+"px",$t.retina&&this._ctx.scale(2,2),this._ctx.translate(-y.min.x,-y.min.y),this.fire("update")}},_reset:function(){co.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(y){this._updateDashArray(y),this._layers[u(y)]=y;var E=y._order={layer:y,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=E),this._drawLast=E,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(y){this._requestRedraw(y)},_removePath:function(y){var E=y._order,z=E.next,ie=E.prev;z?z.prev=ie:this._drawLast=ie,ie?ie.next=z:this._drawFirst=z,delete y._order,delete this._layers[u(y)],this._requestRedraw(y)},_updatePath:function(y){this._extendRedrawBounds(y),y._project(),y._update(),this._requestRedraw(y)},_updateStyle:function(y){this._updateDashArray(y),this._requestRedraw(y)},_updateDashArray:function(y){if(typeof y.options.dashArray=="string"){var E=y.options.dashArray.split(/[, ]+/),z=[],ie,me;for(me=0;me<E.length;me++){if(ie=Number(E[me]),isNaN(ie))return;z.push(ie)}y.options._dashArray=z}else y.options._dashArray=y.options.dashArray},_requestRedraw:function(y){this._map&&(this._extendRedrawBounds(y),this._redrawRequest=this._redrawRequest||J(this._redraw,this))},_extendRedrawBounds:function(y){if(y._pxBounds){var E=(y.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new V,this._redrawBounds.extend(y._pxBounds.min.subtract([E,E])),this._redrawBounds.extend(y._pxBounds.max.add([E,E]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var y=this._redrawBounds;if(y){var E=y.getSize();this._ctx.clearRect(y.min.x,y.min.y,E.x,E.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var y,E=this._redrawBounds;if(this._ctx.save(),E){var z=E.getSize();this._ctx.beginPath(),this._ctx.rect(E.min.x,E.min.y,z.x,z.y),this._ctx.clip()}this._drawing=!0;for(var ie=this._drawFirst;ie;ie=ie.next)y=ie.layer,(!E||y._pxBounds&&y._pxBounds.intersects(E))&&y._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(y,E){if(this._drawing){var z,ie,me,Ee,Fe=y._parts,tt=Fe.length,mt=this._ctx;if(tt){for(mt.beginPath(),z=0;z<tt;z++){for(ie=0,me=Fe[z].length;ie<me;ie++)Ee=Fe[z][ie],mt[ie?"lineTo":"moveTo"](Ee.x,Ee.y);E&&mt.closePath()}this._fillStroke(mt,y)}}},_updateCircle:function(y){if(!(!this._drawing||y._empty())){var E=y._point,z=this._ctx,ie=Math.max(Math.round(y._radius),1),me=(Math.max(Math.round(y._radiusY),1)||ie)/ie;me!==1&&(z.save(),z.scale(1,me)),z.beginPath(),z.arc(E.x,E.y/me,ie,0,Math.PI*2,!1),me!==1&&z.restore(),this._fillStroke(z,y)}},_fillStroke:function(y,E){var z=E.options;z.fill&&(y.globalAlpha=z.fillOpacity,y.fillStyle=z.fillColor||z.color,y.fill(z.fillRule||"evenodd")),z.stroke&&z.weight!==0&&(y.setLineDash&&y.setLineDash(E.options&&E.options._dashArray||[]),y.globalAlpha=z.opacity,y.lineWidth=z.weight,y.strokeStyle=z.color,y.lineCap=z.lineCap,y.lineJoin=z.lineJoin,y.stroke())},_onClick:function(y){for(var E=this._map.mouseEventToLayerPoint(y),z,ie,me=this._drawFirst;me;me=me.next)z=me.layer,z.options.interactive&&z._containsPoint(E)&&(!(y.type==="click"||y.type==="preclick")||!this._map._draggableMoved(z))&&(ie=z);this._fireEvent(ie?[ie]:!1,y)},_onMouseMove:function(y){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var E=this._map.mouseEventToLayerPoint(y);this._handleMouseHover(y,E)}},_handleMouseOut:function(y){var E=this._hoveredLayer;E&&(Bn(this._container,"leaflet-interactive"),this._fireEvent([E],y,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(y,E){if(!this._mouseHoverThrottled){for(var z,ie,me=this._drawFirst;me;me=me.next)z=me.layer,z.options.interactive&&z._containsPoint(E)&&(ie=z);ie!==this._hoveredLayer&&(this._handleMouseOut(y),ie&&(ir(this._container,"leaflet-interactive"),this._fireEvent([ie],y,"mouseover"),this._hoveredLayer=ie)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,y),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(y,E,z){this._map._fireDOMEvent(E,z||E.type,y)},_bringToFront:function(y){var E=y._order;if(E){var z=E.next,ie=E.prev;if(z)z.prev=ie;else return;ie?ie.next=z:z&&(this._drawFirst=z),E.prev=this._drawLast,this._drawLast.next=E,E.next=null,this._drawLast=E,this._requestRedraw(y)}},_bringToBack:function(y){var E=y._order;if(E){var z=E.next,ie=E.prev;if(ie)ie.next=z;else return;z?z.prev=ie:ie&&(this._drawLast=ie),E.prev=null,E.next=this._drawFirst,this._drawFirst.prev=E,this._drawFirst=E,this._requestRedraw(y)}}});function Rd(y){return $t.canvas?new wu(y):null}var vc=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(y){return document.createElement("<lvml:"+y+' class="lvml">')}}catch{}return function(y){return document.createElement("<"+y+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Sh={_initContainer:function(){this._container=Jr("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(co.prototype._update.call(this),this.fire("update"))},_initPath:function(y){var E=y._container=vc("shape");ir(E,"leaflet-vml-shape "+(this.options.className||"")),E.coordsize="1 1",y._path=vc("path"),E.appendChild(y._path),this._updateStyle(y),this._layers[u(y)]=y},_addPath:function(y){var E=y._container;this._container.appendChild(E),y.options.interactive&&y.addInteractiveTarget(E)},_removePath:function(y){var E=y._container;Rn(E),y.removeInteractiveTarget(E),delete this._layers[u(y)]},_updateStyle:function(y){var E=y._stroke,z=y._fill,ie=y.options,me=y._container;me.stroked=!!ie.stroke,me.filled=!!ie.fill,ie.stroke?(E||(E=y._stroke=vc("stroke")),me.appendChild(E),E.weight=ie.weight+"px",E.color=ie.color,E.opacity=ie.opacity,ie.dashArray?E.dashStyle=D(ie.dashArray)?ie.dashArray.join(" "):ie.dashArray.replace(/( *, *)/g," "):E.dashStyle="",E.endcap=ie.lineCap.replace("butt","flat"),E.joinstyle=ie.lineJoin):E&&(me.removeChild(E),y._stroke=null),ie.fill?(z||(z=y._fill=vc("fill")),me.appendChild(z),z.color=ie.fillColor||ie.color,z.opacity=ie.fillOpacity):z&&(me.removeChild(z),y._fill=null)},_updateCircle:function(y){var E=y._point.round(),z=Math.round(y._radius),ie=Math.round(y._radiusY||z);this._setPath(y,y._empty()?"M0 0":"AL "+E.x+","+E.y+" "+z+","+ie+" 0,"+65535*360)},_setPath:function(y,E){y._path.v=E},_bringToFront:function(y){Mr(y._container)},_bringToBack:function(y){Qa(y._container)}},yl=$t.vml?vc:Oe,bc=co.extend({_initContainer:function(){this._container=yl("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yl("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Rn(this._container),Zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){co.prototype._update.call(this);var y=this._bounds,E=y.getSize(),z=this._container;(!this._svgSize||!this._svgSize.equals(E))&&(this._svgSize=E,z.setAttribute("width",E.x),z.setAttribute("height",E.y)),Ht(z,y.min),z.setAttribute("viewBox",[y.min.x,y.min.y,E.x,E.y].join(" ")),this.fire("update")}},_initPath:function(y){var E=y._path=yl("path");y.options.className&&ir(E,y.options.className),y.options.interactive&&ir(E,"leaflet-interactive"),this._updateStyle(y),this._layers[u(y)]=y},_addPath:function(y){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(y._path),y.addInteractiveTarget(y._path)},_removePath:function(y){Rn(y._path),y.removeInteractiveTarget(y._path),delete this._layers[u(y)]},_updatePath:function(y){y._project(),y._update()},_updateStyle:function(y){var E=y._path,z=y.options;E&&(z.stroke?(E.setAttribute("stroke",z.color),E.setAttribute("stroke-opacity",z.opacity),E.setAttribute("stroke-width",z.weight),E.setAttribute("stroke-linecap",z.lineCap),E.setAttribute("stroke-linejoin",z.lineJoin),z.dashArray?E.setAttribute("stroke-dasharray",z.dashArray):E.removeAttribute("stroke-dasharray"),z.dashOffset?E.setAttribute("stroke-dashoffset",z.dashOffset):E.removeAttribute("stroke-dashoffset")):E.setAttribute("stroke","none"),z.fill?(E.setAttribute("fill",z.fillColor||z.color),E.setAttribute("fill-opacity",z.fillOpacity),E.setAttribute("fill-rule",z.fillRule||"evenodd")):E.setAttribute("fill","none"))},_updatePoly:function(y,E){this._setPath(y,st(y._parts,E))},_updateCircle:function(y){var E=y._point,z=Math.max(Math.round(y._radius),1),ie=Math.max(Math.round(y._radiusY),1)||z,me="a"+z+","+ie+" 0 1,0 ",Ee=y._empty()?"M0 0":"M"+(E.x-z)+","+E.y+me+z*2+",0 "+me+-z*2+",0 ";this._setPath(y,Ee)},_setPath:function(y,E){y._path.setAttribute("d",E)},_bringToFront:function(y){Mr(y._path)},_bringToBack:function(y){Qa(y._path)}});$t.vml&&bc.include(Sh);function Ls(y){return $t.svg||$t.vml?new bc(y):null}mn.include({getRenderer:function(y){var E=y.options.renderer||this._getPaneRenderer(y.options.pane)||this.options.renderer||this._renderer;return E||(E=this._renderer=this._createRenderer()),this.hasLayer(E)||this.addLayer(E),E},_getPaneRenderer:function(y){if(y==="overlayPane"||y===void 0)return!1;var E=this._paneRenderers[y];return E===void 0&&(E=this._createRenderer({pane:y}),this._paneRenderers[y]=E),E},_createRenderer:function(y){return this.options.preferCanvas&&Rd(y)||Ls(y)}});var gs=b.extend({initialize:function(y,E){b.prototype.initialize.call(this,this._boundsToLatLngs(y),E)},setBounds:function(y){return this.setLatLngs(this._boundsToLatLngs(y))},_boundsToLatLngs:function(y){return y=W(y),[y.getSouthWest(),y.getNorthWest(),y.getNorthEast(),y.getSouthEast()]}});function Ch(y,E){return new gs(y,E)}bc.create=yl,bc.pointsToPath=st,N.geometryToLayer=I,N.coordsToLatLng=H,N.coordsToLatLngs=ne,N.latLngToCoords=he,N.latLngsToCoords=ve,N.getFeature=Ne,N.asFeature=Me,mn.mergeOptions({boxZoom:!0});var zs=Re.extend({initialize:function(y){this._map=y,this._container=y._container,this._pane=y._panes.overlayPane,this._resetStateTimeout=0,y.on("unload",this._destroy,this)},addHooks:function(){qt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Rn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(y){if(!y.shiftKey||y.which!==1&&y.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),la(),Cr(),this._startPoint=this._map.mouseEventToContainerPoint(y),qt(document,{contextmenu:Ks,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(y){this._moved||(this._moved=!0,this._box=Jr("div","leaflet-zoom-box",this._container),ir(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(y);var E=new V(this._point,this._startPoint),z=E.getSize();Ht(this._box,E.min),this._box.style.width=z.x+"px",this._box.style.height=z.y+"px"},_finish:function(){this._moved&&(Rn(this._box),Bn(this._container,"leaflet-crosshair")),Ps(),Jn(),Zt(document,{contextmenu:Ks,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(y){if(!(y.which!==1&&y.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var E=new se(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(E).fire("boxzoomend",{boxZoomBounds:E})}},_onKeyDown:function(y){y.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});mn.addInitHook("addHandler","boxZoom",zs),mn.mergeOptions({doubleClickZoom:!0});var Su=Re.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(y){var E=this._map,z=E.getZoom(),ie=E.options.zoomDelta,me=y.originalEvent.shiftKey?z-ie:z+ie;E.options.doubleClickZoom==="center"?E.setZoom(me):E.setZoomAround(y.containerPoint,me)}});mn.addInitHook("addHandler","doubleClickZoom",Su),mn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var il=Re.extend({addHooks:function(){if(!this._draggable){var y=this._map;this._draggable=new Ct(y._mapPane,y._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),y.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),y.on("zoomend",this._onZoomEnd,this),y.whenReady(this._onZoomEnd,this))}ir(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Bn(this._map._container,"leaflet-grab"),Bn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var y=this._map;if(y._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var E=W(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(E.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(E.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;y.fire("movestart").fire("dragstart"),y.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(y){if(this._map.options.inertia){var E=this._lastTime=+new Date,z=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(z),this._times.push(E),this._prunePositions(E)}this._map.fire("move",y).fire("drag",y)},_prunePositions:function(y){for(;this._positions.length>1&&y-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var y=this._map.getSize().divideBy(2),E=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=E.subtract(y).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(y,E){return y-(y-E)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var y=this._draggable._newPos.subtract(this._draggable._startPos),E=this._offsetLimit;y.x<E.min.x&&(y.x=this._viscousLimit(y.x,E.min.x)),y.y<E.min.y&&(y.y=this._viscousLimit(y.y,E.min.y)),y.x>E.max.x&&(y.x=this._viscousLimit(y.x,E.max.x)),y.y>E.max.y&&(y.y=this._viscousLimit(y.y,E.max.y)),this._draggable._newPos=this._draggable._startPos.add(y)}},_onPreDragWrap:function(){var y=this._worldWidth,E=Math.round(y/2),z=this._initialWorldOffset,ie=this._draggable._newPos.x,me=(ie-E+z)%y+E-z,Ee=(ie+E+z)%y-E-z,Fe=Math.abs(me+z)<Math.abs(Ee+z)?me:Ee;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Fe},_onDragEnd:function(y){var E=this._map,z=E.options,ie=!z.inertia||y.noInertia||this._times.length<2;if(E.fire("dragend",y),ie)E.fire("moveend");else{this._prunePositions(+new Date);var me=this._lastPos.subtract(this._positions[0]),Ee=(this._lastTime-this._times[0])/1e3,Fe=z.easeLinearity,tt=me.multiplyBy(Fe/Ee),mt=tt.distanceTo([0,0]),kt=Math.min(z.inertiaMaxSpeed,mt),Kt=tt.multiplyBy(kt/mt),br=kt/(z.inertiaDeceleration*Fe),Cn=Kt.multiplyBy(-br/2).round();!Cn.x&&!Cn.y?E.fire("moveend"):(Cn=E._limitOffset(Cn,E.options.maxBounds),J(function(){E.panBy(Cn,{duration:br,easeLinearity:Fe,noMoveStart:!0,animate:!0})}))}}});mn.addInitHook("addHandler","dragging",il),mn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Md=Re.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(y){this._map=y,this._setPanDelta(y.options.keyboardPanDelta),this._setZoomDelta(y.options.zoomDelta)},addHooks:function(){var y=this._map._container;y.tabIndex<=0&&(y.tabIndex="0"),qt(y,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var y=document.body,E=document.documentElement,z=y.scrollTop||E.scrollTop,ie=y.scrollLeft||E.scrollLeft;this._map._container.focus(),window.scrollTo(ie,z)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(y){var E=this._panKeys={},z=this.keyCodes,ie,me;for(ie=0,me=z.left.length;ie<me;ie++)E[z.left[ie]]=[-1*y,0];for(ie=0,me=z.right.length;ie<me;ie++)E[z.right[ie]]=[y,0];for(ie=0,me=z.down.length;ie<me;ie++)E[z.down[ie]]=[0,y];for(ie=0,me=z.up.length;ie<me;ie++)E[z.up[ie]]=[0,-1*y]},_setZoomDelta:function(y){var E=this._zoomKeys={},z=this.keyCodes,ie,me;for(ie=0,me=z.zoomIn.length;ie<me;ie++)E[z.zoomIn[ie]]=y;for(ie=0,me=z.zoomOut.length;ie<me;ie++)E[z.zoomOut[ie]]=-y},_addHooks:function(){qt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(y){if(!(y.altKey||y.ctrlKey||y.metaKey)){var E=y.keyCode,z=this._map,ie;if(E in this._panKeys){if(!z._panAnim||!z._panAnim._inProgress)if(ie=this._panKeys[E],y.shiftKey&&(ie=Se(ie).multiplyBy(3)),z.options.maxBounds&&(ie=z._limitOffset(Se(ie),z.options.maxBounds)),z.options.worldCopyJump){var me=z.wrapLatLng(z.unproject(z.project(z.getCenter()).add(ie)));z.panTo(me)}else z.panBy(ie)}else if(E in this._zoomKeys)z.setZoom(z.getZoom()+(y.shiftKey?3:1)*this._zoomKeys[E]);else if(E===27&&z._popup&&z._popup.options.closeOnEscapeKey)z.closePopup();else return;Ks(y)}}});mn.addInitHook("addHandler","keyboard",Md),mn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var hd=Re.extend({addHooks:function(){qt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(y){var E=ki(y),z=this._map.options.wheelDebounceTime;this._delta+=E,this._lastMousePos=this._map.mouseEventToContainerPoint(y),this._startTime||(this._startTime=+new Date);var ie=Math.max(z-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),ie),Ks(y)},_performZoom:function(){var y=this._map,E=y.getZoom(),z=this._map.options.zoomSnap||0;y._stop();var ie=this._delta/(this._map.options.wheelPxPerZoomLevel*4),me=4*Math.log(2/(1+Math.exp(-Math.abs(ie))))/Math.LN2,Ee=z?Math.ceil(me/z)*z:me,Fe=y._limitZoom(E+(this._delta>0?Ee:-Ee))-E;this._delta=0,this._startTime=null,Fe&&(y.options.scrollWheelZoom==="center"?y.setZoom(E+Fe):y.setZoomAround(this._lastMousePos,E+Fe))}});mn.addInitHook("addHandler","scrollWheelZoom",hd);var Uc=600;mn.mergeOptions({tapHold:$t.touchNative&&$t.safari&&$t.mobile,tapTolerance:15});var Ld=Re.extend({addHooks:function(){qt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(y){if(clearTimeout(this._holdTimeout),y.touches.length===1){var E=y.touches[0];this._startPos=this._newPos=new ce(E.clientX,E.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(qt(document,"touchend",mi),qt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",E))},this),Uc),qt(document,"touchend touchcancel contextmenu",this._cancel,this),qt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function y(){Zt(document,"touchend",mi),Zt(document,"touchend touchcancel",y)},_cancel:function(){clearTimeout(this._holdTimeout),Zt(document,"touchend touchcancel contextmenu",this._cancel,this),Zt(document,"touchmove",this._onMove,this)},_onMove:function(y){var E=y.touches[0];this._newPos=new ce(E.clientX,E.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(y,E){var z=new MouseEvent(y,{bubbles:!0,cancelable:!0,view:window,screenX:E.screenX,screenY:E.screenY,clientX:E.clientX,clientY:E.clientY});z._simulated=!0,E.target.dispatchEvent(z)}});mn.addInitHook("addHandler","tapHold",Ld),mn.mergeOptions({touchZoom:$t.touch,bounceAtZoomLimits:!0});var Cu=Re.extend({addHooks:function(){ir(this._map._container,"leaflet-touch-zoom"),qt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Bn(this._map._container,"leaflet-touch-zoom"),Zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(y){var E=this._map;if(!(!y.touches||y.touches.length!==2||E._animatingZoom||this._zooming)){var z=E.mouseEventToContainerPoint(y.touches[0]),ie=E.mouseEventToContainerPoint(y.touches[1]);this._centerPoint=E.getSize()._divideBy(2),this._startLatLng=E.containerPointToLatLng(this._centerPoint),E.options.touchZoom!=="center"&&(this._pinchStartLatLng=E.containerPointToLatLng(z.add(ie)._divideBy(2))),this._startDist=z.distanceTo(ie),this._startZoom=E.getZoom(),this._moved=!1,this._zooming=!0,E._stop(),qt(document,"touchmove",this._onTouchMove,this),qt(document,"touchend touchcancel",this._onTouchEnd,this),mi(y)}},_onTouchMove:function(y){if(!(!y.touches||y.touches.length!==2||!this._zooming)){var E=this._map,z=E.mouseEventToContainerPoint(y.touches[0]),ie=E.mouseEventToContainerPoint(y.touches[1]),me=z.distanceTo(ie)/this._startDist;if(this._zoom=E.getScaleZoom(me,this._startZoom),!E.options.bounceAtZoomLimits&&(this._zoom<E.getMinZoom()&&me<1||this._zoom>E.getMaxZoom()&&me>1)&&(this._zoom=E._limitZoom(this._zoom)),E.options.touchZoom==="center"){if(this._center=this._startLatLng,me===1)return}else{var Ee=z._add(ie)._divideBy(2)._subtract(this._centerPoint);if(me===1&&Ee.x===0&&Ee.y===0)return;this._center=E.unproject(E.project(this._pinchStartLatLng,this._zoom).subtract(Ee),this._zoom)}this._moved||(E._moveStart(!0,!1),this._moved=!0),Z(this._animRequest);var Fe=o(E._move,E,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=J(Fe,this,!0),mi(y)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Z(this._animRequest),Zt(document,"touchmove",this._onTouchMove,this),Zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});mn.addInitHook("addHandler","touchZoom",Cu),mn.BoxZoom=zs,mn.DoubleClickZoom=Su,mn.Drag=il,mn.Keyboard=Md,mn.ScrollWheelZoom=hd,mn.TapHold=Ld,mn.TouchZoom=Cu,n.Bounds=V,n.Browser=$t,n.CRS=be,n.Canvas=wu,n.Circle=Zs,n.CircleMarker=is,n.Class=de,n.Control=xa,n.DivIcon=Ms,n.DivOverlay=Mn,n.DomEvent=ji,n.DomUtil=bi,n.Draggable=Ct,n.Evented=ue,n.FeatureGroup=Qs,n.GeoJSON=N,n.GridLayer=Io,n.Handler=Re,n.Icon=ps,n.ImageOverlay=ct,n.LatLng=oe,n.LatLngBounds=se,n.Layer=qn,n.LayerGroup=rs,n.LineUtil=Ql,n.Map=mn,n.Marker=da,n.Mixin=We,n.Path=_i,n.Point=ce,n.PolyUtil=Ur,n.Polygon=b,n.Polyline=h,n.Popup=ua,n.PosAnimation=Zo,n.Projection=pl,n.Rectangle=gs,n.Renderer=co,n.SVG=bc,n.SVGOverlay=Tr,n.TileLayer=Oo,n.Tooltip=Un,n.Transformation=Je,n.Util=re,n.VideoOverlay=_t,n.bind=o,n.bounds=X,n.canvas=Rd,n.circle=je,n.circleMarker=ln,n.control=ao,n.divIcon=xc,n.extend=a,n.featureGroup=qi,n.geoJSON=$e,n.geoJson=Xe,n.gridLayer=ju,n.icon=tl,n.imageOverlay=Tt,n.latLng=ge,n.latLngBounds=W,n.layerGroup=ns,n.map=Gl,n.marker=Ys,n.point=Se,n.polygon=S,n.polyline=g,n.popup=Ra,n.rectangle=Ch,n.setOptions=C,n.stamp=u,n.svg=Ls,n.svgOverlay=qr,n.tileLayer=rl,n.tooltip=Ma,n.transformation=Qe,n.version=i,n.videoOverlay=At;var zd=window.L;n.noConflict=function(){return window.L=zd,this},window.L=n}))})(Sg,Sg.exports)),Sg.exports}var dNe=cNe();const zf=hc(dNe),lM=[24.7136,46.6753],uNe=10,tv=zf.divIcon({className:"custom-marker",html:`<div style="
    background: #0d9488;
    width: 32px;
    height: 32px;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    border: 2px solid white;
  ">
    <div style="transform: rotate(45deg); color: white; font-size: 14px;"></div>
  </div>`,iconSize:[32,32],iconAnchor:[16,32]});function hNe({latitude:t,longitude:r,onLocationSelect:n,height:i="300px"}){const a=k.useRef(null),s=k.useRef(null),o=k.useRef(null),[l,u]=k.useState(!1),d=()=>{if(!navigator.geolocation){Ki.error("Geolocation is not supported by your browser");return}u(!0),navigator.geolocation.getCurrentPosition(f=>{const{latitude:p,longitude:x}=f.coords;s.current&&(o.current?o.current.setLatLng([p,x]):o.current=zf.marker([p,x],{icon:tv}).addTo(s.current),s.current.setView([p,x],16)),n(p,x),u(!1),Ki.success("Location detected successfully")},f=>{switch(u(!1),f.code){case f.PERMISSION_DENIED:Ki.error("Location access denied. Please enable location permissions.");break;case f.POSITION_UNAVAILABLE:Ki.error("Location information unavailable");break;case f.TIMEOUT:Ki.error("Location request timed out");break;default:Ki.error("Unable to get your location")}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})};return k.useEffect(()=>{if(!a.current||s.current)return;const f=t||lM[0],p=r||lM[1],x=t&&r?15:uNe,v=zf.map(a.current).setView([f,p],x);return zf.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(v),t&&r&&(o.current=zf.marker([t,r],{icon:tv}).addTo(v)),v.on("click",w=>{const{lat:C,lng:A}=w.latlng;o.current?o.current.setLatLng([C,A]):o.current=zf.marker([C,A],{icon:tv}).addTo(v),n(C,A)}),s.current=v,()=>{s.current&&(s.current.remove(),s.current=null)}},[]),k.useEffect(()=>{s.current&&t&&r&&(o.current?o.current.setLatLng([t,r]):o.current=zf.marker([t,r],{icon:tv}).addTo(s.current),s.current.setView([t,r],15))},[t,r]),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("div",{ref:a,style:{height:i,width:"100%",borderRadius:"8px",border:"1px solid var(--border)",overflow:"hidden"}}),e.jsx("button",{type:"button",onClick:d,disabled:l,style:{position:"absolute",top:"10px",right:"10px",background:"white",border:"none",padding:"8px 12px",borderRadius:"6px",fontSize:"0.8125rem",fontWeight:500,color:"#0d9488",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",cursor:l?"wait":"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s"},onMouseOver:f=>{l||(f.currentTarget.style.background="#0d9488",f.currentTarget.style.color="white")},onMouseOut:f=>{f.currentTarget.style.background="white",f.currentTarget.style.color="#0d9488"},children:l?e.jsxs(e.Fragment,{children:[e.jsx(_g,{size:16,style:{animation:"spin 1s linear infinite"}}),"Locating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(AY,{size:16}),"Use My Location"]})}),e.jsxs("div",{style:{position:"absolute",bottom:"8px",left:"8px",background:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"0.75rem",color:"var(--text-muted)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(_a,{size:14}),"Click on the map to select location"]}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function fNe(){const t=pr(),r=gn(),[n,i]=k.useState({nameEn:"",nameAr:"",email:"",mobile:"",phone:"",fullAddress:"",postalCode:"",countryId:"",regionId:"",cityId:"",latitude:"",longitude:"",deliveryWindowStart:"",deliveryWindowEnd:"",preferredDeliveryTime:""}),[a,s]=k.useState([]),[o,l]=k.useState({}),[u,d]=k.useState(null),[f,p]=k.useState(!1),[x,v]=k.useState(!1),[w,C]=k.useState(""),A=k.useRef(null),T=k.useRef(null),{data:O,isLoading:D}=Ve({queryKey:["my-profile"],queryFn:async()=>{const{data:W}=await xe.get("/profile");return W}}),{data:M}=Ve({queryKey:["settings","countries"],queryFn:async()=>{const{data:W}=await xe.get("/settings/countries");return W}}),{data:Q}=Ve({queryKey:["settings","regions",n.countryId],queryFn:async()=>{const W=n.countryId?{countryId:n.countryId}:{},{data:oe}=await xe.get("/settings/regions",{params:W});return oe}}),{data:U}=Ve({queryKey:["settings","cities",n.regionId],queryFn:async()=>{const W=n.regionId?{regionId:n.regionId}:{},{data:oe}=await xe.get("/settings/cities",{params:W});return oe},enabled:!!n.regionId}),{data:$}=Ve({queryKey:["location-photos"],queryFn:async()=>{const{data:W}=await xe.get("/profile/location-photos");return W}});k.useEffect(()=>{O&&(i({nameEn:O.nameEn||O.name||"",nameAr:O.nameAr||"",email:O.email||"",mobile:O.mobile||"",phone:O.phone||"",fullAddress:O.fullAddress||O.address||"",postalCode:O.postalCode||"",countryId:O.countryId||"",regionId:O.regionId||"",cityId:O.cityId||"",latitude:O.latitude?.toString()||"",longitude:O.longitude?.toString()||"",deliveryWindowStart:O.deliveryWindowStart||"",deliveryWindowEnd:O.deliveryWindowEnd||"",preferredDeliveryTime:O.preferredDeliveryTime||""}),O.contacts?.length>0&&s(O.contacts),O.logoUrl&&d(O.logoUrl))},[O]);const ee=ot({mutationFn:async W=>(await xe.put("/profile",W)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["my-profile"]}),r.success("Profile updated successfully")},onError:W=>{const oe=an(W);r.error(oe?.userMessage||"Failed to save profile")}}),F=()=>{const W={};return n.nameEn?.trim()||(W.nameEn="English name is required"),n.mobile?.trim()?/^(\+966|05)[0-9]{8,9}$/.test(n.mobile.replace(/\s/g,""))||(W.mobile="Invalid Saudi mobile format (+9665xxxxxxxx or 05xxxxxxxx)"):W.mobile="Mobile number is required",n.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)&&(W.email="Invalid email format"),n.fullAddress?.trim()||(W.fullAddress="Address is required"),l(W),Object.keys(W).length===0},Y=()=>{if(!F()){r.error("Please fix the validation errors");return}ee.mutate({...n,contacts:a})},J=async W=>{const oe=W.target.files?.[0];if(!oe)return;if(oe.size>5*1024*1024){r.error("Logo must be less than 5MB");return}if(!["image/png","image/jpeg","image/jpg"].includes(oe.type)){r.error("Only PNG and JPG images are allowed");return}p(!0);const ge=new FormData;ge.append("logo",oe);try{const{data:be}=await xe.post("/profile/logo",ge,{headers:{"Content-Type":"multipart/form-data"}});d(be.logoUrl),t.invalidateQueries({queryKey:["my-profile"]}),r.success("Logo uploaded successfully")}catch(be){const Le=an(be);r.error(Le?.userMessage||"Failed to upload logo")}finally{p(!1)}},Z=async()=>{try{await xe.delete("/profile/logo"),d(null),t.invalidateQueries({queryKey:["my-profile"]}),r.success("Logo removed")}catch(W){const oe=an(W);r.error(oe?.userMessage||"Failed to remove logo")}},re=()=>{s([...a,{name:"",title:"",email:"",phone:""}])},de=(W,oe,ge)=>{const be=[...a];be[W]={...be[W],[oe]:ge},s(be)},le=W=>{s(a.filter((oe,ge)=>ge!==W))},K=(W,oe)=>{i({...n,latitude:W.toFixed(6),longitude:oe.toFixed(6)})},ue=async W=>{const oe=W.target.files?.[0];if(!oe)return;if(oe.size>5*1024*1024){r.error("Photo must be less than 5MB");return}if(!["image/png","image/jpeg","image/jpg"].includes(oe.type)){r.error("Only PNG and JPG images are allowed");return}v(!0);const ge=new FormData;ge.append("photo",oe),ge.append("caption",w);try{await xe.post("/profile/location-photos",ge,{headers:{"Content-Type":"multipart/form-data"}}),t.invalidateQueries({queryKey:["location-photos"]}),C(""),r.success("Location photo uploaded")}catch(be){const Le=an(be);r.error(Le?.userMessage||"Failed to upload photo")}finally{v(!1),T.current&&(T.current.value="")}},ce=async W=>{try{await xe.delete(`/profile/location-photos/${W}`),t.invalidateQueries({queryKey:["location-photos"]}),r.success("Photo deleted")}catch(oe){const ge=an(oe);r.error(ge?.userMessage||"Failed to delete photo")}};if(D)return e.jsx("div",{style:{padding:"2rem"},children:e.jsx("div",{className:"card skeleton",style:{height:"400px"}})});const ye={background:"white",border:"1px solid var(--border)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem"},Se={display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1.25rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)",fontSize:"1rem",fontWeight:600,color:"#0d9488"},V={display:"block",marginBottom:"0.375rem",fontSize:"0.875rem",fontWeight:500,color:"var(--text-secondary)"},X={width:"100%",padding:"0.625rem 0.875rem",border:"1px solid var(--border)",borderRadius:"8px",fontSize:"0.875rem",transition:"border-color 0.15s ease"},se={...X,borderColor:"var(--danger)"};return e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem"},children:"My Profile"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"Manage your company information and contact details"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:Y,disabled:ee.isPending,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(cc,{size:18}),ee.isPending?"Saving...":"Save Changes"]})]}),e.jsxs("div",{style:ye,children:[e.jsxs("div",{style:Se,children:[e.jsx(Lp,{size:20}),"Company Information"]}),e.jsxs("div",{style:{display:"flex",gap:"2rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{flex:"0 0 140px"},children:[e.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"12px",border:"2px dashed var(--border)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#f8fafc",overflow:"hidden",position:"relative"},children:u?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:u,alt:"Logo",style:{width:"100%",height:"100%",objectFit:"contain"}}),e.jsx("button",{onClick:Z,style:{position:"absolute",top:"4px",right:"4px",background:"rgba(0,0,0,0.5)",border:"none",borderRadius:"50%",padding:"4px",cursor:"pointer",color:"white"},children:e.jsx(Dr,{size:14})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Dv,{size:32,style:{color:"var(--text-muted)",marginBottom:"0.5rem"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Company Logo"})]})}),e.jsx("input",{type:"file",ref:A,onChange:J,accept:"image/png,image/jpeg,image/jpg",style:{display:"none"}}),e.jsxs("button",{onClick:()=>A.current?.click(),disabled:f,style:{width:"100%",marginTop:"0.5rem",padding:"0.5rem",fontSize:"0.75rem",border:"1px solid var(--border)",borderRadius:"6px",background:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"},children:[e.jsx(om,{size:14}),f?"Uploading...":"Upload Logo"]})]}),e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Name (English) *"}),e.jsx("input",{type:"text",value:n.nameEn,onChange:W=>i({...n,nameEn:W.target.value}),style:o.nameEn?se:X,placeholder:"Company name in English"}),o.nameEn&&e.jsxs("span",{style:{color:"var(--danger)",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.25rem"},children:[e.jsx(sn,{size:12})," ",o.nameEn]})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Name (Arabic)"}),e.jsx("input",{type:"text",value:n.nameAr,onChange:W=>i({...n,nameAr:W.target.value}),style:X,placeholder:"  ",dir:"rtl"})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:W=>i({...n,email:W.target.value}),style:o.email?se:X,placeholder:"company@example.com"}),o.email&&e.jsxs("span",{style:{color:"var(--danger)",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.25rem"},children:[e.jsx(sn,{size:12})," ",o.email]})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Mobile *"}),e.jsx("input",{type:"tel",value:n.mobile,onChange:W=>i({...n,mobile:W.target.value}),style:o.mobile?se:X,placeholder:"+966 5x xxx xxxx"}),o.mobile&&e.jsxs("span",{style:{color:"var(--danger)",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.25rem"},children:[e.jsx(sn,{size:12})," ",o.mobile]})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Phone (Landline)"}),e.jsx("input",{type:"tel",value:n.phone,onChange:W=>i({...n,phone:W.target.value}),style:X,placeholder:"+966 1x xxx xxxx"})]})]})})]})]}),e.jsxs("div",{style:ye,children:[e.jsxs("div",{style:Se,children:[e.jsx(_a,{size:20}),"Delivery Address"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"1rem",marginBottom:"1rem"},children:e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Full Address *"}),e.jsx("textarea",{value:n.fullAddress,onChange:W=>i({...n,fullAddress:W.target.value}),style:{...X,minHeight:"80px",resize:"vertical"},placeholder:"Complete delivery address"}),o.fullAddress&&e.jsxs("span",{style:{color:"var(--danger)",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"0.25rem",marginTop:"0.25rem"},children:[e.jsx(sn,{size:12})," ",o.fullAddress]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Country"}),e.jsxs("select",{value:n.countryId,onChange:W=>i({...n,countryId:W.target.value,regionId:"",cityId:""}),style:X,children:[e.jsx("option",{value:"",children:"Select Country"}),M?.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Region"}),e.jsxs("select",{value:n.regionId,onChange:W=>i({...n,regionId:W.target.value,cityId:""}),style:X,disabled:!n.countryId,children:[e.jsx("option",{value:"",children:"Select Region"}),Q?.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"City"}),e.jsxs("select",{value:n.cityId,onChange:W=>i({...n,cityId:W.target.value}),style:X,disabled:!n.regionId,children:[e.jsx("option",{value:"",children:"Select City"}),U?.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Postal Code"}),e.jsx("input",{type:"text",value:n.postalCode,onChange:W=>i({...n,postalCode:W.target.value}),style:X,placeholder:"12345"})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"GPS Latitude"}),e.jsx("input",{type:"text",value:n.latitude,onChange:W=>i({...n,latitude:W.target.value}),style:X,placeholder:"24.7136"})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"GPS Longitude"}),e.jsx("input",{type:"text",value:n.longitude,onChange:W=>i({...n,longitude:W.target.value}),style:X,placeholder:"46.6753"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:V,children:"Select Location on Map"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:"Click on the map to set your delivery location coordinates"}),e.jsx(hNe,{latitude:n.latitude?parseFloat(n.latitude):null,longitude:n.longitude?parseFloat(n.longitude):null,onLocationSelect:K,height:"300px"})]})]}),e.jsxs("div",{style:ye,children:[e.jsxs("div",{style:Se,children:[e.jsx(Rv,{size:20}),"Location Photos"]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"1rem"},children:"Upload photos of your delivery location to help drivers identify your building"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:V,children:"Caption (optional)"}),e.jsx("input",{type:"text",value:w,onChange:W=>C(W.target.value),style:X,placeholder:"e.g., Front entrance, Loading dock"})]}),e.jsx("input",{type:"file",ref:T,onChange:ue,accept:"image/png,image/jpeg,image/jpg",style:{display:"none"}}),e.jsxs("button",{onClick:()=>T.current?.click(),disabled:x,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem",border:"1px solid #0d9488",borderRadius:"8px",background:"#0d9488",color:"white",cursor:"pointer",fontSize:"0.875rem",whiteSpace:"nowrap"},children:[e.jsx(om,{size:16}),x?"Uploading...":"Upload Photo"]})]}),$&&$.length>0?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"1rem"},children:$.map(W=>e.jsxs("div",{style:{position:"relative",borderRadius:"8px",overflow:"hidden",border:"1px solid var(--border)",background:"#f8fafc"},children:[e.jsx("img",{src:W.photoUrl,alt:W.caption||"Location photo",style:{width:"100%",height:"150px",objectFit:"cover"}}),e.jsx("button",{onClick:()=>ce(W.id),style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0,0,0,0.5)",border:"none",borderRadius:"50%",padding:"6px",cursor:"pointer",color:"white"},children:e.jsx(Gi,{size:14})}),W.caption&&e.jsx("div",{style:{padding:"0.5rem",fontSize:"0.75rem",color:"var(--text-secondary)",background:"white",borderTop:"1px solid var(--border)"},children:W.caption})]},W.id))}):e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)",background:"#f8fafc",borderRadius:"8px",border:"1px dashed var(--border)"},children:[e.jsx(Dv,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:"No location photos uploaded yet"})]})]}),e.jsxs("div",{style:ye,children:[e.jsxs("div",{style:Se,children:[e.jsx(vo,{size:20}),"Delivery Preferences"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Delivery Window Start"}),e.jsx("input",{type:"time",value:n.deliveryWindowStart,onChange:W=>i({...n,deliveryWindowStart:W.target.value}),style:X})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Delivery Window End"}),e.jsx("input",{type:"time",value:n.deliveryWindowEnd,onChange:W=>i({...n,deliveryWindowEnd:W.target.value}),style:X})]}),e.jsxs("div",{children:[e.jsx("label",{style:V,children:"Preferred Delivery Time"}),e.jsx("input",{type:"time",value:n.preferredDeliveryTime,onChange:W=>i({...n,preferredDeliveryTime:W.target.value}),style:X})]})]})]}),e.jsxs("div",{style:ye,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.25rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"1rem",fontWeight:600,color:"#0d9488"},children:[e.jsx(Uo,{size:20}),"Contact Persons"]}),e.jsxs("button",{onClick:re,style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.5rem 0.75rem",fontSize:"0.875rem",border:"1px solid var(--border)",borderRadius:"6px",background:"white",cursor:"pointer"},children:[e.jsx(cn,{size:16}),"Add Contact"]})]}),a.length===0?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:'No contact persons added. Click "Add Contact" to add one.'}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:a.map((W,oe)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:"0.75rem",padding:"1rem",background:"#f8fafc",borderRadius:"8px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{...V,fontSize:"0.75rem"},children:"Name"}),e.jsx("input",{type:"text",value:W.name,onChange:ge=>de(oe,"name",ge.target.value),style:X,placeholder:"Contact name"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{...V,fontSize:"0.75rem"},children:"Title"}),e.jsx("input",{type:"text",value:W.title,onChange:ge=>de(oe,"title",ge.target.value),style:X,placeholder:"Job title"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{...V,fontSize:"0.75rem"},children:"Email"}),e.jsx("input",{type:"email",value:W.email,onChange:ge=>de(oe,"email",ge.target.value),style:X,placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{...V,fontSize:"0.75rem"},children:"Phone"}),e.jsx("input",{type:"tel",value:W.phone,onChange:ge=>de(oe,"phone",ge.target.value),style:X,placeholder:"+966 5x xxx xxxx"})]}),e.jsx("button",{onClick:()=>le(oe),style:{padding:"0.625rem",border:"none",borderRadius:"6px",background:"#fee2e2",color:"var(--danger)",cursor:"pointer"},children:e.jsx(Gi,{size:16})})]},oe))})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",paddingBottom:"2rem"},children:e.jsxs("button",{className:"btn btn-primary",onClick:Y,disabled:ee.isPending,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(cc,{size:18}),ee.isPending?"Saving...":"Save Changes"]})})]})}function mNe(){const{user:t}=Il(),r=Gr(),n=pr(),[i,a]=k.useState(0),[s,o]=k.useState(null),[l,u]=k.useState(""),[d,f]=k.useState(1),[p,x]=k.useState(10),[v,w]=k.useState(""),[C,A]=k.useState(""),[T,O]=k.useState("calendar"),[D,M]=k.useState(null),[Q,U]=k.useState(0),$=hl(Yf(new Date),i*7),ee=hl($,13),{data:F,isLoading:Y}=Ve({queryKey:["portal-capacity-calendar",$.toISOString()],queryFn:async()=>{const{data:ge}=await xe.get("/portal/capacity/calendar",{params:{startDate:$.toISOString(),endDate:ee.toISOString()}});return ge}}),{data:J,isLoading:Z}=Ve({queryKey:["portal-available-products"],queryFn:async()=>{const{data:ge}=await xe.get("/portal/products/available");return ge}}),re=ot({mutationFn:async ge=>{const{data:be}=await xe.post("/portal/reservations",ge);return be},onSuccess:ge=>{M(ge),U(ge.expiresInSeconds||900),O("confirm");const be=setInterval(()=>{U(Le=>Le<=1?(clearInterval(be),0):Le-1)},1e3)}}),de=ot({mutationFn:async()=>{const{data:ge}=await xe.post(`/portal/reservations/${D.id}/confirm`,{hospitalOrderReference:v,specialNotes:C});return ge},onSuccess:ge=>{n.invalidateQueries({queryKey:["portal-capacity-calendar"]}),n.invalidateQueries({queryKey:["portal-orders"]}),r(`/portal/orders/${ge.order.id}/journey`)}}),le=J?.find(ge=>ge.id===l),K=le?le.dispensingMinutesPerDose*d:15*d,ue=ge=>{ge.availableMinutes<=0||(o(ge),u(""),f(1),x(10),w(""),A(""))},ce=()=>{!s||!l||re.mutate({productId:l,windowId:s.id,requestedDate:s.date,requestedActivity:p,numberOfDoses:d,hospitalOrderReference:v})},ye=()=>{de.mutate()},Se=ge=>{const be=Math.floor(ge/60),Le=ge%60;return`${be}:${Le.toString().padStart(2,"0")}`},V=J?.find(ge=>ge.id===l),X=ge=>{u(ge);const be=J?.find(Le=>Le.id===ge);be?.standardDose&&x(be.standardDose)},se=ge=>ge>=90?"var(--danger)":ge>=70?"var(--warning)":"var(--success)",W=(F||[]).reduce((ge,be)=>{const Le=Ze(new Date(be.date),"yyyy-MM-dd");return ge[Le]||(ge[Le]=[]),ge[Le].push(be),ge},{}),oe={totalSlots:F?.length||0,availableSlots:F?.filter(ge=>ge.availableMinutes>0).length||0,totalCapacity:F?.reduce((ge,be)=>ge+be.capacityMinutes,0)||0,availableCapacity:F?.reduce((ge,be)=>ge+be.availableMinutes,0)||0};return Y||Z?e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{className:"card skeleton",style:{height:"80px",marginBottom:"1rem"}}),e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:Array.from({length:4}).map((ge,be)=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},be))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0.5rem"},children:Array.from({length:14}).map((ge,be)=>e.jsx("div",{className:"card skeleton",style:{height:"120px"}},be))})]}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Book Capacity"}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ts,{size:14})," ",t?.customerName||"Select a delivery window to reserve capacity"]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Slots",value:oe.totalSlots,icon:e.jsx($n,{size:20}),color:"primary"}),e.jsx(nt,{title:"Available Slots",value:oe.availableSlots,icon:e.jsx(zC,{size:20}),color:"success"}),e.jsx(nt,{title:"Total Capacity",value:`${Math.round(oe.totalCapacity/60)}h`,icon:e.jsx(Qt,{size:20}),color:"info"}),e.jsx(nt,{title:"Available",value:`${Math.round(oe.availableCapacity/60)}h`,icon:e.jsx(zp,{size:20}),color:"warning"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx($n,{size:18,style:{color:"var(--primary)"}}),e.jsxs("span",{style:{fontWeight:500},children:[Ze($,"MMM d")," - ",Ze(ee,"MMM d, yyyy")]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>a(ge=>ge-1),disabled:i===0,children:e.jsx(Xp,{size:16})}),e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>a(0),children:"Today"}),e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>a(ge=>ge+1),children:e.jsx(bo,{size:16})})]}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"1rem",fontSize:"0.8125rem"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx("span",{style:{width:10,height:10,borderRadius:"50%",background:"var(--success)"}}),"Available"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx("span",{style:{width:10,height:10,borderRadius:"50%",background:"var(--warning)"}}),"Limited"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx("span",{style:{width:10,height:10,borderRadius:"50%",background:"var(--danger)"}}),"Full"]})]})]})}),T==="calendar"&&e.jsxs("div",{className:"grid",style:{gridTemplateColumns:s?"1fr 380px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0.75rem"},children:Array.from({length:14}).map((ge,be)=>{const Le=hl($,be),ke=Ze(Le,"yyyy-MM-dd"),He=W[ke]||[],Je=Ze(Le,"yyyy-MM-dd")===Ze(new Date,"yyyy-MM-dd"),Qe=Le<Yf(new Date),vt=He.reduce((Pt,Oe)=>Pt+Oe.availableMinutes,0);return e.jsxs("div",{className:"card",style:{padding:0,opacity:Qe?.5:1,border:Je?"2px solid #0d9488":"1px solid var(--border)",overflow:"hidden"},children:[e.jsxs("div",{style:{background:Je?"rgba(13, 148, 136, 0.1)":"var(--bg-secondary)",padding:"0.75rem",textAlign:"center",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"0.25rem"},children:Ze(Le,"EEE")}),e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:Je?"#0d9488":"var(--text-primary)"},children:Ze(Le,"d")})]}),e.jsx("div",{style:{padding:"0.75rem"},children:He.length===0?e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",textAlign:"center",padding:"1.5rem 0",background:"var(--bg-secondary)",borderRadius:"8px"},children:"No slots"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.625rem"},children:He.map(Pt=>{const Oe=s?.id===Pt.id,st=Pt.availableMinutes<=0,Wt=st?"Full":Pt.utilizationPercent>=70?"Limited":"Available",Bt=st?"var(--danger)":Pt.utilizationPercent>=70?"var(--warning)":"var(--success)",yt=st?"rgba(239, 68, 68, 0.1)":Pt.utilizationPercent>=70?"rgba(234, 179, 8, 0.1)":"rgba(34, 197, 94, 0.1)";return e.jsxs("button",{onClick:()=>!Qe&&ue(Pt),disabled:Qe||st,style:{padding:0,borderRadius:"10px",border:Oe?"2px solid #0d9488":"1px solid var(--border)",background:Oe?"rgba(13, 148, 136, 0.08)":"var(--bg-primary)",cursor:Qe||st?"not-allowed":"pointer",textAlign:"left",transition:"all 0.2s ease",overflow:"hidden",boxShadow:Oe?"0 2px 8px rgba(13, 148, 136, 0.2)":"none"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.625rem 0.75rem",borderBottom:"1px solid var(--border)",background:Oe?"rgba(13, 148, 136, 0.05)":"var(--bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",fontSize:"0.8125rem",fontWeight:600},children:[e.jsx(Qt,{size:13,style:{color:Oe?"#0d9488":"var(--text-muted)"}}),Ze(new Date(Pt.startTime),"HH:mm")," - ",Ze(new Date(Pt.endTime),"HH:mm")]}),e.jsx("span",{style:{padding:"0.1875rem 0.5rem",borderRadius:"10px",fontSize:"0.625rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.3px",background:yt,color:Bt},children:Wt})]}),e.jsxs("div",{style:{padding:"0.625rem 0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Capacity"}),e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:700,color:Bt},children:[Pt.availableMinutes," min"]})]}),e.jsx("div",{style:{width:"100%",height:"6px",background:"var(--bg-muted)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Pt.utilizationPercent}%`,height:"100%",background:Bt,borderRadius:"3px",transition:"width 0.3s ease"}})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"0.375rem",fontSize:"0.625rem",color:"var(--text-muted)"},children:[e.jsxs("span",{children:[Pt.usedMinutes," used"]}),e.jsxs("span",{children:[Pt.capacityMinutes," total"]})]})]})]},Pt.id)})})}),He.length>0&&e.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"0.5rem 0.75rem",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.375rem",fontSize:"0.6875rem",color:"var(--text-muted)"},children:[e.jsx(vp,{size:11}),vt," min available"]})]},be)})}),s&&e.jsxs("div",{className:"card",style:{padding:0,position:"sticky",top:"100px",alignSelf:"start",width:"340px",minWidth:"340px",maxWidth:"340px",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:"Slot Details"}),e.jsx("button",{onClick:()=>o(null),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem"},children:e.jsx(Dr,{size:18,style:{color:"var(--text-muted)"}})})]}),e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"rgba(13, 148, 136, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx($n,{size:20,style:{color:"#0d9488"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:Ze(new Date(s.date),"EEEE")}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:600},children:Ze(new Date(s.date),"MMMM d, yyyy")})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Qt,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Time Slot"})]}),e.jsxs("span",{style:{fontSize:"0.8125rem",fontWeight:600},children:[Ze(new Date(s.startTime),"HH:mm")," - ",Ze(new Date(s.endTime),"HH:mm")]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(zp,{size:12,style:{color:"#0d9488"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Available"})]}),e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:700,color:se(s.utilizationPercent)},children:[s.availableMinutes," min"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.375rem 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(vp,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Total Capacity"})]}),e.jsxs("span",{style:{fontSize:"0.8125rem"},children:[s.capacityMinutes," min"]})]}),e.jsxs("div",{style:{padding:"0.375rem 0"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Utilization"}),e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:600},children:[s.utilizationPercent,"%"]})]}),e.jsx("div",{style:{height:"4px",background:"var(--bg-secondary)",borderRadius:"2px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Math.min(s.utilizationPercent,100)}%`,height:"100%",background:se(s.utilizationPercent),borderRadius:"2px",transition:"width 0.3s ease"}})})]})]})]}),e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h4",{style:{fontSize:"0.6875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Reserve This Slot"}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsxs("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:["Product ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsxs("select",{className:"form-control",value:l,onChange:ge=>X(ge.target.value),style:{fontSize:"0.8125rem",padding:"0.4rem 0.5rem",width:"100%",boxSizing:"border-box",borderColor:l?"#0d9488":"var(--border)",borderWidth:l?"2px":"1px"},children:[e.jsx("option",{value:"",children:"Select a product..."}),J?.map(ge=>e.jsxs("option",{value:ge.id,children:[ge.name," (",ge.code,")"]},ge.id))]})]}),V&&e.jsxs("div",{style:{padding:"0.625rem",background:"rgba(13, 148, 136, 0.06)",borderRadius:"6px",marginBottom:"0.75rem",border:"1px solid rgba(13, 148, 136, 0.15)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Rr,{size:14,style:{color:"#0d9488"}}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:600,color:"#0d9488"},children:V.code}),e.jsx("span",{style:{fontSize:"0.625rem",padding:"0.125rem 0.375rem",background:"rgba(13, 148, 136, 0.15)",borderRadius:"4px",color:"#0d9488",textTransform:"uppercase"},children:V.productType})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.6875rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Radionuclide: "}),e.jsx("span",{style:{fontWeight:500},children:V.radionuclide})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Half-life: "}),e.jsxs("span",{style:{fontWeight:500},children:[V.halfLifeMinutes," min"]})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Dose Unit: "}),e.jsx("span",{style:{fontWeight:600,color:"#0d9488"},children:V.doseUnit})]}),V.standardDose&&e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Std. Dose: "}),e.jsxs("span",{style:{fontWeight:500},children:[V.standardDose," ",V.doseUnit]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:["Doses ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"number",className:"form-control",value:d,onChange:ge=>f(Math.max(1,parseInt(ge.target.value)||1)),min:1,style:{fontSize:"0.8125rem",padding:"0.4rem 0.5rem",width:"100%",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:["Activity (",V?.doseUnit||"mCi",") ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"number",className:"form-control",value:p,onChange:ge=>x(parseFloat(ge.target.value)||0),step:"0.1",style:{fontSize:"0.8125rem",padding:"0.4rem 0.5rem",width:"100%",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"Hospital Reference"}),e.jsx("input",{type:"text",className:"form-control",value:v,onChange:ge=>w(ge.target.value),placeholder:"Your internal reference",style:{fontSize:"0.8125rem",padding:"0.4rem 0.5rem",width:"100%",boxSizing:"border-box"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"Special Notes"}),e.jsx("textarea",{className:"form-control",value:C,onChange:ge=>A(ge.target.value),rows:2,placeholder:"Any special requirements...",style:{fontSize:"0.8125rem",padding:"0.4rem 0.5rem",resize:"none",width:"100%",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{padding:"1rem"},children:[l&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:K>s.availableMinutes?"rgba(239, 68, 68, 0.08)":"rgba(13, 148, 136, 0.08)",borderRadius:"6px",marginBottom:"0.75rem",border:K>s.availableMinutes?"1px solid rgba(239, 68, 68, 0.2)":"1px solid rgba(13, 148, 136, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(vp,{size:14,style:{color:K>s.availableMinutes?"var(--danger)":"#0d9488"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Est. Time"})]}),e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:700,color:K>s.availableMinutes?"var(--danger)":"#0d9488"},children:[K," min",K>s.availableMinutes&&e.jsx(Hr,{size:12,style:{marginLeft:"0.25rem",verticalAlign:"middle"}})]})]}),e.jsxs("button",{className:"btn",onClick:ce,disabled:!l||K>s.availableMinutes||re.isPending,style:{width:"100%",boxSizing:"border-box",background:!l||K>s.availableMinutes?"var(--bg-secondary)":"#0d9488",borderColor:!l||K>s.availableMinutes?"var(--border)":"#0d9488",color:!l||K>s.availableMinutes?"var(--text-muted)":"white",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.625rem 1rem",fontSize:"0.875rem",fontWeight:600,cursor:!l||K>s.availableMinutes?"not-allowed":"pointer"},children:[e.jsx(zC,{size:16}),re.isPending?"Reserving...":"Reserve Capacity"]})]})]})]}),T==="confirm"&&D&&e.jsxs("div",{className:"card",style:{padding:"2rem",maxWidth:"500px",margin:"2rem auto"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:"rgba(34, 197, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem"},children:e.jsx(Ai,{size:32,style:{color:"var(--success)"}})}),e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.5rem"},children:"Capacity Reserved!"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:0},children:["Reservation: ",D.reservationNumber]})]}),e.jsxs("div",{style:{background:Q<120?"rgba(239, 68, 68, 0.1)":"rgba(234, 179, 8, 0.1)",border:`1px solid ${Q<120?"rgba(239, 68, 68, 0.3)":"rgba(234, 179, 8, 0.3)"}`,padding:"1rem",borderRadius:"8px",textAlign:"center",marginBottom:"1.5rem"},children:[e.jsx(vp,{size:24,style:{marginBottom:"0.5rem",color:Q<120?"var(--danger)":"var(--warning)"}}),e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700},children:Se(Q)}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",margin:"0.25rem 0 0"},children:"Confirm before expiry"})]}),e.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)",marginBottom:"0.75rem",fontWeight:500},children:"Order Summary"}),e.jsxs("div",{style:{display:"grid",gap:"0.625rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Product"}),e.jsx("span",{style:{fontWeight:500},children:D.product?.name})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Doses"}),e.jsx("span",{style:{fontWeight:500},children:D.numberOfDoses})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Activity"}),e.jsxs("span",{style:{fontWeight:500},children:[D.requestedActivity," mCi"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Delivery"}),e.jsx("span",{style:{fontWeight:500},children:Ze(new Date(D.requestedDate),"MMM d, yyyy")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Reserved Time"}),e.jsxs("span",{style:{fontWeight:500},children:[D.estimatedMinutes," min"]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>{O("calendar"),M(null),o(null)},style:{flex:1},children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:ye,disabled:Q===0||de.isPending,style:{flex:2,background:"#0d9488",borderColor:"#0d9488"},children:de.isPending?"Creating Order...":"Confirm Order"})]})]})]})}const pNe=[{value:"",label:"All Statuses"},{value:"NEW",label:"New"},{value:"OPEN",label:"Open"},{value:"IN_PROGRESS",label:"In Progress"},{value:"WAITING_FOR_USER",label:"Waiting for You"},{value:"WAITING_FOR_ADMIN",label:"Waiting for Support"},{value:"RESOLVED",label:"Resolved"},{value:"CLOSED",label:"Closed"}],gNe=[{value:"",label:"All Categories"},{value:"ACCOUNT",label:"Account"},{value:"ORDER",label:"Order"},{value:"DELIVERY",label:"Delivery"},{value:"INVOICE",label:"Invoice"},{value:"PAYMENT",label:"Payment"},{value:"QC",label:"Quality"},{value:"SYSTEM",label:"System"},{value:"OTHER",label:"Other"}],rv={NEW:{color:"var(--info)",bg:"rgba(59, 130, 246, 0.1)"},OPEN:{color:"var(--primary)",bg:"rgba(99, 102, 241, 0.1)"},IN_PROGRESS:{color:"var(--warning)",bg:"rgba(234, 179, 8, 0.1)"},WAITING_FOR_USER:{color:"var(--danger)",bg:"rgba(239, 68, 68, 0.1)"},WAITING_FOR_ADMIN:{color:"var(--info)",bg:"rgba(59, 130, 246, 0.1)"},RESOLVED:{color:"var(--success)",bg:"rgba(34, 197, 94, 0.1)"},CLOSED:{color:"var(--text-muted)",bg:"var(--bg-secondary)"},CANCELLED:{color:"var(--text-muted)",bg:"var(--bg-secondary)"}},nv={LOW:{color:"var(--text-muted)",label:"Low",bg:"var(--bg-secondary)"},MEDIUM:{color:"var(--warning)",label:"Medium",bg:"rgba(234, 179, 8, 0.1)"},HIGH:{color:"var(--danger)",label:"High",bg:"rgba(239, 68, 68, 0.1)"},CRITICAL:{color:"#dc2626",label:"Critical",bg:"rgba(220, 38, 38, 0.15)"}},cM={ACCOUNT:"",ORDER:"",DELIVERY:"",INVOICE:"",PAYMENT:"",QC:"",SYSTEM:"",OTHER:""};function yNe(){const t=Gr(),[r,n]=k.useState(1),[i,a]=k.useState(""),[s,o]=k.useState(""),[l,u]=k.useState(""),[d,f]=k.useState(null),p=12,{data:x,isLoading:v}=Ve({queryKey:["portal-tickets",r,i,s,l],queryFn:async()=>{const D={page:r,limit:p};i&&(D.status=i),s&&(D.category=s),l&&(D.search=l);const{data:M}=await xe.get("/helpdesk/tickets",{params:D});return M}}),w=x?.tickets||[],C=x?.pagination||{total:0},A={total:C.total,waitingForYou:w.filter(D=>D.status==="WAITING_FOR_USER").length,open:w.filter(D=>["NEW","OPEN","IN_PROGRESS","WAITING_FOR_ADMIN"].includes(D.status)).length,resolved:w.filter(D=>["RESOLVED","CLOSED"].includes(D.status)).length},T=()=>{a(""),o(""),u(""),n(1)},O=i||s||l;return v?e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:Array.from({length:4}).map((D,M)=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},M))}),e.jsx("div",{className:"card skeleton",style:{height:"60px",marginBottom:"1rem"}}),e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"1rem"},children:Array.from({length:6}).map((D,M)=>e.jsx("div",{className:"card skeleton",style:{height:"160px"}},M))})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Support Tickets"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"View and manage your support requests"})]}),e.jsxs(nr,{to:"/portal/helpdesk/new",className:"btn btn-primary",style:{background:"#0d9488",borderColor:"#0d9488"},children:[e.jsx(cn,{size:16})," New Ticket"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Tickets",value:A.total,icon:e.jsx(Sm,{size:20}),color:"primary",onClick:()=>{a(""),n(1)},active:!i}),e.jsx(nt,{title:"Needs Response",value:A.waitingForYou,icon:e.jsx(sn,{size:20}),color:"danger",onClick:()=>{a(i==="WAITING_FOR_USER"?"":"WAITING_FOR_USER"),n(1)},active:i==="WAITING_FOR_USER"}),e.jsx(nt,{title:"Open",value:A.open,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>{a(i==="OPEN"?"":"OPEN"),n(1)},active:i==="OPEN"}),e.jsx(nt,{title:"Resolved",value:A.resolved,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>{a(i==="RESOLVED"?"":"RESOLVED"),n(1)},active:i==="RESOLVED"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search tickets...",value:l,onChange:D=>{u(D.target.value),n(1)},style:{paddingLeft:"2.25rem"}})]}),e.jsx("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:i,onChange:D=>{a(D.target.value),n(1)},children:pNe.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))}),e.jsx("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:s,onChange:D=>{o(D.target.value),n(1)},children:gNe.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))}),O&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:T,children:[e.jsx(Dr,{size:14})," Clear"]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:d?"1fr 400px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{children:w.length===0?e.jsx("div",{className:"card",style:{padding:"3rem"},children:e.jsx(fn,{icon:"file",title:"No tickets found",message:O?"Try adjusting your filters":"Create your first support ticket to get help"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"1rem"},children:w.map(D=>{const M=d?.id===D.id,Q=rv[D.status]||rv.OPEN,U=nv[D.priority]||nv.MEDIUM;return e.jsxs("div",{className:"card",onClick:()=>f(M?null:D),style:{padding:"1.25rem",cursor:"pointer",border:M?"2px solid #0d9488":"1px solid var(--border)",transition:"all 0.2s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.25rem"},children:cM[D.category]||""}),e.jsx("code",{style:{fontSize:"0.8125rem",fontWeight:500,color:"var(--text-muted)"},children:D.ticketNo})]}),e.jsx("span",{style:{padding:"0.25rem 0.625rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500,background:Q.bg,color:Q.color},children:D.status.replace(/_/g," ")})]}),e.jsx("h3",{style:{fontSize:"0.9375rem",fontWeight:600,marginBottom:"0.5rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:D.subject}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem",fontSize:"0.8125rem",color:"var(--text-muted)"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(r2,{size:12}),D.category]}),e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"8px",fontSize:"0.75rem",fontWeight:500,background:U.bg,color:U.color},children:U.label})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"0.75rem",borderTop:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.8125rem",color:"var(--text-muted)"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(t2,{size:14})," ",D._count?.messages||0]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ah,{size:14})," ",D._count?.attachments||0]})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx(Qt,{size:12}),Ze(new Date(D.lastActivityAt),"MMM d, h:mm a")]})]})]},D.id)})}),C.total>p&&e.jsx("div",{style:{marginTop:"1.5rem"},children:e.jsx(a0,{page:r,pageSize:p,totalCount:C.total,onPageChange:n})})]})}),d&&e.jsxs("div",{className:"card",style:{padding:"1.5rem",position:"sticky",top:"100px",alignSelf:"start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:"Ticket Details"}),e.jsx("button",{onClick:()=>f(null),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem"},children:e.jsx(Dr,{size:18,style:{color:"var(--text-muted)"}})})]}),e.jsxs("div",{style:{background:"rgba(13, 148, 136, 0.1)",padding:"1rem",borderRadius:"8px",marginBottom:"1.25rem",border:"1px solid rgba(13, 148, 136, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:cM[d.category]||""}),e.jsx("code",{style:{fontSize:"0.875rem",fontWeight:500},children:d.ticketNo})]}),e.jsx("h4",{style:{fontSize:"1rem",fontWeight:600,margin:"0.5rem 0"},children:d.subject})]}),e.jsxs("div",{style:{display:"grid",gap:"0.875rem",fontSize:"0.875rem",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Status"}),e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"8px",fontSize:"0.75rem",fontWeight:500,background:rv[d.status]?.bg,color:rv[d.status]?.color},children:d.status.replace(/_/g," ")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Category"}),e.jsx("span",{style:{fontWeight:500},children:d.category})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Priority"}),e.jsx("span",{style:{fontWeight:500,color:nv[d.priority]?.color},children:nv[d.priority]?.label||d.priority})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),e.jsx("span",{style:{fontWeight:500},children:Ze(new Date(d.createdAt),"MMM d, yyyy")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Last Activity"}),e.jsx("span",{style:{fontWeight:500},children:Ze(new Date(d.lastActivityAt),"MMM d, h:mm a")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Messages"}),e.jsx("span",{style:{fontWeight:500},children:d._count?.messages||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Attachments"}),e.jsx("span",{style:{fontWeight:500},children:d._count?.attachments||0})]})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>t(`/portal/helpdesk/${d.id}`),style:{width:"100%",background:"#0d9488",borderColor:"#0d9488"},children:[e.jsx(ih,{size:16,style:{marginRight:"0.5rem"}}),"View Full Ticket"]})]})]})]})}const xNe=[{value:"ACCOUNT",label:"Account Issue",description:"Login, profile, or account settings"},{value:"ORDER",label:"Order Issue",description:"Problems with your orders"},{value:"DELIVERY",label:"Delivery Issue",description:"Shipping or delivery problems"},{value:"INVOICE",label:"Invoice Issue",description:"Billing or invoice questions"},{value:"PAYMENT",label:"Payment Issue",description:"Payment or refund requests"},{value:"QC",label:"Quality Issue",description:"Product quality concerns"},{value:"SYSTEM",label:"System Issue",description:"Technical problems or bugs"},{value:"OTHER",label:"Other",description:"Other inquiries"}],vNe=[{value:"LOW",label:"Low",description:"General inquiry, no urgency"},{value:"MEDIUM",label:"Medium",description:"Important but not urgent"},{value:"HIGH",label:"High",description:"Urgent, needs quick response"},{value:"CRITICAL",label:"Critical",description:"Emergency, requires immediate attention"}];function bNe(){const t=Gr(),r=pr(),[n,i]=k.useState({subject:"",description:"",category:"",priority:"MEDIUM",relatedEntityType:"",relatedEntityId:""}),[a,s]=k.useState(""),o=ot({mutationFn:async u=>{const{data:d}=await xe.post("/helpdesk/tickets",u);return d},onSuccess:u=>{r.invalidateQueries({queryKey:["portal-tickets"]}),t(`/portal/helpdesk/${u.id}`)},onError:u=>{s(u.response?.data?.error||"Failed to create ticket")}}),l=u=>{if(u.preventDefault(),s(""),!n.subject.trim()){s("Please enter a subject");return}if(!n.description.trim()){s("Please describe your issue");return}if(!n.category){s("Please select a category");return}o.mutate(n)};return e.jsxs("div",{style:{padding:"1.5rem",maxWidth:"800px",margin:"0 auto"},children:[e.jsxs(nr,{to:"/portal/helpdesk",style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",marginBottom:"1rem",textDecoration:"none"},children:[e.jsx(sa,{size:18}),"Back to My Tickets"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx(Sm,{size:28,style:{color:"var(--primary)"}}),e.jsx("h1",{style:{margin:0},children:"Create Support Ticket"})]}),e.jsx("form",{onSubmit:l,children:e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[a&&e.jsxs("div",{className:"alert alert-danger",style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sn,{size:18}),a]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Subject *"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Brief summary of your issue",value:n.subject,onChange:u=>i({...n,subject:u.target.value}),maxLength:200})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Category *"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"0.75rem"},children:xNe.map(u=>e.jsxs("label",{style:{padding:"1rem",border:`2px solid ${n.category===u.value?"var(--primary)":"var(--border)"}`,borderRadius:"8px",cursor:"pointer",background:n.category===u.value?"var(--primary-bg)":"transparent",transition:"all 0.2s"},children:[e.jsx("input",{type:"radio",name:"category",value:u.value,checked:n.category===u.value,onChange:d=>i({...n,category:d.target.value}),style:{display:"none"}}),e.jsx("div",{style:{fontWeight:500},children:u.label}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:u.description})]},u.value))})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Priority"}),e.jsx("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:vNe.map(u=>e.jsxs("label",{style:{padding:"0.75rem 1rem",border:`2px solid ${n.priority===u.value?"var(--primary)":"var(--border)"}`,borderRadius:"8px",cursor:"pointer",background:n.priority===u.value?"var(--primary-bg)":"transparent",transition:"all 0.2s",flex:"1",minWidth:"140px"},children:[e.jsx("input",{type:"radio",name:"priority",value:u.value,checked:n.priority===u.value,onChange:d=>i({...n,priority:d.target.value}),style:{display:"none"}}),e.jsx("div",{style:{fontWeight:500},children:u.label}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:u.description})]},u.value))})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[e.jsx("label",{className:"form-label",children:"Description *"}),e.jsx("textarea",{className:"form-input",rows:6,placeholder:"Please describe your issue in detail. Include any relevant information such as order numbers, error messages, or steps to reproduce the problem.",value:n.description,onChange:u=>i({...n,description:u.target.value}),style:{resize:"vertical",minHeight:"120px"}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx(nr,{to:"/portal/helpdesk",className:"btn",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:o.isPending,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qi,{size:18}),o.isPending?"Submitting...":"Submit Ticket"]})]})]})})]})}const dM={NEW:{color:"var(--info)",bg:"var(--info-bg)",label:"New"},OPEN:{color:"var(--primary)",bg:"var(--primary-bg)",label:"Open"},IN_PROGRESS:{color:"var(--warning)",bg:"var(--warning-bg)",label:"In Progress"},WAITING_FOR_USER:{color:"var(--danger)",bg:"var(--danger-bg)",label:"Waiting for Your Reply"},WAITING_FOR_ADMIN:{color:"var(--info)",bg:"var(--info-bg)",label:"Waiting for Support"},RESOLVED:{color:"var(--success)",bg:"var(--success-bg)",label:"Resolved"},CLOSED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"Closed"},CANCELLED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"Cancelled"}},jNe={LOW:"Low",MEDIUM:"Medium",HIGH:"High",CRITICAL:"Critical"};function wNe(){const{id:t}=fl(),{user:r}=Il(),n=pr(),[i,a]=k.useState(""),{data:s,isLoading:o,error:l}=Ve({queryKey:["portal-ticket",t],queryFn:async()=>{const{data:x}=await xe.get(`/helpdesk/tickets/${t}`);return x},enabled:!!t}),u=ot({mutationFn:async x=>{const{data:v}=await xe.post(`/helpdesk/tickets/${t}/reply`,{body:x});return v},onSuccess:()=>{a(""),n.invalidateQueries({queryKey:["portal-ticket",t]}),n.invalidateQueries({queryKey:["portal-tickets"]})}}),d=x=>{x.preventDefault(),i.trim()&&u.mutate(i)};if(o)return e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("div",{className:"spinner"}),"Loading ticket..."]});if(l||!s)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs(nr,{to:"/portal/helpdesk",style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",marginBottom:"1rem",textDecoration:"none"},children:[e.jsx(sa,{size:18}),"Back to My Tickets"]}),e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{children:"Ticket not found"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"This ticket may not exist or you don't have access to view it."})]})]});const f=!["CLOSED","CANCELLED","RESOLVED"].includes(s.status),p=dM[s.status]||dM.NEW;return e.jsxs("div",{style:{padding:"1.5rem",maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(nr,{to:"/portal/helpdesk",style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",marginBottom:"1rem",textDecoration:"none"},children:[e.jsx(sa,{size:18}),"Back to My Tickets"]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx(Sm,{size:24,style:{color:"var(--primary)"}}),e.jsx("code",{style:{fontSize:"1rem",fontWeight:600},children:s.ticketNo}),e.jsx("span",{className:"badge",style:{background:p.bg,color:p.color,fontWeight:500},children:p.label})]}),e.jsx("h1",{style:{margin:0,fontSize:"1.25rem"},children:s.subject})]}),e.jsxs("div",{style:{textAlign:"right",fontSize:"0.85rem",color:"var(--text-muted)"},children:[e.jsxs("div",{children:["Created ",Ze(new Date(s.createdAt),"MMM d, yyyy h:mm a")]}),e.jsxs("div",{children:["Last update ",Ze(new Date(s.lastActivityAt),"MMM d, yyyy h:mm a")]})]})]})}),e.jsxs("div",{style:{padding:"1rem 1.5rem",background:"var(--bg-secondary)",display:"flex",gap:"2rem",flexWrap:"wrap",fontSize:"0.9rem"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Category:"})," ",e.jsx("strong",{children:s.category})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Priority:"})," ",e.jsx("strong",{children:jNe[s.priority]||s.priority})]}),s.assignedToUser&&e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Assigned to:"})," ",e.jsxs("strong",{children:[s.assignedToUser.firstName," ",s.assignedToUser.lastName]})]}),s.relatedEntityType&&s.relatedEntityId&&e.jsxs("div",{children:[e.jsxs("span",{style:{color:"var(--text-muted)"},children:["Related ",s.relatedEntityType,":"]})," ",e.jsxs(nr,{to:`/portal/${s.relatedEntityType.toLowerCase()}s/${s.relatedEntityId}`,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:["View ",e.jsx(ih,{size:12})]})]})]})]}),s.status==="WAITING_FOR_USER"&&e.jsxs("div",{className:"alert alert-warning",style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sn,{size:18}),e.jsx("span",{children:"Support is waiting for your response. Please reply below."})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",fontWeight:500,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(t2,{size:18}),"Conversation"]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem",paddingBottom:"1.5rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"var(--primary)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:600},children:[s.requesterUser?.firstName?.[0],s.requesterUser?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[s.requesterUser?.firstName," ",s.requesterUser?.lastName]}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",marginLeft:"0.5rem"},children:["(You)  ",Ze(new Date(s.createdAt),"MMM d, h:mm a")]})]})]}),e.jsx("div",{style:{marginLeft:"40px",whiteSpace:"pre-wrap"},children:s.description}),s.attachments?.filter(x=>!x.messageId).length>0&&e.jsxs("div",{style:{marginLeft:"40px",marginTop:"1rem"},children:[e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:[e.jsx(ah,{size:12})," Attachments"]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:s.attachments.filter(x=>!x.messageId).map(x=>e.jsxs("a",{href:x.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ir,{size:14}),x.fileName]},x.id))})]})]}),s.messages?.map(x=>{const v=x.createdByUserId===r?.id;return e.jsxs("div",{style:{marginBottom:"1.5rem",paddingBottom:"1.5rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:v?"var(--primary)":"var(--success)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem",fontWeight:600},children:[x.createdByUser?.firstName?.[0],x.createdByUser?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[x.createdByUser?.firstName," ",x.createdByUser?.lastName]}),v&&e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",marginLeft:"0.25rem"},children:"(You)"}),!v&&e.jsx("span",{className:"badge",style:{marginLeft:"0.5rem",background:"var(--success-bg)",color:"var(--success)",fontSize:"0.7rem"},children:"Support"}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.8rem",marginLeft:"0.5rem"},children:[" ",Ze(new Date(x.createdAt),"MMM d, h:mm a")]})]})]}),e.jsx("div",{style:{marginLeft:"40px",whiteSpace:"pre-wrap"},children:x.body}),x.attachments?.length>0&&e.jsx("div",{style:{marginLeft:"40px",marginTop:"1rem"},children:e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:x.attachments.map(w=>e.jsxs("a",{href:w.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ir,{size:14}),w.fileName]},w.id))})})]},x.id)}),s.messages?.length===0&&e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:[e.jsx(Qt,{size:32,style:{marginBottom:"0.5rem",opacity:.5}}),e.jsx("p",{children:"No replies yet. Our support team will respond shortly."})]})]})]}),f?e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:d,style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qi,{size:16}),"Your Reply"]}),e.jsx("textarea",{className:"form-input",rows:4,placeholder:"Type your message here...",value:i,onChange:x=>a(x.target.value),style:{resize:"vertical",minHeight:"100px"}})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:!i.trim()||u.isPending,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qi,{size:16}),u.isPending?"Sending...":"Send Reply"]})})]})}):e.jsxs("div",{className:"card",style:{padding:"1.5rem",textAlign:"center",background:"var(--bg-secondary)"},children:[e.jsx(Ft,{size:32,style:{color:"var(--success)",marginBottom:"0.5rem"}}),e.jsxs("p",{style:{margin:0,color:"var(--text-muted)"},children:["This ticket is ",s.status.toLowerCase(),". If you need further assistance, please create a new ticket."]})]})]})}const SNe={ORDER:Fo,BATCH:Bi,SHIPMENT:dn,INVOICE:td,APPROVAL:gu,ALERT:sn,INFO:lf,TICKET:am},CNe={ORDER:"#0d9488",BATCH:"#8b5cf6",SHIPMENT:"#f59e0b",INVOICE:"#10b981",APPROVAL:"#ec4899",ALERT:"#ef4444",INFO:"#6b7280",TICKET:"#3b82f6"};function uM(t,r){if(!t||!r)return null;switch(t.toLowerCase()){case"order":return`/portal/orders/${r}/journey`;case"shipment":return"/portal/orders";case"invoice":return"/portal/invoices";case"ticket":return`/portal/helpdesk/${r}`;default:return null}}function NNe(){const t=Gr(),r=pr(),[n,i]=k.useState("all"),[a,s]=k.useState(""),[o,l]=k.useState(1),u=20,{data:d,isLoading:f}=Ve({queryKey:["portal-notifications",n,o],queryFn:async()=>{const O=new URLSearchParams;n==="unread"&&O.append("unreadOnly","true"),O.append("limit",u.toString()),O.append("page",o.toString());const{data:D}=await xe.get(`/notifications?${O.toString()}`);return D}}),p=ot({mutationFn:async O=>{await xe.patch(`/notifications/${O}/read`)},onSuccess:()=>{r.invalidateQueries({queryKey:["portal-notifications"]}),r.invalidateQueries({queryKey:["notifications"]})}}),x=ot({mutationFn:async()=>{await xe.patch("/notifications/read-all")},onSuccess:()=>{r.invalidateQueries({queryKey:["portal-notifications"]}),r.invalidateQueries({queryKey:["notifications"]})}}),v=O=>{O.isRead||p.mutate(O.id);const D=uM(O.relatedType,O.relatedId);D&&t(D)},w=d?.notifications||[],C=d?.unreadCount||0,A=w.filter(O=>!(n==="read"&&!O.isRead||a&&O.type!==a)),T=[...new Set(w.map(O=>O.type))];return f?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"rgba(13, 148, 136, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(xo,{size:24,style:{color:"#0d9488"}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:"Notifications"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"0.875rem"},children:[C," unread notification",C!==1?"s":""]})]})]}),C>0&&e.jsxs("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"btn",style:{display:"flex",alignItems:"center",gap:"0.5rem",background:"#0d9488",borderColor:"#0d9488",color:"white"},children:[e.jsx(XL,{size:16}),"Mark All as Read"]})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:16,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,fontSize:"0.875rem"},children:"Filter:"})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:["all","unread","read"].map(O=>e.jsx("button",{onClick:()=>{i(O),l(1)},style:{padding:"0.375rem 0.75rem",borderRadius:"6px",border:"none",background:n===O?"#0d9488":"var(--bg-secondary)",color:n===O?"white":"var(--text-primary)",fontSize:"0.8rem",fontWeight:500,cursor:"pointer",textTransform:"capitalize"},children:O},O))}),T.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"1px",height:"24px",background:"var(--border)",margin:"0 0.5rem"}}),e.jsxs("select",{value:a,onChange:O=>s(O.target.value),className:"form-select",style:{fontSize:"0.8rem",padding:"0.375rem 0.75rem",minWidth:"140px"},children:[e.jsx("option",{value:"",children:"All Types"}),T.map(O=>e.jsx("option",{value:O,children:O},O))]})]})]})}),e.jsx("div",{className:"card",style:{padding:0},children:A.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(xo,{size:48,style:{opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{margin:0,fontSize:"0.9375rem"},children:n==="unread"?"No unread notifications":"No notifications"})]}):e.jsx("div",{children:A.map((O,D)=>{const M=SNe[O.type]||xo,Q=CNe[O.type]||"#6b7280",U=!!uM(O.relatedType,O.relatedId);return e.jsxs("div",{onClick:()=>v(O),style:{display:"flex",gap:"1rem",padding:"1rem 1.25rem",borderBottom:D<A.length-1?"1px solid var(--border)":"none",background:O.isRead?"transparent":"rgba(13, 148, 136, 0.03)",cursor:U?"pointer":"default",transition:"background 0.15s"},onMouseEnter:$=>{U&&($.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:$=>{$.currentTarget.style.background=O.isRead?"transparent":"rgba(13, 148, 136, 0.03)"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:`${Q}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(M,{size:20,style:{color:Q}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.25rem"},children:[e.jsxs("div",{style:{fontWeight:O.isRead?400:600,fontSize:"0.9375rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[O.title,U&&e.jsx(ih,{size:14,style:{color:"var(--text-muted)",opacity:.6}})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",whiteSpace:"nowrap"},children:Ze(new Date(O.createdAt),"MMM d, h:mm a")})]}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"var(--text-muted)",lineHeight:1.5},children:O.message}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginTop:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.6875rem",fontWeight:500,padding:"0.125rem 0.5rem",borderRadius:"4px",background:`${Q}15`,color:Q,textTransform:"uppercase",letterSpacing:"0.5px"},children:O.type}),!O.isRead&&e.jsxs("button",{onClick:$=>{$.stopPropagation(),p.mutate(O.id)},style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#0d9488",background:"none",border:"none",cursor:"pointer",padding:0},children:[e.jsx(Ai,{size:12}),"Mark as read"]})]})]})]},O.id)})})}),d&&d.totalCount>u&&e.jsx("div",{style:{marginTop:"1rem"},children:e.jsx(a0,{page:o,pageSize:u,totalCount:d.totalCount,onPageChange:l})})]})}const hM=[{id:"countries",label:"Countries",icon:sm},{id:"cities",label:"Cities",icon:_a},{id:"regions",label:"Regions",icon:_Z},{id:"categories",label:"Categories",icon:r2},{id:"couriers",label:"Couriers",icon:dn},{id:"vehicles",label:"Vehicles",icon:ZL},{id:"dose-units",label:"Dose Units",icon:Mc},{id:"product-types",label:"Product Types",icon:Rr},{id:"production-methods",label:"Production Methods",icon:lu},{id:"currencies",label:"Currencies",icon:of},{id:"attachments",label:"Attachment Types",icon:ah},{id:"notifications",label:"Notification Routing",icon:xo,link:"/settings/notifications"},{id:"channels",label:"Notification Channels",icon:uc,link:"/admin/notification-channels"},{id:"announcements",label:"Announcements",icon:az,link:"/admin/announcements"},{id:"languages",label:"Languages",icon:py,link:"/admin/languages"},{id:"exchange-rates",label:"Exchange Rates",icon:of,link:"/admin/exchange-rates"},{id:"localization",label:"Localization",icon:Qt,link:"/admin/localization"},{id:"translations",label:"Translations",icon:sm,link:"/admin/translations"},{id:"zatca",label:"ZATCA Integration",icon:gu,link:"/admin/zatca"}];function ANe(){const[t,r]=k.useState("countries"),[n,i]=k.useState(!1),[a,s]=k.useState(null),[o,l]=k.useState({}),u=pr(),d=Gr(),{data:f}=Ve({queryKey:["settings","countries"],queryFn:async()=>{const{data:K}=await xe.get("/settings/countries");return K}}),{data:p}=Ve({queryKey:["settings","cities"],queryFn:async()=>{const{data:K}=await xe.get("/settings/cities");return K}}),{data:x}=Ve({queryKey:["settings","regions"],queryFn:async()=>{const{data:K}=await xe.get("/settings/regions");return K}}),{data:v}=Ve({queryKey:["settings","categories"],queryFn:async()=>{const{data:K}=await xe.get("/settings/categories");return K}}),{data:w}=Ve({queryKey:["settings","couriers"],queryFn:async()=>{const{data:K}=await xe.get("/settings/couriers");return K}}),{data:C}=Ve({queryKey:["settings","vehicles"],queryFn:async()=>{const{data:K}=await xe.get("/settings/vehicles");return K}}),{data:A}=Ve({queryKey:["settings","dose-units"],queryFn:async()=>{const{data:K}=await xe.get("/settings/dose-units");return K}}),{data:T}=Ve({queryKey:["settings","product-types"],queryFn:async()=>{const{data:K}=await xe.get("/settings/product-types");return K}}),{data:O}=Ve({queryKey:["settings","production-methods"],queryFn:async()=>{const{data:K}=await xe.get("/settings/production-methods");return K}}),{data:D}=Ve({queryKey:["settings","currencies"],queryFn:async()=>{const{data:K}=await xe.get("/settings/currencies");return K}}),M=ot({mutationFn:async({endpoint:K,data:ue})=>xe.post(`/settings/${K}`,ue),onSuccess:()=>{u.invalidateQueries({queryKey:["settings",t]}),i(!1),l({})}}),Q=ot({mutationFn:async({endpoint:K,id:ue,data:ce})=>xe.put(`/settings/${K}/${ue}`,ce),onSuccess:()=>{u.invalidateQueries({queryKey:["settings",t]}),i(!1),s(null),l({})}}),U=ot({mutationFn:async({endpoint:K,id:ue})=>xe.delete(`/settings/${K}/${ue}`),onSuccess:()=>{u.invalidateQueries({queryKey:["settings",t]})}}),$=()=>{s(null),l({}),i(!0)},ee=K=>{s(K),l(K),i(!0)},F=async K=>{confirm("Are you sure you want to delete this item?")&&U.mutate({endpoint:t,id:K})},Y=()=>{a?Q.mutate({endpoint:t,id:a.id,data:o}):M.mutate({endpoint:t,data:o})},J=()=>{switch(t){case"countries":return f||[];case"cities":return p||[];case"regions":return x||[];case"categories":return v||[];case"couriers":return w||[];case"vehicles":return C||[];case"dose-units":return A||[];case"product-types":return T||[];case"production-methods":return O||[];case"currencies":return D||[];default:return[]}},Z=()=>{const K=J();switch(t){case"countries":return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Name (Arabic)"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:ue.code}),e.jsx("td",{children:ue.name}),e.jsx("td",{dir:"rtl",children:ue.nameAr||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]});case"cities":return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Name (Arabic)"}),e.jsx("th",{children:"Region"}),e.jsx("th",{children:"Country"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:ue.code}),e.jsx("td",{children:ue.name}),e.jsx("td",{dir:"rtl",children:ue.nameAr||"-"}),e.jsx("td",{children:ue.region?.name||"-"}),e.jsx("td",{children:ue.country?.name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]});case"regions":return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Name (Arabic)"}),e.jsx("th",{children:"Country"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:ue.code}),e.jsx("td",{children:ue.name}),e.jsx("td",{dir:"rtl",children:ue.nameAr||"-"}),e.jsx("td",{children:ue.country?.name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]});case"couriers":return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Vehicles"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:ue.code}),e.jsx("td",{children:ue.name}),e.jsx("td",{children:ue.phone||"-"}),e.jsx("td",{children:ue.email||"-"}),e.jsx("td",{children:ue.vehicles?.length||0}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]});case"vehicles":return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plate Number"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Model"}),e.jsx("th",{children:"Capacity"}),e.jsx("th",{children:"Courier"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:ue.plateNumber}),e.jsx("td",{children:ue.vehicleType}),e.jsx("td",{children:ue.model||"-"}),e.jsx("td",{children:ue.capacity||"-"}),e.jsx("td",{children:ue.courier?.name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]});case"currencies":return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Symbol"}),e.jsx("th",{children:"Exchange Rate"}),e.jsx("th",{children:"Default"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:600},children:ue.code}),e.jsx("td",{children:ue.name}),e.jsx("td",{style:{fontSize:"1.125rem"},children:ue.symbol}),e.jsx("td",{children:ue.exchangeRate.toFixed(4)}),e.jsx("td",{children:ue.isDefault&&e.jsx("span",{className:"badge badge-info",children:"Default"})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),!ue.isDefault&&e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]});case"attachments":return e.jsxs("div",{style:{padding:"3rem",textAlign:"center",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx(ah,{size:48,style:{color:"var(--primary)",marginBottom:"1rem"}}),e.jsx("h3",{style:{margin:"0 0 0.5rem"},children:"Attachment Type Settings"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem"},children:"Configure allowed file types, extensions, and size limits for attachments."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>d("/settings/attachments"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:["Manage Attachment Types",e.jsx(ih,{size:16})]})]});default:return e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px"},children:"Actions"})]})}),e.jsxs("tbody",{children:[K.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:500},children:ue.code}),e.jsx("td",{children:ue.name}),e.jsx("td",{children:ue.description||ue.symbol||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ue.isActive?"success":"default"}`,children:ue.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>ee(ue),title:"Edit",children:e.jsx(Qh,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F(ue.id),title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},ue.id)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--text-muted)",padding:"2rem"},children:"No records found"})})]})]})}},re=()=>{switch(t){case"countries":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value.toUpperCase()}),placeholder:"e.g., SA, AE, US",maxLength:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"e.g., Saudi Arabia"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{type:"text",className:"form-input",dir:"rtl",value:o.nameAr||"",onChange:K=>l({...o,nameAr:K.target.value}),placeholder:"e.g.,   "})]})]});case"cities":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Country *"}),e.jsxs("select",{className:"form-select",value:o.countryId||"",onChange:K=>l({...o,countryId:K.target.value,regionId:""}),children:[e.jsx("option",{value:"",children:"Select Country"}),f?.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Region *"}),e.jsxs("select",{className:"form-select",value:o.regionId||"",onChange:K=>l({...o,regionId:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Region"}),x?.filter(K=>K.countryId===o.countryId).map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value.toUpperCase()}),placeholder:"e.g., JED, RUH"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"e.g., Jeddah"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{type:"text",className:"form-input",dir:"rtl",value:o.nameAr||"",onChange:K=>l({...o,nameAr:K.target.value}),placeholder:"e.g., "})]})]});case"regions":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Country *"}),e.jsxs("select",{className:"form-select",value:o.countryId||"",onChange:K=>l({...o,countryId:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Country"}),f?.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value.toUpperCase()}),placeholder:"e.g., WEST, CENT"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"e.g., Western Region"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{type:"text",className:"form-input",dir:"rtl",value:o.nameAr||"",onChange:K=>l({...o,nameAr:K.target.value}),placeholder:"e.g.,  "})]})]});case"couriers":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value.toUpperCase()}),placeholder:"e.g., COR001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"e.g., Express Medical Courier"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"text",className:"form-input",value:o.phone||"",onChange:K=>l({...o,phone:K.target.value}),placeholder:"e.g., +966 12 345 6789"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-input",value:o.email||"",onChange:K=>l({...o,email:K.target.value}),placeholder:"e.g., courier@example.com"})]})]});case"vehicles":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Courier"}),e.jsxs("select",{className:"form-select",value:o.courierId||"",onChange:K=>l({...o,courierId:K.target.value||null}),children:[e.jsx("option",{value:"",children:"No Courier"}),w?.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Plate Number *"}),e.jsx("input",{type:"text",className:"form-input",value:o.plateNumber||"",onChange:K=>l({...o,plateNumber:K.target.value.toUpperCase()}),placeholder:"e.g., ABC 1234"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Type *"}),e.jsxs("select",{className:"form-select",value:o.vehicleType||"",onChange:K=>l({...o,vehicleType:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"Van",children:"Van"}),e.jsx("option",{value:"Car",children:"Car"}),e.jsx("option",{value:"Truck",children:"Truck"}),e.jsx("option",{value:"Motorcycle",children:"Motorcycle"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Model"}),e.jsx("input",{type:"text",className:"form-input",value:o.model||"",onChange:K=>l({...o,model:K.target.value}),placeholder:"e.g., Toyota Hiace 2024"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Capacity"}),e.jsx("input",{type:"text",className:"form-input",value:o.capacity||"",onChange:K=>l({...o,capacity:K.target.value}),placeholder:"e.g., 50 packages"})]})]});case"currencies":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value.toUpperCase()}),placeholder:"e.g., SAR, USD, EUR",maxLength:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"e.g., Saudi Riyal"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Symbol *"}),e.jsx("input",{type:"text",className:"form-input",value:o.symbol||"",onChange:K=>l({...o,symbol:K.target.value}),placeholder:"e.g., ., $, ",maxLength:5})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Exchange Rate (to SAR) *"}),e.jsx("input",{type:"number",className:"form-input",value:o.exchangeRate||1,onChange:K=>l({...o,exchangeRate:parseFloat(K.target.value)}),step:"0.0001",min:"0"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Rate relative to SAR (SAR = 1.0000)"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:o.isDefault||!1,onChange:K=>l({...o,isDefault:K.target.checked})}),e.jsx("span",{className:"form-label",style:{marginBottom:0},children:"Set as default currency"})]})})]});case"dose-units":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value}),placeholder:"e.g., mCi, MBq, GBq"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"e.g., Millicurie"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Symbol *"}),e.jsx("input",{type:"text",className:"form-input",value:o.symbol||"",onChange:K=>l({...o,symbol:K.target.value}),placeholder:"e.g., mCi"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("input",{type:"text",className:"form-input",value:o.description||"",onChange:K=>l({...o,description:K.target.value}),placeholder:"e.g., Unit of radioactivity"})]})]});default:return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code||"",onChange:K=>l({...o,code:K.target.value.toUpperCase()}),placeholder:"Enter code"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name||"",onChange:K=>l({...o,name:K.target.value}),placeholder:"Enter name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{type:"text",className:"form-input",dir:"rtl",value:o.nameAr||"",onChange:K=>l({...o,nameAr:K.target.value}),placeholder:"Enter Arabic name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-input",value:o.description||"",onChange:K=>l({...o,description:K.target.value}),placeholder:"Enter description",rows:2})]})]})}},de=hM.find(K=>K.id===t),le=de?.icon||sh;return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Settings"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Configure lookup tables and system master data"})]})}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[e.jsx("div",{className:"card",style:{width:"220px",padding:"0.5rem",flexShrink:0},children:e.jsx("nav",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:hM.map(K=>{const ue=K.icon,ce=t===K.id,ye=K;return e.jsxs("button",{onClick:()=>{ye.link?d(ye.link):r(K.id)},className:ce?"btn btn-primary":"btn btn-secondary",style:{justifyContent:"flex-start",width:"100%",fontWeight:ce?600:400},children:[e.jsx(ue,{size:16}),K.label,ye.link&&e.jsx(ih,{size:12,style:{marginLeft:"auto"}})]},K.id)})})}),e.jsxs("div",{className:"card",style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(le,{size:18}),de?.label]}),e.jsxs("button",{className:"btn btn-primary",onClick:$,children:[e.jsx(cn,{size:18}),"Add New"]})]}),e.jsx("div",{style:{overflow:"auto"},children:Z()})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:()=>i(!1),children:e.jsxs("div",{className:"modal",onClick:K=>K.stopPropagation(),style:{maxWidth:"500px",width:"95%"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{style:{fontWeight:600,margin:0,fontSize:"1.125rem"},children:[a?"Edit":"Add New"," ",de?.label.replace(/ies$/,"y").replace(/s$/,"")]}),e.jsx("button",{className:"btn btn-sm",onClick:()=>i(!1),style:{padding:"0.375rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:e.jsx(Dr,{size:18})})]}),e.jsxs("div",{className:"modal-body",children:[re(),a&&e.jsx("div",{className:"form-group",style:{marginTop:"1.25rem",paddingTop:"1rem",borderTop:"1px solid var(--border)"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer",padding:"0.75rem 1rem",background:o.isActive!==!1?"rgba(34, 197, 94, 0.08)":"rgba(239, 68, 68, 0.08)",borderRadius:"var(--radius)",border:`1px solid ${o.isActive!==!1?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`},children:[e.jsx("input",{type:"checkbox",checked:o.isActive!==!1,onChange:K=>l({...o,isActive:K.target.checked}),style:{width:"18px",height:"18px",cursor:"pointer"}}),e.jsx("span",{style:{fontWeight:500,color:o.isActive!==!1?"var(--success)":"var(--danger)"},children:o.isActive!==!1?"Active":"Inactive"})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:Y,disabled:M.isPending||Q.isPending,children:M.isPending||Q.isPending?"Saving...":"Save"})]})]})})]})}function ENe(){const t=Gr(),{data:r,isLoading:n,isError:i,error:a,refetch:s,isFetching:o}=Ve({queryKey:["dashboard-qc"],queryFn:async()=>{const{data:u}=await xe.get("/dashboard/qc");return u},refetchInterval:6e4});if(i)return e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(Hr,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Failed to load QC dashboard"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:a instanceof Error?a.message:"An error occurred."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>s(),children:"Try Again"})]});if(n)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[1,2,3,4].map(u=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},u))}),e.jsx("div",{className:"card skeleton",style:{height:"400px"}})]});const l=[{id:"qc_failed",type:"error",icon:"qc_failed",title:"QC Failed Batches",count:r?.kpis?.qcFailed||0,linkTo:"/batches?status=FAILED_QC"}];return e.jsxs("div",{children:[e.jsx(s0,{title:"QC Dashboard",subtitle:"Quality control queue and batch testing overview",lastRefreshed:r?.lastRefreshed?new Date(r.lastRefreshed):void 0,onRefresh:()=>s(),isRefreshing:o,actions:e.jsx("button",{className:"btn btn-secondary",onClick:()=>t("/"),children:"Back to Overview"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Awaiting Samples",value:r?.kpis?.awaitingSamples||0,icon:e.jsx(Bi,{size:20}),color:"warning",linkTo:"/qc?status=QC_PENDING"}),e.jsx(nt,{title:"QC In Progress",value:r?.kpis?.qcInProgress||0,icon:e.jsx(Qt,{size:20}),color:"info",linkTo:"/qc?status=QC_IN_PROGRESS"}),e.jsx(nt,{title:"QC Failed",value:r?.kpis?.qcFailed||0,icon:e.jsx(ri,{size:20}),color:r?.kpis?.qcFailed>0?"danger":void 0,linkTo:"/batches?status=FAILED_QC"}),e.jsx(nt,{title:"Nearing Deadline",value:r?.kpis?.nearingDeadline||0,icon:e.jsx(Hr,{size:20}),color:r?.kpis?.nearingDeadline>0?"warning":void 0,linkTo:"/qc?urgent=true"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem"},children:[e.jsx(Tc,{title:"QC Queue - Prioritized by Delivery Urgency",items:r?.queue||[],viewAllLink:"/qc",maxItems:10,icon:e.jsx(Bi,{size:18,style:{color:"#d97706"}}),accentColor:"#d97706",emptyMessage:"No batches awaiting QC testing"}),e.jsx(yy,{title:"QC Exceptions",items:l})]})]})}function _Ne(){const t=Gr(),{data:r,isLoading:n,isError:i,error:a,refetch:s,isFetching:o}=Ve({queryKey:["dashboard-qp"],queryFn:async()=>{const{data:u}=await xe.get("/dashboard/qp");return u},refetchInterval:6e4});if(i)return e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Failed to load QP dashboard"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:a instanceof Error?a.message:"An error occurred."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>s(),children:"Try Again"})]});if(n)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[1,2,3,4].map(u=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},u))}),e.jsx("div",{className:"card skeleton",style:{height:"400px"}})]});const l=[{id:"on_hold",type:"warning",icon:"on_hold",title:"On Hold Batches",count:r?.kpis?.onHold||0,linkTo:"/batches?status=ON_HOLD"},{id:"rejected",type:"error",icon:"qc_failed",title:"Rejected Batches",count:r?.kpis?.rejected||0,linkTo:"/batches?status=REJECTED"}];return e.jsxs("div",{children:[e.jsx(s0,{title:"QP Release Dashboard",subtitle:"Batch release queue and QP approval overview",lastRefreshed:r?.lastRefreshed?new Date(r.lastRefreshed):void 0,onRefresh:()=>s(),isRefreshing:o,actions:e.jsx("button",{className:"btn btn-secondary",onClick:()=>t("/"),children:"Back to Overview"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Awaiting QP Release",value:r?.kpis?.awaitingQP||0,icon:e.jsx(aa,{size:20}),color:"warning",linkTo:"/release?status=QC_PASSED"}),e.jsx(nt,{title:"On Hold",value:r?.kpis?.onHold||0,icon:e.jsx(sn,{size:20}),color:r?.kpis?.onHold>0?"warning":void 0,linkTo:"/batches?status=ON_HOLD"}),e.jsx(nt,{title:"Released Today",value:r?.kpis?.releasedToday||0,icon:e.jsx(Ft,{size:20}),color:"success",linkTo:"/batches?status=RELEASED&today=true"}),e.jsx(nt,{title:"Rejected",value:r?.kpis?.rejected||0,icon:e.jsx(ri,{size:20}),color:r?.kpis?.rejected>0?"danger":void 0,linkTo:"/batches?status=REJECTED"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem"},children:[e.jsx(Tc,{title:"QP Release Queue",items:r?.queue||[],viewAllLink:"/release",maxItems:10,icon:e.jsx(aa,{size:18,style:{color:"#7c3aed"}}),accentColor:"#7c3aed",emptyMessage:"No batches awaiting QP release"}),e.jsx(yy,{title:"Release Exceptions",items:l})]})]})}function TNe(){const t=Gr(),{data:r,isLoading:n,isError:i,error:a,refetch:s,isFetching:o}=Ve({queryKey:["dashboard-dispensing"],queryFn:async()=>{const{data:u}=await xe.get("/dashboard/dispensing");return u},refetchInterval:6e4});if(i)return e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(Hr,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Failed to load Dispensing dashboard"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:a instanceof Error?a.message:"An error occurred."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>s(),children:"Try Again"})]});if(n)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[1,2,3,4].map(u=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},u))}),e.jsx("div",{className:"card skeleton",style:{height:"400px"}})]});const l=[{id:"blocked",type:"warning",icon:"on_hold",title:"Blocked (Not Released)",count:r?.kpis?.blocked||0,linkTo:"/batches?status=ON_HOLD,FAILED_QC"}];return e.jsxs("div",{children:[e.jsx(s0,{title:"Dispensing Dashboard",subtitle:"Dose dispensing queue and progress tracking",lastRefreshed:r?.lastRefreshed?new Date(r.lastRefreshed):void 0,onRefresh:()=>s(),isRefreshing:o,actions:e.jsx("button",{className:"btn btn-secondary",onClick:()=>t("/"),children:"Back to Overview"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Ready to Dispense",value:r?.kpis?.readyToDispense||0,icon:e.jsx(Rr,{size:20}),color:"success",linkTo:"/dispensing?ready=true"}),e.jsx(nt,{title:"Dispensing In Progress",value:r?.kpis?.dispensingInProgress||0,icon:e.jsx(yo,{size:20}),color:"info",linkTo:"/dispensing?status=DISPENSING_IN_PROGRESS"}),e.jsx(nt,{title:"Blocked",value:r?.kpis?.blocked||0,icon:e.jsx(qC,{size:20}),color:r?.kpis?.blocked>0?"warning":void 0,linkTo:"/batches?status=ON_HOLD,FAILED_QC"}),e.jsx(nt,{title:"Dispensed Today",value:r?.kpis?.dispensedToday||0,icon:e.jsx(Ft,{size:20}),color:"success",linkTo:"/dispensing?dispensed=today"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem"},children:[e.jsx(Tc,{title:"Dispensing Queue",items:r?.queue||[],viewAllLink:"/dispensing",maxItems:10,icon:e.jsx(Rr,{size:18,style:{color:"#0d9488"}}),accentColor:"#0d9488",emptyMessage:"No batches ready for dispensing"}),e.jsx(yy,{title:"Dispensing Exceptions",items:l})]})]})}function INe(){const t=Gr(),{data:r,isLoading:n,isError:i,error:a,refetch:s,isFetching:o}=Ve({queryKey:["dashboard-logistics"],queryFn:async()=>{const{data:u}=await xe.get("/dashboard/logistics");return u},refetchInterval:6e4});if(i)return e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(Hr,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Failed to load Logistics dashboard"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:a instanceof Error?a.message:"An error occurred."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>s(),children:"Try Again"})]});if(n)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[1,2,3,4,5].map(u=>e.jsx("div",{className:"card skeleton",style:{height:"100px"}},u))}),e.jsx("div",{className:"card skeleton",style:{height:"400px"}})]});const l=[{id:"delayed",type:"error",icon:"delay",title:"Delayed Shipments",count:r?.kpis?.delayed||0,linkTo:"/shipments?status=DELAYED"}];return e.jsxs("div",{children:[e.jsx(s0,{title:"Logistics Dashboard",subtitle:"Shipment tracking and delivery management",lastRefreshed:r?.lastRefreshed?new Date(r.lastRefreshed):void 0,onRefresh:()=>s(),isRefreshing:o,actions:e.jsx("button",{className:"btn btn-secondary",onClick:()=>t("/"),children:"Back to Overview"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Ready to Pack",value:r?.kpis?.readyToPack||0,icon:e.jsx(Rr,{size:20}),linkTo:"/shipments?status=CREATED"}),e.jsx(nt,{title:"Ready to Dispatch",value:r?.kpis?.readyToDispatch||0,icon:e.jsx(Qi,{size:20}),color:"info",linkTo:"/shipments?status=ASSIGNED"}),e.jsx(nt,{title:"In Transit",value:r?.kpis?.inTransit||0,icon:e.jsx(dn,{size:20}),color:"warning",linkTo:"/shipments?status=IN_TRANSIT"}),e.jsx(nt,{title:"Delayed",value:r?.kpis?.delayed||0,icon:e.jsx(Hr,{size:20}),color:r?.kpis?.delayed>0?"danger":void 0,linkTo:"/shipments?status=DELAYED"}),e.jsx(nt,{title:"Delivered Today",value:r?.kpis?.deliveredToday||0,icon:e.jsx(Ft,{size:20}),color:"success",linkTo:"/shipments?delivered=today"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem"},children:[e.jsx(Tc,{title:"Logistics Queue",items:r?.queue||[],viewAllLink:"/shipments",maxItems:10,icon:e.jsx(dn,{size:18,style:{color:"#0891b2"}}),accentColor:"#0891b2",emptyMessage:"No shipments in queue"}),e.jsx(yy,{title:"Logistics Exceptions",items:l})]})]})}function ONe(){const t=pr(),[r,n]=k.useState("PENDING_CONFIRMATION"),[i,a]=k.useState(null),[s,o]=k.useState(!1),[l,u]=k.useState(""),{data:d}=Ve({queryKey:["payment-stats"],queryFn:async()=>{const{data:T}=await xe.get("/payments/stats");return T}}),{data:f,isLoading:p}=Ve({queryKey:["payment-requests",r],queryFn:async()=>{const T={limit:50};r&&(T.status=r);const{data:O}=await xe.get("/payments",{params:T});return O.data}}),{data:x,refetch:v}=Ve({queryKey:["payment-request-detail",i?.id],queryFn:async()=>{if(!i?.id)return null;const{data:T}=await xe.get(`/payments/${i.id}`);return T},enabled:!!i?.id}),w=ot({mutationFn:async T=>{const{data:O}=await xe.post(`/payments/${T}/confirm`);return O},onSuccess:T=>{Ki.success("Payment confirmed! Receipt voucher generated."),t.invalidateQueries({queryKey:["payment-requests"]}),t.invalidateQueries({queryKey:["payment-stats"]}),v(),a(null)},onError:T=>{Ki.error(T.response?.data?.error||"Failed to confirm payment")}}),C=ot({mutationFn:async({id:T,reason:O})=>{const{data:D}=await xe.post(`/payments/${T}/reject`,{reason:O});return D},onSuccess:()=>{Ki.success("Payment rejected"),t.invalidateQueries({queryKey:["payment-requests"]}),t.invalidateQueries({queryKey:["payment-stats"]}),o(!1),u(""),a(null)},onError:T=>{Ki.error(T.response?.data?.error||"Failed to reject payment")}}),A=T=>{const O={PENDING_CONFIRMATION:{color:"warning",icon:Qt},CONFIRMED:{color:"success",icon:Ft},REJECTED:{color:"danger",icon:ri}},{color:D,icon:M}=O[T]||{color:"default",icon:Qt};return e.jsxs("span",{className:`badge badge-${D}`,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(M,{size:12}),T]})};return p?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem"},children:"Payment Approvals"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"Review and process customer payment submissions"})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:r==="PENDING_CONFIRMATION"?"2px solid var(--warning)":void 0},onClick:()=>n("PENDING_CONFIRMATION"),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(234, 179, 8, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Qt,{size:20,style:{color:"var(--warning)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600},children:d?.pending||0}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Pending Review"})]})]})}),e.jsx("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:r==="CONFIRMED"?"2px solid var(--success)":void 0},onClick:()=>n("CONFIRMED"),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(34, 197, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ft,{size:20,style:{color:"var(--success)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--success)"},children:d?.confirmed||0}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Confirmed"})]})]})}),e.jsx("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:r==="REJECTED"?"2px solid var(--danger)":void 0},onClick:()=>n("REJECTED"),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(239, 68, 68, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ri,{size:20,style:{color:"var(--danger)"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600,color:"var(--danger)"},children:d?.rejected||0}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Rejected"})]})]})}),e.jsx("div",{className:"card",style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"rgba(13, 148, 136, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ul,{size:20,style:{color:"#0d9488"}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600},children:Mf(d?.totalPendingAmount||0)}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:"Pending Amount"})]})]})})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:i?"1fr 450px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{className:"card",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Method"}),e.jsx("th",{children:"Submitted"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"60px"},children:"Action"})]})}),e.jsxs("tbody",{children:[f?.map(T=>e.jsxs("tr",{style:{cursor:"pointer",backgroundColor:i?.id===T.id?"var(--background-secondary)":void 0},onClick:()=>a(T),children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:T.invoice?.customer?.nameEn||T.invoice?.customer?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:T.invoice?.customer?.code})]}),e.jsx("td",{style:{fontFamily:"monospace"},children:T.invoice?.invoiceNumber}),e.jsx("td",{style:{fontWeight:500},children:Mf(T.amount)}),e.jsx("td",{children:T.paymentMethod?.replace("_"," ")}),e.jsx("td",{children:Ze(new Date(T.submittedAt),"MMM d, HH:mm")}),e.jsx("td",{children:A(T.status)}),e.jsx("td",{onClick:O=>O.stopPropagation(),children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>a(T),children:e.jsx(os,{size:14})})})]},T.id)),(!f||f.length===0)&&e.jsx("tr",{children:e.jsxs("td",{colSpan:7,style:{textAlign:"center",padding:"3rem"},children:[e.jsx(Ul,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"No payment requests found"})]})})]})]})}),i&&e.jsxs("div",{className:"card",style:{maxHeight:"calc(100vh - 240px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",paddingBottom:"1rem",borderBottom:"1px solid var(--border)",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",marginBottom:"0.25rem"},children:"Payment Request"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:x?.invoice?.customer?.nameEn||x?.invoice?.customer?.name})]}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>a(null),children:e.jsx(Dr,{size:14})})]}),e.jsxs("div",{style:{backgroundColor:"rgba(234, 179, 8, 0.1)",borderLeft:"4px solid #3b82f6",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Payment Amount"}),e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"#16a34a"},children:Mf(i.amount)})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Invoice"}),e.jsx("div",{style:{fontWeight:500,fontFamily:"monospace",color:"var(--primary)"},children:x?.invoice?.invoiceNumber})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Method"}),e.jsx("div",{style:{fontWeight:600},children:i.paymentMethod?.replace("_"," ")})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Submitted"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(i.submittedAt),"MMM d, yyyy HH:mm")})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Status"}),e.jsx("div",{children:A(i.status)})]})]}),i.reference&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Reference"}),e.jsx("div",{style:{fontFamily:"monospace",backgroundColor:"var(--background-secondary)",padding:"0.5rem",borderRadius:"0.25rem"},children:i.reference})]}),i.notes&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Notes"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:i.notes})]}),i.proofUrl&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.5rem"},children:"Payment Proof"}),e.jsxs("a",{href:i.proofUrl,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline",style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ir,{size:16}),"View Proof",e.jsx(ih,{size:14})]})]}),x?.invoice&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",marginBottom:"0.75rem"},children:"Invoice Summary"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Total Amount"}),e.jsx("span",{style:{fontWeight:500},children:Mf(x.invoice.totalAmount)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Already Paid"}),e.jsx("span",{style:{fontWeight:500,color:"#16a34a"},children:Mf(x.invoice.paidAmount)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid var(--border)",paddingTop:"0.75rem"},children:[e.jsx("span",{style:{fontWeight:500},children:"Balance After This Payment"}),e.jsx("span",{style:{fontWeight:600},children:Mf(Math.max(0,x.invoice.totalAmount-x.invoice.paidAmount-i.amount))})]})]})]}),i.status==="REJECTED"&&i.rejectReason&&e.jsxs("div",{style:{backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--danger)",padding:"0.75rem",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--danger)",textTransform:"uppercase",marginBottom:"0.25rem"},children:"Rejection Reason"}),e.jsx("div",{style:{color:"var(--danger)"},children:i.rejectReason})]}),i.status==="PENDING_CONFIRMATION"&&e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsxs("button",{className:"btn btn-success",style:{flex:1},onClick:()=>w.mutate(i.id),disabled:w.isPending,children:[e.jsx(Ai,{size:16,style:{marginRight:"0.5rem"}}),w.isPending?"Confirming...":"Confirm Payment"]}),e.jsxs("button",{className:"btn btn-danger",style:{flex:1},onClick:()=>o(!0),disabled:C.isPending,children:[e.jsx(Dr,{size:16,style:{marginRight:"0.5rem"}}),"Reject"]})]}),i.reviewedBy&&e.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[i.status==="CONFIRMED"?"Confirmed":"Rejected"," by ",i.reviewedBy?.fullName||i.reviewedBy?.username,i.reviewedAt&&` on ${Ze(new Date(i.reviewedAt),"MMM d, yyyy HH:mm")}`]})]})]}),s&&e.jsx("div",{className:"modal-overlay",onClick:()=>o(!1),children:e.jsxs("div",{className:"modal",onClick:T=>T.stopPropagation(),style:{maxWidth:"400px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:"Reject Payment"}),e.jsx("button",{className:"modal-close",onClick:()=>o(!1),children:e.jsx(Dr,{size:20})})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Rejection Reason *"}),e.jsx("textarea",{className:"form-textarea",value:l,onChange:T=>u(T.target.value),placeholder:"Please provide a reason for rejection",rows:3,required:!0})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-danger",onClick:()=>C.mutate({id:i.id,reason:l}),disabled:!l||C.isPending,children:C.isPending?"Rejecting...":"Reject Payment"})]})]})})]})}function kNe(){const t=pr(),[r,n]=k.useState(!1),[i,a]=k.useState(null),[s,o]=k.useState({name:"",extensions:"",mimeTypes:"",maxSizeMB:5,isActive:!0}),{data:l,isLoading:u}=Ve({queryKey:["attachment-types"],queryFn:async()=>{const{data:C}=await xe.get("/attachments/types");return C}}),d=ot({mutationFn:async C=>{i?await xe.put(`/attachments/types/${i.id}`,C):await xe.post("/attachments/types",C)},onSuccess:()=>{t.invalidateQueries({queryKey:["attachment-types"]}),Ki.success(i?"Type updated":"Type created"),x()},onError:()=>{Ki.error("Failed to save attachment type")}}),f=ot({mutationFn:async C=>{await xe.delete(`/attachments/types/${C}`)},onSuccess:()=>{t.invalidateQueries({queryKey:["attachment-types"]}),Ki.success("Type deleted")},onError:()=>{Ki.error("Cannot delete type with existing attachments")}}),p=C=>{C?(a(C),o({name:C.name,extensions:C.extensions.join(", "),mimeTypes:C.mimeTypes.join(", "),maxSizeMB:C.maxSizeMB,isActive:C.isActive})):(a(null),o({name:"",extensions:"",mimeTypes:"",maxSizeMB:5,isActive:!0})),n(!0)},x=()=>{n(!1),a(null)},v=C=>{C.preventDefault();const A={name:s.name.trim(),extensions:s.extensions.split(",").map(T=>T.trim().toLowerCase().replace(/^\./,"")).filter(Boolean),mimeTypes:s.mimeTypes.split(",").map(T=>T.trim()).filter(Boolean),maxSizeMB:Number(s.maxSizeMB),isActive:s.isActive};d.mutate(A)},w=[{label:"PDF Documents",value:"pdf",mime:"application/pdf"},{label:"Images (JPG)",value:"jpg, jpeg",mime:"image/jpeg"},{label:"Images (PNG)",value:"png",mime:"image/png"},{label:"Word Documents",value:"doc, docx",mime:"application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document"},{label:"Excel Files",value:"xls, xlsx",mime:"application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},{label:"Text Files",value:"txt",mime:"text/plain"}];return e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:"Attachment Types"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.25rem"},children:"Configure allowed file types and extensions for attachments"})]}),e.jsxs("button",{onClick:()=>p(),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem",background:"var(--primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:500},children:[e.jsx(cn,{size:18}),"Add Type"]})]}),e.jsx("div",{style:{background:"var(--bg-primary)",borderRadius:"12px",border:"1px solid var(--border)",overflow:"hidden"},children:u?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"Loading..."}):l?.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center"},children:[e.jsx(KY,{size:48,style:{color:"var(--text-muted)",opacity:.5,marginBottom:"1rem"}}),e.jsx("h3",{style:{margin:"0 0 0.5rem"},children:"No attachment types defined"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"All file types are currently allowed. Add types to restrict uploads."}),e.jsx("button",{onClick:()=>p(),style:{padding:"0.5rem 1rem",background:"var(--primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Add First Type"})]}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[e.jsx("th",{style:{padding:"0.875rem 1rem",textAlign:"left",fontWeight:600},children:"Name"}),e.jsx("th",{style:{padding:"0.875rem 1rem",textAlign:"left",fontWeight:600},children:"Extensions"}),e.jsx("th",{style:{padding:"0.875rem 1rem",textAlign:"left",fontWeight:600},children:"Max Size"}),e.jsx("th",{style:{padding:"0.875rem 1rem",textAlign:"center",fontWeight:600},children:"Status"}),e.jsx("th",{style:{padding:"0.875rem 1rem",textAlign:"right",fontWeight:600},children:"Actions"})]})}),e.jsx("tbody",{children:l?.map(C=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"0.875rem 1rem",fontWeight:500},children:C.name}),e.jsx("td",{style:{padding:"0.875rem 1rem"},children:e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem"},children:C.extensions.map(A=>e.jsxs("span",{style:{padding:"0.125rem 0.5rem",background:"var(--primary)",color:"white",borderRadius:"4px",fontSize:"0.75rem",fontFamily:"monospace"},children:[".",A]},A))})}),e.jsxs("td",{style:{padding:"0.875rem 1rem"},children:[C.maxSizeMB," MB"]}),e.jsx("td",{style:{padding:"0.875rem 1rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500,background:C.isActive?"rgba(34, 197, 94, 0.1)":"rgba(156, 163, 175, 0.1)",color:C.isActive?"#22c55e":"#9ca3af"},children:C.isActive?"Active":"Inactive"})}),e.jsx("td",{style:{padding:"0.875rem 1rem",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>p(C),style:{padding:"0.375rem",background:"none",border:"1px solid var(--border)",borderRadius:"6px",cursor:"pointer"},children:e.jsx(ma,{size:16})}),e.jsx("button",{onClick:()=>{confirm("Delete this attachment type?")&&f.mutate(C.id)},style:{padding:"0.375rem",background:"none",border:"1px solid #ef4444",borderRadius:"6px",cursor:"pointer",color:"#ef4444"},children:e.jsx(Gi,{size:16})})]})})]},C.id))})]})}),e.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"rgba(59, 130, 246, 0.05)",borderRadius:"8px",border:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.875rem"},children:"How it works"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",color:"var(--text-muted)"},children:"When no types are defined, all file types up to 5MB are allowed. Once you add types, only files matching the defined extensions will be accepted. The maximum file size limit of 5MB applies globally."})]}),r&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:"12px",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0},children:[i?"Edit":"Add"," Attachment Type"]}),e.jsx("button",{onClick:x,style:{background:"none",border:"none",cursor:"pointer"},children:e.jsx(Dr,{size:20})})]}),e.jsxs("form",{onSubmit:v,style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.375rem",fontWeight:500,fontSize:"0.875rem"},children:"Type Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:C=>o({...s,name:C.target.value}),placeholder:"e.g., Documents, Images, Certificates",required:!0,style:{width:"100%",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"0.875rem"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.375rem",fontWeight:500,fontSize:"0.875rem"},children:"Allowed Extensions"}),e.jsx("input",{type:"text",value:s.extensions,onChange:C=>o({...s,extensions:C.target.value}),placeholder:"pdf, doc, docx, jpg, png",style:{width:"100%",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"0.875rem"}}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Comma-separated list of extensions (without dots)"})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,fontSize:"0.875rem"},children:"Quick Add"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.375rem"},children:w.map(C=>e.jsxs("button",{type:"button",onClick:()=>{const A=s.extensions.split(",").map(U=>U.trim()).filter(Boolean),T=C.value.split(",").map(U=>U.trim()),O=[...new Set([...A,...T])],D=s.mimeTypes.split(",").map(U=>U.trim()).filter(Boolean),M=C.mime.split(",").map(U=>U.trim()),Q=[...new Set([...D,...M])];o({...s,extensions:O.join(", "),mimeTypes:Q.join(", ")})},style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"4px",cursor:"pointer"},children:["+ ",C.label]},C.label))})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.375rem",fontWeight:500,fontSize:"0.875rem"},children:"MIME Types (optional)"}),e.jsx("input",{type:"text",value:s.mimeTypes,onChange:C=>o({...s,mimeTypes:C.target.value}),placeholder:"application/pdf, image/jpeg",style:{width:"100%",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"monospace"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.375rem",fontWeight:500,fontSize:"0.875rem"},children:"Max Size (MB)"}),e.jsx("input",{type:"number",value:s.maxSizeMB,onChange:C=>o({...s,maxSizeMB:Number(C.target.value)}),min:.1,max:5,step:.5,style:{width:"100%",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.375rem",fontWeight:500,fontSize:"0.875rem"},children:"Status"}),e.jsxs("select",{value:s.isActive?"active":"inactive",onChange:C=>o({...s,isActive:C.target.value==="active"}),style:{width:"100%",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"6px",fontSize:"0.875rem"},children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",paddingTop:"0.5rem"},children:[e.jsx("button",{type:"button",onClick:x,style:{padding:"0.625rem 1rem",background:"none",border:"1px solid var(--border)",borderRadius:"6px",cursor:"pointer"},children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:d.isPending,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.625rem 1rem",background:"var(--primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:[e.jsx(cc,{size:16}),d.isPending?"Saving...":"Save"]})]})]})]})})]})}function DNe(){const t=gn(),r=pr(),[n,i]=k.useState(!1),[a,s]=k.useState(null),[o,l]=k.useState({code:"",name:"",nativeName:"",direction:"ltr",isActive:!0,isDefault:!1,sortOrder:0}),{data:u=[],isLoading:d}=Ve({queryKey:["languages"],queryFn:async()=>{const{data:M}=await xe.get("/localization/languages");return M}}),f=ot({mutationFn:async M=>{const{data:Q}=await xe.post("/localization/languages",M);return Q},onSuccess:()=>{r.invalidateQueries({queryKey:["languages"]}),t.success("Language Created","Language has been added successfully"),C()},onError:M=>{t.error("Error",M.response?.data?.error||"Failed to create language")}}),p=ot({mutationFn:async({id:M,data:Q})=>{const{data:U}=await xe.put(`/localization/languages/${M}`,Q);return U},onSuccess:()=>{r.invalidateQueries({queryKey:["languages"]}),t.success("Language Updated","Language has been updated successfully"),C()},onError:M=>{t.error("Error",M.response?.data?.error||"Failed to update language")}}),x=ot({mutationFn:async M=>{await xe.delete(`/localization/languages/${M}`)},onSuccess:()=>{r.invalidateQueries({queryKey:["languages"]}),t.success("Language Deleted","Language has been removed")},onError:M=>{t.error("Error",M.response?.data?.error||"Failed to delete language")}}),v=ot({mutationFn:async()=>{const{data:M}=await xe.post("/localization/seed-languages");return M},onSuccess:()=>{r.invalidateQueries({queryKey:["languages"]}),t.success("Languages Seeded","Default languages have been added")},onError:M=>{t.error("Error",M.response?.data?.error||"Failed to seed languages")}}),w=M=>{M?(s(M),l({code:M.code,name:M.name,nativeName:M.nativeName||"",direction:M.direction,isActive:M.isActive,isDefault:M.isDefault,sortOrder:M.sortOrder})):(s(null),l({code:"",name:"",nativeName:"",direction:"ltr",isActive:!0,isDefault:!1,sortOrder:u.length})),i(!0)},C=()=>{i(!1),s(null)},A=M=>{M.preventDefault(),a?p.mutate({id:a.id,data:o}):f.mutate(o)},T=M=>{if(M.isDefault){t.error("Cannot Delete","Cannot delete the default language");return}confirm(`Are you sure you want to delete ${M.name}?`)&&x.mutate(M.id)},O=M=>{p.mutate({id:M.id,data:{...M,isDefault:!0}})},D=M=>{p.mutate({id:M.id,data:{...M,isActive:!M.isActive}})};return e.jsxs("div",{children:[e.jsx(Ad,{title:"Languages",subtitle:"Manage supported languages for the application",actions:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.length===0&&e.jsxs("button",{className:"btn btn-secondary",onClick:()=>v.mutate(),children:[e.jsx(py,{size:16}),"Seed Default Languages"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>w(),children:[e.jsx(cn,{size:16}),"Add Language"]})]})}),e.jsx("div",{className:"card",children:d?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:"Loading languages..."}):u.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center"},children:[e.jsx(sm,{size:48,style:{color:"var(--text-muted)",marginBottom:"1rem"}}),e.jsx("h3",{style:{marginBottom:"0.5rem"},children:"No Languages Configured"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:'Click "Seed Default Languages" to add English and Arabic, or add languages manually.'})]}):e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Native Name"}),e.jsx("th",{children:"Direction"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Default"}),e.jsx("th",{children:"Order"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:u.map(M=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{style:{background:"var(--bg-secondary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontWeight:600},children:M.code.toUpperCase()})}),e.jsx("td",{style:{fontWeight:500},children:M.name}),e.jsx("td",{children:M.nativeName||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${M.direction==="rtl"?"warning":"default"}`,children:M.direction.toUpperCase()})}),e.jsx("td",{children:e.jsx("button",{className:`badge badge-${M.isActive?"success":"danger"}`,onClick:()=>D(M),style:{cursor:"pointer",border:"none"},children:M.isActive?"Active":"Inactive"})}),e.jsx("td",{children:M.isDefault?e.jsx("span",{className:"badge badge-primary",children:"Default"}):e.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},onClick:()=>O(M),children:"Set Default"})}),e.jsx("td",{children:M.sortOrder}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary",style:{padding:"0.375rem"},onClick:()=>w(M),children:e.jsx(ma,{size:14})}),e.jsx("button",{className:"btn btn-danger",style:{padding:"0.375rem"},onClick:()=>T(M),disabled:M.isDefault,children:e.jsx(Gi,{size:14})})]})})]},M.id))})]})}),n&&e.jsx("div",{className:"modal-overlay",onClick:C,children:e.jsxs("div",{className:"modal",onClick:M=>M.stopPropagation(),style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:a?"Edit Language":"Add Language"}),e.jsx("button",{className:"modal-close",onClick:C,children:e.jsx(Dr,{size:20})})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Language Code *"}),e.jsx("input",{type:"text",className:"form-input",value:o.code,onChange:M=>l({...o,code:M.target.value}),placeholder:"e.g., en, ar, fr",maxLength:5,required:!0,disabled:!!a})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Direction *"}),e.jsxs("select",{className:"form-select",value:o.direction,onChange:M=>l({...o,direction:M.target.value}),required:!0,children:[e.jsx("option",{value:"ltr",children:"Left to Right (LTR)"}),e.jsx("option",{value:"rtl",children:"Right to Left (RTL)"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Language Name *"}),e.jsx("input",{type:"text",className:"form-input",value:o.name,onChange:M=>l({...o,name:M.target.value}),placeholder:"e.g., English",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Native Name"}),e.jsx("input",{type:"text",className:"form-input",value:o.nativeName,onChange:M=>l({...o,nativeName:M.target.value}),placeholder:"e.g., "})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sort Order"}),e.jsx("input",{type:"number",className:"form-input",value:o.sortOrder,onChange:M=>l({...o,sortOrder:parseInt(M.target.value)||0})})]}),e.jsx("div",{className:"form-group",style:{display:"flex",flexDirection:"column",justifyContent:"flex-end"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:o.isActive,onChange:M=>l({...o,isActive:M.target.checked})}),"Active"]})})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:o.isDefault,onChange:M=>l({...o,isDefault:M.target.checked})}),"Set as Default Language"]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:C,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[a?"Update":"Create"," Language"]})]})]})]})})]})}const fM=[{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"AED",name:"UAE Dirham"},{code:"KWD",name:"Kuwaiti Dinar"},{code:"BHD",name:"Bahraini Dinar"},{code:"QAR",name:"Qatari Riyal"},{code:"OMR",name:"Omani Rial"},{code:"EGP",name:"Egyptian Pound"},{code:"JOD",name:"Jordanian Dinar"}];function PNe(){const t=gn(),r=pr(),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(null),[u,d]=k.useState(""),[f,p]=k.useState(1),[x,v]=k.useState("exchangerate-api"),[w,C]=k.useState(""),[A,T]=k.useState({date:Ze(new Date,"yyyy-MM-dd"),fromCurrency:"USD",rate:3.75,source:"MANUAL"}),{data:O,isLoading:D}=Ve({queryKey:["exchange-rates",u,f],queryFn:async()=>{const le={page:f,pageSize:25};u&&(le.fromCurrency=u);const{data:K}=await xe.get("/localization/exchange-rates",{params:le});return K}}),{data:M=[]}=Ve({queryKey:["latest-exchange-rates"],queryFn:async()=>{const{data:le}=await xe.get("/localization/exchange-rates/latest");return le}}),{data:Q=[]}=Ve({queryKey:["rate-providers"],queryFn:async()=>{const{data:le}=await xe.get("/localization/exchange-rates/providers");return le}}),U=ot({mutationFn:async le=>{const{data:K}=await xe.post("/localization/exchange-rates/fetch-online",le);return K},onSuccess:le=>{r.invalidateQueries({queryKey:["exchange-rates"]}),r.invalidateQueries({queryKey:["latest-exchange-rates"]}),t.success("Rates Updated",le.message),s(!1),C("")},onError:le=>{t.error("Error",le.response?.data?.error||"Failed to fetch rates")}}),$=ot({mutationFn:async le=>{const{data:K}=await xe.post("/localization/exchange-rates",le);return K},onSuccess:()=>{r.invalidateQueries({queryKey:["exchange-rates"]}),r.invalidateQueries({queryKey:["latest-exchange-rates"]}),t.success("Rate Saved","Exchange rate has been saved"),Y()},onError:le=>{t.error("Error",le.response?.data?.error||"Failed to save rate")}}),ee=ot({mutationFn:async le=>{await xe.delete(`/localization/exchange-rates/${le}`)},onSuccess:()=>{r.invalidateQueries({queryKey:["exchange-rates"]}),r.invalidateQueries({queryKey:["latest-exchange-rates"]}),t.success("Rate Deleted","Exchange rate has been removed")},onError:le=>{t.error("Error",le.response?.data?.error||"Failed to delete rate")}}),F=le=>{le?(l(le),T({date:le.date.split("T")[0],fromCurrency:le.fromCurrency,rate:le.rate,source:le.source})):(l(null),T({date:Ze(new Date,"yyyy-MM-dd"),fromCurrency:"USD",rate:3.75,source:"MANUAL"})),i(!0)},Y=()=>{i(!1),l(null)},J=le=>{le.preventDefault(),$.mutate(A)},Z=le=>{confirm(`Delete rate for ${le.fromCurrency} on ${Ze(new Date(le.date),"MMM dd, yyyy")}?`)&&ee.mutate(le.id)},re=O?.data||[],de=O?.total||0;return e.jsxs("div",{children:[e.jsx(Ad,{title:"Exchange Rates",subtitle:"Manage currency exchange rates to SAR (base currency)",actions:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:[e.jsx(f8,{size:16}),"Fetch from Provider"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>F(),children:[e.jsx(cn,{size:16}),"Add Rate"]})]})}),M.length>0&&e.jsx("div",{className:"grid grid-4",style:{marginBottom:"1.5rem"},children:M.slice(0,4).map(le=>e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(of,{size:20,style:{color:"var(--primary)"}}),e.jsxs("span",{className:"stat-label",children:[le.fromCurrency,"/SAR"]})]}),e.jsx("div",{className:"stat-value",children:le.rate.toFixed(4)}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Ze(new Date(le.date),"MMM dd, yyyy")})]},le.id))}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("select",{className:"form-select",value:u,onChange:le=>{d(le.target.value),p(1)},style:{width:"auto"},children:[e.jsx("option",{value:"",children:"All Currencies"}),fM.map(le=>e.jsxs("option",{value:le.code,children:[le.code," - ",le.name]},le.code))]}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:[de," rates found"]})]}),D?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:"Loading rates..."}):re.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center"},children:[e.jsx(r0,{size:48,style:{color:"var(--text-muted)",marginBottom:"1rem"}}),e.jsx("h3",{style:{marginBottom:"0.5rem"},children:"No Exchange Rates"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"Add exchange rates to enable multi-currency display"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"From Currency"}),e.jsx("th",{children:"To Currency"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:re.map(le=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx($n,{size:14,style:{color:"var(--text-muted)"}}),Ze(new Date(le.date),"MMM dd, yyyy")]})}),e.jsx("td",{children:e.jsx("code",{style:{background:"var(--bg-secondary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontWeight:600},children:le.fromCurrency})}),e.jsx("td",{children:e.jsx("code",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontWeight:600},children:"SAR"})}),e.jsx("td",{style:{fontWeight:600,fontFamily:"monospace"},children:le.rate.toFixed(4)}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${le.source==="API"?"info":"default"}`,children:le.source})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-secondary",style:{padding:"0.375rem"},onClick:()=>F(le),children:e.jsx(ma,{size:14})}),e.jsx("button",{className:"btn btn-danger",style:{padding:"0.375rem"},onClick:()=>Z(le),children:e.jsx(Gi,{size:14})})]})})]},le.id))})]}),e.jsx(a0,{page:f,pageSize:25,totalCount:de,onPageChange:p})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:Y,children:e.jsxs("div",{className:"modal",onClick:le=>le.stopPropagation(),style:{maxWidth:"450px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:o?"Edit Exchange Rate":"Add Exchange Rate"}),e.jsx("button",{className:"modal-close",onClick:Y,children:e.jsx(Dr,{size:20})})]}),e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Date *"}),e.jsx("input",{type:"date",className:"form-input",value:A.date,onChange:le=>T({...A,date:le.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"From Currency *"}),e.jsx("select",{className:"form-select",value:A.fromCurrency,onChange:le=>T({...A,fromCurrency:le.target.value}),required:!0,children:fM.map(le=>e.jsxs("option",{value:le.code,children:[le.code," - ",le.name]},le.code))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"To Currency"}),e.jsx("input",{type:"text",className:"form-input",value:"SAR (Saudi Riyal)",disabled:!0,style:{background:"var(--bg-secondary)"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Exchange Rate *"}),e.jsx("input",{type:"number",className:"form-input",value:A.rate,onChange:le=>T({...A,rate:parseFloat(le.target.value)||0}),step:"0.0001",min:"0.0001",placeholder:"e.g., 3.75",required:!0}),e.jsxs("small",{style:{color:"var(--text-muted)"},children:["1 ",A.fromCurrency," = ",A.rate," SAR"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Source"}),e.jsxs("select",{className:"form-select",value:A.source,onChange:le=>T({...A,source:le.target.value}),children:[e.jsx("option",{value:"MANUAL",children:"Manual Entry"}),e.jsx("option",{value:"API",children:"API Import"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Y,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[o?"Update":"Add"," Rate"]})]})]})]})}),a&&e.jsx("div",{className:"modal-overlay",onClick:()=>s(!1),children:e.jsxs("div",{className:"modal",onClick:le=>le.stopPropagation(),style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Fetch Rates from Provider"}),e.jsx("button",{className:"modal-close",onClick:()=>s(!1),children:e.jsx(Dr,{size:20})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{style:{marginBottom:"1rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Fetch today's exchange rates from an online provider. Rates will be saved to SAR (Saudi Riyal)."}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Provider"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Q.map(le=>e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",padding:"0.75rem",border:"1px solid var(--border)",borderRadius:"8px",cursor:"pointer",background:x===le.id?"var(--bg-secondary)":"transparent"},children:[e.jsx("input",{type:"radio",name:"provider",value:le.id,checked:x===le.id,onChange:K=>v(K.target.value),style:{marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:le.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[le.description,le.requiresKey&&e.jsx("span",{style:{color:"var(--warning)",marginLeft:"0.5rem"},children:"(API key required)"})]})]})]},le.id))})]}),Q.find(le=>le.id===x)?.requiresKey&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"API Key *"}),e.jsx("input",{type:"password",className:"form-input",value:w,onChange:le=>C(le.target.value),placeholder:"Enter your API key"}),e.jsx("small",{style:{color:"var(--text-muted)",marginTop:"0.25rem",display:"block"},children:"Get a free API key from the provider's website"})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"8px",fontSize:"0.8125rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Currencies to fetch:"})," USD, EUR, GBP, AED, KWD, BHD, QAR, OMR, EGP, JOD"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{if(Q.find(K=>K.id===x)?.requiresKey&&!w){t.error("API Key Required","Please enter your API key");return}U.mutate({provider:x,apiKey:w||void 0})},disabled:U.isPending,children:U.isPending?e.jsxs(e.Fragment,{children:[e.jsx(cu,{size:16,className:"spin"}),"Fetching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f8,{size:16}),"Fetch Rates"]})})]})]})})]})}const RNe=["Asia/Riyadh","Asia/Dubai","Asia/Kuwait","Asia/Bahrain","Asia/Qatar","Africa/Cairo","Europe/London","Europe/Paris","America/New_York","America/Los_Angeles","UTC"],MNe=[{value:"yyyy-MM-dd",label:"2024-01-15"},{value:"dd/MM/yyyy",label:"15/01/2024"},{value:"MM/dd/yyyy",label:"01/15/2024"},{value:"dd-MM-yyyy",label:"15-01-2024"},{value:"dd MMM yyyy",label:"15 Jan 2024"}],LNe=[{value:"HH:mm",label:"14:30 (24-hour)"},{value:"HH:mm:ss",label:"14:30:00 (24-hour with seconds)"},{value:"hh:mm a",label:"02:30 PM (12-hour)"},{value:"hh:mm:ss a",label:"02:30:00 PM (12-hour with seconds)"}];function zNe(){const t=gn(),r=pr(),[n,i]=k.useState({}),{data:a,isLoading:s}=Ve({queryKey:["localization-settings"],queryFn:async()=>{const{data:f}=await xe.get("/localization/settings");return f}}),{data:o=[]}=Ve({queryKey:["languages-active"],queryFn:async()=>{const{data:f}=await xe.get("/localization/languages",{params:{activeOnly:"true"}});return f}});k.useEffect(()=>{a&&i(a)},[a]);const l=ot({mutationFn:async f=>{const{data:p}=await xe.put("/localization/settings",f);return p},onSuccess:()=>{r.invalidateQueries({queryKey:["localization-settings"]}),t.success("Settings Saved","Localization settings have been updated")},onError:f=>{t.error("Error",f.response?.data?.error||"Failed to save settings")}}),u=f=>{f.preventDefault(),l.mutate(n)},d=(f,p)=>{i(x=>({...x,[f]:p}))};return s?e.jsxs("div",{children:[e.jsx(Ad,{title:"Localization Settings",subtitle:"Configure system-wide localization preferences"}),e.jsx("div",{className:"card",style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:"Loading settings..."})]}):e.jsxs("div",{children:[e.jsx(Ad,{title:"Localization Settings",subtitle:"Configure system-wide language, timezone, and currency preferences"}),e.jsxs("form",{onSubmit:u,children:[e.jsxs("div",{className:"grid grid-2",style:{gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sm,{size:20,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Language Settings"})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Default Language"}),e.jsxs("select",{className:"form-select",value:n.defaultLanguageCode||"en",onChange:f=>d("defaultLanguageCode",f.target.value),children:[o.map(f=>e.jsxs("option",{value:f.code,children:[f.name," (",f.code.toUpperCase(),")"]},f.code)),o.length===0&&e.jsx("option",{value:"en",children:"English (en)"})]}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"Used when user has no preference set"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.enableUserLanguageOverride??!0,onChange:f=>d("enableUserLanguageOverride",f.target.checked)}),"Allow users to override language"]}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"When disabled, all users will see the default language"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qt,{size:20,style:{color:"var(--warning)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Timezone Settings"})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Default Timezone"}),e.jsx("select",{className:"form-select",value:n.defaultTimezone||"Asia/Riyadh",onChange:f=>d("defaultTimezone",f.target.value),children:RNe.map(f=>e.jsx("option",{value:f,children:f},f))}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"All timestamps displayed using this timezone by default"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.enableUserTimezoneOverride??!0,onChange:f=>d("enableUserTimezoneOverride",f.target.checked)}),"Allow users to override timezone"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(of,{size:20,style:{color:"var(--success)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Currency Settings"})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Base Currency"}),e.jsx("input",{type:"text",className:"form-input",value:"SAR (Saudi Riyal)",disabled:!0,style:{background:"var(--bg-secondary)"}}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"All accounting is stored in SAR"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.enableMultiCurrencyDisplay??!0,onChange:f=>d("enableMultiCurrencyDisplay",f.target.checked)}),"Enable multi-currency display"]}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"Allow displaying amounts in other currencies using exchange rates"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.enableUserCurrencyOverride??!0,onChange:f=>d("enableUserCurrencyOverride",f.target.checked)}),"Allow users to override display currency"]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sh,{size:20,style:{color:"var(--info)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Format Settings"})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Date Format"}),e.jsx("select",{className:"form-select",value:n.dateFormat||"yyyy-MM-dd",onChange:f=>d("dateFormat",f.target.value),children:MNe.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Time Format"}),e.jsx("select",{className:"form-select",value:n.timeFormat||"HH:mm",onChange:f=>d("timeFormat",f.target.value),children:LNe.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Number Format Locale"}),e.jsxs("select",{className:"form-select",value:n.numberFormat||"en-US",onChange:f=>d("numberFormat",f.target.value),children:[e.jsx("option",{value:"en-US",children:"English (US) - 1,234.56"}),e.jsx("option",{value:"en-GB",children:"English (UK) - 1,234.56"}),e.jsx("option",{value:"ar-SA",children:"Arabic (SA) - "}),e.jsx("option",{value:"de-DE",children:"German - 1.234,56"}),e.jsx("option",{value:"fr-FR",children:"French - 1 234,56"})]})]})]})]})]}),e.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end"},children:e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:l.isPending,children:[e.jsx(cc,{size:16}),"Save Settings"]})})]})]})}const mM=[{value:"SYSTEM",label:"System UI",icon:sm,description:"Navigation, buttons, labels"},{value:"PRODUCT",label:"Products",icon:rh,description:"Product names and descriptions"},{value:"CUSTOMER",label:"Customers",icon:Ts,description:"Customer information"},{value:"MATERIAL",label:"Materials",icon:r2,description:"Material names"},{value:"SUPPLIER",label:"Suppliers",icon:dc,description:"Supplier details"},{value:"CATEGORY",label:"Categories",icon:nz,description:"Category labels"},{value:"CITY",label:"Cities",icon:_a,description:"City names"},{value:"REGION",label:"Regions",icon:_a,description:"Region names"},{value:"COUNTRY",label:"Countries",icon:_a,description:"Country names"}],vg=[{prefix:"nav.",label:"Navigation",color:"#3b82f6"},{prefix:"action.",label:"Actions",color:"#10b981"},{prefix:"label.",label:"Labels",color:"#8b5cf6"},{prefix:"status.",label:"Status",color:"#f59e0b"},{prefix:"message.",label:"Messages",color:"#06b6d4"},{prefix:"page.",label:"Pages",color:"#ec4899"}];function BNe(){const t=gn(),r=pr(),[n,i]=k.useState("SYSTEM"),[a,s]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(1),[f,p]=k.useState(null),[x,v]=k.useState(""),[w,C]=k.useState(null),[A,T]=k.useState(new Set(["nav.","action.","label."])),{data:O=[]}=Ve({queryKey:["languages-active"],queryFn:async()=>{const{data:K}=await xe.get("/localization/languages",{params:{activeOnly:"true"}});return K}}),{data:D,isLoading:M,refetch:Q}=Ve({queryKey:["translations",n,"",a,o,u],queryFn:async()=>{const K={page:u,pageSize:100};n&&(K.entityType=n),a&&(K.langCode=a),o&&(K.search=o);const{data:ue}=await xe.get("/localization/translations",{params:K});return ue}}),U=ot({mutationFn:async({entityType:K,entityId:ue,fieldKey:ce,langCode:ye,value:Se})=>{const{data:V}=await xe.post("/localization/translations",{entityType:K,entityId:ue,fieldKey:ce,langCode:ye,value:Se});return V},onSuccess:()=>{r.invalidateQueries({queryKey:["translations"]}),t.success("Saved","Translation updated successfully"),p(null)},onError:K=>{t.error("Error",K.response?.data?.error||"Failed to save translation")}}),$=ot({mutationFn:async()=>{const{data:K}=await xe.post("/localization/seed-system-translations");return K},onSuccess:K=>{r.invalidateQueries({queryKey:["translations"]}),t.success("Translations Added",`Created ${K.created} new translations`)},onError:K=>{t.error("Failed",K.response?.data?.error||"Could not add translations")}}),ee=K=>{U.mutate({entityType:K.entityType,entityId:K.entityId,fieldKey:K.fieldKey,langCode:K.langCode,value:x})},F=async()=>{try{const K=await xe.get("/localization/translations/export",{params:{entityType:n},responseType:"blob"}),ue=URL.createObjectURL(K.data),ce=document.createElement("a");ce.href=ue,ce.download=`translations-${n.toLowerCase()}.json`,ce.click(),URL.revokeObjectURL(ue),t.success("Exported","Translations file downloaded")}catch(K){t.error("Export Failed",K.response?.data?.error||"Could not export translations")}},Y=async K=>{const ue=K.target.files?.[0];if(ue){try{const ce=await ue.text(),ye=JSON.parse(ce);await xe.post("/localization/translations/import",{translations:ye}),r.invalidateQueries({queryKey:["translations"]}),t.success("Imported","Translations uploaded successfully")}catch(ce){t.error("Import Failed",ce.response?.data?.error||"Could not import translations")}K.target.value=""}},J=D?.data||[],Z=D?.total||0,re=k.useMemo(()=>{if(n!=="SYSTEM")return null;const K={};return J.forEach(ue=>{const ye=vg.find(Se=>ue.fieldKey.startsWith(Se.prefix))?.prefix||"other";K[ye]||(K[ye]=[]),K[ye].push(ue)}),K},[J,n]),de=K=>{T(ue=>{const ce=new Set(ue);return ce.has(K)?ce.delete(K):ce.add(K),ce})};mM.find(K=>K.value===n);const le=(K,ue=!1)=>{const ce=f===K.id,ye=vg.find(V=>K.fieldKey.startsWith(V.prefix)),Se=K.fieldKey.replace(ye?.prefix||"","");return e.jsxs("div",{style:{padding:"1rem",background:ce?"var(--bg-secondary)":"var(--bg-primary)",borderRadius:"8px",border:"1px solid var(--border)",transition:"all 0.2s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[ue&&ye&&e.jsx("span",{style:{fontSize:"0.6875rem",padding:"0.125rem 0.5rem",borderRadius:"4px",background:`${ye.color}15`,color:ye.color,fontWeight:600,textTransform:"uppercase"},children:ye.label}),e.jsx("span",{style:{fontWeight:600,fontSize:"0.875rem",color:"var(--text-primary)",fontFamily:"var(--font-mono, monospace)"},children:Se})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem",borderRadius:"4px",background:K.langCode==="ar"?"#10b98115":"#3b82f615",color:K.langCode==="ar"?"#10b981":"#3b82f6",fontWeight:600},children:K.langCode==="ar"?"":"English"}),ce?e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsxs("button",{className:"btn btn-primary",style:{padding:"0.375rem 0.625rem",fontSize:"0.75rem"},onClick:()=>ee(K),disabled:U.isPending,children:[e.jsx(cc,{size:14}),"Save"]}),e.jsx("button",{className:"btn btn-secondary",style:{padding:"0.375rem 0.625rem",fontSize:"0.75rem"},onClick:()=>p(null),children:e.jsx(Dr,{size:14})})]}):e.jsxs("button",{className:"btn btn-secondary",style:{padding:"0.375rem 0.625rem",fontSize:"0.75rem"},onClick:()=>{p(K.id),v(K.value)},children:[e.jsx(ma,{size:14}),"Edit"]})]})]}),ce?e.jsx("textarea",{className:"form-input",value:x,onChange:V=>v(V.target.value),autoFocus:!0,rows:2,style:{width:"100%",resize:"vertical",direction:K.langCode==="ar"?"rtl":"ltr",fontFamily:K.langCode==="ar"?"inherit":"var(--font-mono, monospace)"}}):e.jsx("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"6px",fontSize:"0.9375rem",lineHeight:1.5,direction:K.langCode==="ar"?"rtl":"ltr",color:K.value?"var(--text-primary)":"var(--text-muted)",fontStyle:K.value?"normal":"italic"},children:K.value||"No translation yet"})]},K.id)};return e.jsxs("div",{children:[e.jsx(Ad,{title:"Translations",subtitle:"Manage text content in multiple languages",actions:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>$.mutate(),disabled:$.isPending,title:"Add default system translations for common UI elements",children:[e.jsx(m8,{size:16}),$.isPending?"Adding...":"Add Default Translations"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:F,title:"Download translations as file",children:[e.jsx(Jp,{size:16}),"Export"]}),e.jsxs("label",{className:"btn btn-secondary",style:{cursor:"pointer"},title:"Upload translations file",children:[e.jsx(om,{size:16}),"Import",e.jsx("input",{type:"file",accept:".json",onChange:Y,style:{display:"none"}})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Content Type"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem"},children:mM.map(K=>{const ue=K.icon,ce=n===K.value;return e.jsxs("button",{onClick:()=>{i(K.value),d(1),C(null)},style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",background:ce?"var(--primary)":"var(--bg-primary)",color:ce?"white":"var(--text-primary)",border:`1px solid ${ce?"var(--primary)":"var(--border)"}`,borderRadius:"8px",cursor:"pointer",textAlign:"left",transition:"all 0.2s"},children:[e.jsx(ue,{size:18,style:{opacity:.8}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.875rem"},children:K.label}),e.jsx("div",{style:{fontSize:"0.75rem",opacity:ce?.85:.6,marginTop:"0.125rem"},children:K.description})]})]},K.value)})}),n==="SYSTEM"&&re&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"0.6875rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:"1.5rem",marginBottom:"0.75rem"},children:"Categories"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:vg.map(K=>{const ue=re[K.prefix]?.length||0,ce=w===K.prefix;return e.jsxs("button",{onClick:()=>C(ce?null:K.prefix),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.625rem 0.875rem",background:ce?`${K.color}10`:"transparent",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"2px",background:K.color}}),e.jsx("span",{style:{fontSize:"0.8125rem",fontWeight:ce?600:400,color:ce?K.color:"var(--text-secondary)"},children:K.label})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",background:"var(--bg-secondary)",padding:"0.125rem 0.5rem",borderRadius:"10px"},children:ue})]},K.prefix)})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"card",style:{marginBottom:"1rem",overflow:"hidden"},children:e.jsxs("div",{style:{padding:"1rem 1.25rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search translations...",value:o,onChange:K=>{l(K.target.value),d(1)},style:{paddingLeft:"2.25rem",width:"280px"}})]}),e.jsxs("select",{className:"form-select",value:a,onChange:K=>{s(K.target.value),d(1)},style:{width:"auto"},children:[e.jsx("option",{value:"",children:"All Languages"}),O.map(K=>e.jsx("option",{value:K.code,children:K.name},K.code))]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.8125rem",display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(py,{size:14}),Z," translations"]})})]})}),M?e.jsxs("div",{className:"card",style:{padding:"4rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx("div",{className:"loading-spinner",style:{margin:"0 auto 1rem"}}),"Loading translations..."]}):J.length===0?e.jsxs("div",{className:"card",style:{padding:"4rem",textAlign:"center"},children:[e.jsx(Ir,{size:48,style:{color:"var(--text-muted)",marginBottom:"1rem"}}),e.jsx("h3",{style:{marginBottom:"0.5rem",fontWeight:600},children:"No Translations Found"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",maxWidth:"400px",margin:"0 auto"},children:n==="SYSTEM"?'Click "Add Default Translations" to populate common UI text, or add translations manually.':"Translations will appear here when you add multilingual content to this type of data."}),n==="SYSTEM"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>$.mutate(),disabled:$.isPending,style:{marginTop:"1rem"},children:[e.jsx(m8,{size:16}),"Add Default Translations"]})]}):n==="SYSTEM"&&re?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:(w?[{prefix:w,...vg.find(K=>K.prefix===w)}]:vg).filter(K=>re[K.prefix]?.length>0).map(K=>{const ue=re[K.prefix]||[],ce=A.has(K.prefix);return e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("button",{onClick:()=>de(K.prefix),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 1.25rem",background:"var(--bg-secondary)",border:"none",borderBottom:ce?"1px solid var(--border)":"none",cursor:"pointer",textAlign:"left"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[ce?e.jsx(qo,{size:18}):e.jsx(bo,{size:18}),e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"3px",background:K.color}}),e.jsx("span",{style:{fontWeight:600,fontSize:"0.9375rem"},children:K.label}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",background:"var(--bg-primary)",padding:"0.25rem 0.625rem",borderRadius:"12px"},children:[ue.length," items"]})]})}),ce&&e.jsx("div",{style:{padding:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(400px, 1fr))",gap:"0.75rem"},children:ue.map(ye=>le(ye,!1))})]},K.prefix)})}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(400px, 1fr))",gap:"0.75rem"},children:J.map(K=>le(K,!0))}),Z>0&&e.jsx("div",{style:{marginTop:"1rem",borderRadius:"8px",overflow:"hidden"},children:e.jsx(a0,{page:u,pageSize:100,totalCount:Z,onPageChange:d})})]})]})]})}function FNe(){const t=Gr(),{data:r,isLoading:n,refetch:i}=Ve({queryKey:["zatca-status"],queryFn:async()=>{const{data:s}=await xe.get("/zatca/status");return s}}),a=s=>{switch(s){case"ACCEPTED":case"CLEARED":case"REPORTED":return"success";case"PENDING":return"warning";case"REJECTED":case"FAILED":return"danger";default:return"default"}};return e.jsxs("div",{children:[e.jsx(Ad,{title:"ZATCA Integration",subtitle:"Fatoora e-invoice integration status and management",actions:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>i(),children:[e.jsx(cu,{size:16}),"Refresh"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>t("/admin/zatca/config"),children:[e.jsx(sh,{size:16}),"Configuration"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>t("/admin/zatca/onboarding"),children:[e.jsx(aa,{size:16}),"Onboarding"]})]})}),n?e.jsx("div",{className:"card",style:{padding:"3rem",textAlign:"center"},children:"Loading ZATCA status..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-4",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Mc,{size:20,style:{color:"var(--primary)"}}),e.jsx("span",{className:"stat-label",children:"Total Submissions"})]}),e.jsx("div",{className:"stat-value",children:r?.stats?.total||0})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Ft,{size:20,style:{color:"var(--success)"}}),e.jsx("span",{className:"stat-label",children:"Accepted"})]}),e.jsx("div",{className:"stat-value",style:{color:"var(--success)"},children:r?.stats?.accepted||0})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Qt,{size:20,style:{color:"var(--warning)"}}),e.jsx("span",{className:"stat-label",children:"Pending"})]}),e.jsx("div",{className:"stat-value",style:{color:"var(--warning)"},children:r?.stats?.pending||0})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(ri,{size:20,style:{color:"var(--danger)"}}),e.jsx("span",{className:"stat-label",children:"Rejected/Failed"})]}),e.jsx("div",{className:"stat-value",style:{color:"var(--danger)"},children:(r?.stats?.rejected||0)+(r?.stats?.failed||0)})]})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{margin:0,fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sh,{size:18})," Configuration Status"]})}),e.jsx("div",{style:{padding:"1.25rem"},children:r?.config?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Environment"}),e.jsx("span",{className:`badge badge-${r.config.environment==="PRODUCTION"?"danger":"info"}`,children:r.config.environment})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"ZATCA Posting"}),e.jsx("span",{className:`badge badge-${r.config.enableZatcaPosting?"success":"default"}`,children:r.config.enableZatcaPosting?"Enabled":"Disabled"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Seller Info"}),e.jsx("span",{className:`badge badge-${r.config.hasSellerInfo?"success":"warning"}`,children:r.config.hasSellerInfo?"Configured":"Missing"})]})]}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:[e.jsx(Hr,{size:32,style:{marginBottom:"0.5rem"}}),e.jsx("p",{children:"ZATCA not configured"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>t("/admin/zatca/config"),children:"Configure Now"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{margin:0,fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(aa,{size:18})," Active Credential"]})}),e.jsx("div",{style:{padding:"1.25rem"},children:r?.credential?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Device"}),e.jsx("span",{style:{fontWeight:500},children:r.credential.deviceName})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Status"}),e.jsx("span",{className:"badge badge-success",children:r.credential.status})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Environment"}),e.jsx("span",{className:`badge badge-${r.credential.environment==="PRODUCTION"?"danger":"info"}`,children:r.credential.environment})]})]}):e.jsxs("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:"1rem"},children:[e.jsx(aa,{size:32,style:{marginBottom:"0.5rem"}}),e.jsx("p",{children:"No active credential"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>t("/admin/zatca/onboarding"),children:"Complete Onboarding"})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(gu,{size:18})," Recent Submissions"]}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>t("/admin/zatca/logs"),children:"View All Logs"})]}),r?.recentSubmissions?.length>0?e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Submitted"})]})}),e.jsx("tbody",{children:r.recentSubmissions.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontWeight:600},children:s.invoice?.invoiceNumber||"-"}),e.jsx("td",{children:s.invoice?.customer?.name||"-"}),e.jsx("td",{children:ci(s.invoice?.totalAmount)}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${a(s.status)}`,children:s.status})}),e.jsx("td",{children:s.submittedAt?Ze(new Date(s.submittedAt),"MMM dd, HH:mm"):"-"})]},s.id))})]}):e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No submissions yet"})]})]})]})}function qNe(){const t=Gr(),r=gn(),n=pr(),[i,a]=k.useState({}),{data:s,isLoading:o}=Ve({queryKey:["zatca-config"],queryFn:async()=>{const{data:p}=await xe.get("/zatca/config");return p}});k.useEffect(()=>{s&&a(s)},[s]);const l=ot({mutationFn:async p=>{const{data:x}=await xe.put("/zatca/config",p);return x},onSuccess:()=>{n.invalidateQueries({queryKey:["zatca-config"]}),n.invalidateQueries({queryKey:["zatca-status"]}),r.success("Configuration Saved","ZATCA settings have been updated")},onError:p=>{r.error("Error",p.response?.data?.error||"Failed to save configuration")}}),u=ot({mutationFn:async()=>{const{data:p}=await xe.post("/zatca/test-connection");return p},onSuccess:p=>{r.success("Connection Test Passed",p.message)},onError:p=>{r.error("Connection Test Failed",p.response?.data?.error||"Failed to connect")}}),d=p=>{p.preventDefault(),l.mutate(i)},f=(p,x)=>{a(v=>({...v,[p]:x}))};return o?e.jsxs("div",{children:[e.jsx(Ad,{title:"ZATCA Configuration",subtitle:"Configure e-invoice integration settings"}),e.jsx("div",{className:"card",style:{padding:"3rem",textAlign:"center"},children:"Loading..."})]}):e.jsxs("div",{children:[e.jsx(Ad,{title:"ZATCA Configuration",subtitle:"Configure Fatoora e-invoice integration settings",actions:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>t("/admin/zatca"),children:[e.jsx(sa,{size:16}),"Back"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>u.mutate(),disabled:u.isPending,children:[e.jsx(cu,{size:16}),"Test Connection"]})]})}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"grid grid-2",style:{gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sh,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"General Settings"})]}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Environment"}),e.jsxs("select",{className:"form-select",value:i.environment||"SIMULATION",onChange:p=>f("environment",p.target.value),children:[e.jsx("option",{value:"SIMULATION",children:"Simulation (Testing)"}),e.jsx("option",{value:"PRODUCTION",children:"Production"})]}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"Use Simulation for testing before going live"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:i.enableZatcaPosting||!1,onChange:p=>f("enableZatcaPosting",p.target.checked)}),"Enable ZATCA Posting"]}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"When enabled, issued invoices will be submitted to ZATCA automatically"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Simplified Invoice Mode (B2C)"}),e.jsxs("select",{className:"form-select",value:i.simplifiedMode||"REPORTING",onChange:p=>f("simplifiedMode",p.target.value),children:[e.jsx("option",{value:"REPORTING",children:"Reporting"}),e.jsx("option",{value:"CLEARANCE",children:"Clearance"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Standard Invoice Mode (B2B)"}),e.jsxs("select",{className:"form-select",value:i.standardMode||"CLEARANCE",onChange:p=>f("standardMode",p.target.value),children:[e.jsx("option",{value:"CLEARANCE",children:"Clearance"}),e.jsx("option",{value:"REPORTING",children:"Reporting"})]})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Lp,{size:18,style:{color:"var(--info)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Seller Information"})]}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Seller Name (English)"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerName||"",onChange:p=>f("sellerName",p.target.value),placeholder:"Company name in English"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Seller Name (Arabic)"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerNameAr||"",onChange:p=>f("sellerNameAr",p.target.value),placeholder:"  ",dir:"rtl"})]})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"VAT Number"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerVatNo||"",onChange:p=>f("sellerVatNo",p.target.value),placeholder:"300000000000003",maxLength:15})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"CR Number"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerCrNo||"",onChange:p=>f("sellerCrNo",p.target.value),placeholder:"Commercial Registration"})]})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Street"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerStreet||"",onChange:p=>f("sellerStreet",p.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Building Number"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerBuilding||"",onChange:p=>f("sellerBuilding",p.target.value)})]})]}),e.jsxs("div",{className:"grid grid-3",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"District"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerDistrict||"",onChange:p=>f("sellerDistrict",p.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerCity||"",onChange:p=>f("sellerCity",p.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",className:"form-input",value:i.sellerPostalCode||"",onChange:p=>f("sellerPostalCode",p.target.value)})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ir,{size:18,style:{color:"var(--warning)"}}),e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Retry & Notification Settings"})]}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Retry Count"}),e.jsx("input",{type:"number",className:"form-input",value:i.retriesCount||3,onChange:p=>f("retriesCount",parseInt(p.target.value)),min:0,max:10})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Backoff Seconds"}),e.jsx("input",{type:"number",className:"form-input",value:i.backoffSeconds||60,onChange:p=>f("backoffSeconds",parseInt(p.target.value)),min:10})]})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:i.blockUntilAccepted||!1,onChange:p=>f("blockUntilAccepted",p.target.checked)}),"Block customer visibility until ZATCA accepted"]})}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:i.notifyOnRejection!==!1,onChange:p=>f("notifyOnRejection",p.target.checked)}),"Notify admin on rejection/failure"]})})]})]})]}),e.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end"},children:e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:l.isPending,children:[e.jsx(cc,{size:16}),"Save Configuration"]})})]})]})}const pM=[{id:1,title:"Create Device",icon:cn},{id:2,title:"Generate CSR",icon:Bg},{id:3,title:"Request CCSID",icon:Ir},{id:4,title:"Compliance Check",icon:aa},{id:5,title:"Request PCSID",icon:Ft}];function UNe(){const t=Gr(),r=gn(),n=pr(),[i,a]=k.useState(null),[s,o]=k.useState(""),[l,u]=k.useState(""),{data:d=[],isLoading:f}=Ve({queryKey:["zatca-credentials"],queryFn:async()=>{const{data:Q}=await xe.get("/zatca/credentials");return Q}}),{data:p}=Ve({queryKey:["zatca-config"],queryFn:async()=>{const{data:Q}=await xe.get("/zatca/config");return Q}}),x=ot({mutationFn:async Q=>{const{data:U}=await xe.post("/zatca/credentials",{deviceName:Q,environment:p?.environment||"SIMULATION"});return U},onSuccess:Q=>{n.invalidateQueries({queryKey:["zatca-credentials"]}),a(Q.id),u(""),r.success("Device Created","New device credential created")},onError:Q=>{r.error("Error",Q.response?.data?.error||"Failed to create device")}}),v=ot({mutationFn:async Q=>{const{data:U}=await xe.post(`/zatca/credentials/${Q}/generate-csr`,{});return U},onSuccess:()=>{n.invalidateQueries({queryKey:["zatca-credentials"]}),r.success("CSR Generated","Certificate Signing Request has been generated")},onError:Q=>{r.error("Error",Q.response?.data?.error||"Failed to generate CSR")}}),w=ot({mutationFn:async({id:Q,otp:U})=>{const{data:$}=await xe.post(`/zatca/credentials/${Q}/request-ccsid`,{otp:U});return $},onSuccess:()=>{n.invalidateQueries({queryKey:["zatca-credentials"]}),o(""),r.success("CCSID Obtained","Compliance CSID has been issued")},onError:Q=>{r.error("Error",Q.response?.data?.error||"Failed to obtain CCSID")}}),C=ot({mutationFn:async Q=>{const{data:U}=await xe.post(`/zatca/credentials/${Q}/run-compliance`);return U},onSuccess:Q=>{n.invalidateQueries({queryKey:["zatca-credentials"]}),Q.result?.passed?r.success("Compliance Passed","All compliance checks passed"):r.error("Compliance Failed","Some checks failed. Review errors.")},onError:Q=>{r.error("Error",Q.response?.data?.error||"Failed to run compliance")}}),A=ot({mutationFn:async Q=>{const{data:U}=await xe.post(`/zatca/credentials/${Q}/request-pcsid`);return U},onSuccess:()=>{n.invalidateQueries({queryKey:["zatca-credentials"]}),n.invalidateQueries({queryKey:["zatca-status"]}),r.success("PCSID Obtained","Production CSID issued. Integration is now ACTIVE!")},onError:Q=>{r.error("Error",Q.response?.data?.error||"Failed to obtain PCSID")}}),T=ot({mutationFn:async Q=>{await xe.delete(`/zatca/credentials/${Q}`)},onSuccess:()=>{n.invalidateQueries({queryKey:["zatca-credentials"]}),a(null),r.success("Deleted","Credential has been removed")},onError:Q=>{r.error("Error",Q.response?.data?.error||"Failed to delete")}}),O=d.find(Q=>Q.id===i),D=Q=>Q.status==="ACTIVE"?6:Q.compliancePassed?5:Q.status==="COMPLIANCE_READY"?4:Q.csrPem?3:2,M=(Q,U)=>Q<U?"completed":Q===U?"current":"pending";return e.jsxs("div",{children:[e.jsx(Ad,{title:"ZATCA Onboarding",subtitle:"Complete the onboarding process to activate ZATCA e-invoice integration",actions:e.jsxs("button",{className:"btn btn-secondary",onClick:()=>t("/admin/zatca"),children:[e.jsx(sa,{size:16}),"Back to Overview"]})}),e.jsxs("div",{className:"grid grid-3",style:{gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{gridColumn:"span 1"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Devices / Solution Units"})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("input",{type:"text",className:"form-input",placeholder:"New device name...",value:l,onChange:Q=>u(Q.target.value),style:{marginBottom:"0.5rem"}}),e.jsxs("button",{className:"btn btn-primary",style:{width:"100%"},onClick:()=>x.mutate(l),disabled:!l||x.isPending,children:[e.jsx(cn,{size:16}),"Create Device"]})]}),f?e.jsx("div",{style:{textAlign:"center",padding:"1rem",color:"var(--text-muted)"},children:"Loading..."}):d.length===0?e.jsx("div",{style:{textAlign:"center",padding:"1rem",color:"var(--text-muted)"},children:"No devices created yet"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:d.map(Q=>e.jsxs("div",{onClick:()=>a(Q.id),style:{padding:"0.75rem",borderRadius:"8px",border:`2px solid ${i===Q.id?"var(--primary)":"var(--border)"}`,cursor:"pointer",background:i===Q.id?"var(--primary-light)":"transparent"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:500},children:Q.deviceName}),e.jsx("span",{className:`badge badge-${Q.status==="ACTIVE"?"success":Q.status==="COMPLIANCE_READY"?"warning":"default"}`,children:Q.status})]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Q.environment})]},Q.id))})]})]}),e.jsxs("div",{className:"card",style:{gridColumn:"span 2"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{margin:0,fontWeight:600},children:"Onboarding Steps"})}),O?e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem"},children:pM.map((Q,U)=>{const $=D(O),ee=M(Q.id,$),F=Q.icon;return e.jsxs("div",{style:{flex:1,textAlign:"center"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 0.5rem",background:ee==="completed"?"var(--success)":ee==="current"?"var(--primary)":"var(--bg-tertiary)",color:ee==="pending"?"var(--text-muted)":"#fff"},children:ee==="completed"?e.jsx(Ai,{size:20}):e.jsx(F,{size:20})}),e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:ee==="current"?600:400},children:Q.title}),U<pM.length-1&&e.jsx("div",{style:{position:"absolute",top:"20px",left:"50%",width:"100%",height:"2px",background:ee==="completed"?"var(--success)":"var(--border)"}})]},Q.id)})}),O.status==="ACTIVE"?e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx(Ft,{size:64,style:{color:"var(--success)",marginBottom:"1rem"}}),e.jsx("h3",{children:"Onboarding Complete!"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"This device is now active and ready to submit invoices to ZATCA."})]}):e.jsx("div",{className:"card",style:{background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{padding:"1.25rem"},children:[D(O)===2&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Step 2: Generate CSR"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Generate a Certificate Signing Request (CSR) with your organization details."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>v.mutate(O.id),disabled:v.isPending,children:[e.jsx(Bg,{size:16}),"Generate CSR"]})]}),D(O)===3&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Step 3: Request CCSID"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Enter the OTP from the Fatoora portal to obtain a Compliance CSID."}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{type:"text",className:"form-input",placeholder:"Enter OTP from Fatoora portal",value:s,onChange:Q=>o(Q.target.value),style:{flex:1}}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>w.mutate({id:O.id,otp:s}),disabled:!s||w.isPending,children:[e.jsx(Ir,{size:16}),"Request CCSID"]})]})]}),D(O)===4&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Step 4: Run Compliance Checks"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Submit sample invoices to verify compliance with ZATCA requirements."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>C.mutate(O.id),disabled:C.isPending,children:[e.jsx(aa,{size:16}),"Run Compliance Checks"]})]}),D(O)===5&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Step 5: Request PCSID"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Compliance passed! Request a Production CSID to activate the integration."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>A.mutate(O.id),disabled:A.isPending,children:[e.jsx(Ft,{size:16}),"Request PCSID & Activate"]})]})]})}),O.status!=="ACTIVE"&&e.jsx("div",{style:{marginTop:"1.5rem",textAlign:"right"},children:e.jsxs("button",{className:"btn btn-danger",onClick:()=>{confirm("Delete this device credential?")&&T.mutate(O.id)},children:[e.jsx(Gi,{size:16}),"Delete Device"]})})]}):e.jsxs("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(aa,{size:48,style:{marginBottom:"1rem"}}),e.jsx("p",{children:"Select a device from the left panel or create a new one to begin onboarding"})]})]})]})]})}const WNe=[{id:"IN_APP",label:"In-App",icon:xo},{id:"EMAIL",label:"Email",icon:uc},{id:"SMS",label:"SMS",icon:vo},{id:"WHATSAPP",label:"WhatsApp",icon:e0}],HNe=[{value:"SMTP",label:"SMTP"},{value:"RESEND",label:"Resend"}],VNe=[{value:"TWILIO",label:"Twilio"}],$Ne=[{value:"META_WHATSAPP",label:"Meta Cloud API"},{value:"TWILIO",label:"Twilio"}];function GNe(){const t=pr(),r=gn(),[n,i]=k.useState("EMAIL"),[a,s]=k.useState(""),[o,l]=k.useState(!1),[u,d]=k.useState({}),[f,p]=k.useState({providerType:"SMTP",host:"",port:"587",secure:!1,username:"",password:"",fromEmail:"",fromName:"RadioPharma OMS",isEnabled:!1}),[x,v]=k.useState({providerType:"TWILIO",accountSid:"",authToken:"",phoneNumber:"",isEnabled:!1}),[w,C]=k.useState({providerType:"META_WHATSAPP",accessToken:"",phoneNumberId:"",businessAccountId:"",isEnabled:!1}),{data:A,isLoading:T}=Ve({queryKey:["notification-channel-configs"],queryFn:async()=>{const{data:le}=await xe.get("/notification-channels");return le}}),{data:O,isLoading:D,refetch:M}=Ve({queryKey:["notification-channel-status"],queryFn:async()=>{const{data:le}=await xe.get("/notification-channels/status");return le}});k.useEffect(()=>{if(A?.EMAIL){const le=A.EMAIL.settingsJson||{};p({providerType:A.EMAIL.providerType||"SMTP",host:le.host||"",port:le.port||"587",secure:le.secure||!1,username:le.username||"",password:le.password||"",fromEmail:le.fromEmail||A.EMAIL.fromAddress||"",fromName:le.fromName||A.EMAIL.fromName||"RadioPharma OMS",isEnabled:A.EMAIL.isEnabled||!1})}if(A?.SMS){const le=A.SMS.settingsJson||{};v({providerType:A.SMS.providerType||"TWILIO",accountSid:le.accountSid||"",authToken:le.authToken||"",phoneNumber:le.phoneNumber||"",isEnabled:A.SMS.isEnabled||!1})}if(A?.WHATSAPP){const le=A.WHATSAPP.settingsJson||{};C({providerType:A.WHATSAPP.providerType||"META_WHATSAPP",accessToken:le.accessToken||"",phoneNumberId:le.phoneNumberId||"",businessAccountId:le.businessAccountId||"",isEnabled:A.WHATSAPP.isEnabled||!1})}},[A]);const Q=ot({mutationFn:async({channel:le,data:K})=>{await xe.put(`/notification-channels/${le}`,K)},onSuccess:()=>{r.success("Settings Saved","Channel configuration updated successfully"),t.invalidateQueries({queryKey:["notification-channel-configs"]}),t.invalidateQueries({queryKey:["notification-channel-status"]})},onError:()=>{r.error("Save Failed","Failed to save channel configuration")}}),U=async()=>{const le=f.providerType==="SMTP"?{host:f.host,port:f.port,secure:f.secure,username:f.username,password:f.password,fromEmail:f.fromEmail,fromName:f.fromName}:{};Q.mutate({channel:"EMAIL",data:{providerType:f.providerType,settingsJson:le,fromName:f.fromName,fromAddress:f.fromEmail,isEnabled:f.isEnabled}})},$=async()=>{Q.mutate({channel:"SMS",data:{providerType:x.providerType,settingsJson:{accountSid:x.accountSid,authToken:x.authToken,phoneNumber:x.phoneNumber},isEnabled:x.isEnabled}})},ee=async()=>{Q.mutate({channel:"WHATSAPP",data:{providerType:w.providerType,settingsJson:{accessToken:w.accessToken,phoneNumberId:w.phoneNumberId,businessAccountId:w.businessAccountId},isEnabled:w.isEnabled}})},F=async le=>{if(!a){r.error("Recipient Required","Please enter a recipient to send the test to");return}l(!0);try{const{data:K}=await xe.post(`/notification-channels/${le}/test`,{recipient:a});K.success?r.success("Test Sent",K.message||"Test message sent successfully"):r.error("Test Failed",K.message||"Failed to send test message"),t.invalidateQueries({queryKey:["notification-channel-configs"]})}catch(K){r.error("Test Failed",K.response?.data?.error||"Failed to send test message")}l(!1)};if(T||D)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const Y=()=>e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx(xo,{size:24,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{margin:0},children:"In-App Notifications"}),e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Always Enabled"]})]}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"In-app notifications are always enabled and cannot be disabled. They appear in the notification bell in the header and in the notification center."}),e.jsxs("div",{className:"card",style:{padding:"1rem",background:"var(--bg-secondary)"},children:[e.jsx("h4",{style:{marginBottom:"0.75rem"},children:"Features"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",color:"var(--text-muted)"},children:[e.jsx("li",{children:"Real-time notification bell with unread count"}),e.jsx("li",{children:"Notification center with full history"}),e.jsx("li",{children:"Click-to-navigate to related records"}),e.jsx("li",{children:"Mark as read / Mark all as read"}),e.jsx("li",{children:"Filter by notification type"})]})]})]}),J=()=>{const le=O?.email,K=le?.connected&&f.isEnabled;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(uc,{size:24,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{margin:0},children:"Email Configuration"}),K&&e.jsx("span",{className:"badge badge-success",children:"Active"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[le?.connected?e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Connected"]}):e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ri,{size:12})," Not Connected"]}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>M(),children:e.jsx(cu,{size:14})})]})]}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem"},children:"Configure email notification settings"}),e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--bg-secondary)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"1rem"},children:"Provider Settings"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.875rem"},children:"Select your email service provider"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:"Provider"}),e.jsx("select",{className:"form-control",value:f.providerType,onChange:ue=>p({...f,providerType:ue.target.value}),style:{maxWidth:"300px"},children:HNe.map(ue=>e.jsx("option",{value:ue.value,children:ue.label},ue.value))})]})]}),f.providerType==="SMTP"&&e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--bg-secondary)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Credentials"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.875rem"},children:"Enter your SMTP API credentials"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["SMTP Host ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",value:f.host,onChange:ue=>p({...f,host:ue.target.value}),placeholder:"smtp.example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["SMTP Port ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",value:f.port,onChange:ue=>p({...f,port:ue.target.value}),placeholder:"587"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:f.secure,onChange:ue=>p({...f,secure:ue.target.checked})}),e.jsx("span",{style:{fontWeight:500},children:"Use SSL/TLS"})]}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.75rem",margin:"0.25rem 0 0 1.5rem"},children:"Enable secure connection for SMTP"})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Username ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",value:f.username,onChange:ue=>p({...f,username:ue.target.value}),placeholder:"your-username"})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Password ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:u.emailPassword?"text":"password",className:"form-control",value:f.password,onChange:ue=>p({...f,password:ue.target.value}),placeholder:"Enter password",style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>d({...u,emailPassword:!u.emailPassword}),style:{position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:u.emailPassword?e.jsx(Eg,{size:16}):e.jsx(os,{size:16})})]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["From Email ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"email",className:"form-control",value:f.fromEmail,onChange:ue=>p({...f,fromEmail:ue.target.value}),placeholder:"noreply@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:"From Name"}),e.jsx("input",{type:"text",className:"form-control",value:f.fromName,onChange:ue=>p({...f,fromName:ue.target.value}),placeholder:"RadioPharma OMS"})]})]})]}),f.providerType==="RESEND"&&e.jsx("div",{className:"card",style:{padding:"1rem",background:"var(--info-bg)",marginBottom:"1.5rem"},children:e.jsx("p",{style:{margin:0,color:"var(--info)",fontSize:"0.875rem"},children:"Resend credentials are managed through Replit integrations. Configure your Resend API key in the Replit secrets panel."})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontWeight:600},children:"Enable Channel"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Allow notifications to be sent through this channel"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:f.isEnabled,onChange:ue=>p({...f,isEnabled:ue.target.checked})}),e.jsx("span",{className:"toggle-slider"})]})]}),le?.error&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--danger-bg)",borderRadius:"6px",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--danger)",marginTop:"1rem"},children:[e.jsx(sn,{size:16}),e.jsx("span",{style:{fontSize:"0.875rem"},children:le.error})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"1.5rem"},children:e.jsxs("button",{className:"btn btn-primary",onClick:U,disabled:Q.isPending,children:[e.jsx(cc,{size:16,style:{marginRight:"0.5rem"}}),"Save Changes"]})})]}),de("EMAIL","email address","test@example.com")]})},Z=()=>{const le=O?.sms,K=le?.connected&&x.isEnabled;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(vo,{size:24,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{margin:0},children:"SMS Configuration"}),K&&e.jsx("span",{className:"badge badge-success",children:"Active"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[le?.connected?e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Connected"]}):e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ri,{size:12})," Not Connected"]}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>M(),children:e.jsx(cu,{size:14})})]})]}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem"},children:"Configure SMS notification settings"}),e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--bg-secondary)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"1rem"},children:"Provider Settings"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.875rem"},children:"Select your SMS service provider"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:"Provider"}),e.jsx("select",{className:"form-control",value:x.providerType,onChange:ue=>v({...x,providerType:ue.target.value}),style:{maxWidth:"300px"},children:VNe.map(ue=>e.jsx("option",{value:ue.value,children:ue.label},ue.value))})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--bg-secondary)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Credentials"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.875rem"},children:"Enter your Twilio API credentials"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Account SID ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",value:x.accountSid,onChange:ue=>v({...x,accountSid:ue.target.value}),placeholder:"AC..."})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Auth Token ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:u.smsAuthToken?"text":"password",className:"form-control",value:x.authToken,onChange:ue=>v({...x,authToken:ue.target.value}),placeholder:"Enter auth token",style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>d({...u,smsAuthToken:!u.smsAuthToken}),style:{position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:u.smsAuthToken?e.jsx(Eg,{size:16}):e.jsx(os,{size:16})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Phone Number ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"tel",className:"form-control",value:x.phoneNumber,onChange:ue=>v({...x,phoneNumber:ue.target.value}),placeholder:"+1234567890"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontWeight:600},children:"Enable Channel"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Allow notifications to be sent through this channel"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:x.isEnabled,onChange:ue=>v({...x,isEnabled:ue.target.checked})}),e.jsx("span",{className:"toggle-slider"})]})]}),le?.error&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--danger-bg)",borderRadius:"6px",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--danger)",marginTop:"1rem"},children:[e.jsx(sn,{size:16}),e.jsx("span",{style:{fontSize:"0.875rem"},children:le.error})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"1.5rem"},children:e.jsxs("button",{className:"btn btn-primary",onClick:$,disabled:Q.isPending,children:[e.jsx(cc,{size:16,style:{marginRight:"0.5rem"}}),"Save Changes"]})})]}),de("SMS","phone number","+966501234567")]})},re=()=>{const le=O?.whatsapp,K=le?.connected&&w.isEnabled;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(e0,{size:24,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{margin:0},children:"WhatsApp Configuration"}),K&&e.jsx("span",{className:"badge badge-success",children:"Active"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[le?.connected?e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Connected"]}):e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ri,{size:12})," Not Connected"]}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>M(),children:e.jsx(cu,{size:14})})]})]}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem"},children:"Configure WhatsApp notification settings"}),e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--bg-secondary)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"1rem"},children:"Provider Settings"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.875rem"},children:"Select your WhatsApp service provider"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:"Provider"}),e.jsx("select",{className:"form-control",value:w.providerType,onChange:ue=>C({...w,providerType:ue.target.value}),style:{maxWidth:"300px"},children:$Ne.map(ue=>e.jsx("option",{value:ue.value,children:ue.label},ue.value))})]})]}),w.providerType==="META_WHATSAPP"&&e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--bg-secondary)",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Credentials"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem",fontSize:"0.875rem"},children:"Enter your Meta API credentials"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Access Token ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:u.whatsappToken?"text":"password",className:"form-control",value:w.accessToken,onChange:ue=>C({...w,accessToken:ue.target.value}),placeholder:"Enter access token",style:{paddingRight:"2.5rem"}}),e.jsx("button",{type:"button",onClick:()=>d({...u,whatsappToken:!u.whatsappToken}),style:{position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:u.whatsappToken?e.jsx(Eg,{size:16}):e.jsx(os,{size:16})})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Phone Number ID ",e.jsx("span",{style:{color:"var(--danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:"form-control",value:w.phoneNumberId,onChange:ue=>C({...w,phoneNumberId:ue.target.value}),placeholder:"Enter phone number id"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:"Business Account ID"}),e.jsx("input",{type:"text",className:"form-control",value:w.businessAccountId,onChange:ue=>C({...w,businessAccountId:ue.target.value}),placeholder:"Enter business account id"})]})]}),w.providerType==="TWILIO"&&e.jsx("div",{className:"card",style:{padding:"1rem",background:"var(--info-bg)",marginBottom:"1.5rem"},children:e.jsx("p",{style:{margin:0,color:"var(--info)",fontSize:"0.875rem"},children:"Twilio WhatsApp uses the same credentials as SMS. Configure your Twilio credentials in the SMS tab."})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontWeight:600},children:"Enable Channel"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Allow notifications to be sent through this channel"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:w.isEnabled,onChange:ue=>C({...w,isEnabled:ue.target.checked})}),e.jsx("span",{className:"toggle-slider"})]})]}),le?.error&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--danger-bg)",borderRadius:"6px",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--danger)",marginTop:"1rem"},children:[e.jsx(sn,{size:16}),e.jsx("span",{style:{fontSize:"0.875rem"},children:le.error})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"1.5rem"},children:e.jsxs("button",{className:"btn btn-primary",onClick:ee,disabled:Q.isPending,children:[e.jsx(cc,{size:16,style:{marginRight:"0.5rem"}}),"Save Changes"]})})]}),de("WHATSAPP","phone number","+966501234567")]})},de=(le,K,ue)=>{const ce=A?.[le];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("h4",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Qi,{size:18}),"Send Test Message"]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:1,maxWidth:"400px"},children:[e.jsxs("label",{style:{fontWeight:500,marginBottom:"0.5rem",display:"block"},children:["Recipient ",K]}),e.jsx("input",{type:le==="EMAIL"?"email":"tel",className:"form-control",value:a,onChange:ye=>s(ye.target.value),placeholder:ue})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>F(le),disabled:o,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[o?e.jsx("div",{className:"spinner",style:{width:"16px",height:"16px"}}):e.jsx(Qi,{size:16}),"Send Test"]})]}),ce?.lastTestedAt&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"6px",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[ce.lastTestStatus==="SENT"?e.jsx(Ft,{size:14,style:{color:"var(--success)"}}):e.jsx(ri,{size:14,style:{color:"var(--danger)"}}),e.jsxs("span",{children:["Last test: ",new Date(ce.lastTestedAt).toLocaleString()," -",e.jsx("span",{style:{color:ce.lastTestStatus==="SENT"?"var(--success)":"var(--danger)",marginLeft:"0.25rem"},children:ce.lastTestStatus==="SENT"?"Successful":"Failed"})]})]}),ce.lastTestMessage&&ce.lastTestStatus!=="SENT"&&e.jsx("p",{style:{margin:"0.5rem 0 0 0",color:"var(--text-muted)"},children:ce.lastTestMessage})]})]}),e.jsx("div",{className:"card",style:{padding:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsxs("h4",{style:{marginBottom:"0.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ir,{size:18}),"Delivery Logs"]}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"0.875rem"},children:"View detailed logs of all delivery attempts"})]}),e.jsx(nr,{to:"/admin/notification-delivery-logs",className:"btn btn-outline",children:"View Logs"})]})})]})};return e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(nr,{to:"/settings",className:"btn btn-outline btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"1.5rem"},children:"Notification Channels"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.875rem"},children:"Configure email, SMS, and WhatsApp notification channels"})]})]})}),e.jsx("div",{style:{display:"flex",borderBottom:"1px solid var(--border)",marginBottom:"1.5rem"},children:WNe.map(le=>{const K=le.id==="EMAIL"?f.isEnabled:le.id==="SMS"?x.isEnabled:le.id==="WHATSAPP"?w.isEnabled:!0;return e.jsxs("button",{onClick:()=>i(le.id),className:`tab-button ${n===le.id?"active":""}`,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",border:"none",background:"transparent",cursor:"pointer",borderBottom:n===le.id?"2px solid var(--primary)":"2px solid transparent",color:n===le.id?"var(--primary)":"var(--text-muted)",fontWeight:n===le.id?600:400},children:[e.jsx(le.icon,{size:18}),le.label,le.id!=="IN_APP"&&K&&e.jsx("span",{className:"badge badge-success",style:{padding:"0.125rem 0.375rem",fontSize:"0.625rem"},children:"ON"}),le.id!=="IN_APP"&&!K&&e.jsx("span",{className:"badge badge-secondary",style:{padding:"0.125rem 0.375rem",fontSize:"0.625rem"},children:"OFF"})]},le.id)})}),n==="IN_APP"&&Y(),n==="EMAIL"&&J(),n==="SMS"&&Z(),n==="WHATSAPP"&&re()]})}const KNe={EMAIL:uc,SMS:vo,WHATSAPP:e0,IN_APP:xo},gM={SENT:{color:"var(--success)",bg:"var(--success-bg)",icon:Ft},FAILED:{color:"var(--danger)",bg:"var(--danger-bg)",icon:ri},PENDING:{color:"var(--warning)",bg:"var(--warning-bg)",icon:Qt},SKIPPED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",icon:QL}};function QNe(){const{formatDateTime:t}=ph(),[r,n]=k.useState({channel:"all",status:"all",startDate:"",endDate:"",search:""}),[i,a]=k.useState(1),s=25,{data:o,isLoading:l}=Ve({queryKey:["delivery-attempts",r,i],queryFn:async()=>{const p=new URLSearchParams;r.channel!=="all"&&p.append("channel",r.channel),r.status!=="all"&&p.append("status",r.status),r.startDate&&p.append("startDate",r.startDate),r.endDate&&p.append("endDate",r.endDate),r.search&&p.append("search",r.search),p.append("page",i.toString()),p.append("limit",s.toString());const{data:x}=await xe.get(`/notification-channels/delivery-attempts?${p}`);return x}}),u=async()=>{const p=new URLSearchParams;r.channel!=="all"&&p.append("channel",r.channel),r.status!=="all"&&p.append("status",r.status),r.startDate&&p.append("startDate",r.startDate),r.endDate&&p.append("endDate",r.endDate),p.append("limit","10000");try{const{data:x}=await xe.get(`/notification-channels/delivery-attempts?${p}`),v=[["Date","Channel","Status","Recipient","Notification","Provider ID","Error"].join(","),...x.data.map(T=>[new Date(T.attemptedAt).toISOString(),T.channel,T.status,`"${T.recipientAddress}"`,`"${T.notification?.title||"N/A"}"`,T.providerMessageId||"",`"${T.errorMessage||""}"`].join(","))],w=new Blob([v.join(`
`)],{type:"text/csv"}),C=URL.createObjectURL(w),A=document.createElement("a");A.href=C,A.download=`notification-logs-${new Date().toISOString().split("T")[0]}.csv`,A.click(),URL.revokeObjectURL(C)}catch(x){console.error("Export failed",x)}},d=p=>{const x=gM[p]||gM.PENDING,v=x.icon;return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,color:x.color,background:x.bg},children:[e.jsx(v,{size:12}),p]})},f=p=>{const x=KNe[p]||xo;return e.jsx(x,{size:16,style:{color:"var(--text-muted)"}})};return e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(nr,{to:"/admin/notification-channels",className:"btn btn-outline btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"1.5rem"},children:"Notification Delivery Logs"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.875rem"},children:"View all notification delivery attempts across channels"})]})]}),e.jsxs("button",{className:"btn btn-outline",onClick:u,children:[e.jsx(Jp,{size:16}),"Export CSV"]})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"Channel"}),e.jsxs("select",{className:"form-control",value:r.channel,onChange:p=>{n({...r,channel:p.target.value}),a(1)},style:{minWidth:"120px"},children:[e.jsx("option",{value:"all",children:"All Channels"}),e.jsx("option",{value:"EMAIL",children:"Email"}),e.jsx("option",{value:"SMS",children:"SMS"}),e.jsx("option",{value:"WHATSAPP",children:"WhatsApp"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"Status"}),e.jsxs("select",{className:"form-control",value:r.status,onChange:p=>{n({...r,status:p.target.value}),a(1)},style:{minWidth:"120px"},children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"SENT",children:"Sent"}),e.jsx("option",{value:"FAILED",children:"Failed"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"SKIPPED",children:"Skipped"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"From Date"}),e.jsx("input",{type:"date",className:"form-control",value:r.startDate,onChange:p=>{n({...r,startDate:p.target.value}),a(1)}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"To Date"}),e.jsx("input",{type:"date",className:"form-control",value:r.endDate,onChange:p=>{n({...r,endDate:p.target.value}),a(1)}})]}),e.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:500,display:"block",marginBottom:"0.25rem"},children:"Search Recipient"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by email or phone...",value:r.search,onChange:p=>{n({...r,search:p.target.value}),a(1)}})]}),e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>{n({channel:"all",status:"all",startDate:"",endDate:"",search:""}),a(1)},children:[e.jsx(Wo,{size:14}),"Clear"]})]})}),l?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"3rem"},children:e.jsx("div",{className:"spinner"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card",style:{overflow:"hidden"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"Channel"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Recipient"}),e.jsx("th",{children:"Notification"}),e.jsx("th",{children:"Provider ID"}),e.jsx("th",{children:"Error"})]})}),e.jsx("tbody",{children:o?.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"No delivery attempts found matching your filters"})}):o?.data.map(p=>e.jsxs("tr",{children:[e.jsx("td",{style:{whiteSpace:"nowrap"},children:t(p.attemptedAt)}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f(p.channel),e.jsx("span",{children:p.channel})]})}),e.jsx("td",{children:d(p.status)}),e.jsx("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:p.recipientAddress}),e.jsx("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:p.notification?.title||"-"}),e.jsx("td",{style:{fontSize:"0.75rem",fontFamily:"monospace",color:"var(--text-muted)"},children:p.providerMessageId?p.providerMessageId.substring(0,20)+"...":"-"}),e.jsx("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",color:"var(--danger)"},children:p.errorMessage||"-"})]},p.id))})]})}),o?.pagination&&o.pagination.total>0&&e.jsx("div",{style:{marginTop:"1rem",borderRadius:"8px",overflow:"hidden"},children:e.jsx(a0,{page:i,pageSize:s,totalCount:o.pagination.total,onPageChange:a})})]})]})}const YNe=[{value:"INFO",label:"All Notifications",description:"Receive all notifications including informational updates"},{value:"ACTION_REQUIRED",label:"Action Required & Above",description:"Only notifications that require your action"},{value:"WARNING",label:"Warnings & Critical Only",description:"Only warnings and critical alerts"},{value:"CRITICAL",label:"Critical Only",description:"Only receive critical system alerts"}];function ZNe(){const t=pr(),r=gn(),[n,i]=k.useState(null),[a,s]=k.useState(!1),{data:o,isLoading:l}=Ve({queryKey:["user-notification-preferences"],queryFn:async()=>{const{data:x}=await xe.get("/notification-channels/user-preferences");return x}});k.useEffect(()=>{o&&i(o)},[o]);const u=ot({mutationFn:async x=>{await xe.put("/notification-channels/user-preferences",x)},onSuccess:()=>{r.success("Preferences Saved","Your notification preferences have been updated"),t.invalidateQueries({queryKey:["user-notification-preferences"]}),s(!1)},onError:()=>{r.error("Save Failed","Failed to save notification preferences")}}),d=(x,v)=>{n&&(i({...n,[x]:v}),s(!0))},f=()=>{n&&u.mutate({emailEnabled:n.emailEnabled,smsEnabled:n.smsEnabled,whatsappEnabled:n.whatsappEnabled,minSeverity:n.minSeverity})};if(l||!n)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const p=(x,v,w,C,A,T)=>{const O=v,D=A===!1;return e.jsxs("div",{className:"card",style:{padding:"1.25rem",opacity:D?.6:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(O,{size:24,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:0},children:w}),e.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"var(--text-muted)"},children:["Receive notifications via ",w.toLowerCase()]})]})]}),e.jsxs("label",{className:"switch",style:{position:"relative"},children:[e.jsx("input",{type:"checkbox",checked:C&&!D,disabled:D,onChange:M=>T(M.target.checked)}),e.jsx("span",{className:"slider"})]})]}),D&&e.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem 0.75rem",background:"var(--warning-bg)",borderRadius:"4px",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"var(--warning)"},children:[e.jsx(sn,{size:14}),"This channel has been disabled by an administrator"]})]})};return e.jsxs("div",{style:{padding:"1.5rem",maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(nr,{to:"/profile",className:"btn btn-outline btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:"1.5rem"},children:"Notification Preferences"}),e.jsx("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"0.875rem"},children:"Choose how you want to receive notifications"})]})]}),e.jsxs("button",{className:"btn btn-primary",onClick:f,disabled:!a||u.isPending,children:[u.isPending?e.jsx("div",{className:"spinner",style:{width:"16px",height:"16px"}}):e.jsx(cc,{size:16}),"Save Changes"]})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(xo,{size:20}),"Notification Channels"]}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Select which channels you want to receive notifications on. In-app notifications are always enabled."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsx("div",{className:"card",style:{padding:"1.25rem",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(xo,{size:24,style:{color:"var(--primary)"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:0},children:"In-App Notifications"}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"var(--text-muted)"},children:"Always enabled - notifications appear in the notification bell"})]}),e.jsx("span",{className:"badge badge-success",children:"Always On"})]})}),p("email",uc,"Email",n.emailEnabled,n.emailGlobalEnabled,x=>d("emailEnabled",x)),p("sms",vo,"SMS",n.smsEnabled,n.smsGlobalEnabled,x=>d("smsEnabled",x)),p("whatsapp",e0,"WhatsApp",n.whatsappEnabled,n.whatsappGlobalEnabled,x=>d("whatsappEnabled",x))]})]}),e.jsxs("div",{children:[e.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(lf,{size:20}),"Notification Threshold"]}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Set the minimum severity level for notifications you want to receive."}),e.jsx("div",{className:"card",style:{padding:"1.25rem"},children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:YNe.map(x=>e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",padding:"0.75rem",borderRadius:"6px",cursor:"pointer",background:n.minSeverity===x.value?"var(--primary-bg)":"transparent",border:n.minSeverity===x.value?"1px solid var(--primary)":"1px solid transparent"},children:[e.jsx("input",{type:"radio",name:"severity",value:x.value,checked:n.minSeverity===x.value,onChange:v=>d("minSeverity",v.target.value),style:{marginTop:"0.125rem"}}),e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:500},children:x.label}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"var(--text-muted)"},children:x.description})]})]},x.value))})})]}),e.jsx("style",{children:`
        .switch {
          position: relative;
          display: inline-block;
          width: 48px;
          height: 26px;
        }
        .switch input {
          opacity: 0;
          width: 0;
          height: 0;
        }
        .slider {
          position: absolute;
          cursor: pointer;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: var(--bg-tertiary);
          transition: 0.3s;
          border-radius: 26px;
        }
        .slider:before {
          position: absolute;
          content: "";
          height: 20px;
          width: 20px;
          left: 3px;
          bottom: 3px;
          background-color: white;
          transition: 0.3s;
          border-radius: 50%;
        }
        input:checked + .slider {
          background-color: var(--primary);
        }
        input:checked + .slider:before {
          transform: translateX(22px);
        }
        input:disabled + .slider {
          opacity: 0.5;
          cursor: not-allowed;
        }
      `})]})}function XNe(){const t=Gr(),r=pr(),n=gn(),[i,a]=k.useState({}),[s,o]=k.useState(null),{data:l,isLoading:u}=Ve({queryKey:["admin-announcements"],queryFn:async()=>{const{data:M}=await xe.get("/announcements/admin/announcements");return M}}),d=ot({mutationFn:async M=>xe.post(`/announcements/admin/announcements/${M}/publish`),onSuccess:()=>{r.invalidateQueries({queryKey:["admin-announcements"]}),n.success("Published","Announcement is now active")},onError:M=>{n.error("Error",M.response?.data?.error||"Failed to publish")}}),f=ot({mutationFn:async M=>xe.post(`/announcements/admin/announcements/${M}/unpublish`),onSuccess:()=>{r.invalidateQueries({queryKey:["admin-announcements"]}),n.success("Unpublished","Announcement is now a draft")}}),p=ot({mutationFn:async M=>xe.delete(`/announcements/admin/announcements/${M}`),onSuccess:()=>{r.invalidateQueries({queryKey:["admin-announcements"]}),n.success("Deleted","Announcement has been removed")}}),x=ot({mutationFn:async M=>xe.post(`/announcements/admin/announcements/${M}/duplicate`),onSuccess:M=>{r.invalidateQueries({queryKey:["admin-announcements"]}),n.success("Duplicated","A copy has been created"),t(`/admin/announcements/${M.data.id}/edit`)}}),v=[{key:"search",label:"Search",type:"search",placeholder:"Search title or content..."},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},{value:"DRAFT",label:"Draft"},{value:"SCHEDULED",label:"Scheduled"},{value:"ACTIVE",label:"Active"},{value:"EXPIRED",label:"Expired"}]},{key:"severity",label:"Severity",type:"select",options:[{value:"",label:"All Severities"},{value:"INFO",label:"Info"},{value:"WARNING",label:"Warning"},{value:"CRITICAL",label:"Critical"}]}],w=M=>M.computedStatus||M.status,C=l?.filter(M=>{const Q=w(M);if(i.status&&Q!==i.status||i.severity&&M.severity!==i.severity||s==="draft"&&Q!=="DRAFT"||s==="scheduled"&&Q!=="SCHEDULED"||s==="active"&&Q!=="ACTIVE"||s==="expired"&&Q!=="EXPIRED")return!1;if(i.search){const U=i.search.toLowerCase();if(!M.title.toLowerCase().includes(U)&&!M.body.toLowerCase().includes(U))return!1}return!0}),A={total:l?.length||0,draft:l?.filter(M=>w(M)==="DRAFT").length||0,scheduled:l?.filter(M=>w(M)==="SCHEDULED").length||0,active:l?.filter(M=>w(M)==="ACTIVE").length||0,expired:l?.filter(M=>w(M)==="EXPIRED").length||0},T=M=>{o(s===M?null:M)},O=M=>{switch(M){case"CRITICAL":return e.jsx(sn,{size:14,style:{color:"var(--danger)"}});case"WARNING":return e.jsx(Hr,{size:14,style:{color:"var(--warning)"}});default:return e.jsx(lf,{size:14,style:{color:"var(--info)"}})}},D=M=>{const Q={DRAFT:"badge-secondary",SCHEDULED:"badge-info",ACTIVE:"badge-success",EXPIRED:"badge-danger"};return e.jsx("span",{className:`badge ${Q[M]||"badge-secondary"}`,children:M})};return u?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Announcement Management"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Create and manage system-wide announcements"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>t("/admin/announcements/new"),children:[e.jsx(cn,{size:16}),"New Announcement"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total",value:A.total,icon:e.jsx(az,{size:20}),color:"primary",onClick:()=>o(null),selected:s===null}),e.jsx(nt,{title:"Draft",value:A.draft,icon:e.jsx(ma,{size:20}),color:"default",onClick:()=>T("draft"),selected:s==="draft"}),e.jsx(nt,{title:"Scheduled",value:A.scheduled,icon:e.jsx($n,{size:20}),color:"info",onClick:()=>T("scheduled"),selected:s==="scheduled"}),e.jsx(nt,{title:"Active",value:A.active,icon:e.jsx(yo,{size:20}),color:"success",onClick:()=>T("active"),selected:s==="active"}),e.jsx(nt,{title:"Expired",value:A.expired,icon:e.jsx(qC,{size:20}),color:"danger",onClick:()=>T("expired"),selected:s==="expired"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:v,values:i,onChange:(M,Q)=>a(U=>({...U,[M]:Q})),onReset:()=>{a({}),o(null)}})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Announcements (",C?.length||0,")"]})}),C&&C.length>0?e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Schedule"}),e.jsx("th",{children:"Audience"}),e.jsx("th",{children:"Delivered"}),e.jsx("th",{children:"Created"}),e.jsx("th",{style:{width:"150px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:C.map(M=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500,maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:M.title}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[M.body.substring(0,60),"..."]})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[O(M.severity),e.jsx("span",{style:{fontSize:"0.8125rem"},children:M.severity})]})}),e.jsx("td",{children:D(w(M))}),e.jsx("td",{style:{fontSize:"0.8125rem"},children:M.startAt?e.jsxs("div",{children:[e.jsx("div",{children:Ze(new Date(M.startAt),"MMM dd, yyyy HH:mm")}),M.endAt&&e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:["to ",Ze(new Date(M.endAt),"MMM dd, yyyy HH:mm")]})]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"-"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(dc,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem"},children:M.audiences.length===0?"All":`${M.audiences.length} targets`})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(os,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.8125rem"},children:M._count.deliveries})]})}),e.jsx("td",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Ze(new Date(M.createdAt),"MMM dd")}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>t(`/admin/announcements/${M.id}/edit`),title:"Edit",disabled:w(M)==="ACTIVE",children:e.jsx(ma,{size:14})}),M.isPublished?w(M)==="ACTIVE"?e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>f.mutate(M.id),title:"Unpublish",disabled:f.isPending,children:e.jsx(qC,{size:14})}):null:e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>d.mutate(M.id),title:"Publish",disabled:d.isPending,children:e.jsx(yo,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>x.mutate(M.id),title:"Duplicate",children:e.jsx(RA,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{confirm("Delete this announcement?")&&p.mutate(M.id)},title:"Delete",children:e.jsx(Gi,{size:14})})]})})]},M.id))})]})}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No announcements found",message:"Create your first announcement to notify users",icon:"alert"})})]})]})}function yM(){const{id:t}=fl(),r=Gr(),n=pr(),i=gn(),a=!!t,[s,o]=k.useState({title:"",body:"",severity:"INFO",publishMode:"IMMEDIATE",startAt:"",endAt:"",sendEmail:!1,sendSms:!1,sendWhatsapp:!1,targetRoleCodes:[],specificCustomerIds:[],specificUserIds:[]}),{data:l,isLoading:u}=Ve({queryKey:["announcement",t],queryFn:async()=>{const{data:C}=await xe.get(`/announcements/admin/announcements/${t}`);return C},enabled:a}),{data:d}=Ve({queryKey:["roles"],queryFn:async()=>{const{data:C}=await xe.get("/roles");return C}}),{data:f}=Ve({queryKey:["customers"],queryFn:async()=>{const{data:C}=await xe.get("/customers");return C}}),{data:p}=Ve({queryKey:["users"],queryFn:async()=>{const{data:C}=await xe.get("/users");return C}});k.useEffect(()=>{if(l){const C=l.audiences.filter(O=>O.audienceType==="ROLE"),A=l.audiences.filter(O=>O.audienceType==="CUSTOMER"),T=l.audiences.filter(O=>O.audienceType==="USER");o({title:l.title,body:l.body,severity:l.severity,publishMode:l.publishMode,startAt:l.startAt?new Date(l.startAt).toISOString().slice(0,16):"",endAt:l.endAt?new Date(l.endAt).toISOString().slice(0,16):"",sendEmail:l.sendEmail,sendSms:l.sendSms,sendWhatsapp:l.sendWhatsapp,targetRoleCodes:C.map(O=>O.roleCode),specificCustomerIds:A.filter(O=>O.customerId).map(O=>O.customerId),specificUserIds:T.map(O=>O.userId)})}},[l]);const x=ot({mutationFn:async C=>a?xe.put(`/announcements/admin/announcements/${t}`,C):xe.post("/announcements/admin/announcements",C),onSuccess:()=>{n.invalidateQueries({queryKey:["admin-announcements"]}),i.success("Saved",a?"Announcement updated":"Announcement created"),r("/admin/announcements")},onError:C=>{i.error("Error",C.response?.data?.error||"Failed to save")}}),v=ot({mutationFn:async C=>xe.post(`/announcements/admin/announcements/${C}/publish`),onSuccess:()=>{n.invalidateQueries({queryKey:["admin-announcements"]}),i.success("Published","Announcement is now active"),r("/admin/announcements")},onError:C=>{i.error("Error",C.response?.data?.error||"Failed to publish")}}),w=async(C,A=!1)=>{if(C.preventDefault(),!s.title.trim()||!s.body.trim()){i.error("Validation Error","Title and message are required");return}if(s.publishMode==="SCHEDULED"&&!s.startAt){i.error("Validation Error","Start date is required for scheduled announcements");return}if(s.startAt&&s.endAt&&new Date(s.startAt)>=new Date(s.endAt)){i.error("Validation Error","End date must be after start date");return}const T=[];s.targetRoleCodes.forEach(M=>{T.push({audienceType:"ROLE",roleCode:M})}),s.specificCustomerIds.forEach(M=>{T.push({audienceType:"CUSTOMER",customerId:M})}),s.specificUserIds.forEach(M=>{T.push({audienceType:"USER",userId:M})});const O={title:s.title,body:s.body,severity:s.severity,publishMode:s.publishMode,startAt:s.startAt||null,endAt:s.endAt||null,sendEmail:s.sendEmail,sendSms:s.sendSms,sendWhatsapp:s.sendWhatsapp,audiences:T},D=await x.mutateAsync(O);A&&D.data.id&&await v.mutateAsync(D.data.id)};return a&&u?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs(nr,{to:"/admin/announcements",style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",textDecoration:"none",marginBottom:"0.5rem"},children:[e.jsx(sa,{size:16}),"Back to Announcements"]}),e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:a?"Edit Announcement":"Create Announcement"})]}),e.jsxs("form",{onSubmit:C=>w(C,!1),children:[e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"2fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontWeight:600,marginBottom:"1rem",fontSize:"1rem"},children:"Content"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Title *"}),e.jsx("input",{type:"text",className:"form-input",value:s.title,onChange:C=>o(A=>({...A,title:C.target.value})),placeholder:"Announcement title",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Message *"}),e.jsx("textarea",{className:"form-input",value:s.body,onChange:C=>o(A=>({...A,body:C.target.value})),placeholder:"Write your announcement message...",rows:6,required:!0,style:{resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Severity"}),e.jsx("div",{style:{display:"flex",gap:"0.75rem"},children:["INFO","WARNING","CRITICAL"].map(C=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1rem",border:`2px solid ${s.severity===C?"var(--primary)":"var(--border)"}`,borderRadius:"var(--radius)",cursor:"pointer",background:s.severity===C?"var(--primary-light)":"transparent",flex:1},children:[e.jsx("input",{type:"radio",name:"severity",value:C,checked:s.severity===C,onChange:()=>o(A=>({...A,severity:C})),style:{display:"none"}}),C==="CRITICAL"?e.jsx(sn,{size:18,style:{color:"var(--danger)"}}):C==="WARNING"?e.jsx(Hr,{size:18,style:{color:"var(--warning)"}}):e.jsx(lf,{size:18,style:{color:"var(--info)"}}),e.jsx("span",{style:{fontWeight:500},children:C.charAt(0)+C.slice(1).toLowerCase()})]},C))})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontWeight:600,marginBottom:"1rem",fontSize:"1rem"},children:"Audience Targeting"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{className:"form-label",style:{marginBottom:"0.5rem",display:"block"},children:"Target Roles"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem"},children:d?.map(C=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:s.targetRoleCodes.includes(C.code),onChange:A=>{A.target.checked?o(T=>({...T,targetRoleCodes:[...T.targetRoleCodes,C.code]})):o(T=>({...T,targetRoleCodes:T.targetRoleCodes.filter(O=>O!==C.code)}))}}),C.name]},C.id))}),!d?.length&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:"No roles found in the system"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Specific Customers (optional)"}),e.jsx("select",{className:"form-select",multiple:!0,value:s.specificCustomerIds,onChange:C=>{const A=Array.from(C.target.selectedOptions,T=>T.value);o(T=>({...T,specificCustomerIds:A}))},style:{minHeight:"100px"},children:f?.map(C=>e.jsxs("option",{value:C.id,children:[C.nameEn||C.name," (",C.code,")"]},C.id))}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"Select specific customers to target. Hold Ctrl/Cmd to select multiple."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Specific Users (optional)"}),e.jsx("select",{className:"form-select",multiple:!0,value:s.specificUserIds,onChange:C=>{const A=Array.from(C.target.selectedOptions,T=>T.value);o(T=>({...T,specificUserIds:A}))},style:{minHeight:"100px"},children:p?.map(C=>e.jsxs("option",{value:C.id,children:[C.firstName," ",C.lastName," (",C.email,")"]},C.id))}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"Select specific users to always include. Hold Ctrl/Cmd to select multiple."})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontWeight:600,marginBottom:"1rem",fontSize:"1rem"},children:"Scheduling"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Publish Mode"}),e.jsxs("select",{className:"form-select",value:s.publishMode,onChange:C=>o(A=>({...A,publishMode:C.target.value})),children:[e.jsx("option",{value:"IMMEDIATE",children:"Immediate"}),e.jsx("option",{value:"SCHEDULED",children:"Scheduled"})]})]}),s.publishMode==="SCHEDULED"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Start Date/Time *"}),e.jsx("input",{type:"datetime-local",className:"form-input",value:s.startAt,onChange:C=>o(A=>({...A,startAt:C.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"End Date/Time (optional)"}),e.jsx("input",{type:"datetime-local",className:"form-input",value:s.endAt,onChange:C=>o(A=>({...A,endAt:C.target.value}))}),e.jsx("small",{style:{color:"var(--text-muted)"},children:"Leave empty for no expiration"})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontWeight:600,marginBottom:"1rem",fontSize:"1rem"},children:"Notification Channels"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1rem"},children:"In addition to in-app notifications, send via:"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:s.sendEmail,onChange:C=>o(A=>({...A,sendEmail:C.target.checked}))}),"Email"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:s.sendSms,onChange:C=>o(A=>({...A,sendSms:C.target.checked}))}),"SMS"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:s.sendWhatsapp,onChange:C=>o(A=>({...A,sendWhatsapp:C.target.checked}))}),"WhatsApp"]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem",background:"var(--primary-light)"},children:[e.jsx("h3",{style:{fontWeight:600,marginBottom:"1rem",fontSize:"1rem"},children:"Preview"}),e.jsxs("div",{style:{padding:"0.75rem 1rem",borderRadius:"var(--radius)",background:s.severity==="CRITICAL"?"var(--danger)":s.severity==="WARNING"?"var(--warning)":"var(--info)",color:"white"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:600},children:[s.severity==="CRITICAL"?e.jsx(sn,{size:16}):s.severity==="WARNING"?e.jsx(Hr,{size:16}):e.jsx(lf,{size:16}),s.title||"Announcement Title"]}),e.jsxs("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem",opacity:.9},children:[s.body.substring(0,80)||"Your message will appear here...",s.body.length>80&&"..."]})]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>r("/admin/announcements"),children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-outline",disabled:x.isPending,children:[e.jsx(cc,{size:16}),x.isPending?"Saving...":"Save as Draft"]}),e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:C=>w(C,!0),disabled:x.isPending||v.isPending,children:[e.jsx(yo,{size:16}),v.isPending?"Publishing...":"Save & Publish"]})]})]})]})}function JNe(){const t=pr(),[r,n]=k.useState(null),{data:i,isLoading:a,refetch:s}=Ve({queryKey:["demo-status"],queryFn:async()=>{const{data:d}=await xe.get("/admin/demo/status");return d}}),o=ot({mutationFn:async({action:d,payload:f})=>{const{data:p}=await xe.post(`/admin/demo/actions/${d}`,f||{});return p},onSuccess:d=>{n({success:!0,message:d.message}),t.invalidateQueries({queryKey:["demo-status"]}),setTimeout(()=>n(null),5e3)},onError:d=>{n({success:!1,message:d.response?.data?.error||"Action failed"}),setTimeout(()=>n(null),5e3)}}),l=ot({mutationFn:async d=>{const{data:f}=await xe.post("/admin/demo/seed",{mode:d});return f},onSuccess:d=>{n({success:!0,message:d.message}),t.invalidateQueries({queryKey:["demo-status"]})},onError:d=>{n({success:!1,message:d.response?.data?.error||"Seed failed"})}}),u=d=>({DELIVERED:"#22c55e",PAID:"#22c55e",CLOSED_ARCHIVED:"#6b7280",IN_TRANSIT:"#3b82f6",ISSUED_POSTED:"#f59e0b",PARTIALLY_PAID:"#f59e0b",DISPATCHED:"#8b5cf6"})[d]||"#6b7280";return a?e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"3rem"},children:[e.jsx(cu,{size:24,className:"spin",style:{margin:"0 auto 1rem"}}),e.jsx("p",{children:"Loading demo status..."})]})}):e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Demo Actions Panel"}),e.jsx("p",{className:"page-subtitle",children:"Quick actions for live demonstrations"})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>s(),children:[e.jsx(cu,{size:16}),"Refresh Status"]})]}),r&&e.jsx("div",{className:`alert ${r.success?"alert-success":"alert-error"}`,style:{marginBottom:"1.5rem"},children:r.message}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(zp,{size:20,style:{color:"#f59e0b"}}),"Demo Mode"]}),e.jsx("div",{style:{padding:"1rem",background:i?.demoMode==="LIVE_DEMO"?"#fef3c7":"#d1fae5",borderRadius:"0.5rem",textAlign:"center",fontWeight:600,fontSize:"1.25rem"},children:i?.demoMode||"Unknown"}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>l.mutate("LIVE_DEMO"),disabled:l.isPending,children:"Seed Live Demo"}),e.jsx("button",{className:"btn btn-secondary",style:{flex:1},onClick:()=>l.mutate("FULLY_COMPLETED"),disabled:l.isPending,children:"Seed Completed"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Current Journey Status"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{children:["Order ",i?.mainJourney.order?.number||"-"]}),e.jsx("span",{className:"badge",style:{background:u(i?.mainJourney.order?.status||""),color:"white"},children:i?.mainJourney.order?.status||"N/A"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{children:["Shipment ",i?.mainJourney.shipment?.number||"-"]}),e.jsx("span",{className:"badge",style:{background:u(i?.mainJourney.shipment?.status||""),color:"white"},children:i?.mainJourney.shipment?.status||"N/A"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{children:["Invoice ",i?.mainJourney.invoice?.number||"-"]}),e.jsx("span",{className:"badge",style:{background:u(i?.mainJourney.invoice?.status||""),color:"white"},children:i?.mainJourney.invoice?.status||"N/A"})]}),i?.mainJourney.invoice&&e.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.5rem"},children:["Paid: SAR ",i.mainJourney.invoice.paidAmount.toLocaleString()," / Remaining: SAR ",i.mainJourney.invoice.remainingAmount.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{marginBottom:"1.5rem"},children:"Quick Demo Actions"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("button",{className:"btn",style:{padding:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",background:i?.availableActions.includes("mark-arrived")?"#3b82f6":"#e5e7eb",color:i?.availableActions.includes("mark-arrived")?"white":"#9ca3af",cursor:i?.availableActions.includes("mark-arrived")?"pointer":"not-allowed"},disabled:!i?.availableActions.includes("mark-arrived")||o.isPending,onClick:()=>o.mutate({action:"mark-arrived"}),children:[e.jsx(Rr,{size:32}),e.jsx("span",{style:{fontWeight:600},children:"Mark Arrived"}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Shipment arrives at destination"})]}),e.jsxs("button",{className:"btn",style:{padding:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",background:i?.availableActions.includes("mark-delivered")?"#22c55e":"#e5e7eb",color:i?.availableActions.includes("mark-delivered")?"white":"#9ca3af",cursor:i?.availableActions.includes("mark-delivered")?"pointer":"not-allowed"},disabled:!i?.availableActions.includes("mark-delivered")||o.isPending,onClick:()=>o.mutate({action:"mark-delivered"}),children:[e.jsx(dn,{size:32}),e.jsx("span",{style:{fontWeight:600},children:"Mark Delivered"}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Complete delivery with POD"})]}),e.jsxs("button",{className:"btn",style:{padding:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",background:i?.availableActions.includes("create-payment-request")?"#f59e0b":"#e5e7eb",color:i?.availableActions.includes("create-payment-request")?"white":"#9ca3af",cursor:i?.availableActions.includes("create-payment-request")?"pointer":"not-allowed"},disabled:!i?.availableActions.includes("create-payment-request")||o.isPending,onClick:()=>o.mutate({action:"create-payment-request",payload:{isPartial:!0}}),children:[e.jsx(Ul,{size:32}),e.jsx("span",{style:{fontWeight:600},children:"Submit Payment"}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Create partial payment request"})]}),e.jsxs("button",{className:"btn",style:{padding:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",background:i?.availableActions.includes("confirm-payment")?"#8b5cf6":"#e5e7eb",color:i?.availableActions.includes("confirm-payment")?"white":"#9ca3af",cursor:i?.availableActions.includes("confirm-payment")?"pointer":"not-allowed"},disabled:!i?.availableActions.includes("confirm-payment")||o.isPending,onClick:()=>o.mutate({action:"confirm-payment"}),children:[e.jsx(Ft,{size:32}),e.jsx("span",{style:{fontWeight:600},children:"Confirm Payment"}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Finance confirms & generates receipt"})]}),e.jsxs("button",{className:"btn",style:{padding:"1.5rem",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",background:i?.availableActions.includes("close-invoice")?"#6b7280":"#e5e7eb",color:i?.availableActions.includes("close-invoice")?"white":"#9ca3af",cursor:i?.availableActions.includes("close-invoice")?"pointer":"not-allowed"},disabled:!i?.availableActions.includes("close-invoice")||o.isPending,onClick:()=>o.mutate({action:"close-invoice"}),children:[e.jsx(Mp,{size:32}),e.jsx("span",{style:{fontWeight:600},children:"Close Invoice"}),e.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:"Archive paid invoice"})]})]})]}),e.jsxs("div",{className:"card",style:{marginTop:"1.5rem"},children:[e.jsxs("h3",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(dn,{size:20,style:{color:"#3b82f6"}}),"Logistics Demo Data"]}),e.jsx("p",{style:{marginBottom:"1rem",color:"#6b7280",fontSize:"0.875rem"},children:"Create shipments ready for driver assignment to test the logistics workflow."}),e.jsxs("button",{className:"btn btn-primary",style:{padding:"1rem 2rem",display:"flex",alignItems:"center",gap:"0.75rem"},disabled:o.isPending,onClick:()=>o.mutate({action:"create-logistics-shipments"}),children:[e.jsx(Rr,{size:20}),e.jsx("span",{style:{fontWeight:600},children:"Create Shipments for Driver Assignment"})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#eff6ff",borderRadius:"0.5rem",fontSize:"0.875rem"},children:[e.jsx("strong",{children:"This will create:"}),e.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.25rem",lineHeight:1.8},children:[e.jsx("li",{children:"3 shipments with PACKED status (ready for driver assignment)"}),e.jsx("li",{children:"Each with an associated order and realistic delivery address"}),e.jsx("li",{children:"One marked as URGENT priority"})]}),e.jsxs("div",{style:{marginTop:"0.75rem",color:"#1d4ed8"},children:["After creation, go to ",e.jsx("strong",{children:"Logistics  Shipments"})," to assign drivers."]})]})]}),e.jsxs("div",{className:"card",style:{marginTop:"1.5rem"},children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Demo Credentials"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.75rem",color:"#374151"},children:"Internal Users"}),e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:"1.75"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"admin@demo.com"})," - Admin"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"orderdesk@demo.com"})," - Order Desk"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"planner@demo.com"})," - Planner"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"qc@demo.com"})," - QC Analyst"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"qp@demo.com"})," - QP"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"logistics@demo.com"})," - Logistics"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"finance@demo.com"})," - Finance"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"driver1@demo.com"})," - Driver"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.75rem",color:"#374151"},children:"Customer Portal"}),e.jsxs("div",{style:{fontSize:"0.875rem",lineHeight:"1.75"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"portal1@hospitaldemo.com"})," - Al Noor Hospital"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"portal2@hospitaldemo.com"})," - Al Noor Hospital (Billing)"]})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#fef3c7",borderRadius:"0.5rem",fontSize:"0.875rem"},children:[e.jsx("strong",{children:"Password for all:"})," demo123"]})]})]})]})]})}const eAe=[{value:"",label:"All Statuses"},{value:"NEW",label:"New"},{value:"OPEN",label:"Open"},{value:"IN_PROGRESS",label:"In Progress"},{value:"WAITING_FOR_USER",label:"Waiting for User"},{value:"WAITING_FOR_ADMIN",label:"Waiting for Admin"},{value:"RESOLVED",label:"Resolved"},{value:"CLOSED",label:"Closed"}],tAe=[{value:"",label:"All Priorities"},{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"CRITICAL",label:"Critical"}],rAe=[{value:"",label:"All Categories"},{value:"ACCOUNT",label:"Account"},{value:"ORDER",label:"Order"},{value:"DELIVERY",label:"Delivery"},{value:"INVOICE",label:"Invoice"},{value:"PAYMENT",label:"Payment"},{value:"QC",label:"QC"},{value:"SYSTEM",label:"System"},{value:"OTHER",label:"Other"}],xM={NEW:{color:"var(--info)",bg:"var(--info-bg)",label:"New"},OPEN:{color:"var(--primary)",bg:"var(--primary-bg)",label:"Open"},IN_PROGRESS:{color:"var(--warning)",bg:"var(--warning-bg)",label:"In Progress"},WAITING_FOR_USER:{color:"var(--danger)",bg:"var(--danger-bg)",label:"Waiting"},WAITING_FOR_ADMIN:{color:"var(--info)",bg:"var(--info-bg)",label:"Pending"},RESOLVED:{color:"var(--success)",bg:"var(--success-bg)",label:"Resolved"},CLOSED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"Closed"},CANCELLED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"Cancelled"}},vM={LOW:{color:"var(--text-muted)",bg:"var(--bg-secondary)"},MEDIUM:{color:"var(--warning)",bg:"var(--warning-bg)"},HIGH:{color:"var(--danger)",bg:"var(--danger-bg)"},CRITICAL:{color:"white",bg:"var(--danger)"}},bM={ACCOUNT:{color:"var(--primary)",bg:"rgba(59, 130, 246, 0.1)"},ORDER:{color:"var(--success)",bg:"rgba(34, 197, 94, 0.1)"},DELIVERY:{color:"var(--warning)",bg:"rgba(234, 179, 8, 0.1)"},INVOICE:{color:"var(--info)",bg:"rgba(6, 182, 212, 0.1)"},PAYMENT:{color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.1)"},QC:{color:"#ec4899",bg:"rgba(236, 72, 153, 0.1)"},SYSTEM:{color:"var(--text-muted)",bg:"var(--bg-secondary)"},OTHER:{color:"var(--text-muted)",bg:"var(--bg-secondary)"}};function nAe(){const t=Gr(),[r,n]=k.useState(""),[i,a]=k.useState(""),[s,o]=k.useState(""),[l,u]=k.useState(""),[d,f]=k.useState(null),{data:p,isLoading:x}=Ve({queryKey:["admin-tickets",r,i,s,l],queryFn:async()=>{const D={limit:100};r&&(D.status=r),i&&(D.priority=i),s&&(D.category=s),l&&(D.search=l);const{data:M}=await xe.get("/helpdesk/admin/tickets",{params:D});return M}}),v=p?.tickets||[],w=p?.stats||{new:0,open:0,slaBreached:0,unassigned:0},C=v,A=D=>bM[D]||bM.OTHER,T=D=>xM[D]||xM.NEW,O=D=>vM[D]||vM.MEDIUM;return x?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Support Tickets"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage customer support requests and inquiries"})]}),e.jsxs(nr,{to:"/admin/helpdesk/tasks",className:"btn",children:[e.jsx(Fg,{size:16})," View Tasks"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"New Tickets",value:w.new,icon:e.jsx(Sm,{size:20}),color:"info",onClick:()=>{n("NEW")},selected:r==="NEW"}),e.jsx(nt,{title:"Open Tickets",value:w.open,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>{n(""),a("")},selected:!r&&!i}),e.jsx(nt,{title:"SLA Breached",value:w.slaBreached,icon:e.jsx(Hr,{size:20}),color:"danger"}),e.jsx(nt,{title:"Unassigned",value:w.unassigned,icon:e.jsx(Uo,{size:20}),color:"primary"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem",padding:"0.75rem 1rem",background:"var(--bg-primary)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsx(Wo,{size:16,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Filters:"}),e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"280px"},children:[e.jsx(Gs,{size:14,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by subject, ticket number...",value:l,onChange:D=>u(D.target.value),className:"form-input",style:{paddingLeft:"2rem",fontSize:"0.875rem",height:"36px"}})]}),e.jsx("select",{className:"form-input",value:r,onChange:D=>n(D.target.value),style:{width:"auto",fontSize:"0.875rem",height:"36px"},children:eAe.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))}),e.jsx("select",{className:"form-input",value:i,onChange:D=>a(D.target.value),style:{width:"auto",fontSize:"0.875rem",height:"36px"},children:tAe.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))}),e.jsx("select",{className:"form-input",value:s,onChange:D=>o(D.target.value),style:{width:"auto",fontSize:"0.875rem",height:"36px"},children:rAe.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:d?"1fr 340px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{children:C.length===0?e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{icon:"file",title:"No tickets found",message:"Try adjusting your filters or wait for new support requests"})}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:C.map(D=>{const M=A(D.category),Q=T(D.status),U=O(D.priority),$=D.slaResponseDueAt&&new Date(D.slaResponseDueAt)<new Date&&!D.slaResponseMet||D.slaResolveDueAt&&new Date(D.slaResolveDueAt)<new Date&&!D.slaResolveMet&&!["RESOLVED","CLOSED","CANCELLED"].includes(D.status);return e.jsxs("div",{className:"card",onClick:()=>f(D),style:{padding:"1rem",cursor:"pointer",border:d?.id===D.id?"2px solid var(--primary)":"1px solid var(--border)",transition:"all 0.15s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:M.bg,color:M.color,fontWeight:600},children:D.category}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:ee=>{ee.stopPropagation(),t(`/admin/helpdesk/tickets/${D.id}`)},style:{padding:"0.25rem 0.5rem"},children:e.jsx(ma,{size:14})})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"0.9375rem"},children:D.subject}),e.jsxs("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontFamily:"monospace"},children:D.ticketNo}),"  ",D.requesterUser?.firstName," ",D.requesterUser?.lastName]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.8125rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(t2,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["Messages: ",D._count?.messages||0]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Fg,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["Tasks: ",D._count?.tasks||0]})]})]}),e.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("span",{className:"badge",style:{background:Q.bg,color:Q.color,fontSize:"0.6875rem"},children:Q.label}),e.jsx("span",{className:"badge",style:{background:U.bg,color:U.color,fontSize:"0.6875rem"},children:D.priority}),$&&e.jsx("span",{title:"SLA Breached",children:e.jsx(Hr,{size:14,style:{color:"var(--danger)"}})})]}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:Ze(new Date(D.lastActivityAt),"MMM d")})]})]},D.id)})})}),d&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",background:A(d.category).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:A(d.category).color,color:"white",marginBottom:"0.5rem"},children:d.category}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:"0.5rem 0 0.25rem"},children:d.subject}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",margin:0},children:d.ticketNo})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>f(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:""})]})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Requester"}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center"},children:[e.jsxs("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)",fontWeight:600},children:[d.requesterUser?.firstName?.[0],d.requesterUser?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:[d.requesterUser?.firstName," ",d.requesterUser?.lastName]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:d.requesterUser?.email})]})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Ticket Info"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Status"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem",color:T(d.status).color},children:T(d.status).label})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Priority"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem"},children:d.priority})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Team"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem"},children:d.assignedTeam||"Unassigned"})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Assignee"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem"},children:d.assignedToUser?d.assignedToUser.firstName:"Unassigned"})]})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Activity"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.8125rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),e.jsx("span",{children:Ze(new Date(d.createdAt),"MMM d, yyyy")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Last Activity"}),e.jsx("span",{children:Ze(new Date(d.lastActivityAt),"MMM d, h:mm a")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Messages"}),e.jsx("span",{children:d._count?.messages||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Tasks"}),e.jsx("span",{children:d._count?.tasks||0})]})]})]}),e.jsx(nr,{to:`/admin/helpdesk/tickets/${d.id}`,className:"btn btn-primary",style:{width:"100%",justifyContent:"center"},children:"Open Ticket"})]})]})]})]})}const iAe=[{value:"",label:"All Statuses"},{value:"TODO",label:"To Do"},{value:"IN_PROGRESS",label:"In Progress"},{value:"DONE",label:"Done"},{value:"BLOCKED",label:"Blocked"}],aAe=[{value:"",label:"All Priorities"},{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"CRITICAL",label:"Critical"}],jM={TODO:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"To Do"},IN_PROGRESS:{color:"var(--warning)",bg:"var(--warning-bg)",label:"In Progress"},DONE:{color:"var(--success)",bg:"var(--success-bg)",label:"Done"},BLOCKED:{color:"var(--danger)",bg:"var(--danger-bg)",label:"Blocked"}},wM={LOW:{color:"var(--text-muted)",bg:"var(--bg-secondary)"},MEDIUM:{color:"var(--warning)",bg:"var(--warning-bg)"},HIGH:{color:"var(--danger)",bg:"var(--danger-bg)"},CRITICAL:{color:"white",bg:"var(--danger)"}};function sAe(){const t=Gr(),r=pr(),[n,i]=k.useState(""),[a,s]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(null),{data:x,isLoading:v}=Ve({queryKey:["admin-tasks",n,o],queryFn:async()=>{const U={limit:100};n&&(U.status=n),o&&(U.assignedTo=o);const{data:$}=await xe.get("/helpdesk/admin/tasks",{params:U});return $}}),{data:w}=Ve({queryKey:["support-users"],queryFn:async()=>{const{data:U}=await xe.get("/helpdesk/admin/support-users");return U}}),C=ot({mutationFn:async({taskId:U,updates:$})=>{const{data:ee}=await xe.patch(`/helpdesk/admin/tasks/${U}`,$);return ee},onSuccess:()=>{r.invalidateQueries({queryKey:["admin-tasks"]}),f&&p(U=>({...U,...C.variables?.updates}))}}),A=x?.tasks||[],T=A.filter(U=>{if(a&&U.priority!==a)return!1;if(u){const $=u.toLowerCase();return U.title.toLowerCase().includes($)||U.ticket?.ticketNo?.toLowerCase().includes($)||U.ticket?.subject?.toLowerCase().includes($)}return!0}),O={total:A.length,todo:A.filter(U=>U.status==="TODO").length,inProgress:A.filter(U=>U.status==="IN_PROGRESS").length,done:A.filter(U=>U.status==="DONE").length},D=U=>jM[U]||jM.TODO,M=U=>wM[U]||wM.MEDIUM,Q=U=>U.dueAt?new Date(U.dueAt)<new Date&&U.status!=="DONE":!1;return v?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(nr,{to:"/admin/helpdesk",className:"btn btn-secondary btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Helpdesk Tasks"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage all tasks across support tickets"})]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Tasks",value:O.total,icon:e.jsx(Fg,{size:20}),color:"primary",onClick:()=>i(""),selected:!n}),e.jsx(nt,{title:"To Do",value:O.todo,icon:e.jsx(Qt,{size:20}),color:"info",onClick:()=>i("TODO"),selected:n==="TODO"}),e.jsx(nt,{title:"In Progress",value:O.inProgress,icon:e.jsx(sn,{size:20}),color:"warning",onClick:()=>i("IN_PROGRESS"),selected:n==="IN_PROGRESS"}),e.jsx(nt,{title:"Completed",value:O.done,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>i("DONE"),selected:n==="DONE"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem",padding:"0.75rem 1rem",background:"var(--bg-primary)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsx(Wo,{size:16,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Filters:"}),e.jsxs("div",{style:{position:"relative",flex:"1",maxWidth:"280px"},children:[e.jsx(Gs,{size:14,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by title, ticket...",value:u,onChange:U=>d(U.target.value),className:"form-input",style:{paddingLeft:"2rem",fontSize:"0.875rem",height:"36px"}})]}),e.jsx("select",{className:"form-input",value:n,onChange:U=>i(U.target.value),style:{width:"auto",fontSize:"0.875rem",height:"36px"},children:iAe.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsx("select",{className:"form-input",value:a,onChange:U=>s(U.target.value),style:{width:"auto",fontSize:"0.875rem",height:"36px"},children:aAe.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsxs("select",{className:"form-input",value:o,onChange:U=>l(U.target.value),style:{width:"auto",fontSize:"0.875rem",height:"36px"},children:[e.jsx("option",{value:"",children:"All Assignees"}),w?.map(U=>e.jsxs("option",{value:U.id,children:[U.firstName," ",U.lastName]},U.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 340px":"1fr",gap:"1.5rem"},children:[e.jsx("div",{children:T.length===0?e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{icon:"file",title:"No tasks found",message:"Try adjusting your filters or create tasks from tickets"})}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:T.map(U=>{const $=D(U.status),ee=M(U.priority),F=Q(U);return e.jsxs("div",{className:"card",onClick:()=>p(U),style:{padding:"1rem",cursor:"pointer",border:f?.id===U.id?"2px solid var(--primary)":"1px solid var(--border)",background:U.status==="DONE"?"var(--success-bg)":F?"rgba(220, 38, 38, 0.03)":"var(--bg-primary)",transition:"all 0.15s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:$.bg,color:$.color,fontWeight:600},children:$.label}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:Y=>{Y.stopPropagation(),t(`/admin/helpdesk/tickets/${U.ticket?.id}`)},style:{padding:"0.25rem 0.5rem"},children:e.jsx(ma,{size:14})})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"0.9375rem",textDecoration:U.status==="DONE"?"line-through":"none",opacity:U.status==="DONE"?.7:1},children:U.title}),e.jsxs("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontFamily:"monospace"},children:U.ticket?.ticketNo}),"  ",U.ticket?.subject?.substring(0,30),U.ticket?.subject?.length>30?"...":""]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.8125rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Uo,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:U.assignedToUser?.firstName||"Unassigned"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",color:F?"var(--danger)":"inherit"},children:[e.jsx($n,{size:14,style:{color:F?"var(--danger)":"var(--text-muted)"}}),e.jsx("span",{children:U.dueAt?Ze(new Date(U.dueAt),"MMM d"):"No due date"})]})]}),e.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{className:"badge",style:{background:ee.bg,color:ee.color,fontSize:"0.6875rem"},children:U.priority}),F&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--danger)",fontWeight:500},children:"Overdue"})]})]},U.id)})})}),f&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",background:D(f.status).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:D(f.status).color,color:"white",marginBottom:"0.5rem"},children:D(f.status).label}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:"0.5rem 0 0.25rem"},children:f.title})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>p(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Related Ticket"}),e.jsxs(nr,{to:`/admin/helpdesk/tickets/${f.ticket?.id}`,style:{display:"block",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",textDecoration:"none",color:"inherit"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem",marginBottom:"0.25rem"},children:f.ticket?.ticketNo}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:f.ticket?.subject})]})]}),f.description&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Description"}),e.jsx("p",{style:{fontSize:"0.875rem",margin:0,lineHeight:1.5},children:f.description})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Task Info"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Priority"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem"},children:f.priority})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Assignee"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem"},children:f.assignedToUser?.firstName||"Unassigned"})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Due Date"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem",color:Q(f)?"var(--danger)":"inherit"},children:f.dueAt?Ze(new Date(f.dueAt),"MMM d, yyyy"):"Not set"})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.125rem"},children:"Created"}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.8125rem"},children:Ze(new Date(f.createdAt),"MMM d")})]})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Update Status"}),e.jsxs("select",{className:"form-input",value:f.status,onChange:U=>C.mutate({taskId:f.id,updates:{status:U.target.value}}),style:{width:"100%",fontSize:"0.875rem"},children:[e.jsx("option",{value:"TODO",children:"To Do"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"DONE",children:"Done"}),e.jsx("option",{value:"BLOCKED",children:"Blocked"})]})]}),e.jsx(nr,{to:`/admin/helpdesk/tickets/${f.ticket?.id}`,className:"btn btn-primary",style:{width:"100%",justifyContent:"center"},children:"View Ticket"})]})]})]})]})}const SM={NEW:{color:"var(--info)",bg:"var(--info-bg)",label:"New"},OPEN:{color:"var(--primary)",bg:"var(--primary-bg)",label:"Open"},IN_PROGRESS:{color:"var(--warning)",bg:"var(--warning-bg)",label:"In Progress"},WAITING_FOR_USER:{color:"var(--danger)",bg:"var(--danger-bg)",label:"Waiting for User"},WAITING_FOR_ADMIN:{color:"var(--info)",bg:"var(--info-bg)",label:"Waiting for Admin"},RESOLVED:{color:"var(--success)",bg:"var(--success-bg)",label:"Resolved"},CLOSED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"Closed"},CANCELLED:{color:"var(--text-muted)",bg:"var(--bg-secondary)",label:"Cancelled"}},CM={LOW:{color:"var(--text-muted)",bg:"var(--bg-secondary)"},MEDIUM:{color:"var(--warning)",bg:"var(--warning-bg)"},HIGH:{color:"var(--danger)",bg:"var(--danger-bg)"},CRITICAL:{color:"white",bg:"var(--danger)"}},oAe=["NEW","OPEN","IN_PROGRESS","WAITING_FOR_USER","WAITING_FOR_ADMIN","RESOLVED","CLOSED","CANCELLED"],NM=["LOW","MEDIUM","HIGH","CRITICAL"],lAe=["SUPPORT","FINANCE","LOGISTICS","QC","IT"];function cAe(){const{id:t}=fl(),{user:r}=Il(),n=pr(),[i,a]=k.useState("conversation"),[s,o]=k.useState(""),[l,u]=k.useState(!1),[d,f]=k.useState(!1),[p,x]=k.useState({title:"",description:"",priority:"MEDIUM",assignedToUserId:"",dueAt:""}),{data:v,isLoading:w,error:C}=Ve({queryKey:["admin-ticket",t],queryFn:async()=>{const{data:Y}=await xe.get(`/helpdesk/admin/tickets/${t}`);return Y},enabled:!!t}),{data:A}=Ve({queryKey:["support-users"],queryFn:async()=>{const{data:Y}=await xe.get("/helpdesk/admin/support-users");return Y}}),T=ot({mutationFn:async Y=>{const{data:J}=await xe.patch(`/helpdesk/admin/tickets/${t}`,Y);return J},onSuccess:()=>{n.invalidateQueries({queryKey:["admin-ticket",t]}),n.invalidateQueries({queryKey:["admin-tickets"]})}}),O=ot({mutationFn:async({body:Y,isInternal:J})=>{const Z=J?`/helpdesk/admin/tickets/${t}/internal-note`:`/helpdesk/admin/tickets/${t}/reply`,{data:re}=await xe.post(Z,{body:Y});return re},onSuccess:()=>{o(""),n.invalidateQueries({queryKey:["admin-ticket",t]})}}),D=ot({mutationFn:async Y=>{const{data:J}=await xe.post(`/helpdesk/admin/tickets/${t}/tasks`,Y);return J},onSuccess:()=>{f(!1),x({title:"",description:"",priority:"MEDIUM",assignedToUserId:"",dueAt:""}),n.invalidateQueries({queryKey:["admin-ticket",t]})}}),M=ot({mutationFn:async({taskId:Y,updates:J})=>{const{data:Z}=await xe.patch(`/helpdesk/admin/tasks/${Y}`,J);return Z},onSuccess:()=>{n.invalidateQueries({queryKey:["admin-ticket",t]})}}),Q=Y=>{Y.preventDefault(),s.trim()&&O.mutate({body:s,isInternal:l})},U=Y=>{Y.preventDefault(),p.title.trim()&&D.mutate(p)};if(w)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(C||!v)return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs(nr,{to:"/admin/helpdesk",className:"btn btn-secondary btn-sm",style:{marginBottom:"1rem"},children:[e.jsx(sa,{size:16})," Back to Tickets"]}),e.jsxs("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:[e.jsx(sn,{size:48,style:{color:"var(--danger)",marginBottom:"1rem"}}),e.jsx("h2",{children:"Ticket not found"})]})]});const $=SM[v.status]||SM.NEW,ee=CM[v.priority]||CM.MEDIUM,F=!["CLOSED","CANCELLED"].includes(v.status);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nr,{to:"/admin/helpdesk",className:"btn btn-secondary btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:v.ticketNo}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:v.subject})]}),e.jsx("span",{className:"badge",style:{background:$.bg,color:$.color,fontWeight:500,padding:"0.5rem 1rem"},children:$.label}),e.jsx("span",{className:"badge",style:{background:ee.bg,color:ee.color,fontWeight:500,padding:"0.5rem 1rem"},children:v.priority})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"1.5rem"},children:[e.jsx("div",{children:e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{display:"flex",borderBottom:"1px solid var(--border)"},children:[{key:"conversation",label:"Conversation",icon:t2,count:v.messages?.length||0},{key:"tasks",label:"Tasks",icon:Fg,count:v.tasks?.length||0}].map(Y=>e.jsxs("button",{onClick:()=>a(Y.key),style:{padding:"1rem 1.5rem",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",borderBottom:i===Y.key?"2px solid var(--primary)":"2px solid transparent",color:i===Y.key?"var(--primary)":"var(--text-secondary)",fontWeight:i===Y.key?600:400},children:[e.jsx(Y.icon,{size:16}),Y.label,Y.count>0&&e.jsx("span",{className:"badge badge-primary",style:{fontSize:"0.7rem"},children:Y.count})]},Y.key))}),e.jsxs("div",{style:{padding:"1.5rem"},children:[i==="conversation"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1.5rem",paddingBottom:"1.5rem",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--primary)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:600},children:[v.requesterUser?.firstName?.[0],v.requesterUser?.lastName?.[0]]}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:600},children:[v.requesterUser?.firstName," ",v.requesterUser?.lastName]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:Ze(new Date(v.createdAt),"MMM d, yyyy h:mm a")})]})]}),e.jsx("div",{style:{marginLeft:"52px",whiteSpace:"pre-wrap",lineHeight:1.6},children:v.description})]}),v.messages?.map(Y=>{const J=Y.visibility==="INTERNAL";return e.jsxs("div",{style:{marginBottom:"1.5rem",paddingBottom:"1.5rem",borderBottom:"1px solid var(--border)",background:J?"var(--warning-bg)":"transparent",padding:J?"1rem":"0 0 1.5rem 0",borderRadius:J?"8px":0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:J?"var(--warning)":"var(--success)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:600},children:[Y.createdByUser?.firstName?.[0],Y.createdByUser?.lastName?.[0]]}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("span",{style:{fontWeight:600},children:[Y.createdByUser?.firstName," ",Y.createdByUser?.lastName]}),J&&e.jsx("span",{className:"badge",style:{background:"var(--warning)",color:"white",fontSize:"0.65rem"},children:"Internal"})]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:Ze(new Date(Y.createdAt),"MMM d, yyyy h:mm a")})]})]}),e.jsx("div",{style:{marginLeft:"52px",whiteSpace:"pre-wrap",lineHeight:1.6},children:Y.body})]},Y.id)}),F&&e.jsxs("form",{onSubmit:Q,style:{marginTop:"1rem"},children:[e.jsxs("div",{style:{marginBottom:"0.75rem",display:"flex",gap:"1.5rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("input",{type:"radio",checked:!l,onChange:()=>u(!1)}),e.jsx(os,{size:14})," Public Reply"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("input",{type:"radio",checked:l,onChange:()=>u(!0)}),e.jsx(Eg,{size:14})," Internal Note"]})]}),e.jsx("textarea",{className:"form-input",rows:4,placeholder:l?"Add an internal note...":"Type your reply...",value:s,onChange:Y=>o(Y.target.value),style:{resize:"vertical",background:l?"var(--warning-bg)":void 0}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"0.75rem"},children:e.jsxs("button",{type:"submit",className:`btn ${l?"btn-warning":"btn-primary"}`,disabled:!s.trim()||O.isPending,children:[e.jsx(Qi,{size:16}),O.isPending?"Sending...":l?"Add Note":"Send Reply"]})})]})]}),i==="tasks"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1rem"},children:"Tasks"}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>f(!0),children:[e.jsx(cn,{size:14})," Add Task"]})]}),d&&e.jsx("form",{onSubmit:U,style:{padding:"1rem",marginBottom:"1rem",background:"var(--bg-secondary)",borderRadius:"8px"},children:e.jsxs("div",{style:{display:"grid",gap:"0.75rem"},children:[e.jsx("input",{type:"text",className:"form-input",placeholder:"Task title",value:p.title,onChange:Y=>x({...p,title:Y.target.value})}),e.jsx("textarea",{className:"form-input",placeholder:"Description",rows:2,value:p.description,onChange:Y=>x({...p,description:Y.target.value})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem"},children:[e.jsx("select",{className:"form-input",value:p.priority,onChange:Y=>x({...p,priority:Y.target.value}),children:NM.map(Y=>e.jsx("option",{value:Y,children:Y},Y))}),e.jsxs("select",{className:"form-input",value:p.assignedToUserId,onChange:Y=>x({...p,assignedToUserId:Y.target.value}),children:[e.jsx("option",{value:"",children:"Unassigned"}),A?.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.firstName," ",Y.lastName]},Y.id))]}),e.jsx("input",{type:"date",className:"form-input",value:p.dueAt,onChange:Y=>x({...p,dueAt:Y.target.value})})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:D.isPending,children:"Create"})]})]})}),v.tasks?.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:[e.jsx(Fg,{size:32,style:{opacity:.5,marginBottom:"0.5rem"}}),e.jsx("p",{children:"No tasks yet"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:v.tasks?.map(Y=>e.jsx("div",{style:{padding:"1rem",border:"1px solid var(--border)",borderRadius:"8px",background:Y.status==="DONE"?"var(--success-bg)":"var(--bg-primary)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,textDecoration:Y.status==="DONE"?"line-through":"none"},children:Y.title}),Y.description&&e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:Y.description}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[Y.assignedToUser&&e.jsxs("span",{children:[e.jsx(Uo,{size:12})," ",Y.assignedToUser.firstName]}),Y.dueAt&&e.jsxs("span",{children:[e.jsx(Qt,{size:12})," ",Ze(new Date(Y.dueAt),"MMM d")]})]})]}),e.jsxs("select",{className:"form-input",value:Y.status,onChange:J=>M.mutate({taskId:Y.id,updates:{status:J.target.value}}),style:{width:"auto",fontSize:"0.75rem",padding:"0.25rem"},children:[e.jsx("option",{value:"TODO",children:"To Do"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"DONE",children:"Done"}),e.jsx("option",{value:"BLOCKED",children:"Blocked"})]})]})},Y.id))})]})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{padding:0,marginBottom:"1rem"},children:[e.jsx("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border)",background:$.bg},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Sm,{size:18,style:{color:$.color}}),e.jsx("span",{style:{fontWeight:600},children:v.ticketNo})]})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Requester"}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)",fontWeight:600,fontSize:"1rem"},children:[v.requesterUser?.firstName?.[0],v.requesterUser?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:"0.125rem"},children:[v.requesterUser?.firstName," ",v.requesterUser?.lastName]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:v.requesterUser?.email}),v.customer&&e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:[e.jsx(Ts,{size:12,style:{marginRight:"0.25rem"}}),v.customer.name]})]})]}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Ticket Properties"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},children:[e.jsx(nz,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Category"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:v.category})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},children:[e.jsx(ZY,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Priority"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:v.priority})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},children:[e.jsx(dc,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Team"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:v.assignedTeam||"Unassigned"})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},children:[e.jsx(WC,{size:12,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Assignee"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.875rem"},children:v.assignedToUser?v.assignedToUser.firstName:"Unassigned"})]})]}),e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Dates"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.8rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),e.jsx("span",{children:Ze(new Date(v.createdAt),"MMM d, yyyy")})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Last Activity"}),e.jsx("span",{children:Ze(new Date(v.lastActivityAt),"MMM d, h:mm a")})]})]}),(v.slaResponseDueAt||v.slaResolveDueAt)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"SLA"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.8rem",marginBottom:"1rem"},children:[v.slaResponseDueAt&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Response"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:v.slaResponseMet===!1?"var(--danger)":v.slaResponseMet?"var(--success)":"inherit"},children:[Ze(new Date(v.slaResponseDueAt),"MMM d"),v.slaResponseMet===!0&&e.jsx(Ft,{size:12}),v.slaResponseMet===!1&&e.jsx(sn,{size:12})]})]}),v.slaResolveDueAt&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Resolve"}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:v.slaResolveMet===!1?"var(--danger)":v.slaResolveMet?"var(--success)":"inherit"},children:[Ze(new Date(v.slaResolveDueAt),"MMM d"),v.slaResolveMet===!0&&e.jsx(Ft,{size:12}),v.slaResolveMet===!1&&e.jsx(sn,{size:12})]})]})]})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Update Ticket"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"0.25rem"},children:"Status"}),e.jsx("select",{className:"form-input",value:v.status,onChange:Y=>T.mutate({status:Y.target.value}),disabled:T.isPending,style:{fontSize:"0.875rem"},children:oAe.map(Y=>e.jsx("option",{value:Y,children:Y.replace(/_/g," ")},Y))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"0.25rem"},children:"Priority"}),e.jsx("select",{className:"form-input",value:v.priority,onChange:Y=>T.mutate({priority:Y.target.value}),disabled:T.isPending,style:{fontSize:"0.875rem"},children:NM.map(Y=>e.jsx("option",{value:Y,children:Y},Y))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"0.25rem"},children:"Assigned To"}),e.jsxs("select",{className:"form-input",value:v.assignedToUserId||"",onChange:Y=>T.mutate({assignedToUserId:Y.target.value||null}),disabled:T.isPending,style:{fontSize:"0.875rem"},children:[e.jsx("option",{value:"",children:"Unassigned"}),A?.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.firstName," ",Y.lastName]},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:"0.75rem",color:"var(--text-muted)",display:"block",marginBottom:"0.25rem"},children:"Team"}),e.jsxs("select",{className:"form-input",value:v.assignedTeam||"",onChange:Y=>T.mutate({assignedTeam:Y.target.value||null}),disabled:T.isPending,style:{fontSize:"0.875rem"},children:[e.jsx("option",{value:"",children:"No Team"}),lAe.map(Y=>e.jsx("option",{value:Y,children:Y},Y))]})]})]})]})]})]})]})}function dAe(){const[t,r]=k.useState(!1),[n,i]=k.useState(null),[a,s]=k.useState(""),[o,l]=k.useState(""),u=pr(),d=gn(),{data:f,isLoading:p}=Ve({queryKey:["drivers",a,o],queryFn:async()=>{const T={};a&&(T.search=a),o&&(T.status=o);const{data:O}=await xe.get("/drivers",{params:T});return O}}),x=ot({mutationFn:async T=>xe.post("/drivers",T),onSuccess:()=>{u.invalidateQueries({queryKey:["drivers"]}),r(!1),i(null),d.success("Driver Created","New driver has been added successfully")},onError:T=>{const O=an(T);d.error("Creation Failed",O?.userMessage||"Failed to create driver")}}),v=ot({mutationFn:async({id:T,data:O})=>xe.put(`/drivers/${T}`,O),onSuccess:()=>{u.invalidateQueries({queryKey:["drivers"]}),r(!1),i(null),d.success("Driver Updated","Driver information has been updated")},onError:T=>{const O=an(T);d.error("Update Failed",O?.userMessage||"Failed to update driver")}}),w=ot({mutationFn:async T=>xe.delete(`/drivers/${T}`),onSuccess:()=>{u.invalidateQueries({queryKey:["drivers"]}),d.success("Driver Removed","Driver has been removed or deactivated")},onError:T=>{const O=an(T);d.error("Delete Failed",O?.userMessage||"Failed to remove driver")}}),C=T=>{T.preventDefault();const O=new FormData(T.currentTarget),D={fullName:O.get("fullName"),mobile:O.get("mobile"),email:O.get("email")||null,nationalId:O.get("nationalId")||null,driverLicenseNo:O.get("driverLicenseNo")||null,licenseExpiryDate:O.get("licenseExpiryDate")||null,vehicleType:O.get("vehicleType"),vehiclePlateNo:O.get("vehiclePlateNo")||null,vehicleModel:O.get("vehicleModel")||null,status:O.get("status")||"ACTIVE",createUserAccount:O.get("createUserAccount")==="on",userPassword:O.get("userPassword")||null};n?v.mutate({id:n.id,data:D}):x.mutate(D)},A={total:f?.length||0,active:f?.filter(T=>T.status==="ACTIVE").length||0,inactive:f?.filter(T=>T.status==="INACTIVE").length||0,onRoute:f?.filter(T=>T.inTransit>0).length||0};return p?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Driver Management"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage delivery drivers, vehicles, and availability"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{i(null),r(!0)},children:[e.jsx(cn,{size:16}),"Add Driver"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Drivers",value:A.total,icon:e.jsx(Uo,{size:20}),color:"primary",onClick:()=>l(""),selected:!o}),e.jsx(nt,{title:"Active",value:A.active,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>l("ACTIVE"),selected:o==="ACTIVE"}),e.jsx(nt,{title:"Inactive",value:A.inactive,icon:e.jsx(ri,{size:20}),color:"default",onClick:()=>l("INACTIVE"),selected:o==="INACTIVE"}),e.jsx(nt,{title:"On Route",value:A.onRoute,icon:e.jsx(dn,{size:20}),color:"info"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:1},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by name, mobile, email, or plate number...",className:"form-input",style:{paddingLeft:"2.25rem"},value:a,onChange:T=>s(T.target.value)})]}),e.jsxs("select",{className:"form-select",style:{width:"150px"},value:o,onChange:T=>l(T.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Drivers (",f?.length||0,")"]})}),f?.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Driver"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Vehicle"}),e.jsx("th",{children:"Workload"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:f.map(T=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)",fontWeight:600},children:T.fullName.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:T.fullName}),T.driverLicenseNo&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["License: ",T.driverLicenseNo]})]})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(vo,{size:12}),T.mobile]}),T.email&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx(uc,{size:12}),T.email]})]})}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ZL,{size:14}),T.vehicleType]}),T.vehiclePlateNo&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[T.vehiclePlateNo," ",T.vehicleModel&&` ${T.vehicleModel}`]})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[T.inTransit>0?e.jsxs("span",{className:"badge badge-info",children:[T.inTransit," in transit"]}):e.jsx("span",{className:"badge badge-default",children:"Available"}),T.assignedToday>0&&e.jsxs("span",{className:"badge badge-warning",children:[T.assignedToday," today"]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${T.status==="ACTIVE"?"badge-success":"badge-default"}`,children:T.status})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>{i(T),r(!0)},title:"Edit",children:e.jsx(t0,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-outline",style:{color:"var(--danger)"},onClick:()=>{confirm(`Are you sure you want to ${T._count?.shipments>0?"deactivate":"delete"} this driver?`)&&w.mutate(T.id)},title:"Remove",children:e.jsx(Gi,{size:14})})]})})]},T.id))})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No drivers found",message:"Add your first driver to start assigning shipments",icon:"user"})})]}),t&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"600px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:n?"Edit Driver":"Add Driver"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>{r(!1),i(null)},children:""})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:2},children:[e.jsx("label",{className:"form-label",children:"Full Name *"}),e.jsx("input",{type:"text",name:"fullName",className:"form-input",required:!0,defaultValue:n?.fullName||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{name:"status",className:"form-select",defaultValue:n?.status||"ACTIVE",children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Mobile *"}),e.jsx("input",{type:"tel",name:"mobile",className:"form-input",required:!0,placeholder:"+966 5xx xxx xxxx",defaultValue:n?.mobile||""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:"form-input",defaultValue:n?.email||""})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"National ID / Iqama"}),e.jsx("input",{type:"text",name:"nationalId",className:"form-input",defaultValue:n?.nationalId||""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Driver License No"}),e.jsx("input",{type:"text",name:"driverLicenseNo",className:"form-input",defaultValue:n?.driverLicenseNo||""})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"License Expiry Date"}),e.jsx("input",{type:"date",name:"licenseExpiryDate",className:"form-input",defaultValue:n?.licenseExpiryDate?Ze(new Date(n.licenseExpiryDate),"yyyy-MM-dd"):""})]}),e.jsxs("div",{style:{borderTop:"1px solid var(--border)",margin:"1rem 0",paddingTop:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem"},children:"Vehicle Information"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Type"}),e.jsxs("select",{name:"vehicleType",className:"form-select",defaultValue:n?.vehicleType||"CAR",children:[e.jsx("option",{value:"CAR",children:"Car"}),e.jsx("option",{value:"VAN",children:"Van"}),e.jsx("option",{value:"MOTORCYCLE",children:"Motorcycle"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Plate Number"}),e.jsx("input",{type:"text",name:"vehiclePlateNo",className:"form-input",placeholder:"ABC 1234",defaultValue:n?.vehiclePlateNo||""})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Vehicle Model"}),e.jsx("input",{type:"text",name:"vehicleModel",className:"form-input",placeholder:"e.g., Toyota Hilux 2023",defaultValue:n?.vehicleModel||""})]})]}),!n&&e.jsxs("div",{style:{borderTop:"1px solid var(--border)",margin:"1rem 0",paddingTop:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem"},children:"Portal Access"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",name:"createUserAccount"}),e.jsx("span",{children:"Create user account for driver portal access"})]}),e.jsxs("div",{className:"form-group",style:{marginTop:"0.75rem"},children:[e.jsx("label",{className:"form-label",children:"Initial Password"}),e.jsx("input",{type:"password",name:"userPassword",className:"form-input",placeholder:"Leave empty for default: driver123"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{r(!1),i(null)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x.isPending||v.isPending,children:x.isPending||v.isPending?"Saving...":n?"Update Driver":"Add Driver"})]})]})]})})]})}const mA=[{status:"PACKED",label:"Packed",icon:Rr},{status:"ASSIGNED_TO_DRIVER",label:"Assigned",icon:Np},{status:"ACCEPTED_BY_DRIVER",label:"Accepted",icon:Ft},{status:"PICKED_UP",label:"Picked Up",icon:dn},{status:"IN_TRANSIT",label:"In Transit",icon:Qi},{status:"ARRIVED",label:"Arrived",icon:_a},{status:"DELIVERED",label:"Delivered",icon:Ft}],uAe=mA.map(t=>t.status);function hAe(){const{id:t}=fl(),[r,n]=k.useState(!1),i=pr(),a=gn(),{data:s,isLoading:o}=Ve({queryKey:["shipment",t],queryFn:async()=>{const{data:v}=await xe.get(`/shipments/${t}`);return v},enabled:!!t}),{data:l}=Ve({queryKey:["drivers"],queryFn:async()=>{const{data:v}=await xe.get("/drivers");return v}}),u=ot({mutationFn:async v=>xe.post(`/shipments/${t}/assign-driver`,v),onSuccess:()=>{i.invalidateQueries({queryKey:["shipment",t]}),n(!1),a.success("Driver Assigned","Driver has been assigned to the shipment")},onError:v=>{const w=an(v);a.error("Assignment Failed",w?.userMessage||"Failed to assign driver")}}),d=v=>{v.preventDefault();const w=new FormData(v.currentTarget);u.mutate({driverId:w.get("driverId"),scheduledPickupAt:w.get("scheduledPickupAt"),scheduledDeliveryAt:w.get("scheduledDeliveryAt"),driverNotes:w.get("driverNotes")})},f=()=>!s||["DELIVERY_FAILED","RETURNED","CANCELLED","DELAYED"].includes(s.status)?-1:uAe.indexOf(s.status),p=v=>({PACKED:Rr,ASSIGNED_TO_DRIVER:Np,ACCEPTED:Ft,PICKED_UP:dn,IN_TRANSIT:Qi,ARRIVED:_a,DELIVERED:Ft,DELIVERY_FAILED:Hr,CHECKPOINT:_a,SCHEDULED:$n,STATUS_CHANGE:Qt})[v]||Qt;if(o)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!s)return e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("h3",{children:"Shipment not found"}),e.jsx(nr,{to:"/shipments",className:"btn btn-primary",style:{marginTop:"1rem"},children:"Back to Shipments"})]});const x=f();return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nr,{to:"/shipments",className:"btn btn-secondary btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:600,margin:0},children:["Shipment ",s.shipmentNumber]}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:s.customer?.nameEn||s.customer?.name})]}),e.jsx(Pn,{status:s.status,size:"md"}),s.priority==="URGENT"&&e.jsx("span",{className:"badge badge-danger",children:"Urgent"})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1.5rem"},children:"Shipment Journey"}),["DELIVERY_FAILED","CANCELLED","DELAYED"].includes(s.status)&&e.jsxs("div",{style:{backgroundColor:s.status==="CANCELLED"?"var(--bg-secondary)":"var(--danger-light)",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(Hr,{size:20,color:s.status==="CANCELLED"?"var(--text-muted)":"var(--danger)"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:500,color:s.status==="CANCELLED"?"var(--text-muted)":"var(--danger)"},children:[s.status==="DELIVERY_FAILED"&&"Delivery Failed",s.status==="CANCELLED"&&"Shipment Cancelled",s.status==="DELAYED"&&"Shipment Delayed"]}),s.driverNotes&&e.jsx("div",{style:{fontSize:"0.875rem",marginTop:"0.25rem"},children:s.driverNotes})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",position:"relative",marginBottom:"1rem"},children:[e.jsx("div",{style:{position:"absolute",top:"20px",left:"40px",right:"40px",height:"2px",backgroundColor:"var(--border)",zIndex:0}}),e.jsx("div",{style:{position:"absolute",top:"20px",left:"40px",width:x>=0?`${x/(mA.length-1)*100}%`:"0%",maxWidth:"calc(100% - 80px)",height:"2px",backgroundColor:"var(--primary)",zIndex:1,transition:"width 0.3s ease"}}),mA.map((v,w)=>{const C=x>=w,A=x===w,T=v.icon;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,flex:1},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:C?"var(--primary)":"var(--bg-secondary)",border:A?"3px solid var(--primary)":"2px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"center",color:C?"white":"var(--text-muted)",transition:"all 0.3s ease"},children:e.jsx(T,{size:18})}),e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",fontWeight:A?600:400,color:C?"var(--text-primary)":"var(--text-muted)",textAlign:"center"},children:v.label})]},v.status)})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,margin:0},children:"Driver"}),["PACKED","ASSIGNED_TO_DRIVER","DELIVERY_FAILED"].includes(s.status)&&e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>n(!0),children:[e.jsx(Np,{size:14}),s.driver?"Reassign":"Assign"]})]}),s.driver?e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"50%",backgroundColor:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)",fontWeight:600,fontSize:"1.25rem"},children:s.driver.fullName.charAt(0).toUpperCase()}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:s.driver.fullName}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:[e.jsx(vo,{size:14}),e.jsx("a",{href:`tel:${s.driver.mobile}`,children:s.driver.mobile})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",color:"var(--text-muted)"},children:[e.jsx(dn,{size:14}),s.driver.vehicleType,"  ",s.driver.vehiclePlateNo]})]})]}):e.jsx("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"1rem"},children:"No driver assigned yet"})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Delivery Details"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(Uo,{size:16,style:{marginTop:"2px",color:"var(--text-muted)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Customer"}),e.jsx("div",{children:s.customer?.nameEn||s.customer?.name})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(_a,{size:16,style:{marginTop:"2px",color:"var(--text-muted)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivery Address"}),e.jsx("div",{children:s.deliveryAddress||s.customer?.address||"Not specified"}),s.customer?.city&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:s.customer.city})]})]}),(s.scheduledPickupAt||s.scheduledDeliveryAt)&&e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx($n,{size:16,style:{marginTop:"2px",color:"var(--text-muted)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Schedule"}),s.scheduledPickupAt&&e.jsxs("div",{children:["Pickup: ",Ze(new Date(s.scheduledPickupAt),"MMM dd, HH:mm")]}),s.scheduledDeliveryAt&&e.jsxs("div",{children:["Delivery: ",Ze(new Date(s.scheduledDeliveryAt),"MMM dd, HH:mm")]})]})]})]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"2fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Timeline"}),s.events?.length>0?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("div",{style:{position:"absolute",left:"15px",top:"24px",bottom:"24px",width:"2px",backgroundColor:"var(--border)"}}),s.events.map((v,w)=>{const C=p(v.eventType);return e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:w<s.events.length-1?"1.5rem":0,position:"relative"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"var(--bg-primary)",border:"2px solid var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:e.jsx(C,{size:14,color:"var(--primary)"})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:v.eventType.replace(/_/g," ")}),v.notes&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:v.notes}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[Ze(new Date(v.createdAt),"MMM dd, yyyy HH:mm"),v.driver&&`  by ${v.driver.fullName}`]})]})]},v.id)})]}):e.jsx("div",{style:{color:"var(--text-muted)",textAlign:"center",padding:"1rem"},children:"No events recorded yet"})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:["Orders (",s.orders?.length||0,")"]}),s.orders?.map(v=>e.jsx("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"0.5rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs(nr,{to:`/orders/${v.id}`,style:{fontWeight:500,color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[v.orderNumber,e.jsx(ih,{size:12})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:v.product?.name})]}),e.jsx(Pn,{status:v.status,size:"sm"})]})},v.id))]}),t&&e.jsx(mc,{entityType:"SHIPMENT",entityId:t,title:"Shipment Attachments"})]}),s.proofOfDelivery&&e.jsxs("div",{className:"card",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Proof of Delivery"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Receiver"}),e.jsx("div",{style:{fontWeight:500},children:s.proofOfDelivery.receiverName}),s.proofOfDelivery.receiverMobile&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:s.proofOfDelivery.receiverMobile})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Delivered At"}),e.jsx("div",{children:Ze(new Date(s.proofOfDelivery.deliveredAt),"MMM dd, yyyy HH:mm")})]}),s.proofOfDelivery.gpsLat&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"GPS Location"}),e.jsxs("div",{children:[s.proofOfDelivery.gpsLat.toFixed(6),", ",s.proofOfDelivery.gpsLng.toFixed(6)]})]})]}),(s.proofOfDelivery.signatureFileUrl||s.proofOfDelivery.photos?.length>0)&&e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"1rem",flexWrap:"wrap"},children:[s.proofOfDelivery.signatureFileUrl&&e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"0.5rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Signature"}),e.jsx("img",{src:s.proofOfDelivery.signatureFileUrl,alt:"Signature",style:{maxWidth:"150px",maxHeight:"80px"}})]}),s.proofOfDelivery.photos?.map((v,w)=>e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"0.5rem",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:[e.jsx(Dv,{size:12,style:{display:"inline",marginRight:"0.25rem"}}),"Photo ",w+1]}),e.jsx("img",{src:v.fileUrl,alt:`Delivery photo ${w+1}`,style:{maxWidth:"150px",maxHeight:"100px",objectFit:"cover"}})]},v.id))]}),s.proofOfDelivery.notes&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Notes"}),e.jsx("div",{children:s.proofOfDelivery.notes})]})]}),r&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Assign Driver"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>n(!1),children:""})]}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Driver *"}),e.jsxs("select",{name:"driverId",className:"form-select",required:!0,defaultValue:s.driver?.id||"",children:[e.jsx("option",{value:"",children:"Select Driver"}),l?.filter(v=>v.status==="ACTIVE").map(v=>e.jsxs("option",{value:v.id,children:[v.fullName," - ",v.vehicleType," (",v.vehiclePlateNo,")"]},v.id))]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Pickup Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledPickupAt",className:"form-input",defaultValue:s.scheduledPickupAt?Ze(new Date(s.scheduledPickupAt),"yyyy-MM-dd'T'HH:mm"):""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Time"}),e.jsx("input",{type:"datetime-local",name:"scheduledDeliveryAt",className:"form-input",defaultValue:s.scheduledDeliveryAt?Ze(new Date(s.scheduledDeliveryAt),"yyyy-MM-dd'T'HH:mm"):""})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes for Driver"}),e.jsx("textarea",{name:"driverNotes",className:"form-textarea",rows:2,placeholder:"Special instructions...",defaultValue:s.driverNotes||""})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u.isPending,children:u.isPending?"Assigning...":"Assign Driver"})]})]})]})})]})}const fAe={ORDER:Fo,BATCH:Bi,SHIPMENT:dn,INVOICE:td,APPROVAL:gu,ALERT:sn,INFO:lf},mAe={ORDER:"#3b82f6",BATCH:"#8b5cf6",SHIPMENT:"#f59e0b",INVOICE:"#10b981",APPROVAL:"#ec4899",ALERT:"#ef4444",INFO:"#6b7280"};function AM(t,r){if(!t||!r)return null;switch(t.toLowerCase()){case"order":return`/orders/${r}/journey`;case"batch":return`/batches/${r}/journey`;case"shipment":return`/shipments/${r}`;case"invoice":return"/invoices";case"customer":return"/customers";case"approval":return"/approvals";case"payment":return"/payments";case"product":return"/products";default:return null}}function pAe(){const t=Gr(),r=pr(),[n,i]=k.useState("all"),[a,s]=k.useState(""),[o,l]=k.useState(1),u=20,{data:d,isLoading:f}=Ve({queryKey:["all-notifications",n,o],queryFn:async()=>{const O=new URLSearchParams;n==="unread"&&O.append("unreadOnly","true"),O.append("limit",u.toString()),O.append("page",o.toString());const{data:D}=await xe.get(`/notifications?${O.toString()}`);return D}}),p=ot({mutationFn:async O=>{await xe.patch(`/notifications/${O}/read`)},onSuccess:()=>{r.invalidateQueries({queryKey:["all-notifications"]}),r.invalidateQueries({queryKey:["notifications"]})}}),x=ot({mutationFn:async()=>{await xe.patch("/notifications/read-all")},onSuccess:()=>{r.invalidateQueries({queryKey:["all-notifications"]}),r.invalidateQueries({queryKey:["notifications"]})}}),v=O=>{O.isRead||p.mutate(O.id);const D=AM(O.relatedType,O.relatedId);D&&t(D)},w=d?.notifications||[],C=d?.unreadCount||0,A=w.filter(O=>!(n==="read"&&!O.isRead||a&&O.type!==a)),T=[...new Set(w.map(O=>O.type))];return f?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(xo,{size:28,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:"Notification Center"}),e.jsxs("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"0.875rem"},children:[C," unread notification",C!==1?"s":""]})]})]}),C>0&&e.jsxs("button",{onClick:()=>x.mutate(),disabled:x.isPending,className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(XL,{size:16}),"Mark All as Read"]})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:16,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,fontSize:"0.875rem"},children:"Filter:"})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:["all","unread","read"].map(O=>e.jsx("button",{onClick:()=>{i(O),l(1)},style:{padding:"0.375rem 0.75rem",borderRadius:"6px",border:"none",background:n===O?"var(--primary)":"var(--bg-secondary)",color:n===O?"white":"var(--text-primary)",fontSize:"0.8rem",fontWeight:500,cursor:"pointer",textTransform:"capitalize"},children:O},O))}),T.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"1px",height:"24px",background:"var(--border)",margin:"0 0.5rem"}}),e.jsxs("select",{value:a,onChange:O=>s(O.target.value),className:"form-select",style:{fontSize:"0.8rem",padding:"0.375rem 0.75rem",minWidth:"140px"},children:[e.jsx("option",{value:"",children:"All Types"}),T.map(O=>e.jsx("option",{value:O,children:O},O))]})]})]})}),e.jsx("div",{className:"card",style:{overflow:"hidden"},children:A.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(xo,{size:48,style:{opacity:.3,marginBottom:"1rem"}}),e.jsx("div",{style:{fontSize:"1.125rem",fontWeight:500,marginBottom:"0.5rem"},children:"No notifications"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:n!=="all"?`No ${n} notifications to display.`:"You're all caught up!"})]}):A.map((O,D)=>{const M=fAe[O.type]||xo,Q=mAe[O.type]||"#6b7280",U=!!AM(O.relatedType,O.relatedId);return e.jsx("div",{onClick:()=>v(O),style:{padding:"1rem 1.25rem",borderBottom:D<A.length-1?"1px solid var(--border)":"none",background:O.isRead?"transparent":"rgba(59, 130, 246, 0.03)",cursor:U?"pointer":"default",transition:"background 0.15s ease"},onMouseEnter:$=>{U&&($.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:$=>{$.currentTarget.style.background=O.isRead?"transparent":"rgba(59, 130, 246, 0.03)"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:`${Q}15`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(M,{size:20,style:{color:Q}})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem",marginBottom:"0.25rem"},children:[e.jsx("div",{style:{fontWeight:O.isRead?500:600,fontSize:"0.925rem",color:(O.isRead,"var(--text-primary)")},children:O.title}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[!O.isRead&&e.jsx("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",whiteSpace:"nowrap"},children:Ze(new Date(O.createdAt),"MMM dd, yyyy HH:mm")})]})]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",lineHeight:1.5,marginBottom:"0.5rem"},children:O.message}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{display:"inline-block",padding:"0.2rem 0.5rem",borderRadius:"4px",background:`${Q}15`,color:Q,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase"},children:O.type}),U&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"var(--primary)"},children:[e.jsx(ih,{size:12}),"View Details"]}),!O.isRead&&e.jsxs("button",{onClick:$=>{$.stopPropagation(),p.mutate(O.id)},style:{display:"flex",alignItems:"center",gap:"0.25rem",padding:"0.25rem 0.5rem",border:"none",background:"none",color:"var(--text-muted)",fontSize:"0.75rem",cursor:"pointer",marginLeft:"auto"},children:[e.jsx(Ai,{size:12}),"Mark as read"]})]})]})]})},O.id)})}),d&&d.totalCount>0&&e.jsx("div",{style:{marginTop:"1rem",borderRadius:"8px",overflow:"hidden"},children:e.jsx(a0,{page:o,pageSize:u,totalCount:d.totalCount,onPageChange:l})})]})}function gAe(){const t=pr(),[r,n]=k.useState(!1),[i,a]=k.useState(null),[s,o]=k.useState({name:"",description:"",permissionIds:[]}),{data:l,isLoading:u}=Ve({queryKey:["roles"],queryFn:async()=>{const{data:A}=await xe.get("/roles");return A}}),{data:d}=Ve({queryKey:["permissions"],queryFn:async()=>{const{data:A}=await xe.get("/roles/permissions/all");return A}}),f=ot({mutationFn:async A=>{const{data:T}=await xe.post("/roles",A);return T},onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]}),v()}}),p=ot({mutationFn:async({id:A,data:T})=>{const{data:O}=await xe.put(`/roles/${A}`,T);return O},onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]}),v()}}),x=A=>{A?(a(A),o({name:A.name,description:A.description||"",permissionIds:A.permissions.map(T=>T.id)})):(a(null),o({name:"",description:"",permissionIds:[]})),n(!0)},v=()=>{n(!1),a(null),o({name:"",description:"",permissionIds:[]})},w=A=>{A.preventDefault(),i?p.mutate({id:i.id,data:s}):f.mutate(s)},C=A=>{o(T=>({...T,permissionIds:T.permissionIds.includes(A)?T.permissionIds.filter(O=>O!==A):[...T.permissionIds,A]}))};return u?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(aa,{size:28,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:"Role Management"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0,fontSize:"0.875rem"},children:"Manage system roles and their permissions"})]})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>x(),style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(cn,{size:16}),"Add Role"]})]}),e.jsx("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))"},children:l?.map(A=>e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(aa,{size:20,style:{color:"var(--primary)"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:600,margin:0},children:A.name}),A.description&&e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-muted)",margin:0,marginTop:"0.25rem"},children:A.description})]})]}),e.jsx("button",{onClick:()=>x(A),style:{background:"none",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-muted)",borderRadius:"6px"},children:e.jsx(Qh,{size:16})})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Bg,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{style:{fontSize:"0.8rem",fontWeight:500,color:"var(--text-muted)"},children:["Permissions (",A.permissions.length,")"]})]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.375rem"},children:[A.permissions.length===0?e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",fontStyle:"italic"},children:"No permissions assigned"}):A.permissions.slice(0,5).map(T=>e.jsx("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",background:"var(--bg-secondary)",fontSize:"0.7rem",fontWeight:500},children:T.name},T.id)),A.permissions.length>5&&e.jsxs("span",{style:{padding:"0.2rem 0.5rem",borderRadius:"4px",background:"var(--primary-light)",color:"var(--primary)",fontSize:"0.7rem",fontWeight:500},children:["+",A.permissions.length-5," more"]})]})]})]},A.id))}),l?.length===0&&e.jsxs("div",{className:"card",style:{padding:"3rem",textAlign:"center"},children:[e.jsx(dc,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"No roles found. Create your first role to get started."})]}),r&&e.jsx("div",{className:"modal-overlay",onClick:v,children:e.jsxs("div",{className:"modal",onClick:A=>A.stopPropagation(),style:{maxWidth:"500px",width:"100%"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:i?"Edit Role":"Create New Role"}),e.jsx("button",{className:"modal-close",onClick:v,children:e.jsx(Dr,{size:20})})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Role Name *"}),e.jsx("input",{type:"text",className:"form-input",value:s.name,onChange:A=>o({...s,name:A.target.value}),placeholder:"e.g., Manager, Supervisor",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-input",value:s.description,onChange:A=>o({...s,description:A.target.value}),placeholder:"Brief description of this role",rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Permissions"}),e.jsx("div",{style:{border:"1px solid var(--border)",borderRadius:"8px",maxHeight:"250px",overflow:"auto"},children:d?.length===0?e.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"},children:"No permissions available"}):d?.map(A=>e.jsxs("div",{onClick:()=>C(A.id),style:{padding:"0.75rem 1rem",display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer",borderBottom:"1px solid var(--border)",background:s.permissionIds.includes(A.id)?"rgba(59, 130, 246, 0.05)":"transparent"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"4px",border:s.permissionIds.includes(A.id)?"none":"2px solid var(--border)",background:s.permissionIds.includes(A.id)?"var(--primary)":"transparent",display:"flex",alignItems:"center",justifyContent:"center"},children:s.permissionIds.includes(A.id)&&e.jsx(Ai,{size:14,color:"white"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.875rem"},children:A.name}),A.description&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:A.description})]})]},A.id))}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[s.permissionIds.length," permission(s) selected"]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:v,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f.isPending||p.isPending,children:i?"Update Role":"Create Role"})]})]})]})})]})}function yAe(){const{user:t,setUser:r}=Il();pr();const n=gn(),[i,a]=k.useState(!1),[s,o]=k.useState(!1),[l,u]=k.useState(!1),[d,f]=k.useState({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",phone:t?.phone||""}),[p,x]=k.useState({currentPassword:"",newPassword:"",confirmPassword:""}),v=ot({mutationFn:async T=>(await xe.put("/users/profile",T)).data,onSuccess:T=>{r(T),a(!1),n.success("Profile Updated","Your profile has been updated successfully")},onError:()=>{n.error("Update Failed","Failed to update profile")}}),w=ot({mutationFn:async T=>{await xe.put("/users/change-password",{currentPassword:T.currentPassword,newPassword:T.newPassword})},onSuccess:()=>{o(!1),x({currentPassword:"",newPassword:"",confirmPassword:""}),n.success("Password Changed","Your password has been changed successfully")},onError:()=>{n.error("Password Change Failed","Failed to change password. Please check your current password.")}}),C=T=>{T.preventDefault(),v.mutate(d)},A=T=>{if(T.preventDefault(),p.newPassword!==p.confirmPassword){n.error("Password Mismatch","New passwords do not match");return}if(p.newPassword.length<6){n.error("Password Too Short","Password must be at least 6 characters");return}w.mutate(p)};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"My Profile"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage your account settings and preferences"})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("div",{style:{width:"4rem",height:"4rem",borderRadius:"50%",background:"var(--primary)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"1.5rem"},children:[t?.firstName?.[0],t?.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{style:{fontWeight:600,margin:0},children:[t?.firstName," ",t?.lastName]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.25rem"},children:[e.jsx(aa,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:t?.role})]})]})]}),!i&&e.jsx("button",{className:"btn btn-secondary",onClick:()=>a(!0),children:"Edit Profile"})]}),e.jsxs("form",{onSubmit:C,style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Uo,{size:14})," First Name"]}),e.jsx("input",{type:"text",className:"form-input",value:d.firstName,onChange:T=>f({...d,firstName:T.target.value}),disabled:!i})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(Uo,{size:14})," Last Name"]}),e.jsx("input",{type:"text",className:"form-input",value:d.lastName,onChange:T=>f({...d,lastName:T.target.value}),disabled:!i})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(uc,{size:14})," Email"]}),e.jsx("input",{type:"email",className:"form-input",value:d.email,onChange:T=>f({...d,email:T.target.value}),disabled:!i})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(vo,{size:14})," Phone"]}),e.jsx("input",{type:"tel",className:"form-input",value:d.phone,onChange:T=>f({...d,phone:T.target.value}),disabled:!i})]})]}),i&&e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{a(!1),f({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",phone:t?.phone||""})},children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:v.isPending,children:[e.jsx(cc,{size:16})," Save Changes"]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("h3",{style:{fontWeight:600,margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Bg,{size:18})," Security"]}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:"0.25rem 0 0"},children:"Manage your password and security settings"})]}),!s&&e.jsx("button",{className:"btn btn-secondary",onClick:()=>o(!0),children:"Change Password"})]}),s&&e.jsxs("form",{onSubmit:A,style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gap:"1rem",maxWidth:"400px"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Current Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:l?"text":"password",className:"form-input",value:p.currentPassword,onChange:T=>x({...p,currentPassword:T.target.value}),required:!0}),e.jsx("button",{type:"button",onClick:()=>u(!l),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:l?e.jsx(Eg,{size:16}):e.jsx(os,{size:16})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"New Password"}),e.jsx("input",{type:l?"text":"password",className:"form-input",value:p.newPassword,onChange:T=>x({...p,newPassword:T.target.value}),required:!0,minLength:6})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm New Password"}),e.jsx("input",{type:l?"text":"password",className:"form-input",value:p.confirmPassword,onChange:T=>x({...p,confirmPassword:T.target.value}),required:!0,minLength:6})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{o(!1),x({currentPassword:"",newPassword:"",confirmPassword:""})},children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:w.isPending,children:[e.jsx(Bg,{size:16})," Update Password"]})]})]}),!s&&e.jsx("div",{style:{padding:"1.5rem",color:"var(--text-muted)",fontSize:"0.875rem"},children:"Your password was last changed on your account creation date."})]})]})}function xAe(){const{data:t,isLoading:r}=Ve({queryKey:["driver-dashboard"],queryFn:async()=>{const{data:i}=await xe.get("/driver/dashboard");return i}});if(r)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const n=t?.stats||{};return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:["Welcome, ",t?.driver?.fullName||"Driver"]}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:[t?.driver?.vehicleType,"  ",t?.driver?.vehiclePlateNo]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Assigned Today",value:n.assignedToday||0,icon:e.jsx(Rr,{size:20}),color:"primary"}),e.jsx(nt,{title:"Awaiting Accept",value:n.awaitingAcceptance||0,icon:e.jsx(Qt,{size:20}),color:"warning"}),e.jsx(nt,{title:"In Transit",value:n.inTransit||0,icon:e.jsx(dn,{size:20}),color:"info"}),e.jsx(nt,{title:"Delivered Today",value:n.deliveredToday||0,icon:e.jsx(Ft,{size:20}),color:"success"}),e.jsx(nt,{title:"Failed",value:n.failed||0,icon:e.jsx(Hr,{size:20}),color:"danger"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Upcoming Deliveries"}),e.jsxs(nr,{to:"/driver/shipments",className:"btn btn-sm btn-outline",children:["View All",e.jsx(lc,{size:14})]})]}),t?.nextDeliveries?.length>0?e.jsx("div",{style:{padding:"1rem"},children:t.nextDeliveries.map(i=>e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"0.75rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontWeight:600,fontFamily:"monospace"},children:i.shipmentNumber}),e.jsx(Pn,{status:i.status,size:"sm"}),i.priority==="URGENT"&&e.jsx("span",{className:"badge badge-danger",children:"Urgent"})]}),e.jsx("div",{style:{fontSize:"0.875rem",marginBottom:"0.25rem"},children:i.customer?.nameEn||i.customer?.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(_a,{size:12}),i.customer?.city||"N/A"]}),i.scheduledDeliveryAt&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Qt,{size:12}),Ze(new Date(i.scheduledDeliveryAt),"HH:mm")]}),e.jsxs("span",{children:[i.orders?.length||0," orders"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i.customer?.mobile&&e.jsx("a",{href:`tel:${i.customer.mobile}`,className:"btn btn-sm btn-outline",children:e.jsx(vo,{size:14})}),e.jsxs(nr,{to:`/driver/shipments/${i.id}`,className:"btn btn-sm btn-primary",children:["Open",e.jsx(lc,{size:14})]})]})]},i.id))}):e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No pending deliveries"})]})]})}function vAe(){const[t,r]=k.useState({}),n=pr(),i=gn(),{data:a,isLoading:s}=Ve({queryKey:["driver-shipments",t],queryFn:async()=>{const{data:l}=await xe.get("/driver/shipments",{params:t});return l}}),o=ot({mutationFn:async l=>xe.post(`/driver/shipments/${l}/accept`),onSuccess:()=>{n.invalidateQueries({queryKey:["driver-shipments"]}),i.success("Accepted","Shipment accepted successfully")},onError:l=>{const u=an(l);i.error("Failed",u?.userMessage||"Failed to accept shipment")}});return s?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"My Shipments"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"View and manage your assigned deliveries"})]})}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search shipment...",className:"form-input",style:{paddingLeft:"2.25rem"},value:t.search||"",onChange:l=>r(u=>({...u,search:l.target.value}))})]}),e.jsxs("select",{className:"form-select",style:{width:"180px"},value:t.status||"",onChange:l=>r(u=>({...u,status:l.target.value})),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"ASSIGNED_TO_DRIVER",children:"Awaiting Accept"}),e.jsx("option",{value:"ACCEPTED_BY_DRIVER",children:"Accepted"}),e.jsx("option",{value:"PICKED_UP",children:"Picked Up"}),e.jsx("option",{value:"IN_TRANSIT",children:"In Transit"}),e.jsx("option",{value:"ARRIVED",children:"Arrived"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"}),e.jsx("option",{value:"DELIVERY_FAILED",children:"Failed"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Shipments (",a?.length||0,")"]})}),a?.length>0?e.jsx("div",{style:{padding:"1rem"},children:a.map(l=>e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"0.75rem",border:l.status==="ASSIGNED_TO_DRIVER"?"2px solid var(--warning)":"none"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.25rem"},children:[e.jsx("span",{style:{fontWeight:600,fontFamily:"monospace"},children:l.shipmentNumber}),e.jsx(Pn,{status:l.status,size:"sm"}),l.priority==="URGENT"&&e.jsx("span",{className:"badge badge-danger",children:"Urgent"})]}),e.jsx("div",{style:{fontSize:"0.875rem",fontWeight:500},children:l.customer?.nameEn||l.customer?.name})]}),e.jsxs("div",{style:{textAlign:"right",fontSize:"0.75rem",color:"var(--text-muted)"},children:[l.orders?.length||0," orders"]})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.875rem",marginBottom:"0.75rem"},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--text-muted)"},children:[e.jsx(_a,{size:14}),l.deliveryAddress||l.customer?.address||"N/A"]})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:[l.scheduledDeliveryAt&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Qt,{size:12}),"Deliver by ",Ze(new Date(l.scheduledDeliveryAt),"MMM dd, HH:mm")]}),l.customer?.city&&e.jsx("span",{children:l.customer.city})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[l.customer?.mobile&&e.jsxs("a",{href:`tel:${l.customer.mobile}`,className:"btn btn-sm btn-outline",children:[e.jsx(vo,{size:14}),"Call"]}),l.status==="ASSIGNED_TO_DRIVER"&&e.jsxs("button",{className:"btn btn-sm btn-success",onClick:()=>o.mutate(l.id),disabled:o.isPending,children:[e.jsx(Ft,{size:14}),"Accept"]}),e.jsxs(nr,{to:`/driver/shipments/${l.id}`,className:"btn btn-sm btn-primary",children:["Open",e.jsx(lc,{size:14})]})]})]},l.id))}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No shipments found",message:"You have no assigned shipments at this time",icon:"truck"})})]})]})}const gC=[{status:"ASSIGNED_TO_DRIVER",label:"Assigned"},{status:"ACCEPTED_BY_DRIVER",label:"Accepted"},{status:"PICKED_UP",label:"Picked Up"},{status:"IN_TRANSIT",label:"In Transit"},{status:"ARRIVED",label:"Arrived"},{status:"DELIVERED",label:"Delivered"}];function bAe(){const{id:t}=fl(),r=Gr(),[n,i]=k.useState(!1),[a,s]=k.useState(!1),[o,l]=k.useState(null),[u,d]=k.useState(!1),f=k.useRef(null),p=k.useRef(null),x=pr(),v=gn(),{data:w,isLoading:C}=Ve({queryKey:["driver-shipment",t],queryFn:async()=>{const{data:Z}=await xe.get(`/driver/shipments/${t}`);return Z},enabled:!!t}),A=ot({mutationFn:async()=>xe.post(`/driver/shipments/${t}/accept`),onSuccess:()=>{x.invalidateQueries({queryKey:["driver-shipment",t]}),v.success("Accepted","Shipment accepted")},onError:Z=>{const re=an(Z);v.error("Failed",re?.userMessage||"Failed to accept")}}),T=ot({mutationFn:async()=>xe.post(`/driver/shipments/${t}/pickup`,{latitude:o?.lat,longitude:o?.lng}),onSuccess:()=>{x.invalidateQueries({queryKey:["driver-shipment",t]}),v.success("Picked Up","Shipment picked up")},onError:Z=>{const re=an(Z);v.error("Failed",re?.userMessage||"Failed to confirm pickup")}}),O=ot({mutationFn:async()=>xe.post(`/driver/shipments/${t}/transit`,{latitude:o?.lat,longitude:o?.lng}),onSuccess:()=>{x.invalidateQueries({queryKey:["driver-shipment",t]}),v.success("In Transit","Started transit")},onError:Z=>{const re=an(Z);v.error("Failed",re?.userMessage||"Failed to start transit")}}),D=ot({mutationFn:async()=>xe.post(`/driver/shipments/${t}/arrived`,{latitude:o?.lat,longitude:o?.lng}),onSuccess:()=>{x.invalidateQueries({queryKey:["driver-shipment",t]}),v.success("Arrived","Marked as arrived")},onError:Z=>{const re=an(Z);v.error("Failed",re?.userMessage||"Failed to mark arrived")}}),M=ot({mutationFn:async Z=>xe.post(`/driver/shipments/${t}/deliver`,Z,{headers:{"Content-Type":"multipart/form-data"}}),onSuccess:()=>{x.invalidateQueries({queryKey:["driver-shipment",t]}),i(!1),v.success("Delivered","Delivery confirmed with proof"),r("/driver/shipments")},onError:Z=>{const re=an(Z);v.error("Failed",re?.userMessage||"Failed to confirm delivery")}}),Q=ot({mutationFn:async Z=>xe.post(`/driver/shipments/${t}/fail`,Z),onSuccess:()=>{x.invalidateQueries({queryKey:["driver-shipment",t]}),s(!1),v.success("Reported","Delivery failure reported")},onError:Z=>{const re=an(Z);v.error("Failed",re?.userMessage||"Failed to report")}}),U=()=>{if(!navigator.geolocation){v.error("Error","Geolocation is not supported");return}d(!0),navigator.geolocation.getCurrentPosition(Z=>{l({lat:Z.coords.latitude,lng:Z.coords.longitude}),d(!1),v.success("Location","GPS location captured")},Z=>{d(!1),v.error("Error","Failed to get location: "+Z.message)},{enableHighAccuracy:!0,timeout:1e4})},$=Z=>{Z.preventDefault();const re=new FormData(Z.currentTarget);if(!re.get("receiverName")?.trim()){v.error("Required","Receiver name is required");return}if(!o){v.error("Required","Please capture GPS location before confirming delivery");return}re.append("latitude",o.lat.toString()),re.append("longitude",o.lng.toString());const le=f.current?.files;if(!le||le.length===0){v.error("Required","Please upload at least one delivery photo");return}for(let ue=0;ue<le.length;ue++)re.append("photos",le[ue]);const K=p.current?.files?.[0];K&&re.append("signature",K),M.mutate(re)},ee=Z=>{Z.preventDefault();const re=new FormData(Z.currentTarget);Q.mutate({reasonCode:re.get("reasonCode"),notes:re.get("notes"),latitude:o?.lat,longitude:o?.lng})},F=()=>w?gC.findIndex(Z=>Z.status===w.status):-1;if(C)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!w)return e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("h3",{children:"Shipment not found"}),e.jsx(nr,{to:"/driver/shipments",className:"btn btn-primary",style:{marginTop:"1rem"},children:"Back to Shipments"})]});const Y=F(),J=["DELIVERED","DELIVERY_FAILED","CANCELLED","RETURNED"].includes(w.status);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nr,{to:"/driver/shipments",className:"btn btn-secondary btn-sm",children:e.jsx(sa,{size:16})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,margin:0},children:w.shipmentNumber}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:w.customer?.nameEn||w.customer?.name})]}),e.jsx(Pn,{status:w.status,size:"md"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",position:"relative",marginBottom:"1rem"},children:[e.jsx("div",{style:{position:"absolute",top:"15px",left:"30px",right:"30px",height:"2px",backgroundColor:"var(--border)",zIndex:0}}),e.jsx("div",{style:{position:"absolute",top:"15px",left:"30px",width:Y>=0?`${Y/(gC.length-1)*100}%`:"0%",maxWidth:"calc(100% - 60px)",height:"2px",backgroundColor:"var(--primary)",zIndex:1}}),gC.map((Z,re)=>{const de=Y>=re,le=Y===re;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,flex:1},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:de?"var(--primary)":"var(--bg-secondary)",border:le?"3px solid var(--primary)":"2px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"center",color:de?"white":"var(--text-muted)",fontSize:"0.75rem",fontWeight:600},children:de?e.jsx(Ft,{size:14}):re+1}),e.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.625rem",fontWeight:le?600:400,color:de?"var(--text-primary)":"var(--text-muted)",textAlign:"center"},children:Z.label})]},Z.status)})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Delivery Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(_a,{size:18,style:{marginTop:"2px",color:"var(--primary)"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivery Address"}),e.jsx("div",{style:{fontWeight:500},children:w.deliveryAddress||w.customer?.address||"Not specified"}),w.customer?.city&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:w.customer.city}),w.deliveryLat&&e.jsxs("a",{href:`https://www.google.com/maps?q=${w.deliveryLat},${w.deliveryLng}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline",style:{marginTop:"0.5rem"},children:[e.jsx(zZ,{size:14}),"Navigate"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(vo,{size:18,style:{marginTop:"2px",color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Contact"}),e.jsx("a",{href:`tel:${w.customer?.mobile||w.customer?.phone}`,style:{fontWeight:500},children:w.customer?.mobile||w.customer?.phone||"N/A"})]})]}),w.scheduledDeliveryAt&&e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(Qt,{size:18,style:{marginTop:"2px",color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Deliver By"}),e.jsx("div",{style:{fontWeight:500},children:Ze(new Date(w.scheduledDeliveryAt),"MMM dd, HH:mm")})]})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:["Orders (",w.orders?.length||0,")"]}),w.orders?.map(Z=>e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{fontWeight:500},children:Z.orderNumber}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:Z.product?.name})]},Z.id)),w.driverNotes&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"var(--warning-light)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--warning)",fontWeight:600},children:"Instructions"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:w.driverNotes})]})]})]}),!J&&e.jsxs("div",{className:"card",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Actions"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:U,disabled:u,children:[e.jsx(_a,{size:16}),u?"Getting Location...":o?"Location Captured":"Capture Location"]}),o&&e.jsxs("span",{style:{display:"flex",alignItems:"center",fontSize:"0.75rem",color:"var(--success)"},children:[e.jsx(Ft,{size:14,style:{marginRight:"0.25rem"}}),o.lat.toFixed(4),", ",o.lng.toFixed(4)]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[w.status==="ASSIGNED_TO_DRIVER"&&e.jsxs("button",{className:"btn btn-success",onClick:()=>A.mutate(),disabled:A.isPending,children:[e.jsx(Ft,{size:16}),"Accept Shipment"]}),w.status==="ACCEPTED_BY_DRIVER"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>T.mutate(),disabled:T.isPending,children:[e.jsx(Rr,{size:16}),"Confirm Pickup"]}),w.status==="PICKED_UP"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>O.mutate(),disabled:O.isPending,children:[e.jsx(dn,{size:16}),"Start Transit"]}),w.status==="IN_TRANSIT"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>D.mutate(),disabled:D.isPending,children:[e.jsx(_a,{size:16}),"Mark Arrived"]}),["ARRIVED","IN_TRANSIT"].includes(w.status)&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success",onClick:()=>i(!0),children:[e.jsx(Ft,{size:16}),"Complete Delivery"]}),e.jsxs("button",{className:"btn btn-danger",onClick:()=>s(!0),children:[e.jsx(Hr,{size:16}),"Report Failed"]})]})]})]}),w.proofOfDelivery&&e.jsxs("div",{className:"card",style:{padding:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem"},children:"Proof of Delivery"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Receiver"}),e.jsx("div",{style:{fontWeight:500},children:w.proofOfDelivery.receiverName})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivered At"}),e.jsx("div",{children:Ze(new Date(w.proofOfDelivery.deliveredAt),"MMM dd, HH:mm")})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"GPS"}),e.jsxs("div",{children:[w.proofOfDelivery.gpsLat?.toFixed(4),", ",w.proofOfDelivery.gpsLng?.toFixed(4)]})]})]})]}),n&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Confirm Delivery"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>i(!1),children:""})]}),e.jsxs("form",{onSubmit:$,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Receiver Name *"}),e.jsx("input",{type:"text",name:"receiverName",className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Receiver Mobile"}),e.jsx("input",{type:"tel",name:"receiverMobile",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Photos *"}),e.jsx("input",{type:"file",ref:f,accept:"image/*",multiple:!0,className:"form-input"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"At least one photo required"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Signature Image"}),e.jsx("input",{type:"file",ref:p,accept:"image/*",className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{name:"notes",className:"form-textarea",rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"GPS Location *"}),o?e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--success)",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",backgroundColor:"var(--success-light)",borderRadius:"var(--radius)"},children:[e.jsx(Ft,{size:14}),o.lat.toFixed(4),", ",o.lng.toFixed(4)]}):e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--danger)",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",backgroundColor:"var(--danger-light)",borderRadius:"var(--radius)"},children:[e.jsx(Hr,{size:14}),'GPS not captured - use "Capture Location" button first']})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-success",disabled:M.isPending,children:M.isPending?"Confirming...":"Confirm Delivery"})]})]})]})}),a&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Report Delivery Failed"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>s(!1),children:""})]}),e.jsxs("form",{onSubmit:ee,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Reason *"}),e.jsxs("select",{name:"reasonCode",className:"form-select",required:!0,children:[e.jsx("option",{value:"",children:"Select Reason"}),e.jsx("option",{value:"CUSTOMER_NOT_AVAILABLE",children:"Customer not available"}),e.jsx("option",{value:"WRONG_ADDRESS",children:"Wrong address"}),e.jsx("option",{value:"CUSTOMER_REFUSED",children:"Customer refused"}),e.jsx("option",{value:"ACCESS_ISSUE",children:"Access issue"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{name:"notes",className:"form-textarea",rows:3,placeholder:"Additional details..."})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-danger",disabled:Q.isPending,children:Q.isPending?"Reporting...":"Report Failed"})]})]})]})})]})}var mr;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(mr||(mr={}));var EM=new Map([[mr.QR_CODE,"QR_CODE"],[mr.AZTEC,"AZTEC"],[mr.CODABAR,"CODABAR"],[mr.CODE_39,"CODE_39"],[mr.CODE_93,"CODE_93"],[mr.CODE_128,"CODE_128"],[mr.DATA_MATRIX,"DATA_MATRIX"],[mr.MAXICODE,"MAXICODE"],[mr.ITF,"ITF"],[mr.EAN_13,"EAN_13"],[mr.EAN_8,"EAN_8"],[mr.PDF_417,"PDF_417"],[mr.RSS_14,"RSS_14"],[mr.RSS_EXPANDED,"RSS_EXPANDED"],[mr.UPC_A,"UPC_A"],[mr.UPC_E,"UPC_E"],[mr.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),_M;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(_M||(_M={}));function jAe(t){return Object.values(mr).includes(t)}var Hb;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Hb||(Hb={}));var wAe=(function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[Hb.SCAN_TYPE_CAMERA,Hb.SCAN_TYPE_FILE],t})(),cH=(function(){function t(r,n){this.format=r,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(r){if(!EM.has(r))throw"".concat(r," not in html5QrcodeSupportedFormatsTextMap");return new t(r,EM.get(r))},t})(),TM=(function(){function t(){}return t.createFromText=function(r){var n={text:r};return{decodedText:r,result:n}},t.createFromQrcodeResult=function(r){return{decodedText:r.text,result:r}},t})(),pA;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(pA||(pA={}));var SAe=(function(){function t(){}return t.createFrom=function(r){return{errorMessage:r,type:pA.UNKWOWN_ERROR}},t})(),CAe=(function(){function t(r){this.verbose=r}return t.prototype.log=function(r){this.verbose&&console.log(r)},t.prototype.warn=function(r){this.verbose&&console.warn(r)},t.prototype.logError=function(r,n){(this.verbose||n===!0)&&console.error(r)},t.prototype.logErrors=function(r){if(r.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(r)},t})();function Uu(t){return typeof t>"u"||t===null}var Cp=(function(){function t(){}return t.codeParseError=function(r){return"QR code parse error, error = ".concat(r)},t.errorGettingUserMedia=function(r){return"Error getting userMedia, error = ".concat(r)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t})(),dH=(function(){function t(){}return t.isMediaStreamConstraintsValid=function(r,n){if(typeof r!="object"){var i=typeof r;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],s=new Set(a),o=Object.keys(r),l=0,u=o;l<u.length;l++){var d=u[l];if(s.has(d))return n.logError("".concat(d," is not supported videoConstaints."),!0),!1}return!0},t})(),Cg={exports:{}},NAe=Cg.exports,IM;function AAe(){return IM||(IM=1,(function(t,r){(function(n,i){i(r)})(NAe,(function(n){function i(je){return je==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(je,h){je.__proto__=h}||function(je,h){for(var g in h)h.hasOwnProperty(g)&&(je[g]=h[g])};function s(je,h){a(je,h);function g(){this.constructor=je}je.prototype=h===null?Object.create(h):(g.prototype=h.prototype,new g)}function o(je,h){var g=Object.setPrototypeOf;g?g(je,h):je.__proto__=h}function l(je,h){h===void 0&&(h=je.constructor);var g=Error.captureStackTrace;g&&g(je,h)}var u=(function(je){s(h,je);function h(g){var b=this.constructor,S=je.call(this,g)||this;return Object.defineProperty(S,"name",{value:b.name,enumerable:!1}),o(S,b.prototype),l(S),S}return h})(Error);class d extends u{constructor(h=void 0){super(h),this.message=h}getKind(){return this.constructor.kind}}d.kind="Exception";class f extends d{}f.kind="ArgumentException";class p extends d{}p.kind="IllegalArgumentException";class x{constructor(h){if(this.binarizer=h,h===null)throw new p("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(h,g){return this.binarizer.getBlackRow(h,g)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(h,g,b,S){const N=this.binarizer.getLuminanceSource().crop(h,g,b,S);return new x(this.binarizer.createBinarizer(N))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const h=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new x(this.binarizer.createBinarizer(h))}rotateCounterClockwise45(){const h=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new x(this.binarizer.createBinarizer(h))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class v extends d{static getChecksumInstance(){return new v}}v.kind="ChecksumException";class w{constructor(h){this.source=h}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class C{static arraycopy(h,g,b,S,N){for(;N--;)b[S++]=h[g++]}static currentTimeMillis(){return Date.now()}}class A extends d{}A.kind="IndexOutOfBoundsException";class T extends A{constructor(h=void 0,g=void 0){super(g),this.index=h,this.message=g}}T.kind="ArrayIndexOutOfBoundsException";class O{static fill(h,g){for(let b=0,S=h.length;b<S;b++)h[b]=g}static fillWithin(h,g,b,S){O.rangeCheck(h.length,g,b);for(let N=g;N<b;N++)h[N]=S}static rangeCheck(h,g,b){if(g>b)throw new p("fromIndex("+g+") > toIndex("+b+")");if(g<0)throw new T(g);if(b>h)throw new T(b)}static asList(...h){return h}static create(h,g,b){return Array.from({length:h}).map(N=>Array.from({length:g}).fill(b))}static createInt32Array(h,g,b){return Array.from({length:h}).map(N=>Int32Array.from({length:g}).fill(b))}static equals(h,g){if(!h||!g||!h.length||!g.length||h.length!==g.length)return!1;for(let b=0,S=h.length;b<S;b++)if(h[b]!==g[b])return!1;return!0}static hashCode(h){if(h===null)return 0;let g=1;for(const b of h)g=31*g+b;return g}static fillUint8Array(h,g){for(let b=0;b!==h.length;b++)h[b]=g}static copyOf(h,g){return h.slice(0,g)}static copyOfUint8Array(h,g){if(h.length<=g){const b=new Uint8Array(g);return b.set(h),b}return h.slice(0,g)}static copyOfRange(h,g,b){const S=b-g,N=new Int32Array(S);return C.arraycopy(h,g,N,0,S),N}static binarySearch(h,g,b){b===void 0&&(b=O.numberComparator);let S=0,N=h.length-1;for(;S<=N;){const I=N+S>>1,R=b(g,h[I]);if(R>0)S=I+1;else if(R<0)N=I-1;else return I}return-S-1}static numberComparator(h,g){return h-g}}class D{static numberOfTrailingZeros(h){let g;if(h===0)return 32;let b=31;return g=h<<16,g!==0&&(b-=16,h=g),g=h<<8,g!==0&&(b-=8,h=g),g=h<<4,g!==0&&(b-=4,h=g),g=h<<2,g!==0&&(b-=2,h=g),b-(h<<1>>>31)}static numberOfLeadingZeros(h){if(h===0)return 32;let g=1;return h>>>16||(g+=16,h<<=16),h>>>24||(g+=8,h<<=8),h>>>28||(g+=4,h<<=4),h>>>30||(g+=2,h<<=2),g-=h>>>31,g}static toHexString(h){return h.toString(16)}static toBinaryString(h){return String(parseInt(String(h),2))}static bitCount(h){return h=h-(h>>>1&1431655765),h=(h&858993459)+(h>>>2&858993459),h=h+(h>>>4)&252645135,h=h+(h>>>8),h=h+(h>>>16),h&63}static truncDivision(h,g){return Math.trunc(h/g)}static parseInt(h,g=void 0){return parseInt(h,g)}}D.MIN_VALUE_32_BITS=-2147483648,D.MAX_VALUE=Number.MAX_SAFE_INTEGER;class M{constructor(h,g){h===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=h,g==null?this.bits=M.makeArray(h):this.bits=g)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(h){if(h>this.bits.length*32){const g=M.makeArray(h);C.arraycopy(this.bits,0,g,0,this.bits.length),this.bits=g}}get(h){return(this.bits[Math.floor(h/32)]&1<<(h&31))!==0}set(h){this.bits[Math.floor(h/32)]|=1<<(h&31)}flip(h){this.bits[Math.floor(h/32)]^=1<<(h&31)}getNextSet(h){const g=this.size;if(h>=g)return g;const b=this.bits;let S=Math.floor(h/32),N=b[S];N&=~((1<<(h&31))-1);const I=b.length;for(;N===0;){if(++S===I)return g;N=b[S]}const R=S*32+D.numberOfTrailingZeros(N);return R>g?g:R}getNextUnset(h){const g=this.size;if(h>=g)return g;const b=this.bits;let S=Math.floor(h/32),N=~b[S];N&=~((1<<(h&31))-1);const I=b.length;for(;N===0;){if(++S===I)return g;N=~b[S]}const R=S*32+D.numberOfTrailingZeros(N);return R>g?g:R}setBulk(h,g){this.bits[Math.floor(h/32)]=g}setRange(h,g){if(g<h||h<0||g>this.size)throw new p;if(g===h)return;g--;const b=Math.floor(h/32),S=Math.floor(g/32),N=this.bits;for(let I=b;I<=S;I++){const R=I>b?0:h&31,ne=(2<<(I<S?31:g&31))-(1<<R);N[I]|=ne}}clear(){const h=this.bits.length,g=this.bits;for(let b=0;b<h;b++)g[b]=0}isRange(h,g,b){if(g<h||h<0||g>this.size)throw new p;if(g===h)return!0;g--;const S=Math.floor(h/32),N=Math.floor(g/32),I=this.bits;for(let R=S;R<=N;R++){const H=R>S?0:h&31,he=(2<<(R<N?31:g&31))-(1<<H)&4294967295;if((I[R]&he)!==(b?he:0))return!1}return!0}appendBit(h){this.ensureCapacity(this.size+1),h&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(h,g){if(g<0||g>32)throw new p("Num bits must be between 0 and 32");this.ensureCapacity(this.size+g);for(let b=g;b>0;b--)this.appendBit((h>>b-1&1)===1)}appendBitArray(h){const g=h.size;this.ensureCapacity(this.size+g);for(let b=0;b<g;b++)this.appendBit(h.get(b))}xor(h){if(this.size!==h.size)throw new p("Sizes don't match");const g=this.bits;for(let b=0,S=g.length;b<S;b++)g[b]^=h.bits[b]}toBytes(h,g,b,S){for(let N=0;N<S;N++){let I=0;for(let R=0;R<8;R++)this.get(h)&&(I|=1<<7-R),h++;g[b+N]=I}}getBitArray(){return this.bits}reverse(){const h=new Int32Array(this.bits.length),g=Math.floor((this.size-1)/32),b=g+1,S=this.bits;for(let N=0;N<b;N++){let I=S[N];I=I>>1&1431655765|(I&1431655765)<<1,I=I>>2&858993459|(I&858993459)<<2,I=I>>4&252645135|(I&252645135)<<4,I=I>>8&16711935|(I&16711935)<<8,I=I>>16&65535|(I&65535)<<16,h[g-N]=I}if(this.size!==b*32){const N=b*32-this.size;let I=h[0]>>>N;for(let R=1;R<b;R++){const H=h[R];I|=H<<32-N,h[R-1]=I,I=H>>>N}h[b-1]=I}this.bits=h}static makeArray(h){return new Int32Array(Math.floor((h+31)/32))}equals(h){if(!(h instanceof M))return!1;const g=h;return this.size===g.size&&O.equals(this.bits,g.bits)}hashCode(){return 31*this.size+O.hashCode(this.bits)}toString(){let h="";for(let g=0,b=this.size;g<b;g++)(g&7)===0&&(h+=" "),h+=this.get(g)?"X":".";return h}clone(){return new M(this.size,this.bits.slice())}}var Q;(function(je){je[je.OTHER=0]="OTHER",je[je.PURE_BARCODE=1]="PURE_BARCODE",je[je.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",je[je.TRY_HARDER=3]="TRY_HARDER",je[je.CHARACTER_SET=4]="CHARACTER_SET",je[je.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",je[je.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",je[je.ASSUME_GS1=7]="ASSUME_GS1",je[je.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",je[je.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",je[je.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Q||(Q={}));var U=Q;class $ extends d{static getFormatInstance(){return new $}}$.kind="FormatException";var ee;(function(je){je[je.Cp437=0]="Cp437",je[je.ISO8859_1=1]="ISO8859_1",je[je.ISO8859_2=2]="ISO8859_2",je[je.ISO8859_3=3]="ISO8859_3",je[je.ISO8859_4=4]="ISO8859_4",je[je.ISO8859_5=5]="ISO8859_5",je[je.ISO8859_6=6]="ISO8859_6",je[je.ISO8859_7=7]="ISO8859_7",je[je.ISO8859_8=8]="ISO8859_8",je[je.ISO8859_9=9]="ISO8859_9",je[je.ISO8859_10=10]="ISO8859_10",je[je.ISO8859_11=11]="ISO8859_11",je[je.ISO8859_13=12]="ISO8859_13",je[je.ISO8859_14=13]="ISO8859_14",je[je.ISO8859_15=14]="ISO8859_15",je[je.ISO8859_16=15]="ISO8859_16",je[je.SJIS=16]="SJIS",je[je.Cp1250=17]="Cp1250",je[je.Cp1251=18]="Cp1251",je[je.Cp1252=19]="Cp1252",je[je.Cp1256=20]="Cp1256",je[je.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",je[je.UTF8=22]="UTF8",je[je.ASCII=23]="ASCII",je[je.Big5=24]="Big5",je[je.GB18030=25]="GB18030",je[je.EUC_KR=26]="EUC_KR"})(ee||(ee={}));class F{constructor(h,g,b,...S){this.valueIdentifier=h,this.name=b,typeof g=="number"?this.values=Int32Array.from([g]):this.values=g,this.otherEncodingNames=S,F.VALUE_IDENTIFIER_TO_ECI.set(h,this),F.NAME_TO_ECI.set(b,this);const N=this.values;for(let I=0,R=N.length;I!==R;I++){const H=N[I];F.VALUES_TO_ECI.set(H,this)}for(const I of S)F.NAME_TO_ECI.set(I,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(h){if(h<0||h>=900)throw new $("incorect value");const g=F.VALUES_TO_ECI.get(h);if(g===void 0)throw new $("incorect value");return g}static getCharacterSetECIByName(h){const g=F.NAME_TO_ECI.get(h);if(g===void 0)throw new $("incorect value");return g}equals(h){if(!(h instanceof F))return!1;const g=h;return this.getName()===g.getName()}}F.VALUE_IDENTIFIER_TO_ECI=new Map,F.VALUES_TO_ECI=new Map,F.NAME_TO_ECI=new Map,F.Cp437=new F(ee.Cp437,Int32Array.from([0,2]),"Cp437"),F.ISO8859_1=new F(ee.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),F.ISO8859_2=new F(ee.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),F.ISO8859_3=new F(ee.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),F.ISO8859_4=new F(ee.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),F.ISO8859_5=new F(ee.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),F.ISO8859_6=new F(ee.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),F.ISO8859_7=new F(ee.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),F.ISO8859_8=new F(ee.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),F.ISO8859_9=new F(ee.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),F.ISO8859_10=new F(ee.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),F.ISO8859_11=new F(ee.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),F.ISO8859_13=new F(ee.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),F.ISO8859_14=new F(ee.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),F.ISO8859_15=new F(ee.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),F.ISO8859_16=new F(ee.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),F.SJIS=new F(ee.SJIS,20,"SJIS","Shift_JIS"),F.Cp1250=new F(ee.Cp1250,21,"Cp1250","windows-1250"),F.Cp1251=new F(ee.Cp1251,22,"Cp1251","windows-1251"),F.Cp1252=new F(ee.Cp1252,23,"Cp1252","windows-1252"),F.Cp1256=new F(ee.Cp1256,24,"Cp1256","windows-1256"),F.UnicodeBigUnmarked=new F(ee.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),F.UTF8=new F(ee.UTF8,26,"UTF8","UTF-8"),F.ASCII=new F(ee.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),F.Big5=new F(ee.Big5,28,"Big5"),F.GB18030=new F(ee.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),F.EUC_KR=new F(ee.EUC_KR,30,"EUC_KR","EUC-KR");class Y extends d{}Y.kind="UnsupportedOperationException";class J{static decode(h,g){const b=this.encodingName(g);return this.customDecoder?this.customDecoder(h,b):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(b)?this.decodeFallback(h,b):new TextDecoder(b).decode(h)}static shouldDecodeOnFallback(h){return!J.isBrowser()&&h==="ISO-8859-1"}static encode(h,g){const b=this.encodingName(g);return this.customEncoder?this.customEncoder(h,b):typeof TextEncoder>"u"?this.encodeFallback(h):new TextEncoder().encode(h)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(h){return typeof h=="string"?h:h.getName()}static encodingCharacterSet(h){return h instanceof F?h:F.getCharacterSetECIByName(h)}static decodeFallback(h,g){const b=this.encodingCharacterSet(g);if(J.isDecodeFallbackSupported(b)){let S="";for(let N=0,I=h.length;N<I;N++){let R=h[N].toString(16);R.length<2&&(R="0"+R),S+="%"+R}return decodeURIComponent(S)}if(b.equals(F.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(h.buffer));throw new Y(`Encoding ${this.encodingName(g)} not supported by fallback.`)}static isDecodeFallbackSupported(h){return h.equals(F.UTF8)||h.equals(F.ISO8859_1)||h.equals(F.ASCII)}static encodeFallback(h){const b=btoa(unescape(encodeURIComponent(h))).split(""),S=[];for(let N=0;N<b.length;N++)S.push(b[N].charCodeAt(0));return new Uint8Array(S)}}class Z{static castAsNonUtf8Char(h,g=null){const b=g?g.getName():this.ISO88591;return J.decode(new Uint8Array([h]),b)}static guessEncoding(h,g){if(g!=null&&g.get(U.CHARACTER_SET)!==void 0)return g.get(U.CHARACTER_SET).toString();const b=h.length;let S=!0,N=!0,I=!0,R=0,H=0,ne=0,he=0,ve=0,Ne=0,Me=0,qe=0,$e=0,Xe=0,ct=0;const Tt=h.length>3&&h[0]===239&&h[1]===187&&h[2]===191;for(let _t=0;_t<b&&(S||N||I);_t++){const At=h[_t]&255;I&&(R>0?(At&128)===0?I=!1:R--:(At&128)!==0&&((At&64)===0?I=!1:(R++,(At&32)===0?H++:(R++,(At&16)===0?ne++:(R++,(At&8)===0?he++:I=!1))))),S&&(At>127&&At<160?S=!1:At>159&&(At<192||At===215||At===247)&&ct++),N&&(ve>0?At<64||At===127||At>252?N=!1:ve--:At===128||At===160||At>239?N=!1:At>160&&At<224?(Ne++,qe=0,Me++,Me>$e&&($e=Me)):At>127?(ve++,Me=0,qe++,qe>Xe&&(Xe=qe)):(Me=0,qe=0))}return I&&R>0&&(I=!1),N&&ve>0&&(N=!1),I&&(Tt||H+ne+he>0)?Z.UTF8:N&&(Z.ASSUME_SHIFT_JIS||$e>=3||Xe>=3)?Z.SHIFT_JIS:S&&N?$e===2&&Ne===2||ct*10>=b?Z.SHIFT_JIS:Z.ISO88591:S?Z.ISO88591:N?Z.SHIFT_JIS:I?Z.UTF8:Z.PLATFORM_DEFAULT_ENCODING}static format(h,...g){let b=-1;function S(I,R,H,ne,he,ve){if(I==="%%")return"%";if(g[++b]===void 0)return;I=ne?parseInt(ne.substr(1)):void 0;let Ne=he?parseInt(he.substr(1)):void 0,Me;switch(ve){case"s":Me=g[b];break;case"c":Me=g[b][0];break;case"f":Me=parseFloat(g[b]).toFixed(I);break;case"p":Me=parseFloat(g[b]).toPrecision(I);break;case"e":Me=parseFloat(g[b]).toExponential(I);break;case"x":Me=parseInt(g[b]).toString(Ne||16);break;case"d":Me=parseFloat(parseInt(g[b],Ne||10).toPrecision(I)).toFixed(0);break}Me=typeof Me=="object"?JSON.stringify(Me):(+Me).toString(Ne);let qe=parseInt(H),$e=H&&H[0]+""=="0"?"0":" ";for(;Me.length<qe;)Me=R!==void 0?Me+$e:$e+Me;return Me}let N=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return h.replace(N,S)}static getBytes(h,g){return J.encode(h,g)}static getCharCode(h,g=0){return h.charCodeAt(g)}static getCharAt(h){return String.fromCharCode(h)}}Z.SHIFT_JIS=F.SJIS.getName(),Z.GB2312="GB2312",Z.ISO88591=F.ISO8859_1.getName(),Z.EUC_JP="EUC_JP",Z.UTF8=F.UTF8.getName(),Z.PLATFORM_DEFAULT_ENCODING=Z.UTF8,Z.ASSUME_SHIFT_JIS=!1;class re{constructor(h=""){this.value=h}enableDecoding(h){return this.encoding=h,this}append(h){return typeof h=="string"?this.value+=h.toString():this.encoding?this.value+=Z.castAsNonUtf8Char(h,this.encoding):this.value+=String.fromCharCode(h),this}appendChars(h,g,b){for(let S=g;g<g+b;S++)this.append(h[S]);return this}length(){return this.value.length}charAt(h){return this.value.charAt(h)}deleteCharAt(h){this.value=this.value.substr(0,h)+this.value.substring(h+1)}setCharAt(h,g){this.value=this.value.substr(0,h)+g+this.value.substr(h+1)}substring(h,g){return this.value.substring(h,g)}setLengthToZero(){this.value=""}toString(){return this.value}insert(h,g){this.value=this.value.substr(0,h)+g+this.value.substr(h+g.length)}}class de{constructor(h,g,b,S){if(this.width=h,this.height=g,this.rowSize=b,this.bits=S,g==null&&(g=h),this.height=g,h<1||g<1)throw new p("Both dimensions must be greater than 0");b==null&&(b=Math.floor((h+31)/32)),this.rowSize=b,S==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(h){const g=h.length,b=h[0].length,S=new de(b,g);for(let N=0;N<g;N++){const I=h[N];for(let R=0;R<b;R++)I[R]&&S.set(R,N)}return S}static parseFromString(h,g,b){if(h===null)throw new p("stringRepresentation cannot be null");const S=new Array(h.length);let N=0,I=0,R=-1,H=0,ne=0;for(;ne<h.length;)if(h.charAt(ne)===`
`||h.charAt(ne)==="\r"){if(N>I){if(R===-1)R=N-I;else if(N-I!==R)throw new p("row lengths do not match");I=N,H++}ne++}else if(h.substring(ne,ne+g.length)===g)ne+=g.length,S[N]=!0,N++;else if(h.substring(ne,ne+b.length)===b)ne+=b.length,S[N]=!1,N++;else throw new p("illegal character encountered: "+h.substring(ne));if(N>I){if(R===-1)R=N-I;else if(N-I!==R)throw new p("row lengths do not match");H++}const he=new de(R,H);for(let ve=0;ve<N;ve++)S[ve]&&he.set(Math.floor(ve%R),Math.floor(ve/R));return he}get(h,g){const b=g*this.rowSize+Math.floor(h/32);return(this.bits[b]>>>(h&31)&1)!==0}set(h,g){const b=g*this.rowSize+Math.floor(h/32);this.bits[b]|=1<<(h&31)&4294967295}unset(h,g){const b=g*this.rowSize+Math.floor(h/32);this.bits[b]&=~(1<<(h&31)&4294967295)}flip(h,g){const b=g*this.rowSize+Math.floor(h/32);this.bits[b]^=1<<(h&31)&4294967295}xor(h){if(this.width!==h.getWidth()||this.height!==h.getHeight()||this.rowSize!==h.getRowSize())throw new p("input matrix dimensions do not match");const g=new M(Math.floor(this.width/32)+1),b=this.rowSize,S=this.bits;for(let N=0,I=this.height;N<I;N++){const R=N*b,H=h.getRow(N,g).getBitArray();for(let ne=0;ne<b;ne++)S[R+ne]^=H[ne]}}clear(){const h=this.bits,g=h.length;for(let b=0;b<g;b++)h[b]=0}setRegion(h,g,b,S){if(g<0||h<0)throw new p("Left and top must be nonnegative");if(S<1||b<1)throw new p("Height and width must be at least 1");const N=h+b,I=g+S;if(I>this.height||N>this.width)throw new p("The region must fit inside the matrix");const R=this.rowSize,H=this.bits;for(let ne=g;ne<I;ne++){const he=ne*R;for(let ve=h;ve<N;ve++)H[he+Math.floor(ve/32)]|=1<<(ve&31)&4294967295}}getRow(h,g){g==null||g.getSize()<this.width?g=new M(this.width):g.clear();const b=this.rowSize,S=this.bits,N=h*b;for(let I=0;I<b;I++)g.setBulk(I*32,S[N+I]);return g}setRow(h,g){C.arraycopy(g.getBitArray(),0,this.bits,h*this.rowSize,this.rowSize)}rotate180(){const h=this.getWidth(),g=this.getHeight();let b=new M(h),S=new M(h);for(let N=0,I=Math.floor((g+1)/2);N<I;N++)b=this.getRow(N,b),S=this.getRow(g-1-N,S),b.reverse(),S.reverse(),this.setRow(N,S),this.setRow(g-1-N,b)}getEnclosingRectangle(){const h=this.width,g=this.height,b=this.rowSize,S=this.bits;let N=h,I=g,R=-1,H=-1;for(let ne=0;ne<g;ne++)for(let he=0;he<b;he++){const ve=S[ne*b+he];if(ve!==0){if(ne<I&&(I=ne),ne>H&&(H=ne),he*32<N){let Ne=0;for(;(ve<<31-Ne&4294967295)===0;)Ne++;he*32+Ne<N&&(N=he*32+Ne)}if(he*32+31>R){let Ne=31;for(;!(ve>>>Ne);)Ne--;he*32+Ne>R&&(R=he*32+Ne)}}}return R<N||H<I?null:Int32Array.from([N,I,R-N+1,H-I+1])}getTopLeftOnBit(){const h=this.rowSize,g=this.bits;let b=0;for(;b<g.length&&g[b]===0;)b++;if(b===g.length)return null;const S=b/h;let N=b%h*32;const I=g[b];let R=0;for(;(I<<31-R&4294967295)===0;)R++;return N+=R,Int32Array.from([N,S])}getBottomRightOnBit(){const h=this.rowSize,g=this.bits;let b=g.length-1;for(;b>=0&&g[b]===0;)b--;if(b<0)return null;const S=Math.floor(b/h);let N=Math.floor(b%h)*32;const I=g[b];let R=31;for(;!(I>>>R);)R--;return N+=R,Int32Array.from([N,S])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(h){if(!(h instanceof de))return!1;const g=h;return this.width===g.width&&this.height===g.height&&this.rowSize===g.rowSize&&O.equals(this.bits,g.bits)}hashCode(){let h=this.width;return h=31*h+this.width,h=31*h+this.height,h=31*h+this.rowSize,h=31*h+O.hashCode(this.bits),h}toString(h="X ",g="  ",b=`
`){return this.buildToString(h,g,b)}buildToString(h,g,b){let S=new re;for(let N=0,I=this.height;N<I;N++){for(let R=0,H=this.width;R<H;R++)S.append(this.get(R,N)?h:g);S.append(b)}return S.toString()}clone(){return new de(this.width,this.height,this.rowSize,this.bits.slice())}}class le extends d{static getNotFoundInstance(){return new le}}le.kind="NotFoundException";class K extends w{constructor(h){super(h),this.luminances=K.EMPTY,this.buckets=new Int32Array(K.LUMINANCE_BUCKETS)}getBlackRow(h,g){const b=this.getLuminanceSource(),S=b.getWidth();g==null||g.getSize()<S?g=new M(S):g.clear(),this.initArrays(S);const N=b.getRow(h,this.luminances),I=this.buckets;for(let H=0;H<S;H++)I[(N[H]&255)>>K.LUMINANCE_SHIFT]++;const R=K.estimateBlackPoint(I);if(S<3)for(let H=0;H<S;H++)(N[H]&255)<R&&g.set(H);else{let H=N[0]&255,ne=N[1]&255;for(let he=1;he<S-1;he++){const ve=N[he+1]&255;(ne*4-H-ve)/2<R&&g.set(he),H=ne,ne=ve}}return g}getBlackMatrix(){const h=this.getLuminanceSource(),g=h.getWidth(),b=h.getHeight(),S=new de(g,b);this.initArrays(g);const N=this.buckets;for(let H=1;H<5;H++){const ne=Math.floor(b*H/5),he=h.getRow(ne,this.luminances),ve=Math.floor(g*4/5);for(let Ne=Math.floor(g/5);Ne<ve;Ne++){const Me=he[Ne]&255;N[Me>>K.LUMINANCE_SHIFT]++}}const I=K.estimateBlackPoint(N),R=h.getMatrix();for(let H=0;H<b;H++){const ne=H*g;for(let he=0;he<g;he++)(R[ne+he]&255)<I&&S.set(he,H)}return S}createBinarizer(h){return new K(h)}initArrays(h){this.luminances.length<h&&(this.luminances=new Uint8ClampedArray(h));const g=this.buckets;for(let b=0;b<K.LUMINANCE_BUCKETS;b++)g[b]=0}static estimateBlackPoint(h){const g=h.length;let b=0,S=0,N=0;for(let he=0;he<g;he++)h[he]>N&&(S=he,N=h[he]),h[he]>b&&(b=h[he]);let I=0,R=0;for(let he=0;he<g;he++){const ve=he-S,Ne=h[he]*ve*ve;Ne>R&&(I=he,R=Ne)}if(S>I){const he=S;S=I,I=he}if(I-S<=g/16)throw new le;let H=I-1,ne=-1;for(let he=I-1;he>S;he--){const ve=he-S,Ne=ve*ve*(I-he)*(b-h[he]);Ne>ne&&(H=he,ne=Ne)}return H<<K.LUMINANCE_SHIFT}}K.LUMINANCE_BITS=5,K.LUMINANCE_SHIFT=8-K.LUMINANCE_BITS,K.LUMINANCE_BUCKETS=1<<K.LUMINANCE_BITS,K.EMPTY=Uint8ClampedArray.from([0]);class ue extends K{constructor(h){super(h),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const h=this.getLuminanceSource(),g=h.getWidth(),b=h.getHeight();if(g>=ue.MINIMUM_DIMENSION&&b>=ue.MINIMUM_DIMENSION){const S=h.getMatrix();let N=g>>ue.BLOCK_SIZE_POWER;(g&ue.BLOCK_SIZE_MASK)!==0&&N++;let I=b>>ue.BLOCK_SIZE_POWER;(b&ue.BLOCK_SIZE_MASK)!==0&&I++;const R=ue.calculateBlackPoints(S,N,I,g,b),H=new de(g,b);ue.calculateThresholdForBlock(S,N,I,g,b,R,H),this.matrix=H}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(h){return new ue(h)}static calculateThresholdForBlock(h,g,b,S,N,I,R){const H=N-ue.BLOCK_SIZE,ne=S-ue.BLOCK_SIZE;for(let he=0;he<b;he++){let ve=he<<ue.BLOCK_SIZE_POWER;ve>H&&(ve=H);const Ne=ue.cap(he,2,b-3);for(let Me=0;Me<g;Me++){let qe=Me<<ue.BLOCK_SIZE_POWER;qe>ne&&(qe=ne);const $e=ue.cap(Me,2,g-3);let Xe=0;for(let Tt=-2;Tt<=2;Tt++){const _t=I[Ne+Tt];Xe+=_t[$e-2]+_t[$e-1]+_t[$e]+_t[$e+1]+_t[$e+2]}const ct=Xe/25;ue.thresholdBlock(h,qe,ve,ct,S,R)}}}static cap(h,g,b){return h<g?g:h>b?b:h}static thresholdBlock(h,g,b,S,N,I){for(let R=0,H=b*N+g;R<ue.BLOCK_SIZE;R++,H+=N)for(let ne=0;ne<ue.BLOCK_SIZE;ne++)(h[H+ne]&255)<=S&&I.set(g+ne,b+R)}static calculateBlackPoints(h,g,b,S,N){const I=N-ue.BLOCK_SIZE,R=S-ue.BLOCK_SIZE,H=new Array(b);for(let ne=0;ne<b;ne++){H[ne]=new Int32Array(g);let he=ne<<ue.BLOCK_SIZE_POWER;he>I&&(he=I);for(let ve=0;ve<g;ve++){let Ne=ve<<ue.BLOCK_SIZE_POWER;Ne>R&&(Ne=R);let Me=0,qe=255,$e=0;for(let ct=0,Tt=he*S+Ne;ct<ue.BLOCK_SIZE;ct++,Tt+=S){for(let _t=0;_t<ue.BLOCK_SIZE;_t++){const At=h[Tt+_t]&255;Me+=At,At<qe&&(qe=At),At>$e&&($e=At)}if($e-qe>ue.MIN_DYNAMIC_RANGE)for(ct++,Tt+=S;ct<ue.BLOCK_SIZE;ct++,Tt+=S)for(let _t=0;_t<ue.BLOCK_SIZE;_t++)Me+=h[Tt+_t]&255}let Xe=Me>>ue.BLOCK_SIZE_POWER*2;if($e-qe<=ue.MIN_DYNAMIC_RANGE&&(Xe=qe/2,ne>0&&ve>0)){const ct=(H[ne-1][ve]+2*H[ne][ve-1]+H[ne-1][ve-1])/4;qe<ct&&(Xe=ct)}H[ne][ve]=Xe}}return H}}ue.BLOCK_SIZE_POWER=3,ue.BLOCK_SIZE=1<<ue.BLOCK_SIZE_POWER,ue.BLOCK_SIZE_MASK=ue.BLOCK_SIZE-1,ue.MINIMUM_DIMENSION=ue.BLOCK_SIZE*5,ue.MIN_DYNAMIC_RANGE=24;class ce{constructor(h,g){this.width=h,this.height=g}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(h,g,b,S){throw new Y("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Y("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Y("This luminance source does not support rotation by 45 degrees.")}toString(){const h=new Uint8ClampedArray(this.width);let g=new re;for(let b=0;b<this.height;b++){const S=this.getRow(b,h);for(let N=0;N<this.width;N++){const I=S[N]&255;let R;I<64?R="#":I<128?R="+":I<192?R=".":R=" ",g.append(R)}g.append(`
`)}return g.toString()}}class ye extends ce{constructor(h){super(h.getWidth(),h.getHeight()),this.delegate=h}getRow(h,g){const b=this.delegate.getRow(h,g),S=this.getWidth();for(let N=0;N<S;N++)b[N]=255-(b[N]&255);return b}getMatrix(){const h=this.delegate.getMatrix(),g=this.getWidth()*this.getHeight(),b=new Uint8ClampedArray(g);for(let S=0;S<g;S++)b[S]=255-(h[S]&255);return b}isCropSupported(){return this.delegate.isCropSupported()}crop(h,g,b,S){return new ye(this.delegate.crop(h,g,b,S))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new ye(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new ye(this.delegate.rotateCounterClockwise45())}}class Se extends ce{constructor(h){super(h.width,h.height),this.canvas=h,this.tempCanvasElement=null,this.buffer=Se.makeBufferFromCanvasImageData(h)}static makeBufferFromCanvasImageData(h){const g=h.getContext("2d").getImageData(0,0,h.width,h.height);return Se.toGrayscaleBuffer(g.data,h.width,h.height)}static toGrayscaleBuffer(h,g,b){const S=new Uint8ClampedArray(g*b);for(let N=0,I=0,R=h.length;N<R;N+=4,I++){let H;if(h[N+3]===0)H=255;else{const he=h[N],ve=h[N+1],Ne=h[N+2];H=306*he+601*ve+117*Ne+512>>10}S[I]=H}return S}getRow(h,g){if(h<0||h>=this.getHeight())throw new p("Requested row is outside the image: "+h);const b=this.getWidth(),S=h*b;return g===null?g=this.buffer.slice(S,S+b):(g.length<b&&(g=new Uint8ClampedArray(b)),g.set(this.buffer.slice(S,S+b))),g}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(h,g,b,S){return super.crop(h,g,b,S),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const h=this.canvas.ownerDocument.createElement("canvas");h.width=this.canvas.width,h.height=this.canvas.height,this.tempCanvasElement=h}return this.tempCanvasElement}rotate(h){const g=this.getTempCanvasElement(),b=g.getContext("2d"),S=h*Se.DEGREE_TO_RADIANS,N=this.canvas.width,I=this.canvas.height,R=Math.ceil(Math.abs(Math.cos(S))*N+Math.abs(Math.sin(S))*I),H=Math.ceil(Math.abs(Math.sin(S))*N+Math.abs(Math.cos(S))*I);return g.width=R,g.height=H,b.translate(R/2,H/2),b.rotate(S),b.drawImage(this.canvas,N/-2,I/-2),this.buffer=Se.makeBufferFromCanvasImageData(g),this}invert(){return new ye(this)}}Se.DEGREE_TO_RADIANS=Math.PI/180;class V{constructor(h,g,b){this.deviceId=h,this.label=g,this.kind="videoinput",this.groupId=b||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var X=(globalThis||Rx||self||window||void 0)&&(globalThis||Rx||self||window||void 0).__awaiter||function(je,h,g,b){function S(N){return N instanceof g?N:new g(function(I){I(N)})}return new(g||(g=Promise))(function(N,I){function R(he){try{ne(b.next(he))}catch(ve){I(ve)}}function H(he){try{ne(b.throw(he))}catch(ve){I(ve)}}function ne(he){he.done?N(he.value):S(he.value).then(R,H)}ne((b=b.apply(je,h||[])).next())})};class se{constructor(h,g=500,b){this.reader=h,this.timeBetweenScansMillis=g,this._hints=b,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(h){this._timeBetweenDecodingAttempts=h<0?0:h}set hints(h){this._hints=h||null}get hints(){return this._hints}listVideoInputDevices(){return X(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const h=yield navigator.mediaDevices.enumerateDevices(),g=[];for(const b of h){const S=b.kind==="video"?"videoinput":b.kind;if(S!=="videoinput")continue;const N=b.deviceId||b.id,I=b.label||`Video device ${g.length+1}`,R=b.groupId,H={deviceId:N,label:I,kind:S,groupId:R};g.push(H)}return g})}getVideoInputDevices(){return X(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(g=>new V(g.deviceId,g.label))})}findDeviceById(h){return X(this,void 0,void 0,function*(){const g=yield this.listVideoInputDevices();return g?g.find(b=>b.deviceId===h):null})}decodeFromInputVideoDevice(h,g){return X(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(h,g)})}decodeOnceFromVideoDevice(h,g){return X(this,void 0,void 0,function*(){this.reset();let b;h?b={deviceId:{exact:h}}:b={facingMode:"environment"};const S={video:b};return yield this.decodeOnceFromConstraints(S,g)})}decodeOnceFromConstraints(h,g){return X(this,void 0,void 0,function*(){const b=yield navigator.mediaDevices.getUserMedia(h);return yield this.decodeOnceFromStream(b,g)})}decodeOnceFromStream(h,g){return X(this,void 0,void 0,function*(){this.reset();const b=yield this.attachStreamToVideo(h,g);return yield this.decodeOnce(b)})}decodeFromInputVideoDeviceContinuously(h,g,b){return X(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(h,g,b)})}decodeFromVideoDevice(h,g,b){return X(this,void 0,void 0,function*(){let S;h?S={deviceId:{exact:h}}:S={facingMode:"environment"};const N={video:S};return yield this.decodeFromConstraints(N,g,b)})}decodeFromConstraints(h,g,b){return X(this,void 0,void 0,function*(){const S=yield navigator.mediaDevices.getUserMedia(h);return yield this.decodeFromStream(S,g,b)})}decodeFromStream(h,g,b){return X(this,void 0,void 0,function*(){this.reset();const S=yield this.attachStreamToVideo(h,g);return yield this.decodeContinuously(S,b)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(h,g){return X(this,void 0,void 0,function*(){const b=this.prepareVideoElement(g);return this.addVideoSource(b,h),this.videoElement=b,this.stream=h,yield this.playVideoOnLoadAsync(b),b})}playVideoOnLoadAsync(h){return new Promise((g,b)=>this.playVideoOnLoad(h,()=>g()))}playVideoOnLoad(h,g){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(h),h.addEventListener("ended",this.videoEndedListener),h.addEventListener("canplay",this.videoCanPlayListener),h.addEventListener("playing",g),this.tryPlayVideo(h)}isVideoPlaying(h){return h.currentTime>0&&!h.paused&&!h.ended&&h.readyState>2}tryPlayVideo(h){return X(this,void 0,void 0,function*(){if(this.isVideoPlaying(h)){console.warn("Trying to play video that is already playing.");return}try{yield h.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(h,g){const b=document.getElementById(h);if(!b)throw new f(`element with id '${h}' not found`);if(b.nodeName.toLowerCase()!==g.toLowerCase())throw new f(`element with id '${h}' must be an ${g} element`);return b}decodeFromImage(h,g){if(!h&&!g)throw new f("either imageElement with a src set or an url must be provided");return g&&!h?this.decodeFromImageUrl(g):this.decodeFromImageElement(h)}decodeFromVideo(h,g){if(!h&&!g)throw new f("Either an element with a src set or an URL must be provided");return g&&!h?this.decodeFromVideoUrl(g):this.decodeFromVideoElement(h)}decodeFromVideoContinuously(h,g,b){if(h===void 0&&g===void 0)throw new f("Either an element with a src set or an URL must be provided");return g&&!h?this.decodeFromVideoUrlContinuously(g,b):this.decodeFromVideoElementContinuously(h,b)}decodeFromImageElement(h){if(!h)throw new f("An image element must be provided.");this.reset();const g=this.prepareImageElement(h);this.imageElement=g;let b;return this.isImageLoaded(g)?b=this.decodeOnce(g,!1,!0):b=this._decodeOnLoadImage(g),b}decodeFromVideoElement(h){const g=this._decodeFromVideoElementSetup(h);return this._decodeOnLoadVideo(g)}decodeFromVideoElementContinuously(h,g){const b=this._decodeFromVideoElementSetup(h);return this._decodeOnLoadVideoContinuously(b,g)}_decodeFromVideoElementSetup(h){if(!h)throw new f("A video element must be provided.");this.reset();const g=this.prepareVideoElement(h);return this.videoElement=g,g}decodeFromImageUrl(h){if(!h)throw new f("An URL must be provided.");this.reset();const g=this.prepareImageElement();this.imageElement=g;const b=this._decodeOnLoadImage(g);return g.src=h,b}decodeFromVideoUrl(h){if(!h)throw new f("An URL must be provided.");this.reset();const g=this.prepareVideoElement(),b=this.decodeFromVideoElement(g);return g.src=h,b}decodeFromVideoUrlContinuously(h,g){if(!h)throw new f("An URL must be provided.");this.reset();const b=this.prepareVideoElement(),S=this.decodeFromVideoElementContinuously(b,g);return b.src=h,S}_decodeOnLoadImage(h){return new Promise((g,b)=>{this.imageLoadedListener=()=>this.decodeOnce(h,!1,!0).then(g,b),h.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(h){return X(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(h),yield this.decodeOnce(h)})}_decodeOnLoadVideoContinuously(h,g){return X(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(h),this.decodeContinuously(h,g)})}isImageLoaded(h){return!(!h.complete||h.naturalWidth===0)}prepareImageElement(h){let g;return typeof h>"u"&&(g=document.createElement("img"),g.width=200,g.height=200),typeof h=="string"&&(g=this.getMediaElement(h,"img")),h instanceof HTMLImageElement&&(g=h),g}prepareVideoElement(h){let g;return!h&&typeof document<"u"&&(g=document.createElement("video"),g.width=200,g.height=200),typeof h=="string"&&(g=this.getMediaElement(h,"video")),h instanceof HTMLVideoElement&&(g=h),g.setAttribute("autoplay","true"),g.setAttribute("muted","true"),g.setAttribute("playsinline","true"),g}decodeOnce(h,g=!0,b=!0){this._stopAsyncDecode=!1;const S=(N,I)=>{if(this._stopAsyncDecode){I(new le("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const R=this.decode(h);N(R)}catch(R){const H=g&&R instanceof le,he=(R instanceof v||R instanceof $)&&b;if(H||he)return setTimeout(S,this._timeBetweenDecodingAttempts,N,I);I(R)}};return new Promise((N,I)=>S(N,I))}decodeContinuously(h,g){this._stopContinuousDecode=!1;const b=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const S=this.decode(h);g(S,null),setTimeout(b,this.timeBetweenScansMillis)}catch(S){g(null,S);const N=S instanceof v||S instanceof $,I=S instanceof le;(N||I)&&setTimeout(b,this._timeBetweenDecodingAttempts)}};b()}decode(h){const g=this.createBinaryBitmap(h);return this.decodeBitmap(g)}_isHTMLVideoElement(h){return h.videoWidth!==0}drawFrameOnCanvas(h,g,b){g||(g={sx:0,sy:0,sWidth:h.videoWidth,sHeight:h.videoHeight,dx:0,dy:0,dWidth:h.videoWidth,dHeight:h.videoHeight}),b||(b=this.captureCanvasContext),b.drawImage(h,g.sx,g.sy,g.sWidth,g.sHeight,g.dx,g.dy,g.dWidth,g.dHeight)}drawImageOnCanvas(h,g,b=this.captureCanvasContext){g||(g={sx:0,sy:0,sWidth:h.naturalWidth,sHeight:h.naturalHeight,dx:0,dy:0,dWidth:h.naturalWidth,dHeight:h.naturalHeight}),b||(b=this.captureCanvasContext),b.drawImage(h,g.sx,g.sy,g.sWidth,g.sHeight,g.dx,g.dy,g.dWidth,g.dHeight)}createBinaryBitmap(h){this.getCaptureCanvasContext(h),this._isHTMLVideoElement(h)?this.drawFrameOnCanvas(h):this.drawImageOnCanvas(h);const g=this.getCaptureCanvas(h),b=new Se(g),S=new ue(b);return new x(S)}getCaptureCanvasContext(h){if(!this.captureCanvasContext){const b=this.getCaptureCanvas(h).getContext("2d");this.captureCanvasContext=b}return this.captureCanvasContext}getCaptureCanvas(h){if(!this.captureCanvas){const g=this.createCaptureCanvas(h);this.captureCanvas=g}return this.captureCanvas}decodeBitmap(h){return this.reader.decode(h,this._hints)}createCaptureCanvas(h){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const g=document.createElement("canvas");let b,S;return typeof h<"u"&&(h instanceof HTMLVideoElement?(b=h.videoWidth,S=h.videoHeight):h instanceof HTMLImageElement&&(b=h.naturalWidth||h.width,S=h.naturalHeight||h.height)),g.style.width=b+"px",g.style.height=S+"px",g.width=b,g.height=S,g}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(h=>h.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(h,g){try{h.srcObject=g}catch{h.src=URL.createObjectURL(g)}}cleanVideoSource(h){try{h.srcObject=null}catch{h.src=""}this.videoElement.removeAttribute("src")}}class W{constructor(h,g,b=g==null?0:8*g.length,S,N,I=C.currentTimeMillis()){this.text=h,this.rawBytes=g,this.numBits=b,this.resultPoints=S,this.format=N,this.timestamp=I,this.text=h,this.rawBytes=g,b==null?this.numBits=g==null?0:8*g.length:this.numBits=b,this.resultPoints=S,this.format=N,this.resultMetadata=null,I==null?this.timestamp=C.currentTimeMillis():this.timestamp=I}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(h,g){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(h,g)}putAllMetadata(h){h!==null&&(this.resultMetadata===null?this.resultMetadata=h:this.resultMetadata=new Map(h))}addResultPoints(h){const g=this.resultPoints;if(g===null)this.resultPoints=h;else if(h!==null&&h.length>0){const b=new Array(g.length+h.length);C.arraycopy(g,0,b,0,g.length),C.arraycopy(h,0,b,g.length,h.length),this.resultPoints=b}}getTimestamp(){return this.timestamp}toString(){return this.text}}var oe;(function(je){je[je.AZTEC=0]="AZTEC",je[je.CODABAR=1]="CODABAR",je[je.CODE_39=2]="CODE_39",je[je.CODE_93=3]="CODE_93",je[je.CODE_128=4]="CODE_128",je[je.DATA_MATRIX=5]="DATA_MATRIX",je[je.EAN_8=6]="EAN_8",je[je.EAN_13=7]="EAN_13",je[je.ITF=8]="ITF",je[je.MAXICODE=9]="MAXICODE",je[je.PDF_417=10]="PDF_417",je[je.QR_CODE=11]="QR_CODE",je[je.RSS_14=12]="RSS_14",je[je.RSS_EXPANDED=13]="RSS_EXPANDED",je[je.UPC_A=14]="UPC_A",je[je.UPC_E=15]="UPC_E",je[je.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(oe||(oe={}));var ge=oe,be;(function(je){je[je.OTHER=0]="OTHER",je[je.ORIENTATION=1]="ORIENTATION",je[je.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",je[je.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",je[je.ISSUE_NUMBER=4]="ISSUE_NUMBER",je[je.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",je[je.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",je[je.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",je[je.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",je[je.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",je[je.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(be||(be={}));var Le=be;class ke{constructor(h,g,b,S,N=-1,I=-1){this.rawBytes=h,this.text=g,this.byteSegments=b,this.ecLevel=S,this.structuredAppendSequenceNumber=N,this.structuredAppendParity=I,this.numBits=h==null?0:8*h.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(h){this.numBits=h}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(h){this.errorsCorrected=h}getErasures(){return this.erasures}setErasures(h){this.erasures=h}getOther(){return this.other}setOther(h){this.other=h}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class He{exp(h){return this.expTable[h]}log(h){if(h===0)throw new p;return this.logTable[h]}static addOrSubtract(h,g){return h^g}}class Je{constructor(h,g){if(g.length===0)throw new p;this.field=h;const b=g.length;if(b>1&&g[0]===0){let S=1;for(;S<b&&g[S]===0;)S++;S===b?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(b-S),C.arraycopy(g,S,this.coefficients,0,this.coefficients.length))}else this.coefficients=g}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(h){return this.coefficients[this.coefficients.length-1-h]}evaluateAt(h){if(h===0)return this.getCoefficient(0);const g=this.coefficients;let b;if(h===1){b=0;for(let I=0,R=g.length;I!==R;I++){const H=g[I];b=He.addOrSubtract(b,H)}return b}b=g[0];const S=g.length,N=this.field;for(let I=1;I<S;I++)b=He.addOrSubtract(N.multiply(h,b),g[I]);return b}addOrSubtract(h){if(!this.field.equals(h.field))throw new p("GenericGFPolys do not have same GenericGF field");if(this.isZero())return h;if(h.isZero())return this;let g=this.coefficients,b=h.coefficients;if(g.length>b.length){const I=g;g=b,b=I}let S=new Int32Array(b.length);const N=b.length-g.length;C.arraycopy(b,0,S,0,N);for(let I=N;I<b.length;I++)S[I]=He.addOrSubtract(g[I-N],b[I]);return new Je(this.field,S)}multiply(h){if(!this.field.equals(h.field))throw new p("GenericGFPolys do not have same GenericGF field");if(this.isZero()||h.isZero())return this.field.getZero();const g=this.coefficients,b=g.length,S=h.coefficients,N=S.length,I=new Int32Array(b+N-1),R=this.field;for(let H=0;H<b;H++){const ne=g[H];for(let he=0;he<N;he++)I[H+he]=He.addOrSubtract(I[H+he],R.multiply(ne,S[he]))}return new Je(R,I)}multiplyScalar(h){if(h===0)return this.field.getZero();if(h===1)return this;const g=this.coefficients.length,b=this.field,S=new Int32Array(g),N=this.coefficients;for(let I=0;I<g;I++)S[I]=b.multiply(N[I],h);return new Je(b,S)}multiplyByMonomial(h,g){if(h<0)throw new p;if(g===0)return this.field.getZero();const b=this.coefficients,S=b.length,N=new Int32Array(S+h),I=this.field;for(let R=0;R<S;R++)N[R]=I.multiply(b[R],g);return new Je(I,N)}divide(h){if(!this.field.equals(h.field))throw new p("GenericGFPolys do not have same GenericGF field");if(h.isZero())throw new p("Divide by 0");const g=this.field;let b=g.getZero(),S=this;const N=h.getCoefficient(h.getDegree()),I=g.inverse(N);for(;S.getDegree()>=h.getDegree()&&!S.isZero();){const R=S.getDegree()-h.getDegree(),H=g.multiply(S.getCoefficient(S.getDegree()),I),ne=h.multiplyByMonomial(R,H),he=g.buildMonomial(R,H);b=b.addOrSubtract(he),S=S.addOrSubtract(ne)}return[b,S]}toString(){let h="";for(let g=this.getDegree();g>=0;g--){let b=this.getCoefficient(g);if(b!==0){if(b<0?(h+=" - ",b=-b):h.length>0&&(h+=" + "),g===0||b!==1){const S=this.field.log(b);S===0?h+="1":S===1?h+="a":(h+="a^",h+=S)}g!==0&&(g===1?h+="x":(h+="x^",h+=g))}}return h}}class Qe extends d{}Qe.kind="ArithmeticException";class vt extends He{constructor(h,g,b){super(),this.primitive=h,this.size=g,this.generatorBase=b;const S=new Int32Array(g);let N=1;for(let R=0;R<g;R++)S[R]=N,N*=2,N>=g&&(N^=h,N&=g-1);this.expTable=S;const I=new Int32Array(g);for(let R=0;R<g-1;R++)I[S[R]]=R;this.logTable=I,this.zero=new Je(this,Int32Array.from([0])),this.one=new Je(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(h,g){if(h<0)throw new p;if(g===0)return this.zero;const b=new Int32Array(h+1);return b[0]=g,new Je(this,b)}inverse(h){if(h===0)throw new Qe;return this.expTable[this.size-this.logTable[h]-1]}multiply(h,g){return h===0||g===0?0:this.expTable[(this.logTable[h]+this.logTable[g])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+D.toHexString(this.primitive)+","+this.size+")"}equals(h){return h===this}}vt.AZTEC_DATA_12=new vt(4201,4096,1),vt.AZTEC_DATA_10=new vt(1033,1024,1),vt.AZTEC_DATA_6=new vt(67,64,1),vt.AZTEC_PARAM=new vt(19,16,1),vt.QR_CODE_FIELD_256=new vt(285,256,0),vt.DATA_MATRIX_FIELD_256=new vt(301,256,1),vt.AZTEC_DATA_8=vt.DATA_MATRIX_FIELD_256,vt.MAXICODE_FIELD_64=vt.AZTEC_DATA_6;class Pt extends d{}Pt.kind="ReedSolomonException";class Oe extends d{}Oe.kind="IllegalStateException";class st{constructor(h){this.field=h}decode(h,g){const b=this.field,S=new Je(b,h),N=new Int32Array(g);let I=!0;for(let Me=0;Me<g;Me++){const qe=S.evaluateAt(b.exp(Me+b.getGeneratorBase()));N[N.length-1-Me]=qe,qe!==0&&(I=!1)}if(I)return;const R=new Je(b,N),H=this.runEuclideanAlgorithm(b.buildMonomial(g,1),R,g),ne=H[0],he=H[1],ve=this.findErrorLocations(ne),Ne=this.findErrorMagnitudes(he,ve);for(let Me=0;Me<ve.length;Me++){const qe=h.length-1-b.log(ve[Me]);if(qe<0)throw new Pt("Bad error location");h[qe]=vt.addOrSubtract(h[qe],Ne[Me])}}runEuclideanAlgorithm(h,g,b){if(h.getDegree()<g.getDegree()){const Me=h;h=g,g=Me}const S=this.field;let N=h,I=g,R=S.getZero(),H=S.getOne();for(;I.getDegree()>=(b/2|0);){let Me=N,qe=R;if(N=I,R=H,N.isZero())throw new Pt("r_{i-1} was zero");I=Me;let $e=S.getZero();const Xe=N.getCoefficient(N.getDegree()),ct=S.inverse(Xe);for(;I.getDegree()>=N.getDegree()&&!I.isZero();){const Tt=I.getDegree()-N.getDegree(),_t=S.multiply(I.getCoefficient(I.getDegree()),ct);$e=$e.addOrSubtract(S.buildMonomial(Tt,_t)),I=I.addOrSubtract(N.multiplyByMonomial(Tt,_t))}if(H=$e.multiply(R).addOrSubtract(qe),I.getDegree()>=N.getDegree())throw new Oe("Division algorithm failed to reduce polynomial?")}const ne=H.getCoefficient(0);if(ne===0)throw new Pt("sigmaTilde(0) was zero");const he=S.inverse(ne),ve=H.multiplyScalar(he),Ne=I.multiplyScalar(he);return[ve,Ne]}findErrorLocations(h){const g=h.getDegree();if(g===1)return Int32Array.from([h.getCoefficient(1)]);const b=new Int32Array(g);let S=0;const N=this.field;for(let I=1;I<N.getSize()&&S<g;I++)h.evaluateAt(I)===0&&(b[S]=N.inverse(I),S++);if(S!==g)throw new Pt("Error locator degree does not match number of roots");return b}findErrorMagnitudes(h,g){const b=g.length,S=new Int32Array(b),N=this.field;for(let I=0;I<b;I++){const R=N.inverse(g[I]);let H=1;for(let ne=0;ne<b;ne++)if(I!==ne){const he=N.multiply(g[ne],R),ve=(he&1)===0?he|1:he&-2;H=N.multiply(H,ve)}S[I]=N.multiply(h.evaluateAt(R),N.inverse(H)),N.getGeneratorBase()!==0&&(S[I]=N.multiply(S[I],R))}return S}}var Wt;(function(je){je[je.UPPER=0]="UPPER",je[je.LOWER=1]="LOWER",je[je.MIXED=2]="MIXED",je[je.DIGIT=3]="DIGIT",je[je.PUNCT=4]="PUNCT",je[je.BINARY=5]="BINARY"})(Wt||(Wt={}));class Bt{decode(h){this.ddata=h;let g=h.getBits(),b=this.extractBits(g),S=this.correctBits(b),N=Bt.convertBoolArrayToByteArray(S),I=Bt.getEncodedData(S),R=new ke(N,I,null,null);return R.setNumBits(S.length),R}static highLevelDecode(h){return this.getEncodedData(h)}static getEncodedData(h){let g=h.length,b=Wt.UPPER,S=Wt.UPPER,N="",I=0;for(;I<g;)if(S===Wt.BINARY){if(g-I<5)break;let R=Bt.readCode(h,I,5);if(I+=5,R===0){if(g-I<11)break;R=Bt.readCode(h,I,11)+31,I+=11}for(let H=0;H<R;H++){if(g-I<8){I=g;break}const ne=Bt.readCode(h,I,8);N+=Z.castAsNonUtf8Char(ne),I+=8}S=b}else{let R=S===Wt.DIGIT?4:5;if(g-I<R)break;let H=Bt.readCode(h,I,R);I+=R;let ne=Bt.getCharacter(S,H);ne.startsWith("CTRL_")?(b=S,S=Bt.getTable(ne.charAt(5)),ne.charAt(6)==="L"&&(b=S)):(N+=ne,S=b)}return N}static getTable(h){switch(h){case"L":return Wt.LOWER;case"P":return Wt.PUNCT;case"M":return Wt.MIXED;case"D":return Wt.DIGIT;case"B":return Wt.BINARY;default:return Wt.UPPER}}static getCharacter(h,g){switch(h){case Wt.UPPER:return Bt.UPPER_TABLE[g];case Wt.LOWER:return Bt.LOWER_TABLE[g];case Wt.MIXED:return Bt.MIXED_TABLE[g];case Wt.PUNCT:return Bt.PUNCT_TABLE[g];case Wt.DIGIT:return Bt.DIGIT_TABLE[g];default:throw new Oe("Bad table")}}correctBits(h){let g,b;this.ddata.getNbLayers()<=2?(b=6,g=vt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(b=8,g=vt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(b=10,g=vt.AZTEC_DATA_10):(b=12,g=vt.AZTEC_DATA_12);let S=this.ddata.getNbDatablocks(),N=h.length/b;if(N<S)throw new $;let I=h.length%b,R=new Int32Array(N);for(let Ne=0;Ne<N;Ne++,I+=b)R[Ne]=Bt.readCode(h,I,b);try{new st(g).decode(R,N-S)}catch(Ne){throw new $(Ne)}let H=(1<<b)-1,ne=0;for(let Ne=0;Ne<S;Ne++){let Me=R[Ne];if(Me===0||Me===H)throw new $;(Me===1||Me===H-1)&&ne++}let he=new Array(S*b-ne),ve=0;for(let Ne=0;Ne<S;Ne++){let Me=R[Ne];if(Me===1||Me===H-1)he.fill(Me>1,ve,ve+b-1),ve+=b-1;else for(let qe=b-1;qe>=0;--qe)he[ve++]=(Me&1<<qe)!==0}return he}extractBits(h){let g=this.ddata.isCompact(),b=this.ddata.getNbLayers(),S=(g?11:14)+b*4,N=new Int32Array(S),I=new Array(this.totalBitsInLayer(b,g));if(g)for(let R=0;R<N.length;R++)N[R]=R;else{let R=S+1+2*D.truncDivision(D.truncDivision(S,2)-1,15),H=S/2,ne=D.truncDivision(R,2);for(let he=0;he<H;he++){let ve=he+D.truncDivision(he,15);N[H-he-1]=ne-ve-1,N[H+he]=ne+ve+1}}for(let R=0,H=0;R<b;R++){let ne=(b-R)*4+(g?9:12),he=R*2,ve=S-1-he;for(let Ne=0;Ne<ne;Ne++){let Me=Ne*2;for(let qe=0;qe<2;qe++)I[H+Me+qe]=h.get(N[he+qe],N[he+Ne]),I[H+2*ne+Me+qe]=h.get(N[he+Ne],N[ve-qe]),I[H+4*ne+Me+qe]=h.get(N[ve-qe],N[ve-Ne]),I[H+6*ne+Me+qe]=h.get(N[ve-Ne],N[he+qe])}H+=ne*8}return I}static readCode(h,g,b){let S=0;for(let N=g;N<g+b;N++)S<<=1,h[N]&&(S|=1);return S}static readByte(h,g){let b=h.length-g;return b>=8?Bt.readCode(h,g,8):Bt.readCode(h,g,b)<<8-b}static convertBoolArrayToByteArray(h){let g=new Uint8Array((h.length+7)/8);for(let b=0;b<g.length;b++)g[b]=Bt.readByte(h,8*b);return g}totalBitsInLayer(h,g){return((g?88:112)+16*h)*h}}Bt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Bt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Bt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Bt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Bt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class yt{constructor(){}static round(h){return h===NaN?0:h<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:h>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:h+(h<0?-.5:.5)|0}static distance(h,g,b,S){const N=h-b,I=g-S;return Math.sqrt(N*N+I*I)}static sum(h){let g=0;for(let b=0,S=h.length;b!==S;b++){const N=h[b];g+=N}return g}}class rr{static floatToIntBits(h){return h}}rr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class St{constructor(h,g){this.x=h,this.y=g}getX(){return this.x}getY(){return this.y}equals(h){if(h instanceof St){const g=h;return this.x===g.x&&this.y===g.y}return!1}hashCode(){return 31*rr.floatToIntBits(this.x)+rr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(h){const g=this.distance(h[0],h[1]),b=this.distance(h[1],h[2]),S=this.distance(h[0],h[2]);let N,I,R;if(b>=g&&b>=S?(I=h[0],N=h[1],R=h[2]):S>=b&&S>=g?(I=h[1],N=h[0],R=h[2]):(I=h[2],N=h[0],R=h[1]),this.crossProductZ(N,I,R)<0){const H=N;N=R,R=H}h[0]=N,h[1]=I,h[2]=R}static distance(h,g){return yt.distance(h.x,h.y,g.x,g.y)}static crossProductZ(h,g,b){const S=g.x,N=g.y;return(b.x-S)*(h.y-N)-(b.y-N)*(h.x-S)}}class xr{constructor(h,g){this.bits=h,this.points=g}getBits(){return this.bits}getPoints(){return this.points}}class hr extends xr{constructor(h,g,b,S,N){super(h,g),this.compact=b,this.nbDatablocks=S,this.nbLayers=N}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class zr{constructor(h,g,b,S){this.image=h,this.height=h.getHeight(),this.width=h.getWidth(),g==null&&(g=zr.INIT_SIZE),b==null&&(b=h.getWidth()/2|0),S==null&&(S=h.getHeight()/2|0);const N=g/2|0;if(this.leftInit=b-N,this.rightInit=b+N,this.upInit=S-N,this.downInit=S+N,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new le}detect(){let h=this.leftInit,g=this.rightInit,b=this.upInit,S=this.downInit,N=!1,I=!0,R=!1,H=!1,ne=!1,he=!1,ve=!1;const Ne=this.width,Me=this.height;for(;I;){I=!1;let qe=!0;for(;(qe||!H)&&g<Ne;)qe=this.containsBlackPoint(b,S,g,!1),qe?(g++,I=!0,H=!0):H||g++;if(g>=Ne){N=!0;break}let $e=!0;for(;($e||!ne)&&S<Me;)$e=this.containsBlackPoint(h,g,S,!0),$e?(S++,I=!0,ne=!0):ne||S++;if(S>=Me){N=!0;break}let Xe=!0;for(;(Xe||!he)&&h>=0;)Xe=this.containsBlackPoint(b,S,h,!1),Xe?(h--,I=!0,he=!0):he||h--;if(h<0){N=!0;break}let ct=!0;for(;(ct||!ve)&&b>=0;)ct=this.containsBlackPoint(h,g,b,!0),ct?(b--,I=!0,ve=!0):ve||b--;if(b<0){N=!0;break}I&&(R=!0)}if(!N&&R){const qe=g-h;let $e=null;for(let _t=1;$e===null&&_t<qe;_t++)$e=this.getBlackPointOnSegment(h,S-_t,h+_t,S);if($e==null)throw new le;let Xe=null;for(let _t=1;Xe===null&&_t<qe;_t++)Xe=this.getBlackPointOnSegment(h,b+_t,h+_t,b);if(Xe==null)throw new le;let ct=null;for(let _t=1;ct===null&&_t<qe;_t++)ct=this.getBlackPointOnSegment(g,b+_t,g-_t,b);if(ct==null)throw new le;let Tt=null;for(let _t=1;Tt===null&&_t<qe;_t++)Tt=this.getBlackPointOnSegment(g,S-_t,g-_t,S);if(Tt==null)throw new le;return this.centerEdges(Tt,$e,ct,Xe)}else throw new le}getBlackPointOnSegment(h,g,b,S){const N=yt.round(yt.distance(h,g,b,S)),I=(b-h)/N,R=(S-g)/N,H=this.image;for(let ne=0;ne<N;ne++){const he=yt.round(h+ne*I),ve=yt.round(g+ne*R);if(H.get(he,ve))return new St(he,ve)}return null}centerEdges(h,g,b,S){const N=h.getX(),I=h.getY(),R=g.getX(),H=g.getY(),ne=b.getX(),he=b.getY(),ve=S.getX(),Ne=S.getY(),Me=zr.CORR;return N<this.width/2?[new St(ve-Me,Ne+Me),new St(R+Me,H+Me),new St(ne-Me,he-Me),new St(N+Me,I-Me)]:[new St(ve+Me,Ne+Me),new St(R+Me,H-Me),new St(ne-Me,he+Me),new St(N-Me,I-Me)]}containsBlackPoint(h,g,b,S){const N=this.image;if(S){for(let I=h;I<=g;I++)if(N.get(I,b))return!0}else for(let I=h;I<=g;I++)if(N.get(b,I))return!0;return!1}}zr.INIT_SIZE=10,zr.CORR=1;class yn{static checkAndNudgePoints(h,g){const b=h.getWidth(),S=h.getHeight();let N=!0;for(let I=0;I<g.length&&N;I+=2){const R=Math.floor(g[I]),H=Math.floor(g[I+1]);if(R<-1||R>b||H<-1||H>S)throw new le;N=!1,R===-1?(g[I]=0,N=!0):R===b&&(g[I]=b-1,N=!0),H===-1?(g[I+1]=0,N=!0):H===S&&(g[I+1]=S-1,N=!0)}N=!0;for(let I=g.length-2;I>=0&&N;I-=2){const R=Math.floor(g[I]),H=Math.floor(g[I+1]);if(R<-1||R>b||H<-1||H>S)throw new le;N=!1,R===-1?(g[I]=0,N=!0):R===b&&(g[I]=b-1,N=!0),H===-1?(g[I+1]=0,N=!0):H===S&&(g[I+1]=S-1,N=!0)}}}class Or{constructor(h,g,b,S,N,I,R,H,ne){this.a11=h,this.a21=g,this.a31=b,this.a12=S,this.a22=N,this.a32=I,this.a13=R,this.a23=H,this.a33=ne}static quadrilateralToQuadrilateral(h,g,b,S,N,I,R,H,ne,he,ve,Ne,Me,qe,$e,Xe){const ct=Or.quadrilateralToSquare(h,g,b,S,N,I,R,H);return Or.squareToQuadrilateral(ne,he,ve,Ne,Me,qe,$e,Xe).times(ct)}transformPoints(h){const g=h.length,b=this.a11,S=this.a12,N=this.a13,I=this.a21,R=this.a22,H=this.a23,ne=this.a31,he=this.a32,ve=this.a33;for(let Ne=0;Ne<g;Ne+=2){const Me=h[Ne],qe=h[Ne+1],$e=N*Me+H*qe+ve;h[Ne]=(b*Me+I*qe+ne)/$e,h[Ne+1]=(S*Me+R*qe+he)/$e}}transformPointsWithValues(h,g){const b=this.a11,S=this.a12,N=this.a13,I=this.a21,R=this.a22,H=this.a23,ne=this.a31,he=this.a32,ve=this.a33,Ne=h.length;for(let Me=0;Me<Ne;Me++){const qe=h[Me],$e=g[Me],Xe=N*qe+H*$e+ve;h[Me]=(b*qe+I*$e+ne)/Xe,g[Me]=(S*qe+R*$e+he)/Xe}}static squareToQuadrilateral(h,g,b,S,N,I,R,H){const ne=h-b+N-R,he=g-S+I-H;if(ne===0&&he===0)return new Or(b-h,N-b,h,S-g,I-S,g,0,0,1);{const ve=b-N,Ne=R-N,Me=S-I,qe=H-I,$e=ve*qe-Ne*Me,Xe=(ne*qe-Ne*he)/$e,ct=(ve*he-ne*Me)/$e;return new Or(b-h+Xe*b,R-h+ct*R,h,S-g+Xe*S,H-g+ct*H,g,Xe,ct,1)}}static quadrilateralToSquare(h,g,b,S,N,I,R,H){return Or.squareToQuadrilateral(h,g,b,S,N,I,R,H).buildAdjoint()}buildAdjoint(){return new Or(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(h){return new Or(this.a11*h.a11+this.a21*h.a12+this.a31*h.a13,this.a11*h.a21+this.a21*h.a22+this.a31*h.a23,this.a11*h.a31+this.a21*h.a32+this.a31*h.a33,this.a12*h.a11+this.a22*h.a12+this.a32*h.a13,this.a12*h.a21+this.a22*h.a22+this.a32*h.a23,this.a12*h.a31+this.a22*h.a32+this.a32*h.a33,this.a13*h.a11+this.a23*h.a12+this.a33*h.a13,this.a13*h.a21+this.a23*h.a22+this.a33*h.a23,this.a13*h.a31+this.a23*h.a32+this.a33*h.a33)}}class xn extends yn{sampleGrid(h,g,b,S,N,I,R,H,ne,he,ve,Ne,Me,qe,$e,Xe,ct,Tt,_t){const At=Or.quadrilateralToQuadrilateral(S,N,I,R,H,ne,he,ve,Ne,Me,qe,$e,Xe,ct,Tt,_t);return this.sampleGridWithTransform(h,g,b,At)}sampleGridWithTransform(h,g,b,S){if(g<=0||b<=0)throw new le;const N=new de(g,b),I=new Float32Array(2*g);for(let R=0;R<b;R++){const H=I.length,ne=R+.5;for(let he=0;he<H;he+=2)I[he]=he/2+.5,I[he+1]=ne;S.transformPoints(I),yn.checkAndNudgePoints(h,I);try{for(let he=0;he<H;he+=2)h.get(Math.floor(I[he]),Math.floor(I[he+1]))&&N.set(he/2,R)}catch{throw new le}}return N}}class Yr{static setGridSampler(h){Yr.gridSampler=h}static getInstance(){return Yr.gridSampler}}Yr.gridSampler=new xn;class tr{constructor(h,g){this.x=h,this.y=g}toResultPoint(){return new St(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class tn{constructor(h){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=h}detect(){return this.detectMirror(!1)}detectMirror(h){let g=this.getMatrixCenter(),b=this.getBullsEyeCorners(g);if(h){let I=b[0];b[0]=b[2],b[2]=I}this.extractParameters(b);let S=this.sampleGrid(this.image,b[this.shift%4],b[(this.shift+1)%4],b[(this.shift+2)%4],b[(this.shift+3)%4]),N=this.getMatrixCornerPoints(b);return new hr(S,N,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(h){if(!this.isValidPoint(h[0])||!this.isValidPoint(h[1])||!this.isValidPoint(h[2])||!this.isValidPoint(h[3]))throw new le;let g=2*this.nbCenterLayers,b=new Int32Array([this.sampleLine(h[0],h[1],g),this.sampleLine(h[1],h[2],g),this.sampleLine(h[2],h[3],g),this.sampleLine(h[3],h[0],g)]);this.shift=this.getRotation(b,g);let S=0;for(let I=0;I<4;I++){let R=b[(this.shift+I)%4];this.compact?(S<<=7,S+=R>>1&127):(S<<=10,S+=(R>>2&992)+(R>>1&31))}let N=this.getCorrectedParameterData(S,this.compact);this.compact?(this.nbLayers=(N>>6)+1,this.nbDataBlocks=(N&63)+1):(this.nbLayers=(N>>11)+1,this.nbDataBlocks=(N&2047)+1)}getRotation(h,g){let b=0;h.forEach((S,N,I)=>{let R=(S>>g-2<<1)+(S&1);b=(b<<3)+R}),b=((b&1)<<11)+(b>>1);for(let S=0;S<4;S++)if(D.bitCount(b^this.EXPECTED_CORNER_BITS[S])<=2)return S;throw new le}getCorrectedParameterData(h,g){let b,S;g?(b=7,S=2):(b=10,S=4);let N=b-S,I=new Int32Array(b);for(let H=b-1;H>=0;--H)I[H]=h&15,h>>=4;try{new st(vt.AZTEC_PARAM).decode(I,N)}catch{throw new le}let R=0;for(let H=0;H<S;H++)R=(R<<4)+I[H];return R}getBullsEyeCorners(h){let g=h,b=h,S=h,N=h,I=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let ve=this.getFirstDifferent(g,I,1,-1),Ne=this.getFirstDifferent(b,I,1,1),Me=this.getFirstDifferent(S,I,-1,1),qe=this.getFirstDifferent(N,I,-1,-1);if(this.nbCenterLayers>2){let $e=this.distancePoint(qe,ve)*this.nbCenterLayers/(this.distancePoint(N,g)*(this.nbCenterLayers+2));if($e<.75||$e>1.25||!this.isWhiteOrBlackRectangle(ve,Ne,Me,qe))break}g=ve,b=Ne,S=Me,N=qe,I=!I}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new le;this.compact=this.nbCenterLayers===5;let R=new St(g.getX()+.5,g.getY()-.5),H=new St(b.getX()+.5,b.getY()+.5),ne=new St(S.getX()-.5,S.getY()+.5),he=new St(N.getX()-.5,N.getY()-.5);return this.expandSquare([R,H,ne,he],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let h,g,b,S;try{let R=new zr(this.image).detect();h=R[0],g=R[1],b=R[2],S=R[3]}catch{let H=this.image.getWidth()/2,ne=this.image.getHeight()/2;h=this.getFirstDifferent(new tr(H+7,ne-7),!1,1,-1).toResultPoint(),g=this.getFirstDifferent(new tr(H+7,ne+7),!1,1,1).toResultPoint(),b=this.getFirstDifferent(new tr(H-7,ne+7),!1,-1,1).toResultPoint(),S=this.getFirstDifferent(new tr(H-7,ne-7),!1,-1,-1).toResultPoint()}let N=yt.round((h.getX()+S.getX()+g.getX()+b.getX())/4),I=yt.round((h.getY()+S.getY()+g.getY()+b.getY())/4);try{let R=new zr(this.image,15,N,I).detect();h=R[0],g=R[1],b=R[2],S=R[3]}catch{h=this.getFirstDifferent(new tr(N+7,I-7),!1,1,-1).toResultPoint(),g=this.getFirstDifferent(new tr(N+7,I+7),!1,1,1).toResultPoint(),b=this.getFirstDifferent(new tr(N-7,I+7),!1,-1,1).toResultPoint(),S=this.getFirstDifferent(new tr(N-7,I-7),!1,-1,-1).toResultPoint()}return N=yt.round((h.getX()+S.getX()+g.getX()+b.getX())/4),I=yt.round((h.getY()+S.getY()+g.getY()+b.getY())/4),new tr(N,I)}getMatrixCornerPoints(h){return this.expandSquare(h,2*this.nbCenterLayers,this.getDimension())}sampleGrid(h,g,b,S,N){let I=Yr.getInstance(),R=this.getDimension(),H=R/2-this.nbCenterLayers,ne=R/2+this.nbCenterLayers;return I.sampleGrid(h,R,R,H,H,ne,H,ne,ne,H,ne,g.getX(),g.getY(),b.getX(),b.getY(),S.getX(),S.getY(),N.getX(),N.getY())}sampleLine(h,g,b){let S=0,N=this.distanceResultPoint(h,g),I=N/b,R=h.getX(),H=h.getY(),ne=I*(g.getX()-h.getX())/N,he=I*(g.getY()-h.getY())/N;for(let ve=0;ve<b;ve++)this.image.get(yt.round(R+ve*ne),yt.round(H+ve*he))&&(S|=1<<b-ve-1);return S}isWhiteOrBlackRectangle(h,g,b,S){let N=3;h=new tr(h.getX()-N,h.getY()+N),g=new tr(g.getX()-N,g.getY()-N),b=new tr(b.getX()+N,b.getY()-N),S=new tr(S.getX()+N,S.getY()+N);let I=this.getColor(S,h);if(I===0)return!1;let R=this.getColor(h,g);return R!==I||(R=this.getColor(g,b),R!==I)?!1:(R=this.getColor(b,S),R===I)}getColor(h,g){let b=this.distancePoint(h,g),S=(g.getX()-h.getX())/b,N=(g.getY()-h.getY())/b,I=0,R=h.getX(),H=h.getY(),ne=this.image.get(h.getX(),h.getY()),he=Math.ceil(b);for(let Ne=0;Ne<he;Ne++)R+=S,H+=N,this.image.get(yt.round(R),yt.round(H))!==ne&&I++;let ve=I/b;return ve>.1&&ve<.9?0:ve<=.1===ne?1:-1}getFirstDifferent(h,g,b,S){let N=h.getX()+b,I=h.getY()+S;for(;this.isValid(N,I)&&this.image.get(N,I)===g;)N+=b,I+=S;for(N-=b,I-=S;this.isValid(N,I)&&this.image.get(N,I)===g;)N+=b;for(N-=b;this.isValid(N,I)&&this.image.get(N,I)===g;)I+=S;return I-=S,new tr(N,I)}expandSquare(h,g,b){let S=b/(2*g),N=h[0].getX()-h[2].getX(),I=h[0].getY()-h[2].getY(),R=(h[0].getX()+h[2].getX())/2,H=(h[0].getY()+h[2].getY())/2,ne=new St(R+S*N,H+S*I),he=new St(R-S*N,H-S*I);N=h[1].getX()-h[3].getX(),I=h[1].getY()-h[3].getY(),R=(h[1].getX()+h[3].getX())/2,H=(h[1].getY()+h[3].getY())/2;let ve=new St(R+S*N,H+S*I),Ne=new St(R-S*N,H-S*I);return[ne,ve,he,Ne]}isValid(h,g){return h>=0&&h<this.image.getWidth()&&g>0&&g<this.image.getHeight()}isValidPoint(h){let g=yt.round(h.getX()),b=yt.round(h.getY());return this.isValid(g,b)}distancePoint(h,g){return yt.distance(h.getX(),h.getY(),g.getX(),g.getY())}distanceResultPoint(h,g){return yt.distance(h.getX(),h.getY(),g.getX(),g.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(D.truncDivision(this.nbLayers-4,8)+1)+15}}class fr{decode(h,g=null){let b=null,S=new tn(h.getBlackMatrix()),N=null,I=null;try{let he=S.detectMirror(!1);N=he.getPoints(),this.reportFoundResultPoints(g,N),I=new Bt().decode(he)}catch(he){b=he}if(I==null)try{let he=S.detectMirror(!0);N=he.getPoints(),this.reportFoundResultPoints(g,N),I=new Bt().decode(he)}catch(he){throw b??he}let R=new W(I.getText(),I.getRawBytes(),I.getNumBits(),N,ge.AZTEC,C.currentTimeMillis()),H=I.getByteSegments();H!=null&&R.putMetadata(Le.BYTE_SEGMENTS,H);let ne=I.getECLevel();return ne!=null&&R.putMetadata(Le.ERROR_CORRECTION_LEVEL,ne),R}reportFoundResultPoints(h,g){if(h!=null){let b=h.get(U.NEED_RESULT_POINT_CALLBACK);b!=null&&g.forEach((S,N,I)=>{b.foundPossibleResultPoint(S)})}}reset(){}}class Yi extends se{constructor(h=500){super(new fr,h)}}class Er{decode(h,g){try{return this.doDecode(h,g)}catch{if(g&&g.get(U.TRY_HARDER)===!0&&h.isRotateSupported()){const N=h.rotateCounterClockwise(),I=this.doDecode(N,g),R=I.getResultMetadata();let H=270;R!==null&&R.get(Le.ORIENTATION)===!0&&(H=H+R.get(Le.ORIENTATION)%360),I.putMetadata(Le.ORIENTATION,H);const ne=I.getResultPoints();if(ne!==null){const he=N.getHeight();for(let ve=0;ve<ne.length;ve++)ne[ve]=new St(he-ne[ve].getY()-1,ne[ve].getX())}return I}else throw new le}}reset(){}doDecode(h,g){const b=h.getWidth(),S=h.getHeight();let N=new M(b);const I=g&&g.get(U.TRY_HARDER)===!0,R=Math.max(1,S>>(I?8:5));let H;I?H=S:H=15;const ne=Math.trunc(S/2);for(let he=0;he<H;he++){const ve=Math.trunc((he+1)/2),Ne=(he&1)===0,Me=ne+R*(Ne?ve:-ve);if(Me<0||Me>=S)break;try{N=h.getBlackRow(Me,N)}catch{continue}for(let qe=0;qe<2;qe++){if(qe===1&&(N.reverse(),g&&g.get(U.NEED_RESULT_POINT_CALLBACK)===!0)){const $e=new Map;g.forEach((Xe,ct)=>$e.set(ct,Xe)),$e.delete(U.NEED_RESULT_POINT_CALLBACK),g=$e}try{const $e=this.decodeRow(Me,N,g);if(qe===1){$e.putMetadata(Le.ORIENTATION,180);const Xe=$e.getResultPoints();Xe!==null&&(Xe[0]=new St(b-Xe[0].getX()-1,Xe[0].getY()),Xe[1]=new St(b-Xe[1].getX()-1,Xe[1].getY()))}return $e}catch{}}}throw new le}static recordPattern(h,g,b){const S=b.length;for(let ne=0;ne<S;ne++)b[ne]=0;const N=h.getSize();if(g>=N)throw new le;let I=!h.get(g),R=0,H=g;for(;H<N;){if(h.get(H)!==I)b[R]++;else{if(++R===S)break;b[R]=1,I=!I}H++}if(!(R===S||R===S-1&&H===N))throw new le}static recordPatternInReverse(h,g,b){let S=b.length,N=h.get(g);for(;g>0&&S>=0;)h.get(--g)!==N&&(S--,N=!N);if(S>=0)throw new le;Er.recordPattern(h,g+1,b)}static patternMatchVariance(h,g,b){const S=h.length;let N=0,I=0;for(let ne=0;ne<S;ne++)N+=h[ne],I+=g[ne];if(N<I)return Number.POSITIVE_INFINITY;const R=N/I;b*=R;let H=0;for(let ne=0;ne<S;ne++){const he=h[ne],ve=g[ne]*R,Ne=he>ve?he-ve:ve-he;if(Ne>b)return Number.POSITIVE_INFINITY;H+=Ne}return H/N}}class wt extends Er{static findStartPattern(h){const g=h.getSize(),b=h.getNextSet(0);let S=0,N=Int32Array.from([0,0,0,0,0,0]),I=b,R=!1;const H=6;for(let ne=b;ne<g;ne++)if(h.get(ne)!==R)N[S]++;else{if(S===H-1){let he=wt.MAX_AVG_VARIANCE,ve=-1;for(let Ne=wt.CODE_START_A;Ne<=wt.CODE_START_C;Ne++){const Me=Er.patternMatchVariance(N,wt.CODE_PATTERNS[Ne],wt.MAX_INDIVIDUAL_VARIANCE);Me<he&&(he=Me,ve=Ne)}if(ve>=0&&h.isRange(Math.max(0,I-(ne-I)/2),I,!1))return Int32Array.from([I,ne,ve]);I+=N[0]+N[1],N=N.slice(2,N.length-1),N[S-1]=0,N[S]=0,S--}else S++;N[S]=1,R=!R}throw new le}static decodeCode(h,g,b){Er.recordPattern(h,b,g);let S=wt.MAX_AVG_VARIANCE,N=-1;for(let I=0;I<wt.CODE_PATTERNS.length;I++){const R=wt.CODE_PATTERNS[I],H=this.patternMatchVariance(g,R,wt.MAX_INDIVIDUAL_VARIANCE);H<S&&(S=H,N=I)}if(N>=0)return N;throw new le}decodeRow(h,g,b){const S=b&&b.get(U.ASSUME_GS1)===!0,N=wt.findStartPattern(g),I=N[2];let R=0;const H=new Uint8Array(20);H[R++]=I;let ne;switch(I){case wt.CODE_START_A:ne=wt.CODE_CODE_A;break;case wt.CODE_START_B:ne=wt.CODE_CODE_B;break;case wt.CODE_START_C:ne=wt.CODE_CODE_C;break;default:throw new $}let he=!1,ve=!1,Ne="",Me=N[0],qe=N[1];const $e=Int32Array.from([0,0,0,0,0,0]);let Xe=0,ct=0,Tt=I,_t=0,At=!0,Tr=!1,qr=!1;for(;!he;){const Io=ve;switch(ve=!1,Xe=ct,ct=wt.decodeCode(g,$e,qe),H[R++]=ct,ct!==wt.CODE_STOP&&(At=!0),ct!==wt.CODE_STOP&&(_t++,Tt+=_t*ct),Me=qe,qe+=$e.reduce((ju,Oo)=>ju+Oo,0),ct){case wt.CODE_START_A:case wt.CODE_START_B:case wt.CODE_START_C:throw new $}switch(ne){case wt.CODE_CODE_A:if(ct<64)qr===Tr?Ne+=String.fromCharCode(32+ct):Ne+=String.fromCharCode(32+ct+128),qr=!1;else if(ct<96)qr===Tr?Ne+=String.fromCharCode(ct-64):Ne+=String.fromCharCode(ct+64),qr=!1;else switch(ct!==wt.CODE_STOP&&(At=!1),ct){case wt.CODE_FNC_1:S&&(Ne.length===0?Ne+="]C1":Ne+="");break;case wt.CODE_FNC_2:case wt.CODE_FNC_3:break;case wt.CODE_FNC_4_A:!Tr&&qr?(Tr=!0,qr=!1):Tr&&qr?(Tr=!1,qr=!1):qr=!0;break;case wt.CODE_SHIFT:ve=!0,ne=wt.CODE_CODE_B;break;case wt.CODE_CODE_B:ne=wt.CODE_CODE_B;break;case wt.CODE_CODE_C:ne=wt.CODE_CODE_C;break;case wt.CODE_STOP:he=!0;break}break;case wt.CODE_CODE_B:if(ct<96)qr===Tr?Ne+=String.fromCharCode(32+ct):Ne+=String.fromCharCode(32+ct+128),qr=!1;else switch(ct!==wt.CODE_STOP&&(At=!1),ct){case wt.CODE_FNC_1:S&&(Ne.length===0?Ne+="]C1":Ne+="");break;case wt.CODE_FNC_2:case wt.CODE_FNC_3:break;case wt.CODE_FNC_4_B:!Tr&&qr?(Tr=!0,qr=!1):Tr&&qr?(Tr=!1,qr=!1):qr=!0;break;case wt.CODE_SHIFT:ve=!0,ne=wt.CODE_CODE_A;break;case wt.CODE_CODE_A:ne=wt.CODE_CODE_A;break;case wt.CODE_CODE_C:ne=wt.CODE_CODE_C;break;case wt.CODE_STOP:he=!0;break}break;case wt.CODE_CODE_C:if(ct<100)ct<10&&(Ne+="0"),Ne+=ct;else switch(ct!==wt.CODE_STOP&&(At=!1),ct){case wt.CODE_FNC_1:S&&(Ne.length===0?Ne+="]C1":Ne+="");break;case wt.CODE_CODE_A:ne=wt.CODE_CODE_A;break;case wt.CODE_CODE_B:ne=wt.CODE_CODE_B;break;case wt.CODE_STOP:he=!0;break}break}Io&&(ne=ne===wt.CODE_CODE_A?wt.CODE_CODE_B:wt.CODE_CODE_A)}const Mn=qe-Me;if(qe=g.getNextUnset(qe),!g.isRange(qe,Math.min(g.getSize(),qe+(qe-Me)/2),!1))throw new le;if(Tt-=_t*Xe,Tt%103!==Xe)throw new v;const ua=Ne.length;if(ua===0)throw new le;ua>0&&At&&(ne===wt.CODE_CODE_C?Ne=Ne.substring(0,ua-2):Ne=Ne.substring(0,ua-1));const Ra=(N[1]+N[0])/2,Un=Me+Mn/2,Ma=H.length,Ms=new Uint8Array(Ma);for(let Io=0;Io<Ma;Io++)Ms[Io]=H[Io];const xc=[new St(Ra,h),new St(Un,h)];return new W(Ne,Ms,0,xc,ge.CODE_128,new Date().getTime())}}wt.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],wt.MAX_AVG_VARIANCE=.25,wt.MAX_INDIVIDUAL_VARIANCE=.7,wt.CODE_SHIFT=98,wt.CODE_CODE_C=99,wt.CODE_CODE_B=100,wt.CODE_CODE_A=101,wt.CODE_FNC_1=102,wt.CODE_FNC_2=97,wt.CODE_FNC_3=96,wt.CODE_FNC_4_A=101,wt.CODE_FNC_4_B=100,wt.CODE_START_A=103,wt.CODE_START_B=104,wt.CODE_START_C=105,wt.CODE_STOP=106;class sr extends Er{constructor(h=!1,g=!1){super(),this.usingCheckDigit=h,this.extendedMode=g,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(h,g,b){let S=this.counters;S.fill(0),this.decodeRowResult="";let N=sr.findAsteriskPattern(g,S),I=g.getNextSet(N[1]),R=g.getSize(),H,ne;do{sr.recordPattern(g,I,S);let $e=sr.toNarrowWidePattern(S);if($e<0)throw new le;H=sr.patternToChar($e),this.decodeRowResult+=H,ne=I;for(let Xe of S)I+=Xe;I=g.getNextSet(I)}while(H!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let he=0;for(let $e of S)he+=$e;let ve=I-ne-he;if(I!==R&&ve*2<he)throw new le;if(this.usingCheckDigit){let $e=this.decodeRowResult.length-1,Xe=0;for(let ct=0;ct<$e;ct++)Xe+=sr.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ct));if(this.decodeRowResult.charAt($e)!==sr.ALPHABET_STRING.charAt(Xe%43))throw new v;this.decodeRowResult=this.decodeRowResult.substring(0,$e)}if(this.decodeRowResult.length===0)throw new le;let Ne;this.extendedMode?Ne=sr.decodeExtended(this.decodeRowResult):Ne=this.decodeRowResult;let Me=(N[1]+N[0])/2,qe=ne+he/2;return new W(Ne,null,0,[new St(Me,h),new St(qe,h)],ge.CODE_39,new Date().getTime())}static findAsteriskPattern(h,g){let b=h.getSize(),S=h.getNextSet(0),N=0,I=S,R=!1,H=g.length;for(let ne=S;ne<b;ne++)if(h.get(ne)!==R)g[N]++;else{if(N===H-1){if(this.toNarrowWidePattern(g)===sr.ASTERISK_ENCODING&&h.isRange(Math.max(0,I-Math.floor((ne-I)/2)),I,!1))return[I,ne];I+=g[0]+g[1],g.copyWithin(0,2,2+N-1),g[N-1]=0,g[N]=0,N--}else N++;g[N]=1,R=!R}throw new le}static toNarrowWidePattern(h){let g=h.length,b=0,S;do{let N=2147483647;for(let H of h)H<N&&H>b&&(N=H);b=N,S=0;let I=0,R=0;for(let H=0;H<g;H++){let ne=h[H];ne>b&&(R|=1<<g-1-H,S++,I+=ne)}if(S===3){for(let H=0;H<g&&S>0;H++){let ne=h[H];if(ne>b&&(S--,ne*2>=I))return-1}return R}}while(S>3);return-1}static patternToChar(h){for(let g=0;g<sr.CHARACTER_ENCODINGS.length;g++)if(sr.CHARACTER_ENCODINGS[g]===h)return sr.ALPHABET_STRING.charAt(g);if(h===sr.ASTERISK_ENCODING)return"*";throw new le}static decodeExtended(h){let g=h.length,b="";for(let S=0;S<g;S++){let N=h.charAt(S);if(N==="+"||N==="$"||N==="%"||N==="/"){let I=h.charAt(S+1),R="\0";switch(N){case"+":if(I>="A"&&I<="Z")R=String.fromCharCode(I.charCodeAt(0)+32);else throw new $;break;case"$":if(I>="A"&&I<="Z")R=String.fromCharCode(I.charCodeAt(0)-64);else throw new $;break;case"%":if(I>="A"&&I<="E")R=String.fromCharCode(I.charCodeAt(0)-38);else if(I>="F"&&I<="J")R=String.fromCharCode(I.charCodeAt(0)-11);else if(I>="K"&&I<="O")R=String.fromCharCode(I.charCodeAt(0)+16);else if(I>="P"&&I<="T")R=String.fromCharCode(I.charCodeAt(0)+43);else if(I==="U")R="\0";else if(I==="V")R="@";else if(I==="W")R="`";else if(I==="X"||I==="Y"||I==="Z")R="";else throw new $;break;case"/":if(I>="A"&&I<="O")R=String.fromCharCode(I.charCodeAt(0)-32);else if(I==="Z")R=":";else throw new $;break}b+=R,S++}else b+=N}return b}}sr.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",sr.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],sr.ASTERISK_ENCODING=148;class ur extends Er{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(h,g,b){let S=this.decodeStart(g),N=this.decodeEnd(g),I=new re;ur.decodeMiddle(g,S[1],N[0],I);let R=I.toString(),H=null;b!=null&&(H=b.get(U.ALLOWED_LENGTHS)),H==null&&(H=ur.DEFAULT_ALLOWED_LENGTHS);let ne=R.length,he=!1,ve=0;for(let qe of H){if(ne===qe){he=!0;break}qe>ve&&(ve=qe)}if(!he&&ne>ve&&(he=!0),!he)throw new $;const Ne=[new St(S[1],h),new St(N[0],h)];return new W(R,null,0,Ne,ge.ITF,new Date().getTime())}static decodeMiddle(h,g,b,S){let N=new Int32Array(10),I=new Int32Array(5),R=new Int32Array(5);for(N.fill(0),I.fill(0),R.fill(0);g<b;){Er.recordPattern(h,g,N);for(let ne=0;ne<5;ne++){let he=2*ne;I[ne]=N[he],R[ne]=N[he+1]}let H=ur.decodeDigit(I);S.append(H.toString()),H=this.decodeDigit(R),S.append(H.toString()),N.forEach(function(ne){g+=ne})}}decodeStart(h){let g=ur.skipWhiteSpace(h),b=ur.findGuardPattern(h,g,ur.START_PATTERN);return this.narrowLineWidth=(b[1]-b[0])/4,this.validateQuietZone(h,b[0]),b}validateQuietZone(h,g){let b=this.narrowLineWidth*10;b=b<g?b:g;for(let S=g-1;b>0&&S>=0&&!h.get(S);S--)b--;if(b!==0)throw new le}static skipWhiteSpace(h){const g=h.getSize(),b=h.getNextSet(0);if(b===g)throw new le;return b}decodeEnd(h){h.reverse();try{let g=ur.skipWhiteSpace(h),b;try{b=ur.findGuardPattern(h,g,ur.END_PATTERN_REVERSED[0])}catch(N){N instanceof le&&(b=ur.findGuardPattern(h,g,ur.END_PATTERN_REVERSED[1]))}this.validateQuietZone(h,b[0]);let S=b[0];return b[0]=h.getSize()-b[1],b[1]=h.getSize()-S,b}finally{h.reverse()}}static findGuardPattern(h,g,b){let S=b.length,N=new Int32Array(S),I=h.getSize(),R=!1,H=0,ne=g;N.fill(0);for(let he=g;he<I;he++)if(h.get(he)!==R)N[H]++;else{if(H===S-1){if(Er.patternMatchVariance(N,b,ur.MAX_INDIVIDUAL_VARIANCE)<ur.MAX_AVG_VARIANCE)return[ne,he];ne+=N[0]+N[1],C.arraycopy(N,2,N,0,H-1),N[H-1]=0,N[H]=0,H--}else H++;N[H]=1,R=!R}throw new le}static decodeDigit(h){let g=ur.MAX_AVG_VARIANCE,b=-1,S=ur.PATTERNS.length;for(let N=0;N<S;N++){let I=ur.PATTERNS[N],R=Er.patternMatchVariance(h,I,ur.MAX_INDIVIDUAL_VARIANCE);R<g?(g=R,b=N):R===g&&(b=-1)}if(b>=0)return b%10;throw new le}}ur.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ur.MAX_AVG_VARIANCE=.38,ur.MAX_INDIVIDUAL_VARIANCE=.5,ur.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ur.START_PATTERN=Int32Array.from([1,1,1,1]),ur.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Yt extends Er{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(h){let g=!1,b,S=0,N=Int32Array.from([0,0,0]);for(;!g;){N=Int32Array.from([0,0,0]),b=Yt.findGuardPattern(h,S,!1,this.START_END_PATTERN,N);let I=b[0];S=b[1];let R=I-(S-I);R>=0&&(g=h.isRange(R,I,!1))}return b}static checkChecksum(h){return Yt.checkStandardUPCEANChecksum(h)}static checkStandardUPCEANChecksum(h){let g=h.length;if(g===0)return!1;let b=parseInt(h.charAt(g-1),10);return Yt.getStandardUPCEANChecksum(h.substring(0,g-1))===b}static getStandardUPCEANChecksum(h){let g=h.length,b=0;for(let S=g-1;S>=0;S-=2){let N=h.charAt(S).charCodeAt(0)-48;if(N<0||N>9)throw new $;b+=N}b*=3;for(let S=g-2;S>=0;S-=2){let N=h.charAt(S).charCodeAt(0)-48;if(N<0||N>9)throw new $;b+=N}return(1e3-b)%10}static decodeEnd(h,g){return Yt.findGuardPattern(h,g,!1,Yt.START_END_PATTERN,new Int32Array(Yt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(h,g,b,S){return this.findGuardPattern(h,g,b,S,new Int32Array(S.length))}static findGuardPattern(h,g,b,S,N){let I=h.getSize();g=b?h.getNextUnset(g):h.getNextSet(g);let R=0,H=g,ne=S.length,he=b;for(let ve=g;ve<I;ve++)if(h.get(ve)!==he)N[R]++;else{if(R===ne-1){if(Er.patternMatchVariance(N,S,Yt.MAX_INDIVIDUAL_VARIANCE)<Yt.MAX_AVG_VARIANCE)return Int32Array.from([H,ve]);H+=N[0]+N[1];let Ne=N.slice(2,N.length-1);for(let Me=0;Me<R-1;Me++)N[Me]=Ne[Me];N[R-1]=0,N[R]=0,R--}else R++;N[R]=1,he=!he}throw new le}static decodeDigit(h,g,b,S){this.recordPattern(h,b,g);let N=this.MAX_AVG_VARIANCE,I=-1,R=S.length;for(let H=0;H<R;H++){let ne=S[H],he=Er.patternMatchVariance(g,ne,Yt.MAX_INDIVIDUAL_VARIANCE);he<N&&(N=he,I=H)}if(I>=0)return I;throw new le}}Yt.MAX_AVG_VARIANCE=.48,Yt.MAX_INDIVIDUAL_VARIANCE=.7,Yt.START_END_PATTERN=Int32Array.from([1,1,1]),Yt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Yt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Kn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(h,g,b){let S=this.decodeRowStringBuffer,N=this.decodeMiddle(g,b,S),I=S.toString(),R=Kn.parseExtensionString(I),H=[new St((b[0]+b[1])/2,h),new St(N,h)],ne=new W(I,null,0,H,ge.UPC_EAN_EXTENSION,new Date().getTime());return R!=null&&ne.putAllMetadata(R),ne}decodeMiddle(h,g,b){let S=this.decodeMiddleCounters;S[0]=0,S[1]=0,S[2]=0,S[3]=0;let N=h.getSize(),I=g[1],R=0;for(let ne=0;ne<5&&I<N;ne++){let he=Yt.decodeDigit(h,S,I,Yt.L_AND_G_PATTERNS);b+=String.fromCharCode(48+he%10);for(let ve of S)I+=ve;he>=10&&(R|=1<<4-ne),ne!==4&&(I=h.getNextSet(I),I=h.getNextUnset(I))}if(b.length!==5)throw new le;let H=this.determineCheckDigit(R);if(Kn.extensionChecksum(b.toString())!==H)throw new le;return I}static extensionChecksum(h){let g=h.length,b=0;for(let S=g-2;S>=0;S-=2)b+=h.charAt(S).charCodeAt(0)-48;b*=3;for(let S=g-1;S>=0;S-=2)b+=h.charAt(S).charCodeAt(0)-48;return b*=3,b%10}determineCheckDigit(h){for(let g=0;g<10;g++)if(h===this.CHECK_DIGIT_ENCODINGS[g])return g;throw new le}static parseExtensionString(h){if(h.length!==5)return null;let g=Kn.parseExtension5String(h);return g==null?null:new Map([[Le.SUGGESTED_PRICE,g]])}static parseExtension5String(h){let g;switch(h.charAt(0)){case"0":g="";break;case"5":g="$";break;case"9":switch(h){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}g="";break;default:g="";break}let b=parseInt(h.substring(1)),S=(b/100).toString(),N=b%100,I=N<10?"0"+N:N.toString();return g+S+"."+I}}class Fr{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(h,g,b){let S=this.decodeRowStringBuffer,N=this.decodeMiddle(g,b,S),I=S.toString(),R=Fr.parseExtensionString(I),H=[new St((b[0]+b[1])/2,h),new St(N,h)],ne=new W(I,null,0,H,ge.UPC_EAN_EXTENSION,new Date().getTime());return R!=null&&ne.putAllMetadata(R),ne}decodeMiddle(h,g,b){let S=this.decodeMiddleCounters;S[0]=0,S[1]=0,S[2]=0,S[3]=0;let N=h.getSize(),I=g[1],R=0;for(let H=0;H<2&&I<N;H++){let ne=Yt.decodeDigit(h,S,I,Yt.L_AND_G_PATTERNS);b+=String.fromCharCode(48+ne%10);for(let he of S)I+=he;ne>=10&&(R|=1<<1-H),H!==1&&(I=h.getNextSet(I),I=h.getNextUnset(I))}if(b.length!==2)throw new le;if(parseInt(b.toString())%4!==R)throw new le;return I}static parseExtensionString(h){return h.length!==2?null:new Map([[Le.ISSUE_NUMBER,parseInt(h)]])}}class Kr{static decodeRow(h,g,b){let S=Yt.findGuardPattern(g,b,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Kn().decodeRow(h,g,S)}catch{return new Fr().decodeRow(h,g,S)}}}Kr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Sr extends Yt{constructor(){super(),this.decodeRowStringBuffer="",Sr.L_AND_G_PATTERNS=Sr.L_PATTERNS.map(h=>Int32Array.from(h));for(let h=10;h<20;h++){let g=Sr.L_PATTERNS[h-10],b=new Int32Array(g.length);for(let S=0;S<g.length;S++)b[S]=g[g.length-S-1];Sr.L_AND_G_PATTERNS[h]=b}}decodeRow(h,g,b){let S=Sr.findStartGuardPattern(g),N=b==null?null:b.get(U.NEED_RESULT_POINT_CALLBACK);if(N!=null){const At=new St((S[0]+S[1])/2,h);N.foundPossibleResultPoint(At)}let I=this.decodeMiddle(g,S,this.decodeRowStringBuffer),R=I.rowOffset,H=I.resultString;if(N!=null){const At=new St(R,h);N.foundPossibleResultPoint(At)}let ne=this.decodeEnd(g,R);if(N!=null){const At=new St((ne[0]+ne[1])/2,h);N.foundPossibleResultPoint(At)}let he=ne[1],ve=he+(he-ne[0]);if(ve>=g.getSize()||!g.isRange(he,ve,!1))throw new le;let Ne=H.toString();if(Ne.length<8)throw new $;if(!Sr.checkChecksum(Ne))throw new v;let Me=(S[1]+S[0])/2,qe=(ne[1]+ne[0])/2,$e=this.getBarcodeFormat(),Xe=[new St(Me,h),new St(qe,h)],ct=new W(Ne,null,0,Xe,$e,new Date().getTime()),Tt=0;try{let At=Kr.decodeRow(h,g,ne[1]);ct.putMetadata(Le.UPC_EAN_EXTENSION,At.getText()),ct.putAllMetadata(At.getResultMetadata()),ct.addResultPoints(At.getResultPoints()),Tt=At.getText().length}catch{}let _t=b==null?null:b.get(U.ALLOWED_EAN_EXTENSIONS);if(_t!=null){let At=!1;for(let Tr in _t)if(Tt.toString()===Tr){At=!0;break}if(!At)throw new le}return ct}decodeEnd(h,g){return Sr.findGuardPattern(h,g,!1,Sr.START_END_PATTERN,new Int32Array(Sr.START_END_PATTERN.length).fill(0))}static checkChecksum(h){return Sr.checkStandardUPCEANChecksum(h)}static checkStandardUPCEANChecksum(h){let g=h.length;if(g===0)return!1;let b=parseInt(h.charAt(g-1),10);return Sr.getStandardUPCEANChecksum(h.substring(0,g-1))===b}static getStandardUPCEANChecksum(h){let g=h.length,b=0;for(let S=g-1;S>=0;S-=2){let N=h.charAt(S).charCodeAt(0)-48;if(N<0||N>9)throw new $;b+=N}b*=3;for(let S=g-2;S>=0;S-=2){let N=h.charAt(S).charCodeAt(0)-48;if(N<0||N>9)throw new $;b+=N}return(1e3-b)%10}}class Qr extends Sr{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(h,g,b){let S=this.decodeMiddleCounters;S[0]=0,S[1]=0,S[2]=0,S[3]=0;let N=h.getSize(),I=g[1],R=0;for(let ne=0;ne<6&&I<N;ne++){let he=Sr.decodeDigit(h,S,I,Sr.L_AND_G_PATTERNS);b+=String.fromCharCode(48+he%10);for(let ve of S)I+=ve;he>=10&&(R|=1<<5-ne)}b=Qr.determineFirstDigit(b,R),I=Sr.findGuardPattern(h,I,!0,Sr.MIDDLE_PATTERN,new Int32Array(Sr.MIDDLE_PATTERN.length).fill(0))[1];for(let ne=0;ne<6&&I<N;ne++){let he=Sr.decodeDigit(h,S,I,Sr.L_PATTERNS);b+=String.fromCharCode(48+he);for(let ve of S)I+=ve}return{rowOffset:I,resultString:b}}getBarcodeFormat(){return ge.EAN_13}static determineFirstDigit(h,g){for(let b=0;b<10;b++)if(g===this.FIRST_DIGIT_ENCODINGS[b])return h=String.fromCharCode(48+b)+h,h;throw new le}}Qr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class _r extends Sr{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(h,g,b){const S=this.decodeMiddleCounters;S[0]=0,S[1]=0,S[2]=0,S[3]=0;let N=h.getSize(),I=g[1];for(let H=0;H<4&&I<N;H++){let ne=Sr.decodeDigit(h,S,I,Sr.L_PATTERNS);b+=String.fromCharCode(48+ne);for(let he of S)I+=he}I=Sr.findGuardPattern(h,I,!0,Sr.MIDDLE_PATTERN,new Int32Array(Sr.MIDDLE_PATTERN.length).fill(0))[1];for(let H=0;H<4&&I<N;H++){let ne=Sr.decodeDigit(h,S,I,Sr.L_PATTERNS);b+=String.fromCharCode(48+ne);for(let he of S)I+=he}return{rowOffset:I,resultString:b}}getBarcodeFormat(){return ge.EAN_8}}class On extends Sr{constructor(){super(...arguments),this.ean13Reader=new Qr}getBarcodeFormat(){return ge.UPC_A}decode(h,g){return this.maybeReturnResult(this.ean13Reader.decode(h))}decodeRow(h,g,b){return this.maybeReturnResult(this.ean13Reader.decodeRow(h,g,b))}decodeMiddle(h,g,b){return this.ean13Reader.decodeMiddle(h,g,b)}maybeReturnResult(h){let g=h.getText();if(g.charAt(0)==="0"){let b=new W(g.substring(1),null,null,h.getResultPoints(),ge.UPC_A);return h.getResultMetadata()!=null&&b.putAllMetadata(h.getResultMetadata()),b}else throw new le}reset(){this.ean13Reader.reset()}}class Zi extends Sr{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(h,g,b){const S=this.decodeMiddleCounters.map(ne=>ne);S[0]=0,S[1]=0,S[2]=0,S[3]=0;const N=h.getSize();let I=g[1],R=0;for(let ne=0;ne<6&&I<N;ne++){const he=Zi.decodeDigit(h,S,I,Zi.L_AND_G_PATTERNS);b+=String.fromCharCode(48+he%10);for(let ve of S)I+=ve;he>=10&&(R|=1<<5-ne)}let H=Zi.determineNumSysAndCheckDigit(b,R);return{rowOffset:I,resultString:H}}decodeEnd(h,g){return Zi.findGuardPatternWithoutCounters(h,g,!0,Zi.MIDDLE_END_PATTERN)}checkChecksum(h){return Sr.checkChecksum(Zi.convertUPCEtoUPCA(h))}static determineNumSysAndCheckDigit(h,g){for(let b=0;b<=1;b++)for(let S=0;S<10;S++)if(g===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[b][S]){let N=String.fromCharCode(48+b),I=String.fromCharCode(48+S);return N+h+I}throw le.getNotFoundInstance()}getBarcodeFormat(){return ge.UPC_E}static convertUPCEtoUPCA(h){const g=h.slice(1,7).split("").map(N=>N.charCodeAt(0)),b=new re;b.append(h.charAt(0));let S=g[5];switch(S){case 0:case 1:case 2:b.appendChars(g,0,2),b.append(S),b.append("0000"),b.appendChars(g,2,3);break;case 3:b.appendChars(g,0,3),b.append("00000"),b.appendChars(g,3,2);break;case 4:b.appendChars(g,0,4),b.append("00000"),b.append(g[4]);break;default:b.appendChars(g,0,5),b.append("0000"),b.append(S);break}return h.length>=8&&b.append(h.charAt(7)),b.toString()}}Zi.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Zi.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Ia extends Er{constructor(h){super();let g=h==null?null:h.get(U.POSSIBLE_FORMATS),b=[];i(g)?(b.push(new Qr),b.push(new On),b.push(new _r),b.push(new Zi)):(g.indexOf(ge.EAN_13)>-1&&b.push(new Qr),g.indexOf(ge.UPC_A)>-1&&b.push(new On),g.indexOf(ge.EAN_8)>-1&&b.push(new _r),g.indexOf(ge.UPC_E)>-1&&b.push(new Zi)),this.readers=b}decodeRow(h,g,b){for(let S of this.readers)try{const N=S.decodeRow(h,g,b),I=N.getBarcodeFormat()===ge.EAN_13&&N.getText().charAt(0)==="0",R=b==null?null:b.get(U.POSSIBLE_FORMATS),H=R==null||R.includes(ge.UPC_A);if(I&&H){const ne=N.getRawBytes(),he=new W(N.getText().substring(1),ne,ne?ne.length:null,N.getResultPoints(),ge.UPC_A);return he.putAllMetadata(N.getResultMetadata()),he}return N}catch{}throw new le}reset(){for(let h of this.readers)h.reset()}}class vi extends Er{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(h,g){for(let b=0;b<g.length;b++)if(Er.patternMatchVariance(h,g[b],vi.MAX_INDIVIDUAL_VARIANCE)<vi.MAX_AVG_VARIANCE)return b;throw new le}static count(h){return yt.sum(new Int32Array(h))}static increment(h,g){let b=0,S=g[0];for(let N=1;N<h.length;N++)g[N]>S&&(S=g[N],b=N);h[b]++}static decrement(h,g){let b=0,S=g[0];for(let N=1;N<h.length;N++)g[N]<S&&(S=g[N],b=N);h[b]--}static isFinderPattern(h){let g=h[0]+h[1],b=g+h[2]+h[3],S=g/b;if(S>=vi.MIN_FINDER_PATTERN_RATIO&&S<=vi.MAX_FINDER_PATTERN_RATIO){let N=Number.MAX_SAFE_INTEGER,I=Number.MIN_SAFE_INTEGER;for(let R of h)R>I&&(I=R),R<N&&(N=R);return I<10*N}return!1}}vi.MAX_AVG_VARIANCE=.2,vi.MAX_INDIVIDUAL_VARIANCE=.45,vi.MIN_FINDER_PATTERN_RATIO=9.5/12,vi.MAX_FINDER_PATTERN_RATIO=12.5/14;class $a{constructor(h,g){this.value=h,this.checksumPortion=g}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(h){if(!(h instanceof $a))return!1;const g=h;return this.value===g.value&&this.checksumPortion===g.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class vr{constructor(h,g,b,S,N){this.value=h,this.startEnd=g,this.value=h,this.startEnd=g,this.resultPoints=new Array,this.resultPoints.push(new St(b,N)),this.resultPoints.push(new St(S,N))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(h){if(!(h instanceof vr))return!1;const g=h;return this.value===g.value}hashCode(){return this.value}}class Oa{constructor(){}static getRSSvalue(h,g,b){let S=0;for(let H of h)S+=H;let N=0,I=0,R=h.length;for(let H=0;H<R-1;H++){let ne;for(ne=1,I|=1<<H;ne<h[H];ne++,I&=~(1<<H)){let he=Oa.combins(S-ne-1,R-H-2);if(b&&I===0&&S-ne-(R-H-1)>=R-H-1&&(he-=Oa.combins(S-ne-(R-H),R-H-2)),R-H-1>1){let ve=0;for(let Ne=S-ne-(R-H-2);Ne>g;Ne--)ve+=Oa.combins(S-ne-Ne-1,R-H-3);he-=ve*(R-1-H)}else S-ne>g&&he--;N+=he}S-=ne}return N}static combins(h,g){let b,S;h-g>g?(S=g,b=h-g):(S=h-g,b=g);let N=1,I=1;for(let R=h;R>b;R--)N*=R,I<=S&&(N/=I,I++);for(;I<=S;)N/=I,I++;return N}}class ml{static buildBitArray(h){let g=h.length*2-1;h[h.length-1].getRightChar()==null&&(g-=1);let b=12*g,S=new M(b),N=0,R=h[0].getRightChar().getValue();for(let H=11;H>=0;--H)(R&1<<H)!=0&&S.set(N),N++;for(let H=1;H<h.length;++H){let ne=h[H],he=ne.getLeftChar().getValue();for(let ve=11;ve>=0;--ve)(he&1<<ve)!=0&&S.set(N),N++;if(ne.getRightChar()!=null){let ve=ne.getRightChar().getValue();for(let Ne=11;Ne>=0;--Ne)(ve&1<<Ne)!=0&&S.set(N),N++}}return S}}class ga{constructor(h,g){g?this.decodedInformation=null:(this.finished=h,this.decodedInformation=g)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Ds{constructor(h){this.newPosition=h}getNewPosition(){return this.newPosition}}class Xr extends Ds{constructor(h,g){super(h),this.value=g}getValue(){return this.value}isFNC1(){return this.value===Xr.FNC1}}Xr.FNC1="$";class $t extends Ds{constructor(h,g,b){super(h),b?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=g}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Qn extends Ds{constructor(h,g,b){if(super(h),g<0||g>10||b<0||b>10)throw new $;this.firstDigit=g,this.secondDigit=b}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Qn.FNC1}isSecondDigitFNC1(){return this.secondDigit===Qn.FNC1}isAnyFNC1(){return this.firstDigit===Qn.FNC1||this.secondDigit===Qn.FNC1}}Qn.FNC1=10;class er{constructor(){}static parseFieldsInGeneralPurpose(h){if(!h)return null;if(h.length<2)throw new le;let g=h.substring(0,2);for(let N of er.TWO_DIGIT_DATA_LENGTH)if(N[0]===g)return N[1]===er.VARIABLE_LENGTH?er.processVariableAI(2,N[2],h):er.processFixedAI(2,N[1],h);if(h.length<3)throw new le;let b=h.substring(0,3);for(let N of er.THREE_DIGIT_DATA_LENGTH)if(N[0]===b)return N[1]===er.VARIABLE_LENGTH?er.processVariableAI(3,N[2],h):er.processFixedAI(3,N[1],h);for(let N of er.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(N[0]===b)return N[1]===er.VARIABLE_LENGTH?er.processVariableAI(4,N[2],h):er.processFixedAI(4,N[1],h);if(h.length<4)throw new le;let S=h.substring(0,4);for(let N of er.FOUR_DIGIT_DATA_LENGTH)if(N[0]===S)return N[1]===er.VARIABLE_LENGTH?er.processVariableAI(4,N[2],h):er.processFixedAI(4,N[1],h);throw new le}static processFixedAI(h,g,b){if(b.length<h)throw new le;let S=b.substring(0,h);if(b.length<h+g)throw new le;let N=b.substring(h,h+g),I=b.substring(h+g),R="("+S+")"+N,H=er.parseFieldsInGeneralPurpose(I);return H==null?R:R+H}static processVariableAI(h,g,b){let S=b.substring(0,h),N;b.length<h+g?N=b.length:N=h+g;let I=b.substring(h,N),R=b.substring(N),H="("+S+")"+I,ne=er.parseFieldsInGeneralPurpose(R);return ne==null?H:H+ne}}er.VARIABLE_LENGTH=[],er.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",er.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",er.VARIABLE_LENGTH,20],["22",er.VARIABLE_LENGTH,29],["30",er.VARIABLE_LENGTH,8],["37",er.VARIABLE_LENGTH,8],["90",er.VARIABLE_LENGTH,30],["91",er.VARIABLE_LENGTH,30],["92",er.VARIABLE_LENGTH,30],["93",er.VARIABLE_LENGTH,30],["94",er.VARIABLE_LENGTH,30],["95",er.VARIABLE_LENGTH,30],["96",er.VARIABLE_LENGTH,30],["97",er.VARIABLE_LENGTH,3],["98",er.VARIABLE_LENGTH,30],["99",er.VARIABLE_LENGTH,30]],er.THREE_DIGIT_DATA_LENGTH=[["240",er.VARIABLE_LENGTH,30],["241",er.VARIABLE_LENGTH,30],["242",er.VARIABLE_LENGTH,6],["250",er.VARIABLE_LENGTH,30],["251",er.VARIABLE_LENGTH,30],["253",er.VARIABLE_LENGTH,17],["254",er.VARIABLE_LENGTH,20],["400",er.VARIABLE_LENGTH,30],["401",er.VARIABLE_LENGTH,30],["402",17],["403",er.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",er.VARIABLE_LENGTH,20],["421",er.VARIABLE_LENGTH,15],["422",3],["423",er.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],er.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",er.VARIABLE_LENGTH,15],["391",er.VARIABLE_LENGTH,18],["392",er.VARIABLE_LENGTH,15],["393",er.VARIABLE_LENGTH,18],["703",er.VARIABLE_LENGTH,30]],er.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",er.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",er.VARIABLE_LENGTH,20],["8003",er.VARIABLE_LENGTH,30],["8004",er.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",er.VARIABLE_LENGTH,30],["8008",er.VARIABLE_LENGTH,12],["8018",18],["8020",er.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",er.VARIABLE_LENGTH,70],["8200",er.VARIABLE_LENGTH,70]];class Xi{constructor(h){this.buffer=new re,this.information=h}decodeAllCodes(h,g){let b=g,S=null;do{let N=this.decodeGeneralPurposeField(b,S),I=er.parseFieldsInGeneralPurpose(N.getNewString());if(I!=null&&h.append(I),N.isRemaining()?S=""+N.getRemainingValue():S=null,b===N.getNewPosition())break;b=N.getNewPosition()}while(!0);return h.toString()}isStillNumeric(h){if(h+7>this.information.getSize())return h+4<=this.information.getSize();for(let g=h;g<h+3;++g)if(this.information.get(g))return!0;return this.information.get(h+3)}decodeNumeric(h){if(h+7>this.information.getSize()){let N=this.extractNumericValueFromBitArray(h,4);return N===0?new Qn(this.information.getSize(),Qn.FNC1,Qn.FNC1):new Qn(this.information.getSize(),N-1,Qn.FNC1)}let g=this.extractNumericValueFromBitArray(h,7),b=(g-8)/11,S=(g-8)%11;return new Qn(h+7,b,S)}extractNumericValueFromBitArray(h,g){return Xi.extractNumericValueFromBitArray(this.information,h,g)}static extractNumericValueFromBitArray(h,g,b){let S=0;for(let N=0;N<b;++N)h.get(g+N)&&(S|=1<<b-N-1);return S}decodeGeneralPurposeField(h,g){this.buffer.setLengthToZero(),g!=null&&this.buffer.append(g),this.current.setPosition(h);let b=this.parseBlocks();return b!=null&&b.isRemaining()?new $t(this.current.getPosition(),this.buffer.toString(),b.getRemainingValue()):new $t(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let h,g;do{let b=this.current.getPosition();if(this.current.isAlpha()?(g=this.parseAlphaBlock(),h=g.isFinished()):this.current.isIsoIec646()?(g=this.parseIsoIec646Block(),h=g.isFinished()):(g=this.parseNumericBlock(),h=g.isFinished()),!(b!==this.current.getPosition())&&!h)break}while(!h);return g.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let h=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(h.getNewPosition()),h.isFirstDigitFNC1()){let g;return h.isSecondDigitFNC1()?g=new $t(this.current.getPosition(),this.buffer.toString()):g=new $t(this.current.getPosition(),this.buffer.toString(),h.getSecondDigit()),new ga(!0,g)}if(this.buffer.append(h.getFirstDigit()),h.isSecondDigitFNC1()){let g=new $t(this.current.getPosition(),this.buffer.toString());return new ga(!0,g)}this.buffer.append(h.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ga(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let h=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(h.getNewPosition()),h.isFNC1()){let g=new $t(this.current.getPosition(),this.buffer.toString());return new ga(!0,g)}this.buffer.append(h.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ga(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let h=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(h.getNewPosition()),h.isFNC1()){let g=new $t(this.current.getPosition(),this.buffer.toString());return new ga(!0,g)}this.buffer.append(h.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ga(!1)}isStillIsoIec646(h){if(h+5>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(h,5);if(g>=5&&g<16)return!0;if(h+7>this.information.getSize())return!1;let b=this.extractNumericValueFromBitArray(h,7);if(b>=64&&b<116)return!0;if(h+8>this.information.getSize())return!1;let S=this.extractNumericValueFromBitArray(h,8);return S>=232&&S<253}decodeIsoIec646(h){let g=this.extractNumericValueFromBitArray(h,5);if(g===15)return new Xr(h+5,Xr.FNC1);if(g>=5&&g<15)return new Xr(h+5,"0"+(g-5));let b=this.extractNumericValueFromBitArray(h,7);if(b>=64&&b<90)return new Xr(h+7,""+(b+1));if(b>=90&&b<116)return new Xr(h+7,""+(b+7));let S=this.extractNumericValueFromBitArray(h,8),N;switch(S){case 232:N="!";break;case 233:N='"';break;case 234:N="%";break;case 235:N="&";break;case 236:N="'";break;case 237:N="(";break;case 238:N=")";break;case 239:N="*";break;case 240:N="+";break;case 241:N=",";break;case 242:N="-";break;case 243:N=".";break;case 244:N="/";break;case 245:N=":";break;case 246:N=";";break;case 247:N="<";break;case 248:N="=";break;case 249:N=">";break;case 250:N="?";break;case 251:N="_";break;case 252:N=" ";break;default:throw new $}return new Xr(h+8,N)}isStillAlpha(h){if(h+5>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(h,5);if(g>=5&&g<16)return!0;if(h+6>this.information.getSize())return!1;let b=this.extractNumericValueFromBitArray(h,6);return b>=16&&b<63}decodeAlphanumeric(h){let g=this.extractNumericValueFromBitArray(h,5);if(g===15)return new Xr(h+5,Xr.FNC1);if(g>=5&&g<15)return new Xr(h+5,"0"+(g-5));let b=this.extractNumericValueFromBitArray(h,6);if(b>=32&&b<58)return new Xr(h+6,""+(b+33));let S;switch(b){case 58:S="*";break;case 59:S=",";break;case 60:S="-";break;case 61:S=".";break;case 62:S="/";break;default:throw new Oe("Decoding invalid alphanumeric value: "+b)}return new Xr(h+6,S)}isAlphaTo646ToAlphaLatch(h){if(h+1>this.information.getSize())return!1;for(let g=0;g<5&&g+h<this.information.getSize();++g)if(g===2){if(!this.information.get(h+2))return!1}else if(this.information.get(h+g))return!1;return!0}isAlphaOr646ToNumericLatch(h){if(h+3>this.information.getSize())return!1;for(let g=h;g<h+3;++g)if(this.information.get(g))return!1;return!0}isNumericToAlphaNumericLatch(h){if(h+1>this.information.getSize())return!1;for(let g=0;g<4&&g+h<this.information.getSize();++g)if(this.information.get(h+g))return!1;return!0}}class Yn{constructor(h){this.information=h,this.generalDecoder=new Xi(h)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class vn extends Yn{constructor(h){super(h)}encodeCompressedGtin(h,g){h.append("(01)");let b=h.length();h.append("9"),this.encodeCompressedGtinWithoutAI(h,g,b)}encodeCompressedGtinWithoutAI(h,g,b){for(let S=0;S<4;++S){let N=this.getGeneralDecoder().extractNumericValueFromBitArray(g+10*S,10);N/100===0&&h.append("0"),N/10===0&&h.append("0"),h.append(N)}vn.appendCheckDigit(h,b)}static appendCheckDigit(h,g){let b=0;for(let S=0;S<13;S++){let N=h.charAt(S+g).charCodeAt(0)-48;b+=(S&1)===0?3*N:N}b=10-b%10,b===10&&(b=0),h.append(b)}}vn.GTIN_SIZE=40;class Fi extends vn{constructor(h){super(h)}parseInformation(){let h=new re;h.append("(01)");let g=h.length(),b=this.getGeneralDecoder().extractNumericValueFromBitArray(Fi.HEADER_SIZE,4);return h.append(b),this.encodeCompressedGtinWithoutAI(h,Fi.HEADER_SIZE+4,g),this.getGeneralDecoder().decodeAllCodes(h,Fi.HEADER_SIZE+44)}}Fi.HEADER_SIZE=4;class Ji extends Yn{constructor(h){super(h)}parseInformation(){let h=new re;return this.getGeneralDecoder().decodeAllCodes(h,Ji.HEADER_SIZE)}}Ji.HEADER_SIZE=5;class cs extends vn{constructor(h){super(h)}encodeCompressedWeight(h,g,b){let S=this.getGeneralDecoder().extractNumericValueFromBitArray(g,b);this.addWeightCode(h,S);let N=this.checkWeight(S),I=1e5;for(let R=0;R<5;++R)N/I===0&&h.append("0"),I/=10;h.append(N)}}class ds extends cs{constructor(h){super(h)}parseInformation(){if(this.getInformation().getSize()!=ds.HEADER_SIZE+cs.GTIN_SIZE+ds.WEIGHT_SIZE)throw new le;let h=new re;return this.encodeCompressedGtin(h,ds.HEADER_SIZE),this.encodeCompressedWeight(h,ds.HEADER_SIZE+cs.GTIN_SIZE,ds.WEIGHT_SIZE),h.toString()}}ds.HEADER_SIZE=5,ds.WEIGHT_SIZE=15;class $o extends ds{constructor(h){super(h)}addWeightCode(h,g){h.append("(3103)")}checkWeight(h){return h}}class Go extends ds{constructor(h){super(h)}addWeightCode(h,g){g<1e4?h.append("(3202)"):h.append("(3203)")}checkWeight(h){return h<1e4?h:h-1e4}}class Ga extends vn{constructor(h){super(h)}parseInformation(){if(this.getInformation().getSize()<Ga.HEADER_SIZE+vn.GTIN_SIZE)throw new le;let h=new re;this.encodeCompressedGtin(h,Ga.HEADER_SIZE);let g=this.getGeneralDecoder().extractNumericValueFromBitArray(Ga.HEADER_SIZE+vn.GTIN_SIZE,Ga.LAST_DIGIT_SIZE);h.append("(392"),h.append(g),h.append(")");let b=this.getGeneralDecoder().decodeGeneralPurposeField(Ga.HEADER_SIZE+vn.GTIN_SIZE+Ga.LAST_DIGIT_SIZE,null);return h.append(b.getNewString()),h.toString()}}Ga.HEADER_SIZE=8,Ga.LAST_DIGIT_SIZE=2;class fi extends vn{constructor(h){super(h)}parseInformation(){if(this.getInformation().getSize()<fi.HEADER_SIZE+vn.GTIN_SIZE)throw new le;let h=new re;this.encodeCompressedGtin(h,fi.HEADER_SIZE);let g=this.getGeneralDecoder().extractNumericValueFromBitArray(fi.HEADER_SIZE+vn.GTIN_SIZE,fi.LAST_DIGIT_SIZE);h.append("(393"),h.append(g),h.append(")");let b=this.getGeneralDecoder().extractNumericValueFromBitArray(fi.HEADER_SIZE+vn.GTIN_SIZE+fi.LAST_DIGIT_SIZE,fi.FIRST_THREE_DIGITS_SIZE);b/100==0&&h.append("0"),b/10==0&&h.append("0"),h.append(b);let S=this.getGeneralDecoder().decodeGeneralPurposeField(fi.HEADER_SIZE+vn.GTIN_SIZE+fi.LAST_DIGIT_SIZE+fi.FIRST_THREE_DIGITS_SIZE,null);return h.append(S.getNewString()),h.toString()}}fi.HEADER_SIZE=8,fi.LAST_DIGIT_SIZE=2,fi.FIRST_THREE_DIGITS_SIZE=10;class kn extends cs{constructor(h,g,b){super(h),this.dateCode=b,this.firstAIdigits=g}parseInformation(){if(this.getInformation().getSize()!=kn.HEADER_SIZE+kn.GTIN_SIZE+kn.WEIGHT_SIZE+kn.DATE_SIZE)throw new le;let h=new re;return this.encodeCompressedGtin(h,kn.HEADER_SIZE),this.encodeCompressedWeight(h,kn.HEADER_SIZE+kn.GTIN_SIZE,kn.WEIGHT_SIZE),this.encodeCompressedDate(h,kn.HEADER_SIZE+kn.GTIN_SIZE+kn.WEIGHT_SIZE),h.toString()}encodeCompressedDate(h,g){let b=this.getGeneralDecoder().extractNumericValueFromBitArray(g,kn.DATE_SIZE);if(b==38400)return;h.append("("),h.append(this.dateCode),h.append(")");let S=b%32;b/=32;let N=b%12+1;b/=12;let I=b;I/10==0&&h.append("0"),h.append(I),N/10==0&&h.append("0"),h.append(N),S/10==0&&h.append("0"),h.append(S)}addWeightCode(h,g){h.append("("),h.append(this.firstAIdigits),h.append(g/1e5),h.append(")")}checkWeight(h){return h%1e5}}kn.HEADER_SIZE=8,kn.WEIGHT_SIZE=20,kn.DATE_SIZE=16;function Ko(je){try{if(je.get(1))return new Fi(je);if(!je.get(2))return new Ji(je);switch(Xi.extractNumericValueFromBitArray(je,1,4)){case 4:return new $o(je);case 5:return new Go(je)}switch(Xi.extractNumericValueFromBitArray(je,1,5)){case 12:return new Ga(je);case 13:return new fi(je)}switch(Xi.extractNumericValueFromBitArray(je,1,7)){case 56:return new kn(je,"310","11");case 57:return new kn(je,"320","11");case 58:return new kn(je,"310","13");case 59:return new kn(je,"320","13");case 60:return new kn(je,"310","15");case 61:return new kn(je,"320","15");case 62:return new kn(je,"310","17");case 63:return new kn(je,"320","17")}}catch(h){throw console.log(h),new Oe("unknown decoder: "+je)}}class Ka{constructor(h,g,b,S){this.leftchar=h,this.rightchar=g,this.finderpattern=b,this.maybeLast=S}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(h,g){return h instanceof Ka?Ka.equalsOrNull(h.leftchar,g.leftchar)&&Ka.equalsOrNull(h.rightchar,g.rightchar)&&Ka.equalsOrNull(h.finderpattern,g.finderpattern):!1}static equalsOrNull(h,g){return h===null?g===null:Ka.equals(h,g)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Oi{constructor(h,g,b){this.pairs=h,this.rowNumber=g,this.wasReversed=b}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(h){return this.checkEqualitity(this,h)}toString(){return"{ "+this.pairs+" }"}equals(h,g){return h instanceof Oi?this.checkEqualitity(h,g)&&h.wasReversed===g.wasReversed:!1}checkEqualitity(h,g){if(!h||!g)return;let b;return h.forEach((S,N)=>{g.forEach(I=>{S.getLeftChar().getValue()===I.getLeftChar().getValue()&&S.getRightChar().getValue()===I.getRightChar().getValue()&&S.getFinderPatter().getValue()===I.getFinderPatter().getValue()&&(b=!0)})}),b}}class Rt extends vi{constructor(h){super(...arguments),this.pairs=new Array(Rt.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=h===!0}decodeRow(h,g,b){this.pairs.length=0,this.startFromEven=!1;try{return Rt.constructResult(this.decodeRow2pairs(h,g))}catch(S){this.verbose&&console.log(S)}return this.pairs.length=0,this.startFromEven=!0,Rt.constructResult(this.decodeRow2pairs(h,g))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(h,g){let b=!1;for(;!b;)try{this.pairs.push(this.retrieveNextPair(g,this.pairs,h))}catch(N){if(N instanceof le){if(!this.pairs.length)throw new le;b=!0}}if(this.checkChecksum())return this.pairs;let S;if(this.rows.length?S=!0:S=!1,this.storeRow(h,!1),S){let N=this.checkRowsBoolean(!1);if(N!=null||(N=this.checkRowsBoolean(!0),N!=null))return N}throw new le}checkRowsBoolean(h){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,h&&(this.rows=this.rows.reverse());let g=null;try{g=this.checkRows(new Array,0)}catch(b){this.verbose&&console.log(b)}return h&&(this.rows=this.rows.reverse()),g}checkRows(h,g){for(let b=g;b<this.rows.length;b++){let S=this.rows[b];this.pairs.length=0;for(let I of h)this.pairs.push(I.getPairs());if(this.pairs.push(S.getPairs()),!Rt.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let N=new Array(h);N.push(S);try{return this.checkRows(N,b+1)}catch(I){this.verbose&&console.log(I)}}throw new le}static isValidSequence(h){for(let g of Rt.FINDER_PATTERN_SEQUENCES){if(h.length>g.length)continue;let b=!0;for(let S=0;S<h.length;S++)if(h[S].getFinderPattern().getValue()!=g[S]){b=!1;break}if(b)return!0}return!1}storeRow(h,g){let b=0,S=!1,N=!1;for(;b<this.rows.length;){let I=this.rows[b];if(I.getRowNumber()>h){N=I.isEquivalent(this.pairs);break}S=I.isEquivalent(this.pairs),b++}N||S||Rt.isPartialRow(this.pairs,this.rows)||(this.rows.push(b,new Oi(this.pairs,h,g)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(h,g){for(let b of g)if(b.getPairs().length!==h.length){for(let S of b.getPairs())for(let N of h)if(Ka.equals(S,N))break}}static isPartialRow(h,g){for(let b of g){let S=!0;for(let N of h){let I=!1;for(let R of b.getPairs())if(N.equals(R)){I=!0;break}if(!I){S=!1;break}}if(S)return!0}return!1}getRows(){return this.rows}static constructResult(h){let g=ml.buildBitArray(h),S=Ko(g).parseInformation(),N=h[0].getFinderPattern().getResultPoints(),I=h[h.length-1].getFinderPattern().getResultPoints(),R=[N[0],N[1],I[0],I[1]];return new W(S,null,null,R,ge.RSS_EXPANDED,null)}checkChecksum(){let h=this.pairs.get(0),g=h.getLeftChar(),b=h.getRightChar();if(b==null)return!1;let S=b.getChecksumPortion(),N=2;for(let R=1;R<this.pairs.size();++R){let H=this.pairs.get(R);S+=H.getLeftChar().getChecksumPortion(),N++;let ne=H.getRightChar();ne!=null&&(S+=ne.getChecksumPortion(),N++)}return S%=211,211*(N-4)+S==g.getValue()}static getNextSecondBar(h,g){let b;return h.get(g)?(b=h.getNextUnset(g),b=h.getNextSet(b)):(b=h.getNextSet(g),b=h.getNextUnset(b)),b}retrieveNextPair(h,g,b){let S=g.length%2==0;this.startFromEven&&(S=!S);let N,I=!0,R=-1;do this.findNextPair(h,g,R),N=this.parseFoundFinderPattern(h,b,S),N==null?R=Rt.getNextSecondBar(h,this.startEnd[0]):I=!1;while(I);let H=this.decodeDataCharacter(h,N,S,!0);if(!this.isEmptyPair(g)&&g[g.length-1].mustBeLast())throw new le;let ne;try{ne=this.decodeDataCharacter(h,N,S,!1)}catch(he){ne=null,this.verbose&&console.log(he)}return new Ka(H,ne,N,!0)}isEmptyPair(h){return h.length===0}findNextPair(h,g,b){let S=this.getDecodeFinderCounters();S[0]=0,S[1]=0,S[2]=0,S[3]=0;let N=h.getSize(),I;b>=0?I=b:this.isEmptyPair(g)?I=0:I=g[g.length-1].getFinderPattern().getStartEnd()[1];let R=g.length%2!=0;this.startFromEven&&(R=!R);let H=!1;for(;I<N&&(H=!h.get(I),!!H);)I++;let ne=0,he=I;for(let ve=I;ve<N;ve++)if(h.get(ve)!=H)S[ne]++;else{if(ne==3){if(R&&Rt.reverseCounters(S),Rt.isFinderPattern(S)){this.startEnd[0]=he,this.startEnd[1]=ve;return}R&&Rt.reverseCounters(S),he+=S[0]+S[1],S[0]=S[2],S[1]=S[3],S[2]=0,S[3]=0,ne--}else ne++;S[ne]=1,H=!H}throw new le}static reverseCounters(h){let g=h.length;for(let b=0;b<g/2;++b){let S=h[b];h[b]=h[g-b-1],h[g-b-1]=S}}parseFoundFinderPattern(h,g,b){let S,N,I;if(b){let ne=this.startEnd[0]-1;for(;ne>=0&&!h.get(ne);)ne--;ne++,S=this.startEnd[0]-ne,N=ne,I=this.startEnd[1]}else N=this.startEnd[0],I=h.getNextUnset(this.startEnd[1]+1),S=I-this.startEnd[1];let R=this.getDecodeFinderCounters();C.arraycopy(R,0,R,1,R.length-1),R[0]=S;let H;try{H=this.parseFinderValue(R,Rt.FINDER_PATTERNS)}catch{return null}return new vr(H,[N,I],N,I,g)}decodeDataCharacter(h,g,b,S){let N=this.getDataCharacterCounters();for(let Un=0;Un<N.length;Un++)N[Un]=0;if(S)Rt.recordPatternInReverse(h,g.getStartEnd()[0],N);else{Rt.recordPattern(h,g.getStartEnd()[1],N);for(let Un=0,Ma=N.length-1;Un<Ma;Un++,Ma--){let Ms=N[Un];N[Un]=N[Ma],N[Ma]=Ms}}let I=17,R=yt.sum(new Int32Array(N))/I,H=(g.getStartEnd()[1]-g.getStartEnd()[0])/15;if(Math.abs(R-H)/H>.3)throw new le;let ne=this.getOddCounts(),he=this.getEvenCounts(),ve=this.getOddRoundingErrors(),Ne=this.getEvenRoundingErrors();for(let Un=0;Un<N.length;Un++){let Ma=1*N[Un]/R,Ms=Ma+.5;if(Ms<1){if(Ma<.3)throw new le;Ms=1}else if(Ms>8){if(Ma>8.7)throw new le;Ms=8}let xc=Un/2;(Un&1)==0?(ne[xc]=Ms,ve[xc]=Ma-Ms):(he[xc]=Ms,Ne[xc]=Ma-Ms)}this.adjustOddEvenCounts(I);let Me=4*g.getValue()+(b?0:2)+(S?0:1)-1,qe=0,$e=0;for(let Un=ne.length-1;Un>=0;Un--){if(Rt.isNotA1left(g,b,S)){let Ma=Rt.WEIGHTS[Me][2*Un];$e+=ne[Un]*Ma}qe+=ne[Un]}let Xe=0;for(let Un=he.length-1;Un>=0;Un--)if(Rt.isNotA1left(g,b,S)){let Ma=Rt.WEIGHTS[Me][2*Un+1];Xe+=he[Un]*Ma}let ct=$e+Xe;if((qe&1)!=0||qe>13||qe<4)throw new le;let Tt=(13-qe)/2,_t=Rt.SYMBOL_WIDEST[Tt],At=9-_t,Tr=Oa.getRSSvalue(ne,_t,!0),qr=Oa.getRSSvalue(he,At,!1),Mn=Rt.EVEN_TOTAL_SUBSET[Tt],ua=Rt.GSUM[Tt],Ra=Tr*Mn+qr+ua;return new $a(Ra,ct)}static isNotA1left(h,g,b){return!(h.getValue()==0&&g&&b)}adjustOddEvenCounts(h){let g=yt.sum(new Int32Array(this.getOddCounts())),b=yt.sum(new Int32Array(this.getEvenCounts())),S=!1,N=!1;g>13?N=!0:g<4&&(S=!0);let I=!1,R=!1;b>13?R=!0:b<4&&(I=!0);let H=g+b-h,ne=(g&1)==1,he=(b&1)==0;if(H==1)if(ne){if(he)throw new le;N=!0}else{if(!he)throw new le;R=!0}else if(H==-1)if(ne){if(he)throw new le;S=!0}else{if(!he)throw new le;I=!0}else if(H==0){if(ne){if(!he)throw new le;g<b?(S=!0,R=!0):(N=!0,I=!0)}else if(he)throw new le}else throw new le;if(S){if(N)throw new le;Rt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(N&&Rt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),I){if(R)throw new le;Rt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}R&&Rt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Rt.SYMBOL_WIDEST=[7,5,4,3,1],Rt.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Rt.GSUM=[0,348,1388,2948,3988],Rt.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Rt.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Rt.FINDER_PAT_A=0,Rt.FINDER_PAT_B=1,Rt.FINDER_PAT_C=2,Rt.FINDER_PAT_D=3,Rt.FINDER_PAT_E=4,Rt.FINDER_PAT_F=5,Rt.FINDER_PATTERN_SEQUENCES=[[Rt.FINDER_PAT_A,Rt.FINDER_PAT_A],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_B,Rt.FINDER_PAT_B],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_C,Rt.FINDER_PAT_B,Rt.FINDER_PAT_D],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_E,Rt.FINDER_PAT_B,Rt.FINDER_PAT_D,Rt.FINDER_PAT_C],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_E,Rt.FINDER_PAT_B,Rt.FINDER_PAT_D,Rt.FINDER_PAT_D,Rt.FINDER_PAT_F],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_E,Rt.FINDER_PAT_B,Rt.FINDER_PAT_D,Rt.FINDER_PAT_E,Rt.FINDER_PAT_F,Rt.FINDER_PAT_F],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_A,Rt.FINDER_PAT_B,Rt.FINDER_PAT_B,Rt.FINDER_PAT_C,Rt.FINDER_PAT_C,Rt.FINDER_PAT_D,Rt.FINDER_PAT_D],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_A,Rt.FINDER_PAT_B,Rt.FINDER_PAT_B,Rt.FINDER_PAT_C,Rt.FINDER_PAT_C,Rt.FINDER_PAT_D,Rt.FINDER_PAT_E,Rt.FINDER_PAT_E],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_A,Rt.FINDER_PAT_B,Rt.FINDER_PAT_B,Rt.FINDER_PAT_C,Rt.FINDER_PAT_C,Rt.FINDER_PAT_D,Rt.FINDER_PAT_E,Rt.FINDER_PAT_F,Rt.FINDER_PAT_F],[Rt.FINDER_PAT_A,Rt.FINDER_PAT_A,Rt.FINDER_PAT_B,Rt.FINDER_PAT_B,Rt.FINDER_PAT_C,Rt.FINDER_PAT_D,Rt.FINDER_PAT_D,Rt.FINDER_PAT_E,Rt.FINDER_PAT_E,Rt.FINDER_PAT_F,Rt.FINDER_PAT_F]],Rt.MAX_PAIRS=11;class io extends $a{constructor(h,g,b){super(h,g),this.count=0,this.finderPattern=b}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class zn extends vi{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(h,g,b){const S=this.decodePair(g,!1,h,b);zn.addOrTally(this.possibleLeftPairs,S),g.reverse();let N=this.decodePair(g,!0,h,b);zn.addOrTally(this.possibleRightPairs,N),g.reverse();for(let I of this.possibleLeftPairs)if(I.getCount()>1){for(let R of this.possibleRightPairs)if(R.getCount()>1&&zn.checkChecksum(I,R))return zn.constructResult(I,R)}throw new le}static addOrTally(h,g){if(g==null)return;let b=!1;for(let S of h)if(S.getValue()===g.getValue()){S.incrementCount(),b=!0;break}b||h.push(g)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(h,g){let b=4537077*h.getValue()+g.getValue(),S=new String(b).toString(),N=new re;for(let ne=13-S.length;ne>0;ne--)N.append("0");N.append(S);let I=0;for(let ne=0;ne<13;ne++){let he=N.charAt(ne).charCodeAt(0)-48;I+=(ne&1)===0?3*he:he}I=10-I%10,I===10&&(I=0),N.append(I.toString());let R=h.getFinderPattern().getResultPoints(),H=g.getFinderPattern().getResultPoints();return new W(N.toString(),null,0,[R[0],R[1],H[0],H[1]],ge.RSS_14,new Date().getTime())}static checkChecksum(h,g){let b=(h.getChecksumPortion()+16*g.getChecksumPortion())%79,S=9*h.getFinderPattern().getValue()+g.getFinderPattern().getValue();return S>72&&S--,S>8&&S--,b===S}decodePair(h,g,b,S){try{let N=this.findFinderPattern(h,g),I=this.parseFoundFinderPattern(h,b,g,N),R=S==null?null:S.get(U.NEED_RESULT_POINT_CALLBACK);if(R!=null){let he=(N[0]+N[1])/2;g&&(he=h.getSize()-1-he),R.foundPossibleResultPoint(new St(he,b))}let H=this.decodeDataCharacter(h,I,!0),ne=this.decodeDataCharacter(h,I,!1);return new io(1597*H.getValue()+ne.getValue(),H.getChecksumPortion()+4*ne.getChecksumPortion(),I)}catch{return null}}decodeDataCharacter(h,g,b){let S=this.getDataCharacterCounters();for(let Xe=0;Xe<S.length;Xe++)S[Xe]=0;if(b)Er.recordPatternInReverse(h,g.getStartEnd()[0],S);else{Er.recordPattern(h,g.getStartEnd()[1]+1,S);for(let Xe=0,ct=S.length-1;Xe<ct;Xe++,ct--){let Tt=S[Xe];S[Xe]=S[ct],S[ct]=Tt}}let N=b?16:15,I=yt.sum(new Int32Array(S))/N,R=this.getOddCounts(),H=this.getEvenCounts(),ne=this.getOddRoundingErrors(),he=this.getEvenRoundingErrors();for(let Xe=0;Xe<S.length;Xe++){let ct=S[Xe]/I,Tt=Math.floor(ct+.5);Tt<1?Tt=1:Tt>8&&(Tt=8);let _t=Math.floor(Xe/2);(Xe&1)===0?(R[_t]=Tt,ne[_t]=ct-Tt):(H[_t]=Tt,he[_t]=ct-Tt)}this.adjustOddEvenCounts(b,N);let ve=0,Ne=0;for(let Xe=R.length-1;Xe>=0;Xe--)Ne*=9,Ne+=R[Xe],ve+=R[Xe];let Me=0,qe=0;for(let Xe=H.length-1;Xe>=0;Xe--)Me*=9,Me+=H[Xe],qe+=H[Xe];let $e=Ne+3*Me;if(b){if((ve&1)!==0||ve>12||ve<4)throw new le;let Xe=(12-ve)/2,ct=zn.OUTSIDE_ODD_WIDEST[Xe],Tt=9-ct,_t=Oa.getRSSvalue(R,ct,!1),At=Oa.getRSSvalue(H,Tt,!0),Tr=zn.OUTSIDE_EVEN_TOTAL_SUBSET[Xe],qr=zn.OUTSIDE_GSUM[Xe];return new $a(_t*Tr+At+qr,$e)}else{if((qe&1)!==0||qe>10||qe<4)throw new le;let Xe=(10-qe)/2,ct=zn.INSIDE_ODD_WIDEST[Xe],Tt=9-ct,_t=Oa.getRSSvalue(R,ct,!0),At=Oa.getRSSvalue(H,Tt,!1),Tr=zn.INSIDE_ODD_TOTAL_SUBSET[Xe],qr=zn.INSIDE_GSUM[Xe];return new $a(At*Tr+_t+qr,$e)}}findFinderPattern(h,g){let b=this.getDecodeFinderCounters();b[0]=0,b[1]=0,b[2]=0,b[3]=0;let S=h.getSize(),N=!1,I=0;for(;I<S&&(N=!h.get(I),g!==N);)I++;let R=0,H=I;for(let ne=I;ne<S;ne++)if(h.get(ne)!==N)b[R]++;else{if(R===3){if(vi.isFinderPattern(b))return[H,ne];H+=b[0]+b[1],b[0]=b[2],b[1]=b[3],b[2]=0,b[3]=0,R--}else R++;b[R]=1,N=!N}throw new le}parseFoundFinderPattern(h,g,b,S){let N=h.get(S[0]),I=S[0]-1;for(;I>=0&&N!==h.get(I);)I--;I++;const R=S[0]-I,H=this.getDecodeFinderCounters(),ne=new Int32Array(H.length);C.arraycopy(H,0,ne,1,H.length-1),ne[0]=R;const he=this.parseFinderValue(ne,zn.FINDER_PATTERNS);let ve=I,Ne=S[1];return b&&(ve=h.getSize()-1-ve,Ne=h.getSize()-1-Ne),new vr(he,[I,S[1]],ve,Ne,g)}adjustOddEvenCounts(h,g){let b=yt.sum(new Int32Array(this.getOddCounts())),S=yt.sum(new Int32Array(this.getEvenCounts())),N=!1,I=!1,R=!1,H=!1;h?(b>12?I=!0:b<4&&(N=!0),S>12?H=!0:S<4&&(R=!0)):(b>11?I=!0:b<5&&(N=!0),S>10?H=!0:S<4&&(R=!0));let ne=b+S-g,he=(b&1)===(h?1:0),ve=(S&1)===1;if(ne===1)if(he){if(ve)throw new le;I=!0}else{if(!ve)throw new le;H=!0}else if(ne===-1)if(he){if(ve)throw new le;N=!0}else{if(!ve)throw new le;R=!0}else if(ne===0){if(he){if(!ve)throw new le;b<S?(N=!0,H=!0):(I=!0,R=!0)}else if(ve)throw new le}else throw new le;if(N){if(I)throw new le;vi.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(I&&vi.decrement(this.getOddCounts(),this.getOddRoundingErrors()),R){if(H)throw new le;vi.increment(this.getEvenCounts(),this.getOddRoundingErrors())}H&&vi.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}zn.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],zn.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],zn.OUTSIDE_GSUM=[0,161,961,2015,2715],zn.INSIDE_GSUM=[0,336,1036,1516],zn.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],zn.INSIDE_ODD_WIDEST=[2,4,6,8],zn.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class us extends Er{constructor(h,g){super(),this.readers=[],this.verbose=g===!0;const b=h?h.get(U.POSSIBLE_FORMATS):null,S=h&&h.get(U.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;b?((b.includes(ge.EAN_13)||b.includes(ge.UPC_A)||b.includes(ge.EAN_8)||b.includes(ge.UPC_E))&&this.readers.push(new Ia(h)),b.includes(ge.CODE_39)&&this.readers.push(new sr(S)),b.includes(ge.CODE_128)&&this.readers.push(new wt),b.includes(ge.ITF)&&this.readers.push(new ur),b.includes(ge.RSS_14)&&this.readers.push(new zn),b.includes(ge.RSS_EXPANDED)&&this.readers.push(new Rt(this.verbose))):(this.readers.push(new Ia(h)),this.readers.push(new sr),this.readers.push(new Ia(h)),this.readers.push(new wt),this.readers.push(new ur),this.readers.push(new zn),this.readers.push(new Rt(this.verbose)))}decodeRow(h,g,b){for(let S=0;S<this.readers.length;S++)try{return this.readers[S].decodeRow(h,g,b)}catch{}throw new le}reset(){this.readers.forEach(h=>h.reset())}}class kl extends se{constructor(h=500,g){super(new us(g),h,g)}}class _n{constructor(h,g,b){this.ecCodewords=h,this.ecBlocks=[g],b&&this.ecBlocks.push(b)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class An{constructor(h,g){this.count=h,this.dataCodewords=g}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class on{constructor(h,g,b,S,N,I){this.versionNumber=h,this.symbolSizeRows=g,this.symbolSizeColumns=b,this.dataRegionSizeRows=S,this.dataRegionSizeColumns=N,this.ecBlocks=I;let R=0;const H=I.getECCodewords(),ne=I.getECBlocks();for(let he of ne)R+=he.getCount()*(he.getDataCodewords()+H);this.totalCodewords=R}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(h,g){if((h&1)!==0||(g&1)!==0)throw new $;for(let b of on.VERSIONS)if(b.symbolSizeRows===h&&b.symbolSizeColumns===g)return b;throw new $}toString(){return""+this.versionNumber}static buildVersions(){return[new on(1,10,10,8,8,new _n(5,new An(1,3))),new on(2,12,12,10,10,new _n(7,new An(1,5))),new on(3,14,14,12,12,new _n(10,new An(1,8))),new on(4,16,16,14,14,new _n(12,new An(1,12))),new on(5,18,18,16,16,new _n(14,new An(1,18))),new on(6,20,20,18,18,new _n(18,new An(1,22))),new on(7,22,22,20,20,new _n(20,new An(1,30))),new on(8,24,24,22,22,new _n(24,new An(1,36))),new on(9,26,26,24,24,new _n(28,new An(1,44))),new on(10,32,32,14,14,new _n(36,new An(1,62))),new on(11,36,36,16,16,new _n(42,new An(1,86))),new on(12,40,40,18,18,new _n(48,new An(1,114))),new on(13,44,44,20,20,new _n(56,new An(1,144))),new on(14,48,48,22,22,new _n(68,new An(1,174))),new on(15,52,52,24,24,new _n(42,new An(2,102))),new on(16,64,64,14,14,new _n(56,new An(2,140))),new on(17,72,72,16,16,new _n(36,new An(4,92))),new on(18,80,80,18,18,new _n(48,new An(4,114))),new on(19,88,88,20,20,new _n(56,new An(4,144))),new on(20,96,96,22,22,new _n(68,new An(4,174))),new on(21,104,104,24,24,new _n(56,new An(6,136))),new on(22,120,120,18,18,new _n(68,new An(6,175))),new on(23,132,132,20,20,new _n(62,new An(8,163))),new on(24,144,144,22,22,new _n(62,new An(8,156),new An(2,155))),new on(25,8,18,6,16,new _n(7,new An(1,5))),new on(26,8,32,6,14,new _n(11,new An(1,10))),new on(27,12,26,10,24,new _n(14,new An(1,16))),new on(28,12,36,10,16,new _n(18,new An(1,22))),new on(29,16,36,14,16,new _n(24,new An(1,32))),new on(30,16,48,14,22,new _n(28,new An(1,49)))]}}on.VERSIONS=on.buildVersions();class Jr{constructor(h){const g=h.getHeight();if(g<8||g>144||(g&1)!==0)throw new $;this.version=Jr.readVersion(h),this.mappingBitMatrix=this.extractDataRegion(h),this.readMappingMatrix=new de(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(h){const g=h.getHeight(),b=h.getWidth();return on.getVersionForDimensions(g,b)}readCodewords(){const h=new Int8Array(this.version.getTotalCodewords());let g=0,b=4,S=0;const N=this.mappingBitMatrix.getHeight(),I=this.mappingBitMatrix.getWidth();let R=!1,H=!1,ne=!1,he=!1;do if(b===N&&S===0&&!R)h[g++]=this.readCorner1(N,I)&255,b-=2,S+=2,R=!0;else if(b===N-2&&S===0&&(I&3)!==0&&!H)h[g++]=this.readCorner2(N,I)&255,b-=2,S+=2,H=!0;else if(b===N+4&&S===2&&(I&7)===0&&!ne)h[g++]=this.readCorner3(N,I)&255,b-=2,S+=2,ne=!0;else if(b===N-2&&S===0&&(I&7)===4&&!he)h[g++]=this.readCorner4(N,I)&255,b-=2,S+=2,he=!0;else{do b<N&&S>=0&&!this.readMappingMatrix.get(S,b)&&(h[g++]=this.readUtah(b,S,N,I)&255),b-=2,S+=2;while(b>=0&&S<I);b+=1,S+=3;do b>=0&&S<I&&!this.readMappingMatrix.get(S,b)&&(h[g++]=this.readUtah(b,S,N,I)&255),b+=2,S-=2;while(b<N&&S>=0);b+=3,S+=1}while(b<N||S<I);if(g!==this.version.getTotalCodewords())throw new $;return h}readModule(h,g,b,S){return h<0&&(h+=b,g+=4-(b+4&7)),g<0&&(g+=S,h+=4-(S+4&7)),this.readMappingMatrix.set(g,h),this.mappingBitMatrix.get(g,h)}readUtah(h,g,b,S){let N=0;return this.readModule(h-2,g-2,b,S)&&(N|=1),N<<=1,this.readModule(h-2,g-1,b,S)&&(N|=1),N<<=1,this.readModule(h-1,g-2,b,S)&&(N|=1),N<<=1,this.readModule(h-1,g-1,b,S)&&(N|=1),N<<=1,this.readModule(h-1,g,b,S)&&(N|=1),N<<=1,this.readModule(h,g-2,b,S)&&(N|=1),N<<=1,this.readModule(h,g-1,b,S)&&(N|=1),N<<=1,this.readModule(h,g,b,S)&&(N|=1),N}readCorner1(h,g){let b=0;return this.readModule(h-1,0,h,g)&&(b|=1),b<<=1,this.readModule(h-1,1,h,g)&&(b|=1),b<<=1,this.readModule(h-1,2,h,g)&&(b|=1),b<<=1,this.readModule(0,g-2,h,g)&&(b|=1),b<<=1,this.readModule(0,g-1,h,g)&&(b|=1),b<<=1,this.readModule(1,g-1,h,g)&&(b|=1),b<<=1,this.readModule(2,g-1,h,g)&&(b|=1),b<<=1,this.readModule(3,g-1,h,g)&&(b|=1),b}readCorner2(h,g){let b=0;return this.readModule(h-3,0,h,g)&&(b|=1),b<<=1,this.readModule(h-2,0,h,g)&&(b|=1),b<<=1,this.readModule(h-1,0,h,g)&&(b|=1),b<<=1,this.readModule(0,g-4,h,g)&&(b|=1),b<<=1,this.readModule(0,g-3,h,g)&&(b|=1),b<<=1,this.readModule(0,g-2,h,g)&&(b|=1),b<<=1,this.readModule(0,g-1,h,g)&&(b|=1),b<<=1,this.readModule(1,g-1,h,g)&&(b|=1),b}readCorner3(h,g){let b=0;return this.readModule(h-1,0,h,g)&&(b|=1),b<<=1,this.readModule(h-1,g-1,h,g)&&(b|=1),b<<=1,this.readModule(0,g-3,h,g)&&(b|=1),b<<=1,this.readModule(0,g-2,h,g)&&(b|=1),b<<=1,this.readModule(0,g-1,h,g)&&(b|=1),b<<=1,this.readModule(1,g-3,h,g)&&(b|=1),b<<=1,this.readModule(1,g-2,h,g)&&(b|=1),b<<=1,this.readModule(1,g-1,h,g)&&(b|=1),b}readCorner4(h,g){let b=0;return this.readModule(h-3,0,h,g)&&(b|=1),b<<=1,this.readModule(h-2,0,h,g)&&(b|=1),b<<=1,this.readModule(h-1,0,h,g)&&(b|=1),b<<=1,this.readModule(0,g-2,h,g)&&(b|=1),b<<=1,this.readModule(0,g-1,h,g)&&(b|=1),b<<=1,this.readModule(1,g-1,h,g)&&(b|=1),b<<=1,this.readModule(2,g-1,h,g)&&(b|=1),b<<=1,this.readModule(3,g-1,h,g)&&(b|=1),b}extractDataRegion(h){const g=this.version.getSymbolSizeRows(),b=this.version.getSymbolSizeColumns();if(h.getHeight()!==g)throw new p("Dimension of bitMatrix must match the version size");const S=this.version.getDataRegionSizeRows(),N=this.version.getDataRegionSizeColumns(),I=g/S|0,R=b/N|0,H=I*S,ne=R*N,he=new de(ne,H);for(let ve=0;ve<I;++ve){const Ne=ve*S;for(let Me=0;Me<R;++Me){const qe=Me*N;for(let $e=0;$e<S;++$e){const Xe=ve*(S+2)+1+$e,ct=Ne+$e;for(let Tt=0;Tt<N;++Tt){const _t=Me*(N+2)+1+Tt;if(h.get(_t,Xe)){const At=qe+Tt;he.set(At,ct)}}}}}return he}}class Rn{constructor(h,g){this.numDataCodewords=h,this.codewords=g}static getDataBlocks(h,g){const b=g.getECBlocks();let S=0;const N=b.getECBlocks();for(let $e of N)S+=$e.getCount();const I=new Array(S);let R=0;for(let $e of N)for(let Xe=0;Xe<$e.getCount();Xe++){const ct=$e.getDataCodewords(),Tt=b.getECCodewords()+ct;I[R++]=new Rn(ct,new Uint8Array(Tt))}const ne=I[0].codewords.length-b.getECCodewords(),he=ne-1;let ve=0;for(let $e=0;$e<he;$e++)for(let Xe=0;Xe<R;Xe++)I[Xe].codewords[$e]=h[ve++];const Ne=g.getVersionNumber()===24,Me=Ne?8:R;for(let $e=0;$e<Me;$e++)I[$e].codewords[ne-1]=h[ve++];const qe=I[0].codewords.length;for(let $e=ne;$e<qe;$e++)for(let Xe=0;Xe<R;Xe++){const ct=Ne?(Xe+8)%R:Xe,Tt=Ne&&ct>7?$e-1:$e;I[ct].codewords[Tt]=h[ve++]}if(ve!==h.length)throw new p;return I}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class hs{constructor(h){this.bytes=h,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(h){if(h<1||h>32||h>this.available())throw new p(""+h);let g=0,b=this.bitOffset,S=this.byteOffset;const N=this.bytes;if(b>0){const I=8-b,R=h<I?h:I,H=I-R,ne=255>>8-R<<H;g=(N[S]&ne)>>H,h-=R,b+=R,b===8&&(b=0,S++)}if(h>0){for(;h>=8;)g=g<<8|N[S]&255,S++,h-=8;if(h>0){const I=8-h,R=255>>I<<I;g=g<<h|(N[S]&R)>>I,b+=h}}return this.bitOffset=b,this.byteOffset=S,g}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Mr;(function(je){je[je.PAD_ENCODE=0]="PAD_ENCODE",je[je.ASCII_ENCODE=1]="ASCII_ENCODE",je[je.C40_ENCODE=2]="C40_ENCODE",je[je.TEXT_ENCODE=3]="TEXT_ENCODE",je[je.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",je[je.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",je[je.BASE256_ENCODE=6]="BASE256_ENCODE"})(Mr||(Mr={}));class Qa{static decode(h){const g=new hs(h),b=new re,S=new re,N=new Array;let I=Mr.ASCII_ENCODE;do if(I===Mr.ASCII_ENCODE)I=this.decodeAsciiSegment(g,b,S);else{switch(I){case Mr.C40_ENCODE:this.decodeC40Segment(g,b);break;case Mr.TEXT_ENCODE:this.decodeTextSegment(g,b);break;case Mr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(g,b);break;case Mr.EDIFACT_ENCODE:this.decodeEdifactSegment(g,b);break;case Mr.BASE256_ENCODE:this.decodeBase256Segment(g,b,N);break;default:throw new $}I=Mr.ASCII_ENCODE}while(I!==Mr.PAD_ENCODE&&g.available()>0);return S.length()>0&&b.append(S.toString()),new ke(h,b.toString(),N.length===0?null:N,null)}static decodeAsciiSegment(h,g,b){let S=!1;do{let N=h.readBits(8);if(N===0)throw new $;if(N<=128)return S&&(N+=128),g.append(String.fromCharCode(N-1)),Mr.ASCII_ENCODE;if(N===129)return Mr.PAD_ENCODE;if(N<=229){const I=N-130;I<10&&g.append("0"),g.append(""+I)}else switch(N){case 230:return Mr.C40_ENCODE;case 231:return Mr.BASE256_ENCODE;case 232:g.append("");break;case 233:case 234:break;case 235:S=!0;break;case 236:g.append("[)>05"),b.insert(0,"");break;case 237:g.append("[)>06"),b.insert(0,"");break;case 238:return Mr.ANSIX12_ENCODE;case 239:return Mr.TEXT_ENCODE;case 240:return Mr.EDIFACT_ENCODE;case 241:break;default:if(N!==254||h.available()!==0)throw new $;break}}while(h.available()>0);return Mr.ASCII_ENCODE}static decodeC40Segment(h,g){let b=!1;const S=[];let N=0;do{if(h.available()===8)return;const I=h.readBits(8);if(I===254)return;this.parseTwoBytes(I,h.readBits(8),S);for(let R=0;R<3;R++){const H=S[R];switch(N){case 0:if(H<3)N=H+1;else if(H<this.C40_BASIC_SET_CHARS.length){const ne=this.C40_BASIC_SET_CHARS[H];b?(g.append(String.fromCharCode(ne.charCodeAt(0)+128)),b=!1):g.append(ne)}else throw new $;break;case 1:b?(g.append(String.fromCharCode(H+128)),b=!1):g.append(String.fromCharCode(H)),N=0;break;case 2:if(H<this.C40_SHIFT2_SET_CHARS.length){const ne=this.C40_SHIFT2_SET_CHARS[H];b?(g.append(String.fromCharCode(ne.charCodeAt(0)+128)),b=!1):g.append(ne)}else switch(H){case 27:g.append("");break;case 30:b=!0;break;default:throw new $}N=0;break;case 3:b?(g.append(String.fromCharCode(H+224)),b=!1):g.append(String.fromCharCode(H+96)),N=0;break;default:throw new $}}}while(h.available()>0)}static decodeTextSegment(h,g){let b=!1,S=[],N=0;do{if(h.available()===8)return;const I=h.readBits(8);if(I===254)return;this.parseTwoBytes(I,h.readBits(8),S);for(let R=0;R<3;R++){const H=S[R];switch(N){case 0:if(H<3)N=H+1;else if(H<this.TEXT_BASIC_SET_CHARS.length){const ne=this.TEXT_BASIC_SET_CHARS[H];b?(g.append(String.fromCharCode(ne.charCodeAt(0)+128)),b=!1):g.append(ne)}else throw new $;break;case 1:b?(g.append(String.fromCharCode(H+128)),b=!1):g.append(String.fromCharCode(H)),N=0;break;case 2:if(H<this.TEXT_SHIFT2_SET_CHARS.length){const ne=this.TEXT_SHIFT2_SET_CHARS[H];b?(g.append(String.fromCharCode(ne.charCodeAt(0)+128)),b=!1):g.append(ne)}else switch(H){case 27:g.append("");break;case 30:b=!0;break;default:throw new $}N=0;break;case 3:if(H<this.TEXT_SHIFT3_SET_CHARS.length){const ne=this.TEXT_SHIFT3_SET_CHARS[H];b?(g.append(String.fromCharCode(ne.charCodeAt(0)+128)),b=!1):g.append(ne),N=0}else throw new $;break;default:throw new $}}}while(h.available()>0)}static decodeAnsiX12Segment(h,g){const b=[];do{if(h.available()===8)return;const S=h.readBits(8);if(S===254)return;this.parseTwoBytes(S,h.readBits(8),b);for(let N=0;N<3;N++){const I=b[N];switch(I){case 0:g.append("\r");break;case 1:g.append("*");break;case 2:g.append(">");break;case 3:g.append(" ");break;default:if(I<14)g.append(String.fromCharCode(I+44));else if(I<40)g.append(String.fromCharCode(I+51));else throw new $;break}}}while(h.available()>0)}static parseTwoBytes(h,g,b){let S=(h<<8)+g-1,N=Math.floor(S/1600);b[0]=N,S-=N*1600,N=Math.floor(S/40),b[1]=N,b[2]=S-N*40}static decodeEdifactSegment(h,g){do{if(h.available()<=16)return;for(let b=0;b<4;b++){let S=h.readBits(6);if(S===31){const N=8-h.getBitOffset();N!==8&&h.readBits(N);return}(S&32)===0&&(S|=64),g.append(String.fromCharCode(S))}}while(h.available()>0)}static decodeBase256Segment(h,g,b){let S=1+h.getByteOffset();const N=this.unrandomize255State(h.readBits(8),S++);let I;if(N===0?I=h.available()/8|0:N<250?I=N:I=250*(N-249)+this.unrandomize255State(h.readBits(8),S++),I<0)throw new $;const R=new Uint8Array(I);for(let H=0;H<I;H++){if(h.available()<8)throw new $;R[H]=this.unrandomize255State(h.readBits(8),S++)}b.push(R);try{g.append(J.decode(R,Z.ISO88591))}catch(H){throw new Oe("Platform does not support required encoding: "+H.message)}}static unrandomize255State(h,g){const b=149*g%255+1,S=h-b;return S>=0?S:S+256}}Qa.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Qa.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Qa.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Qa.TEXT_SHIFT2_SET_CHARS=Qa.C40_SHIFT2_SET_CHARS,Qa.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class No{constructor(){this.rsDecoder=new st(vt.DATA_MATRIX_FIELD_256)}decode(h){const g=new Jr(h),b=g.getVersion(),S=g.readCodewords(),N=Rn.getDataBlocks(S,b);let I=0;for(let ne of N)I+=ne.getNumDataCodewords();const R=new Uint8Array(I),H=N.length;for(let ne=0;ne<H;ne++){const he=N[ne],ve=he.getCodewords(),Ne=he.getNumDataCodewords();this.correctErrors(ve,Ne);for(let Me=0;Me<Ne;Me++)R[Me*H+ne]=ve[Me]}return Qa.decode(R)}correctErrors(h,g){const b=new Int32Array(h);try{this.rsDecoder.decode(b,h.length-g)}catch{throw new v}for(let S=0;S<g;S++)h[S]=b[S]}}class ir{constructor(h){this.image=h,this.rectangleDetector=new zr(this.image)}detect(){const h=this.rectangleDetector.detect();let g=this.detectSolid1(h);if(g=this.detectSolid2(g),g[3]=this.correctTopRight(g),!g[3])throw new le;g=this.shiftToModuleCenter(g);const b=g[0],S=g[1],N=g[2],I=g[3];let R=this.transitionsBetween(b,I)+1,H=this.transitionsBetween(N,I)+1;(R&1)===1&&(R+=1),(H&1)===1&&(H+=1),4*R<7*H&&4*H<7*R&&(R=H=Math.max(R,H));let ne=ir.sampleGrid(this.image,b,S,N,I,R,H);return new xr(ne,[b,S,N,I])}static shiftPoint(h,g,b){let S=(g.getX()-h.getX())/(b+1),N=(g.getY()-h.getY())/(b+1);return new St(h.getX()+S,h.getY()+N)}static moveAway(h,g,b){let S=h.getX(),N=h.getY();return S<g?S-=1:S+=1,N<b?N-=1:N+=1,new St(S,N)}detectSolid1(h){let g=h[0],b=h[1],S=h[3],N=h[2],I=this.transitionsBetween(g,b),R=this.transitionsBetween(b,S),H=this.transitionsBetween(S,N),ne=this.transitionsBetween(N,g),he=I,ve=[N,g,b,S];return he>R&&(he=R,ve[0]=g,ve[1]=b,ve[2]=S,ve[3]=N),he>H&&(he=H,ve[0]=b,ve[1]=S,ve[2]=N,ve[3]=g),he>ne&&(ve[0]=S,ve[1]=N,ve[2]=g,ve[3]=b),ve}detectSolid2(h){let g=h[0],b=h[1],S=h[2],N=h[3],I=this.transitionsBetween(g,N),R=ir.shiftPoint(b,S,(I+1)*4),H=ir.shiftPoint(S,b,(I+1)*4),ne=this.transitionsBetween(R,g),he=this.transitionsBetween(H,N);return ne<he?(h[0]=g,h[1]=b,h[2]=S,h[3]=N):(h[0]=b,h[1]=S,h[2]=N,h[3]=g),h}correctTopRight(h){let g=h[0],b=h[1],S=h[2],N=h[3],I=this.transitionsBetween(g,N),R=this.transitionsBetween(b,N),H=ir.shiftPoint(g,b,(R+1)*4),ne=ir.shiftPoint(S,b,(I+1)*4);I=this.transitionsBetween(H,N),R=this.transitionsBetween(ne,N);let he=new St(N.getX()+(S.getX()-b.getX())/(I+1),N.getY()+(S.getY()-b.getY())/(I+1)),ve=new St(N.getX()+(g.getX()-b.getX())/(R+1),N.getY()+(g.getY()-b.getY())/(R+1));if(!this.isValid(he))return this.isValid(ve)?ve:null;if(!this.isValid(ve))return he;let Ne=this.transitionsBetween(H,he)+this.transitionsBetween(ne,he),Me=this.transitionsBetween(H,ve)+this.transitionsBetween(ne,ve);return Ne>Me?he:ve}shiftToModuleCenter(h){let g=h[0],b=h[1],S=h[2],N=h[3],I=this.transitionsBetween(g,N)+1,R=this.transitionsBetween(S,N)+1,H=ir.shiftPoint(g,b,R*4),ne=ir.shiftPoint(S,b,I*4);I=this.transitionsBetween(H,N)+1,R=this.transitionsBetween(ne,N)+1,(I&1)===1&&(I+=1),(R&1)===1&&(R+=1);let he=(g.getX()+b.getX()+S.getX()+N.getX())/4,ve=(g.getY()+b.getY()+S.getY()+N.getY())/4;g=ir.moveAway(g,he,ve),b=ir.moveAway(b,he,ve),S=ir.moveAway(S,he,ve),N=ir.moveAway(N,he,ve);let Ne,Me;return H=ir.shiftPoint(g,b,R*4),H=ir.shiftPoint(H,N,I*4),Ne=ir.shiftPoint(b,g,R*4),Ne=ir.shiftPoint(Ne,S,I*4),ne=ir.shiftPoint(S,N,R*4),ne=ir.shiftPoint(ne,b,I*4),Me=ir.shiftPoint(N,S,R*4),Me=ir.shiftPoint(Me,g,I*4),[H,Ne,ne,Me]}isValid(h){return h.getX()>=0&&h.getX()<this.image.getWidth()&&h.getY()>0&&h.getY()<this.image.getHeight()}static sampleGrid(h,g,b,S,N,I,R){return Yr.getInstance().sampleGrid(h,I,R,.5,.5,I-.5,.5,I-.5,R-.5,.5,R-.5,g.getX(),g.getY(),N.getX(),N.getY(),S.getX(),S.getY(),b.getX(),b.getY())}transitionsBetween(h,g){let b=Math.trunc(h.getX()),S=Math.trunc(h.getY()),N=Math.trunc(g.getX()),I=Math.trunc(g.getY()),R=Math.abs(I-S)>Math.abs(N-b);if(R){let $e=b;b=S,S=$e,$e=N,N=I,I=$e}let H=Math.abs(N-b),ne=Math.abs(I-S),he=-H/2,ve=S<I?1:-1,Ne=b<N?1:-1,Me=0,qe=this.image.get(R?S:b,R?b:S);for(let $e=b,Xe=S;$e!==N;$e+=Ne){let ct=this.image.get(R?Xe:$e,R?$e:Xe);if(ct!==qe&&(Me++,qe=ct),he+=ne,he>0){if(Xe===I)break;Xe+=ve,he-=H}}return Me}}class Bn{constructor(){this.decoder=new No}decode(h,g=null){let b,S;if(g!=null&&g.has(U.PURE_BARCODE)){const ne=Bn.extractPureBits(h.getBlackMatrix());b=this.decoder.decode(ne),S=Bn.NO_POINTS}else{const ne=new ir(h.getBlackMatrix()).detect();b=this.decoder.decode(ne.getBits()),S=ne.getPoints()}const N=b.getRawBytes(),I=new W(b.getText(),N,8*N.length,S,ge.DATA_MATRIX,C.currentTimeMillis()),R=b.getByteSegments();R!=null&&I.putMetadata(Le.BYTE_SEGMENTS,R);const H=b.getECLevel();return H!=null&&I.putMetadata(Le.ERROR_CORRECTION_LEVEL,H),I}reset(){}static extractPureBits(h){const g=h.getTopLeftOnBit(),b=h.getBottomRightOnBit();if(g==null||b==null)throw new le;const S=this.moduleSize(g,h);let N=g[1];const I=b[1];let R=g[0];const ne=(b[0]-R+1)/S,he=(I-N+1)/S;if(ne<=0||he<=0)throw new le;const ve=S/2;N+=ve,R+=ve;const Ne=new de(ne,he);for(let Me=0;Me<he;Me++){const qe=N+Me*S;for(let $e=0;$e<ne;$e++)h.get(R+$e*S,qe)&&Ne.set($e,Me)}return Ne}static moduleSize(h,g){const b=g.getWidth();let S=h[0];const N=h[1];for(;S<b&&g.get(S,N);)S++;if(S===b)throw new le;const I=S-h[0];if(I===0)throw new le;return I}}Bn.NO_POINTS=[];class Ya extends se{constructor(h=500){super(new Bn,h)}}var di;(function(je){je[je.L=0]="L",je[je.M=1]="M",je[je.Q=2]="Q",je[je.H=3]="H"})(di||(di={}));class kr{constructor(h,g,b){this.value=h,this.stringValue=g,this.bits=b,kr.FOR_BITS.set(b,this),kr.FOR_VALUE.set(h,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(h){switch(h){case"L":return kr.L;case"M":return kr.M;case"Q":return kr.Q;case"H":return kr.H;default:throw new f(h+"not available")}}toString(){return this.stringValue}equals(h){if(!(h instanceof kr))return!1;const g=h;return this.value===g.value}static forBits(h){if(h<0||h>=kr.FOR_BITS.size)throw new p;return kr.FOR_BITS.get(h)}}kr.FOR_BITS=new Map,kr.FOR_VALUE=new Map,kr.L=new kr(di.L,"L",1),kr.M=new kr(di.M,"M",0),kr.Q=new kr(di.Q,"Q",3),kr.H=new kr(di.H,"H",2);class ea{constructor(h){this.errorCorrectionLevel=kr.forBits(h>>3&3),this.dataMask=h&7}static numBitsDiffering(h,g){return D.bitCount(h^g)}static decodeFormatInformation(h,g){const b=ea.doDecodeFormatInformation(h,g);return b!==null?b:ea.doDecodeFormatInformation(h^ea.FORMAT_INFO_MASK_QR,g^ea.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(h,g){let b=Number.MAX_SAFE_INTEGER,S=0;for(const N of ea.FORMAT_INFO_DECODE_LOOKUP){const I=N[0];if(I===h||I===g)return new ea(N[1]);let R=ea.numBitsDiffering(h,I);R<b&&(S=N[1],b=R),h!==g&&(R=ea.numBitsDiffering(g,I),R<b&&(S=N[1],b=R))}return b<=3?new ea(S):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(h){if(!(h instanceof ea))return!1;const g=h;return this.errorCorrectionLevel===g.errorCorrectionLevel&&this.dataMask===g.dataMask}}ea.FORMAT_INFO_MASK_QR=21522,ea.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class it{constructor(h,...g){this.ecCodewordsPerBlock=h,this.ecBlocks=g}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let h=0;const g=this.ecBlocks;for(const b of g)h+=b.getCount();return h}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Pe{constructor(h,g){this.count=h,this.dataCodewords=g}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ht{constructor(h,g,...b){this.versionNumber=h,this.alignmentPatternCenters=g,this.ecBlocks=b;let S=0;const N=b[0].getECCodewordsPerBlock(),I=b[0].getECBlocks();for(const R of I)S+=R.getCount()*(R.getDataCodewords()+N);this.totalCodewords=S}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(h){return this.ecBlocks[h.getValue()]}static getProvisionalVersionForDimension(h){if(h%4!==1)throw new $;try{return this.getVersionForNumber((h-17)/4)}catch{throw new $}}static getVersionForNumber(h){if(h<1||h>40)throw new p;return Ht.VERSIONS[h-1]}static decodeVersionInformation(h){let g=Number.MAX_SAFE_INTEGER,b=0;for(let S=0;S<Ht.VERSION_DECODE_INFO.length;S++){const N=Ht.VERSION_DECODE_INFO[S];if(N===h)return Ht.getVersionForNumber(S+7);const I=ea.numBitsDiffering(h,N);I<g&&(b=S+7,g=I)}return g<=3?Ht.getVersionForNumber(b):null}buildFunctionPattern(){const h=this.getDimensionForVersion(),g=new de(h);g.setRegion(0,0,9,9),g.setRegion(h-8,0,8,9),g.setRegion(0,h-8,9,8);const b=this.alignmentPatternCenters.length;for(let S=0;S<b;S++){const N=this.alignmentPatternCenters[S]-2;for(let I=0;I<b;I++)S===0&&(I===0||I===b-1)||S===b-1&&I===0||g.setRegion(this.alignmentPatternCenters[I]-2,N,5,5)}return g.setRegion(6,9,1,h-17),g.setRegion(9,6,h-17,1),this.versionNumber>6&&(g.setRegion(h-11,0,3,6),g.setRegion(0,h-11,6,3)),g}toString(){return""+this.versionNumber}}Ht.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ht.VERSIONS=[new Ht(1,new Int32Array(0),new it(7,new Pe(1,19)),new it(10,new Pe(1,16)),new it(13,new Pe(1,13)),new it(17,new Pe(1,9))),new Ht(2,Int32Array.from([6,18]),new it(10,new Pe(1,34)),new it(16,new Pe(1,28)),new it(22,new Pe(1,22)),new it(28,new Pe(1,16))),new Ht(3,Int32Array.from([6,22]),new it(15,new Pe(1,55)),new it(26,new Pe(1,44)),new it(18,new Pe(2,17)),new it(22,new Pe(2,13))),new Ht(4,Int32Array.from([6,26]),new it(20,new Pe(1,80)),new it(18,new Pe(2,32)),new it(26,new Pe(2,24)),new it(16,new Pe(4,9))),new Ht(5,Int32Array.from([6,30]),new it(26,new Pe(1,108)),new it(24,new Pe(2,43)),new it(18,new Pe(2,15),new Pe(2,16)),new it(22,new Pe(2,11),new Pe(2,12))),new Ht(6,Int32Array.from([6,34]),new it(18,new Pe(2,68)),new it(16,new Pe(4,27)),new it(24,new Pe(4,19)),new it(28,new Pe(4,15))),new Ht(7,Int32Array.from([6,22,38]),new it(20,new Pe(2,78)),new it(18,new Pe(4,31)),new it(18,new Pe(2,14),new Pe(4,15)),new it(26,new Pe(4,13),new Pe(1,14))),new Ht(8,Int32Array.from([6,24,42]),new it(24,new Pe(2,97)),new it(22,new Pe(2,38),new Pe(2,39)),new it(22,new Pe(4,18),new Pe(2,19)),new it(26,new Pe(4,14),new Pe(2,15))),new Ht(9,Int32Array.from([6,26,46]),new it(30,new Pe(2,116)),new it(22,new Pe(3,36),new Pe(2,37)),new it(20,new Pe(4,16),new Pe(4,17)),new it(24,new Pe(4,12),new Pe(4,13))),new Ht(10,Int32Array.from([6,28,50]),new it(18,new Pe(2,68),new Pe(2,69)),new it(26,new Pe(4,43),new Pe(1,44)),new it(24,new Pe(6,19),new Pe(2,20)),new it(28,new Pe(6,15),new Pe(2,16))),new Ht(11,Int32Array.from([6,30,54]),new it(20,new Pe(4,81)),new it(30,new Pe(1,50),new Pe(4,51)),new it(28,new Pe(4,22),new Pe(4,23)),new it(24,new Pe(3,12),new Pe(8,13))),new Ht(12,Int32Array.from([6,32,58]),new it(24,new Pe(2,92),new Pe(2,93)),new it(22,new Pe(6,36),new Pe(2,37)),new it(26,new Pe(4,20),new Pe(6,21)),new it(28,new Pe(7,14),new Pe(4,15))),new Ht(13,Int32Array.from([6,34,62]),new it(26,new Pe(4,107)),new it(22,new Pe(8,37),new Pe(1,38)),new it(24,new Pe(8,20),new Pe(4,21)),new it(22,new Pe(12,11),new Pe(4,12))),new Ht(14,Int32Array.from([6,26,46,66]),new it(30,new Pe(3,115),new Pe(1,116)),new it(24,new Pe(4,40),new Pe(5,41)),new it(20,new Pe(11,16),new Pe(5,17)),new it(24,new Pe(11,12),new Pe(5,13))),new Ht(15,Int32Array.from([6,26,48,70]),new it(22,new Pe(5,87),new Pe(1,88)),new it(24,new Pe(5,41),new Pe(5,42)),new it(30,new Pe(5,24),new Pe(7,25)),new it(24,new Pe(11,12),new Pe(7,13))),new Ht(16,Int32Array.from([6,26,50,74]),new it(24,new Pe(5,98),new Pe(1,99)),new it(28,new Pe(7,45),new Pe(3,46)),new it(24,new Pe(15,19),new Pe(2,20)),new it(30,new Pe(3,15),new Pe(13,16))),new Ht(17,Int32Array.from([6,30,54,78]),new it(28,new Pe(1,107),new Pe(5,108)),new it(28,new Pe(10,46),new Pe(1,47)),new it(28,new Pe(1,22),new Pe(15,23)),new it(28,new Pe(2,14),new Pe(17,15))),new Ht(18,Int32Array.from([6,30,56,82]),new it(30,new Pe(5,120),new Pe(1,121)),new it(26,new Pe(9,43),new Pe(4,44)),new it(28,new Pe(17,22),new Pe(1,23)),new it(28,new Pe(2,14),new Pe(19,15))),new Ht(19,Int32Array.from([6,30,58,86]),new it(28,new Pe(3,113),new Pe(4,114)),new it(26,new Pe(3,44),new Pe(11,45)),new it(26,new Pe(17,21),new Pe(4,22)),new it(26,new Pe(9,13),new Pe(16,14))),new Ht(20,Int32Array.from([6,34,62,90]),new it(28,new Pe(3,107),new Pe(5,108)),new it(26,new Pe(3,41),new Pe(13,42)),new it(30,new Pe(15,24),new Pe(5,25)),new it(28,new Pe(15,15),new Pe(10,16))),new Ht(21,Int32Array.from([6,28,50,72,94]),new it(28,new Pe(4,116),new Pe(4,117)),new it(26,new Pe(17,42)),new it(28,new Pe(17,22),new Pe(6,23)),new it(30,new Pe(19,16),new Pe(6,17))),new Ht(22,Int32Array.from([6,26,50,74,98]),new it(28,new Pe(2,111),new Pe(7,112)),new it(28,new Pe(17,46)),new it(30,new Pe(7,24),new Pe(16,25)),new it(24,new Pe(34,13))),new Ht(23,Int32Array.from([6,30,54,78,102]),new it(30,new Pe(4,121),new Pe(5,122)),new it(28,new Pe(4,47),new Pe(14,48)),new it(30,new Pe(11,24),new Pe(14,25)),new it(30,new Pe(16,15),new Pe(14,16))),new Ht(24,Int32Array.from([6,28,54,80,106]),new it(30,new Pe(6,117),new Pe(4,118)),new it(28,new Pe(6,45),new Pe(14,46)),new it(30,new Pe(11,24),new Pe(16,25)),new it(30,new Pe(30,16),new Pe(2,17))),new Ht(25,Int32Array.from([6,32,58,84,110]),new it(26,new Pe(8,106),new Pe(4,107)),new it(28,new Pe(8,47),new Pe(13,48)),new it(30,new Pe(7,24),new Pe(22,25)),new it(30,new Pe(22,15),new Pe(13,16))),new Ht(26,Int32Array.from([6,30,58,86,114]),new it(28,new Pe(10,114),new Pe(2,115)),new it(28,new Pe(19,46),new Pe(4,47)),new it(28,new Pe(28,22),new Pe(6,23)),new it(30,new Pe(33,16),new Pe(4,17))),new Ht(27,Int32Array.from([6,34,62,90,118]),new it(30,new Pe(8,122),new Pe(4,123)),new it(28,new Pe(22,45),new Pe(3,46)),new it(30,new Pe(8,23),new Pe(26,24)),new it(30,new Pe(12,15),new Pe(28,16))),new Ht(28,Int32Array.from([6,26,50,74,98,122]),new it(30,new Pe(3,117),new Pe(10,118)),new it(28,new Pe(3,45),new Pe(23,46)),new it(30,new Pe(4,24),new Pe(31,25)),new it(30,new Pe(11,15),new Pe(31,16))),new Ht(29,Int32Array.from([6,30,54,78,102,126]),new it(30,new Pe(7,116),new Pe(7,117)),new it(28,new Pe(21,45),new Pe(7,46)),new it(30,new Pe(1,23),new Pe(37,24)),new it(30,new Pe(19,15),new Pe(26,16))),new Ht(30,Int32Array.from([6,26,52,78,104,130]),new it(30,new Pe(5,115),new Pe(10,116)),new it(28,new Pe(19,47),new Pe(10,48)),new it(30,new Pe(15,24),new Pe(25,25)),new it(30,new Pe(23,15),new Pe(25,16))),new Ht(31,Int32Array.from([6,30,56,82,108,134]),new it(30,new Pe(13,115),new Pe(3,116)),new it(28,new Pe(2,46),new Pe(29,47)),new it(30,new Pe(42,24),new Pe(1,25)),new it(30,new Pe(23,15),new Pe(28,16))),new Ht(32,Int32Array.from([6,34,60,86,112,138]),new it(30,new Pe(17,115)),new it(28,new Pe(10,46),new Pe(23,47)),new it(30,new Pe(10,24),new Pe(35,25)),new it(30,new Pe(19,15),new Pe(35,16))),new Ht(33,Int32Array.from([6,30,58,86,114,142]),new it(30,new Pe(17,115),new Pe(1,116)),new it(28,new Pe(14,46),new Pe(21,47)),new it(30,new Pe(29,24),new Pe(19,25)),new it(30,new Pe(11,15),new Pe(46,16))),new Ht(34,Int32Array.from([6,34,62,90,118,146]),new it(30,new Pe(13,115),new Pe(6,116)),new it(28,new Pe(14,46),new Pe(23,47)),new it(30,new Pe(44,24),new Pe(7,25)),new it(30,new Pe(59,16),new Pe(1,17))),new Ht(35,Int32Array.from([6,30,54,78,102,126,150]),new it(30,new Pe(12,121),new Pe(7,122)),new it(28,new Pe(12,47),new Pe(26,48)),new it(30,new Pe(39,24),new Pe(14,25)),new it(30,new Pe(22,15),new Pe(41,16))),new Ht(36,Int32Array.from([6,24,50,76,102,128,154]),new it(30,new Pe(6,121),new Pe(14,122)),new it(28,new Pe(6,47),new Pe(34,48)),new it(30,new Pe(46,24),new Pe(10,25)),new it(30,new Pe(2,15),new Pe(64,16))),new Ht(37,Int32Array.from([6,28,54,80,106,132,158]),new it(30,new Pe(17,122),new Pe(4,123)),new it(28,new Pe(29,46),new Pe(14,47)),new it(30,new Pe(49,24),new Pe(10,25)),new it(30,new Pe(24,15),new Pe(46,16))),new Ht(38,Int32Array.from([6,32,58,84,110,136,162]),new it(30,new Pe(4,122),new Pe(18,123)),new it(28,new Pe(13,46),new Pe(32,47)),new it(30,new Pe(48,24),new Pe(14,25)),new it(30,new Pe(42,15),new Pe(32,16))),new Ht(39,Int32Array.from([6,26,54,82,110,138,166]),new it(30,new Pe(20,117),new Pe(4,118)),new it(28,new Pe(40,47),new Pe(7,48)),new it(30,new Pe(43,24),new Pe(22,25)),new it(30,new Pe(10,15),new Pe(67,16))),new Ht(40,Int32Array.from([6,30,58,86,114,142,170]),new it(30,new Pe(19,118),new Pe(6,119)),new it(28,new Pe(18,47),new Pe(31,48)),new it(30,new Pe(34,24),new Pe(34,25)),new it(30,new Pe(20,15),new Pe(61,16)))];var ni;(function(je){je[je.DATA_MASK_000=0]="DATA_MASK_000",je[je.DATA_MASK_001=1]="DATA_MASK_001",je[je.DATA_MASK_010=2]="DATA_MASK_010",je[je.DATA_MASK_011=3]="DATA_MASK_011",je[je.DATA_MASK_100=4]="DATA_MASK_100",je[je.DATA_MASK_101=5]="DATA_MASK_101",je[je.DATA_MASK_110=6]="DATA_MASK_110",je[je.DATA_MASK_111=7]="DATA_MASK_111"})(ni||(ni={}));class la{constructor(h,g){this.value=h,this.isMasked=g}unmaskBitMatrix(h,g){for(let b=0;b<g;b++)for(let S=0;S<g;S++)this.isMasked(b,S)&&h.flip(S,b)}}la.values=new Map([[ni.DATA_MASK_000,new la(ni.DATA_MASK_000,(je,h)=>(je+h&1)===0)],[ni.DATA_MASK_001,new la(ni.DATA_MASK_001,(je,h)=>(je&1)===0)],[ni.DATA_MASK_010,new la(ni.DATA_MASK_010,(je,h)=>h%3===0)],[ni.DATA_MASK_011,new la(ni.DATA_MASK_011,(je,h)=>(je+h)%3===0)],[ni.DATA_MASK_100,new la(ni.DATA_MASK_100,(je,h)=>(Math.floor(je/2)+Math.floor(h/3)&1)===0)],[ni.DATA_MASK_101,new la(ni.DATA_MASK_101,(je,h)=>je*h%6===0)],[ni.DATA_MASK_110,new la(ni.DATA_MASK_110,(je,h)=>je*h%6<3)],[ni.DATA_MASK_111,new la(ni.DATA_MASK_111,(je,h)=>(je+h+je*h%3&1)===0)]]);class Ps{constructor(h){const g=h.getHeight();if(g<21||(g&3)!==1)throw new $;this.bitMatrix=h}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let h=0;for(let N=0;N<6;N++)h=this.copyBit(N,8,h);h=this.copyBit(7,8,h),h=this.copyBit(8,8,h),h=this.copyBit(8,7,h);for(let N=5;N>=0;N--)h=this.copyBit(8,N,h);const g=this.bitMatrix.getHeight();let b=0;const S=g-7;for(let N=g-1;N>=S;N--)b=this.copyBit(8,N,b);for(let N=g-8;N<g;N++)b=this.copyBit(N,8,b);if(this.parsedFormatInfo=ea.decodeFormatInformation(h,b),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new $}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const h=this.bitMatrix.getHeight(),g=Math.floor((h-17)/4);if(g<=6)return Ht.getVersionForNumber(g);let b=0;const S=h-11;for(let I=5;I>=0;I--)for(let R=h-9;R>=S;R--)b=this.copyBit(R,I,b);let N=Ht.decodeVersionInformation(b);if(N!==null&&N.getDimensionForVersion()===h)return this.parsedVersion=N,N;b=0;for(let I=5;I>=0;I--)for(let R=h-9;R>=S;R--)b=this.copyBit(I,R,b);if(N=Ht.decodeVersionInformation(b),N!==null&&N.getDimensionForVersion()===h)return this.parsedVersion=N,N;throw new $}copyBit(h,g,b){return(this.isMirror?this.bitMatrix.get(g,h):this.bitMatrix.get(h,g))?b<<1|1:b<<1}readCodewords(){const h=this.readFormatInformation(),g=this.readVersion(),b=la.values.get(h.getDataMask()),S=this.bitMatrix.getHeight();b.unmaskBitMatrix(this.bitMatrix,S);const N=g.buildFunctionPattern();let I=!0;const R=new Uint8Array(g.getTotalCodewords());let H=0,ne=0,he=0;for(let ve=S-1;ve>0;ve-=2){ve===6&&ve--;for(let Ne=0;Ne<S;Ne++){const Me=I?S-1-Ne:Ne;for(let qe=0;qe<2;qe++)N.get(ve-qe,Me)||(he++,ne<<=1,this.bitMatrix.get(ve-qe,Me)&&(ne|=1),he===8&&(R[H++]=ne,he=0,ne=0))}I=!I}if(H!==g.getTotalCodewords())throw new $;return R}remask(){if(this.parsedFormatInfo===null)return;const h=la.values[this.parsedFormatInfo.getDataMask()],g=this.bitMatrix.getHeight();h.unmaskBitMatrix(this.bitMatrix,g)}setMirror(h){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=h}mirror(){const h=this.bitMatrix;for(let g=0,b=h.getWidth();g<b;g++)for(let S=g+1,N=h.getHeight();S<N;S++)h.get(g,S)!==h.get(S,g)&&(h.flip(S,g),h.flip(g,S))}}class Qo{constructor(h,g){this.numDataCodewords=h,this.codewords=g}static getDataBlocks(h,g,b){if(h.length!==g.getTotalCodewords())throw new p;const S=g.getECBlocksForLevel(b);let N=0;const I=S.getECBlocks();for(const qe of I)N+=qe.getCount();const R=new Array(N);let H=0;for(const qe of I)for(let $e=0;$e<qe.getCount();$e++){const Xe=qe.getDataCodewords(),ct=S.getECCodewordsPerBlock()+Xe;R[H++]=new Qo(Xe,new Uint8Array(ct))}const ne=R[0].codewords.length;let he=R.length-1;for(;he>=0&&R[he].codewords.length!==ne;)he--;he++;const ve=ne-S.getECCodewordsPerBlock();let Ne=0;for(let qe=0;qe<ve;qe++)for(let $e=0;$e<H;$e++)R[$e].codewords[qe]=h[Ne++];for(let qe=he;qe<H;qe++)R[qe].codewords[ve]=h[Ne++];const Me=R[0].codewords.length;for(let qe=ve;qe<Me;qe++)for(let $e=0;$e<H;$e++){const Xe=$e<he?qe:qe+1;R[$e].codewords[Xe]=h[Ne++]}return R}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ya;(function(je){je[je.TERMINATOR=0]="TERMINATOR",je[je.NUMERIC=1]="NUMERIC",je[je.ALPHANUMERIC=2]="ALPHANUMERIC",je[je.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",je[je.BYTE=4]="BYTE",je[je.ECI=5]="ECI",je[je.KANJI=6]="KANJI",je[je.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",je[je.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",je[je.HANZI=9]="HANZI"})(ya||(ya={}));class Cr{constructor(h,g,b,S){this.value=h,this.stringValue=g,this.characterCountBitsForVersions=b,this.bits=S,Cr.FOR_BITS.set(S,this),Cr.FOR_VALUE.set(h,this)}static forBits(h){const g=Cr.FOR_BITS.get(h);if(g===void 0)throw new p;return g}getCharacterCountBits(h){const g=h.getVersionNumber();let b;return g<=9?b=0:g<=26?b=1:b=2,this.characterCountBitsForVersions[b]}getValue(){return this.value}getBits(){return this.bits}equals(h){if(!(h instanceof Cr))return!1;const g=h;return this.value===g.value}toString(){return this.stringValue}}Cr.FOR_BITS=new Map,Cr.FOR_VALUE=new Map,Cr.TERMINATOR=new Cr(ya.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Cr.NUMERIC=new Cr(ya.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Cr.ALPHANUMERIC=new Cr(ya.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Cr.STRUCTURED_APPEND=new Cr(ya.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Cr.BYTE=new Cr(ya.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Cr.ECI=new Cr(ya.ECI,"ECI",Int32Array.from([0,0,0]),7),Cr.KANJI=new Cr(ya.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Cr.FNC1_FIRST_POSITION=new Cr(ya.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Cr.FNC1_SECOND_POSITION=new Cr(ya.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Cr.HANZI=new Cr(ya.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Jn{static decode(h,g,b,S){const N=new hs(h);let I=new re;const R=new Array;let H=-1,ne=-1;try{let he=null,ve=!1,Ne;do{if(N.available()<4)Ne=Cr.TERMINATOR;else{const Me=N.readBits(4);Ne=Cr.forBits(Me)}switch(Ne){case Cr.TERMINATOR:break;case Cr.FNC1_FIRST_POSITION:case Cr.FNC1_SECOND_POSITION:ve=!0;break;case Cr.STRUCTURED_APPEND:if(N.available()<16)throw new $;H=N.readBits(8),ne=N.readBits(8);break;case Cr.ECI:const Me=Jn.parseECIValue(N);if(he=F.getCharacterSetECIByValue(Me),he===null)throw new $;break;case Cr.HANZI:const qe=N.readBits(4),$e=N.readBits(Ne.getCharacterCountBits(g));qe===Jn.GB2312_SUBSET&&Jn.decodeHanziSegment(N,I,$e);break;default:const Xe=N.readBits(Ne.getCharacterCountBits(g));switch(Ne){case Cr.NUMERIC:Jn.decodeNumericSegment(N,I,Xe);break;case Cr.ALPHANUMERIC:Jn.decodeAlphanumericSegment(N,I,Xe,ve);break;case Cr.BYTE:Jn.decodeByteSegment(N,I,Xe,he,R,S);break;case Cr.KANJI:Jn.decodeKanjiSegment(N,I,Xe);break;default:throw new $}break}}while(Ne!==Cr.TERMINATOR)}catch{throw new $}return new ke(h,I.toString(),R.length===0?null:R,b===null?null:b.toString(),H,ne)}static decodeHanziSegment(h,g,b){if(b*13>h.available())throw new $;const S=new Uint8Array(2*b);let N=0;for(;b>0;){const I=h.readBits(13);let R=I/96<<8&4294967295|I%96;R<959?R+=41377:R+=42657,S[N]=R>>8&255,S[N+1]=R&255,N+=2,b--}try{g.append(J.decode(S,Z.GB2312))}catch(I){throw new $(I)}}static decodeKanjiSegment(h,g,b){if(b*13>h.available())throw new $;const S=new Uint8Array(2*b);let N=0;for(;b>0;){const I=h.readBits(13);let R=I/192<<8&4294967295|I%192;R<7936?R+=33088:R+=49472,S[N]=R>>8,S[N+1]=R,N+=2,b--}try{g.append(J.decode(S,Z.SHIFT_JIS))}catch(I){throw new $(I)}}static decodeByteSegment(h,g,b,S,N,I){if(8*b>h.available())throw new $;const R=new Uint8Array(b);for(let ne=0;ne<b;ne++)R[ne]=h.readBits(8);let H;S===null?H=Z.guessEncoding(R,I):H=S.getName();try{g.append(J.decode(R,H))}catch(ne){throw new $(ne)}N.push(R)}static toAlphaNumericChar(h){if(h>=Jn.ALPHANUMERIC_CHARS.length)throw new $;return Jn.ALPHANUMERIC_CHARS[h]}static decodeAlphanumericSegment(h,g,b,S){const N=g.length();for(;b>1;){if(h.available()<11)throw new $;const I=h.readBits(11);g.append(Jn.toAlphaNumericChar(Math.floor(I/45))),g.append(Jn.toAlphaNumericChar(I%45)),b-=2}if(b===1){if(h.available()<6)throw new $;g.append(Jn.toAlphaNumericChar(h.readBits(6)))}if(S)for(let I=N;I<g.length();I++)g.charAt(I)==="%"&&(I<g.length()-1&&g.charAt(I+1)==="%"?g.deleteCharAt(I+1):g.setCharAt(I,""))}static decodeNumericSegment(h,g,b){for(;b>=3;){if(h.available()<10)throw new $;const S=h.readBits(10);if(S>=1e3)throw new $;g.append(Jn.toAlphaNumericChar(Math.floor(S/100))),g.append(Jn.toAlphaNumericChar(Math.floor(S/10)%10)),g.append(Jn.toAlphaNumericChar(S%10)),b-=3}if(b===2){if(h.available()<7)throw new $;const S=h.readBits(7);if(S>=100)throw new $;g.append(Jn.toAlphaNumericChar(Math.floor(S/10))),g.append(Jn.toAlphaNumericChar(S%10))}else if(b===1){if(h.available()<4)throw new $;const S=h.readBits(4);if(S>=10)throw new $;g.append(Jn.toAlphaNumericChar(S))}}static parseECIValue(h){const g=h.readBits(8);if((g&128)===0)return g&127;if((g&192)===128){const b=h.readBits(8);return(g&63)<<8&4294967295|b}if((g&224)===192){const b=h.readBits(16);return(g&31)<<16&4294967295|b}throw new $}}Jn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Jn.GB2312_SUBSET=1;class Dl{constructor(h){this.mirrored=h}isMirrored(){return this.mirrored}applyMirroredCorrection(h){if(!this.mirrored||h===null||h.length<3)return;const g=h[0];h[0]=h[2],h[2]=g}}class qc{constructor(){this.rsDecoder=new st(vt.QR_CODE_FIELD_256)}decodeBooleanArray(h,g){return this.decodeBitMatrix(de.parseFromBooleanArray(h),g)}decodeBitMatrix(h,g){const b=new Ps(h);let S=null;try{return this.decodeBitMatrixParser(b,g)}catch(N){S=N}try{b.remask(),b.setMirror(!0),b.readVersion(),b.readFormatInformation(),b.mirror();const N=this.decodeBitMatrixParser(b,g);return N.setOther(new Dl(!0)),N}catch(N){throw S!==null?S:N}}decodeBitMatrixParser(h,g){const b=h.readVersion(),S=h.readFormatInformation().getErrorCorrectionLevel(),N=h.readCodewords(),I=Qo.getDataBlocks(N,b,S);let R=0;for(const he of I)R+=he.getNumDataCodewords();const H=new Uint8Array(R);let ne=0;for(const he of I){const ve=he.getCodewords(),Ne=he.getNumDataCodewords();this.correctErrors(ve,Ne);for(let Me=0;Me<Ne;Me++)H[ne++]=ve[Me]}return Jn.decode(H,b,S,g)}correctErrors(h,g){const b=new Int32Array(h);try{this.rsDecoder.decode(b,h.length-g)}catch{throw new v}for(let S=0;S<g;S++)h[S]=b[S]}}class ka extends St{constructor(h,g,b){super(h,g),this.estimatedModuleSize=b}aboutEquals(h,g,b){if(Math.abs(g-this.getY())<=h&&Math.abs(b-this.getX())<=h){const S=Math.abs(h-this.estimatedModuleSize);return S<=1||S<=this.estimatedModuleSize}return!1}combineEstimate(h,g,b){const S=(this.getX()+g)/2,N=(this.getY()+h)/2,I=(this.estimatedModuleSize+b)/2;return new ka(S,N,I)}}class Za{constructor(h,g,b,S,N,I,R){this.image=h,this.startX=g,this.startY=b,this.width=S,this.height=N,this.moduleSize=I,this.resultPointCallback=R,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const h=this.startX,g=this.height,b=this.width,S=h+b,N=this.startY+g/2,I=new Int32Array(3),R=this.image;for(let H=0;H<g;H++){const ne=N+((H&1)===0?Math.floor((H+1)/2):-Math.floor((H+1)/2));I[0]=0,I[1]=0,I[2]=0;let he=h;for(;he<S&&!R.get(he,ne);)he++;let ve=0;for(;he<S;){if(R.get(he,ne))if(ve===1)I[1]++;else if(ve===2){if(this.foundPatternCross(I)){const Ne=this.handlePossibleCenter(I,ne,he);if(Ne!==null)return Ne}I[0]=I[2],I[1]=1,I[2]=0,ve=1}else I[++ve]++;else ve===1&&ve++,I[ve]++;he++}if(this.foundPatternCross(I)){const Ne=this.handlePossibleCenter(I,ne,S);if(Ne!==null)return Ne}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new le}static centerFromEnd(h,g){return g-h[2]-h[1]/2}foundPatternCross(h){const g=this.moduleSize,b=g/2;for(let S=0;S<3;S++)if(Math.abs(g-h[S])>=b)return!1;return!0}crossCheckVertical(h,g,b,S){const N=this.image,I=N.getHeight(),R=this.crossCheckStateCount;R[0]=0,R[1]=0,R[2]=0;let H=h;for(;H>=0&&N.get(g,H)&&R[1]<=b;)R[1]++,H--;if(H<0||R[1]>b)return NaN;for(;H>=0&&!N.get(g,H)&&R[0]<=b;)R[0]++,H--;if(R[0]>b)return NaN;for(H=h+1;H<I&&N.get(g,H)&&R[1]<=b;)R[1]++,H++;if(H===I||R[1]>b)return NaN;for(;H<I&&!N.get(g,H)&&R[2]<=b;)R[2]++,H++;if(R[2]>b)return NaN;const ne=R[0]+R[1]+R[2];return 5*Math.abs(ne-S)>=2*S?NaN:this.foundPatternCross(R)?Za.centerFromEnd(R,H):NaN}handlePossibleCenter(h,g,b){const S=h[0]+h[1]+h[2],N=Za.centerFromEnd(h,b),I=this.crossCheckVertical(g,N,2*h[1],S);if(!isNaN(I)){const R=(h[0]+h[1]+h[2])/3;for(const ne of this.possibleCenters)if(ne.aboutEquals(R,I,N))return ne.combineEstimate(I,N,R);const H=new ka(N,I,R);this.possibleCenters.push(H),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(H)}return null}}class Ao extends St{constructor(h,g,b,S){super(h,g),this.estimatedModuleSize=b,this.count=S,S===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(h,g,b){if(Math.abs(g-this.getY())<=h&&Math.abs(b-this.getX())<=h){const S=Math.abs(h-this.estimatedModuleSize);return S<=1||S<=this.estimatedModuleSize}return!1}combineEstimate(h,g,b){const S=this.count+1,N=(this.count*this.getX()+g)/S,I=(this.count*this.getY()+h)/S,R=(this.count*this.estimatedModuleSize+b)/S;return new Ao(N,I,R,S)}}class Pl{constructor(h){this.bottomLeft=h[0],this.topLeft=h[1],this.topRight=h[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class bi{constructor(h,g){this.image=h,this.resultPointCallback=g,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=g}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(h){const g=h!=null&&h.get(U.TRY_HARDER)!==void 0,b=h!=null&&h.get(U.PURE_BARCODE)!==void 0,S=this.image,N=S.getHeight(),I=S.getWidth();let R=Math.floor(3*N/(4*bi.MAX_MODULES));(R<bi.MIN_SKIP||g)&&(R=bi.MIN_SKIP);let H=!1;const ne=new Int32Array(5);for(let ve=R-1;ve<N&&!H;ve+=R){ne[0]=0,ne[1]=0,ne[2]=0,ne[3]=0,ne[4]=0;let Ne=0;for(let Me=0;Me<I;Me++)if(S.get(Me,ve))(Ne&1)===1&&Ne++,ne[Ne]++;else if((Ne&1)===0)if(Ne===4)if(bi.foundPatternCross(ne)){if(this.handlePossibleCenter(ne,ve,Me,b)===!0)if(R=2,this.hasSkipped===!0)H=this.haveMultiplyConfirmedCenters();else{const $e=this.findRowSkip();$e>ne[2]&&(ve+=$e-ne[2]-R,Me=I-1)}else{ne[0]=ne[2],ne[1]=ne[3],ne[2]=ne[4],ne[3]=1,ne[4]=0,Ne=3;continue}Ne=0,ne[0]=0,ne[1]=0,ne[2]=0,ne[3]=0,ne[4]=0}else ne[0]=ne[2],ne[1]=ne[3],ne[2]=ne[4],ne[3]=1,ne[4]=0,Ne=3;else ne[++Ne]++;else ne[Ne]++;bi.foundPatternCross(ne)&&this.handlePossibleCenter(ne,ve,I,b)===!0&&(R=ne[0],this.hasSkipped&&(H=this.haveMultiplyConfirmedCenters()))}const he=this.selectBestPatterns();return St.orderBestPatterns(he),new Pl(he)}static centerFromEnd(h,g){return g-h[4]-h[3]-h[2]/2}static foundPatternCross(h){let g=0;for(let N=0;N<5;N++){const I=h[N];if(I===0)return!1;g+=I}if(g<7)return!1;const b=g/7,S=b/2;return Math.abs(b-h[0])<S&&Math.abs(b-h[1])<S&&Math.abs(3*b-h[2])<3*S&&Math.abs(b-h[3])<S&&Math.abs(b-h[4])<S}getCrossCheckStateCount(){const h=this.crossCheckStateCount;return h[0]=0,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h}crossCheckDiagonal(h,g,b,S){const N=this.getCrossCheckStateCount();let I=0;const R=this.image;for(;h>=I&&g>=I&&R.get(g-I,h-I);)N[2]++,I++;if(h<I||g<I)return!1;for(;h>=I&&g>=I&&!R.get(g-I,h-I)&&N[1]<=b;)N[1]++,I++;if(h<I||g<I||N[1]>b)return!1;for(;h>=I&&g>=I&&R.get(g-I,h-I)&&N[0]<=b;)N[0]++,I++;if(N[0]>b)return!1;const H=R.getHeight(),ne=R.getWidth();for(I=1;h+I<H&&g+I<ne&&R.get(g+I,h+I);)N[2]++,I++;if(h+I>=H||g+I>=ne)return!1;for(;h+I<H&&g+I<ne&&!R.get(g+I,h+I)&&N[3]<b;)N[3]++,I++;if(h+I>=H||g+I>=ne||N[3]>=b)return!1;for(;h+I<H&&g+I<ne&&R.get(g+I,h+I)&&N[4]<b;)N[4]++,I++;if(N[4]>=b)return!1;const he=N[0]+N[1]+N[2]+N[3]+N[4];return Math.abs(he-S)<2*S&&bi.foundPatternCross(N)}crossCheckVertical(h,g,b,S){const N=this.image,I=N.getHeight(),R=this.getCrossCheckStateCount();let H=h;for(;H>=0&&N.get(g,H);)R[2]++,H--;if(H<0)return NaN;for(;H>=0&&!N.get(g,H)&&R[1]<=b;)R[1]++,H--;if(H<0||R[1]>b)return NaN;for(;H>=0&&N.get(g,H)&&R[0]<=b;)R[0]++,H--;if(R[0]>b)return NaN;for(H=h+1;H<I&&N.get(g,H);)R[2]++,H++;if(H===I)return NaN;for(;H<I&&!N.get(g,H)&&R[3]<b;)R[3]++,H++;if(H===I||R[3]>=b)return NaN;for(;H<I&&N.get(g,H)&&R[4]<b;)R[4]++,H++;if(R[4]>=b)return NaN;const ne=R[0]+R[1]+R[2]+R[3]+R[4];return 5*Math.abs(ne-S)>=2*S?NaN:bi.foundPatternCross(R)?bi.centerFromEnd(R,H):NaN}crossCheckHorizontal(h,g,b,S){const N=this.image,I=N.getWidth(),R=this.getCrossCheckStateCount();let H=h;for(;H>=0&&N.get(H,g);)R[2]++,H--;if(H<0)return NaN;for(;H>=0&&!N.get(H,g)&&R[1]<=b;)R[1]++,H--;if(H<0||R[1]>b)return NaN;for(;H>=0&&N.get(H,g)&&R[0]<=b;)R[0]++,H--;if(R[0]>b)return NaN;for(H=h+1;H<I&&N.get(H,g);)R[2]++,H++;if(H===I)return NaN;for(;H<I&&!N.get(H,g)&&R[3]<b;)R[3]++,H++;if(H===I||R[3]>=b)return NaN;for(;H<I&&N.get(H,g)&&R[4]<b;)R[4]++,H++;if(R[4]>=b)return NaN;const ne=R[0]+R[1]+R[2]+R[3]+R[4];return 5*Math.abs(ne-S)>=S?NaN:bi.foundPatternCross(R)?bi.centerFromEnd(R,H):NaN}handlePossibleCenter(h,g,b,S){const N=h[0]+h[1]+h[2]+h[3]+h[4];let I=bi.centerFromEnd(h,b),R=this.crossCheckVertical(g,Math.floor(I),h[2],N);if(!isNaN(R)&&(I=this.crossCheckHorizontal(Math.floor(I),Math.floor(R),h[2],N),!isNaN(I)&&(!S||this.crossCheckDiagonal(Math.floor(R),Math.floor(I),h[2],N)))){const H=N/7;let ne=!1;const he=this.possibleCenters;for(let ve=0,Ne=he.length;ve<Ne;ve++){const Me=he[ve];if(Me.aboutEquals(H,R,I)){he[ve]=Me.combineEstimate(R,I,H),ne=!0;break}}if(!ne){const ve=new Ao(I,R,H);he.push(ve),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(ve)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let g=null;for(const b of this.possibleCenters)if(b.getCount()>=bi.CENTER_QUORUM)if(g==null)g=b;else return this.hasSkipped=!0,Math.floor((Math.abs(g.getX()-b.getX())-Math.abs(g.getY()-b.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let h=0,g=0;const b=this.possibleCenters.length;for(const I of this.possibleCenters)I.getCount()>=bi.CENTER_QUORUM&&(h++,g+=I.getEstimatedModuleSize());if(h<3)return!1;const S=g/b;let N=0;for(const I of this.possibleCenters)N+=Math.abs(I.getEstimatedModuleSize()-S);return N<=.05*g}selectBestPatterns(){const h=this.possibleCenters.length;if(h<3)throw new le;const g=this.possibleCenters;let b;if(h>3){let S=0,N=0;for(const H of this.possibleCenters){const ne=H.getEstimatedModuleSize();S+=ne,N+=ne*ne}b=S/h;let I=Math.sqrt(N/h-b*b);g.sort((H,ne)=>{const he=Math.abs(ne.getEstimatedModuleSize()-b),ve=Math.abs(H.getEstimatedModuleSize()-b);return he<ve?-1:he>ve?1:0});const R=Math.max(.2*b,I);for(let H=0;H<g.length&&g.length>3;H++){const ne=g[H];Math.abs(ne.getEstimatedModuleSize()-b)>R&&(g.splice(H,1),H--)}}if(g.length>3){let S=0;for(const N of g)S+=N.getEstimatedModuleSize();b=S/g.length,g.sort((N,I)=>{if(I.getCount()===N.getCount()){const R=Math.abs(I.getEstimatedModuleSize()-b),H=Math.abs(N.getEstimatedModuleSize()-b);return R<H?1:R>H?-1:0}else return I.getCount()-N.getCount()}),g.splice(3)}return[g[0],g[1],g[2]]}}bi.CENTER_QUORUM=2,bi.MIN_SKIP=3,bi.MAX_MODULES=57;class qt{constructor(h){this.image=h}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(h){this.resultPointCallback=h==null?null:h.get(U.NEED_RESULT_POINT_CALLBACK);const b=new bi(this.image,this.resultPointCallback).find(h);return this.processFinderPatternInfo(b)}processFinderPatternInfo(h){const g=h.getTopLeft(),b=h.getTopRight(),S=h.getBottomLeft(),N=this.calculateModuleSize(g,b,S);if(N<1)throw new le("No pattern found in proccess finder.");const I=qt.computeDimension(g,b,S,N),R=Ht.getProvisionalVersionForDimension(I),H=R.getDimensionForVersion()-7;let ne=null;if(R.getAlignmentPatternCenters().length>0){const Me=b.getX()-g.getX()+S.getX(),qe=b.getY()-g.getY()+S.getY(),$e=1-3/H,Xe=Math.floor(g.getX()+$e*(Me-g.getX())),ct=Math.floor(g.getY()+$e*(qe-g.getY()));for(let Tt=4;Tt<=16;Tt<<=1)try{ne=this.findAlignmentInRegion(N,Xe,ct,Tt);break}catch(_t){if(!(_t instanceof le))throw _t}}const he=qt.createTransform(g,b,S,ne,I),ve=qt.sampleGrid(this.image,he,I);let Ne;return ne===null?Ne=[S,g,b]:Ne=[S,g,b,ne],new xr(ve,Ne)}static createTransform(h,g,b,S,N){const I=N-3.5;let R,H,ne,he;return S!==null?(R=S.getX(),H=S.getY(),ne=I-3,he=ne):(R=g.getX()-h.getX()+b.getX(),H=g.getY()-h.getY()+b.getY(),ne=I,he=I),Or.quadrilateralToQuadrilateral(3.5,3.5,I,3.5,ne,he,3.5,I,h.getX(),h.getY(),g.getX(),g.getY(),R,H,b.getX(),b.getY())}static sampleGrid(h,g,b){return Yr.getInstance().sampleGridWithTransform(h,b,b,g)}static computeDimension(h,g,b,S){const N=yt.round(St.distance(h,g)/S),I=yt.round(St.distance(h,b)/S);let R=Math.floor((N+I)/2)+7;switch(R&3){case 0:R++;break;case 2:R--;break;case 3:throw new le("Dimensions could be not found.")}return R}calculateModuleSize(h,g,b){return(this.calculateModuleSizeOneWay(h,g)+this.calculateModuleSizeOneWay(h,b))/2}calculateModuleSizeOneWay(h,g){const b=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(h.getX()),Math.floor(h.getY()),Math.floor(g.getX()),Math.floor(g.getY())),S=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(g.getX()),Math.floor(g.getY()),Math.floor(h.getX()),Math.floor(h.getY()));return isNaN(b)?S/7:isNaN(S)?b/7:(b+S)/14}sizeOfBlackWhiteBlackRunBothWays(h,g,b,S){let N=this.sizeOfBlackWhiteBlackRun(h,g,b,S),I=1,R=h-(b-h);R<0?(I=h/(h-R),R=0):R>=this.image.getWidth()&&(I=(this.image.getWidth()-1-h)/(R-h),R=this.image.getWidth()-1);let H=Math.floor(g-(S-g)*I);return I=1,H<0?(I=g/(g-H),H=0):H>=this.image.getHeight()&&(I=(this.image.getHeight()-1-g)/(H-g),H=this.image.getHeight()-1),R=Math.floor(h+(R-h)*I),N+=this.sizeOfBlackWhiteBlackRun(h,g,R,H),N-1}sizeOfBlackWhiteBlackRun(h,g,b,S){const N=Math.abs(S-g)>Math.abs(b-h);if(N){let Me=h;h=g,g=Me,Me=b,b=S,S=Me}const I=Math.abs(b-h),R=Math.abs(S-g);let H=-I/2;const ne=h<b?1:-1,he=g<S?1:-1;let ve=0;const Ne=b+ne;for(let Me=h,qe=g;Me!==Ne;Me+=ne){const $e=N?qe:Me,Xe=N?Me:qe;if(ve===1===this.image.get($e,Xe)){if(ve===2)return yt.distance(Me,qe,h,g);ve++}if(H+=R,H>0){if(qe===S)break;qe+=he,H-=I}}return ve===2?yt.distance(b+ne,S,h,g):NaN}findAlignmentInRegion(h,g,b,S){const N=Math.floor(S*h),I=Math.max(0,g-N),R=Math.min(this.image.getWidth()-1,g+N);if(R-I<h*3)throw new le("Alignment top exceeds estimated module size.");const H=Math.max(0,b-N),ne=Math.min(this.image.getHeight()-1,b+N);if(ne-H<h*3)throw new le("Alignment bottom exceeds estimated module size.");return new Za(this.image,I,H,R-I,ne-H,h,this.resultPointCallback).find()}}class ca{constructor(){this.decoder=new qc}getDecoder(){return this.decoder}decode(h,g){let b,S;if(g!=null&&g.get(U.PURE_BARCODE)!==void 0){const H=ca.extractPureBits(h.getBlackMatrix());b=this.decoder.decodeBitMatrix(H,g),S=ca.NO_POINTS}else{const H=new qt(h.getBlackMatrix()).detect(g);b=this.decoder.decodeBitMatrix(H.getBits(),g),S=H.getPoints()}b.getOther()instanceof Dl&&b.getOther().applyMirroredCorrection(S);const N=new W(b.getText(),b.getRawBytes(),void 0,S,ge.QR_CODE,void 0),I=b.getByteSegments();I!==null&&N.putMetadata(Le.BYTE_SEGMENTS,I);const R=b.getECLevel();return R!==null&&N.putMetadata(Le.ERROR_CORRECTION_LEVEL,R),b.hasStructuredAppend()&&(N.putMetadata(Le.STRUCTURED_APPEND_SEQUENCE,b.getStructuredAppendSequenceNumber()),N.putMetadata(Le.STRUCTURED_APPEND_PARITY,b.getStructuredAppendParity())),N}reset(){}static extractPureBits(h){const g=h.getTopLeftOnBit(),b=h.getBottomRightOnBit();if(g===null||b===null)throw new le;const S=this.moduleSize(g,h);let N=g[1],I=b[1],R=g[0],H=b[0];if(R>=H||N>=I)throw new le;if(I-N!==H-R&&(H=R+(I-N),H>=h.getWidth()))throw new le;const ne=Math.round((H-R+1)/S),he=Math.round((I-N+1)/S);if(ne<=0||he<=0)throw new le;if(he!==ne)throw new le;const ve=Math.floor(S/2);N+=ve,R+=ve;const Ne=R+Math.floor((ne-1)*S)-H;if(Ne>0){if(Ne>ve)throw new le;R-=Ne}const Me=N+Math.floor((he-1)*S)-I;if(Me>0){if(Me>ve)throw new le;N-=Me}const qe=new de(ne,he);for(let $e=0;$e<he;$e++){const Xe=N+Math.floor($e*S);for(let ct=0;ct<ne;ct++)h.get(R+Math.floor(ct*S),Xe)&&qe.set(ct,$e)}return qe}static moduleSize(h,g){const b=g.getHeight(),S=g.getWidth();let N=h[0],I=h[1],R=!0,H=0;for(;N<S&&I<b;){if(R!==g.get(N,I)){if(++H===5)break;R=!R}N++,I++}if(N===S||I===b)throw new le;return(N-h[0])/7}}ca.NO_POINTS=new Array;class Zt{PDF417Common(){}static getBitCountSum(h){return yt.sum(h)}static toIntArray(h){if(h==null||!h.length)return Zt.EMPTY_INT_ARRAY;const g=new Int32Array(h.length);let b=0;for(const S of h)g[b++]=S;return g}static getCodeword(h){const g=O.binarySearch(Zt.SYMBOL_TABLE,h&262143);return g<0?-1:(Zt.CODEWORD_TABLE[g]-1)%Zt.NUMBER_OF_CODEWORDS}}Zt.NUMBER_OF_CODEWORDS=929,Zt.MAX_CODEWORDS_IN_BARCODE=Zt.NUMBER_OF_CODEWORDS-1,Zt.MIN_ROWS_IN_BARCODE=3,Zt.MAX_ROWS_IN_BARCODE=90,Zt.MODULES_IN_CODEWORD=17,Zt.MODULES_IN_STOP_PATTERN=18,Zt.BARS_IN_MODULE=8,Zt.EMPTY_INT_ARRAY=new Int32Array([]),Zt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Zt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class ud{constructor(h,g){this.bits=h,this.points=g}getBits(){return this.bits}getPoints(){return this.points}}class Lr{static detectMultiple(h,g,b){let S=h.getBlackMatrix(),N=Lr.detect(b,S);return N.length||(S=S.clone(),S.rotate180(),N=Lr.detect(b,S)),new ud(S,N)}static detect(h,g){const b=new Array;let S=0,N=0,I=!1;for(;S<g.getHeight();){const R=Lr.findVertices(g,S,N);if(R[0]==null&&R[3]==null){if(!I)break;I=!1,N=0;for(const H of b)H[1]!=null&&(S=Math.trunc(Math.max(S,H[1].getY()))),H[3]!=null&&(S=Math.max(S,Math.trunc(H[3].getY())));S+=Lr.ROW_STEP;continue}if(I=!0,b.push(R),!h)break;R[2]!=null?(N=Math.trunc(R[2].getX()),S=Math.trunc(R[2].getY())):(N=Math.trunc(R[4].getX()),S=Math.trunc(R[4].getY()))}return b}static findVertices(h,g,b){const S=h.getHeight(),N=h.getWidth(),I=new Array(8);return Lr.copyToResult(I,Lr.findRowsWithPattern(h,S,N,g,b,Lr.START_PATTERN),Lr.INDEXES_START_PATTERN),I[4]!=null&&(b=Math.trunc(I[4].getX()),g=Math.trunc(I[4].getY())),Lr.copyToResult(I,Lr.findRowsWithPattern(h,S,N,g,b,Lr.STOP_PATTERN),Lr.INDEXES_STOP_PATTERN),I}static copyToResult(h,g,b){for(let S=0;S<b.length;S++)h[b[S]]=g[S]}static findRowsWithPattern(h,g,b,S,N,I){const R=new Array(4);let H=!1;const ne=new Int32Array(I.length);for(;S<g;S+=Lr.ROW_STEP){let ve=Lr.findGuardPattern(h,N,S,b,!1,I,ne);if(ve!=null){for(;S>0;){const Ne=Lr.findGuardPattern(h,N,--S,b,!1,I,ne);if(Ne!=null)ve=Ne;else{S++;break}}R[0]=new St(ve[0],S),R[1]=new St(ve[1],S),H=!0;break}}let he=S+1;if(H){let ve=0,Ne=Int32Array.from([Math.trunc(R[0].getX()),Math.trunc(R[1].getX())]);for(;he<g;he++){const Me=Lr.findGuardPattern(h,Ne[0],he,b,!1,I,ne);if(Me!=null&&Math.abs(Ne[0]-Me[0])<Lr.MAX_PATTERN_DRIFT&&Math.abs(Ne[1]-Me[1])<Lr.MAX_PATTERN_DRIFT)Ne=Me,ve=0;else{if(ve>Lr.SKIPPED_ROW_COUNT_MAX)break;ve++}}he-=ve+1,R[2]=new St(Ne[0],he),R[3]=new St(Ne[1],he)}return he-S<Lr.BARCODE_MIN_HEIGHT&&O.fill(R,null),R}static findGuardPattern(h,g,b,S,N,I,R){O.fillWithin(R,0,R.length,0);let H=g,ne=0;for(;h.get(H,b)&&H>0&&ne++<Lr.MAX_PIXEL_DRIFT;)H--;let he=H,ve=0,Ne=I.length;for(let Me=N;he<S;he++)if(h.get(he,b)!==Me)R[ve]++;else{if(ve===Ne-1){if(Lr.patternMatchVariance(R,I,Lr.MAX_INDIVIDUAL_VARIANCE)<Lr.MAX_AVG_VARIANCE)return new Int32Array([H,he]);H+=R[0]+R[1],C.arraycopy(R,2,R,0,ve-1),R[ve-1]=0,R[ve]=0,ve--}else ve++;R[ve]=1,Me=!Me}return ve===Ne-1&&Lr.patternMatchVariance(R,I,Lr.MAX_INDIVIDUAL_VARIANCE)<Lr.MAX_AVG_VARIANCE?new Int32Array([H,he-1]):null}static patternMatchVariance(h,g,b){let S=h.length,N=0,I=0;for(let ne=0;ne<S;ne++)N+=h[ne],I+=g[ne];if(N<I)return 1/0;let R=N/I;b*=R;let H=0;for(let ne=0;ne<S;ne++){let he=h[ne],ve=g[ne]*R,Ne=he>ve?he-ve:ve-he;if(Ne>b)return 1/0;H+=Ne}return H/N}}Lr.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Lr.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Lr.MAX_AVG_VARIANCE=.42,Lr.MAX_INDIVIDUAL_VARIANCE=.8,Lr.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Lr.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Lr.MAX_PIXEL_DRIFT=3,Lr.MAX_PATTERN_DRIFT=5,Lr.SKIPPED_ROW_COUNT_MAX=25,Lr.ROW_STEP=5,Lr.BARCODE_MIN_HEIGHT=10;class Tn{constructor(h,g){if(g.length===0)throw new p;this.field=h;let b=g.length;if(b>1&&g[0]===0){let S=1;for(;S<b&&g[S]===0;)S++;S===b?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(b-S),C.arraycopy(g,S,this.coefficients,0,this.coefficients.length))}else this.coefficients=g}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(h){return this.coefficients[this.coefficients.length-1-h]}evaluateAt(h){if(h===0)return this.getCoefficient(0);if(h===1){let S=0;for(let N of this.coefficients)S=this.field.add(S,N);return S}let g=this.coefficients[0],b=this.coefficients.length;for(let S=1;S<b;S++)g=this.field.add(this.field.multiply(h,g),this.coefficients[S]);return g}add(h){if(!this.field.equals(h.field))throw new p("ModulusPolys do not have same ModulusGF field");if(this.isZero())return h;if(h.isZero())return this;let g=this.coefficients,b=h.coefficients;if(g.length>b.length){let I=g;g=b,b=I}let S=new Int32Array(b.length),N=b.length-g.length;C.arraycopy(b,0,S,0,N);for(let I=N;I<b.length;I++)S[I]=this.field.add(g[I-N],b[I]);return new Tn(this.field,S)}subtract(h){if(!this.field.equals(h.field))throw new p("ModulusPolys do not have same ModulusGF field");return h.isZero()?this:this.add(h.negative())}multiply(h){return h instanceof Tn?this.multiplyOther(h):this.multiplyScalar(h)}multiplyOther(h){if(!this.field.equals(h.field))throw new p("ModulusPolys do not have same ModulusGF field");if(this.isZero()||h.isZero())return new Tn(this.field,new Int32Array([0]));let g=this.coefficients,b=g.length,S=h.coefficients,N=S.length,I=new Int32Array(b+N-1);for(let R=0;R<b;R++){let H=g[R];for(let ne=0;ne<N;ne++)I[R+ne]=this.field.add(I[R+ne],this.field.multiply(H,S[ne]))}return new Tn(this.field,I)}negative(){let h=this.coefficients.length,g=new Int32Array(h);for(let b=0;b<h;b++)g[b]=this.field.subtract(0,this.coefficients[b]);return new Tn(this.field,g)}multiplyScalar(h){if(h===0)return new Tn(this.field,new Int32Array([0]));if(h===1)return this;let g=this.coefficients.length,b=new Int32Array(g);for(let S=0;S<g;S++)b[S]=this.field.multiply(this.coefficients[S],h);return new Tn(this.field,b)}multiplyByMonomial(h,g){if(h<0)throw new p;if(g===0)return new Tn(this.field,new Int32Array([0]));let b=this.coefficients.length,S=new Int32Array(b+h);for(let N=0;N<b;N++)S[N]=this.field.multiply(this.coefficients[N],g);return new Tn(this.field,S)}toString(){let h=new re;for(let g=this.getDegree();g>=0;g--){let b=this.getCoefficient(g);b!==0&&(b<0?(h.append(" - "),b=-b):h.length()>0&&h.append(" + "),(g===0||b!==1)&&h.append(b),g!==0&&(g===1?h.append("x"):(h.append("x^"),h.append(g))))}return h.toString()}}class gc{add(h,g){return(h+g)%this.modulus}subtract(h,g){return(this.modulus+h-g)%this.modulus}exp(h){return this.expTable[h]}log(h){if(h===0)throw new p;return this.logTable[h]}inverse(h){if(h===0)throw new Qe;return this.expTable[this.modulus-this.logTable[h]-1]}multiply(h,g){return h===0||g===0?0:this.expTable[(this.logTable[h]+this.logTable[g])%(this.modulus-1)]}getSize(){return this.modulus}equals(h){return h===this}}class Rs extends gc{constructor(h,g){super(),this.modulus=h,this.expTable=new Int32Array(h),this.logTable=new Int32Array(h);let b=1;for(let S=0;S<h;S++)this.expTable[S]=b,b=b*g%h;for(let S=0;S<h-1;S++)this.logTable[this.expTable[S]]=S;this.zero=new Tn(this,new Int32Array([0])),this.one=new Tn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(h,g){if(h<0)throw new p;if(g===0)return this.zero;let b=new Int32Array(h+1);return b[0]=g,new Tn(this,b)}}Rs.PDF417_GF=new Rs(Zt.NUMBER_OF_CODEWORDS,3);class fs{constructor(){this.field=Rs.PDF417_GF}decode(h,g,b){let S=new Tn(this.field,h),N=new Int32Array(g),I=!1;for(let qe=g;qe>0;qe--){let $e=S.evaluateAt(this.field.exp(qe));N[g-qe]=$e,$e!==0&&(I=!0)}if(!I)return 0;let R=this.field.getOne();if(b!=null)for(const qe of b){let $e=this.field.exp(h.length-1-qe),Xe=new Tn(this.field,new Int32Array([this.field.subtract(0,$e),1]));R=R.multiply(Xe)}let H=new Tn(this.field,N),ne=this.runEuclideanAlgorithm(this.field.buildMonomial(g,1),H,g),he=ne[0],ve=ne[1],Ne=this.findErrorLocations(he),Me=this.findErrorMagnitudes(ve,he,Ne);for(let qe=0;qe<Ne.length;qe++){let $e=h.length-1-this.field.log(Ne[qe]);if($e<0)throw v.getChecksumInstance();h[$e]=this.field.subtract(h[$e],Me[qe])}return Ne.length}runEuclideanAlgorithm(h,g,b){if(h.getDegree()<g.getDegree()){let Ne=h;h=g,g=Ne}let S=h,N=g,I=this.field.getZero(),R=this.field.getOne();for(;N.getDegree()>=Math.round(b/2);){let Ne=S,Me=I;if(S=N,I=R,S.isZero())throw v.getChecksumInstance();N=Ne;let qe=this.field.getZero(),$e=S.getCoefficient(S.getDegree()),Xe=this.field.inverse($e);for(;N.getDegree()>=S.getDegree()&&!N.isZero();){let ct=N.getDegree()-S.getDegree(),Tt=this.field.multiply(N.getCoefficient(N.getDegree()),Xe);qe=qe.add(this.field.buildMonomial(ct,Tt)),N=N.subtract(S.multiplyByMonomial(ct,Tt))}R=qe.multiply(I).subtract(Me).negative()}let H=R.getCoefficient(0);if(H===0)throw v.getChecksumInstance();let ne=this.field.inverse(H),he=R.multiply(ne),ve=N.multiply(ne);return[he,ve]}findErrorLocations(h){let g=h.getDegree(),b=new Int32Array(g),S=0;for(let N=1;N<this.field.getSize()&&S<g;N++)h.evaluateAt(N)===0&&(b[S]=this.field.inverse(N),S++);if(S!==g)throw v.getChecksumInstance();return b}findErrorMagnitudes(h,g,b){let S=g.getDegree(),N=new Int32Array(S);for(let ne=1;ne<=S;ne++)N[S-ne]=this.field.multiply(ne,g.getCoefficient(ne));let I=new Tn(this.field,N),R=b.length,H=new Int32Array(R);for(let ne=0;ne<R;ne++){let he=this.field.inverse(b[ne]),ve=this.field.subtract(0,h.evaluateAt(he)),Ne=this.field.inverse(I.evaluateAt(he));H[ne]=this.field.multiply(ve,Ne)}return H}}class Xa{constructor(h,g,b,S,N){h instanceof Xa?this.constructor_2(h):this.constructor_1(h,g,b,S,N)}constructor_1(h,g,b,S,N){const I=g==null||b==null,R=S==null||N==null;if(I&&R)throw new le;I?(g=new St(0,S.getY()),b=new St(0,N.getY())):R&&(S=new St(h.getWidth()-1,g.getY()),N=new St(h.getWidth()-1,b.getY())),this.image=h,this.topLeft=g,this.bottomLeft=b,this.topRight=S,this.bottomRight=N,this.minX=Math.trunc(Math.min(g.getX(),b.getX())),this.maxX=Math.trunc(Math.max(S.getX(),N.getX())),this.minY=Math.trunc(Math.min(g.getY(),S.getY())),this.maxY=Math.trunc(Math.max(b.getY(),N.getY()))}constructor_2(h){this.image=h.image,this.topLeft=h.getTopLeft(),this.bottomLeft=h.getBottomLeft(),this.topRight=h.getTopRight(),this.bottomRight=h.getBottomRight(),this.minX=h.getMinX(),this.maxX=h.getMaxX(),this.minY=h.getMinY(),this.maxY=h.getMaxY()}static merge(h,g){return h==null?g:g==null?h:new Xa(h.image,h.topLeft,h.bottomLeft,g.topRight,g.bottomRight)}addMissingRows(h,g,b){let S=this.topLeft,N=this.bottomLeft,I=this.topRight,R=this.bottomRight;if(h>0){let H=b?this.topLeft:this.topRight,ne=Math.trunc(H.getY()-h);ne<0&&(ne=0);let he=new St(H.getX(),ne);b?S=he:I=he}if(g>0){let H=b?this.bottomLeft:this.bottomRight,ne=Math.trunc(H.getY()+g);ne>=this.image.getHeight()&&(ne=this.image.getHeight()-1);let he=new St(H.getX(),ne);b?N=he:R=he}return new Xa(this.image,S,N,I,R)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class mi{constructor(h,g,b,S){this.columnCount=h,this.errorCorrectionLevel=S,this.rowCountUpperPart=g,this.rowCountLowerPart=b,this.rowCount=g+b}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Ks{constructor(){this.buffer=""}static form(h,g){let b=-1;function S(I,R,H,ne,he,ve){if(I==="%%")return"%";if(g[++b]===void 0)return;I=ne?parseInt(ne.substr(1)):void 0;let Ne=he?parseInt(he.substr(1)):void 0,Me;switch(ve){case"s":Me=g[b];break;case"c":Me=g[b][0];break;case"f":Me=parseFloat(g[b]).toFixed(I);break;case"p":Me=parseFloat(g[b]).toPrecision(I);break;case"e":Me=parseFloat(g[b]).toExponential(I);break;case"x":Me=parseInt(g[b]).toString(Ne||16);break;case"d":Me=parseFloat(parseInt(g[b],Ne||10).toPrecision(I)).toFixed(0);break}Me=typeof Me=="object"?JSON.stringify(Me):(+Me).toString(Ne);let qe=parseInt(H),$e=H&&H[0]+""=="0"?"0":" ";for(;Me.length<qe;)Me=R!==void 0?Me+$e:$e+Me;return Me}let N=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return h.replace(N,S)}format(h,...g){this.buffer+=Ks.form(h,g)}toString(){return this.buffer}}class Ja{constructor(h){this.boundingBox=new Xa(h),this.codewords=new Array(h.getMaxY()-h.getMinY()+1)}getCodewordNearby(h){let g=this.getCodeword(h);if(g!=null)return g;for(let b=1;b<Ja.MAX_NEARBY_DISTANCE;b++){let S=this.imageRowToCodewordIndex(h)-b;if(S>=0&&(g=this.codewords[S],g!=null)||(S=this.imageRowToCodewordIndex(h)+b,S<this.codewords.length&&(g=this.codewords[S],g!=null)))return g}return null}imageRowToCodewordIndex(h){return h-this.boundingBox.getMinY()}setCodeword(h,g){this.codewords[this.imageRowToCodewordIndex(h)]=g}getCodeword(h){return this.codewords[this.imageRowToCodewordIndex(h)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const h=new Ks;let g=0;for(const b of this.codewords){if(b==null){h.format("%3d:    |   %n",g++);continue}h.format("%3d: %3d|%3d%n",g++,b.getRowNumber(),b.getValue())}return h.toString()}}Ja.MAX_NEARBY_DISTANCE=5;class Yo{constructor(){this.values=new Map}setValue(h){h=Math.trunc(h);let g=this.values.get(h);g==null&&(g=0),g++,this.values.set(h,g)}getValue(){let h=-1,g=new Array;for(const[b,S]of this.values.entries()){const N={getKey:()=>b,getValue:()=>S};N.getValue()>h?(h=N.getValue(),g=[],g.push(N.getKey())):N.getValue()===h&&g.push(N.getKey())}return Zt.toIntArray(g)}getConfidence(h){return this.values.get(h)}}class yc extends Ja{constructor(h,g){super(h),this._isLeft=g}setRowNumbers(){for(let h of this.getCodewords())h?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(h){let g=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(g,h);let b=this.getBoundingBox(),S=this._isLeft?b.getTopLeft():b.getTopRight(),N=this._isLeft?b.getBottomLeft():b.getBottomRight(),I=this.imageRowToCodewordIndex(Math.trunc(S.getY())),R=this.imageRowToCodewordIndex(Math.trunc(N.getY())),H=-1,ne=1,he=0;for(let ve=I;ve<R;ve++){if(g[ve]==null)continue;let Ne=g[ve],Me=Ne.getRowNumber()-H;if(Me===0)he++;else if(Me===1)ne=Math.max(ne,he),he=1,H=Ne.getRowNumber();else if(Me<0||Ne.getRowNumber()>=h.getRowCount()||Me>ve)g[ve]=null;else{let qe;ne>2?qe=(ne-2)*Me:qe=Me;let $e=qe>=ve;for(let Xe=1;Xe<=qe&&!$e;Xe++)$e=g[ve-Xe]!=null;$e?g[ve]=null:(H=Ne.getRowNumber(),he=1)}}}getRowHeights(){let h=this.getBarcodeMetadata();if(h==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(h);let g=new Int32Array(h.getRowCount());for(let b of this.getCodewords())if(b!=null){let S=b.getRowNumber();if(S>=g.length)continue;g[S]++}return g}adjustIncompleteIndicatorColumnRowNumbers(h){let g=this.getBoundingBox(),b=this._isLeft?g.getTopLeft():g.getTopRight(),S=this._isLeft?g.getBottomLeft():g.getBottomRight(),N=this.imageRowToCodewordIndex(Math.trunc(b.getY())),I=this.imageRowToCodewordIndex(Math.trunc(S.getY())),R=this.getCodewords(),H=-1;for(let ne=N;ne<I;ne++){if(R[ne]==null)continue;let he=R[ne];he.setRowNumberAsRowIndicatorColumn();let ve=he.getRowNumber()-H;ve===0||(ve===1?H=he.getRowNumber():he.getRowNumber()>=h.getRowCount()?R[ne]=null:H=he.getRowNumber())}}getBarcodeMetadata(){let h=this.getCodewords(),g=new Yo,b=new Yo,S=new Yo,N=new Yo;for(let R of h){if(R==null)continue;R.setRowNumberAsRowIndicatorColumn();let H=R.getValue()%30,ne=R.getRowNumber();switch(this._isLeft||(ne+=2),ne%3){case 0:b.setValue(H*3+1);break;case 1:N.setValue(H/3),S.setValue(H%3);break;case 2:g.setValue(H+1);break}}if(g.getValue().length===0||b.getValue().length===0||S.getValue().length===0||N.getValue().length===0||g.getValue()[0]<1||b.getValue()[0]+S.getValue()[0]<Zt.MIN_ROWS_IN_BARCODE||b.getValue()[0]+S.getValue()[0]>Zt.MAX_ROWS_IN_BARCODE)return null;let I=new mi(g.getValue()[0],b.getValue()[0],S.getValue()[0],N.getValue()[0]);return this.removeIncorrectCodewords(h,I),I}removeIncorrectCodewords(h,g){for(let b=0;b<h.length;b++){let S=h[b];if(h[b]==null)continue;let N=S.getValue()%30,I=S.getRowNumber();if(I>g.getRowCount()){h[b]=null;continue}switch(this._isLeft||(I+=2),I%3){case 0:N*3+1!==g.getRowCountUpperPart()&&(h[b]=null);break;case 1:(Math.trunc(N/3)!==g.getErrorCorrectionLevel()||N%3!==g.getRowCountLowerPart())&&(h[b]=null);break;case 2:N+1!==g.getColumnCount()&&(h[b]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class ki{constructor(h,g){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=h,this.barcodeColumnCount=h.getColumnCount(),this.boundingBox=g,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let h=Zt.MAX_CODEWORDS_IN_BARCODE,g;do g=h,h=this.adjustRowNumbersAndGetCount();while(h>0&&h<g);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(h){h?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let h=this.adjustRowNumbersByRow();if(h===0)return 0;for(let g=1;g<this.barcodeColumnCount+1;g++){let b=this.detectionResultColumns[g].getCodewords();for(let S=0;S<b.length;S++)b[S]!=null&&(b[S].hasValidRowNumber()||this.adjustRowNumbers(g,S,b))}return h}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let h=this.detectionResultColumns[0].getCodewords(),g=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let b=0;b<h.length;b++)if(h[b]!=null&&g[b]!=null&&h[b].getRowNumber()===g[b].getRowNumber())for(let S=1;S<=this.barcodeColumnCount;S++){let N=this.detectionResultColumns[S].getCodewords()[b];N!=null&&(N.setRowNumber(h[b].getRowNumber()),N.hasValidRowNumber()||(this.detectionResultColumns[S].getCodewords()[b]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let h=0,g=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let b=0;b<g.length;b++){if(g[b]==null)continue;let S=g[b].getRowNumber(),N=0;for(let I=this.barcodeColumnCount+1;I>0&&N<this.ADJUST_ROW_NUMBER_SKIP;I--){let R=this.detectionResultColumns[I].getCodewords()[b];R!=null&&(N=ki.adjustRowNumberIfValid(S,N,R),R.hasValidRowNumber()||h++)}}return h}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let h=0,g=this.detectionResultColumns[0].getCodewords();for(let b=0;b<g.length;b++){if(g[b]==null)continue;let S=g[b].getRowNumber(),N=0;for(let I=1;I<this.barcodeColumnCount+1&&N<this.ADJUST_ROW_NUMBER_SKIP;I++){let R=this.detectionResultColumns[I].getCodewords()[b];R!=null&&(N=ki.adjustRowNumberIfValid(S,N,R),R.hasValidRowNumber()||h++)}}return h}static adjustRowNumberIfValid(h,g,b){return b==null||b.hasValidRowNumber()||(b.isValidRowNumber(h)?(b.setRowNumber(h),g=0):++g),g}adjustRowNumbers(h,g,b){if(!this.detectionResultColumns[h-1])return;let S=b[g],N=this.detectionResultColumns[h-1].getCodewords(),I=N;this.detectionResultColumns[h+1]!=null&&(I=this.detectionResultColumns[h+1].getCodewords());let R=new Array(14);R[2]=N[g],R[3]=I[g],g>0&&(R[0]=b[g-1],R[4]=N[g-1],R[5]=I[g-1]),g>1&&(R[8]=b[g-2],R[10]=N[g-2],R[11]=I[g-2]),g<b.length-1&&(R[1]=b[g+1],R[6]=N[g+1],R[7]=I[g+1]),g<b.length-2&&(R[9]=b[g+2],R[12]=N[g+2],R[13]=I[g+2]);for(let H of R)if(ki.adjustRowNumber(S,H))return}static adjustRowNumber(h,g){return g==null?!1:g.hasValidRowNumber()&&g.getBucket()===h.getBucket()?(h.setRowNumber(g.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(h){this.boundingBox=h}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(h,g){this.detectionResultColumns[h]=g}getDetectionResultColumn(h){return this.detectionResultColumns[h]}toString(){let h=this.detectionResultColumns[0];h==null&&(h=this.detectionResultColumns[this.barcodeColumnCount+1]);let g=new Ks;for(let b=0;b<h.getCodewords().length;b++){g.format("CW %3d:",b);for(let S=0;S<this.barcodeColumnCount+2;S++){if(this.detectionResultColumns[S]==null){g.format("    |   ");continue}let N=this.detectionResultColumns[S].getCodewords()[b];if(N==null){g.format("    |   ");continue}g.format(" %3d|%3d",N.getRowNumber(),N.getValue())}g.format("%n")}return g.toString()}}class ms{constructor(h,g,b,S){this.rowNumber=ms.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(h),this.endX=Math.trunc(g),this.bucket=Math.trunc(b),this.value=Math.trunc(S)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(h){return h!==ms.BARCODE_ROW_UNKNOWN&&this.bucket===h%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(h){this.rowNumber=h}toString(){return this.rowNumber+"|"+this.value}}ms.BARCODE_ROW_UNKNOWN=-1;class ji{static initialize(){for(let h=0;h<Zt.SYMBOL_TABLE.length;h++){let g=Zt.SYMBOL_TABLE[h],b=g&1;for(let S=0;S<Zt.BARS_IN_MODULE;S++){let N=0;for(;(g&1)===b;)N+=1,g>>=1;b=g&1,ji.RATIOS_TABLE[h]||(ji.RATIOS_TABLE[h]=new Array(Zt.BARS_IN_MODULE)),ji.RATIOS_TABLE[h][Zt.BARS_IN_MODULE-S-1]=Math.fround(N/Zt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(h){let g=ji.getDecodedCodewordValue(ji.sampleBitCounts(h));return g!==-1?g:ji.getClosestDecodedValue(h)}static sampleBitCounts(h){let g=yt.sum(h),b=new Int32Array(Zt.BARS_IN_MODULE),S=0,N=0;for(let I=0;I<Zt.MODULES_IN_CODEWORD;I++){let R=g/(2*Zt.MODULES_IN_CODEWORD)+I*g/Zt.MODULES_IN_CODEWORD;N+h[S]<=R&&(N+=h[S],S++),b[S]++}return b}static getDecodedCodewordValue(h){let g=ji.getBitValue(h);return Zt.getCodeword(g)===-1?-1:g}static getBitValue(h){let g=0;for(let b=0;b<h.length;b++)for(let S=0;S<h[b];S++)g=g<<1|(b%2===0?1:0);return Math.trunc(g)}static getClosestDecodedValue(h){let g=yt.sum(h),b=new Array(Zt.BARS_IN_MODULE);if(g>1)for(let I=0;I<b.length;I++)b[I]=Math.fround(h[I]/g);let S=rr.MAX_VALUE,N=-1;this.bSymbolTableReady||ji.initialize();for(let I=0;I<ji.RATIOS_TABLE.length;I++){let R=0,H=ji.RATIOS_TABLE[I];for(let ne=0;ne<Zt.BARS_IN_MODULE;ne++){let he=Math.fround(H[ne]-b[ne]);if(R+=Math.fround(he*he),R>=S)break}R<S&&(S=R,N=Zt.SYMBOL_TABLE[I])}return N}}ji.bSymbolTableReady=!1,ji.RATIOS_TABLE=new Array(Zt.SYMBOL_TABLE.length).map(je=>new Array(Zt.BARS_IN_MODULE));class Zo{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(h){this.segmentIndex=h}getFileId(){return this.fileId}setFileId(h){this.fileId=h}getOptionalData(){return this.optionalData}setOptionalData(h){this.optionalData=h}isLastSegment(){return this.lastSegment}setLastSegment(h){this.lastSegment=h}getSegmentCount(){return this.segmentCount}setSegmentCount(h){this.segmentCount=h}getSender(){return this.sender||null}setSender(h){this.sender=h}getAddressee(){return this.addressee||null}setAddressee(h){this.addressee=h}getFileName(){return this.fileName}setFileName(h){this.fileName=h}getFileSize(){return this.fileSize}setFileSize(h){this.fileSize=h}getChecksum(){return this.checksum}setChecksum(h){this.checksum=h}getTimestamp(){return this.timestamp}setTimestamp(h){this.timestamp=h}}class mn{static parseLong(h,g=void 0){return parseInt(h,g)}}class Gl extends d{}Gl.kind="NullPointerException";class xa{writeBytes(h){this.writeBytesOffset(h,0,h.length)}writeBytesOffset(h,g,b){if(h==null)throw new Gl;if(g<0||g>h.length||b<0||g+b>h.length||g+b<0)throw new A;if(b===0)return;for(let S=0;S<b;S++)this.write(h[g+S])}flush(){}close(){}}class ao extends d{}class Kl extends xa{constructor(h=32){if(super(),this.count=0,h<0)throw new p("Negative initial size: "+h);this.buf=new Uint8Array(h)}ensureCapacity(h){h-this.buf.length>0&&this.grow(h)}grow(h){let b=this.buf.length<<1;if(b-h<0&&(b=h),b<0){if(h<0)throw new ao;b=D.MAX_VALUE}this.buf=O.copyOfUint8Array(this.buf,b)}write(h){this.ensureCapacity(this.count+1),this.buf[this.count]=h,this.count+=1}writeBytesOffset(h,g,b){if(g<0||g>h.length||b<0||g+b-h.length>0)throw new A;this.ensureCapacity(this.count+b),C.arraycopy(h,g,this.buf,this.count,b),this.count+=b}writeTo(h){h.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return O.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(h){return h?typeof h=="string"?this.toString_string(h):this.toString_number(h):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(h){return new String(this.buf).toString()}toString_number(h){return new String(this.buf).toString()}close(){}}var Fn;(function(je){je[je.ALPHA=0]="ALPHA",je[je.LOWER=1]="LOWER",je[je.MIXED=2]="MIXED",je[je.PUNCT=3]="PUNCT",je[je.ALPHA_SHIFT=4]="ALPHA_SHIFT",je[je.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Fn||(Fn={}));function Eo(){if(typeof window<"u")return window.BigInt||null;if(typeof Rx<"u")return Rx.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let _o;function To(je){if(typeof _o>"u"&&(_o=Eo()),_o===null)throw new Error("BigInt is not supported!");return _o(je)}function Rl(){let je=[];je[0]=To(1);let h=To(900);je[1]=h;for(let g=2;g<16;g++)je[g]=je[g-1]*h;return je}class pt{static decode(h,g){let b=new re(""),S=F.ISO8859_1;b.enableDecoding(S);let N=1,I=h[N++],R=new Zo;for(;N<h[0];){switch(I){case pt.TEXT_COMPACTION_MODE_LATCH:N=pt.textCompaction(h,N,b);break;case pt.BYTE_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH_6:N=pt.byteCompaction(I,h,S,N,b);break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b.append(h[N++]);break;case pt.NUMERIC_COMPACTION_MODE_LATCH:N=pt.numericCompaction(h,N,b);break;case pt.ECI_CHARSET:F.getCharacterSetECIByValue(h[N++]);break;case pt.ECI_GENERAL_PURPOSE:N+=2;break;case pt.ECI_USER_DEFINED:N++;break;case pt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:N=pt.decodeMacroBlock(h,N,R);break;case pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pt.MACRO_PDF417_TERMINATOR:throw new $;default:N--,N=pt.textCompaction(h,N,b);break}if(N<h.length)I=h[N++];else throw $.getFormatInstance()}if(b.length()===0)throw $.getFormatInstance();let H=new ke(null,b.toString(),null,g);return H.setOther(R),H}static decodeMacroBlock(h,g,b){if(g+pt.NUMBER_OF_SEQUENCE_CODEWORDS>h[0])throw $.getFormatInstance();let S=new Int32Array(pt.NUMBER_OF_SEQUENCE_CODEWORDS);for(let R=0;R<pt.NUMBER_OF_SEQUENCE_CODEWORDS;R++,g++)S[R]=h[g];b.setSegmentIndex(D.parseInt(pt.decodeBase900toBase10(S,pt.NUMBER_OF_SEQUENCE_CODEWORDS)));let N=new re;g=pt.textCompaction(h,g,N),b.setFileId(N.toString());let I=-1;for(h[g]===pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(I=g+1);g<h[0];)switch(h[g]){case pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(g++,h[g]){case pt.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let R=new re;g=pt.textCompaction(h,g+1,R),b.setFileName(R.toString());break;case pt.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let H=new re;g=pt.textCompaction(h,g+1,H),b.setSender(H.toString());break;case pt.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let ne=new re;g=pt.textCompaction(h,g+1,ne),b.setAddressee(ne.toString());break;case pt.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let he=new re;g=pt.numericCompaction(h,g+1,he),b.setSegmentCount(D.parseInt(he.toString()));break;case pt.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let ve=new re;g=pt.numericCompaction(h,g+1,ve),b.setTimestamp(mn.parseLong(ve.toString()));break;case pt.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Ne=new re;g=pt.numericCompaction(h,g+1,Ne),b.setChecksum(D.parseInt(Ne.toString()));break;case pt.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Me=new re;g=pt.numericCompaction(h,g+1,Me),b.setFileSize(mn.parseLong(Me.toString()));break;default:throw $.getFormatInstance()}break;case pt.MACRO_PDF417_TERMINATOR:g++,b.setLastSegment(!0);break;default:throw $.getFormatInstance()}if(I!==-1){let R=g-I;b.isLastSegment()&&R--,b.setOptionalData(O.copyOfRange(h,I,I+R))}return g}static textCompaction(h,g,b){let S=new Int32Array((h[0]-g)*2),N=new Int32Array((h[0]-g)*2),I=0,R=!1;for(;g<h[0]&&!R;){let H=h[g++];if(H<pt.TEXT_COMPACTION_MODE_LATCH)S[I]=H/30,S[I+1]=H%30,I+=2;else switch(H){case pt.TEXT_COMPACTION_MODE_LATCH:S[I++]=pt.TEXT_COMPACTION_MODE_LATCH;break;case pt.BYTE_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH_6:case pt.NUMERIC_COMPACTION_MODE_LATCH:case pt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pt.MACRO_PDF417_TERMINATOR:g--,R=!0;break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:S[I]=pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,H=h[g++],N[I]=H,I++;break}}return pt.decodeTextCompaction(S,N,I,b),g}static decodeTextCompaction(h,g,b,S){let N=Fn.ALPHA,I=Fn.ALPHA,R=0;for(;R<b;){let H=h[R],ne="";switch(N){case Fn.ALPHA:if(H<26)ne=String.fromCharCode(65+H);else switch(H){case 26:ne=" ";break;case pt.LL:N=Fn.LOWER;break;case pt.ML:N=Fn.MIXED;break;case pt.PS:I=N,N=Fn.PUNCT_SHIFT;break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:S.append(g[R]);break;case pt.TEXT_COMPACTION_MODE_LATCH:N=Fn.ALPHA;break}break;case Fn.LOWER:if(H<26)ne=String.fromCharCode(97+H);else switch(H){case 26:ne=" ";break;case pt.AS:I=N,N=Fn.ALPHA_SHIFT;break;case pt.ML:N=Fn.MIXED;break;case pt.PS:I=N,N=Fn.PUNCT_SHIFT;break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:S.append(g[R]);break;case pt.TEXT_COMPACTION_MODE_LATCH:N=Fn.ALPHA;break}break;case Fn.MIXED:if(H<pt.PL)ne=pt.MIXED_CHARS[H];else switch(H){case pt.PL:N=Fn.PUNCT;break;case 26:ne=" ";break;case pt.LL:N=Fn.LOWER;break;case pt.AL:N=Fn.ALPHA;break;case pt.PS:I=N,N=Fn.PUNCT_SHIFT;break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:S.append(g[R]);break;case pt.TEXT_COMPACTION_MODE_LATCH:N=Fn.ALPHA;break}break;case Fn.PUNCT:if(H<pt.PAL)ne=pt.PUNCT_CHARS[H];else switch(H){case pt.PAL:N=Fn.ALPHA;break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:S.append(g[R]);break;case pt.TEXT_COMPACTION_MODE_LATCH:N=Fn.ALPHA;break}break;case Fn.ALPHA_SHIFT:if(N=I,H<26)ne=String.fromCharCode(65+H);else switch(H){case 26:ne=" ";break;case pt.TEXT_COMPACTION_MODE_LATCH:N=Fn.ALPHA;break}break;case Fn.PUNCT_SHIFT:if(N=I,H<pt.PAL)ne=pt.PUNCT_CHARS[H];else switch(H){case pt.PAL:N=Fn.ALPHA;break;case pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:S.append(g[R]);break;case pt.TEXT_COMPACTION_MODE_LATCH:N=Fn.ALPHA;break}break}ne!==""&&S.append(ne),R++}}static byteCompaction(h,g,b,S,N){let I=new Kl,R=0,H=0,ne=!1;switch(h){case pt.BYTE_COMPACTION_MODE_LATCH:let he=new Int32Array(6),ve=g[S++];for(;S<g[0]&&!ne;)switch(he[R++]=ve,H=900*H+ve,ve=g[S++],ve){case pt.TEXT_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH:case pt.NUMERIC_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH_6:case pt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pt.MACRO_PDF417_TERMINATOR:S--,ne=!0;break;default:if(R%5===0&&R>0){for(let Ne=0;Ne<6;++Ne)I.write(Number(To(H)>>To(8*(5-Ne))));H=0,R=0}break}S===g[0]&&ve<pt.TEXT_COMPACTION_MODE_LATCH&&(he[R++]=ve);for(let Ne=0;Ne<R;Ne++)I.write(he[Ne]);break;case pt.BYTE_COMPACTION_MODE_LATCH_6:for(;S<g[0]&&!ne;){let Ne=g[S++];if(Ne<pt.TEXT_COMPACTION_MODE_LATCH)R++,H=900*H+Ne;else switch(Ne){case pt.TEXT_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH:case pt.NUMERIC_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH_6:case pt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pt.MACRO_PDF417_TERMINATOR:S--,ne=!0;break}if(R%5===0&&R>0){for(let Me=0;Me<6;++Me)I.write(Number(To(H)>>To(8*(5-Me))));H=0,R=0}}break}return N.append(J.decode(I.toByteArray(),b)),S}static numericCompaction(h,g,b){let S=0,N=!1,I=new Int32Array(pt.MAX_NUMERIC_CODEWORDS);for(;g<h[0]&&!N;){let R=h[g++];if(g===h[0]&&(N=!0),R<pt.TEXT_COMPACTION_MODE_LATCH)I[S]=R,S++;else switch(R){case pt.TEXT_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH:case pt.BYTE_COMPACTION_MODE_LATCH_6:case pt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pt.MACRO_PDF417_TERMINATOR:g--,N=!0;break}(S%pt.MAX_NUMERIC_CODEWORDS===0||R===pt.NUMERIC_COMPACTION_MODE_LATCH||N)&&S>0&&(b.append(pt.decodeBase900toBase10(I,S)),S=0)}return g}static decodeBase900toBase10(h,g){let b=To(0);for(let N=0;N<g;N++)b+=pt.EXP900[g-N-1]*To(h[N]);let S=b.toString();if(S.charAt(0)!=="1")throw new $;return S.substring(1)}}pt.TEXT_COMPACTION_MODE_LATCH=900,pt.BYTE_COMPACTION_MODE_LATCH=901,pt.NUMERIC_COMPACTION_MODE_LATCH=902,pt.BYTE_COMPACTION_MODE_LATCH_6=924,pt.ECI_USER_DEFINED=925,pt.ECI_GENERAL_PURPOSE=926,pt.ECI_CHARSET=927,pt.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,pt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,pt.MACRO_PDF417_TERMINATOR=922,pt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,pt.MAX_NUMERIC_CODEWORDS=15,pt.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,pt.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,pt.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,pt.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,pt.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,pt.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,pt.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,pt.PL=25,pt.LL=27,pt.AS=27,pt.ML=28,pt.AL=28,pt.PS=29,pt.PAL=29,pt.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,pt.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",pt.EXP900=Eo()?Rl():[],pt.NUMBER_OF_SEQUENCE_CODEWORDS=2;class te{constructor(){}static decode(h,g,b,S,N,I,R){let H=new Xa(h,g,b,S,N),ne=null,he=null,ve;for(let qe=!0;;qe=!1){if(g!=null&&(ne=te.getRowIndicatorColumn(h,H,g,!0,I,R)),S!=null&&(he=te.getRowIndicatorColumn(h,H,S,!1,I,R)),ve=te.merge(ne,he),ve==null)throw le.getNotFoundInstance();let $e=ve.getBoundingBox();if(qe&&$e!=null&&($e.getMinY()<H.getMinY()||$e.getMaxY()>H.getMaxY()))H=$e;else break}ve.setBoundingBox(H);let Ne=ve.getBarcodeColumnCount()+1;ve.setDetectionResultColumn(0,ne),ve.setDetectionResultColumn(Ne,he);let Me=ne!=null;for(let qe=1;qe<=Ne;qe++){let $e=Me?qe:Ne-qe;if(ve.getDetectionResultColumn($e)!==void 0)continue;let Xe;$e===0||$e===Ne?Xe=new yc(H,$e===0):Xe=new Ja(H),ve.setDetectionResultColumn($e,Xe);let ct=-1,Tt=ct;for(let _t=H.getMinY();_t<=H.getMaxY();_t++){if(ct=te.getStartColumn(ve,$e,_t,Me),ct<0||ct>H.getMaxX()){if(Tt===-1)continue;ct=Tt}let At=te.detectCodeword(h,H.getMinX(),H.getMaxX(),Me,ct,_t,I,R);At!=null&&(Xe.setCodeword(_t,At),Tt=ct,I=Math.min(I,At.getWidth()),R=Math.max(R,At.getWidth()))}}return te.createDecoderResult(ve)}static merge(h,g){if(h==null&&g==null)return null;let b=te.getBarcodeMetadata(h,g);if(b==null)return null;let S=Xa.merge(te.adjustBoundingBox(h),te.adjustBoundingBox(g));return new ki(b,S)}static adjustBoundingBox(h){if(h==null)return null;let g=h.getRowHeights();if(g==null)return null;let b=te.getMax(g),S=0;for(let R of g)if(S+=b-R,R>0)break;let N=h.getCodewords();for(let R=0;S>0&&N[R]==null;R++)S--;let I=0;for(let R=g.length-1;R>=0&&(I+=b-g[R],!(g[R]>0));R--);for(let R=N.length-1;I>0&&N[R]==null;R--)I--;return h.getBoundingBox().addMissingRows(S,I,h.isLeft())}static getMax(h){let g=-1;for(let b of h)g=Math.max(g,b);return g}static getBarcodeMetadata(h,g){let b;if(h==null||(b=h.getBarcodeMetadata())==null)return g==null?null:g.getBarcodeMetadata();let S;return g==null||(S=g.getBarcodeMetadata())==null?b:b.getColumnCount()!==S.getColumnCount()&&b.getErrorCorrectionLevel()!==S.getErrorCorrectionLevel()&&b.getRowCount()!==S.getRowCount()?null:b}static getRowIndicatorColumn(h,g,b,S,N,I){let R=new yc(g,S);for(let H=0;H<2;H++){let ne=H===0?1:-1,he=Math.trunc(Math.trunc(b.getX()));for(let ve=Math.trunc(Math.trunc(b.getY()));ve<=g.getMaxY()&&ve>=g.getMinY();ve+=ne){let Ne=te.detectCodeword(h,0,h.getWidth(),S,he,ve,N,I);Ne!=null&&(R.setCodeword(ve,Ne),S?he=Ne.getStartX():he=Ne.getEndX())}}return R}static adjustCodewordCount(h,g){let b=g[0][1],S=b.getValue(),N=h.getBarcodeColumnCount()*h.getBarcodeRowCount()-te.getNumberOfECCodeWords(h.getBarcodeECLevel());if(S.length===0){if(N<1||N>Zt.MAX_CODEWORDS_IN_BARCODE)throw le.getNotFoundInstance();b.setValue(N)}else S[0]!==N&&b.setValue(N)}static createDecoderResult(h){let g=te.createBarcodeMatrix(h);te.adjustCodewordCount(h,g);let b=new Array,S=new Int32Array(h.getBarcodeRowCount()*h.getBarcodeColumnCount()),N=[],I=new Array;for(let H=0;H<h.getBarcodeRowCount();H++)for(let ne=0;ne<h.getBarcodeColumnCount();ne++){let he=g[H][ne+1].getValue(),ve=H*h.getBarcodeColumnCount()+ne;he.length===0?b.push(ve):he.length===1?S[ve]=he[0]:(I.push(ve),N.push(he))}let R=new Array(N.length);for(let H=0;H<R.length;H++)R[H]=N[H];return te.createDecoderResultFromAmbiguousValues(h.getBarcodeECLevel(),S,Zt.toIntArray(b),Zt.toIntArray(I),R)}static createDecoderResultFromAmbiguousValues(h,g,b,S,N){let I=new Int32Array(S.length),R=100;for(;R-- >0;){for(let H=0;H<I.length;H++)g[S[H]]=N[H][I[H]];try{return te.decodeCodewords(g,h,b)}catch(H){if(!(H instanceof v))throw H}if(I.length===0)throw v.getChecksumInstance();for(let H=0;H<I.length;H++)if(I[H]<N[H].length-1){I[H]++;break}else if(I[H]=0,H===I.length-1)throw v.getChecksumInstance()}throw v.getChecksumInstance()}static createBarcodeMatrix(h){let g=Array.from({length:h.getBarcodeRowCount()},()=>new Array(h.getBarcodeColumnCount()+2));for(let S=0;S<g.length;S++)for(let N=0;N<g[S].length;N++)g[S][N]=new Yo;let b=0;for(let S of h.getDetectionResultColumns()){if(S!=null){for(let N of S.getCodewords())if(N!=null){let I=N.getRowNumber();if(I>=0){if(I>=g.length)continue;g[I][b].setValue(N.getValue())}}}b++}return g}static isValidBarcodeColumn(h,g){return g>=0&&g<=h.getBarcodeColumnCount()+1}static getStartColumn(h,g,b,S){let N=S?1:-1,I=null;if(te.isValidBarcodeColumn(h,g-N)&&(I=h.getDetectionResultColumn(g-N).getCodeword(b)),I!=null)return S?I.getEndX():I.getStartX();if(I=h.getDetectionResultColumn(g).getCodewordNearby(b),I!=null)return S?I.getStartX():I.getEndX();if(te.isValidBarcodeColumn(h,g-N)&&(I=h.getDetectionResultColumn(g-N).getCodewordNearby(b)),I!=null)return S?I.getEndX():I.getStartX();let R=0;for(;te.isValidBarcodeColumn(h,g-N);){g-=N;for(let H of h.getDetectionResultColumn(g).getCodewords())if(H!=null)return(S?H.getEndX():H.getStartX())+N*R*(H.getEndX()-H.getStartX());R++}return S?h.getBoundingBox().getMinX():h.getBoundingBox().getMaxX()}static detectCodeword(h,g,b,S,N,I,R,H){N=te.adjustCodewordStartColumn(h,g,b,S,N,I);let ne=te.getModuleBitCount(h,g,b,S,N,I);if(ne==null)return null;let he,ve=yt.sum(ne);if(S)he=N+ve;else{for(let qe=0;qe<ne.length/2;qe++){let $e=ne[qe];ne[qe]=ne[ne.length-1-qe],ne[ne.length-1-qe]=$e}he=N,N=he-ve}if(!te.checkCodewordSkew(ve,R,H))return null;let Ne=ji.getDecodedValue(ne),Me=Zt.getCodeword(Ne);return Me===-1?null:new ms(N,he,te.getCodewordBucketNumber(Ne),Me)}static getModuleBitCount(h,g,b,S,N,I){let R=N,H=new Int32Array(8),ne=0,he=S?1:-1,ve=S;for(;(S?R<b:R>=g)&&ne<H.length;)h.get(R,I)===ve?(H[ne]++,R+=he):(ne++,ve=!ve);return ne===H.length||R===(S?b:g)&&ne===H.length-1?H:null}static getNumberOfECCodeWords(h){return 2<<h}static adjustCodewordStartColumn(h,g,b,S,N,I){let R=N,H=S?-1:1;for(let ne=0;ne<2;ne++){for(;(S?R>=g:R<b)&&S===h.get(R,I);){if(Math.abs(N-R)>te.CODEWORD_SKEW_SIZE)return N;R+=H}H=-H,S=!S}return R}static checkCodewordSkew(h,g,b){return g-te.CODEWORD_SKEW_SIZE<=h&&h<=b+te.CODEWORD_SKEW_SIZE}static decodeCodewords(h,g,b){if(h.length===0)throw $.getFormatInstance();let S=1<<g+1,N=te.correctErrors(h,b,S);te.verifyCodewordCount(h,S);let I=pt.decode(h,""+g);return I.setErrorsCorrected(N),I.setErasures(b.length),I}static correctErrors(h,g,b){if(g!=null&&g.length>b/2+te.MAX_ERRORS||b<0||b>te.MAX_EC_CODEWORDS)throw v.getChecksumInstance();return te.errorCorrection.decode(h,b,g)}static verifyCodewordCount(h,g){if(h.length<4)throw $.getFormatInstance();let b=h[0];if(b>h.length)throw $.getFormatInstance();if(b===0)if(g<h.length)h[0]=h.length-g;else throw $.getFormatInstance()}static getBitCountForCodeword(h){let g=new Int32Array(8),b=0,S=g.length-1;for(;!((h&1)!==b&&(b=h&1,S--,S<0));)g[S]++,h>>=1;return g}static getCodewordBucketNumber(h){return h instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(h):this.getCodewordBucketNumber_number(h)}static getCodewordBucketNumber_number(h){return te.getCodewordBucketNumber(te.getBitCountForCodeword(h))}static getCodewordBucketNumber_Int32Array(h){return(h[0]-h[2]+h[4]-h[6]+9)%9}static toString(h){let g=new Ks;for(let b=0;b<h.length;b++){g.format("Row %2d: ",b);for(let S=0;S<h[b].length;S++){let N=h[b][S];N.getValue().length===0?g.format("        ",null):g.format("%4d(%2d)",N.getValue()[0],N.getConfidence(N.getValue()[0]))}g.format("%n")}return g.toString()}}te.CODEWORD_SKEW_SIZE=2,te.MAX_ERRORS=3,te.MAX_EC_CODEWORDS=512,te.errorCorrection=new fs;class we{decode(h,g=null){let b=we.decode(h,g,!1);if(b==null||b.length===0||b[0]==null)throw le.getNotFoundInstance();return b[0]}decodeMultiple(h,g=null){try{return we.decode(h,g,!0)}catch(b){throw b instanceof $||b instanceof v?le.getNotFoundInstance():b}}static decode(h,g,b){const S=new Array,N=Lr.detectMultiple(h,g,b);for(const I of N.getPoints()){const R=te.decode(N.getBits(),I[4],I[5],I[6],I[7],we.getMinCodewordWidth(I),we.getMaxCodewordWidth(I)),H=new W(R.getText(),R.getRawBytes(),void 0,I,ge.PDF_417);H.putMetadata(Le.ERROR_CORRECTION_LEVEL,R.getECLevel());const ne=R.getOther();ne!=null&&H.putMetadata(Le.PDF417_EXTRA_METADATA,ne),S.push(H)}return S.map(I=>I)}static getMaxWidth(h,g){return h==null||g==null?0:Math.trunc(Math.abs(h.getX()-g.getX()))}static getMinWidth(h,g){return h==null||g==null?D.MAX_VALUE:Math.trunc(Math.abs(h.getX()-g.getX()))}static getMaxCodewordWidth(h){return Math.floor(Math.max(Math.max(we.getMaxWidth(h[0],h[4]),we.getMaxWidth(h[6],h[2])*Zt.MODULES_IN_CODEWORD/Zt.MODULES_IN_STOP_PATTERN),Math.max(we.getMaxWidth(h[1],h[5]),we.getMaxWidth(h[7],h[3])*Zt.MODULES_IN_CODEWORD/Zt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(h){return Math.floor(Math.min(Math.min(we.getMinWidth(h[0],h[4]),we.getMinWidth(h[6],h[2])*Zt.MODULES_IN_CODEWORD/Zt.MODULES_IN_STOP_PATTERN),Math.min(we.getMinWidth(h[1],h[5]),we.getMinWidth(h[7],h[3])*Zt.MODULES_IN_CODEWORD/Zt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Re extends d{}Re.kind="ReaderException";class We{constructor(h,g){this.verbose=h===!0,g&&this.setHints(g)}decode(h,g){return g&&this.setHints(g),this.decodeInternal(h)}decodeWithState(h){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(h)}setHints(h){this.hints=h;const g=!i(h)&&h.get(U.TRY_HARDER)===!0,b=i(h)?null:h.get(U.POSSIBLE_FORMATS),S=new Array;if(!i(b)){const N=b.some(I=>I===ge.UPC_A||I===ge.UPC_E||I===ge.EAN_13||I===ge.EAN_8||I===ge.CODABAR||I===ge.CODE_39||I===ge.CODE_93||I===ge.CODE_128||I===ge.ITF||I===ge.RSS_14||I===ge.RSS_EXPANDED);N&&!g&&S.push(new us(h,this.verbose)),b.includes(ge.QR_CODE)&&S.push(new ca),b.includes(ge.DATA_MATRIX)&&S.push(new Bn),b.includes(ge.AZTEC)&&S.push(new fr),b.includes(ge.PDF_417)&&S.push(new we),N&&g&&S.push(new us(h,this.verbose))}S.length===0&&(g||S.push(new us(h,this.verbose)),S.push(new ca),S.push(new Bn),S.push(new fr),S.push(new we),g&&S.push(new us(h,this.verbose))),this.readers=S}reset(){if(this.readers!==null)for(const h of this.readers)h.reset()}decodeInternal(h){if(this.readers===null)throw new Re("No readers where selected, nothing can be read.");for(const g of this.readers)try{return g.decode(h,this.hints)}catch(b){if(b instanceof Re)continue}throw new le("No MultiFormat Readers were able to detect the code.")}}class et extends se{constructor(h=null,g=500){const b=new We;b.setHints(h),super(b,g)}decodeBitmap(h){return this.reader.decodeWithState(h)}}class Ct extends se{constructor(h=500){super(new we,h)}}class Lt extends se{constructor(h=500){super(new ca,h)}}var ar;(function(je){je[je.ERROR_CORRECTION=0]="ERROR_CORRECTION",je[je.CHARACTER_SET=1]="CHARACTER_SET",je[je.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",je[je.MIN_SIZE=3]="MIN_SIZE",je[je.MAX_SIZE=4]="MAX_SIZE",je[je.MARGIN=5]="MARGIN",je[je.PDF417_COMPACT=6]="PDF417_COMPACT",je[je.PDF417_COMPACTION=7]="PDF417_COMPACTION",je[je.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",je[je.AZTEC_LAYERS=9]="AZTEC_LAYERS",je[je.QR_VERSION=10]="QR_VERSION"})(ar||(ar={}));var Gt=ar;class Ur{constructor(h){this.field=h,this.cachedGenerators=[],this.cachedGenerators.push(new Je(h,Int32Array.from([1])))}buildGenerator(h){const g=this.cachedGenerators;if(h>=g.length){let b=g[g.length-1];const S=this.field;for(let N=g.length;N<=h;N++){const I=b.multiply(new Je(S,Int32Array.from([1,S.exp(N-1+S.getGeneratorBase())])));g.push(I),b=I}}return g[h]}encode(h,g){if(g===0)throw new p("No error correction bytes");const b=h.length-g;if(b<=0)throw new p("No data bytes provided");const S=this.buildGenerator(g),N=new Int32Array(b);C.arraycopy(h,0,N,0,b);let I=new Je(this.field,N);I=I.multiplyByMonomial(g,1);const H=I.divide(S)[1].getCoefficients(),ne=g-H.length;for(let he=0;he<ne;he++)h[b+he]=0;C.arraycopy(H,0,h,b+ne,H.length)}}class lr{constructor(){}static applyMaskPenaltyRule1(h){return lr.applyMaskPenaltyRule1Internal(h,!0)+lr.applyMaskPenaltyRule1Internal(h,!1)}static applyMaskPenaltyRule2(h){let g=0;const b=h.getArray(),S=h.getWidth(),N=h.getHeight();for(let I=0;I<N-1;I++){const R=b[I];for(let H=0;H<S-1;H++){const ne=R[H];ne===R[H+1]&&ne===b[I+1][H]&&ne===b[I+1][H+1]&&g++}}return lr.N2*g}static applyMaskPenaltyRule3(h){let g=0;const b=h.getArray(),S=h.getWidth(),N=h.getHeight();for(let I=0;I<N;I++)for(let R=0;R<S;R++){const H=b[I];R+6<S&&H[R]===1&&H[R+1]===0&&H[R+2]===1&&H[R+3]===1&&H[R+4]===1&&H[R+5]===0&&H[R+6]===1&&(lr.isWhiteHorizontal(H,R-4,R)||lr.isWhiteHorizontal(H,R+7,R+11))&&g++,I+6<N&&b[I][R]===1&&b[I+1][R]===0&&b[I+2][R]===1&&b[I+3][R]===1&&b[I+4][R]===1&&b[I+5][R]===0&&b[I+6][R]===1&&(lr.isWhiteVertical(b,R,I-4,I)||lr.isWhiteVertical(b,R,I+7,I+11))&&g++}return g*lr.N3}static isWhiteHorizontal(h,g,b){g=Math.max(g,0),b=Math.min(b,h.length);for(let S=g;S<b;S++)if(h[S]===1)return!1;return!0}static isWhiteVertical(h,g,b,S){b=Math.max(b,0),S=Math.min(S,h.length);for(let N=b;N<S;N++)if(h[N][g]===1)return!1;return!0}static applyMaskPenaltyRule4(h){let g=0;const b=h.getArray(),S=h.getWidth(),N=h.getHeight();for(let H=0;H<N;H++){const ne=b[H];for(let he=0;he<S;he++)ne[he]===1&&g++}const I=h.getHeight()*h.getWidth();return Math.floor(Math.abs(g*2-I)*10/I)*lr.N4}static getDataMaskBit(h,g,b){let S,N;switch(h){case 0:S=b+g&1;break;case 1:S=b&1;break;case 2:S=g%3;break;case 3:S=(b+g)%3;break;case 4:S=Math.floor(b/2)+Math.floor(g/3)&1;break;case 5:N=b*g,S=(N&1)+N%3;break;case 6:N=b*g,S=(N&1)+N%3&1;break;case 7:N=b*g,S=N%3+(b+g&1)&1;break;default:throw new p("Invalid mask pattern: "+h)}return S===0}static applyMaskPenaltyRule1Internal(h,g){let b=0;const S=g?h.getHeight():h.getWidth(),N=g?h.getWidth():h.getHeight(),I=h.getArray();for(let R=0;R<S;R++){let H=0,ne=-1;for(let he=0;he<N;he++){const ve=g?I[R][he]:I[he][R];ve===ne?H++:(H>=5&&(b+=lr.N1+(H-5)),H=1,ne=ve)}H>=5&&(b+=lr.N1+(H-5))}return b}}lr.N1=3,lr.N2=3,lr.N3=40,lr.N4=10;class Sn{constructor(h,g){this.width=h,this.height=g;const b=new Array(g);for(let S=0;S!==g;S++)b[S]=new Uint8Array(h);this.bytes=b}getHeight(){return this.height}getWidth(){return this.width}get(h,g){return this.bytes[g][h]}getArray(){return this.bytes}setNumber(h,g,b){this.bytes[g][h]=b}setBoolean(h,g,b){this.bytes[g][h]=b?1:0}clear(h){for(const g of this.bytes)O.fill(g,h)}equals(h){if(!(h instanceof Sn))return!1;const g=h;if(this.width!==g.width||this.height!==g.height)return!1;for(let b=0,S=this.height;b<S;++b){const N=this.bytes[b],I=g.bytes[b];for(let R=0,H=this.width;R<H;++R)if(N[R]!==I[R])return!1}return!0}toString(){const h=new re;for(let g=0,b=this.height;g<b;++g){const S=this.bytes[g];for(let N=0,I=this.width;N<I;++N)switch(S[N]){case 0:h.append(" 0");break;case 1:h.append(" 1");break;default:h.append("  ");break}h.append(`
`)}return h.toString()}}class ei{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const h=new re;return h.append(`<<
`),h.append(" mode: "),h.append(this.mode?this.mode.toString():"null"),h.append(`
 ecLevel: `),h.append(this.ecLevel?this.ecLevel.toString():"null"),h.append(`
 version: `),h.append(this.version?this.version.toString():"null"),h.append(`
 maskPattern: `),h.append(this.maskPattern.toString()),this.matrix?(h.append(`
 matrix:
`),h.append(this.matrix.toString())):h.append(`
 matrix: null
`),h.append(`>>
`),h.toString()}setMode(h){this.mode=h}setECLevel(h){this.ecLevel=h}setVersion(h){this.version=h}setMaskPattern(h){this.maskPattern=h}setMatrix(h){this.matrix=h}static isValidMaskPattern(h){return h>=0&&h<ei.NUM_MASK_PATTERNS}}ei.NUM_MASK_PATTERNS=8;class Zr extends d{}Zr.kind="WriterException";class Xt{constructor(){}static clearMatrix(h){h.clear(255)}static buildMatrix(h,g,b,S,N){Xt.clearMatrix(N),Xt.embedBasicPatterns(b,N),Xt.embedTypeInfo(g,S,N),Xt.maybeEmbedVersionInfo(b,N),Xt.embedDataBits(h,S,N)}static embedBasicPatterns(h,g){Xt.embedPositionDetectionPatternsAndSeparators(g),Xt.embedDarkDotAtLeftBottomCorner(g),Xt.maybeEmbedPositionAdjustmentPatterns(h,g),Xt.embedTimingPatterns(g)}static embedTypeInfo(h,g,b){const S=new M;Xt.makeTypeInfoBits(h,g,S);for(let N=0,I=S.getSize();N<I;++N){const R=S.get(S.getSize()-1-N),H=Xt.TYPE_INFO_COORDINATES[N],ne=H[0],he=H[1];if(b.setBoolean(ne,he,R),N<8){const ve=b.getWidth()-N-1;b.setBoolean(ve,8,R)}else{const Ne=b.getHeight()-7+(N-8);b.setBoolean(8,Ne,R)}}}static maybeEmbedVersionInfo(h,g){if(h.getVersionNumber()<7)return;const b=new M;Xt.makeVersionInfoBits(h,b);let S=17;for(let N=0;N<6;++N)for(let I=0;I<3;++I){const R=b.get(S);S--,g.setBoolean(N,g.getHeight()-11+I,R),g.setBoolean(g.getHeight()-11+I,N,R)}}static embedDataBits(h,g,b){let S=0,N=-1,I=b.getWidth()-1,R=b.getHeight()-1;for(;I>0;){for(I===6&&(I-=1);R>=0&&R<b.getHeight();){for(let H=0;H<2;++H){const ne=I-H;if(!Xt.isEmpty(b.get(ne,R)))continue;let he;S<h.getSize()?(he=h.get(S),++S):he=!1,g!==255&&lr.getDataMaskBit(g,ne,R)&&(he=!he),b.setBoolean(ne,R,he)}R+=N}N=-N,R+=N,I-=2}if(S!==h.getSize())throw new Zr("Not all bits consumed: "+S+"/"+h.getSize())}static findMSBSet(h){return 32-D.numberOfLeadingZeros(h)}static calculateBCHCode(h,g){if(g===0)throw new p("0 polynomial");const b=Xt.findMSBSet(g);for(h<<=b-1;Xt.findMSBSet(h)>=b;)h^=g<<Xt.findMSBSet(h)-b;return h}static makeTypeInfoBits(h,g,b){if(!ei.isValidMaskPattern(g))throw new Zr("Invalid mask pattern");const S=h.getBits()<<3|g;b.appendBits(S,5);const N=Xt.calculateBCHCode(S,Xt.TYPE_INFO_POLY);b.appendBits(N,10);const I=new M;if(I.appendBits(Xt.TYPE_INFO_MASK_PATTERN,15),b.xor(I),b.getSize()!==15)throw new Zr("should not happen but we got: "+b.getSize())}static makeVersionInfoBits(h,g){g.appendBits(h.getVersionNumber(),6);const b=Xt.calculateBCHCode(h.getVersionNumber(),Xt.VERSION_INFO_POLY);if(g.appendBits(b,12),g.getSize()!==18)throw new Zr("should not happen but we got: "+g.getSize())}static isEmpty(h){return h===255}static embedTimingPatterns(h){for(let g=8;g<h.getWidth()-8;++g){const b=(g+1)%2;Xt.isEmpty(h.get(g,6))&&h.setNumber(g,6,b),Xt.isEmpty(h.get(6,g))&&h.setNumber(6,g,b)}}static embedDarkDotAtLeftBottomCorner(h){if(h.get(8,h.getHeight()-8)===0)throw new Zr;h.setNumber(8,h.getHeight()-8,1)}static embedHorizontalSeparationPattern(h,g,b){for(let S=0;S<8;++S){if(!Xt.isEmpty(b.get(h+S,g)))throw new Zr;b.setNumber(h+S,g,0)}}static embedVerticalSeparationPattern(h,g,b){for(let S=0;S<7;++S){if(!Xt.isEmpty(b.get(h,g+S)))throw new Zr;b.setNumber(h,g+S,0)}}static embedPositionAdjustmentPattern(h,g,b){for(let S=0;S<5;++S){const N=Xt.POSITION_ADJUSTMENT_PATTERN[S];for(let I=0;I<5;++I)b.setNumber(h+I,g+S,N[I])}}static embedPositionDetectionPattern(h,g,b){for(let S=0;S<7;++S){const N=Xt.POSITION_DETECTION_PATTERN[S];for(let I=0;I<7;++I)b.setNumber(h+I,g+S,N[I])}}static embedPositionDetectionPatternsAndSeparators(h){const g=Xt.POSITION_DETECTION_PATTERN[0].length;Xt.embedPositionDetectionPattern(0,0,h),Xt.embedPositionDetectionPattern(h.getWidth()-g,0,h),Xt.embedPositionDetectionPattern(0,h.getWidth()-g,h);const b=8;Xt.embedHorizontalSeparationPattern(0,b-1,h),Xt.embedHorizontalSeparationPattern(h.getWidth()-b,b-1,h),Xt.embedHorizontalSeparationPattern(0,h.getWidth()-b,h);const S=7;Xt.embedVerticalSeparationPattern(S,0,h),Xt.embedVerticalSeparationPattern(h.getHeight()-S-1,0,h),Xt.embedVerticalSeparationPattern(S,h.getHeight()-S,h)}static maybeEmbedPositionAdjustmentPatterns(h,g){if(h.getVersionNumber()<2)return;const b=h.getVersionNumber()-1,S=Xt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[b];for(let N=0,I=S.length;N!==I;N++){const R=S[N];if(R>=0)for(let H=0;H!==I;H++){const ne=S[H];ne>=0&&Xt.isEmpty(g.get(ne,R))&&Xt.embedPositionAdjustmentPattern(ne-2,R-2,g)}}}}Xt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Xt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Xt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Xt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Xt.VERSION_INFO_POLY=7973,Xt.TYPE_INFO_POLY=1335,Xt.TYPE_INFO_MASK_PATTERN=21522;class va{constructor(h,g){this.dataBytes=h,this.errorCorrectionBytes=g}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class rn{constructor(){}static calculateMaskPenalty(h){return lr.applyMaskPenaltyRule1(h)+lr.applyMaskPenaltyRule2(h)+lr.applyMaskPenaltyRule3(h)+lr.applyMaskPenaltyRule4(h)}static encode(h,g,b=null){let S=rn.DEFAULT_BYTE_MODE_ENCODING;const N=b!==null&&b.get(Gt.CHARACTER_SET)!==void 0;N&&(S=b.get(Gt.CHARACTER_SET).toString());const I=this.chooseMode(h,S),R=new M;if(I===Cr.BYTE&&(N||rn.DEFAULT_BYTE_MODE_ENCODING!==S)){const _t=F.getCharacterSetECIByName(S);_t!==void 0&&this.appendECI(_t,R)}this.appendModeInfo(I,R);const H=new M;this.appendBytes(h,I,H,S);let ne;if(b!==null&&b.get(Gt.QR_VERSION)!==void 0){const _t=Number.parseInt(b.get(Gt.QR_VERSION).toString(),10);ne=Ht.getVersionForNumber(_t);const At=this.calculateBitsNeeded(I,R,H,ne);if(!this.willFit(At,ne,g))throw new Zr("Data too big for requested version")}else ne=this.recommendVersion(g,I,R,H);const he=new M;he.appendBitArray(R);const ve=I===Cr.BYTE?H.getSizeInBytes():h.length;this.appendLengthInfo(ve,ne,I,he),he.appendBitArray(H);const Ne=ne.getECBlocksForLevel(g),Me=ne.getTotalCodewords()-Ne.getTotalECCodewords();this.terminateBits(Me,he);const qe=this.interleaveWithECBytes(he,ne.getTotalCodewords(),Me,Ne.getNumBlocks()),$e=new ei;$e.setECLevel(g),$e.setMode(I),$e.setVersion(ne);const Xe=ne.getDimensionForVersion(),ct=new Sn(Xe,Xe),Tt=this.chooseMaskPattern(qe,g,ne,ct);return $e.setMaskPattern(Tt),Xt.buildMatrix(qe,g,ne,Tt,ct),$e.setMatrix(ct),$e}static recommendVersion(h,g,b,S){const N=this.calculateBitsNeeded(g,b,S,Ht.getVersionForNumber(1)),I=this.chooseVersion(N,h),R=this.calculateBitsNeeded(g,b,S,I);return this.chooseVersion(R,h)}static calculateBitsNeeded(h,g,b,S){return g.getSize()+h.getCharacterCountBits(S)+b.getSize()}static getAlphanumericCode(h){return h<rn.ALPHANUMERIC_TABLE.length?rn.ALPHANUMERIC_TABLE[h]:-1}static chooseMode(h,g=null){if(F.SJIS.getName()===g&&this.isOnlyDoubleByteKanji(h))return Cr.KANJI;let b=!1,S=!1;for(let N=0,I=h.length;N<I;++N){const R=h.charAt(N);if(rn.isDigit(R))b=!0;else if(this.getAlphanumericCode(R.charCodeAt(0))!==-1)S=!0;else return Cr.BYTE}return S?Cr.ALPHANUMERIC:b?Cr.NUMERIC:Cr.BYTE}static isOnlyDoubleByteKanji(h){let g;try{g=J.encode(h,F.SJIS)}catch{return!1}const b=g.length;if(b%2!==0)return!1;for(let S=0;S<b;S+=2){const N=g[S]&255;if((N<129||N>159)&&(N<224||N>235))return!1}return!0}static chooseMaskPattern(h,g,b,S){let N=Number.MAX_SAFE_INTEGER,I=-1;for(let R=0;R<ei.NUM_MASK_PATTERNS;R++){Xt.buildMatrix(h,g,b,R,S);let H=this.calculateMaskPenalty(S);H<N&&(N=H,I=R)}return I}static chooseVersion(h,g){for(let b=1;b<=40;b++){const S=Ht.getVersionForNumber(b);if(rn.willFit(h,S,g))return S}throw new Zr("Data too big")}static willFit(h,g,b){const S=g.getTotalCodewords(),I=g.getECBlocksForLevel(b).getTotalECCodewords(),R=S-I,H=(h+7)/8;return R>=H}static terminateBits(h,g){const b=h*8;if(g.getSize()>b)throw new Zr("data bits cannot fit in the QR Code"+g.getSize()+" > "+b);for(let I=0;I<4&&g.getSize()<b;++I)g.appendBit(!1);const S=g.getSize()&7;if(S>0)for(let I=S;I<8;I++)g.appendBit(!1);const N=h-g.getSizeInBytes();for(let I=0;I<N;++I)g.appendBits((I&1)===0?236:17,8);if(g.getSize()!==b)throw new Zr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(h,g,b,S,N,I){if(S>=b)throw new Zr("Block ID too large");const R=h%b,H=b-R,ne=Math.floor(h/b),he=ne+1,ve=Math.floor(g/b),Ne=ve+1,Me=ne-ve,qe=he-Ne;if(Me!==qe)throw new Zr("EC bytes mismatch");if(b!==H+R)throw new Zr("RS blocks mismatch");if(h!==(ve+Me)*H+(Ne+qe)*R)throw new Zr("Total bytes mismatch");S<H?(N[0]=ve,I[0]=Me):(N[0]=Ne,I[0]=qe)}static interleaveWithECBytes(h,g,b,S){if(h.getSizeInBytes()!==b)throw new Zr("Number of bits and data bytes does not match");let N=0,I=0,R=0;const H=new Array;for(let he=0;he<S;++he){const ve=new Int32Array(1),Ne=new Int32Array(1);rn.getNumDataBytesAndNumECBytesForBlockID(g,b,S,he,ve,Ne);const Me=ve[0],qe=new Uint8Array(Me);h.toBytes(8*N,qe,0,Me);const $e=rn.generateECBytes(qe,Ne[0]);H.push(new va(qe,$e)),I=Math.max(I,Me),R=Math.max(R,$e.length),N+=ve[0]}if(b!==N)throw new Zr("Data bytes does not match offset");const ne=new M;for(let he=0;he<I;++he)for(const ve of H){const Ne=ve.getDataBytes();he<Ne.length&&ne.appendBits(Ne[he],8)}for(let he=0;he<R;++he)for(const ve of H){const Ne=ve.getErrorCorrectionBytes();he<Ne.length&&ne.appendBits(Ne[he],8)}if(g!==ne.getSizeInBytes())throw new Zr("Interleaving error: "+g+" and "+ne.getSizeInBytes()+" differ.");return ne}static generateECBytes(h,g){const b=h.length,S=new Int32Array(b+g);for(let I=0;I<b;I++)S[I]=h[I]&255;new Ur(vt.QR_CODE_FIELD_256).encode(S,g);const N=new Uint8Array(g);for(let I=0;I<g;I++)N[I]=S[b+I];return N}static appendModeInfo(h,g){g.appendBits(h.getBits(),4)}static appendLengthInfo(h,g,b,S){const N=b.getCharacterCountBits(g);if(h>=1<<N)throw new Zr(h+" is bigger than "+((1<<N)-1));S.appendBits(h,N)}static appendBytes(h,g,b,S){switch(g){case Cr.NUMERIC:rn.appendNumericBytes(h,b);break;case Cr.ALPHANUMERIC:rn.appendAlphanumericBytes(h,b);break;case Cr.BYTE:rn.append8BitBytes(h,b,S);break;case Cr.KANJI:rn.appendKanjiBytes(h,b);break;default:throw new Zr("Invalid mode: "+g)}}static getDigit(h){return h.charCodeAt(0)-48}static isDigit(h){const g=rn.getDigit(h);return g>=0&&g<=9}static appendNumericBytes(h,g){const b=h.length;let S=0;for(;S<b;){const N=rn.getDigit(h.charAt(S));if(S+2<b){const I=rn.getDigit(h.charAt(S+1)),R=rn.getDigit(h.charAt(S+2));g.appendBits(N*100+I*10+R,10),S+=3}else if(S+1<b){const I=rn.getDigit(h.charAt(S+1));g.appendBits(N*10+I,7),S+=2}else g.appendBits(N,4),S++}}static appendAlphanumericBytes(h,g){const b=h.length;let S=0;for(;S<b;){const N=rn.getAlphanumericCode(h.charCodeAt(S));if(N===-1)throw new Zr;if(S+1<b){const I=rn.getAlphanumericCode(h.charCodeAt(S+1));if(I===-1)throw new Zr;g.appendBits(N*45+I,11),S+=2}else g.appendBits(N,6),S++}}static append8BitBytes(h,g,b){let S;try{S=J.encode(h,b)}catch(N){throw new Zr(N)}for(let N=0,I=S.length;N!==I;N++){const R=S[N];g.appendBits(R,8)}}static appendKanjiBytes(h,g){let b;try{b=J.encode(h,F.SJIS)}catch(N){throw new Zr(N)}const S=b.length;for(let N=0;N<S;N+=2){const I=b[N]&255,R=b[N+1]&255,H=I<<8&4294967295|R;let ne=-1;if(H>=33088&&H<=40956?ne=H-33088:H>=57408&&H<=60351&&(ne=H-49472),ne===-1)throw new Zr("Invalid byte sequence");const he=(ne>>8)*192+(ne&255);g.appendBits(he,13)}}static appendECI(h,g){g.appendBits(Cr.ECI.getBits(),4),g.appendBits(h.getValue(),8)}}rn.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),rn.DEFAULT_BYTE_MODE_ENCODING=F.UTF8.getName();class Ei{write(h,g,b,S=null){if(h.length===0)throw new p("Found empty contents");if(g<0||b<0)throw new p("Requested dimensions are too small: "+g+"x"+b);let N=kr.L,I=Ei.QUIET_ZONE_SIZE;S!==null&&(S.get(Gt.ERROR_CORRECTION)!==void 0&&(N=kr.fromString(S.get(Gt.ERROR_CORRECTION).toString())),S.get(Gt.MARGIN)!==void 0&&(I=Number.parseInt(S.get(Gt.MARGIN).toString(),10)));const R=rn.encode(h,N,S);return this.renderResult(R,g,b,I)}writeToDom(h,g,b,S,N=null){typeof h=="string"&&(h=document.querySelector(h));const I=this.write(g,b,S,N);h&&h.appendChild(I)}renderResult(h,g,b,S){const N=h.getMatrix();if(N===null)throw new Oe;const I=N.getWidth(),R=N.getHeight(),H=I+S*2,ne=R+S*2,he=Math.max(g,H),ve=Math.max(b,ne),Ne=Math.min(Math.floor(he/H),Math.floor(ve/ne)),Me=Math.floor((he-I*Ne)/2),qe=Math.floor((ve-R*Ne)/2),$e=this.createSVGElement(he,ve);for(let Xe=0,ct=qe;Xe<R;Xe++,ct+=Ne)for(let Tt=0,_t=Me;Tt<I;Tt++,_t+=Ne)if(N.get(Tt,Xe)===1){const At=this.createSvgRectElement(_t,ct,Ne,Ne);$e.appendChild(At)}return $e}createSVGElement(h,g){const b=document.createElementNS(Ei.SVG_NS,"svg");return b.setAttributeNS(null,"height",h.toString()),b.setAttributeNS(null,"width",g.toString()),b}createSvgRectElement(h,g,b,S){const N=document.createElementNS(Ei.SVG_NS,"rect");return N.setAttributeNS(null,"x",h.toString()),N.setAttributeNS(null,"y",g.toString()),N.setAttributeNS(null,"height",b.toString()),N.setAttributeNS(null,"width",S.toString()),N.setAttributeNS(null,"fill","#000000"),N}}Ei.QUIET_ZONE_SIZE=4,Ei.SVG_NS="http://www.w3.org/2000/svg";class es{encode(h,g,b,S,N){if(h.length===0)throw new p("Found empty contents");if(g!==ge.QR_CODE)throw new p("Can only encode QR_CODE, but got "+g);if(b<0||S<0)throw new p(`Requested dimensions are too small: ${b}x${S}`);let I=kr.L,R=es.QUIET_ZONE_SIZE;N!==null&&(N.get(Gt.ERROR_CORRECTION)!==void 0&&(I=kr.fromString(N.get(Gt.ERROR_CORRECTION).toString())),N.get(Gt.MARGIN)!==void 0&&(R=Number.parseInt(N.get(Gt.MARGIN).toString(),10)));const H=rn.encode(h,I,N);return es.renderResult(H,b,S,R)}static renderResult(h,g,b,S){const N=h.getMatrix();if(N===null)throw new Oe;const I=N.getWidth(),R=N.getHeight(),H=I+S*2,ne=R+S*2,he=Math.max(g,H),ve=Math.max(b,ne),Ne=Math.min(Math.floor(he/H),Math.floor(ve/ne)),Me=Math.floor((he-I*Ne)/2),qe=Math.floor((ve-R*Ne)/2),$e=new de(he,ve);for(let Xe=0,ct=qe;Xe<R;Xe++,ct+=Ne)for(let Tt=0,_t=Me;Tt<I;Tt++,_t+=Ne)N.get(Tt,Xe)===1&&$e.setRegion(_t,ct,Ne,Ne);return $e}}es.QUIET_ZONE_SIZE=4;class ts{encode(h,g,b,S,N){let I;if(g===ge.QR_CODE)I=new es;else throw new p("No encoder available for format "+g);return I.encode(h,g,b,S,N)}}class Da extends ce{constructor(h,g,b,S,N,I,R,H){if(super(I,R),this.yuvData=h,this.dataWidth=g,this.dataHeight=b,this.left=S,this.top=N,S+I>g||N+R>b)throw new p("Crop rectangle does not fit within image data.");H&&this.reverseHorizontal(I,R)}getRow(h,g){if(h<0||h>=this.getHeight())throw new p("Requested row is outside the image: "+h);const b=this.getWidth();(g==null||g.length<b)&&(g=new Uint8ClampedArray(b));const S=(h+this.top)*this.dataWidth+this.left;return C.arraycopy(this.yuvData,S,g,0,b),g}getMatrix(){const h=this.getWidth(),g=this.getHeight();if(h===this.dataWidth&&g===this.dataHeight)return this.yuvData;const b=h*g,S=new Uint8ClampedArray(b);let N=this.top*this.dataWidth+this.left;if(h===this.dataWidth)return C.arraycopy(this.yuvData,N,S,0,b),S;for(let I=0;I<g;I++){const R=I*h;C.arraycopy(this.yuvData,N,S,R,h),N+=this.dataWidth}return S}isCropSupported(){return!0}crop(h,g,b,S){return new Da(this.yuvData,this.dataWidth,this.dataHeight,this.left+h,this.top+g,b,S,!1)}renderThumbnail(){const h=this.getWidth()/Da.THUMBNAIL_SCALE_FACTOR,g=this.getHeight()/Da.THUMBNAIL_SCALE_FACTOR,b=new Int32Array(h*g),S=this.yuvData;let N=this.top*this.dataWidth+this.left;for(let I=0;I<g;I++){const R=I*h;for(let H=0;H<h;H++){const ne=S[N+H*Da.THUMBNAIL_SCALE_FACTOR]&255;b[R+H]=4278190080|ne*65793}N+=this.dataWidth*Da.THUMBNAIL_SCALE_FACTOR}return b}getThumbnailWidth(){return this.getWidth()/Da.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Da.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(h,g){const b=this.yuvData;for(let S=0,N=this.top*this.dataWidth+this.left;S<g;S++,N+=this.dataWidth){const I=N+h/2;for(let R=N,H=N+h-1;R<I;R++,H--){const ne=b[R];b[R]=b[H],b[H]=ne}}}invert(){return new ye(this)}}Da.THUMBNAIL_SCALE_FACTOR=2;class Xo extends ce{constructor(h,g,b,S,N,I,R){if(super(g,b),this.dataWidth=S,this.dataHeight=N,this.left=I,this.top=R,h.BYTES_PER_ELEMENT===4){const H=g*b,ne=new Uint8ClampedArray(H);for(let he=0;he<H;he++){const ve=h[he],Ne=ve>>16&255,Me=ve>>7&510,qe=ve&255;ne[he]=(Ne+Me+qe)/4&255}this.luminances=ne}else this.luminances=h;if(S===void 0&&(this.dataWidth=g),N===void 0&&(this.dataHeight=b),I===void 0&&(this.left=0),R===void 0&&(this.top=0),this.left+g>this.dataWidth||this.top+b>this.dataHeight)throw new p("Crop rectangle does not fit within image data.")}getRow(h,g){if(h<0||h>=this.getHeight())throw new p("Requested row is outside the image: "+h);const b=this.getWidth();(g==null||g.length<b)&&(g=new Uint8ClampedArray(b));const S=(h+this.top)*this.dataWidth+this.left;return C.arraycopy(this.luminances,S,g,0,b),g}getMatrix(){const h=this.getWidth(),g=this.getHeight();if(h===this.dataWidth&&g===this.dataHeight)return this.luminances;const b=h*g,S=new Uint8ClampedArray(b);let N=this.top*this.dataWidth+this.left;if(h===this.dataWidth)return C.arraycopy(this.luminances,N,S,0,b),S;for(let I=0;I<g;I++){const R=I*h;C.arraycopy(this.luminances,N,S,R,h),N+=this.dataWidth}return S}isCropSupported(){return!0}crop(h,g,b,S){return new Xo(this.luminances,b,S,this.dataWidth,this.dataHeight,this.left+h,this.top+g)}invert(){return new ye(this)}}class Pa extends F{static forName(h){return this.getCharacterSetECIByName(h)}}class so{}so.ISO_8859_1=F.ISO8859_1;class oo{isCompact(){return this.compact}setCompact(h){this.compact=h}getSize(){return this.size}setSize(h){this.size=h}getLayers(){return this.layers}setLayers(h){this.layers=h}getCodeWords(){return this.codeWords}setCodeWords(h){this.codeWords=h}getMatrix(){return this.matrix}setMatrix(h){this.matrix=h}}class Ql{static singletonList(h){return[h]}static min(h,g){return h.sort(g)[0]}}class Jo{constructor(h){this.previous=h}getPrevious(){return this.previous}}class wi extends Jo{constructor(h,g,b){super(h),this.value=g,this.bitCount=b}appendTo(h,g){h.appendBits(this.value,this.bitCount)}add(h,g){return new wi(this,h,g)}addBinaryShift(h,g){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new wi(this,h,g)}toString(){let h=this.value&(1<<this.bitCount)-1;return h|=1<<this.bitCount,"<"+D.toBinaryString(h|1<<this.bitCount).substring(1)+">"}}class pl extends wi{constructor(h,g,b){super(h,0,0),this.binaryShiftStart=g,this.binaryShiftByteCount=b}appendTo(h,g){for(let b=0;b<this.binaryShiftByteCount;b++)(b===0||b===31&&this.binaryShiftByteCount<=62)&&(h.appendBits(31,5),this.binaryShiftByteCount>62?h.appendBits(this.binaryShiftByteCount-31,16):b===0?h.appendBits(Math.min(this.binaryShiftByteCount,31),5):h.appendBits(this.binaryShiftByteCount-31,5)),h.appendBits(g[this.binaryShiftStart+b],8)}addBinaryShift(h,g){return new pl(this,h,g)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Yl(je,h,g){return new pl(je,h,g)}function el(je,h,g){return new wi(je,h,g)}const gl=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],qn=0,rs=1,ns=2,Qs=3,qi=4,ps=new wi(null,0,0),tl=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Ml(je){for(let h of je)O.fill(h,-1);return je[qn][qi]=0,je[rs][qi]=0,je[rs][qn]=28,je[Qs][qi]=0,je[ns][qi]=0,je[ns][qn]=15,je}const lo=Ml(O.createInt32Array(6,6));class da{constructor(h,g,b,S){this.token=h,this.mode=g,this.binaryShiftByteCount=b,this.bitCount=S}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(h,g){let b=this.bitCount,S=this.token;if(h!==this.mode){let I=tl[this.mode][h];S=el(S,I&65535,I>>16),b+=I>>16}let N=h===ns?4:5;return S=el(S,g,N),new da(S,h,0,b+N)}shiftAndAppend(h,g){let b=this.token,S=this.mode===ns?4:5;return b=el(b,lo[this.mode][h],S),b=el(b,g,5),new da(b,this.mode,0,this.bitCount+S+5)}addBinaryShiftChar(h){let g=this.token,b=this.mode,S=this.bitCount;if(this.mode===qi||this.mode===ns){let R=tl[b][qn];g=el(g,R&65535,R>>16),S+=R>>16,b=qn}let N=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,I=new da(g,b,this.binaryShiftByteCount+1,S+N);return I.binaryShiftByteCount===2078&&(I=I.endBinaryShift(h+1)),I}endBinaryShift(h){if(this.binaryShiftByteCount===0)return this;let g=this.token;return g=Yl(g,h-this.binaryShiftByteCount,this.binaryShiftByteCount),new da(g,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(h){let g=this.bitCount+(tl[this.mode][h.mode]>>16);return this.binaryShiftByteCount<h.binaryShiftByteCount?g+=da.calculateBinaryShiftCost(h)-da.calculateBinaryShiftCost(this):this.binaryShiftByteCount>h.binaryShiftByteCount&&h.binaryShiftByteCount>0&&(g+=10),g<=h.bitCount}toBitArray(h){let g=[];for(let S=this.endBinaryShift(h.length).token;S!==null;S=S.getPrevious())g.unshift(S);let b=new M;for(const S of g)S.appendTo(b,h);return b}toString(){return Z.format("%s bits=%d bytes=%d",gl[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(h){return h.binaryShiftByteCount>62?21:h.binaryShiftByteCount>31?20:h.binaryShiftByteCount>0?10:0}}da.INITIAL_STATE=new da(ps,qn,0,0);function Ys(je){const h=Z.getCharCode(" "),g=Z.getCharCode("."),b=Z.getCharCode(",");je[qn][h]=1;const S=Z.getCharCode("Z"),N=Z.getCharCode("A");for(let Ne=N;Ne<=S;Ne++)je[qn][Ne]=Ne-N+2;je[rs][h]=1;const I=Z.getCharCode("z"),R=Z.getCharCode("a");for(let Ne=R;Ne<=I;Ne++)je[rs][Ne]=Ne-R+2;je[ns][h]=1;const H=Z.getCharCode("9"),ne=Z.getCharCode("0");for(let Ne=ne;Ne<=H;Ne++)je[ns][Ne]=Ne-ne+2;je[ns][b]=12,je[ns][g]=13;const he=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Ne=0;Ne<he.length;Ne++)je[Qs][Z.getCharCode(he[Ne])]=Ne;const ve=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Ne=0;Ne<ve.length;Ne++)Z.getCharCode(ve[Ne])>0&&(je[qi][Z.getCharCode(ve[Ne])]=Ne);return je}const _i=Ys(O.createInt32Array(5,256));class is{constructor(h){this.text=h}encode(){const h=Z.getCharCode(" "),g=Z.getCharCode(`
`);let b=Ql.singletonList(da.INITIAL_STATE);for(let N=0;N<this.text.length;N++){let I,R=N+1<this.text.length?this.text[N+1]:0;switch(this.text[N]){case Z.getCharCode("\r"):I=R===g?2:0;break;case Z.getCharCode("."):I=R===h?3:0;break;case Z.getCharCode(","):I=R===h?4:0;break;case Z.getCharCode(":"):I=R===h?5:0;break;default:I=0}I>0?(b=is.updateStateListForPair(b,N,I),N++):b=this.updateStateListForChar(b,N)}return Ql.min(b,(N,I)=>N.getBitCount()-I.getBitCount()).toBitArray(this.text)}updateStateListForChar(h,g){const b=[];for(let S of h)this.updateStateForChar(S,g,b);return is.simplifyStates(b)}updateStateForChar(h,g,b){let S=this.text[g]&255,N=_i[h.getMode()][S]>0,I=null;for(let R=0;R<=qi;R++){let H=_i[R][S];if(H>0){if(I==null&&(I=h.endBinaryShift(g)),!N||R===h.getMode()||R===ns){const ne=I.latchAndAppend(R,H);b.push(ne)}if(!N&&lo[h.getMode()][R]>=0){const ne=I.shiftAndAppend(R,H);b.push(ne)}}}if(h.getBinaryShiftByteCount()>0||_i[h.getMode()][S]===0){let R=h.addBinaryShiftChar(g);b.push(R)}}static updateStateListForPair(h,g,b){const S=[];for(let N of h)this.updateStateForPair(N,g,b,S);return this.simplifyStates(S)}static updateStateForPair(h,g,b,S){let N=h.endBinaryShift(g);if(S.push(N.latchAndAppend(qi,b)),h.getMode()!==qi&&S.push(N.shiftAndAppend(qi,b)),b===3||b===4){let I=N.latchAndAppend(ns,16-b).latchAndAppend(ns,1);S.push(I)}if(h.getBinaryShiftByteCount()>0){let I=h.addBinaryShiftChar(g).addBinaryShiftChar(g+1);S.push(I)}}static simplifyStates(h){let g=[];for(const b of h){let S=!0;for(const N of g){if(N.isBetterThanOrEqualTo(b)){S=!1;break}b.isBetterThanOrEqualTo(N)&&(g=g.filter(I=>I!==N))}S&&g.push(b)}return g}}class ln{constructor(){}static encodeBytes(h){return ln.encode(h,ln.DEFAULT_EC_PERCENT,ln.DEFAULT_AZTEC_LAYERS)}static encode(h,g,b){let S=new is(h).encode(),N=D.truncDivision(S.getSize()*g,100)+11,I=S.getSize()+N,R,H,ne,he,ve;if(b!==ln.DEFAULT_AZTEC_LAYERS){if(R=b<0,H=Math.abs(b),H>(R?ln.MAX_NB_BITS_COMPACT:ln.MAX_NB_BITS))throw new p(Z.format("Illegal value %s for layers",b));ne=ln.totalBitsInLayer(H,R),he=ln.WORD_SIZE[H];let At=ne-ne%he;if(ve=ln.stuffBits(S,he),ve.getSize()+N>At)throw new p("Data to large for user specified layer");if(R&&ve.getSize()>he*64)throw new p("Data to large for user specified layer")}else{he=0,ve=null;for(let At=0;;At++){if(At>ln.MAX_NB_BITS)throw new p("Data too large for an Aztec code");if(R=At<=3,H=R?At+1:At,ne=ln.totalBitsInLayer(H,R),I>ne)continue;(ve==null||he!==ln.WORD_SIZE[H])&&(he=ln.WORD_SIZE[H],ve=ln.stuffBits(S,he));let Tr=ne-ne%he;if(!(R&&ve.getSize()>he*64)&&ve.getSize()+N<=Tr)break}}let Ne=ln.generateCheckWords(ve,ne,he),Me=ve.getSize()/he,qe=ln.generateModeMessage(R,H,Me),$e=(R?11:14)+H*4,Xe=new Int32Array($e),ct;if(R){ct=$e;for(let At=0;At<Xe.length;At++)Xe[At]=At}else{ct=$e+1+2*D.truncDivision(D.truncDivision($e,2)-1,15);let At=D.truncDivision($e,2),Tr=D.truncDivision(ct,2);for(let qr=0;qr<At;qr++){let Mn=qr+D.truncDivision(qr,15);Xe[At-qr-1]=Tr-Mn-1,Xe[At+qr]=Tr+Mn+1}}let Tt=new de(ct);for(let At=0,Tr=0;At<H;At++){let qr=(H-At)*4+(R?9:12);for(let Mn=0;Mn<qr;Mn++){let ua=Mn*2;for(let Ra=0;Ra<2;Ra++)Ne.get(Tr+ua+Ra)&&Tt.set(Xe[At*2+Ra],Xe[At*2+Mn]),Ne.get(Tr+qr*2+ua+Ra)&&Tt.set(Xe[At*2+Mn],Xe[$e-1-At*2-Ra]),Ne.get(Tr+qr*4+ua+Ra)&&Tt.set(Xe[$e-1-At*2-Ra],Xe[$e-1-At*2-Mn]),Ne.get(Tr+qr*6+ua+Ra)&&Tt.set(Xe[$e-1-At*2-Mn],Xe[At*2+Ra])}Tr+=qr*8}if(ln.drawModeMessage(Tt,R,ct,qe),R)ln.drawBullsEye(Tt,D.truncDivision(ct,2),5);else{ln.drawBullsEye(Tt,D.truncDivision(ct,2),7);for(let At=0,Tr=0;At<D.truncDivision($e,2)-1;At+=15,Tr+=16)for(let qr=D.truncDivision(ct,2)&1;qr<ct;qr+=2)Tt.set(D.truncDivision(ct,2)-Tr,qr),Tt.set(D.truncDivision(ct,2)+Tr,qr),Tt.set(qr,D.truncDivision(ct,2)-Tr),Tt.set(qr,D.truncDivision(ct,2)+Tr)}let _t=new oo;return _t.setCompact(R),_t.setSize(ct),_t.setLayers(H),_t.setCodeWords(Me),_t.setMatrix(Tt),_t}static drawBullsEye(h,g,b){for(let S=0;S<b;S+=2)for(let N=g-S;N<=g+S;N++)h.set(N,g-S),h.set(N,g+S),h.set(g-S,N),h.set(g+S,N);h.set(g-b,g-b),h.set(g-b+1,g-b),h.set(g-b,g-b+1),h.set(g+b,g-b),h.set(g+b,g-b+1),h.set(g+b,g+b-1)}static generateModeMessage(h,g,b){let S=new M;return h?(S.appendBits(g-1,2),S.appendBits(b-1,6),S=ln.generateCheckWords(S,28,4)):(S.appendBits(g-1,5),S.appendBits(b-1,11),S=ln.generateCheckWords(S,40,4)),S}static drawModeMessage(h,g,b,S){let N=D.truncDivision(b,2);if(g)for(let I=0;I<7;I++){let R=N-3+I;S.get(I)&&h.set(R,N-5),S.get(I+7)&&h.set(N+5,R),S.get(20-I)&&h.set(R,N+5),S.get(27-I)&&h.set(N-5,R)}else for(let I=0;I<10;I++){let R=N-5+I+D.truncDivision(I,5);S.get(I)&&h.set(R,N-7),S.get(I+10)&&h.set(N+7,R),S.get(29-I)&&h.set(R,N+7),S.get(39-I)&&h.set(N-7,R)}}static generateCheckWords(h,g,b){let S=h.getSize()/b,N=new Ur(ln.getGF(b)),I=D.truncDivision(g,b),R=ln.bitsToWords(h,b,I);N.encode(R,I-S);let H=g%b,ne=new M;ne.appendBits(0,H);for(const he of Array.from(R))ne.appendBits(he,b);return ne}static bitsToWords(h,g,b){let S=new Int32Array(b),N,I;for(N=0,I=h.getSize()/g;N<I;N++){let R=0;for(let H=0;H<g;H++)R|=h.get(N*g+H)?1<<g-H-1:0;S[N]=R}return S}static getGF(h){switch(h){case 4:return vt.AZTEC_PARAM;case 6:return vt.AZTEC_DATA_6;case 8:return vt.AZTEC_DATA_8;case 10:return vt.AZTEC_DATA_10;case 12:return vt.AZTEC_DATA_12;default:throw new p("Unsupported word size "+h)}}static stuffBits(h,g){let b=new M,S=h.getSize(),N=(1<<g)-2;for(let I=0;I<S;I+=g){let R=0;for(let H=0;H<g;H++)(I+H>=S||h.get(I+H))&&(R|=1<<g-1-H);(R&N)===N?(b.appendBits(R&N,g),I--):(R&N)===0?(b.appendBits(R|1,g),I--):b.appendBits(R,g)}return b}static totalBitsInLayer(h,g){return((g?88:112)+16*h)*h}}ln.DEFAULT_EC_PERCENT=33,ln.DEFAULT_AZTEC_LAYERS=0,ln.MAX_NB_BITS=32,ln.MAX_NB_BITS_COMPACT=4,ln.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Zs{encode(h,g,b,S){return this.encodeWithHints(h,g,b,S,null)}encodeWithHints(h,g,b,S,N){let I=so.ISO_8859_1,R=ln.DEFAULT_EC_PERCENT,H=ln.DEFAULT_AZTEC_LAYERS;return N!=null&&(N.has(Gt.CHARACTER_SET)&&(I=Pa.forName(N.get(Gt.CHARACTER_SET).toString())),N.has(Gt.ERROR_CORRECTION)&&(R=D.parseInt(N.get(Gt.ERROR_CORRECTION).toString())),N.has(Gt.AZTEC_LAYERS)&&(H=D.parseInt(N.get(Gt.AZTEC_LAYERS).toString()))),Zs.encodeLayers(h,g,b,S,I,R,H)}static encodeLayers(h,g,b,S,N,I,R){if(g!==ge.AZTEC)throw new p("Can only encode AZTEC, but got "+g);let H=ln.encode(Z.getBytes(h,N),I,R);return Zs.renderResult(H,b,S)}static renderResult(h,g,b){let S=h.getMatrix();if(S==null)throw new Oe;let N=S.getWidth(),I=S.getHeight(),R=Math.max(g,N),H=Math.max(b,I),ne=Math.min(R/N,H/I),he=(R-N*ne)/2,ve=(H-I*ne)/2,Ne=new de(R,H);for(let Me=0,qe=ve;Me<I;Me++,qe+=ne)for(let $e=0,Xe=he;$e<N;$e++,Xe+=ne)S.get($e,Me)&&Ne.setRegion(Xe,qe,ne,ne);return Ne}}n.AbstractExpandedDecoder=Yn,n.ArgumentException=f,n.ArithmeticException=Qe,n.AztecCode=oo,n.AztecCodeReader=fr,n.AztecCodeWriter=Zs,n.AztecDecoder=Bt,n.AztecDetector=tn,n.AztecDetectorResult=hr,n.AztecEncoder=ln,n.AztecHighLevelEncoder=is,n.AztecPoint=tr,n.BarcodeFormat=ge,n.Binarizer=w,n.BinaryBitmap=x,n.BitArray=M,n.BitMatrix=de,n.BitSource=hs,n.BrowserAztecCodeReader=Yi,n.BrowserBarcodeReader=kl,n.BrowserCodeReader=se,n.BrowserDatamatrixCodeReader=Ya,n.BrowserMultiFormatReader=et,n.BrowserPDF417Reader=Ct,n.BrowserQRCodeReader=Lt,n.BrowserQRCodeSvgWriter=Ei,n.CharacterSetECI=F,n.ChecksumException=v,n.Code128Reader=wt,n.Code39Reader=sr,n.DataMatrixDecodedBitStreamParser=Qa,n.DataMatrixReader=Bn,n.DecodeHintType=U,n.DecoderResult=ke,n.DefaultGridSampler=xn,n.DetectorResult=xr,n.EAN13Reader=Qr,n.EncodeHintType=Gt,n.Exception=d,n.FormatException=$,n.GenericGF=vt,n.GenericGFPoly=Je,n.GlobalHistogramBinarizer=K,n.GridSampler=yn,n.GridSamplerInstance=Yr,n.HTMLCanvasElementLuminanceSource=Se,n.HybridBinarizer=ue,n.ITFReader=ur,n.IllegalArgumentException=p,n.IllegalStateException=Oe,n.InvertedLuminanceSource=ye,n.LuminanceSource=ce,n.MathUtils=yt,n.MultiFormatOneDReader=us,n.MultiFormatReader=We,n.MultiFormatWriter=ts,n.NotFoundException=le,n.OneDReader=Er,n.PDF417DecodedBitStreamParser=pt,n.PDF417DecoderErrorCorrection=fs,n.PDF417Reader=we,n.PDF417ResultMetadata=Zo,n.PerspectiveTransform=Or,n.PlanarYUVLuminanceSource=Da,n.QRCodeByteMatrix=Sn,n.QRCodeDataMask=la,n.QRCodeDecodedBitStreamParser=Jn,n.QRCodeDecoderErrorCorrectionLevel=kr,n.QRCodeDecoderFormatInformation=ea,n.QRCodeEncoder=rn,n.QRCodeEncoderQRCode=ei,n.QRCodeMaskUtil=lr,n.QRCodeMatrixUtil=Xt,n.QRCodeMode=Cr,n.QRCodeReader=ca,n.QRCodeVersion=Ht,n.QRCodeWriter=es,n.RGBLuminanceSource=Xo,n.RSS14Reader=zn,n.RSSExpandedReader=Rt,n.ReaderException=Re,n.ReedSolomonDecoder=st,n.ReedSolomonEncoder=Ur,n.ReedSolomonException=Pt,n.Result=W,n.ResultMetadataType=Le,n.ResultPoint=St,n.StringUtils=Z,n.UnsupportedOperationException=Y,n.VideoInputDevice=V,n.WhiteRectangleDetector=zr,n.WriterException=Zr,n.ZXingArrays=O,n.ZXingCharset=Pa,n.ZXingInteger=D,n.ZXingStandardCharsets=so,n.ZXingStringBuilder=re,n.ZXingStringEncoding=J,n.ZXingSystem=C,n.createAbstractExpandedDecoder=Ko,Object.defineProperty(n,"__esModule",{value:!0})}))})(Cg,Cg.exports)),Cg.exports}var Na=AAe();const EAe=hc(Na),_Ae=KM({__proto__:null,default:EAe},[Na]);var OM=(function(){function t(r,n,i){if(this.formatMap=new Map([[mr.QR_CODE,Na.BarcodeFormat.QR_CODE],[mr.AZTEC,Na.BarcodeFormat.AZTEC],[mr.CODABAR,Na.BarcodeFormat.CODABAR],[mr.CODE_39,Na.BarcodeFormat.CODE_39],[mr.CODE_93,Na.BarcodeFormat.CODE_93],[mr.CODE_128,Na.BarcodeFormat.CODE_128],[mr.DATA_MATRIX,Na.BarcodeFormat.DATA_MATRIX],[mr.MAXICODE,Na.BarcodeFormat.MAXICODE],[mr.ITF,Na.BarcodeFormat.ITF],[mr.EAN_13,Na.BarcodeFormat.EAN_13],[mr.EAN_8,Na.BarcodeFormat.EAN_8],[mr.PDF_417,Na.BarcodeFormat.PDF_417],[mr.RSS_14,Na.BarcodeFormat.RSS_14],[mr.RSS_EXPANDED,Na.BarcodeFormat.RSS_EXPANDED],[mr.UPC_A,Na.BarcodeFormat.UPC_A],[mr.UPC_E,Na.BarcodeFormat.UPC_E],[mr.UPC_EAN_EXTENSION,Na.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!_Ae)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=i;var a=this.createZXingFormats(r),s=new Map;s.set(Na.DecodeHintType.POSSIBLE_FORMATS,a),s.set(Na.DecodeHintType.TRY_HARDER,!1),this.hints=s}return t.prototype.decodeAsync=function(r){var n=this;return new Promise(function(i,a){try{i(n.decode(r))}catch(s){a(s)}})},t.prototype.decode=function(r){var n=new Na.MultiFormatReader(this.verbose,this.hints),i=new Na.HTMLCanvasElementLuminanceSource(r),a=new Na.BinaryBitmap(new Na.HybridBinarizer(i)),s=n.decode(a);return{text:s.text,format:cH.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(n,i,a){r.set(n,i)}),r},t.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},t.prototype.createZXingFormats=function(r){for(var n=[],i=0,a=r;i<a.length;i++){var s=a[i];this.formatMap.has(s)?n.push(this.formatMap.get(s)):this.logger.logError("".concat(s," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t})(),TAe=function(t,r,n,i){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(f){try{d(i.next(f))}catch(p){o(p)}}function u(f){try{d(i.throw(f))}catch(p){o(p)}}function d(f){f.done?s(f.value):a(f.value).then(l,u)}d((i=i.apply(t,r||[])).next())})},IAe=function(t,r){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(f){return u([d,f])}}function u(d){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(n=0)),n;)try{if(i=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,a=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){n.label=d[1];break}if(d[0]===6&&n.label<s[1]){n.label=s[1],s=d;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(d);break}s[2]&&n.ops.pop(),n.trys.pop();continue}d=r.call(t,n)}catch(f){d=[6,f],a=0}finally{i=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},kM=(function(){function t(r,n,i){if(this.formatMap=new Map([[mr.QR_CODE,"qr_code"],[mr.AZTEC,"aztec"],[mr.CODABAR,"codabar"],[mr.CODE_39,"code_39"],[mr.CODE_93,"code_93"],[mr.CODE_128,"code_128"],[mr.DATA_MATRIX,"data_matrix"],[mr.ITF,"itf"],[mr.EAN_13,"ean_13"],[mr.EAN_8,"ean_8"],[mr.PDF_417,"pdf417"],[mr.UPC_A,"upc_a"],[mr.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=i;var a=this.createBarcodeDetectorFormats(r);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var r=new BarcodeDetector({formats:["qr_code"]});return typeof r<"u"},t.prototype.decodeAsync=function(r){return TAe(this,void 0,void 0,function(){var n,i;return IAe(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(r)];case 1:if(n=a.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(n),[2,{text:i.rawValue,format:cH.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(r){for(var n=null,i=0,a=0,s=r;a<s.length;a++){var o=s[a],l=o.boundingBox.width*o.boundingBox.height;l>i&&(i=l,n=o)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(r){for(var n=[],i=0,a=r;i<a.length;i++){var s=a[i];this.formatMap.has(s)?n.push(this.formatMap.get(s)):this.logger.warn("".concat(s," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(r){if(!this.reverseFormatMap.has(r))throw"reverseFormatMap doesn't have ".concat(r);return this.reverseFormatMap.get(r)},t.prototype.createReverseFormatMap=function(){var r=new Map;return this.formatMap.forEach(function(n,i,a){r.set(n,i)}),r},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t})(),DM=function(t,r,n,i){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(f){try{d(i.next(f))}catch(p){o(p)}}function u(f){try{d(i.throw(f))}catch(p){o(p)}}function d(f){f.done?s(f.value):a(f.value).then(l,u)}d((i=i.apply(t,r||[])).next())})},PM=function(t,r){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(f){return u([d,f])}}function u(d){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(n=0)),n;)try{if(i=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,a=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){n.label=d[1];break}if(d[0]===6&&n.label<s[1]){n.label=s[1],s=d;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(d);break}s[2]&&n.ops.pop(),n.trys.pop();continue}d=r.call(t,n)}catch(f){d=[6,f],a=0}finally{i=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},OAe=(function(){function t(r,n,i,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,n&&kM.isSupported()?(this.primaryDecoder=new kM(r,i,a),this.secondaryDecoder=new OM(r,i,a)):this.primaryDecoder=new OM(r,i,a)}return t.prototype.decodeAsync=function(r){return DM(this,void 0,void 0,function(){var n;return PM(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(r)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(r){return DM(this,void 0,void 0,function(){var n,i;return PM(this,function(a){switch(a.label){case 0:n=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(r)];case 2:return[2,a.sent()];case 3:if(i=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(r)];throw i;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(r){if(this.verbose){var n=performance.now()-r;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var r=0,n=0,i=this.executionResults;n<i.length;n++){var a=i[n];r+=a}var s=r/this.executionResults.length;console.log("".concat(s," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t})(),n3=(function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(i[s]=a[s])},t(r,n)};return function(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(r,n);function i(){this.constructor=r}r.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}})(),Vb=function(t,r,n,i){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(f){try{d(i.next(f))}catch(p){o(p)}}function u(f){try{d(i.throw(f))}catch(p){o(p)}}function d(f){f.done?s(f.value):a(f.value).then(l,u)}d((i=i.apply(t,r||[])).next())})},$b=function(t,r){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(f){return u([d,f])}}function u(d){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(n=0)),n;)try{if(i=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,a=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){n.label=d[1];break}if(d[0]===6&&n.label<s[1]){n.label=s[1],s=d;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(d);break}s[2]&&n.ops.pop(),n.trys.pop();continue}d=r.call(t,n)}catch(f){d=[6,f],a=0}finally{i=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},uH=(function(){function t(r,n){this.name=r,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(r){var n={};n[this.name]=r;var i={advanced:[n]};return this.track.applyConstraints(i)},t.prototype.value=function(){var r=this.track.getSettings();if(this.name in r){var n=r[this.name];return n}return null},t})(),kAe=(function(t){n3(r,t);function r(n,i){return t.call(this,n,i)||this}return r.prototype.min=function(){return this.getCapabilities().min},r.prototype.max=function(){return this.getCapabilities().max},r.prototype.step=function(){return this.getCapabilities().step},r.prototype.apply=function(n){var i={};i[this.name]=n;var a={advanced:[i]};return this.track.applyConstraints(a)},r.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),i=n[this.name];return{min:i.min,max:i.max,step:i.step}},r.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},r})(uH),DAe=(function(t){n3(r,t);function r(n){return t.call(this,"zoom",n)||this}return r})(kAe),PAe=(function(t){n3(r,t);function r(n){return t.call(this,"torch",n)||this}return r})(uH),RAe=(function(){function t(r){this.track=r}return t.prototype.zoomFeature=function(){return new DAe(this.track)},t.prototype.torchFeature=function(){return new PAe(this.track)},t})(),MAe=(function(){function t(r,n,i){this.isClosed=!1,this.parentElement=r,this.mediaStream=n,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),r.append(this.surface)}return t.prototype.createVideoElement=function(r){var n=document.createElement("video");return n.style.width="".concat(r,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var r=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var i=r.surface.clientWidth,a=r.surface.clientHeight;r.callbacks.onRenderSurfaceReady(i,a),r.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(r,n,i,a){return Vb(this,void 0,void 0,function(){var s,o;return $b(this,function(l){switch(l.label){case 0:return s=new t(r,n,a),i.aspectRatio?(o={aspectRatio:i.aspectRatio},[4,s.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:l.sent(),l.label=2;case 2:return s.setupSurface(),[2,s]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(r){this.failIfClosed();var n=this,i=function(){setTimeout(r,200),n.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(r){return Vb(this,void 0,void 0,function(){return $b(this,function(n){if("aspectRatio"in r)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(r)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var r=this;return new Promise(function(n,i){var a=r.mediaStream.getVideoTracks(),s=a.length,o=0;r.mediaStream.getVideoTracks().forEach(function(l){r.mediaStream.removeTrack(l),l.stop(),++o,o>=s&&(r.isClosed=!0,r.parentElement.removeChild(r.surface),n())})})},t.prototype.getCapabilities=function(){return new RAe(this.getFirstTrackOrFail())},t})(),LAe=(function(){function t(r){this.mediaStream=r}return t.prototype.render=function(r,n,i){return Vb(this,void 0,void 0,function(){return $b(this,function(a){return[2,MAe.create(r,this.mediaStream,n,i)]})})},t.create=function(r){return Vb(this,void 0,void 0,function(){var n,i;return $b(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:r},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return i=a.sent(),[2,new t(i)]}})})},t})(),RM=function(t,r,n,i){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(f){try{d(i.next(f))}catch(p){o(p)}}function u(f){try{d(i.throw(f))}catch(p){o(p)}}function d(f){f.done?s(f.value):a(f.value).then(l,u)}d((i=i.apply(t,r||[])).next())})},MM=function(t,r){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(f){return u([d,f])}}function u(d){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(n=0)),n;)try{if(i=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,a=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){n.label=d[1];break}if(d[0]===6&&n.label<s[1]){n.label=s[1],s=d;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(d);break}s[2]&&n.ops.pop(),n.trys.pop();continue}d=r.call(t,n)}catch(f){d=[6,f],a=0}finally{i=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},zAe=(function(){function t(){}return t.failIfNotSupported=function(){return RM(this,void 0,void 0,function(){return MM(this,function(r){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(r){return RM(this,void 0,void 0,function(){return MM(this,function(n){return[2,LAe.create(r)]})})},t})(),BAe=function(t,r,n,i){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(f){try{d(i.next(f))}catch(p){o(p)}}function u(f){try{d(i.throw(f))}catch(p){o(p)}}function d(f){f.done?s(f.value):a(f.value).then(l,u)}d((i=i.apply(t,r||[])).next())})},FAe=function(t,r){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(f){return u([d,f])}}function u(d){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(n=0)),n;)try{if(i=1,a&&(s=d[0]&2?a.return:d[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,d[1])).done)return s;switch(a=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,a=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){n.label=d[1];break}if(d[0]===6&&n.label<s[1]){n.label=s[1],s=d;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(d);break}s[2]&&n.ops.pop(),n.trys.pop();continue}d=r.call(t,n)}catch(f){d=[6,f],a=0}finally{i=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},qAe=(function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var r=MediaStreamTrack;return MediaStreamTrack&&r.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var r=Cp.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(r=Cp.insecureContextCameraQueryError()),Promise.reject(r)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var r=location.host.split(":")[0];return r==="127.0.0.1"||r==="localhost"},t.getCamerasFromMediaDevices=function(){return BAe(this,void 0,void 0,function(){var r,n,i,a,s,o,l;return FAe(this,function(u){switch(u.label){case 0:return r=function(d){for(var f=d.getVideoTracks(),p=0,x=f;p<x.length;p++){var v=x[p];v.enabled=!1,v.stop(),d.removeTrack(v)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=u.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=u.sent(),a=[],s=0,o=i;s<o.length;s++)l=o[s],l.kind==="videoinput"&&a.push({id:l.deviceId,label:l.label});return r(n),[2,a]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(r,n){var i=function(s){for(var o=[],l=0,u=s;l<u.length;l++){var d=u[l];d.kind==="video"&&o.push({id:d.id,label:d.label})}r(o)},a=MediaStreamTrack;a.getSources(i)})},t})(),Ns;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(Ns||(Ns={}));var UAe=(function(){function t(){this.state=Ns.NOT_STARTED,this.onGoingTransactionNewState=Ns.UNKNOWN}return t.prototype.directTransition=function(r){this.failIfTransitionOngoing(),this.validateTransition(r),this.state=r},t.prototype.startTransition=function(r){return this.failIfTransitionOngoing(),this.validateTransition(r),this.onGoingTransactionNewState=r,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===Ns.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var r=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ns.UNKNOWN,this.directTransition(r)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ns.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ns.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ns.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(r){switch(this.state){case Ns.UNKNOWN:throw"Transition from unknown is not allowed";case Ns.NOT_STARTED:this.failIfNewStateIs(r,[Ns.PAUSED]);break;case Ns.SCANNING:break;case Ns.PAUSED:break}},t.prototype.failIfNewStateIs=function(r,n){for(var i=0,a=n;i<a.length;i++){var s=a[i];if(r===s)throw"Cannot transition from ".concat(this.state," to ").concat(r)}},t})(),WAe=(function(){function t(r){this.stateManager=r}return t.prototype.startTransition=function(r){return this.stateManager.startTransition(r)},t.prototype.directTransition=function(r){this.stateManager.directTransition(r)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===Ns.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==Ns.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ns.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===Ns.PAUSED},t})(),HAe=(function(){function t(){}return t.create=function(){return new WAe(new UAe)},t})(),VAe=(function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(i[s]=a[s])},t(r,n)};return function(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(r,n);function i(){this.constructor=r}r.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}})(),_c=(function(t){VAe(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.DEFAULT_WIDTH=300,r.DEFAULT_WIDTH_OFFSET=2,r.FILE_SCAN_MIN_HEIGHT=300,r.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,r.MIN_QR_BOX_SIZE=50,r.SHADED_LEFT=1,r.SHADED_RIGHT=2,r.SHADED_TOP=3,r.SHADED_BOTTOM=4,r.SHADED_REGION_ELEMENT_ID="qr-shaded-region",r.VERBOSE=!1,r.BORDER_SHADER_DEFAULT_COLOR="#ffffff",r.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",r})(wAe),$Ae=(function(){function t(r,n){this.logger=n,this.fps=_c.SCAN_DEFAULT_FPS,r?(r.fps&&(this.fps=r.fps),this.disableFlip=r.disableFlip===!0,this.qrbox=r.qrbox,this.aspectRatio=r.aspectRatio,this.videoConstraints=r.videoConstraints):this.disableFlip=_c.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?dH.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!Uu(this.qrbox)},t.create=function(r,n){return new t(r,n)},t})(),GAe=(function(){function t(r,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(r))throw"HTML Element with id=".concat(r," not found");this.elementId=r,this.verbose=!1;var i;typeof n=="boolean"?this.verbose=n===!0:n&&(i=n,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new CAe(this.verbose),this.qrcode=new OAe(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=HAe.create()}return t.prototype.start=function(r,n,i,a){var s=this;if(!r)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;a?o=a:o=this.verbose?this.logger.log:function(){};var l=$Ae.create(n,this.logger);this.clearElement();var u=!1;l.videoConstraints&&(l.isMediaStreamConstraintsValid()?u=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var d=u,f=document.getElementById(this.elementId);f.clientWidth?f.clientWidth:_c.DEFAULT_WIDTH,f.style.position="relative",this.shouldScan=!0,this.element=f;var p=this,x=this.stateManagerProxy.startTransition(Ns.SCANNING);return new Promise(function(v,w){var C=d?l.videoConstraints:p.createVideoConstraints(r);if(!C){x.cancel(),w("videoConstraints should be defined");return}var A={};(!d||l.aspectRatio)&&(A.aspectRatio=l.aspectRatio);var T={onRenderSurfaceReady:function(O,D){p.setupUi(O,D,l),p.isScanning=!0,p.foreverScan(l,i,o)}};zAe.failIfNotSupported().then(function(O){O.create(C).then(function(D){return D.render(s.element,A,T).then(function(M){p.renderedCamera=M,x.execute(),v(null)}).catch(function(M){x.cancel(),w(M)})}).catch(function(D){x.cancel(),w(Cp.errorGettingUserMedia(D))})}).catch(function(O){x.cancel(),w(Cp.cameraStreamingNotSupported())})})},t.prototype.pause=function(r){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ns.PAUSED),this.showPausedState(),(Uu(r)||r!==!0)&&(r=!1),r&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var r=this,n=function(){r.stateManagerProxy.directTransition(Ns.SCANNING),r.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var r=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(Ns.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(r.element){var s=document.getElementById(_c.SHADED_REGION_ELEMENT_ID);s&&r.element.removeChild(s)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),i(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),n.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(r,n){return this.scanFileV2(r,n).then(function(i){return i.decodedText})},t.prototype.scanFileV2=function(r,n){var i=this;if(!r||!(r instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Uu(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,s){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(r);var o=new Image;o.onload=function(){var l=o.width,u=o.height,d=document.getElementById(i.elementId),f=d.clientWidth?d.clientWidth:_c.DEFAULT_WIDTH,p=Math.max(d.clientHeight?d.clientHeight:u,_c.FILE_SCAN_MIN_HEIGHT),x=i.computeCanvasDrawConfig(l,u,f,p);if(n){var v=i.createCanvasElement(f,p,"qr-canvas-visible");v.style.display="inline-block",d.appendChild(v);var w=v.getContext("2d");if(!w)throw"Unable to get 2d context from canvas";w.canvas.width=f,w.canvas.height=p,w.drawImage(o,0,0,l,u,x.x,x.y,x.width,x.height)}var C=_c.FILE_SCAN_HIDDEN_CANVAS_PADDING,A=Math.max(o.width,x.width),T=Math.max(o.height,x.height),O=A+2*C,D=T+2*C,M=i.createCanvasElement(O,D);d.appendChild(M);var Q=M.getContext("2d");if(!Q)throw"Unable to get 2d context from canvas";Q.canvas.width=O,Q.canvas.height=D,Q.drawImage(o,0,0,l,u,C,C,A,T);try{i.qrcode.decodeRobustlyAsync(M).then(function(U){a(TM.createFromQrcodeResult(U))}).catch(s)}catch(U){s("QR code parse error, error = ".concat(U))}},o.onerror=s,o.onabort=s,o.onstalled=s,o.onsuspend=s,o.src=URL.createObjectURL(r)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return qAe.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(r){if(r){if(!dH.isMediaStreamConstraintsValid(r,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(r)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(r){var n=[mr.QR_CODE,mr.AZTEC,mr.CODABAR,mr.CODE_39,mr.CODE_93,mr.CODE_128,mr.DATA_MATRIX,mr.MAXICODE,mr.ITF,mr.EAN_13,mr.EAN_8,mr.PDF_417,mr.RSS_14,mr.RSS_EXPANDED,mr.UPC_A,mr.UPC_E,mr.UPC_EAN_EXTENSION];if(!r||typeof r=="boolean"||!r.formatsToSupport)return n;if(!Array.isArray(r.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(r.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],a=0,s=r.formatsToSupport;a<s.length;a++){var o=s[a];jAe(o)?i.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},t.prototype.getUseBarCodeDetectorIfSupported=function(r){if(Uu(r))return!0;if(!Uu(r.useBarCodeDetectorIfSupported))return r.useBarCodeDetectorIfSupported!==!1;if(Uu(r.experimentalFeatures))return!0;var n=r.experimentalFeatures;return Uu(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(r,n,i){var a=this,s=i.qrbox;this.validateQrboxConfig(s);var o=this.toQrdimensions(r,n,s),l=function(d){if(d<_c.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(_c.MIN_QR_BOX_SIZE,"px.")},u=function(d){return d>r&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),d=r),d};l(o.width),l(o.height),o.width=u(o.width)},t.prototype.validateQrboxConfig=function(r){if(typeof r!="number"&&typeof r!="function"&&(r.width===void 0||r.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(r,n,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(r,n)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return i},t.prototype.setupUi=function(r,n,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(r,n,i);var a=Uu(i.qrbox)?{width:r,height:n}:i.qrbox;this.validateQrboxConfig(a);var s=this.toQrdimensions(r,n,a);s.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=i.isShadedBoxEnabled()&&s.height<=n,l={x:0,y:0,width:r,height:n},u=o?this.getShadedRegionBounds(r,n,s):l,d=this.createCanvasElement(u.width,u.height),f={willReadFrequently:!0},p=d.getContext("2d",f);p.canvas.width=u.width,p.canvas.height=u.height,this.element.append(d),o&&this.possiblyInsertShadingElement(this.element,r,n,s),this.createScannerPausedUiElement(this.element),this.qrRegion=u,this.context=p,this.canvasElement=d},t.prototype.createScannerPausedUiElement=function(r){var n=document.createElement("div");n.innerText=Cp.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",r.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(r,n){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return r(a.text,TM.createFromQrcodeResult(a)),i.possiblyUpdateShaders(!0),!0}).catch(function(a){i.possiblyUpdateShaders(!1);var s=Cp.codeParseError(a);return n(s,SAe.createFrom(s)),!1})},t.prototype.foreverScan=function(r,n,i){var a=this;if(this.shouldScan&&this.renderedCamera){var s=this.renderedCamera.getSurface(),o=s.videoWidth/s.clientWidth,l=s.videoHeight/s.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var u=this.qrRegion.width*o,d=this.qrRegion.height*l,f=this.qrRegion.x*o,p=this.qrRegion.y*l;this.context.drawImage(s,f,p,u,d,0,0,this.qrRegion.width,this.qrRegion.height);var x=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(r,n,i)},a.getTimeoutFps(r.fps))};this.scanContext(n,i).then(function(v){!v&&r.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(n,i).finally(function(){x()})):x()}).catch(function(v){a.logger.logError("Error happend while scanning context",v),x()})}},t.prototype.createVideoConstraints=function(r){if(typeof r=="string")return{deviceId:{exact:r}};if(typeof r=="object"){var n="facingMode",i="deviceId",a={user:!0,environment:!0},s="exact",o=function(w){if(w in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(w,"'")},l=Object.keys(r);if(l.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(l.length," keys");var u=Object.keys(r)[0];if(u!==n&&u!==i)throw"Only '".concat(n,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(u===n){var d=r.facingMode;if(typeof d=="string"){if(o(d))return{facingMode:d}}else if(typeof d=="object")if(s in d){if(o(d["".concat(s)]))return{facingMode:{exact:d["".concat(s)]}}}else throw"'facingMode' should be string or object with"+" ".concat(s," as key.");else{var f=typeof d;throw"Invalid type of 'facingMode' = ".concat(f)}}else{var p=r.deviceId;if(typeof p=="string")return{deviceId:p};if(typeof p=="object"){if(s in p)return{deviceId:{exact:p["".concat(s)]}};throw"'deviceId' should be string or object with"+" ".concat(s," as key.")}else{var x=typeof p;throw"Invalid type of 'deviceId' = ".concat(x)}}}var v=typeof r;throw"Invalid type of 'cameraIdOrConfig' = ".concat(v)},t.prototype.computeCanvasDrawConfig=function(r,n,i,a){if(r<=i&&n<=a){var s=(i-r)/2,o=(a-n)/2;return{x:s,y:o,width:r,height:n}}else{var l=r,u=n;return r>i&&(n=i/r*n,r=i),n>a&&(r=a/n*r,n=a),this.logger.log("Image downsampled from "+"".concat(l,"X").concat(u)+" to ".concat(r,"X").concat(n,".")),this.computeCanvasDrawConfig(r,n,i,a)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var r=document.getElementById(this.elementId);r&&(r.innerHTML="")},t.prototype.possiblyUpdateShaders=function(r){this.qrMatch!==r&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=r?_c.BORDER_SHADER_MATCH_COLOR:_c.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=r)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(r,n,i){var a=r,s=n,o=document.createElement("canvas");return o.style.width="".concat(a,"px"),o.style.height="".concat(s,"px"),o.style.display="none",o.id=Uu(i)?"qr-canvas":i,o},t.prototype.getShadedRegionBounds=function(r,n,i){if(i.width>r||i.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(r-i.width)/2,y:(n-i.height)/2,width:i.width,height:i.height}},t.prototype.possiblyInsertShadingElement=function(r,n,i,a){if(!(n-a.width<1||i-a.height<1)){var s=document.createElement("div");s.style.position="absolute";var o=(n-a.width)/2,l=(i-a.height)/2;if(s.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderTop="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderBottom="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),s.style.boxSizing="border-box",s.style.top="0px",s.style.bottom="0px",s.style.left="0px",s.style.right="0px",s.id="".concat(_c.SHADED_REGION_ELEMENT_ID),n-a.width<11||i-a.height<11)this.hasBorderShaders=!1;else{var u=5,d=40;this.insertShaderBorders(s,d,u,-u,null,0,!0),this.insertShaderBorders(s,d,u,-u,null,0,!1),this.insertShaderBorders(s,d,u,null,-u,0,!0),this.insertShaderBorders(s,d,u,null,-u,0,!1),this.insertShaderBorders(s,u,d+u,-u,null,-u,!0),this.insertShaderBorders(s,u,d+u,null,-u,-u,!0),this.insertShaderBorders(s,u,d+u,-u,null,-u,!1),this.insertShaderBorders(s,u,d+u,null,-u,-u,!1),this.hasBorderShaders=!0}r.append(s)}},t.prototype.insertShaderBorders=function(r,n,i,a,s,o,l){var u=document.createElement("div");u.style.position="absolute",u.style.backgroundColor=_c.BORDER_SHADER_DEFAULT_COLOR,u.style.width="".concat(n,"px"),u.style.height="".concat(i,"px"),a!==null&&(u.style.top="".concat(a,"px")),s!==null&&(u.style.bottom="".concat(s,"px")),l?u.style.left="".concat(o,"px"):u.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(u),r.appendChild(u)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(r){return 1e3/r},t})(),LM;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(LM||(LM={}));function KAe({onScan:t,onClose:r,placeholder:n="Scan barcode or enter manually..."}){const[i,a]=k.useState("manual"),[s,o]=k.useState(""),[l,u]=k.useState(null),[d,f]=k.useState(!1),p=k.useRef(null),x=k.useRef(null),v=k.useRef(null),w=k.useCallback(async()=>{if(p.current&&d){try{await p.current.stop(),p.current.clear()}catch(O){console.error("Error stopping scanner:",O)}f(!1)}},[d]),C=k.useCallback(async()=>{if(x.current)try{u(null);const O=new GAe("barcode-scanner-container");p.current=O,await O.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:150}},(D,M)=>{t(D,M.result.format?.formatName),w(),r&&r()},()=>{}),f(!0)}catch(O){console.error("Scanner error:",O),u(O?.message||"Failed to start camera. Please check permissions."),a("manual")}},[t,r,w]);k.useEffect(()=>(i==="camera"?C():w(),()=>{w()}),[i]),k.useEffect(()=>{i==="manual"&&v.current&&v.current.focus()},[i]);const A=O=>{O.preventDefault(),s.trim()&&(t(s.trim(),"MANUAL"),o(""),r&&r())},T=O=>{O.key==="Enter"&&s.trim()&&(t(s.trim(),"MANUAL"),o(""),r&&r())};return e.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:"12px",border:"1px solid var(--border)",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:()=>a("manual"),style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",borderRadius:"6px",border:"none",background:i==="manual"?"var(--primary)":"transparent",color:i==="manual"?"white":"var(--text-secondary)",cursor:"pointer",fontSize:"13px",fontWeight:500},children:[e.jsx(hZ,{size:16}),"Manual"]}),e.jsxs("button",{onClick:()=>a("camera"),style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",borderRadius:"6px",border:"none",background:i==="camera"?"var(--primary)":"transparent",color:i==="camera"?"white":"var(--text-secondary)",cursor:"pointer",fontSize:"13px",fontWeight:500},children:[e.jsx(Dv,{size:16}),"Camera"]})]}),r&&e.jsx("button",{onClick:r,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",borderRadius:"6px",border:"none",background:"transparent",color:"var(--text-secondary)",cursor:"pointer"},children:e.jsx(Dr,{size:18})})]}),e.jsxs("div",{style:{padding:"16px"},children:[l&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",background:"rgba(239, 68, 68, 0.1)",borderRadius:"8px",marginBottom:"16px",color:"var(--error)",fontSize:"13px"},children:[e.jsx(sn,{size:16}),l]}),i==="camera"?e.jsxs("div",{children:[e.jsx("div",{id:"barcode-scanner-container",ref:x,style:{width:"100%",minHeight:"200px",borderRadius:"8px",overflow:"hidden",background:"var(--bg-tertiary)"}}),e.jsx("p",{style:{marginTop:"12px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"},children:"Point your camera at a barcode or QR code"})]}):e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(dz,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{ref:v,type:"text",value:s,onChange:O=>o(O.target.value),onKeyPress:T,placeholder:n,autoFocus:!0,style:{width:"100%",padding:"12px 12px 12px 40px",borderRadius:"8px",border:"1px solid var(--border)",background:"var(--bg-secondary)",color:"var(--text-primary)",fontSize:"14px"}})]}),e.jsx("p",{style:{marginTop:"8px",color:"var(--text-muted)",fontSize:"12px"},children:"Type or scan with USB scanner, then press Enter"})]})]})]})}function QAe({isOpen:t,onClose:r,onScan:n,title:i="Scan Barcode"}){return t?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:r,children:e.jsx("div",{style:{width:"100%",maxWidth:"400px"},onClick:a=>a.stopPropagation(),children:e.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:"12px",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{margin:0,fontSize:"16px",fontWeight:600},children:i}),e.jsx("button",{onClick:r,style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)"},children:e.jsx(Dr,{size:20})})]}),e.jsx(KAe,{onScan:n,onClose:r})]})})}):null}const iv=[{value:"RAW_MATERIAL",label:"Raw Material"},{value:"CONSUMABLE",label:"Consumable"},{value:"REAGENT",label:"Reagent"},{value:"PACKAGING",label:"Packaging"},{value:"RADIOISOTOPE",label:"Radioisotope"},{value:"TARGET_MATERIAL",label:"Target Material"},{value:"SOLVENT",label:"Solvent"},{value:"BUFFER",label:"Buffer"},{value:"FILTER",label:"Filter"},{value:"CONTAINER",label:"Container"},{value:"EXCIPIENT",label:"Excipient"},{value:"REFERENCE_STANDARD",label:"Reference Standard"}],av=[{value:"ACTIVE",label:"Active",color:"var(--success)"},{value:"INACTIVE",label:"Inactive",color:"var(--text-muted)"},{value:"DISCONTINUED",label:"Discontinued",color:"var(--error)"},{value:"PENDING_APPROVAL",label:"Pending Approval",color:"var(--warning)"}],yC=t=>({RAW_MATERIAL:{bg:"rgba(59, 130, 246, 0.1)",color:"#3b82f6"},CONSUMABLE:{bg:"rgba(34, 197, 94, 0.1)",color:"#22c55e"},REAGENT:{bg:"rgba(168, 85, 247, 0.1)",color:"#a855f7"},PACKAGING:{bg:"rgba(249, 115, 22, 0.1)",color:"#f97316"},RADIOISOTOPE:{bg:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},TARGET_MATERIAL:{bg:"rgba(236, 72, 153, 0.1)",color:"#ec4899"},SOLVENT:{bg:"rgba(20, 184, 166, 0.1)",color:"#14b8a6"},BUFFER:{bg:"rgba(6, 182, 212, 0.1)",color:"#06b6d4"},FILTER:{bg:"rgba(132, 204, 22, 0.1)",color:"#84cc16"},CONTAINER:{bg:"rgba(234, 179, 8, 0.1)",color:"#eab308"},EXCIPIENT:{bg:"rgba(99, 102, 241, 0.1)",color:"#6366f1"},REFERENCE_STANDARD:{bg:"rgba(244, 63, 94, 0.1)",color:"#f43f5e"}})[t]||{bg:"rgba(107, 114, 128, 0.1)",color:"#6b7280"};function YAe(){const[t,r]=k.useState(!1),[n,i]=k.useState(null),[a,s]=k.useState(null),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(""),[x,v]=k.useState(!1),[w,C]=k.useState(!1),A=pr(),T=gn(),O=re=>{v(!1),p(re),T.info("Barcode Scanned",`Searching for: ${re}`)},{data:D,isLoading:M}=Ve({queryKey:["materials",o,u,f],queryFn:async()=>{const re=new URLSearchParams;o&&re.append("category",o),u&&re.append("status",u),f&&re.append("search",f);const{data:de}=await xe.get(`/materials?${re.toString()}`);return de}}),{data:Q}=Ve({queryKey:["suppliers"],queryFn:async()=>{const{data:re}=await xe.get("/suppliers");return re}}),U=ot({mutationFn:async re=>n?xe.put(`/materials/${n.id}`,re):xe.post("/materials",re),onSuccess:()=>{A.invalidateQueries({queryKey:["materials"]}),r(!1),i(null),T.success(n?"Material Updated":"Material Created",n?"Material details have been updated":"New material has been added")},onError:re=>{const de=an(re);T.error("Error",de?.userMessage||"Failed to save material")}}),$=ot({mutationFn:async re=>xe.delete(`/materials/${re}`),onSuccess:()=>{A.invalidateQueries({queryKey:["materials"]}),T.success("Material Deleted","Material has been removed"),a?.id===n?.id&&s(null)},onError:re=>{const de=an(re);T.error("Error",de?.userMessage||"Failed to delete material")}}),ee=re=>{re.preventDefault();const de=new FormData(re.currentTarget);U.mutate({code:de.get("code"),name:de.get("name"),nameAr:de.get("nameAr")||null,category:de.get("category"),description:de.get("description")||null,unit:de.get("unit"),reorderPoint:parseFloat(de.get("reorderPoint"))||0,reorderQty:parseFloat(de.get("reorderQty"))||0,leadTimeDays:parseInt(de.get("leadTimeDays"))||0,supplierId:de.get("supplierId")||null,status:de.get("status"),storageConditions:de.get("storageConditions")||null,shelfLifeDays:parseInt(de.get("shelfLifeDays"))||null,hazardClass:de.get("hazardClass")||null,isRadioactive:de.get("isRadioactive")==="true"})},F=D?.filter(re=>re.status==="ACTIVE").length||0,Y=D?.filter(re=>re._count?.stock>0&&re.reorderPoint>0&&re._count?.stock<=re.reorderPoint).length||0,J=D?.filter(re=>re.isRadioactive).length||0,Z=D||[];return M?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Materials"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.25rem"},children:"Manage raw materials, consumables, and reagents"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{i(null),r(!0)},children:[e.jsx(cn,{size:16})," Add Material"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Materials",value:D?.length||0,icon:e.jsx(Rr,{size:24}),color:"primary"}),e.jsx(nt,{title:"Active",value:F,icon:e.jsx(Wl,{size:24}),color:"success"}),e.jsx(nt,{title:"Low Stock",value:Y,icon:e.jsx(Hr,{size:24}),color:"warning"}),e.jsx(nt,{title:"Radioactive",value:J,icon:e.jsx(ou,{size:24}),color:"danger"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search by name, code, or supplier...",value:f,onChange:re=>p(re.target.value),style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:o,onChange:re=>l(re.target.value),children:[e.jsx("option",{value:"",children:"All Categories"}),iv.map(re=>e.jsx("option",{value:re.value,children:re.label},re.value))]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"130px"},value:u,onChange:re=>d(re.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),av.map(re=>e.jsx("option",{value:re.value,children:re.label},re.value))]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>v(!0),title:"Scan barcode to search",children:[e.jsx(dz,{size:16})," Scan"]}),(o||u||f)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{l(""),d(""),p("")},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:a?"1fr 380px":"1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:Z.map(re=>{const de=yC(re.category),le=a?.id===re.id,K=av.find(ue=>ue.value===re.status);return e.jsxs("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:le?"2px solid var(--primary)":"1px solid var(--border)",transition:"all 0.2s"},onClick:()=>s(re),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:de.bg,color:de.color,fontWeight:600},children:iv.find(ue=>ue.value===re.category)?.label||re.category}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:ue=>{ue.stopPropagation(),i(re),r(!0)},children:e.jsx(ma,{size:14})})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"1rem"},children:re.name}),e.jsxs("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"1rem"},children:[e.jsx("span",{style:{fontFamily:"monospace"},children:re.code}),re.supplier?.name&&`  ${re.supplier.name}`]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.8125rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(rh,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["Unit: ",re.unit]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(LA,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["Reorder: ",re.reorderPoint]})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("span",{className:"badge",style:{fontSize:"0.6875rem",background:K?.color==="var(--success)"?"rgba(34, 197, 94, 0.1)":K?.color==="var(--warning)"?"rgba(234, 179, 8, 0.1)":K?.color==="var(--error)"?"rgba(239, 68, 68, 0.1)":"var(--bg-secondary)",color:K?.color||"var(--text-muted)"},children:K?.label||re.status}),re.isRadioactive&&e.jsxs("span",{className:"badge",style:{fontSize:"0.6875rem",background:"rgba(239, 68, 68, 0.1)",color:"var(--error)"},children:[e.jsx(ou,{size:10,style:{marginRight:"0.25rem"}})," Radioactive"]}),re._count?.recipeComponents>0&&e.jsxs("span",{style:{opacity:.7},children:["Used in ",re._count.recipeComponents," recipe",re._count.recipeComponents>1?"s":""]})]})]},re.id)})}),Z.length===0&&e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{title:"No materials found",message:f||o||u?"Try adjusting your filters":"Add your first material to get started",icon:"package"})})]}),a&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:yC(a.category).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:yC(a.category).color,color:"white",marginBottom:"0.5rem"},children:iv.find(re=>re.value===a.category)?.label||a.category}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:"0.5rem 0 0.25rem"},children:a.name}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:0},children:a.code})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>s(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Material Properties"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(rh,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Unit"})]}),e.jsx("div",{style:{fontWeight:600},children:a.unit})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Rr,{size:14,style:{color:"var(--warning)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Status"})]}),e.jsx("div",{style:{fontWeight:600},children:av.find(re=>re.value===a.status)?.label||a.status})]}),a.shelfLifeDays&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Bi,{size:14,style:{color:"var(--success)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Shelf Life"})]}),e.jsxs("div",{style:{fontWeight:600},children:[a.shelfLifeDays," days"]})]}),a.leadTimeDays>0&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Ts,{size:14,style:{color:"var(--info)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Lead Time"})]}),e.jsxs("div",{style:{fontWeight:600},children:[a.leadTimeDays," days"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Inventory Details"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"Reorder Point"}),e.jsxs("span",{style:{fontWeight:600},children:[a.reorderPoint," ",a.unit]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.625rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{fontSize:"0.8125rem"},children:"Reorder Qty"}),e.jsxs("span",{style:{fontWeight:600},children:[a.reorderQty," ",a.unit]})]})]})]}),a.supplier&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Preferred Supplier"}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ts,{size:16,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontWeight:500},children:a.supplier.name})]})]}),a.storageConditions&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Storage Conditions"}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",margin:0},children:a.storageConditions})]}),a.isRadioactive&&e.jsx("div",{style:{marginBottom:"1.25rem"},children:e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius)",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--error)"},children:[e.jsx(ou,{size:16}),e.jsx("span",{style:{fontWeight:500},children:"Radioactive Material"}),a.hazardClass&&e.jsxs("span",{style:{marginLeft:"auto",fontSize:"0.75rem"},children:["Class: ",a.hazardClass]})]})}),a._count?.recipeComponents>0&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Used In Recipes"}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(99, 102, 241, 0.1)",borderRadius:"var(--radius)",color:"var(--primary)",fontWeight:500},children:[a._count.recipeComponents," recipe",a._count.recipeComponents>1?"s":""]})]}),e.jsx("div",{style:{marginBottom:"1.25rem"},children:e.jsx(mc,{entityType:"Material",entityId:a.id,title:"Material Documents"})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsxs("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>{i(a),r(!0)},children:[e.jsx(ma,{size:16})," Edit Material"]}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>C(!0),title:"Print Label",children:e.jsx(wm,{size:16})}),a._count?.recipeComponents===0&&e.jsx("button",{className:"btn btn-secondary",style:{color:"var(--error)"},onClick:()=>{confirm("Are you sure you want to delete this material?")&&($.mutate(a.id),s(null))},children:e.jsx(Gi,{size:16})})]})]})]})]}),t&&e.jsx("div",{className:"modal-overlay",onClick:()=>{r(!1),i(null)},children:e.jsxs("div",{className:"modal",style:{maxWidth:"40rem"},onClick:re=>re.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:n?"Edit Material":"Add Material"}),e.jsx("button",{onClick:()=>{r(!1),i(null)},style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:ee,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code"}),e.jsx("input",{name:"code",className:"form-input",defaultValue:n?.code||"",required:!0,disabled:!!n})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsx("select",{name:"category",className:"form-select",defaultValue:n?.category||"RAW_MATERIAL",required:!0,children:iv.map(re=>e.jsx("option",{value:re.value,children:re.label},re.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (English)"}),e.jsx("input",{name:"name",className:"form-input",defaultValue:n?.name||"",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{name:"nameAr",className:"form-input",defaultValue:n?.nameAr||"",dir:"rtl"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{name:"description",className:"form-input",defaultValue:n?.description||"",rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Unit"}),e.jsxs("select",{name:"unit",className:"form-select",defaultValue:n?.unit||"EA",required:!0,children:[e.jsx("option",{value:"EA",children:"Each (EA)"}),e.jsx("option",{value:"KG",children:"Kilogram (KG)"}),e.jsx("option",{value:"G",children:"Gram (G)"}),e.jsx("option",{value:"MG",children:"Milligram (MG)"}),e.jsx("option",{value:"L",children:"Liter (L)"}),e.jsx("option",{value:"ML",children:"Milliliter (ML)"}),e.jsx("option",{value:"M",children:"Meter (M)"}),e.jsx("option",{value:"CM",children:"Centimeter (CM)"}),e.jsx("option",{value:"PC",children:"Piece (PC)"}),e.jsx("option",{value:"BOX",children:"Box"}),e.jsx("option",{value:"VIAL",children:"Vial"}),e.jsx("option",{value:"AMPOULE",children:"Ampoule"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsx("select",{name:"status",className:"form-select",defaultValue:n?.status||"ACTIVE",children:av.map(re=>e.jsx("option",{value:re.value,children:re.label},re.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Preferred Supplier"}),e.jsxs("select",{name:"supplierId",className:"form-select",defaultValue:n?.supplierId||"",children:[e.jsx("option",{value:"",children:"Select Supplier"}),Q?.map(re=>e.jsx("option",{value:re.id,children:re.name},re.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Reorder Point"}),e.jsx("input",{name:"reorderPoint",className:"form-input",type:"number",step:"0.01",defaultValue:n?.reorderPoint||0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Reorder Qty"}),e.jsx("input",{name:"reorderQty",className:"form-input",type:"number",step:"0.01",defaultValue:n?.reorderQty||0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Lead Time (days)"}),e.jsx("input",{name:"leadTimeDays",className:"form-input",type:"number",defaultValue:n?.leadTimeDays||0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Storage Conditions"}),e.jsx("input",{name:"storageConditions",className:"form-input",defaultValue:n?.storageConditions||"",placeholder:"e.g., 2-8C"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Shelf Life (days)"}),e.jsx("input",{name:"shelfLifeDays",className:"form-input",type:"number",defaultValue:n?.shelfLifeDays||""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Hazard Class"}),e.jsx("input",{name:"hazardClass",className:"form-input",defaultValue:n?.hazardClass||"",placeholder:"e.g., Class 7"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Radioactive"}),e.jsxs("select",{name:"isRadioactive",className:"form-select",defaultValue:n?.isRadioactive?"true":"false",children:[e.jsx("option",{value:"false",children:"No"}),e.jsx("option",{value:"true",children:"Yes"})]})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{r(!1),i(null)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:U.isPending,children:U.isPending?"Saving...":"Save Material"})]})]})]})}),e.jsx(QAe,{isOpen:x,onClose:()=>v(!1),onScan:O,title:"Scan Material Barcode"}),w&&a&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"450px"},onClick:re=>re.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Print Material Label"}),e.jsx("button",{onClick:()=>C(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsx("div",{className:"modal-body",style:{display:"flex",justifyContent:"center"},children:e.jsx(B5e,{material:a})})]})})]})}const zM={RAW_MATERIAL:"Raw Material",CONSUMABLE:"Consumable",REAGENT:"Reagent",PACKAGING:"Packaging",RADIOISOTOPE:"Radioisotope",TARGET_MATERIAL:"Target Material",SOLVENT:"Solvent",BUFFER:"Buffer",FILTER:"Filter",CONTAINER:"Container",EXCIPIENT:"Excipient",REFERENCE_STANDARD:"Reference Standard"};function xC(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}function ZAe(){const{id:t}=fl(),r=Gr(),[n,i]=k.useState("overview"),{data:a,isLoading:s}=Ve({queryKey:["material",t],queryFn:async()=>{const{data:A}=await xe.get(`/materials/${t}`);return A},enabled:!!t}),{data:o}=Ve({queryKey:["material-stock",t],queryFn:async()=>{const{data:A}=await xe.get(`/inventory/stock?materialId=${t}`);return A},enabled:!!t}),{data:l}=Ve({queryKey:["material-audit",t],queryFn:async()=>{const{data:A}=await xe.get(`/audit?entityType=Material&entityId=${t}`);return A.logs||[]},enabled:!!t});if(s)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!a)return e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(fn,{icon:"search",title:"Material Not Found",message:"The material you're looking for doesn't exist or has been deleted.",ctaLabel:"Back to Materials",onCta:()=>r("/materials")})});const u=o?.reduce((A,T)=>A+(T.availableQty||0),0)||0,d=o?.filter(A=>A.status==="QUARANTINE").reduce((A,T)=>A+T.quantity,0)||0,f=o?.filter(A=>A.status==="EXPIRED").reduce((A,T)=>A+T.quantity,0)||0,p=o?.filter(A=>{if(!A.expiryDate)return!1;const T=Math.ceil((new Date(A.expiryDate).getTime()-Date.now())/(1e3*60*60*24));return T>0&&T<=30}).length||0,x=[{title:"On-Hand Qty",value:`${u} ${a.unit}`,icon:e.jsx(Rr,{size:24}),color:"primary"},{title:"Quarantine",value:`${d} ${a.unit}`,icon:e.jsx(Hr,{size:24}),color:"warning"},{title:"Expired",value:`${f} ${a.unit}`,icon:e.jsx(ri,{size:24}),color:"danger"},{title:"Near Expiry",value:p,icon:e.jsx(Qt,{size:24}),color:"info"}],v=[];a.supplier&&v.push({type:"supplier",label:a.supplier.name,link:"/suppliers",count:1}),a.recipeComponents?.length>0&&v.push({type:"recipe",label:"Used in recipes",link:"/recipes",count:a.recipeComponents.length});const w=(l||[]).map(A=>({id:A.id,title:A.action.replace(/_/g," "),description:A.details||"",timestamp:A.createdAt,actor:A.user?.firstName?`${A.user.firstName} ${A.user.lastName}`:"System",type:A.action.includes("CREATED")?"success":A.action.includes("DELETED")?"error":"info"})),C=[{key:"overview",label:"Overview",icon:e.jsx(Ir,{size:16}),content:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Basic Information"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Code"}),e.jsx("td",{style:{padding:"0.5rem 0",fontWeight:500},children:a.code})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Name"}),e.jsx("td",{style:{padding:"0.5rem 0",fontWeight:500},children:a.name})]}),a.nameAr&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Arabic Name"}),e.jsx("td",{style:{padding:"0.5rem 0",fontWeight:500},children:a.nameAr})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Category"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:zM[a.category]||a.category})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Unit"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.unit})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Status"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:e.jsx("span",{className:`badge badge-${a.status==="ACTIVE"?"success":"default"}`,children:a.status})})]}),a.description&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Description"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.description})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Inventory Settings"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Min Stock Level"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[a.minStockLevel," ",a.unit]})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Reorder Point"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[a.reorderPoint," ",a.unit]})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Reorder Qty"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[a.reorderQuantity," ",a.unit]})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Lead Time"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[a.leadTimeDays," days"]})]}),a.shelfLifeDays&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Shelf Life"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[a.shelfLifeDays," days"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Supplier & Cost"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Preferred Supplier"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.supplier?.name||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Unit Cost"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.unitCost?`${a.unitCost.toFixed(2)} ${a.currency}`:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Requires QC"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.requiresQC?e.jsx(Ft,{size:16,color:"var(--success)"}):e.jsx(ri,{size:16,color:"var(--text-muted)"})})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Radioactive"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.isRadioactive?e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--warning)"},children:[e.jsx(ou,{size:16})," Yes ",a.halfLifeMinutes&&`(t: ${a.halfLifeMinutes} min)`]}):"No"})]})]})})]}),(a.storageConditions||a.handlingInstructions||a.hazardClass)&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Storage & Handling"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[a.storageConditions&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Storage"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.storageConditions})]}),a.handlingInstructions&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Handling"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.handlingInstructions})]}),a.hazardClass&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Hazard Class"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.hazardClass})]}),a.casNumber&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"CAS Number"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.casNumber})]})]})})]})]})},{key:"stock",label:"Stock / Lots",icon:e.jsx(Mp,{size:16}),badge:o?.length||0,content:o?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Lot #"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Available"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Expiry"})]})}),e.jsx("tbody",{children:o.map(A=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace"},children:A.lotNumber||"-"}),e.jsx("td",{children:A.warehouse?.name||"-"}),e.jsx("td",{children:A.location?.code||"-"}),e.jsxs("td",{children:[A.quantity," ",A.unit]}),e.jsxs("td",{children:[A.availableQty," ",A.unit]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${A.status==="AVAILABLE"?"success":A.status==="QUARANTINE"?"warning":A.status==="EXPIRED"?"danger":"default"}`,children:A.status})}),e.jsx("td",{children:xC(A.expiryDate,"dd MMM yyyy")})]},A.id))})]})}):e.jsx(fn,{icon:"package",title:"No Stock",message:"This material has no inventory records yet."})},{key:"recipes",label:"Used In",icon:e.jsx(Wl,{size:16}),badge:a.recipeComponents?.length||0,content:a.recipeComponents?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Recipe"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Version"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:a.recipeComponents.map(A=>e.jsxs("tr",{children:[e.jsxs("td",{children:[A.recipe?.code," - ",A.recipe?.name]}),e.jsx("td",{children:A.recipe?.product?.name||"-"}),e.jsxs("td",{children:["v",A.recipe?.version]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${A.recipe?.status==="ACTIVE"?"success":"default"}`,children:A.recipe?.status})})]},A.id))})]})}):e.jsx(fn,{icon:"package",title:"Not Used in Recipes",message:"This material is not currently used in any recipes."})},{key:"documents",label:"Documents",icon:e.jsx(Ir,{size:16}),content:e.jsx(mc,{entityType:"Material",entityId:t})},{key:"timeline",label:"Timeline",icon:e.jsx(jm,{size:16}),badge:w.length,content:w.length>0?e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:w.map(A=>e.jsxs("div",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:A.type==="success"?"var(--success)":A.type==="error"?"var(--danger)":"var(--primary)",marginTop:"0.5rem",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:A.title}),A.description&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:A.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[A.actor,"  ",xC(A.timestamp,"dd MMM yyyy HH:mm")]})]})]},A.id))}):e.jsx(fn,{icon:"search",title:"No Activity",message:"No activity recorded for this material yet."})}];return e.jsx(gy,{title:a.name,code:a.code,subtitle:zM[a.category]||a.category,status:{value:a.status,label:a.status,variant:a.status==="ACTIVE"?"success":"default"},metadata:[{label:"Unit",value:a.unit},{label:"Created",value:xC(a.createdAt,"dd MMM yyyy")},...a.isRadioactive?[{label:"Radioactive",value:e.jsx(ou,{size:14,style:{color:"var(--warning)"}})}]:[]],kpis:x,tabs:C,defaultTab:"overview",actions:[{label:"Edit",icon:e.jsx(t0,{size:16}),onClick:()=>r("/materials"),variant:"secondary"}],linkedRecords:v,timeline:w,showTimeline:!1,backUrl:"/materials",backLabel:"Materials"})}function hH({isOpen:t,onClose:r,onSuccess:n,scope:i,entityType:a,entityId:s,title:o="Electronic Signature Required",description:l,metadata:u}){const[d,f]=k.useState(""),[p,x]=k.useState(""),[v,w]=k.useState(""),[C,A]=k.useState(""),{data:T}=Ve({queryKey:["esignature-meanings",i],queryFn:async()=>{const{data:U}=await xe.get(`/esignatures/meanings/${i}`);return U},enabled:t}),O=ot({mutationFn:async()=>{const{data:U}=await xe.post("/esignatures/sign",{password:d,scope:i,entityType:a,entityId:s,meaning:p,comment:v||void 0,metadata:u});return U},onSuccess:U=>{Ki.success("Signed successfully"),f(""),x(""),w(""),A(""),n(U.signature),r()},onError:U=>{A(U.response?.data?.error||"Signature failed")}}),D=U=>{if(U.preventDefault(),A(""),!d){A("Password is required for authentication");return}if(!p){A("Please select the meaning of your signature");return}O.mutate()},M=()=>{f(""),x(""),w(""),A(""),r()};if(!t)return null;const Q={BATCH_RELEASE:"Batch Release",QC_APPROVAL:"QC Approval",DEVIATION_APPROVAL:"Deviation Approval",MASTERDATA_CHANGE:"Master Data Change",RECIPE_ACTIVATION:"Recipe Activation",PO_APPROVAL:"Purchase Order Approval",FINANCIAL_APPROVAL:"Financial Approval",DISPENSING_APPROVAL:"Dispensing Approval"};return e.jsx("div",{className:"modal-overlay",onClick:M,children:e.jsxs("div",{className:"modal",style:{maxWidth:"480px"},onClick:U=>U.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"linear-gradient(135deg, var(--primary) 0%, #1e40af 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(qg,{size:20,style:{color:"white"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:o}),e.jsx("span",{className:"badge badge-primary",style:{fontSize:"0.6875rem",marginTop:"0.25rem"},children:Q[i]||i})]})]}),e.jsx("button",{onClick:M,style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"modal-body",children:[l&&e.jsx("div",{style:{padding:"0.875rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"1.25rem",fontSize:"0.875rem",color:"var(--text-muted)"},children:l}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"var(--radius)",marginBottom:"1.25rem",display:"flex",alignItems:"flex-start",gap:"0.75rem"},children:[e.jsx(BC,{size:18,style:{color:"var(--primary)",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{style:{fontSize:"0.8125rem"},children:[e.jsx("strong",{children:"GMP Compliance Notice"}),e.jsx("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)"},children:"This action requires your electronic signature. Your password will be verified and the signature will be permanently recorded with timestamp."})]})]}),C&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius)",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--danger)",fontSize:"0.875rem"},children:[e.jsx(sn,{size:16}),C]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Meaning of Signature *"}),e.jsxs("select",{className:"form-select",value:p,onChange:U=>x(U.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select the meaning of your signature"}),T?.map((U,$)=>e.jsx("option",{value:U,children:U},$))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Comment / Reason (Optional)"}),e.jsx("textarea",{className:"form-textarea",value:v,onChange:U=>w(U.target.value),placeholder:"Add any additional comments or reasons...",rows:2,style:{resize:"none"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx(BC,{size:14,style:{marginRight:"0.375rem"}}),"Enter Your Password to Sign *"]}),e.jsx("input",{type:"password",className:"form-input",value:d,onChange:U=>f(U.target.value),placeholder:"Enter your password",required:!0,autoComplete:"current-password"})]}),e.jsxs("div",{style:{padding:"0.625rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ft,{size:14,style:{color:"var(--success)"}}),"Signature will be timestamped: ",new Date().toLocaleString()]})]}),e.jsxs("div",{className:"modal-footer",style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",borderTop:"1px solid var(--border)",padding:"1rem 1.5rem"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:M,disabled:O.isPending,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:O.isPending||!d||!p,style:{minWidth:"140px"},children:O.isPending?e.jsxs(e.Fragment,{children:[e.jsx(_g,{size:16,className:"animate-spin"}),"Signing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qg,{size:16}),"Sign & Confirm"]})})]})]})]})})}const BM={BATCH_RELEASE:{bg:"rgba(34, 197, 94, 0.1)",color:"var(--success)"},QC_APPROVAL:{bg:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"},DEVIATION_APPROVAL:{bg:"rgba(234, 179, 8, 0.1)",color:"var(--warning)"},MASTERDATA_CHANGE:{bg:"rgba(168, 85, 247, 0.1)",color:"#a855f7"},RECIPE_ACTIVATION:{bg:"rgba(16, 185, 129, 0.1)",color:"#10b981"},PO_APPROVAL:{bg:"rgba(20, 184, 166, 0.1)",color:"#14b8a6"},FINANCIAL_APPROVAL:{bg:"rgba(99, 102, 241, 0.1)",color:"#6366f1"},DISPENSING_APPROVAL:{bg:"rgba(249, 115, 22, 0.1)",color:"#f97316"}},FM={BATCH_RELEASE:"Batch Release",QC_APPROVAL:"QC Approval",DEVIATION_APPROVAL:"Deviation Approval",MASTERDATA_CHANGE:"Master Data Change",RECIPE_ACTIVATION:"Recipe Activation",PO_APPROVAL:"PO Approval",FINANCIAL_APPROVAL:"Financial Approval",DISPENSING_APPROVAL:"Dispensing"};function XAe({entityType:t,entityId:r,scope:n,title:i="Electronic Signatures",compact:a=!1}){const{data:s,isLoading:o}=Ve({queryKey:["esignatures",t,r,n],queryFn:async()=>{const l=n?`?scope=${n}`:"",{data:u}=await xe.get(`/esignatures/entity/${t}/${r}${l}`);return u},enabled:!!r});return o?e.jsx("div",{style:{padding:a?"0.75rem":"1rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.875rem"},children:"Loading signatures..."}):!s||s.length===0?a?e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",fontStyle:"italic"},children:"No signatures recorded"}):e.jsxs("div",{style:{padding:"1.5rem",textAlign:"center",color:"var(--text-muted)",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(qg,{size:24,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsx("div",{style:{fontSize:"0.875rem"},children:"No electronic signatures recorded"})]}):a?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:s.map(l=>{const u=BM[l.scope]||{bg:"var(--bg-secondary)",color:"var(--text)"};return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:u.bg,borderRadius:"var(--radius)",fontSize:"0.75rem"},children:[e.jsx(Ft,{size:14,style:{color:u.color,flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("span",{style:{fontWeight:500},children:l.signedBy.name}),e.jsx("span",{style:{color:"var(--text-muted)",marginLeft:"0.375rem"},children:Ze(new Date(l.signedAt),"MMM d, HH:mm")})]}),e.jsx("span",{className:"badge",style:{background:u.bg,color:u.color,fontSize:"0.625rem"},children:FM[l.scope]||l.scope})]},l.id)})}):e.jsxs("div",{className:"card",style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid var(--border)"},children:[e.jsx(qg,{size:18,style:{color:"var(--primary)"}}),e.jsx("h3",{style:{fontWeight:600,fontSize:"0.9375rem",margin:0},children:i}),e.jsxs("span",{className:"badge badge-default",style:{marginLeft:"auto"},children:[s.length," signature",s.length!==1?"s":""]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:s.map(l=>{const u=BM[l.scope]||{bg:"var(--bg-secondary)",color:"var(--text)"};return e.jsxs("div",{style:{padding:"0.875rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",borderLeft:`3px solid ${u.color}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:u.bg,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Uo,{size:14,style:{color:u.color}})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.875rem"},children:l.signedBy.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:l.signedBy.email})]})]}),e.jsx("span",{className:"badge",style:{background:u.bg,color:u.color,fontSize:"0.6875rem"},children:FM[l.scope]||l.scope})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",fontSize:"0.8125rem",marginBottom:"0.375rem"},children:[e.jsx(Ir,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:l.meaning})]}),l.comment&&e.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",fontStyle:"italic",marginBottom:"0.375rem",paddingLeft:"1.25rem"},children:['"',l.comment,'"']}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx(Qt,{size:12}),Ze(new Date(l.signedAt),"MMMM d, yyyy 'at' HH:mm:ss")]})]},l.id)})})]})}const JAe=[{value:"DRAFT",label:"Draft",color:"var(--text-muted)",icon:Ir},{value:"PENDING_APPROVAL",label:"Pending Approval",color:"var(--warning)",icon:Qt},{value:"ACTIVE",label:"Active",color:"var(--success)",icon:Ft},{value:"SUPERSEDED",label:"Superseded",color:"var(--text-muted)",icon:LA},{value:"OBSOLETE",label:"Obsolete",color:"var(--error)",icon:sn}],eEe={DRAFT:{label:"Draft",description:"Recipe is being developed. Can be edited and components added.",nextAction:"Submit for approval when ready"},PENDING_APPROVAL:{label:"Pending Approval",description:"Recipe submitted and awaiting QA approval with e-signature.",nextAction:"QA approves and activates with signature"},ACTIVE:{label:"Active",description:"Recipe is approved and can be used in production.",nextAction:"Create new version for changes"},SUPERSEDED:{label:"Superseded",description:"Recipe replaced by a newer version.",nextAction:"Reference only - use active version"},OBSOLETE:{label:"Obsolete",description:"Recipe no longer valid for production.",nextAction:"Historical reference only"}};function tEe(){const[t,r]=k.useState(!1),[n,i]=k.useState(null),[a,s]=k.useState(null),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(""),[x,v]=k.useState(!1),[w,C]=k.useState(null),[A,T]=k.useState({}),[O,D]=k.useState(!1),M=pr(),Q=gn(),{data:U,isLoading:$}=Ve({queryKey:["recipes",o,u,f],queryFn:async()=>{const V=new URLSearchParams;o&&V.append("status",o),u&&V.append("productId",u),f&&V.append("search",f);const{data:X}=await xe.get(`/recipes?${V.toString()}`);return X}}),{data:ee}=Ve({queryKey:["products"],queryFn:async()=>{const{data:V}=await xe.get("/products");return V}}),{data:F}=Ve({queryKey:["materials"],queryFn:async()=>{const{data:V}=await xe.get("/materials?status=ACTIVE");return V}}),{data:Y}=Ve({queryKey:["recipe",a?.id],queryFn:async()=>{if(!a?.id)return null;const{data:V}=await xe.get(`/recipes/${a.id}`);return V},enabled:!!a?.id}),J=ot({mutationFn:async V=>n?xe.put(`/recipes/${n.id}`,V):xe.post("/recipes",V),onSuccess:()=>{M.invalidateQueries({queryKey:["recipes"]}),r(!1),i(null),Q.success(n?"Recipe Updated":"Recipe Created",n?"Recipe details have been updated":"New recipe has been created")},onError:V=>{const X=an(V);Q.error("Error",X?.userMessage||"Failed to save recipe")}}),Z=ot({mutationFn:async V=>xe.post(`/recipes/${V}/submit-for-approval`),onSuccess:()=>{M.invalidateQueries({queryKey:["recipes"]}),Q.success("Submitted","Recipe has been submitted for approval")},onError:V=>{const X=an(V);Q.error("Error",X?.userMessage||"Failed to submit recipe")}}),re=ot({mutationFn:async({id:V,signatureId:X})=>xe.post(`/recipes/${V}/activate`,{signatureId:X}),onSuccess:()=>{M.invalidateQueries({queryKey:["recipes"]}),C(null),Q.success("Recipe Activated","Recipe is now active and can be used in production")},onError:V=>{const X=an(V);Q.error("Error",X?.userMessage||"Failed to activate recipe")}}),de=ot({mutationFn:async V=>xe.post(`/recipes/${V}/create-new-version`),onSuccess:V=>{M.invalidateQueries({queryKey:["recipes"]}),Q.success("New Version Created",`Version ${V.data.version} has been created as a draft`)},onError:V=>{const X=an(V);Q.error("Error",X?.userMessage||"Failed to create new version")}}),le=ot({mutationFn:async V=>xe.delete(`/recipes/${V}`),onSuccess:()=>{M.invalidateQueries({queryKey:["recipes"]}),Q.success("Recipe Deleted","Recipe has been removed")},onError:V=>{const X=an(V);Q.error("Error",X?.userMessage||"Failed to delete recipe")}}),K=V=>{V.preventDefault();const X=new FormData(V.currentTarget),se=X.get("componentsJson"),W=X.get("stepsJson");J.mutate({code:X.get("code"),name:X.get("name"),productId:X.get("productId"),description:X.get("description")||null,yieldQuantity:parseFloat(X.get("yieldQuantity")),yieldUnit:X.get("yieldUnit"),yieldTolerance:parseFloat(X.get("yieldTolerance"))||5,synthesisTimeMinutes:parseInt(X.get("synthesisTimeMinutes"))||null,totalTimeMinutes:parseInt(X.get("totalTimeMinutes"))||null,specialInstructions:X.get("specialInstructions")||null,safetyPrecautions:X.get("safetyPrecautions")||null,equipmentRequirements:X.get("equipmentRequirements")||null,qualityNotes:X.get("qualityNotes")||null,components:se?JSON.parse(se):[],steps:W?JSON.parse(W):[]})},ue=V=>({DRAFT:"default",PENDING_APPROVAL:"warning",ACTIVE:"success",SUPERSEDED:"default",OBSOLETE:"danger"})[V]||"default",ce=V=>{T(X=>({...X,[V]:!X[V]}))},ye=U?.recipes||U||[],Se={total:ye.length,active:ye.filter(V=>V.status==="ACTIVE").length,draft:ye.filter(V=>V.status==="DRAFT").length,pending:ye.filter(V=>V.status==="PENDING_APPROVAL").length,superseded:ye.filter(V=>V.status==="SUPERSEDED").length};return $?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:600,marginBottom:"0.25rem"},children:"Recipes & BOM"}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:"Manage product recipes and bills of materials"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>D(!O),children:[e.jsx(am,{size:16}),"Workflow Guide",O?e.jsx(nh,{size:14}):e.jsx(qo,{size:14})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>r(!0),children:[e.jsx(cn,{size:16})," Create Recipe"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Recipes",value:Se.total,icon:e.jsx(Ir,{size:20}),color:"primary",onClick:()=>l(""),selected:!o}),e.jsx(nt,{title:"Active",value:Se.active,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>l("ACTIVE"),selected:o==="ACTIVE"}),e.jsx(nt,{title:"Drafts",value:Se.draft,icon:e.jsx(ma,{size:20}),color:"default",onClick:()=>l("DRAFT"),selected:o==="DRAFT"}),e.jsx(nt,{title:"Pending Approval",value:Se.pending,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>l("PENDING_APPROVAL"),selected:o==="PENDING_APPROVAL"}),e.jsx(nt,{title:"Superseded",value:Se.superseded,icon:e.jsx(LA,{size:20}),color:"default",onClick:()=>l("SUPERSEDED"),selected:o==="SUPERSEDED"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search recipes...",value:f,onChange:V=>p(V.target.value),style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:u,onChange:V=>d(V.target.value),children:[e.jsx("option",{value:"",children:"All Products"}),ee?.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:o,onChange:V=>l(V.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),JAe.map(V=>e.jsx("option",{value:V.value,children:V.label},V.value))]}),(f||u||o)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{p(""),d(""),l("")},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),O&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.25rem"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(am,{size:18,style:{color:"var(--primary)"}}),"Recipe Versioning Workflow"]}),e.jsx("div",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Recipes follow a controlled versioning workflow with e-signature approval:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem",padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:["DRAFT","PENDING_APPROVAL","ACTIVE","SUPERSEDED"].map((V,X,se)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Pn,{status:V,size:"sm"}),X<se.length-1&&e.jsx(lc,{size:14,style:{color:"var(--text-muted)"}})]},V))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"0.75rem"},children:Object.entries(eEe).map(([V,X])=>e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"var(--radius-sm)",borderLeft:`3px solid var(--${ue(V)==="default"?"secondary":ue(V)})`},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:e.jsx(Pn,{status:V,size:"sm"})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:X.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Next:"})," ",X.nextAction]})]},V))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:a?"1fr 420px":"1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Recipe List (",ye.length,")"]})}),ye.length===0?e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{icon:"package",title:"No Recipes Found",message:f||o||u?"No recipes match your search criteria":"Get started by creating your first recipe",ctaLabel:!f&&!o&&!u?"Create Recipe":void 0,onCta:!f&&!o&&!u?()=>r(!0):void 0})}):e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Recipe"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Version"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Components"}),e.jsx("th",{style:{width:"180px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:ye.map(V=>e.jsxs("tr",{onClick:()=>s(V),style:{cursor:"pointer",background:a?.id===V.id?"var(--bg-hover)":void 0},children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem"},children:V.code}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:V.name})]}),e.jsx("td",{children:e.jsx("span",{style:{background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.8125rem"},children:V.product?.name})}),e.jsx("td",{children:e.jsxs("span",{style:{fontWeight:600},children:["v",V.version]})}),e.jsx("td",{children:e.jsx(Pn,{status:V.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(Rr,{size:14,style:{color:"var(--text-muted)"}}),V._count?.components||0,e.jsx("span",{style:{color:"var(--text-muted)"},children:"|"}),e.jsx(xZ,{size:14,style:{color:"var(--text-muted)"}}),V._count?.steps||0]})}),e.jsx("td",{onClick:X=>X.stopPropagation(),children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[V.status==="DRAFT"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>{i(V),r(!0)},title:"Edit",children:e.jsx(ma,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>Z.mutate(V.id),title:"Submit for Approval",disabled:Z.isPending,children:e.jsx(Qi,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>{confirm("Delete this draft recipe?")&&le.mutate(V.id)},title:"Delete",style:{color:"var(--error)"},children:e.jsx(Gi,{size:14})})]}),V.status==="PENDING_APPROVAL"&&e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>{C(V),v(!0)},title:"Activate with E-Signature",children:[e.jsx(qg,{size:14})," Activate"]}),(V.status==="ACTIVE"||V.status==="SUPERSEDED")&&e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>de.mutate(V.id),title:"Create New Version",disabled:de.isPending,children:[e.jsx(RA,{size:14})," New Version"]})]})})]},V.id))})]})]}),a&&Y&&e.jsxs("div",{className:"card",style:{padding:0,position:"sticky",top:"1rem",maxHeight:"calc(100vh - 150px)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,fontSize:"1rem"},children:Y.code}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:Y.name})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("span",{style:{fontWeight:600,fontSize:"0.875rem"},children:["v",Y.version]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>s(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})]}),e.jsx("div",{style:{marginTop:"0.75rem"},children:e.jsx(Pn,{status:Y.status,size:"md"})})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"1.25rem"},children:[e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Product"}),e.jsx("span",{style:{background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)",padding:"0.375rem 0.75rem",borderRadius:"4px",fontWeight:500},children:Y.product?.name})]}),Y.description&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Description"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:Y.description})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Yield Information"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Expected Yield"}),e.jsxs("div",{style:{fontWeight:600,fontSize:"1rem"},children:[Y.yieldQuantity," ",Y.yieldUnit]})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Tolerance"}),e.jsxs("div",{style:{fontWeight:600,fontSize:"1rem"},children:["",Y.yieldTolerance,"%"]})]})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:"0.5rem"},onClick:()=>ce(Y.id),children:[A[Y.id]?e.jsx(qo,{size:16}):e.jsx(bo,{size:16}),e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Bill of Materials (",Y.components?.length||0,")"]})]}),A[Y.id]&&e.jsx("div",{style:{marginLeft:"1.5rem"},children:Y.components?.length===0?e.jsx("div",{style:{color:"var(--text-muted)",fontStyle:"italic",fontSize:"0.875rem"},children:"No components defined"}):Y.components?.map(V=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid var(--border)",fontSize:"0.875rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:V.material?.name}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[V.material?.code,V.isCritical&&e.jsx("span",{style:{color:"var(--error)",marginLeft:"0.5rem"},children:"Critical"})]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontWeight:500},children:[V.quantity," ",V.unit]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["",V.tolerancePercent,"%"]})]})]},V.id))})]}),Y.steps?.length>0&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:["Process Steps (",Y.steps.length,")"]}),Y.steps.map(V=>e.jsxs("div",{style:{padding:"0.5rem 0.75rem",marginBottom:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{background:"var(--primary)",color:"white",width:"22px",height:"22px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.6875rem",fontWeight:600},children:V.stepNumber}),e.jsx("span",{style:{fontWeight:500,fontSize:"0.875rem"},children:V.title}),V.qualityCheckpoint&&e.jsx("span",{title:"QC Checkpoint",children:e.jsx(Ft,{size:14,style:{color:"var(--success)"}})})]}),V.description&&e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginLeft:"30px",marginTop:"0.25rem"},children:V.description})]},V.id))]}),Y.activatedAt&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Activation Details"}),e.jsxs("div",{style:{fontSize:"0.875rem",padding:"0.75rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Activated By:"})," ",Y.activatedBy?.firstName," ",Y.activatedBy?.lastName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(Y.activatedAt).toLocaleString()]})]}),Y.activationSignatureId&&e.jsx("div",{style:{marginTop:"0.75rem"},children:e.jsx(XAe,{entityType:"Recipe",entityId:Y.id,compact:!0})})]})]})]})]}),t&&e.jsx(rEe,{recipe:n,products:ee||[],materials:F||[],onClose:()=>{r(!1),i(null)},onSubmit:K,isPending:J.isPending}),x&&w&&e.jsx(hH,{isOpen:x,onClose:()=>{v(!1),C(null)},onSuccess:V=>{re.mutate({id:w.id,signatureId:V.id}),v(!1)},scope:"RECIPE_ACTIVATION",entityType:"Recipe",entityId:w.id,title:"Activate Recipe",description:`You are about to activate recipe ${w.code} v${w.version}. This will make it the active recipe for production and supersede any previous active version.`})]})}function rEe({recipe:t,products:r,materials:n,onClose:i,onSubmit:a,isPending:s}){const[o,l]=k.useState(t?.components||[]),[u,d]=k.useState(t?.steps||[]),f=()=>{l([...o,{materialId:"",quantity:0,unit:"",tolerancePercent:5,isOptional:!1,isCritical:!1}])},p=(A,T,O)=>{const D=[...o];if(D[A]={...D[A],[T]:O},T==="materialId"){const M=n.find(Q=>Q.id===O);M&&(D[A].unit=M.unit)}l(D)},x=A=>{l(o.filter((T,O)=>O!==A))},v=()=>{d([...u,{stepNumber:u.length+1,title:"",description:"",durationMinutes:null,qualityCheckpoint:!1}])},w=(A,T,O)=>{const D=[...u];D[A]={...D[A],[T]:O},d(D)},C=A=>{const T=u.filter((O,D)=>D!==A).map((O,D)=>({...O,stepNumber:D+1}));d(T)};return e.jsx("div",{className:"modal-overlay",onClick:i,children:e.jsxs("div",{className:"modal",onClick:A=>A.stopPropagation(),style:{maxWidth:"900px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:t?"Edit Recipe":"Create Recipe"}),e.jsx("button",{className:"btn btn-ghost",onClick:i,children:""})]}),e.jsxs("form",{onSubmit:A=>{A.preventDefault();const T=A.currentTarget,O=document.createElement("input");O.type="hidden",O.name="componentsJson",O.value=JSON.stringify(o),T.appendChild(O);const D=document.createElement("input");D.type="hidden",D.name="stepsJson",D.value=JSON.stringify(u),T.appendChild(D),a(A)},children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Recipe Code *"}),e.jsx("input",{type:"text",name:"code",className:"form-input",defaultValue:t?.code||"",required:!0,placeholder:"e.g., RCP-FDG-001",disabled:!!t})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",name:"name",className:"form-input",defaultValue:t?.name||"",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Product *"}),e.jsxs("select",{name:"productId",className:"form-select",defaultValue:t?.productId||"",required:!0,disabled:!!t,children:[e.jsx("option",{value:"",children:"Select Product"}),r.map(A=>e.jsxs("option",{value:A.id,children:[A.code," - ",A.name]},A.id))]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{name:"description",className:"form-input",rows:2,defaultValue:t?.description||""})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Yield Quantity *"}),e.jsx("input",{type:"number",name:"yieldQuantity",className:"form-input",defaultValue:t?.yieldQuantity||"",required:!0,step:"0.01"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Yield Unit *"}),e.jsx("input",{type:"text",name:"yieldUnit",className:"form-input",defaultValue:t?.yieldUnit||"mCi",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tolerance (%)"}),e.jsx("input",{type:"number",name:"yieldTolerance",className:"form-input",defaultValue:t?.yieldTolerance||5,step:"0.1"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Synthesis Time (min)"}),e.jsx("input",{type:"number",name:"synthesisTimeMinutes",className:"form-input",defaultValue:t?.synthesisTimeMinutes||""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Total Time (min)"}),e.jsx("input",{type:"number",name:"totalTimeMinutes",className:"form-input",defaultValue:t?.totalTimeMinutes||""})]})]}),e.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("h4",{style:{margin:0},children:["Bill of Materials (",o.length,")"]}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:f,children:[e.jsx(cn,{size:14})," Add Component"]})]}),o.map((A,T)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr auto auto",gap:"0.5rem",marginBottom:"0.5rem",alignItems:"center"},children:[e.jsxs("select",{className:"form-select",value:A.materialId,onChange:O=>p(T,"materialId",O.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Material"}),n.map(O=>e.jsxs("option",{value:O.id,children:[O.code," - ",O.name]},O.id))]}),e.jsx("input",{type:"number",className:"form-input",placeholder:"Qty",value:A.quantity,onChange:O=>p(T,"quantity",parseFloat(O.target.value)),step:"0.01"}),e.jsx("input",{type:"text",className:"form-input",value:A.unit,onChange:O=>p(T,"unit",O.target.value),placeholder:"Unit"}),e.jsx("input",{type:"number",className:"form-input",placeholder:"%",value:A.tolerancePercent,onChange:O=>p(T,"tolerancePercent",parseFloat(O.target.value))}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},children:[e.jsx("input",{type:"checkbox",checked:A.isCritical,onChange:O=>p(T,"isCritical",O.target.checked)}),"Critical"]}),e.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>x(T),style:{color:"var(--error)"},children:e.jsx(Dr,{size:14})})]},T))]}),e.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("h4",{style:{margin:0},children:["Process Steps (",u.length,")"]}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:v,children:[e.jsx(cn,{size:14})," Add Step"]})]}),u.map((A,T)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 2fr 2fr auto auto",gap:"0.5rem",marginBottom:"0.5rem",alignItems:"center"},children:[e.jsx("span",{style:{background:"var(--primary)",color:"white",width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:600},children:A.stepNumber}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Step Title",value:A.title,onChange:O=>w(T,"title",O.target.value),required:!0}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Description",value:A.description,onChange:O=>w(T,"description",O.target.value)}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},children:[e.jsx("input",{type:"checkbox",checked:A.qualityCheckpoint,onChange:O=>w(T,"qualityCheckpoint",O.target.checked)}),"QC"]}),e.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>C(T),style:{color:"var(--error)"},children:e.jsx(Dr,{size:14})})]},T))]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:s,children:s?"Saving...":t?"Update Recipe":"Create Recipe"})]})]})]})})}const sv=[{value:"ACTIVE",label:"Active",color:"var(--success)"},{value:"ON_HOLD",label:"On Hold",color:"var(--warning)"},{value:"BLOCKED",label:"Blocked",color:"var(--error)"},{value:"PENDING",label:"Pending",color:"var(--text-muted)"}],vC=t=>{switch(t){case"ACTIVE":return{bg:"rgba(34, 197, 94, 0.1)",color:"var(--success)"};case"ON_HOLD":return{bg:"rgba(234, 179, 8, 0.1)",color:"var(--warning)"};case"BLOCKED":return{bg:"rgba(239, 68, 68, 0.1)",color:"var(--error)"};case"PENDING":return{bg:"rgba(107, 114, 128, 0.1)",color:"var(--text-muted)"};default:return{bg:"rgba(107, 114, 128, 0.1)",color:"var(--text-muted)"}}};function nEe(){const t=pr(),r=gn(),[n,i]=k.useState(""),[a,s]=k.useState(""),[o,l]=k.useState(!1),[u,d]=k.useState(null),[f,p]=k.useState(null),[x,v]=k.useState({code:"",name:"",nameAr:"",email:"",phone:"",mobile:"",website:"",taxNumber:"",vatNumber:"",crNumber:"",bankName:"",bankBranch:"",bankAccountName:"",bankAccountNumber:"",bankIban:"",bankSwift:"",fullAddress:"",shortAddress:"",buildingNo:"",street:"",secondaryNo:"",district:"",postalCode:"",city:"",region:"",country:"Saudi Arabia",paymentTermsDays:30,status:"ACTIVE"}),{data:w}=Ve({queryKey:["supplier-stats"],queryFn:async()=>{const{data:ee}=await xe.get("/suppliers/stats");return ee}}),{data:C=[],isLoading:A}=Ve({queryKey:["suppliers",n,a],queryFn:async()=>{const ee=new URLSearchParams;n&&ee.append("search",n),a&&ee.append("status",a);const{data:F}=await xe.get(`/suppliers?${ee}`);return F}}),{data:T}=Ve({queryKey:["supplier",f?.id],queryFn:async()=>{const{data:ee}=await xe.get(`/suppliers/${f?.id}`);return ee},enabled:!!f?.id}),O=ot({mutationFn:async ee=>(await xe.post("/suppliers",ee)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["suppliers"]}),t.invalidateQueries({queryKey:["supplier-stats"]}),r.success("Supplier created successfully"),M()},onError:ee=>{r.error(ee.message)}}),D=ot({mutationFn:async ee=>(await xe.put(`/suppliers/${u?.id}`,ee)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["suppliers"]}),t.invalidateQueries({queryKey:["supplier-stats"]}),t.invalidateQueries({queryKey:["supplier",f?.id]}),r.success("Supplier updated successfully"),M()},onError:ee=>{r.error(ee.message)}}),M=()=>{l(!1),d(null),v({code:"",name:"",nameAr:"",email:"",phone:"",mobile:"",website:"",taxNumber:"",vatNumber:"",crNumber:"",bankName:"",bankBranch:"",bankAccountName:"",bankAccountNumber:"",bankIban:"",bankSwift:"",fullAddress:"",shortAddress:"",buildingNo:"",street:"",secondaryNo:"",district:"",postalCode:"",city:"",region:"",country:"Saudi Arabia",paymentTermsDays:30,status:"ACTIVE"})},Q=ee=>{d(ee),v({code:ee.code,name:ee.name,nameAr:ee.nameAr||"",email:ee.email||"",phone:ee.phone||"",mobile:ee.mobile||"",website:ee.website||"",taxNumber:ee.taxNumber||"",vatNumber:ee.vatNumber||"",crNumber:ee.crNumber||"",bankName:ee.bankName||"",bankBranch:"",bankAccountName:"",bankAccountNumber:"",bankIban:ee.bankIban||"",bankSwift:"",fullAddress:ee.fullAddress||"",shortAddress:ee.shortAddress||"",buildingNo:ee.buildingNo||"",street:ee.street||"",secondaryNo:ee.secondaryNo||"",district:ee.district||"",postalCode:ee.postalCode||"",city:ee.city||"",region:ee.region||"",country:ee.country||"Saudi Arabia",paymentTermsDays:ee.paymentTermsDays||30,status:ee.status}),l(!0)},U=ee=>{ee.preventDefault(),u?D.mutate(x):O.mutate(x)};if(A)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const $=T||f;return e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Suppliers"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.25rem"},children:"Manage vendor and supplier information"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>l(!0),children:[e.jsx(cn,{size:16})," Add Supplier"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Suppliers",value:w?.total||0,icon:e.jsx(Ts,{size:24}),color:"primary"}),e.jsx(nt,{title:"Active",value:w?.active||0,icon:e.jsx(Ai,{size:24}),color:"success"}),e.jsx(nt,{title:"On Hold",value:w?.onHold||0,icon:e.jsx(sn,{size:24}),color:"warning"}),e.jsx(nt,{title:"Blocked",value:w?.blocked||0,icon:e.jsx(QL,{size:24}),color:"danger"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search by name, code, or city...",value:n,onChange:ee=>i(ee.target.value),style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"130px"},value:a,onChange:ee=>s(ee.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),sv.map(ee=>e.jsx("option",{value:ee.value,children:ee.label},ee.value))]}),(a||n)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{s(""),i("")},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:f?"1fr 400px":"1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:C.map(ee=>{const F=vC(ee.status),Y=f?.id===ee.id;return e.jsxs("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:Y?"2px solid var(--primary)":"1px solid var(--border)",transition:"all 0.2s"},onClick:()=>p(ee),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:F.bg,color:F.color,fontWeight:600},children:sv.find(J=>J.value===ee.status)?.label||ee.status}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:J=>{J.stopPropagation(),Q(ee)},children:e.jsx(ma,{size:14})})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"1rem"},children:ee.name}),ee.nameAr&&e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"0.25rem",direction:"rtl"},children:ee.nameAr}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"1rem"},children:e.jsx("span",{style:{fontFamily:"monospace"},children:ee.code})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem",fontSize:"0.8125rem"},children:[ee.email&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(uc,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ee.email})]}),ee.phone&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(vo,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:ee.phone})]}),ee.city&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(_a,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:[ee.city,ee.country].filter(Boolean).join(", ")})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",color:"var(--text-muted)",display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ul,{size:12})," ",ee.paymentTermsDays," days"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Fo,{size:12})," ",ee._count?.purchaseOrders||0," POs"]})]})]},ee.id)})}),C.length===0&&e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{title:"No suppliers found",message:n||a?"Try adjusting your filters":"Add your first supplier to get started",icon:"package"})})]}),f&&$&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:vC($.status).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:vC($.status).color,color:"white",marginBottom:"0.5rem"},children:sv.find(ee=>ee.value===$.status)?.label||$.status}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:"0.5rem 0 0.25rem"},children:$.name}),$.nameAr&&e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:0,direction:"rtl"},children:$.nameAr}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:"0.25rem 0 0"},children:$.code})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>p(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Contact Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[$.email&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(uc,{size:16,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:$.email})]}),$.phone&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(vo,{size:16,style:{color:"var(--success)"}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:$.phone})]}),$.mobile&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(vo,{size:16,style:{color:"var(--info)"}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:$.mobile})]}),$.website&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(sm,{size:16,style:{color:"var(--warning)"}}),e.jsx("a",{href:$.website,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"0.875rem",color:"var(--primary)"},children:$.website})]})]})]}),($.fullAddress||$.shortAddress||$.city)&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Saudi National Address"}),e.jsx("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem"},children:[e.jsx(_a,{size:16,style:{color:"var(--primary)",marginTop:"0.125rem"}}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[$.shortAddress&&e.jsx("div",{style:{fontWeight:600,color:"var(--primary)",marginBottom:"0.25rem"},children:$.shortAddress}),$.buildingNo&&e.jsxs("div",{children:["Building ",$.buildingNo,", ",$.street]}),$.secondaryNo&&e.jsxs("div",{children:["Secondary No. ",$.secondaryNo]}),$.district&&e.jsx("div",{children:$.district}),e.jsx("div",{children:[$.city,$.region,$.country].filter(Boolean).join(", ")}),$.postalCode&&e.jsxs("div",{children:["Postal Code: ",$.postalCode]})]})]})})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Financial Details"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Payment Terms"}),e.jsxs("div",{style:{fontWeight:600},children:[$.paymentTermsDays," days"]})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Purchase Orders"}),e.jsx("div",{style:{fontWeight:600},children:$._count?.purchaseOrders||0})]})]})]}),($.taxNumber||$.vatNumber||$.crNumber)&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Tax & Registration"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem",fontSize:"0.8125rem"},children:[$.taxNumber&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Tax Number"}),e.jsx("span",{style:{fontWeight:500},children:$.taxNumber})]}),$.vatNumber&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"VAT Number"}),e.jsx("span",{style:{fontWeight:500},children:$.vatNumber})]}),$.crNumber&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"CR Number"}),e.jsx("span",{style:{fontWeight:500},children:$.crNumber})]})]})]}),($.bankName||$.bankIban)&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Bank Information"}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[$.bankName&&e.jsx("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:$.bankName}),$.bankIban&&e.jsx("div",{style:{fontSize:"0.8125rem",fontFamily:"monospace",color:"var(--text-muted)"},children:$.bankIban})]})]}),$.contacts&&$.contacts.length>0&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:["Contacts (",$.contacts.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:$.contacts.map(ee=>e.jsxs("div",{style:{padding:"0.75rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:500},children:ee.name}),ee.isPrimary&&e.jsx("span",{className:"badge",style:{fontSize:"0.625rem",background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"},children:"Primary"})]}),ee.title&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:ee.title}),ee.email&&e.jsx("div",{style:{fontSize:"0.75rem",marginTop:"0.25rem"},children:ee.email}),ee.phone&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:ee.phone})]},ee.id))})]}),e.jsx("div",{style:{marginBottom:"1.25rem"},children:e.jsx(mc,{entityType:"Supplier",entityId:$.id,title:"Supplier Documents"})}),e.jsxs("button",{className:"btn btn-primary",style:{width:"100%"},onClick:()=>Q($),children:[e.jsx(ma,{size:16})," Edit Supplier"]})]})]})]}),o&&e.jsx("div",{className:"modal-overlay",onClick:M,children:e.jsxs("div",{className:"modal",style:{maxWidth:"40rem"},onClick:ee=>ee.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:u?"Edit Supplier":"Add Supplier"}),e.jsx("button",{type:"button",onClick:M,style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:U,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code"}),e.jsx("input",{className:"form-input",type:"text",value:x.code,onChange:ee=>v({...x,code:ee.target.value}),required:!0,disabled:!!u,placeholder:"e.g., SUP-001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsx("select",{className:"form-select",value:x.status,onChange:ee=>v({...x,status:ee.target.value}),children:sv.map(ee=>e.jsx("option",{value:ee.value,children:ee.label},ee.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (English)"}),e.jsx("input",{className:"form-input",type:"text",value:x.name,onChange:ee=>v({...x,name:ee.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{className:"form-input",type:"text",value:x.nameAr,onChange:ee=>v({...x,nameAr:ee.target.value}),dir:"rtl"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{className:"form-input",type:"email",value:x.email,onChange:ee=>v({...x,email:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{className:"form-input",type:"text",value:x.phone,onChange:ee=>v({...x,phone:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Mobile"}),e.jsx("input",{className:"form-input",type:"text",value:x.mobile,onChange:ee=>v({...x,mobile:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Website"}),e.jsx("input",{className:"form-input",type:"url",value:x.website,onChange:ee=>v({...x,website:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tax Number"}),e.jsx("input",{className:"form-input",type:"text",value:x.taxNumber,onChange:ee=>v({...x,taxNumber:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"VAT Number"}),e.jsx("input",{className:"form-input",type:"text",value:x.vatNumber,onChange:ee=>v({...x,vatNumber:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"CR Number"}),e.jsx("input",{className:"form-input",type:"text",value:x.crNumber,onChange:ee=>v({...x,crNumber:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Bank Name"}),e.jsx("input",{className:"form-input",type:"text",value:x.bankName,onChange:ee=>v({...x,bankName:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"IBAN"}),e.jsx("input",{className:"form-input",type:"text",value:x.bankIban,onChange:ee=>v({...x,bankIban:ee.target.value}),placeholder:"SA..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Payment Terms (Days)"}),e.jsx("input",{className:"form-input",type:"number",value:x.paymentTermsDays,onChange:ee=>v({...x,paymentTermsDays:parseInt(ee.target.value)||30}),min:0})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Full Address"}),e.jsx("input",{className:"form-input",type:"text",value:x.fullAddress,onChange:ee=>v({...x,fullAddress:ee.target.value}),placeholder:"Complete address with landmarks"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Short Address"}),e.jsx("input",{className:"form-input",type:"text",value:x.shortAddress,onChange:ee=>v({...x,shortAddress:ee.target.value.toUpperCase()}),placeholder:"ABCD1234",maxLength:8})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Building No."}),e.jsx("input",{className:"form-input",type:"text",value:x.buildingNo,onChange:ee=>v({...x,buildingNo:ee.target.value}),placeholder:"e.g., 4240"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Street"}),e.jsx("input",{className:"form-input",type:"text",value:x.street,onChange:ee=>v({...x,street:ee.target.value}),placeholder:"Street name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Secondary No."}),e.jsx("input",{className:"form-input",type:"text",value:x.secondaryNo,onChange:ee=>v({...x,secondaryNo:ee.target.value}),placeholder:"e.g., 9014"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"District"}),e.jsx("input",{className:"form-input",type:"text",value:x.district,onChange:ee=>v({...x,district:ee.target.value}),placeholder:"e.g., Ar Rawdah"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{className:"form-input",type:"text",value:x.postalCode,onChange:ee=>v({...x,postalCode:ee.target.value}),placeholder:"12345",maxLength:5})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{className:"form-input",type:"text",value:x.city,onChange:ee=>v({...x,city:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Region"}),e.jsx("input",{className:"form-input",type:"text",value:x.region,onChange:ee=>v({...x,region:ee.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{className:"form-input",type:"text",value:x.country,onChange:ee=>v({...x,country:ee.target.value})})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:M,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:O.isPending||D.isPending,children:O.isPending||D.isPending?"Saving...":"Save Supplier"})]})]})]})})]})}function ov(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}function iEe(){const{id:t}=fl(),r=Gr(),{data:n,isLoading:i}=Ve({queryKey:["supplier",t],queryFn:async()=>{const{data:A}=await xe.get(`/suppliers/${t}`);return A},enabled:!!t}),{data:a}=Ve({queryKey:["supplier-pos",t],queryFn:async()=>{const{data:A}=await xe.get(`/purchase-orders?supplierId=${t}`);return A},enabled:!!t}),{data:s}=Ve({queryKey:["supplier-grns",t],queryFn:async()=>{const{data:A}=await xe.get(`/grn?supplierId=${t}`);return A},enabled:!!t}),{data:o}=Ve({queryKey:["supplier-audit",t],queryFn:async()=>{const{data:A}=await xe.get(`/audit?entityType=Supplier&entityId=${t}`);return A.logs||[]},enabled:!!t});if(i)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!n)return e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(fn,{icon:"search",title:"Supplier Not Found",message:"The supplier you're looking for doesn't exist or has been deleted.",ctaLabel:"Back to Suppliers",onCta:()=>r("/suppliers")})});const l=a?.filter(A=>["DRAFT","PENDING_APPROVAL","APPROVED","SENT","ACKNOWLEDGED","PARTIALLY_RECEIVED"].includes(A.status)).length||0,u=a?.reduce((A,T)=>T.status==="RECEIVED"||T.status==="CLOSED"?A+(Number(T.totalAmount)||0):A,0)||0,d=s?.filter(A=>A.status==="APPROVED").length||0,f=s?.length||0,p=f>0?Math.round(d/f*100):0,x=[{title:"Open POs",value:l,icon:e.jsx(Fo,{size:24}),color:"primary"},{title:"Total Spend",value:`${u.toLocaleString()} ${n.currency||"SAR"}`,icon:e.jsx(of,{size:24}),color:"success"},{title:"GRNs Received",value:d,icon:e.jsx(dn,{size:24}),color:"info"},{title:"On-Time Rate",value:`${p}%`,icon:e.jsx(Qt,{size:24}),color:p>=90?"success":p>=70?"warning":"danger"}],v=[];a?.length>0&&v.push({type:"purchaseOrder",label:"Purchase Orders",link:`/purchase-orders?supplierId=${t}`,count:a.length}),s?.length>0&&v.push({type:"grn",label:"Goods Receipts",link:`/grn?supplierId=${t}`,count:s.length});const w=(o||[]).map(A=>({id:A.id,title:A.action.replace(/_/g," "),description:A.details||"",timestamp:A.createdAt,actor:A.user?.firstName?`${A.user.firstName} ${A.user.lastName}`:"System",type:A.action.includes("CREATED")?"success":A.action.includes("BLOCKED")?"error":"info"})),C=[{key:"overview",label:"Overview",icon:e.jsx(Ir,{size:16}),content:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Contact Information"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:[e.jsx(uc,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Email"]}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.email||"-"})]}),e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:[e.jsx(vo,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Phone"]}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.phone||"-"})]}),e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:[e.jsx(vo,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Mobile"]}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.mobile||"-"})]}),n.website&&e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:[e.jsx(sm,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Website"]}),e.jsx("td",{style:{padding:"0.5rem 0"},children:e.jsx("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",children:n.website})})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Address"}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[n.buildingNumber&&e.jsx("div",{children:n.buildingNumber}),n.street&&e.jsx("div",{children:n.street}),n.district&&e.jsx("div",{children:n.district}),n.city&&e.jsxs("div",{children:[n.city,n.postalCode&&`, ${n.postalCode}`]}),n.country&&e.jsx("div",{children:n.country}),!n.buildingNumber&&!n.street&&!n.city&&e.jsx("span",{children:"-"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Business Details"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[n.taxNumber&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Tax Number"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.taxNumber})]}),n.vatNumber&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"VAT Number"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.vatNumber})]}),n.crNumber&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"CR Number"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.crNumber})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Payment Terms"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.paymentTerms||"Net 30"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Currency"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.currency||"SAR"})]})]})})]}),(n.bankName||n.bankIban)&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Banking Information"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[n.bankName&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Bank Name"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.bankName})]}),n.bankIban&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"IBAN"}),e.jsx("td",{style:{padding:"0.5rem 0",fontFamily:"monospace"},children:n.bankIban})]}),n.bankSwift&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"SWIFT"}),e.jsx("td",{style:{padding:"0.5rem 0",fontFamily:"monospace"},children:n.bankSwift})]})]})})]}),n.notes&&e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Notes"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",whiteSpace:"pre-wrap"},children:n.notes})]})]})},{key:"purchase-orders",label:"Purchase Orders",icon:e.jsx(Fo,{size:16}),badge:a?.length||0,content:a?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO Number"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.map(A=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace"},children:A.poNumber}),e.jsx("td",{children:ov(A.orderDate,"dd MMM yyyy")}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${A.status==="RECEIVED"||A.status==="CLOSED"?"success":A.status==="CANCELLED"?"danger":A.status==="PENDING_APPROVAL"?"warning":"info"}`,children:A.status.replace(/_/g," ")})}),e.jsxs("td",{children:[Number(A.totalAmount||0).toLocaleString()," ",A.currency||"SAR"]}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>r("/purchase-orders"),children:"View"})})]},A.id))})]})}):e.jsx(fn,{icon:"package",title:"No Purchase Orders",message:"No purchase orders found for this supplier."})},{key:"receiving",label:"Receiving",icon:e.jsx(dn,{size:16}),badge:s?.length||0,content:s?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN Number"}),e.jsx("th",{children:"PO"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Items"})]})}),e.jsx("tbody",{children:s.map(A=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace"},children:A.grnNumber}),e.jsx("td",{children:A.purchaseOrder?.poNumber||"-"}),e.jsx("td",{children:ov(A.receivedDate,"dd MMM yyyy")}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${A.status==="APPROVED"?"success":A.status==="REJECTED"?"danger":A.status==="PENDING_QC"?"warning":"default"}`,children:A.status.replace(/_/g," ")})}),e.jsx("td",{children:A._count?.items||0})]},A.id))})]})}):e.jsx(fn,{icon:"truck",title:"No Receipts",message:"No goods receiving notes found for this supplier."})},{key:"documents",label:"Documents",icon:e.jsx(Ir,{size:16}),content:e.jsx(mc,{entityType:"Supplier",entityId:t})},{key:"timeline",label:"Timeline",icon:e.jsx(jm,{size:16}),badge:w.length,content:w.length>0?e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:w.map(A=>e.jsxs("div",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:A.type==="success"?"var(--success)":A.type==="error"?"var(--danger)":"var(--primary)",marginTop:"0.5rem",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:A.title}),A.description&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:A.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[A.actor,"  ",ov(A.timestamp,"dd MMM yyyy HH:mm")]})]})]},A.id))}):e.jsx(fn,{icon:"search",title:"No Activity",message:"No activity recorded for this supplier yet."})}];return e.jsx(gy,{title:n.name,code:n.code,subtitle:n.nameAr||void 0,status:{value:n.status,label:n.status,variant:n.status==="ACTIVE"?"success":n.status==="ON_HOLD"?"warning":n.status==="BLOCKED"?"danger":"default"},metadata:[{label:"Created",value:ov(n.createdAt,"dd MMM yyyy")},...n.email?[{label:"Email",value:n.email}]:[]],kpis:x,tabs:C,defaultTab:"overview",actions:[{label:"Edit",icon:e.jsx(t0,{size:16}),onClick:()=>r("/suppliers"),variant:"secondary"}],linkedRecords:v,timeline:w,showTimeline:!1,backUrl:"/suppliers",backLabel:"Suppliers"})}const bC=[{value:"DRAFT",label:"Draft",color:"var(--text-muted)"},{value:"PENDING_APPROVAL",label:"Pending Approval",color:"var(--warning)"},{value:"APPROVED",label:"Approved",color:"var(--info)"},{value:"SENT",label:"Sent",color:"var(--primary)"},{value:"ACKNOWLEDGED",label:"Acknowledged",color:"var(--primary)"},{value:"PARTIALLY_RECEIVED",label:"Partially Received",color:"var(--warning)"},{value:"RECEIVED",label:"Received",color:"var(--success)"},{value:"CLOSED",label:"Closed",color:"var(--text-muted)"},{value:"CANCELLED",label:"Cancelled",color:"var(--error)"}];function aEe(){const t=pr(),r=gn();Gr();const[n,i]=k.useState({}),[a,s]=k.useState(!1),[o,l]=k.useState(!1),[u,d]=k.useState(!1),[f,p]=k.useState(null),[x,v]=k.useState(null),[w,C]=k.useState(null),[A,T]=k.useState({poNumber:"",supplierId:"",expectedDate:"",paymentTermsDays:30,deliveryTerms:"",shippingAddress:"",notes:""}),[O,D]=k.useState([{lineNumber:1,itemCode:"",itemName:"",orderedQty:1,unit:"EA",unitPrice:0}]),{data:M}=Ve({queryKey:["po-stats"],queryFn:async()=>{const{data:oe}=await xe.get("/purchase-orders/stats");return oe}}),{data:Q=[],isLoading:U}=Ve({queryKey:["purchase-orders",n],queryFn:async()=>{const oe=new URLSearchParams;n.search&&oe.append("search",n.search),n.status&&oe.append("status",n.status),n.supplierId&&oe.append("supplierId",n.supplierId);const{data:ge}=await xe.get(`/purchase-orders?${oe}`);return ge}}),{data:$=[]}=Ve({queryKey:["suppliers-list"],queryFn:async()=>{const{data:oe}=await xe.get("/suppliers?status=ACTIVE");return oe}}),{data:ee}=Ve({queryKey:["purchase-order",x?.id],queryFn:async()=>{const{data:oe}=await xe.get(`/purchase-orders/${x?.id}`);return oe},enabled:!!x?.id}),{data:F}=Ve({queryKey:["po-next-number"],queryFn:async()=>{const{data:oe}=await xe.get("/purchase-orders/next-number");return oe},enabled:a&&!f}),Y=ot({mutationFn:async oe=>(await xe.post("/purchase-orders",oe)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["purchase-orders"]}),t.invalidateQueries({queryKey:["po-stats"]}),t.invalidateQueries({queryKey:["po-next-number"]}),r.success("Purchase order created successfully"),de()},onError:oe=>{r.error(oe.message)}}),J=ot({mutationFn:async oe=>(await xe.put(`/purchase-orders/${f?.id}`,oe)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["purchase-orders"]}),t.invalidateQueries({queryKey:["po-stats"]}),r.success("Purchase order updated successfully"),de()},onError:oe=>{r.error(oe.message)}}),Z=ot({mutationFn:async({id:oe,action:ge,data:be})=>(await xe.post(`/purchase-orders/${oe}/${ge}`,be||{})).data,onSuccess:(oe,ge)=>{t.invalidateQueries({queryKey:["purchase-orders"]}),t.invalidateQueries({queryKey:["po-stats"]}),t.invalidateQueries({queryKey:["purchase-order",ge.id]}),r.success(`Purchase order ${ge.action} successfully`)},onError:oe=>{r.error(oe.message)}}),re=ot({mutationFn:async oe=>(await xe.delete(`/purchase-orders/${oe}`)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["purchase-orders"]}),t.invalidateQueries({queryKey:["po-stats"]}),r.success("Purchase order deleted successfully")},onError:oe=>{r.error(oe.message)}}),de=()=>{s(!1),p(null),T({poNumber:"",supplierId:"",expectedDate:"",paymentTermsDays:30,deliveryTerms:"",shippingAddress:"",notes:""}),D([{lineNumber:1,itemCode:"",itemName:"",orderedQty:1,unit:"EA",unitPrice:0}])},le=oe=>{p(oe),T({poNumber:oe.poNumber,supplierId:oe.supplierId,expectedDate:oe.expectedDate?oe.expectedDate.split("T")[0]:"",paymentTermsDays:oe.paymentTermsDays,deliveryTerms:oe.deliveryTerms||"",shippingAddress:oe.shippingAddress||"",notes:oe.notes||""}),D(oe.items.map((ge,be)=>({...ge,lineNumber:be+1}))),s(!0)},K=oe=>{oe.preventDefault();const ge=O.filter(Le=>Le.itemCode&&Le.itemName&&Le.orderedQty>0);if(ge.length===0){r.error("Please add at least one valid item");return}const be={...A,poNumber:A.poNumber||F?.poNumber,items:ge};f?J.mutate(be):Y.mutate(be)},ue=()=>{D([...O,{lineNumber:O.length+1,itemCode:"",itemName:"",orderedQty:1,unit:"EA",unitPrice:0}])},ce=oe=>{O.length>1&&D(O.filter((ge,be)=>be!==oe).map((ge,be)=>({...ge,lineNumber:be+1})))},ye=(oe,ge,be)=>{const Le=[...O];Le[oe][ge]=be,D(Le)},Se=oe=>bC.find(be=>be.value===oe)?.color||"var(--text-muted)",V=(oe,ge="SAR")=>new Intl.NumberFormat("en-SA",{style:"currency",currency:ge}).format(oe),X=()=>{const oe=O.reduce((be,Le)=>be+Le.orderedQty*Le.unitPrice,0),ge=oe*.15;return{subtotal:oe,tax:ge,total:oe+ge}},se=async oe=>{x&&(await Z.mutateAsync({id:x.id,action:"approve",data:{signatureId:oe.id}}),d(!1))},W=[{key:"search",label:"Search",type:"search",placeholder:"Search PO number, supplier..."},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},...bC.map(oe=>({value:oe.value,label:oe.label}))]},{key:"supplierId",label:"Supplier",type:"select",options:[{value:"",label:"All Suppliers"},...$.map(oe=>({value:oe.id,label:oe.name}))]}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Purchase Orders"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage procurement and supplier orders"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>s(!0),children:[e.jsx(cn,{size:16})," Create PO"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total",value:M?.total||0,icon:e.jsx(Ir,{size:20}),color:"primary",onClick:()=>i({}),selected:!n.status}),e.jsx(nt,{title:"Draft",value:M?.draft||0,icon:e.jsx(Ir,{size:20}),onClick:()=>i({status:"DRAFT"}),selected:n.status==="DRAFT"}),e.jsx(nt,{title:"Pending Approval",value:M?.pendingApproval||0,icon:e.jsx(Pv,{size:20}),color:"warning",onClick:()=>i({status:"PENDING_APPROVAL"}),selected:n.status==="PENDING_APPROVAL"}),e.jsx(nt,{title:"Sent",value:M?.sent||0,icon:e.jsx(Qi,{size:20}),color:"info",onClick:()=>i({status:"SENT"}),selected:n.status==="SENT"}),e.jsx(nt,{title:"Received",value:M?.received||0,icon:e.jsx(Ai,{size:20}),color:"success",onClick:()=>i({status:"RECEIVED"}),selected:n.status==="RECEIVED"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:W,values:n,onChange:(oe,ge)=>i(be=>({...be,[oe]:ge})),onReset:()=>i({})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Purchase Order List (",Q?.length||0,")"]})}),U?e.jsx("div",{className:"loading-spinner",style:{padding:"3rem",textAlign:"center"},children:"Loading..."}):Q.length===0?e.jsxs("div",{style:{padding:"3rem",textAlign:"center"},children:[e.jsx(Ir,{size:48,style:{color:"var(--text-muted)",marginBottom:"1rem"}}),e.jsx("h3",{style:{marginBottom:"0.5rem"},children:"No purchase orders found"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Create your first purchase order"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>s(!0),children:[e.jsx(cn,{size:16})," Create PO"]})]}):e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO Number"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Expected"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"120px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:Q.map(oe=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(nr,{to:`/purchase-orders/${oe.id}`,style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem",color:"var(--primary)"},children:oe.poNumber})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:oe.supplier?.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:oe.supplier?.code})]}),e.jsx("td",{children:new Date(oe.orderDate).toLocaleDateString()}),e.jsx("td",{children:oe.expectedDate?new Date(oe.expectedDate).toLocaleDateString():"-"}),e.jsx("td",{children:e.jsxs("span",{className:"badge badge-default",children:[oe._count?.items||0," items"]})}),e.jsx("td",{style:{fontWeight:500},children:V(Number(oe.totalAmount),oe.currencyCode)}),e.jsx("td",{children:e.jsx(Pn,{status:oe.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx(nr,{to:`/purchase-orders/${oe.id}`,className:"btn btn-sm btn-outline",title:"View Details",children:e.jsx(os,{size:14})}),["DRAFT","PENDING_APPROVAL"].includes(oe.status)&&e.jsx("button",{className:"btn btn-sm btn-outline",onClick:ge=>{ge.stopPropagation(),le(oe)},title:"Edit",children:e.jsx(ma,{size:14})}),oe.status==="DRAFT"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:ge=>{ge.stopPropagation(),Z.mutate({id:oe.id,action:"submit"})},title:"Submit for Approval",children:e.jsx(Qi,{size:14})}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:ge=>{ge.stopPropagation(),confirm("Delete this purchase order?")&&re.mutate(oe.id)},title:"Delete",children:e.jsx(Gi,{size:14})})]}),oe.status==="PENDING_APPROVAL"&&e.jsx("button",{className:"btn btn-sm btn-outline",onClick:ge=>{ge.stopPropagation(),v(oe),d(!0)},title:"Approve",style:{color:"var(--success)"},children:e.jsx(Ai,{size:16})}),oe.status==="APPROVED"&&e.jsx("button",{className:"btn btn-sm btn-outline",onClick:ge=>{ge.stopPropagation(),Z.mutate({id:oe.id,action:"send"})},title:"Send to Supplier",children:e.jsx(dn,{size:14})})]})})]},oe.id))})]})]}),a&&e.jsx("div",{className:"modal-overlay",onClick:de,children:e.jsx("div",{className:"modal",style:{maxWidth:"60rem"},onClick:oe=>oe.stopPropagation(),children:e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:f?"Edit Purchase Order":"Create Purchase Order"}),e.jsx("button",{type:"button",onClick:de,style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"PO Number"}),e.jsx("input",{type:"text",value:A.poNumber||F?.poNumber||"",onChange:oe=>T({...A,poNumber:oe.target.value}),disabled:!!f,placeholder:"Auto-generated"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Supplier *"}),e.jsxs("select",{value:A.supplierId,onChange:oe=>T({...A,supplierId:oe.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),$.map(oe=>e.jsxs("option",{value:oe.id,children:[oe.name," (",oe.code,")"]},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Expected Delivery"}),e.jsx("input",{type:"date",value:A.expectedDate,onChange:oe=>T({...A,expectedDate:oe.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",value:A.paymentTermsDays,onChange:oe=>T({...A,paymentTermsDays:parseInt(oe.target.value)||30}),min:0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Delivery Terms"}),e.jsx("input",{type:"text",value:A.deliveryTerms,onChange:oe=>T({...A,deliveryTerms:oe.target.value}),placeholder:"e.g., FOB, CIF"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Shipping Address"}),e.jsx("input",{type:"text",value:A.shippingAddress,onChange:oe=>T({...A,shippingAddress:oe.target.value})})]})]}),e.jsx("h4",{style:{marginBottom:"0.75rem"},children:"Line Items"}),e.jsx("div",{className:"table-container",style:{marginBottom:"1rem"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"},children:"#"}),e.jsx("th",{children:"Item Code *"}),e.jsx("th",{children:"Item Name *"}),e.jsx("th",{style:{width:"80px"},children:"Qty *"}),e.jsx("th",{style:{width:"80px"},children:"Unit"}),e.jsx("th",{style:{width:"120px"},children:"Unit Price *"}),e.jsx("th",{style:{width:"120px"},children:"Total"}),e.jsx("th",{style:{width:"40px"}})]})}),e.jsx("tbody",{children:O.map((oe,ge)=>e.jsxs("tr",{children:[e.jsx("td",{children:oe.lineNumber}),e.jsx("td",{children:e.jsx("input",{type:"text",value:oe.itemCode,onChange:be=>ye(ge,"itemCode",be.target.value),style:{width:"100%"}})}),e.jsx("td",{children:e.jsx("input",{type:"text",value:oe.itemName,onChange:be=>ye(ge,"itemName",be.target.value),style:{width:"100%"}})}),e.jsx("td",{children:e.jsx("input",{type:"number",value:oe.orderedQty,onChange:be=>ye(ge,"orderedQty",parseFloat(be.target.value)||0),min:0,step:"0.01",style:{width:"100%"}})}),e.jsx("td",{children:e.jsx("input",{type:"text",value:oe.unit,onChange:be=>ye(ge,"unit",be.target.value),style:{width:"100%"}})}),e.jsx("td",{children:e.jsx("input",{type:"number",value:oe.unitPrice,onChange:be=>ye(ge,"unitPrice",parseFloat(be.target.value)||0),min:0,step:"0.01",style:{width:"100%"}})}),e.jsx("td",{style:{textAlign:"right"},children:V(oe.orderedQty*oe.unitPrice)}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"icon-button",onClick:()=>ce(ge),disabled:O.length===1,children:e.jsx(Dr,{size:16})})})]},ge))}),e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:6,style:{textAlign:"right"},children:e.jsx("strong",{children:"Subtotal:"})}),e.jsx("td",{style:{textAlign:"right"},children:V(X().subtotal)}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:6,style:{textAlign:"right"},children:e.jsx("strong",{children:"VAT (15%):"})}),e.jsx("td",{style:{textAlign:"right"},children:V(X().tax)}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:6,style:{textAlign:"right"},children:e.jsx("strong",{children:"Total:"})}),e.jsx("td",{style:{textAlign:"right",fontWeight:"bold"},children:V(X().total)}),e.jsx("td",{})]})]})]})}),e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:ue,children:[e.jsx(cn,{size:16})," Add Item"]}),e.jsxs("div",{className:"form-group",style:{marginTop:"1rem"},children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{value:A.notes,onChange:oe=>T({...A,notes:oe.target.value}),rows:3})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:de,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Y.isPending||J.isPending,children:Y.isPending||J.isPending?"Saving...":f?"Update":"Create"})]})]})})}),o&&ee&&e.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:"60rem"},onClick:oe=>oe.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:"Purchase Order Details"}),e.jsx("button",{type:"button",onClick:()=>l(!1),style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"PO Information"}),e.jsxs("div",{children:[e.jsx("strong",{children:"PO Number:"})," ",ee.poNumber]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Order Date:"})," ",new Date(ee.orderDate).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Expected:"})," ",ee.expectedDate?new Date(ee.expectedDate).toLocaleDateString():"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:"status-badge",style:{backgroundColor:Se(ee.status)+"20",color:Se(ee.status)},children:bC.find(oe=>oe.value===ee.status)?.label})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Supplier"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",ee.supplier?.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Code:"})," ",ee.supplier?.code]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Totals"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Subtotal:"})," ",V(Number(ee.subtotal))]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tax:"})," ",V(Number(ee.taxAmount))]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Total:"})," ",V(Number(ee.totalAmount))]})]})]}),e.jsx("h4",{style:{marginBottom:"0.75rem"},children:"Line Items"}),e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Ordered"}),e.jsx("th",{children:"Received"}),e.jsx("th",{children:"Unit"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Total"})]})}),e.jsx("tbody",{children:ee.items?.map(oe=>e.jsxs("tr",{children:[e.jsx("td",{children:oe.lineNumber}),e.jsx("td",{children:oe.itemCode}),e.jsx("td",{children:oe.itemName}),e.jsx("td",{children:oe.orderedQty}),e.jsx("td",{children:oe.receivedQty||0}),e.jsx("td",{children:oe.unit}),e.jsx("td",{children:V(Number(oe.unitPrice))}),e.jsx("td",{children:V(Number(oe.totalPrice))})]},oe.id))})]}),ee.notes&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("h4",{children:"Notes"}),e.jsx("p",{style:{whiteSpace:"pre-wrap"},children:ee.notes})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>l(!1),children:"Close"}),["DRAFT","PENDING_APPROVAL"].includes(ee.status)&&e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>{l(!1),le(ee)},children:[e.jsx(ma,{size:16})," Edit"]})]})]})}),u&&x&&e.jsx(hH,{isOpen:u,onClose:()=>d(!1),scope:"PO_APPROVAL",entityType:"PURCHASE_ORDER",entityId:x.id,title:`Approve Purchase Order ${x.poNumber}`,description:`I approve this purchase order for ${V(Number(x.totalAmount))}`,onSuccess:se})]})}function mp(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}const sEe={DRAFT:"default",PENDING_APPROVAL:"warning",APPROVED:"info",SENT:"info",ACKNOWLEDGED:"info",PARTIALLY_RECEIVED:"warning",RECEIVED:"success",CLOSED:"success",CANCELLED:"danger"};function oEe(){const{id:t}=fl(),r=Gr(),n=pr(),i=gn(),{data:a,isLoading:s}=Ve({queryKey:["purchase-order",t],queryFn:async()=>{const{data:M}=await xe.get(`/purchase-orders/${t}`);return M},enabled:!!t}),{data:o}=Ve({queryKey:["po-audit",t],queryFn:async()=>{const{data:M}=await xe.get(`/audit?entityType=PurchaseOrder&entityId=${t}`);return M.logs||[]},enabled:!!t}),l=ot({mutationFn:async()=>{const{data:M}=await xe.post(`/purchase-orders/${t}/submit`);return M},onSuccess:()=>{n.invalidateQueries({queryKey:["purchase-order",t]}),i.success("Purchase order submitted for approval")},onError:M=>{i.error(M.response?.data?.error||"Failed to submit PO")}}),u=ot({mutationFn:async()=>{const{data:M}=await xe.post(`/purchase-orders/${t}/approve`);return M},onSuccess:()=>{n.invalidateQueries({queryKey:["purchase-order",t]}),i.success("Purchase order approved")},onError:M=>{i.error(M.response?.data?.error||"Failed to approve PO")}}),d=ot({mutationFn:async()=>{const{data:M}=await xe.post(`/purchase-orders/${t}/send`);return M},onSuccess:()=>{n.invalidateQueries({queryKey:["purchase-order",t]}),i.success("Purchase order sent to supplier")},onError:M=>{i.error(M.response?.data?.error||"Failed to send PO")}});if(s)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!a)return e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(fn,{icon:"search",title:"Purchase Order Not Found",message:"The purchase order you're looking for doesn't exist or has been deleted.",ctaLabel:"Back to Purchase Orders",onCta:()=>r("/purchase-orders")})});const f=a.items?.length||0,p=a.items?.reduce((M,Q)=>M+Number(Q.quantity)*Number(Q.unitPrice),0)||0,x=a.grns?.reduce((M,Q)=>M+Q.items?.reduce((U,$)=>U+Number($.receivedQuantity||0),0),0)||0,v=a.items?.reduce((M,Q)=>M+Number(Q.quantity),0)||0,w=v>0?Math.round(x/v*100):0,C=[{title:"Line Items",value:f,icon:e.jsx(Rr,{size:24}),color:"primary"},{title:"Total Value",value:`${p.toLocaleString()} ${a.currency||"SAR"}`,icon:e.jsx(of,{size:24}),color:"success"},{title:"Receipt Rate",value:`${w}%`,icon:e.jsx(dn,{size:24}),color:w>=100?"success":w>0?"warning":"default"},{title:"GRNs",value:a.grns?.length||0,icon:e.jsx(Ir,{size:24}),color:"info"}],A=[];a.supplier&&A.push({type:"supplier",label:a.supplier.name,link:`/suppliers/${a.supplier.id}`}),a.grns?.length>0&&A.push({type:"grn",label:"Goods Receipts",link:`/grn?purchaseOrderId=${t}`,count:a.grns.length});const T=(o||[]).map(M=>({id:M.id,title:M.action.replace(/_/g," "),description:M.details||"",timestamp:M.createdAt,actor:M.user?.firstName?`${M.user.firstName} ${M.user.lastName}`:"System",type:M.action.includes("APPROVED")?"success":M.action.includes("REJECTED")||M.action.includes("CANCELLED")?"error":"info"})),O=()=>{const M=[];return a.status==="DRAFT"&&M.push({label:"Submit for Approval",icon:e.jsx(Qi,{size:16}),onClick:()=>l.mutate(),variant:"primary",loading:l.isPending}),a.status==="PENDING_APPROVAL"&&M.push({label:"Approve",icon:e.jsx(Ai,{size:16}),onClick:()=>u.mutate(),variant:"primary",loading:u.isPending}),a.status==="APPROVED"&&M.push({label:"Send to Supplier",icon:e.jsx(Qi,{size:16}),onClick:()=>d.mutate(),variant:"primary",loading:d.isPending}),(a.status==="DRAFT"||a.status==="PENDING_APPROVAL")&&M.push({label:"Edit",icon:e.jsx(t0,{size:16}),onClick:()=>r("/purchase-orders"),variant:"secondary"}),M},D=[{key:"overview",label:"Overview",icon:e.jsx(Ir,{size:16}),content:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Order Details"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Order Date"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:mp(a.orderDate,"dd MMM yyyy")})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Expected Delivery"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:mp(a.expectedDeliveryDate,"dd MMM yyyy")})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Currency"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.currency||"SAR"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Payment Terms"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.paymentTerms||"-"})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Supplier"}),a.supplier?e.jsxs("div",{style:{fontSize:"0.875rem"},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.5rem"},children:a.supplier.name}),a.supplier.email&&e.jsx("div",{style:{color:"var(--text-secondary)"},children:a.supplier.email}),a.supplier.phone&&e.jsx("div",{style:{color:"var(--text-secondary)"},children:a.supplier.phone}),e.jsx("button",{className:"btn btn-secondary btn-sm",style:{marginTop:"0.5rem"},onClick:()=>r(`/suppliers/${a.supplier.id}`),children:"View Supplier"})]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"No supplier assigned"})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Financial Summary"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Subtotal"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[Number(a.subtotal||0).toLocaleString()," ",a.currency||"SAR"]})]}),e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:["VAT (",a.vatRate||15,"%)"]}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[Number(a.vatAmount||0).toLocaleString()," ",a.currency||"SAR"]})]}),e.jsxs("tr",{style:{fontWeight:600},children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Total"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[Number(a.totalAmount||0).toLocaleString()," ",a.currency||"SAR"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Workflow"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Created By"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.createdBy?.firstName?`${a.createdBy.firstName} ${a.createdBy.lastName}`:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Approved By"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.approvedBy?.firstName?`${a.approvedBy.firstName} ${a.approvedBy.lastName}`:"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Approved At"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:mp(a.approvedAt,"dd MMM yyyy HH:mm")})]})]})})]}),a.notes&&e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Notes"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",whiteSpace:"pre-wrap"},children:a.notes})]})]})},{key:"items",label:"Line Items",icon:e.jsx(Rr,{size:16}),badge:f,content:a.items?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Unit"}),e.jsx("th",{style:{textAlign:"right"},children:"Qty"}),e.jsx("th",{style:{textAlign:"right"},children:"Unit Price"}),e.jsx("th",{style:{textAlign:"right"},children:"Total"})]})}),e.jsx("tbody",{children:a.items.map(M=>e.jsxs("tr",{children:[e.jsx("td",{children:M.lineNumber}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:M.description}),M.materialCode&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:M.materialCode})]}),e.jsx("td",{children:M.unit||"EA"}),e.jsx("td",{style:{textAlign:"right"},children:Number(M.quantity).toLocaleString()}),e.jsx("td",{style:{textAlign:"right"},children:Number(M.unitPrice).toLocaleString()}),e.jsx("td",{style:{textAlign:"right"},children:(Number(M.quantity)*Number(M.unitPrice)).toLocaleString()})]},M.id))}),e.jsx("tfoot",{children:e.jsxs("tr",{style:{fontWeight:600},children:[e.jsx("td",{colSpan:5,style:{textAlign:"right"},children:"Total:"}),e.jsxs("td",{style:{textAlign:"right"},children:[p.toLocaleString()," ",a.currency||"SAR"]})]})})]})}):e.jsx(fn,{icon:"package",title:"No Line Items",message:"No items have been added to this purchase order."})},{key:"receiving",label:"Receiving",icon:e.jsx(dn,{size:16}),badge:a.grns?.length||0,content:a.grns?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN Number"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Received By"})]})}),e.jsx("tbody",{children:a.grns.map(M=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace"},children:M.grnNumber}),e.jsx("td",{children:mp(M.receivedDate,"dd MMM yyyy")}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${M.status==="APPROVED"?"success":M.status==="REJECTED"?"danger":M.status==="PENDING_QC"?"warning":"default"}`,children:M.status?.replace(/_/g," ")})}),e.jsx("td",{children:M.items?.length||0}),e.jsx("td",{children:M.receivedBy?.name||"-"})]},M.id))})]})}):e.jsx(fn,{icon:"truck",title:"No Receipts",message:"No goods have been received against this purchase order yet."})},{key:"documents",label:"Documents",icon:e.jsx(Ir,{size:16}),content:e.jsx(mc,{entityType:"PurchaseOrder",entityId:t})},{key:"timeline",label:"Timeline",icon:e.jsx(jm,{size:16}),badge:T.length,content:T.length>0?e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:T.map(M=>e.jsxs("div",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:M.type==="success"?"var(--success)":M.type==="error"?"var(--danger)":"var(--primary)",marginTop:"0.5rem",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:M.title}),M.description&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:M.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[M.actor,"  ",mp(M.timestamp,"dd MMM yyyy HH:mm")]})]})]},M.id))}):e.jsx(fn,{icon:"search",title:"No Activity",message:"No activity recorded for this purchase order yet."})}];return e.jsx(gy,{title:`Purchase Order ${a.poNumber}`,code:a.poNumber,status:{value:a.status,label:a.status?.replace(/_/g," "),variant:sEe[a.status]||"default"},metadata:[{label:"Order Date",value:mp(a.orderDate,"dd MMM yyyy")},{label:"Supplier",value:a.supplier?.name||"-"}],kpis:C,tabs:D,defaultTab:"overview",actions:O(),linkedRecords:A,timeline:T,showTimeline:!1,backUrl:"/purchase-orders",backLabel:"Purchase Orders"})}const Ng=[{value:"RAW_MATERIALS",label:"Raw Materials",color:"#3b82f6"},{value:"QUARANTINE",label:"Quarantine",color:"#f59e0b"},{value:"PRODUCTION",label:"Production",color:"#8b5cf6"},{value:"FINISHED_GOODS",label:"Finished Goods",color:"#22c55e"},{value:"COLD_STORAGE",label:"Cold Storage",color:"#06b6d4"},{value:"RADIOACTIVE",label:"Radioactive",color:"#ef4444"},{value:"WASTE",label:"Waste",color:"#6b7280"}],Ag=[{value:"ACTIVE",label:"Active",color:"#22c55e"},{value:"INACTIVE",label:"Inactive",color:"#94a3b8"},{value:"MAINTENANCE",label:"Maintenance",color:"#f59e0b"}],jC=t=>{const r=Ng.find(n=>n.value===t);return{bg:`${r?.color}15`,color:r?.color||"#6b7280"}},qM=t=>{const r=Ag.find(n=>n.value===t);return{bg:`${r?.color}20`,color:r?.color||"#6b7280"}};function lEe(){const t=pr(),r=gn(),[n,i]=k.useState(""),[a,s]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(!1),[f,p]=k.useState(null),[x,v]=k.useState(null),[w,C]=k.useState(!1),[A,T]=k.useState(null),[O,D]=k.useState({code:"",name:"",nameAr:"",type:"RAW_MATERIALS",status:"ACTIVE",description:"",address:"",temperatureMin:"",temperatureMax:"",humidityMin:"",humidityMax:"",isRadioactive:!1,requiresQC:!0}),[M,Q]=k.useState({code:"",name:"",zone:"",aisle:"",rack:"",shelf:"",bin:"",capacity:"",capacityUnit:"",isActive:!0}),{data:U}=Ve({queryKey:["warehouse-stats"],queryFn:async()=>{const{data:V}=await xe.get("/warehouses/stats");return V}}),{data:$=[],isLoading:ee}=Ve({queryKey:["warehouses",n,a,o],queryFn:async()=>{const V=new URLSearchParams;a&&V.append("status",a),o&&V.append("type",o),n&&V.append("search",n);const{data:X}=await xe.get(`/warehouses?${V}`);return X}}),{data:F}=Ve({queryKey:["warehouse",x?.id],queryFn:async()=>{const{data:V}=await xe.get(`/warehouses/${x?.id}`);return V},enabled:!!x?.id}),Y=ot({mutationFn:async V=>f?xe.put(`/warehouses/${f.id}`,V):xe.post("/warehouses",V),onSuccess:()=>{t.invalidateQueries({queryKey:["warehouses"]}),t.invalidateQueries({queryKey:["warehouse-stats"]}),r.success(f?"Warehouse updated":"Warehouse created"),de()},onError:V=>{r.error(V.response?.data?.error||"Failed to save warehouse")}}),J=ot({mutationFn:async V=>xe.delete(`/warehouses/${V}`),onSuccess:()=>{t.invalidateQueries({queryKey:["warehouses"]}),t.invalidateQueries({queryKey:["warehouse-stats"]}),r.success("Warehouse deleted"),x&&v(null)},onError:V=>{r.error(V.response?.data?.error||"Failed to delete warehouse")}}),Z=ot({mutationFn:async V=>A?xe.put(`/warehouses/${x?.id}/locations/${A.id}`,V):xe.post(`/warehouses/${x?.id}/locations`,V),onSuccess:()=>{t.invalidateQueries({queryKey:["warehouse",x?.id]}),t.invalidateQueries({queryKey:["warehouses"]}),t.invalidateQueries({queryKey:["warehouse-stats"]}),r.success(A?"Location updated":"Location added"),C(!1)},onError:V=>{r.error(V.response?.data?.error||"Failed to save location")}}),re=ot({mutationFn:async V=>xe.delete(`/warehouses/${x?.id}/locations/${V}`),onSuccess:()=>{t.invalidateQueries({queryKey:["warehouse",x?.id]}),t.invalidateQueries({queryKey:["warehouses"]}),t.invalidateQueries({queryKey:["warehouse-stats"]}),r.success("Location deleted")},onError:V=>{r.error(V.response?.data?.error||"Failed to delete location")}}),de=()=>{d(!1),p(null),D({code:"",name:"",nameAr:"",type:"RAW_MATERIALS",status:"ACTIVE",description:"",address:"",temperatureMin:"",temperatureMax:"",humidityMin:"",humidityMax:"",isRadioactive:!1,requiresQC:!0})},le=V=>{p(V),D({code:V.code,name:V.name,nameAr:V.nameAr||"",type:V.type,status:V.status,description:V.description||"",address:V.address||"",temperatureMin:V.temperatureMin?.toString()||"",temperatureMax:V.temperatureMax?.toString()||"",humidityMin:V.humidityMin?.toString()||"",humidityMax:V.humidityMax?.toString()||"",isRadioactive:V.isRadioactive,requiresQC:V.requiresQC}),d(!0)},K=V=>{V.preventDefault(),Y.mutate(O)},ue=()=>{T(null),Q({code:"",name:"",zone:"",aisle:"",rack:"",shelf:"",bin:"",capacity:"",capacityUnit:"",isActive:!0}),C(!0)},ce=V=>{T(V),Q({code:V.code,name:V.name,zone:V.zone||"",aisle:V.aisle||"",rack:V.rack||"",shelf:V.shelf||"",bin:V.bin||"",capacity:V.capacity?.toString()||"",capacityUnit:V.capacityUnit||"",isActive:V.isActive}),C(!0)},ye=V=>{V.preventDefault(),Z.mutate(M)},Se=F||x;return ee?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Warehouses"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.25rem"},children:"Manage warehouse locations and storage areas"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{de(),d(!0)},children:[e.jsx(cn,{size:16})," Add Warehouse"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Warehouses",value:U?.total||0,icon:e.jsx(lm,{size:24}),color:"primary"}),e.jsx(nt,{title:"Active",value:U?.active||0,icon:e.jsx(Ft,{size:24}),color:"success"}),e.jsx(nt,{title:"Maintenance",value:U?.maintenance||0,icon:e.jsx(fz,{size:24}),color:"warning"}),e.jsx(nt,{title:"Locations",value:U?.totalLocations||0,icon:e.jsx(mv,{size:24}),color:"info"}),e.jsx(nt,{title:"Stock Items",value:U?.totalStockItems||0,icon:e.jsx(Rr,{size:24}),color:"default"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search by name or code...",value:n,onChange:V=>i(V.target.value),style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"140px"},value:o,onChange:V=>l(V.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),Ng.map(V=>e.jsx("option",{value:V.value,children:V.label},V.value))]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"130px"},value:a,onChange:V=>s(V.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),Ag.map(V=>e.jsx("option",{value:V.value,children:V.label},V.value))]}),(a||o||n)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{s(""),l(""),i("")},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:x?"1fr 420px":"1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:$.map(V=>{const X=jC(V.type),se=qM(V.status),W=x?.id===V.id;return e.jsxs("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:W?"2px solid var(--primary)":"1px solid var(--border)",transition:"all 0.2s"},onClick:()=>v(V),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:X.bg,color:X.color,fontWeight:600},children:Ng.find(oe=>oe.value===V.type)?.label||V.type}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:oe=>{oe.stopPropagation(),le(V)},children:e.jsx(ma,{size:14})})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"1rem"},children:V.name}),V.nameAr&&e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"0.25rem",direction:"rtl"},children:V.nameAr}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"1rem"},children:e.jsx("span",{style:{fontFamily:"monospace"},children:V.code})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",fontSize:"0.8125rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(mv,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:[V._count.locations," locations"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(Rr,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:[V._count.stockItems," items"]})]}),V.temperatureMin!==null&&V.temperatureMax!==null&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",gridColumn:"span 2"},children:[e.jsx(UC,{size:14,style:{color:"var(--info)"}}),e.jsxs("span",{children:[V.temperatureMin,"C - ",V.temperatureMax,"C"]})]})]}),e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",display:"flex",gap:"0.5rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("span",{className:"badge",style:{fontSize:"0.6875rem",background:se.bg,color:se.color},children:Ag.find(oe=>oe.value===V.status)?.label||V.status}),V.isRadioactive&&e.jsxs("span",{className:"badge",style:{fontSize:"0.6875rem",background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:[e.jsx(ou,{size:10,style:{marginRight:"0.25rem"}})," Radioactive"]}),V.requiresQC&&e.jsxs("span",{className:"badge",style:{fontSize:"0.6875rem",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6"},children:[e.jsx(Bi,{size:10,style:{marginRight:"0.25rem"}})," QC Required"]})]})]},V.id)})}),$.length===0&&e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{title:"No warehouses found",message:n||a||o?"Try adjusting your filters":"Add your first warehouse to get started",icon:"package"})})]}),x&&Se&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:jC(Se.type).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:jC(Se.type).color,color:"white",marginBottom:"0.5rem"},children:Ng.find(V=>V.value===Se.type)?.label||Se.type}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:"0.5rem 0 0.25rem"},children:Se.name}),Se.nameAr&&e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:0,direction:"rtl"},children:Se.nameAr}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:"0.25rem 0 0"},children:Se.code})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>v(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsxs("div",{style:{padding:"1.25rem",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},children:[e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Status & Attributes"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("span",{className:"badge",style:{...qM(Se.status)},children:Ag.find(V=>V.value===Se.status)?.label}),Se.isRadioactive&&e.jsxs("span",{className:"badge",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:[e.jsx(ou,{size:12})," Radioactive"]}),Se.requiresQC&&e.jsxs("span",{className:"badge",style:{background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6"},children:[e.jsx(Bi,{size:12})," QC Required"]})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Capacity Overview"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(mv,{size:14,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Locations"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"1.25rem"},children:Se._count.locations})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",marginBottom:"0.25rem"},children:[e.jsx(Rr,{size:14,style:{color:"var(--success)"}}),e.jsx("span",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Stock Items"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:"1.25rem"},children:Se._count.stockItems})]})]})]}),(Se.temperatureMin!==null||Se.humidityMin!==null)&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Environmental Conditions"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[Se.temperatureMin!==null&&Se.temperatureMax!==null&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(UC,{size:16,style:{color:"var(--info)"}}),e.jsxs("span",{style:{fontSize:"0.875rem"},children:["Temperature: ",Se.temperatureMin,"C - ",Se.temperatureMax,"C"]})]}),Se.humidityMin!==null&&Se.humidityMax!==null&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(OY,{size:16,style:{color:"var(--primary)"}}),e.jsxs("span",{style:{fontSize:"0.875rem"},children:["Humidity: ",Se.humidityMin,"% - ",Se.humidityMax,"%"]})]})]})]}),Se.address&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Address"}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(_a,{size:16,style:{color:"var(--primary)",marginTop:"0.125rem"}}),e.jsx("span",{style:{fontSize:"0.875rem"},children:Se.address})]})]}),Se.description&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Description"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",margin:0},children:Se.description})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Locations (",Se.locations?.length||0,")"]}),e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:ue,children:[e.jsx(cn,{size:14})," Add"]})]}),Se.locations&&Se.locations.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Se.locations.map(V=>e.jsxs("div",{style:{padding:"0.75rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:500},children:V.name}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginLeft:"0.5rem"},children:["(",V.code,")"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(V),children:e.jsx(ma,{size:12})}),e.jsx("button",{className:"btn btn-ghost btn-sm",style:{color:"var(--error)"},onClick:()=>{confirm("Delete this location?")&&re.mutate(V.id)},children:e.jsx(Gi,{size:12})})]})]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[V.zone,V.aisle,V.rack,V.shelf].filter(Boolean).join(" / ")||"No hierarchy defined"}),e.jsx("span",{className:"badge",style:{fontSize:"0.625rem",marginTop:"0.375rem",background:V.isActive?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",color:V.isActive?"#22c55e":"#ef4444"},children:V.isActive?"Active":"Inactive"})]},V.id))}):e.jsx("div",{style:{textAlign:"center",padding:"1rem",color:"var(--text-muted)",fontSize:"0.875rem"},children:"No locations defined"})]}),e.jsx("div",{style:{marginBottom:"1.25rem"},children:e.jsx(mc,{entityType:"Warehouse",entityId:Se.id,title:"Warehouse Documents"})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>le(Se),children:[e.jsx(ma,{size:16})," Edit Warehouse"]}),Se._count.stockItems===0&&Se._count.locations===0&&e.jsx("button",{className:"btn btn-secondary",style:{color:"var(--error)"},onClick:()=>{confirm("Are you sure you want to delete this warehouse?")&&J.mutate(Se.id)},children:e.jsx(Gi,{size:16})})]})]})]})]}),u&&e.jsx("div",{className:"modal-overlay",onClick:de,children:e.jsxs("div",{className:"modal",onClick:V=>V.stopPropagation(),style:{maxWidth:"600px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:f?"Edit Warehouse":"Add Warehouse"}),e.jsx("button",{className:"btn btn-ghost",onClick:de,children:""})]}),e.jsxs("form",{onSubmit:K,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:O.code,onChange:V=>D({...O,code:V.target.value}),required:!0,disabled:!!f})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsx("select",{className:"form-select",value:O.status,onChange:V=>D({...O,status:V.target.value}),children:Ag.map(V=>e.jsx("option",{value:V.value,children:V.label},V.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:O.name,onChange:V=>D({...O,name:V.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name (Arabic)"}),e.jsx("input",{type:"text",className:"form-input",value:O.nameAr,onChange:V=>D({...O,nameAr:V.target.value}),dir:"rtl"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Type"}),e.jsx("select",{className:"form-select",value:O.type,onChange:V=>D({...O,type:V.target.value}),children:Ng.map(V=>e.jsx("option",{value:V.value,children:V.label},V.value))})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{className:"form-input",value:O.description,onChange:V=>D({...O,description:V.target.value}),rows:2})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Address"}),e.jsx("input",{type:"text",className:"form-input",value:O.address,onChange:V=>D({...O,address:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Temperature Min (C)"}),e.jsx("input",{type:"number",className:"form-input",value:O.temperatureMin,onChange:V=>D({...O,temperatureMin:V.target.value}),step:"0.1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Temperature Max (C)"}),e.jsx("input",{type:"number",className:"form-input",value:O.temperatureMax,onChange:V=>D({...O,temperatureMax:V.target.value}),step:"0.1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Humidity Min (%)"}),e.jsx("input",{type:"number",className:"form-input",value:O.humidityMin,onChange:V=>D({...O,humidityMin:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Humidity Max (%)"}),e.jsx("input",{type:"number",className:"form-input",value:O.humidityMax,onChange:V=>D({...O,humidityMax:V.target.value})})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:O.isRadioactive,onChange:V=>D({...O,isRadioactive:V.target.checked})}),"Radioactive Storage"]})}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:O.requiresQC,onChange:V=>D({...O,requiresQC:V.target.checked})}),"Requires QC"]})})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:de,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Y.isPending,children:Y.isPending?"Saving...":f?"Update":"Create"})]})]})]})}),w&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:e.jsxs("div",{className:"modal",onClick:V=>V.stopPropagation(),style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:A?"Edit Location":"Add Location"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>C(!1),children:""})]}),e.jsxs("form",{onSubmit:ye,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Code *"}),e.jsx("input",{type:"text",className:"form-input",value:M.code,onChange:V=>Q({...M,code:V.target.value}),required:!0,disabled:!!A})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name *"}),e.jsx("input",{type:"text",className:"form-input",value:M.name,onChange:V=>Q({...M,name:V.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zone"}),e.jsx("input",{type:"text",className:"form-input",value:M.zone,onChange:V=>Q({...M,zone:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Aisle"}),e.jsx("input",{type:"text",className:"form-input",value:M.aisle,onChange:V=>Q({...M,aisle:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rack"}),e.jsx("input",{type:"text",className:"form-input",value:M.rack,onChange:V=>Q({...M,rack:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Shelf"}),e.jsx("input",{type:"text",className:"form-input",value:M.shelf,onChange:V=>Q({...M,shelf:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bin"}),e.jsx("input",{type:"text",className:"form-input",value:M.bin,onChange:V=>Q({...M,bin:V.target.value})})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("input",{type:"checkbox",checked:M.isActive,onChange:V=>Q({...M,isActive:V.target.checked})}),"Active"]})})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>C(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Z.isPending,children:Z.isPending?"Saving...":A?"Update":"Create"})]})]})]})})]})}function UM(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}const WM={RAW_MATERIALS:"Raw Materials",QUARANTINE:"Quarantine",PRODUCTION:"Production",FINISHED_GOODS:"Finished Goods",COLD_STORAGE:"Cold Storage",RADIOACTIVE:"Radioactive",WASTE:"Waste"};function cEe(){const{id:t}=fl(),r=Gr(),{data:n,isLoading:i}=Ve({queryKey:["warehouse",t],queryFn:async()=>{const{data:w}=await xe.get(`/warehouses/${t}`);return w},enabled:!!t}),{data:a}=Ve({queryKey:["warehouse-stock",t],queryFn:async()=>{const{data:w}=await xe.get(`/stock?warehouseId=${t}`);return w},enabled:!!t}),{data:s}=Ve({queryKey:["warehouse-movements",t],queryFn:async()=>{const{data:w}=await xe.get(`/stock/movements?warehouseId=${t}&limit=50`);return w},enabled:!!t}),{data:o}=Ve({queryKey:["warehouse-audit",t],queryFn:async()=>{const{data:w}=await xe.get(`/audit?entityType=Warehouse&entityId=${t}`);return w.logs||[]},enabled:!!t});if(i)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!n)return e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(fn,{icon:"search",title:"Warehouse Not Found",message:"The warehouse you're looking for doesn't exist or has been deleted.",ctaLabel:"Back to Warehouses",onCta:()=>r("/warehouses")})});const l=n.locations?.length||0,u=a?.length||0,d=a?.filter(w=>w.quantity<=(w.material?.reorderPoint||0)).length||0,f=[{title:"Locations",value:l,icon:e.jsx(_a,{size:24}),color:"primary"},{title:"Stock Items",value:u,icon:e.jsx(Rr,{size:24}),color:"success"},{title:"Low Stock",value:d,icon:e.jsx(sn,{size:24}),color:d>0?"danger":"success"},{title:"Movements",value:s?.length||0,icon:e.jsx(Mp,{size:24}),color:"info"}],p=[];a?.length>0&&p.push({type:"material",label:"Stock Items",link:`/inventory?warehouseId=${t}`,count:u});const x=(o||[]).map(w=>({id:w.id,title:w.action.replace(/_/g," "),description:w.details||"",timestamp:w.createdAt,actor:w.user?.firstName?`${w.user.firstName} ${w.user.lastName}`:"System",type:w.action.includes("CREATED")?"success":"info"})),v=[{key:"overview",label:"Overview",icon:e.jsx(Ir,{size:16}),content:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Warehouse Details"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Type"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:WM[n.type]||n.type})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Status"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:e.jsx("span",{className:`badge badge-${n.isActive?"success":"default"}`,children:n.isActive?"Active":"Inactive"})})]}),n.address&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Address"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:n.address})]})]})})]}),(n.temperatureMin!==null||n.humidityMin!==null)&&e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Environmental Controls"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[n.temperatureMin!==null&&e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:[e.jsx(UC,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Temperature Range"]}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[n.temperatureMin,"C - ",n.temperatureMax,"C"]})]}),n.humidityMin!==null&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Humidity Range"}),e.jsxs("td",{style:{padding:"0.5rem 0"},children:[n.humidityMin,"% - ",n.humidityMax,"%"]})]})]})})]}),n.description&&e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Description"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",whiteSpace:"pre-wrap"},children:n.description})]})]})},{key:"locations",label:"Locations",icon:e.jsx(_a,{size:16}),badge:l,content:n.locations?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Zone"}),e.jsx("th",{children:"Aisle"}),e.jsx("th",{children:"Rack"}),e.jsx("th",{children:"Shelf"}),e.jsx("th",{children:"Bin"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.locations.map(w=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace"},children:w.code}),e.jsx("td",{children:w.zone||"-"}),e.jsx("td",{children:w.aisle||"-"}),e.jsx("td",{children:w.rack||"-"}),e.jsx("td",{children:w.shelf||"-"}),e.jsx("td",{children:w.bin||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${w.isActive?"success":"default"}`,children:w.isActive?"Active":"Inactive"})})]},w.id))})]})}):e.jsx(fn,{icon:"box",title:"No Locations",message:"No storage locations have been defined for this warehouse."})},{key:"stock",label:"Stock",icon:e.jsx(Rr,{size:16}),badge:u,content:a?.length>0?e.jsxs("div",{children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Material"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Lot/Batch"}),e.jsx("th",{style:{textAlign:"right"},children:"Quantity"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:a.slice(0,50).map(w=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:w.material?.name||"-"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:w.material?.code})]}),e.jsx("td",{style:{fontFamily:"monospace"},children:w.location?.code||"-"}),e.jsx("td",{children:w.lotNumber||w.batchNumber||"-"}),e.jsxs("td",{style:{textAlign:"right"},children:[Number(w.quantity).toLocaleString()," ",w.unit||"EA"]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${w.status==="AVAILABLE"?"success":w.status==="QUARANTINE"?"warning":w.status==="RESERVED"?"info":w.status==="EXPIRED"||w.status==="REJECTED"?"danger":"default"}`,children:w.status?.replace(/_/g," ")})})]},w.id))})]}),a.length>50&&e.jsxs("p",{style:{textAlign:"center",marginTop:"1rem",color:"var(--text-muted)"},children:["Showing 50 of ",a.length," items. ",e.jsx("a",{href:`/inventory?warehouseId=${t}`,children:"View all"})]})]}):e.jsx(fn,{icon:"package",title:"No Stock",message:"No stock is currently stored in this warehouse."})},{key:"movements",label:"Movements",icon:e.jsx(Mp,{size:16}),badge:s?.length||0,content:s?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Material"}),e.jsx("th",{style:{textAlign:"right"},children:"Quantity"}),e.jsx("th",{children:"Reference"})]})}),e.jsx("tbody",{children:s.map(w=>e.jsxs("tr",{children:[e.jsx("td",{children:UM(w.createdAt,"dd MMM yyyy HH:mm")}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${w.type?.includes("RECEIPT")||w.type?.includes("IN")?"success":w.type?.includes("ISSUE")||w.type?.includes("OUT")?"warning":"default"}`,children:w.type?.replace(/_/g," ")})}),e.jsx("td",{children:w.material?.name||"-"}),e.jsx("td",{style:{textAlign:"right"},children:Number(w.quantity).toLocaleString()}),e.jsx("td",{style:{fontFamily:"monospace"},children:w.reference||"-"})]},w.id))})]})}):e.jsx(fn,{icon:"clock",title:"No Movements",message:"No stock movements recorded for this warehouse."})},{key:"documents",label:"Documents",icon:e.jsx(Ir,{size:16}),content:e.jsx(mc,{entityType:"Warehouse",entityId:t})},{key:"timeline",label:"Timeline",icon:e.jsx(jm,{size:16}),badge:x.length,content:x.length>0?e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:x.map(w=>e.jsxs("div",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:w.type==="success"?"var(--success)":"var(--primary)",marginTop:"0.5rem",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:w.title}),w.description&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:w.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[w.actor,"  ",UM(w.timestamp,"dd MMM yyyy HH:mm")]})]})]},w.id))}):e.jsx(fn,{icon:"search",title:"No Activity",message:"No activity recorded for this warehouse yet."})}];return e.jsx(gy,{title:n.name,code:n.code,status:{value:n.isActive?"ACTIVE":"INACTIVE",label:n.isActive?"Active":"Inactive",variant:n.isActive?"success":"default"},metadata:[{label:"Type",value:WM[n.type]||n.type},{label:"Locations",value:`${l}`}],kpis:f,tabs:v,defaultTab:"overview",actions:[{label:"Edit",icon:e.jsx(t0,{size:16}),onClick:()=>r("/warehouses"),variant:"secondary"}],linkedRecords:p,timeline:x,showTimeline:!1,backUrl:"/warehouses",backLabel:"Warehouses"})}const wC=[{value:"DRAFT",label:"Draft",color:"#94a3b8"},{value:"PENDING_QC",label:"Pending QC",color:"#f59e0b"},{value:"APPROVED",label:"Approved",color:"#22c55e"},{value:"PARTIALLY_APPROVED",label:"Partial",color:"#3b82f6"},{value:"REJECTED",label:"Rejected",color:"#ef4444"}];function dEe(){Gr();const[t,r]=k.useState([]),[n,i]=k.useState(null),[a,s]=k.useState([]),[o,l]=k.useState([]),[u,d]=k.useState(!0),[f,p]=k.useState({}),[x,v]=k.useState(!1),[w,C]=k.useState(!1),[A,T]=k.useState(!1),[O,D]=k.useState(null),[M,Q]=k.useState(null),[U,$]=k.useState(null),[ee,F]=k.useState({poId:"",deliveryNoteNumber:"",notes:"",items:[]}),[Y,J]=k.useState({acceptedQty:0,rejectedQty:0,rejectionReason:"",warehouseId:"",binLocation:""});k.useEffect(()=>{Z(),re()},[f]);const Z=async()=>{try{d(!0);const W=new URLSearchParams;f.status&&W.append("status",f.status),f.search&&W.append("search",f.search);const[oe,ge,be]=await Promise.all([xe.get(`/grn?${W}`),xe.get("/grn/stats"),xe.get("/grn/pending-pos")]);r(oe.data),i(ge.data),s(be.data)}catch(W){console.error("Error fetching GRNs:",W)}finally{d(!1)}},re=async()=>{try{const W=await xe.get("/warehouses?status=ACTIVE");l(W.data)}catch(W){console.error("Error fetching warehouses:",W)}},de=W=>{Q(W),F({poId:W.id,deliveryNoteNumber:"",notes:"",items:W.items.map(oe=>({poItemId:oe.id,itemCode:oe.itemCode,itemName:oe.itemName,orderedQty:oe.orderedQty,alreadyReceived:oe.receivedQty,receivedQty:oe.orderedQty-oe.receivedQty,unit:oe.unit,lotNumber:"",batchNumber:"",expiryDate:"",manufacturingDate:"",warehouseId:"",binLocation:"",notes:""}))})},le=async W=>{W.preventDefault();try{const oe={poId:ee.poId,deliveryNoteNumber:ee.deliveryNoteNumber,notes:ee.notes,items:ee.items.filter(ge=>ge.receivedQty>0).map(ge=>({poItemId:ge.poItemId,receivedQty:ge.receivedQty,unit:ge.unit,lotNumber:ge.lotNumber,batchNumber:ge.batchNumber,expiryDate:ge.expiryDate||null,manufacturingDate:ge.manufacturingDate||null,warehouseId:ge.warehouseId||null,binLocation:ge.binLocation,notes:ge.notes}))};await xe.post("/grn",oe),v(!1),Q(null),Z()}catch(oe){alert(oe.response?.data?.error||"Failed to create GRN")}},K=async W=>{try{if(await xe.post(`/grn/${W.id}/submit`),Z(),w){const oe=await xe.get(`/grn/${W.id}`);D(oe.data)}}catch(oe){alert(oe.response?.data?.error||"Failed to submit GRN")}},ue=W=>{$(W),J({acceptedQty:W.receivedQty,rejectedQty:0,rejectionReason:"",warehouseId:W.warehouseId||"",binLocation:W.binLocation||""}),T(!0)},ce=async W=>{if(W.preventDefault(),!(!O||!U))try{await xe.post(`/grn/${O.id}/approve-item/${U.id}`,Y),T(!1);const oe=await xe.get(`/grn/${O.id}`);D(oe.data),Z()}catch(oe){alert(oe.response?.data?.error||"Failed to complete QC")}},ye=async()=>{if(O)try{await xe.post(`/grn/${O.id}/complete`);const W=await xe.get(`/grn/${O.id}`);D(W.data),Z()}catch(W){alert(W.response?.data?.error||"Failed to complete GRN")}},Se=async()=>{if(O)try{await xe.post(`/grn/${O.id}/post-to-stock`),alert("GRN posted to stock successfully"),Z()}catch(W){alert(W.response?.data?.error||"Failed to post to stock")}},V=W=>{const oe=wC.find(ge=>ge.value===W);return{backgroundColor:`${oe?.color}20`,color:oe?.color}},X=W=>({QUARANTINE:{bg:"#fef3c7",color:"#92400e"},RELEASED:{bg:"#dcfce7",color:"#166534"},REJECTED:{bg:"#fee2e2",color:"#991b1b"}})[W]||{bg:"#f1f5f9",color:"#475569"},se=[{key:"search",label:"Search",type:"search",placeholder:"Search GRN or PO number..."},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},...wC.map(W=>({value:W.value,label:W.label}))]}];return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Goods Receiving"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Receive goods from purchase orders and manage QC"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>v(!0),children:[e.jsx(cn,{size:16})," Receive Goods"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total",value:n?.total||0,icon:e.jsx(Rr,{size:20}),color:"primary",onClick:()=>p({}),selected:!f.status}),e.jsx(nt,{title:"Draft",value:n?.draft||0,icon:e.jsx(Ir,{size:20}),onClick:()=>p({status:"DRAFT"}),selected:f.status==="DRAFT"}),e.jsx(nt,{title:"Pending QC",value:n?.pendingQC||0,icon:e.jsx(Qt,{size:20}),color:"warning",onClick:()=>p({status:"PENDING_QC"}),selected:f.status==="PENDING_QC"}),e.jsx(nt,{title:"Approved",value:n?.approved||0,icon:e.jsx(Ai,{size:20}),color:"success",onClick:()=>p({status:"APPROVED"}),selected:f.status==="APPROVED"}),e.jsx(nt,{title:"Today",value:n?.receivedToday||0,icon:e.jsx($n,{size:20}),color:"info"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:se,values:f,onChange:(W,oe)=>p(ge=>({...ge,[W]:oe})),onReset:()=>p({})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["GRN List (",t?.length||0,")"]})}),u?e.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:"Loading..."}):t.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"var(--text-muted)"},children:[e.jsx(Rr,{size:48,style:{marginBottom:"1rem",opacity:.5}}),e.jsx("h3",{style:{marginBottom:"0.5rem"},children:"No goods receiving notes found"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Create your first GRN"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>v(!0),children:[e.jsx(cn,{size:16})," Receive Goods"]})]}):e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN #"}),e.jsx("th",{children:"PO #"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Received Date"}),e.jsx("th",{children:"Delivery Note"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:"120px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:t.map(W=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(nr,{to:`/grn/${W.id}`,style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem",color:"var(--primary)"},children:W.grnNumber})}),e.jsx("td",{children:W.purchaseOrder?.poNumber?e.jsx(nr,{to:`/purchase-orders/${W.poId}`,style:{color:"var(--text-muted)",fontSize:"0.875rem"},children:W.purchaseOrder.poNumber}):"-"}),e.jsx("td",{children:e.jsx("div",{style:{fontWeight:500},children:W.supplier?.name||"-"})}),e.jsx("td",{children:new Date(W.receivedDate).toLocaleDateString()}),e.jsx("td",{children:W.deliveryNoteNumber||"-"}),e.jsx("td",{children:e.jsxs("span",{className:"badge badge-default",children:[W._count?.items||0," items"]})}),e.jsx("td",{children:e.jsx(Pn,{status:W.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[e.jsx(nr,{to:`/grn/${W.id}`,className:"btn btn-sm btn-outline",title:"View Details",children:e.jsx(os,{size:14})}),W.status==="DRAFT"&&e.jsx("button",{className:"btn btn-sm btn-outline",onClick:oe=>{oe.stopPropagation(),K(W)},title:"Submit for QC",children:e.jsx(Qi,{size:14})})]})})]},W.id))})]})]}),x&&e.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:e.jsxs("div",{className:"modal",onClick:W=>W.stopPropagation(),style:{maxWidth:"900px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Receive Goods"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>v(!1),children:""})]}),M?e.jsxs("form",{onSubmit:le,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsxs("strong",{children:["PO: ",M.poNumber]})," - ",M.supplier.name,e.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",style:{marginLeft:"1rem"},onClick:()=>Q(null),children:"Change"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Delivery Note Number"}),e.jsx("input",{type:"text",className:"form-input",value:ee.deliveryNoteNumber,onChange:W=>F({...ee,deliveryNoteNumber:W.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes"}),e.jsx("input",{type:"text",className:"form-input",value:ee.notes,onChange:W=>F({...ee,notes:W.target.value})})]})]}),e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Items to Receive"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{fontSize:"0.875rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Ordered"}),e.jsx("th",{children:"Already Recv"}),e.jsx("th",{children:"Receiving Qty"}),e.jsx("th",{children:"Lot #"}),e.jsx("th",{children:"Batch #"}),e.jsx("th",{children:"Expiry"}),e.jsx("th",{children:"Warehouse"})]})}),e.jsx("tbody",{children:ee.items.map((W,oe)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{children:e.jsx("strong",{children:W.itemCode})}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W.itemName})]}),e.jsxs("td",{children:[W.orderedQty," ",W.unit]}),e.jsx("td",{children:W.alreadyReceived}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-input",style:{width:"80px"},value:W.receivedQty,onChange:ge=>{const be=[...ee.items];be[oe].receivedQty=parseFloat(ge.target.value)||0,F({...ee,items:be})},min:0,max:W.orderedQty-W.alreadyReceived})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-input",style:{width:"100px"},value:W.lotNumber,onChange:ge=>{const be=[...ee.items];be[oe].lotNumber=ge.target.value,F({...ee,items:be})}})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-input",style:{width:"100px"},value:W.batchNumber,onChange:ge=>{const be=[...ee.items];be[oe].batchNumber=ge.target.value,F({...ee,items:be})}})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-input",style:{width:"130px"},value:W.expiryDate,onChange:ge=>{const be=[...ee.items];be[oe].expiryDate=ge.target.value,F({...ee,items:be})}})}),e.jsx("td",{children:e.jsxs("select",{className:"form-select",style:{width:"150px"},value:W.warehouseId,onChange:ge=>{const be=[...ee.items];be[oe].warehouseId=ge.target.value,F({...ee,items:be})},children:[e.jsx("option",{value:"",children:"Select..."}),o.map(ge=>e.jsxs("option",{value:ge.id,children:[ge.code," - ",ge.name]},ge.id))]})})]},W.poItemId))})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>v(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Create GRN"})]})]}):e.jsxs("div",{className:"modal-body",children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Select Purchase Order"}),a.length===0?e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center",padding:"2rem"},children:"No pending purchase orders available for receiving"}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO #"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:a.map(W=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:W.poNumber})}),e.jsx("td",{children:W.supplier.name}),e.jsx("td",{children:W.status}),e.jsx("td",{children:W.items.length}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>de(W),children:"Select"})})]},W.id))})]})]})]})}),w&&O&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:e.jsxs("div",{className:"modal",onClick:W=>W.stopPropagation(),style:{maxWidth:"900px",maxHeight:"90vh",overflow:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:["GRN Details - ",O.grnNumber]}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>C(!1),children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"PO Number"}),e.jsx("div",{children:O.purchaseOrder?.poNumber})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Supplier"}),e.jsx("div",{children:O.supplier?.name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Status"}),e.jsx("span",{className:"badge",style:V(O.status),children:wC.find(W=>W.value===O.status)?.label})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Received Date"}),e.jsx("div",{children:new Date(O.receivedDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Delivery Note"}),e.jsx("div",{children:O.deliveryNoteNumber||"-"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("h3",{children:["Items (",O.items.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[O.status==="DRAFT"&&e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>K(O),children:[e.jsx(Qi,{size:14})," Submit for QC"]}),O.status==="PENDING_QC"&&O.items.every(W=>W.status!=="QUARANTINE")&&e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:ye,children:[e.jsx(sf,{size:14})," Complete GRN"]}),["APPROVED","PARTIALLY_APPROVED"].includes(O.status)&&e.jsxs("button",{className:"btn btn-success btn-sm",onClick:Se,children:[e.jsx(Rr,{size:14})," Post to Stock"]})]})]}),e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Received"}),e.jsx("th",{children:"Accepted"}),e.jsx("th",{children:"Rejected"}),e.jsx("th",{children:"Lot/Batch"}),e.jsx("th",{children:"Expiry"}),e.jsx("th",{children:"Status"}),O.status==="PENDING_QC"&&e.jsx("th",{children:"QC"})]})}),e.jsx("tbody",{children:O.items.map(W=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{children:e.jsx("strong",{children:W.poItem?.itemCode})}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W.poItem?.itemName})]}),e.jsxs("td",{children:[W.receivedQty," ",W.unit]}),e.jsx("td",{style:{color:"#22c55e"},children:W.acceptedQty}),e.jsx("td",{style:{color:"#ef4444"},children:W.rejectedQty}),e.jsxs("td",{children:[e.jsx("div",{children:W.lotNumber||"-"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W.batchNumber})]}),e.jsx("td",{children:W.expiryDate?new Date(W.expiryDate).toLocaleDateString():"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:X(W.status),children:W.status})}),O.status==="PENDING_QC"&&e.jsx("td",{children:W.status==="QUARANTINE"&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>ue(W),children:"QC"})})]},W.id))})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn",onClick:()=>C(!1),children:"Close"})})]})}),A&&U&&e.jsx("div",{className:"modal-overlay",onClick:()=>T(!1),children:e.jsxs("div",{className:"modal",onClick:W=>W.stopPropagation(),style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"QC Review"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>T(!1),children:""})]}),e.jsxs("form",{onSubmit:ce,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",marginBottom:"1rem"},children:[e.jsx("strong",{children:U.poItem?.itemCode})," - ",U.poItem?.itemName,e.jsxs("div",{style:{marginTop:"0.5rem",color:"var(--text-muted)"},children:["Received Qty: ",U.receivedQty," ",U.unit]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Accepted Qty"}),e.jsx("input",{type:"number",className:"form-input",value:Y.acceptedQty,onChange:W=>{const oe=parseFloat(W.target.value)||0;J({...Y,acceptedQty:oe,rejectedQty:U.receivedQty-oe})},min:0,max:U.receivedQty})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rejected Qty"}),e.jsx("input",{type:"number",className:"form-input",value:Y.rejectedQty,onChange:W=>{const oe=parseFloat(W.target.value)||0;J({...Y,rejectedQty:oe,acceptedQty:U.receivedQty-oe})},min:0,max:U.receivedQty})]})]}),Y.rejectedQty>0&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rejection Reason *"}),e.jsx("textarea",{className:"form-input",value:Y.rejectionReason,onChange:W=>J({...Y,rejectionReason:W.target.value}),required:Y.rejectedQty>0,rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Warehouse"}),e.jsxs("select",{className:"form-select",value:Y.warehouseId,onChange:W=>J({...Y,warehouseId:W.target.value}),children:[e.jsx("option",{value:"",children:"Select warehouse..."}),o.map(W=>e.jsxs("option",{value:W.id,children:[W.code," - ",W.name]},W.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bin Location"}),e.jsx("input",{type:"text",className:"form-input",value:Y.binLocation,onChange:W=>J({...Y,binLocation:W.target.value})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>T(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Complete QC"})]})]})]})})]})}function SC(t,r){try{if(!t)return"-";const n=new Date(t);return isNaN(n.getTime())?"-":Ze(n,r)}catch{return"-"}}const uEe={DRAFT:"default",PENDING_QC:"warning",APPROVED:"success",PARTIALLY_APPROVED:"info",REJECTED:"danger"};function hEe(){const{id:t}=fl(),r=Gr(),n=pr(),i=gn(),{data:a,isLoading:s}=Ve({queryKey:["grn",t],queryFn:async()=>{const{data:D}=await xe.get(`/grn/${t}`);return D},enabled:!!t}),{data:o}=Ve({queryKey:["grn-audit",t],queryFn:async()=>{const{data:D}=await xe.get(`/audit?entityType=GoodsReceivingNote&entityId=${t}`);return D.logs||[]},enabled:!!t}),l=ot({mutationFn:async()=>{const{data:D}=await xe.post(`/grn/${t}/submit`);return D},onSuccess:()=>{n.invalidateQueries({queryKey:["grn",t]}),i.success("GRN submitted for QC")},onError:D=>{i.error(D.response?.data?.error||"Failed to submit GRN")}}),u=ot({mutationFn:async()=>{const{data:D}=await xe.post(`/grn/${t}/approve`);return D},onSuccess:()=>{n.invalidateQueries({queryKey:["grn",t]}),i.success("GRN approved")},onError:D=>{i.error(D.response?.data?.error||"Failed to approve GRN")}});if(s)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});if(!a)return e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(fn,{icon:"search",title:"GRN Not Found",message:"The goods receiving note you're looking for doesn't exist or has been deleted.",ctaLabel:"Back to Goods Receiving",onCta:()=>r("/grn")})});const d=a.items?.length||0,f=a.items?.reduce((D,M)=>D+Number(M.receivedQuantity||0),0)||0,p=a.items?.reduce((D,M)=>D+Number(M.orderedQuantity||0),0)||0,x=p>0?Math.round(f/p*100):0,v=a.items?.filter(D=>D.qcStatus==="PASSED").length||0,w=[{title:"Line Items",value:d,icon:e.jsx(Rr,{size:24}),color:"primary"},{title:"Qty Received",value:f.toLocaleString(),icon:e.jsx(dn,{size:24}),color:"success"},{title:"Receipt Rate",value:`${x}%`,icon:e.jsx(Pv,{size:24}),color:x>=100?"success":x>=80?"warning":"danger"},{title:"QC Passed",value:`${v}/${d}`,icon:e.jsx(Ai,{size:24}),color:v===d?"success":v>0?"warning":"default"}],C=[];a.purchaseOrder&&C.push({type:"purchaseOrder",label:a.purchaseOrder.poNumber,link:`/purchase-orders/${a.purchaseOrder.id}`}),a.supplier&&C.push({type:"supplier",label:a.supplier.name,link:`/suppliers/${a.supplier.id}`}),a.warehouse&&C.push({type:"warehouse",label:a.warehouse.name,link:`/warehouses/${a.warehouse.id}`});const A=(o||[]).map(D=>({id:D.id,title:D.action.replace(/_/g," "),description:D.details||"",timestamp:D.createdAt,actor:D.user?.firstName?`${D.user.firstName} ${D.user.lastName}`:"System",type:D.action.includes("APPROVED")?"success":D.action.includes("REJECTED")?"error":"info"})),T=()=>{const D=[];return a.status==="DRAFT"&&D.push({label:"Submit for QC",icon:e.jsx(Pv,{size:16}),onClick:()=>l.mutate(),variant:"primary",loading:l.isPending}),a.status==="PENDING_QC"&&D.push({label:"Approve",icon:e.jsx(Ai,{size:16}),onClick:()=>u.mutate(),variant:"primary",loading:u.isPending}),a.status==="DRAFT"&&D.push({label:"Edit",icon:e.jsx(t0,{size:16}),onClick:()=>r("/grn"),variant:"secondary"}),D},O=[{key:"overview",label:"Overview",icon:e.jsx(Ir,{size:16}),content:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Receipt Details"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:[e.jsx($n,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Received Date"]}),e.jsx("td",{style:{padding:"0.5rem 0"},children:SC(a.receivedDate,"dd MMM yyyy")})]}),e.jsxs("tr",{children:[e.jsxs("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:[e.jsx(Uo,{size:14,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Received By"]}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.receivedBy?.name||"-"})]}),a.deliveryNote&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Delivery Note"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.deliveryNote})]}),a.vehicleNumber&&e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Vehicle Number"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.vehicleNumber})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Source"}),e.jsx("table",{style:{width:"100%",fontSize:"0.875rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)",width:"40%"},children:"Purchase Order"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.purchaseOrder?e.jsx("a",{href:"#",onClick:D=>{D.preventDefault(),r(`/purchase-orders/${a.purchaseOrder.id}`)},style:{color:"var(--primary)"},children:a.purchaseOrder.poNumber}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Supplier"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.supplier?e.jsx("a",{href:"#",onClick:D=>{D.preventDefault(),r(`/suppliers/${a.supplier.id}`)},style:{color:"var(--primary)"},children:a.supplier.name}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"0.5rem 0",color:"var(--text-muted)"},children:"Warehouse"}),e.jsx("td",{style:{padding:"0.5rem 0"},children:a.warehouse?e.jsx("a",{href:"#",onClick:D=>{D.preventDefault(),r(`/warehouses/${a.warehouse.id}`)},style:{color:"var(--primary)"},children:a.warehouse.name}):"-"})]})]})})]}),a.notes&&e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("h4",{style:{marginBottom:"1rem",fontWeight:600},children:"Notes"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",whiteSpace:"pre-wrap"},children:a.notes})]})]})},{key:"items",label:"Line Items",icon:e.jsx(Rr,{size:16}),badge:d,content:a.items?.length>0?e.jsx("div",{children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Material"}),e.jsx("th",{style:{textAlign:"right"},children:"Ordered"}),e.jsx("th",{style:{textAlign:"right"},children:"Received"}),e.jsx("th",{children:"Lot/Batch"}),e.jsx("th",{children:"QC Status"})]})}),e.jsx("tbody",{children:a.items.map((D,M)=>e.jsxs("tr",{children:[e.jsx("td",{children:M+1}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:D.material?.name||D.description||"-"}),D.material?.code&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:D.material.code})]}),e.jsx("td",{style:{textAlign:"right"},children:Number(D.orderedQuantity||0).toLocaleString()}),e.jsx("td",{style:{textAlign:"right"},children:Number(D.receivedQuantity||0).toLocaleString()}),e.jsx("td",{style:{fontFamily:"monospace"},children:D.lotNumber||D.batchNumber||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${D.qcStatus==="PASSED"?"success":D.qcStatus==="FAILED"?"danger":D.qcStatus==="PENDING"?"warning":"default"}`,children:D.qcStatus||"Pending"})})]},D.id))})]})}):e.jsx(fn,{icon:"package",title:"No Line Items",message:"No items have been added to this GRN."})},{key:"documents",label:"Documents",icon:e.jsx(Ir,{size:16}),content:e.jsx(mc,{entityType:"GoodsReceivingNote",entityId:t})},{key:"timeline",label:"Timeline",icon:e.jsx(jm,{size:16}),badge:A.length,content:A.length>0?e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto"},children:A.map(D=>e.jsxs("div",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border)",display:"flex",gap:"1rem",alignItems:"flex-start"},children:[e.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:D.type==="success"?"var(--success)":D.type==="error"?"var(--danger)":"var(--primary)",marginTop:"0.5rem",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:"0.25rem"},children:D.title}),D.description&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:D.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[D.actor,"  ",SC(D.timestamp,"dd MMM yyyy HH:mm")]})]})]},D.id))}):e.jsx(fn,{icon:"search",title:"No Activity",message:"No activity recorded for this GRN yet."})}];return e.jsx(gy,{title:`GRN ${a.grnNumber}`,code:a.grnNumber,status:{value:a.status,label:a.status?.replace(/_/g," "),variant:uEe[a.status]||"default"},metadata:[{label:"Received",value:SC(a.receivedDate,"dd MMM yyyy")},{label:"Supplier",value:a.supplier?.name||"-"}],kpis:w,tabs:O,defaultTab:"overview",actions:T(),linkedRecords:C,timeline:A,showTimeline:!1,backUrl:"/grn",backLabel:"Goods Receiving"})}const _v=[{value:"AVAILABLE",label:"Available",color:"#22c55e"},{value:"QUARANTINE",label:"Quarantine",color:"#f59e0b"},{value:"RESERVED",label:"Reserved",color:"#3b82f6"},{value:"ON_HOLD",label:"On Hold",color:"#94a3b8"},{value:"EXPIRED",label:"Expired",color:"#ef4444"},{value:"REJECTED",label:"Rejected",color:"#dc2626"}],gA=[{value:"RECEIPT",label:"Receipt",color:"#22c55e"},{value:"ISSUE",label:"Issue",color:"#ef4444"},{value:"TRANSFER_IN",label:"Transfer In",color:"#3b82f6"},{value:"TRANSFER_OUT",label:"Transfer Out",color:"#f59e0b"},{value:"ADJUSTMENT_IN",label:"Adjustment +",color:"#22c55e"},{value:"ADJUSTMENT_OUT",label:"Adjustment -",color:"#ef4444"},{value:"RETURN",label:"Return",color:"#8b5cf6"},{value:"SCRAP",label:"Scrap",color:"#dc2626"}],CC=t=>{const r=_v.find(n=>n.value===t);return{bg:`${r?.color}20`,color:r?.color||"#6b7280"}},HM=t=>{const r=gA.find(n=>n.value===t);return{backgroundColor:`${r?.color}20`,color:r?.color}};function fEe(){const t=pr(),r=gn(),[n,i]=k.useState("stock"),[a,s]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(!1),[x,v]=k.useState(null),[w,C]=k.useState(!1),[A,T]=k.useState(!1),[O,D]=k.useState(null),[M,Q]=k.useState({adjustmentQty:0,reason:"",notes:""}),[U,$]=k.useState({toWarehouseId:"",toLocationId:"",quantity:0,reason:"",notes:""}),{data:ee}=Ve({queryKey:["stock-stats"],queryFn:async()=>{const{data:se}=await xe.get("/stock/stats");return se}}),{data:F=[],isLoading:Y}=Ve({queryKey:["stock",a,o,u,f],queryFn:async()=>{const se=new URLSearchParams;o&&se.append("warehouseId",o),u&&se.append("status",u),a&&se.append("search",a),f&&se.append("lowStock","true");const{data:W}=await xe.get(`/stock?${se}`);return W},enabled:n==="stock"}),{data:J=[]}=Ve({queryKey:["stock-movements",o],queryFn:async()=>{const se=new URLSearchParams;o&&se.append("warehouseId",o);const{data:W}=await xe.get(`/stock/movements?${se}`);return W},enabled:n==="movements"}),{data:Z=[]}=Ve({queryKey:["warehouses-active"],queryFn:async()=>{const{data:se}=await xe.get("/warehouses?status=ACTIVE");return se}}),{data:re}=Ve({queryKey:["stock-item",x?.id],queryFn:async()=>{const{data:se}=await xe.get(`/stock/${x?.id}`);return se},enabled:!!x?.id}),de=ot({mutationFn:async se=>xe.post("/stock/adjust",se),onSuccess:()=>{t.invalidateQueries({queryKey:["stock"]}),t.invalidateQueries({queryKey:["stock-stats"]}),t.invalidateQueries({queryKey:["stock-item",x?.id]}),r.success("Stock adjusted successfully"),C(!1)},onError:se=>{r.error(se.response?.data?.error||"Failed to adjust stock")}}),le=ot({mutationFn:async se=>xe.post("/stock/transfer",se),onSuccess:()=>{t.invalidateQueries({queryKey:["stock"]}),t.invalidateQueries({queryKey:["stock-stats"]}),t.invalidateQueries({queryKey:["stock-item",x?.id]}),r.success("Stock transferred successfully"),T(!1)},onError:se=>{r.error(se.response?.data?.error||"Failed to transfer stock")}}),K=se=>se.material.minStockLevel>0&&se.availableQty<se.material.minStockLevel,ue=se=>{if(!se.expiryDate)return!1;const W=new Date(se.expiryDate),oe=new Date;return oe.setDate(oe.getDate()+30),W<=oe&&W>new Date},ce=se=>{D(se),Q({adjustmentQty:0,reason:"",notes:""}),C(!0)},ye=se=>{D(se),$({toWarehouseId:"",toLocationId:"",quantity:se.availableQty,reason:"",notes:""}),T(!0)},Se=se=>{se.preventDefault(),O&&de.mutate({stockItemId:O.id,...M})},V=se=>{se.preventDefault(),O&&le.mutate({stockItemId:O.id,...U})},X=re||x;return Y&&n==="stock"?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h1",{children:"Inventory"}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:"0.25rem"},children:"Track stock levels and movements"})]})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Items",value:ee?.totalItems||0,icon:e.jsx(Rr,{size:24}),color:"primary"}),e.jsx(nt,{title:"Available",value:ee?.available||0,icon:e.jsx(Ft,{size:24}),color:"success"}),e.jsx(nt,{title:"Quarantine",value:ee?.quarantine||0,icon:e.jsx(lz,{size:24}),color:"warning"}),e.jsx(nt,{title:"Low Stock",value:ee?.lowStockCount||0,icon:e.jsx(Hr,{size:24}),color:"danger"}),e.jsx(nt,{title:"Expiring Soon",value:ee?.expiringSoon||0,icon:e.jsx(Qt,{size:24}),color:"info"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsxs("button",{className:`btn ${n==="stock"?"btn-primary":"btn-secondary"}`,onClick:()=>i("stock"),children:[e.jsx(Rr,{size:16})," Stock Items"]}),e.jsxs("button",{className:`btn ${n==="movements"?"btn-primary":"btn-secondary"}`,onClick:()=>i("movements"),children:[e.jsx(u8,{size:16})," Movements"]})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search material, lot, batch...",value:a,onChange:se=>s(se.target.value),style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"160px"},value:o,onChange:se=>l(se.target.value),children:[e.jsx("option",{value:"",children:"All Warehouses"}),Z.map(se=>e.jsxs("option",{value:se.id,children:[se.code," - ",se.name]},se.id))]}),n==="stock"&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"130px"},value:u,onChange:se=>d(se.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),_v.map(se=>e.jsx("option",{value:se.value,children:se.label},se.value))]}),e.jsxs("button",{className:`btn btn-sm ${f?"btn-warning":"btn-secondary"}`,onClick:()=>p(!f),children:[e.jsx(Hr,{size:14})," Low Stock"]})]}),(a||o||u||f)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{s(""),l(""),d(""),p(!1)},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),n==="stock"&&e.jsxs("div",{className:"grid",style:{gridTemplateColumns:x?"1fr 420px":"1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1rem"},children:F.map(se=>{const W=CC(se.status),oe=x?.id===se.id,ge=K(se),be=ue(se);return e.jsxs("div",{className:"card",style:{padding:"1.25rem",cursor:"pointer",border:oe?"2px solid var(--primary)":ge?"2px solid var(--error)":"1px solid var(--border)",transition:"all 0.2s",background:ge?"rgba(239, 68, 68, 0.03)":void 0},onClick:()=>v(se),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsx("span",{className:"badge",style:{background:W.bg,color:W.color,fontWeight:600},children:_v.find(Le=>Le.value===se.status)?.label||se.status}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[ge&&e.jsxs("span",{className:"badge",style:{fontSize:"0.625rem",background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:[e.jsx(Hr,{size:10})," Low"]}),be&&e.jsxs("span",{className:"badge",style:{fontSize:"0.625rem",background:"rgba(245, 158, 11, 0.1)",color:"#f59e0b"},children:[e.jsx(Qt,{size:10})," Expiring"]})]})]}),e.jsx("h3",{style:{fontWeight:600,marginBottom:"0.25rem",fontSize:"1rem"},children:se.material.name}),e.jsx("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:e.jsx("span",{style:{fontFamily:"monospace"},children:se.material.code})}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",textTransform:"uppercase"},children:"Total"}),e.jsx("div",{style:{fontWeight:600},children:se.quantity})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",textTransform:"uppercase"},children:"Reserved"}),e.jsx("div",{style:{fontWeight:600,color:"#3b82f6"},children:se.reservedQty})]}),e.jsxs("div",{style:{textAlign:"center",padding:"0.5rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"var(--radius)"},children:[e.jsx("div",{style:{fontSize:"0.625rem",color:"var(--text-muted)",textTransform:"uppercase"},children:"Available"}),e.jsx("div",{style:{fontWeight:600,color:"#22c55e"},children:se.availableQty})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem",fontSize:"0.8125rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(lm,{size:14,style:{color:"var(--text-muted)"}}),e.jsx("span",{children:se.warehouse.code}),se.location&&e.jsxs("span",{style:{color:"var(--text-muted)"},children:["/ ",se.location.code]})]}),se.lotNumber&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem"},children:[e.jsx(MA,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{children:["Lot: ",se.lotNumber]})]})]}),se.expiryDate&&e.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid var(--border)",fontSize:"0.75rem",display:"flex",alignItems:"center",gap:"0.375rem",color:be?"#f59e0b":"var(--text-muted)"},children:[e.jsx($n,{size:12}),"Expires: ",new Date(se.expiryDate).toLocaleDateString()]})]},se.id)})}),F.length===0&&e.jsx("div",{className:"card",style:{padding:"2rem"},children:e.jsx(fn,{title:"No stock items found",message:a||o||u?"Try adjusting your filters":"No stock items available",icon:"package"})})]}),x&&X&&e.jsxs("div",{className:"card",style:{padding:0,height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsx("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border)",background:CC(X.status).bg},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:CC(X.status).color,color:"white",marginBottom:"0.5rem"},children:_v.find(se=>se.value===X.status)?.label||X.status}),e.jsx("h3",{style:{fontWeight:600,fontSize:"1.125rem",margin:"0.5rem 0 0.25rem"},children:X.material.name}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:0},children:X.material.code})]}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>v(null),style:{borderRadius:"50%",width:"28px",height:"28px",padding:0},children:e.jsx(Dr,{size:14})})]})}),e.jsxs("div",{style:{padding:"1.25rem",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},children:[e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Quantity Summary"}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem"},children:[e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Total"}),e.jsx("div",{style:{fontWeight:700,fontSize:"1.25rem"},children:X.quantity}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:X.unit})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Reserved"}),e.jsx("div",{style:{fontWeight:700,fontSize:"1.25rem",color:"#3b82f6"},children:X.reservedQty}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:X.unit})]}),e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"var(--radius)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:"Available"}),e.jsx("div",{style:{fontWeight:700,fontSize:"1.25rem",color:"#22c55e"},children:X.availableQty}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:X.unit})]})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.75rem"},children:"Location Details"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(lm,{size:16,style:{color:"var(--primary)"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:500},children:[X.warehouse.code," - ",X.warehouse.name]}),X.location&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Location: ",X.location.code]})]})]})})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Batch Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Lot Number"}),e.jsx("span",{style:{fontWeight:500},children:X.lotNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Batch Number"}),e.jsx("span",{style:{fontWeight:500},children:X.batchNumber||"-"})]})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Dates"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Manufacturing Date"}),e.jsx("span",{style:{fontWeight:500},children:X.manufacturingDate?new Date(X.manufacturingDate).toLocaleDateString():"-"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Received Date"}),e.jsx("span",{style:{fontWeight:500},children:X.receivedDate?new Date(X.receivedDate).toLocaleDateString():"-"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",background:ue(X)?"rgba(245, 158, 11, 0.1)":void 0},children:[e.jsx("span",{style:{color:ue(X)?"#f59e0b":"var(--text-muted)"},children:"Expiry Date"}),e.jsx("span",{style:{fontWeight:500,color:ue(X)?"#f59e0b":void 0},children:X.expiryDate?new Date(X.expiryDate).toLocaleDateString():"-"})]})]})]}),X.unitCost&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Cost Information"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:[e.jsx(PA,{size:16,style:{color:"var(--success)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Unit Cost"}),e.jsx("div",{style:{fontWeight:600},children:ci(X.unitCost)})]})]})]}),X.movements&&X.movements.length>0&&e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.5rem"},children:"Recent Movements"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.375rem"},children:X.movements.slice(0,5).map(se=>e.jsxs("div",{style:{padding:"0.5rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",fontSize:"0.8125rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{className:"badge",style:HM(se.type),children:gA.find(W=>W.value===se.type)?.label}),e.jsxs("span",{style:{fontWeight:500},children:[se.quantity," ",se.unit]})]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:new Date(se.performedAt).toLocaleString()})]},se.id))})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",style:{flex:1},onClick:()=>ce(X),children:[e.jsx(r0,{size:16})," Adjust"]}),X.availableQty>0&&e.jsxs("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>ye(X),children:[e.jsx(u8,{size:16})," Transfer"]})]})]})]})]}),n==="movements"&&e.jsx("div",{className:"card",style:{padding:"1rem"},children:J.length===0?e.jsx(fn,{title:"No movements found",message:"Stock movements will appear here",icon:"package"}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Movement #"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Material"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:J.map(se=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:se.movementNumber})}),e.jsx("td",{children:new Date(se.performedAt).toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:HM(se.type),children:gA.find(W=>W.value===se.type)?.label})}),e.jsxs("td",{children:[e.jsx("div",{children:se.stockItem.material.code}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:se.stockItem.material.name})]}),e.jsx("td",{children:se.warehouse.code}),e.jsxs("td",{style:{fontWeight:600,color:se.type.includes("IN")||se.type==="RECEIPT"||se.type==="ADJUSTMENT_IN"||se.type==="RETURN"?"#22c55e":"#ef4444"},children:[se.type.includes("IN")||se.type==="RECEIPT"||se.type==="ADJUSTMENT_IN"||se.type==="RETURN"?"+":"-",se.quantity," ",se.unit]}),e.jsx("td",{children:se.referenceType&&se.referenceNumber?e.jsxs("span",{children:[se.referenceType,": ",se.referenceNumber]}):"-"}),e.jsx("td",{children:se.reason||"-"})]},se.id))})]})})}),w&&O&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:e.jsxs("div",{className:"modal",onClick:se=>se.stopPropagation(),style:{maxWidth:"400px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Adjust Stock"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>C(!1),children:""})]}),e.jsxs("form",{onSubmit:Se,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",marginBottom:"1rem"},children:[e.jsx("strong",{children:O.material.code})," - ",O.material.name,e.jsxs("div",{style:{marginTop:"0.5rem",color:"var(--text-muted)"},children:["Current: ",O.quantity," ",O.unit," (Available: ",O.availableQty,")"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Adjustment Quantity"}),e.jsx("input",{type:"number",className:"form-input",value:M.adjustmentQty,onChange:se=>Q({...M,adjustmentQty:parseFloat(se.target.value)||0}),step:"0.01"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Positive for increase, negative for decrease"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Reason *"}),e.jsxs("select",{className:"form-select",value:M.reason,onChange:se=>Q({...M,reason:se.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select reason..."}),e.jsx("option",{value:"Physical count correction",children:"Physical count correction"}),e.jsx("option",{value:"Damage/Scrap",children:"Damage/Scrap"}),e.jsx("option",{value:"Expired",children:"Expired"}),e.jsx("option",{value:"System error correction",children:"System error correction"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{className:"form-input",value:M.notes,onChange:se=>Q({...M,notes:se.target.value}),rows:2})]}),e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:M.adjustmentQty>=0?"#dcfce7":"#fee2e2",borderRadius:"8px"},children:[e.jsx("strong",{children:"New Quantity: "}),O.quantity+M.adjustmentQty," ",O.unit]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>C(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:M.adjustmentQty===0||de.isPending,children:de.isPending?"Adjusting...":"Adjust Stock"})]})]})]})}),A&&O&&e.jsx("div",{className:"modal-overlay",onClick:()=>T(!1),children:e.jsxs("div",{className:"modal",onClick:se=>se.stopPropagation(),style:{maxWidth:"450px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Transfer Stock"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>T(!1),children:""})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",marginBottom:"1rem"},children:[e.jsx("strong",{children:O.material.code})," - ",O.material.name,e.jsxs("div",{style:{marginTop:"0.5rem",color:"var(--text-muted)"},children:["From: ",O.warehouse.code," - ",O.warehouse.name]}),e.jsxs("div",{style:{color:"var(--text-muted)"},children:["Available: ",O.availableQty," ",O.unit]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"To Warehouse *"}),e.jsxs("select",{className:"form-select",value:U.toWarehouseId,onChange:se=>$({...U,toWarehouseId:se.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select warehouse..."}),Z.filter(se=>se.id!==O.warehouseId).map(se=>e.jsxs("option",{value:se.id,children:[se.code," - ",se.name]},se.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Quantity *"}),e.jsx("input",{type:"number",className:"form-input",value:U.quantity,onChange:se=>$({...U,quantity:parseFloat(se.target.value)||0}),min:.01,max:O.availableQty,step:"0.01",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Reason"}),e.jsx("input",{type:"text",className:"form-input",value:U.reason,onChange:se=>$({...U,reason:se.target.value}),placeholder:"e.g., Production requirement"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{className:"form-input",value:U.notes,onChange:se=>$({...U,notes:se.target.value}),rows:2})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>T(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:!U.toWarehouseId||U.quantity<=0||le.isPending,children:le.isPending?"Transferring...":"Transfer"})]})]})]})})]})}const mEe=[{value:"DRAFT",label:"Draft",color:"#94a3b8"},{value:"IN_PROGRESS",label:"In Progress",color:"#3b82f6"},{value:"PENDING_REVIEW",label:"Pending Review",color:"#f59e0b"},{value:"APPROVED",label:"Approved",color:"#22c55e"},{value:"REJECTED",label:"Rejected",color:"#ef4444"},{value:"CANCELLED",label:"Cancelled",color:"#6b7280"}],VM=[{value:"PENDING",label:"Pending",color:"#94a3b8"},{value:"IN_PROGRESS",label:"In Progress",color:"#3b82f6"},{value:"COMPLETED",label:"Completed",color:"#22c55e"},{value:"SKIPPED",label:"Skipped",color:"#6b7280"},{value:"FAILED",label:"Failed",color:"#ef4444"},{value:"ON_HOLD",label:"On Hold",color:"#f59e0b"}],pEe={DRAFT:{label:"Draft",description:"Batch record created but production not yet started.",nextAction:"Start production to begin recording steps"},IN_PROGRESS:{label:"In Progress",description:"Production is actively running. Steps are being executed.",nextAction:"Complete all steps to finish production"},PENDING_REVIEW:{label:"Pending Review",description:"Production complete. Awaiting QA review and approval.",nextAction:"Review and approve the batch record"},APPROVED:{label:"Approved",description:"Batch record approved. Ready for release.",nextAction:"Batch can proceed to QC/release"},REJECTED:{label:"Rejected",description:"Batch record was rejected during review.",nextAction:"Investigate and document deviation"}};function gEe(){const t=pr(),r=gn(),[n,i]=k.useState(""),[a,s]=k.useState(""),[o,l]=k.useState(1),[u,d]=k.useState(!1),[f,p]=k.useState(!1),[x,v]=k.useState(null),[w,C]=k.useState(!1),[A,T]=k.useState({batchId:"",recipeId:"",notes:""}),{data:O,isLoading:D}=Ve({queryKey:["batch-records",n,a,o],queryFn:async()=>{const X={page:o,limit:15};n&&(X.search=n),a&&(X.status=a);const{data:se}=await xe.get("/batch-records",{params:X});return se}}),{data:M}=Ve({queryKey:["batch-records-stats"],queryFn:async()=>{const{data:X}=await xe.get("/batch-records",{params:{limit:1e3}}),se=X.records;return{total:se.length,draft:se.filter(W=>W.status==="DRAFT").length,inProgress:se.filter(W=>W.status==="IN_PROGRESS").length,pendingReview:se.filter(W=>W.status==="PENDING_REVIEW").length,approved:se.filter(W=>W.status==="APPROVED").length,rejected:se.filter(W=>W.status==="REJECTED").length}}}),{data:Q}=Ve({queryKey:["batch-record",x],queryFn:async()=>{const[X,se]=await Promise.all([xe.get(`/batch-records/${x}`),xe.get(`/batch-records/${x}/kpis`)]);return{record:X.data,kpis:se.data}},enabled:!!x}),{data:U}=Ve({queryKey:["batch-record-form-data"],queryFn:async()=>{const[X,se]=await Promise.all([xe.get("/batches",{params:{status:"SCHEDULED,IN_PRODUCTION",limit:100}}),xe.get("/recipes",{params:{status:"ACTIVE",limit:100}})]);return{batches:X.data.batches||[],recipes:se.data.recipes||[]}},enabled:w}),$=ot({mutationFn:async X=>xe.post("/batch-records",X),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-records"]}),t.invalidateQueries({queryKey:["batch-records-stats"]}),r.success("Batch record created"),C(!1),T({batchId:"",recipeId:"",notes:""})},onError:X=>{r.error(X.response?.data?.error||"Failed to create batch record")}}),ee=ot({mutationFn:async X=>xe.post(`/batch-records/${X}/start`),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-records"]}),t.invalidateQueries({queryKey:["batch-records-stats"]}),t.invalidateQueries({queryKey:["batch-record",x]}),r.success("Production started")},onError:X=>{r.error(X.response?.data?.error||"Failed to start production")}}),F=ot({mutationFn:async({recordId:X,stepId:se})=>xe.post(`/batch-records/${X}/steps/${se}/start`),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-record",x]}),r.success("Step started")},onError:X=>{r.error(X.response?.data?.error||"Failed to start step")}}),Y=ot({mutationFn:async({recordId:X,stepId:se})=>xe.post(`/batch-records/${X}/steps/${se}/complete`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-record",x]}),r.success("Step completed")},onError:X=>{r.error(X.response?.data?.error||"Failed to complete step")}}),J=ot({mutationFn:async X=>xe.post(`/batch-records/${X}/complete`,{}),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-records"]}),t.invalidateQueries({queryKey:["batch-records-stats"]}),t.invalidateQueries({queryKey:["batch-record",x]}),r.success("Production completed")},onError:X=>{r.error(X.response?.data?.error||"Failed to complete production")}}),Z=ot({mutationFn:async X=>xe.post(`/batch-records/${X}/review`,{meaning:"Reviewed and verified"}),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-records"]}),t.invalidateQueries({queryKey:["batch-records-stats"]}),t.invalidateQueries({queryKey:["batch-record",x]}),r.success("Record reviewed")},onError:X=>{r.error(X.response?.data?.error||"Failed to review record")}}),re=ot({mutationFn:async X=>xe.post(`/batch-records/${X}/approve`,{meaning:"Approved for release"}),onSuccess:()=>{t.invalidateQueries({queryKey:["batch-records"]}),t.invalidateQueries({queryKey:["batch-records-stats"]}),t.invalidateQueries({queryKey:["batch-record",x]}),r.success("Record approved")},onError:X=>{r.error(X.response?.data?.error||"Failed to approve record")}}),de=X=>{v(X),p(!0)},le=X=>({DRAFT:"default",IN_PROGRESS:"info",PENDING_REVIEW:"warning",APPROVED:"success",REJECTED:"danger",CANCELLED:"default"})[X]||"default",K=X=>{const se=VM.find(W=>W.value===X);return{backgroundColor:`${se?.color}20`,color:se?.color}},ue=O?.records||[],ce=O?.totalPages||1,ye=Q?.record,Se=Q?.kpis,V=ye?.steps||[];return D?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.25rem"},children:[e.jsx(lu,{size:28,style:{color:"var(--primary)"}}),e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:600,margin:0},children:"Manufacturing Execution"})]}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:"Electronic Batch Records (eBR) for production control"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>d(!u),children:[e.jsx(am,{size:16}),"Workflow Guide",u?e.jsx(nh,{size:14}):e.jsx(qo,{size:14})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>C(!0),children:[e.jsx(cn,{size:16})," New Batch Record"]})]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(6, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Records",value:M?.total||0,icon:e.jsx(lu,{size:20}),color:"primary",onClick:()=>s(""),selected:!a}),e.jsx(nt,{title:"Draft",value:M?.draft||0,icon:e.jsx(Qt,{size:20}),color:"default",onClick:()=>s("DRAFT"),selected:a==="DRAFT"}),e.jsx(nt,{title:"In Progress",value:M?.inProgress||0,icon:e.jsx(Mc,{size:20}),color:"info",onClick:()=>s("IN_PROGRESS"),selected:a==="IN_PROGRESS"}),e.jsx(nt,{title:"Pending Review",value:M?.pendingReview||0,icon:e.jsx(os,{size:20}),color:"warning",onClick:()=>s("PENDING_REVIEW"),selected:a==="PENDING_REVIEW"}),e.jsx(nt,{title:"Approved",value:M?.approved||0,icon:e.jsx(Ft,{size:20}),color:"success",onClick:()=>s("APPROVED"),selected:a==="APPROVED"}),e.jsx(nt,{title:"Rejected",value:M?.rejected||0,icon:e.jsx(Hr,{size:20}),color:"danger",onClick:()=>s("REJECTED"),selected:a==="REJECTED"})]}),e.jsx("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:18,style:{color:"var(--text-muted)"}}),e.jsx("span",{style:{fontWeight:500,color:"var(--text-muted)"},children:"Filters:"})]}),e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px",maxWidth:"300px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Search record # or batch...",value:n,onChange:X=>{i(X.target.value),l(1)},style:{paddingLeft:"2.25rem"}})]}),e.jsxs("select",{className:"form-select",style:{width:"auto",minWidth:"150px"},value:a,onChange:X=>{s(X.target.value),l(1)},children:[e.jsx("option",{value:"",children:"All Statuses"}),mEe.map(X=>e.jsx("option",{value:X.value,children:X.label},X.value))]}),(n||a)&&e.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>{i(""),s(""),l(1)},children:[e.jsx(Dr,{size:14})," Clear"]})]})}),u&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",padding:"1.25rem"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(am,{size:18,style:{color:"var(--primary)"}}),"Batch Record Workflow Guide"]}),e.jsx("div",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Batch records flow through these stages from creation to approval:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem",padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius)"},children:["DRAFT","IN_PROGRESS","PENDING_REVIEW","APPROVED"].map((X,se,W)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Pn,{status:X,size:"sm"}),se<W.length-1&&e.jsx(lc,{size:14,style:{color:"var(--text-muted)"}})]},X))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"0.75rem"},children:Object.entries(pEe).map(([X,se])=>e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"var(--radius-sm)",borderLeft:`3px solid var(--${le(X)==="default"?"secondary":le(X)})`},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:e.jsx(Pn,{status:X,size:"sm"})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:se.description}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Next:"})," ",se.nextAction]})]},X))})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Batch Records (",ue.length,")"]})}),ue.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Record #"}),e.jsx("th",{children:"Batch"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Recipe"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Progress"}),e.jsx("th",{children:"Created"}),e.jsx("th",{style:{width:"100px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:ue.map(X=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem",color:"var(--primary)"},children:X.recordNumber}),e.jsx("td",{children:X.batch?.batchNumber}),e.jsx("td",{children:X.batch?.product?.name}),e.jsx("td",{children:e.jsxs("span",{style:{fontSize:"0.875rem"},children:[X.recipe?.code," v",X.recipeVersion]})}),e.jsx("td",{children:e.jsx(Pn,{status:X.status,size:"sm"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Mc,{size:14,style:{color:"var(--text-muted)"}}),e.jsxs("span",{style:{fontSize:"0.875rem"},children:[X._count?.steps||0," steps"]}),(X._count?.deviations||0)>0&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",color:"var(--error)",fontSize:"0.75rem"},children:[e.jsx(Hr,{size:12}),X._count?.deviations]})]})}),e.jsx("td",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:new Date(X.createdAt).toLocaleDateString()}),e.jsx("td",{children:e.jsx("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>de(X.id),title:"View Details",children:e.jsx(os,{size:14})})})})]},X.id))})]}),ce>1&&e.jsxs("div",{style:{padding:"1rem",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>l(X=>Math.max(1,X-1)),disabled:o===1,children:"Previous"}),e.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:["Page ",o," of ",ce]}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>l(X=>Math.min(ce,X+1)),disabled:o===ce,children:"Next"})]})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No batch records found",message:"Create a new batch record to get started",icon:"package"})})]}),w&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(!1),children:e.jsxs("div",{className:"modal",onClick:X=>X.stopPropagation(),style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Create Batch Record"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>C(!1),children:""})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Batch *"}),e.jsxs("select",{className:"form-select",value:A.batchId,onChange:X=>T({...A,batchId:X.target.value}),children:[e.jsx("option",{value:"",children:"Select batch..."}),U?.batches.map(X=>e.jsxs("option",{value:X.id,children:[X.batchNumber," - ",X.product?.name]},X.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Recipe *"}),e.jsxs("select",{className:"form-select",value:A.recipeId,onChange:X=>T({...A,recipeId:X.target.value}),children:[e.jsx("option",{value:"",children:"Select recipe..."}),U?.recipes.map(X=>e.jsxs("option",{value:X.id,children:[X.code," - ",X.name," (v",X.version,")"]},X.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notes"}),e.jsx("textarea",{className:"form-input",value:A.notes,onChange:X=>T({...A,notes:X.target.value}),rows:3})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn",onClick:()=>C(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>$.mutate(A),disabled:$.isPending||!A.batchId||!A.recipeId,children:$.isPending?"Creating...":"Create Record"})]})]})}),f&&ye&&e.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:e.jsxs("div",{className:"modal",onClick:X=>X.stopPropagation(),style:{maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"modal-header",style:{background:"var(--bg-secondary)"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{marginBottom:"0.25rem"},children:ye.recordNumber}),e.jsxs("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:0},children:[ye.batch?.batchNumber," - ",ye.batch?.product?.name]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(Pn,{status:ye.status,size:"md"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>p(!1),children:""})]})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"1.5rem"},children:[Se&&e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(5, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{padding:"1rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--info)",marginBottom:"0.5rem"},children:[e.jsx(Mc,{size:16}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500},children:"Progress"})]}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--info)"},children:[Se.progress?.percentage||0,"%"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[Se.progress?.completed,"/",Se.progress?.total," steps"]})]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(139, 92, 246, 0.1)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"#8b5cf6",marginBottom:"0.5rem"},children:[e.jsx(Qt,{size:16}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500},children:"Duration"})]}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"#8b5cf6"},children:[Se.timing?.actualMinutes||0," min"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:["Expected: ",Se.timing?.expectedMinutes||0," min"]})]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--success)",marginBottom:"0.5rem"},children:[e.jsx(Rr,{size:16}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500},children:"Materials"})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--success)"},children:Se.materials?.itemsConsumed||0}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Items consumed"})]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--warning)",marginBottom:"0.5rem"},children:[e.jsx(fz,{size:16}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500},children:"Equipment"})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--warning)"},children:Se.equipment?.itemsUsed||0}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Items used"})]}),e.jsxs("div",{style:{padding:"1rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"var(--radius)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--error)",marginBottom:"0.5rem"},children:[e.jsx(fv,{size:16}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:500},children:"Deviations"})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--error)"},children:Se.deviations?.total||0}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[Se.deviations?.open||0," open"]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsx("h4",{style:{fontWeight:600,margin:0},children:"Production Steps"})}),e.jsx("div",{children:V.map(X=>e.jsxs("div",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.875rem"},children:X.stepNumber}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsxs("span",{style:{fontWeight:500},children:["Step ",X.stepNumber,": ",X.title]}),X.isQualityCheckpoint&&e.jsx("span",{className:"badge",style:{fontSize:"0.625rem",background:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6"},children:"QC"})]}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:X.description})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[X.plannedDuration&&e.jsxs("span",{style:{fontSize:"0.8125rem",color:"var(--text-muted)"},children:["~",X.plannedDuration," min"]}),e.jsx("span",{className:"badge",style:K(X.status),children:VM.find(se=>se.value===X.status)?.label}),ye.status==="IN_PROGRESS"&&X.status==="PENDING"&&e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>F.mutate({recordId:ye.id,stepId:X.id}),disabled:F.isPending,children:e.jsx(yo,{size:14})}),ye.status==="IN_PROGRESS"&&X.status==="IN_PROGRESS"&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>Y.mutate({recordId:ye.id,stepId:X.id}),disabled:Y.isPending,children:e.jsx(Ft,{size:14})})]})]},X.id))})]}),(ye.startedBy||ye.approvedBy)&&e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",display:"flex",gap:"2rem"},children:[ye.startedBy&&e.jsxs("span",{children:["Started by: ",ye.startedBy.firstName," ",ye.startedBy.lastName]}),ye.approvedBy&&e.jsxs("span",{children:["Approved by: ",ye.approvedBy.firstName," ",ye.approvedBy.lastName]})]})]}),e.jsxs("div",{className:"modal-footer",style:{background:"var(--bg-secondary)"},children:[e.jsx("button",{className:"btn",onClick:()=>p(!1),children:"Close"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[ye.status==="DRAFT"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>ee.mutate(ye.id),disabled:ee.isPending,children:[e.jsx(yo,{size:16})," Start Production"]}),ye.status==="IN_PROGRESS"&&Se?.progress?.percentage===100&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>J.mutate(ye.id),disabled:J.isPending,children:[e.jsx(Ft,{size:16})," Complete Production"]}),ye.status==="PENDING_REVIEW"&&!ye.reviewedAt&&e.jsxs("button",{className:"btn btn-warning",onClick:()=>Z.mutate(ye.id),disabled:Z.isPending,children:[e.jsx(os,{size:16})," Review Record"]}),ye.status==="PENDING_REVIEW"&&ye.reviewedAt&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>re.mutate(ye.id),disabled:re.isPending,children:[e.jsx(Ft,{size:16})," Approve Record"]})]})]})]})})]})}const yEe=[{value:"OPEN",label:"Open"},{value:"PHASE_1_LAB_INVESTIGATION",label:"Phase 1 Investigation"},{value:"PHASE_1_COMPLETE",label:"Phase 1 Complete"},{value:"PHASE_2_FULL_INVESTIGATION",label:"Phase 2 Investigation"},{value:"PHASE_2_COMPLETE",label:"Phase 2 Complete"},{value:"CAPA_PROPOSED",label:"CAPA Proposed"},{value:"CAPA_APPROVED",label:"CAPA Approved"},{value:"CAPA_IMPLEMENTING",label:"CAPA Implementing"},{value:"CLOSED_CONFIRMED",label:"Closed (Confirmed)"},{value:"CLOSED_INVALIDATED",label:"Closed (Invalidated)"},{value:"CLOSED_INCONCLUSIVE",label:"Closed (Inconclusive)"}],$M=[{value:"OOS",label:"Out of Specification"},{value:"OOT",label:"Out of Trend"},{value:"OOE",label:"Out of Expectation"}],GM=[{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"CRITICAL",label:"Critical"}];function xEe(){const[t,r]=k.useState({}),[n,i]=k.useState(1),[a,s]=k.useState(!1),[o,l]=k.useState(!1),[u,d]=k.useState(null),[f,p]=k.useState(null),x=k.useRef(null),v=pr(),w=gn(),[C,A]=k.useState({batchId:"",caseType:"OOS",priority:"MEDIUM",testName:"",testMethod:"",specMin:"",specMax:"",actualValue:"",unit:"",deviationPercent:"",initialDescription:"",dueDate:""});k.useEffect(()=>{const W=oe=>{x.current&&!x.current.contains(oe.target)&&p(null)};return f&&document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[f]);const{data:T,isLoading:O}=Ve({queryKey:["oos-cases",t,n],queryFn:async()=>{const W=new URLSearchParams;W.append("page",n.toString()),W.append("limit","20"),t.status&&W.append("status",t.status),t.caseType&&W.append("caseType",t.caseType),t.priority&&W.append("priority",t.priority);const{data:oe}=await xe.get(`/oos-investigations?${W}`);return oe}}),D=T?.cases||[],M=T?.totalPages||1,Q=t.search?D.filter(W=>W.caseNumber.toLowerCase().includes(t.search.toLowerCase())||W.testName.toLowerCase().includes(t.search.toLowerCase())||W.batch?.batchNumber?.toLowerCase().includes(t.search.toLowerCase())||W.batch?.product?.name?.toLowerCase().includes(t.search.toLowerCase())):D,{data:U}=Ve({queryKey:["oos-stats"],queryFn:async()=>{const{data:W}=await xe.get("/oos-investigations/stats");return W}}),{data:$}=Ve({queryKey:["batches-for-oos"],queryFn:async()=>{const{data:W}=await xe.get("/batches");return W.slice(0,100)}}),ee=ot({mutationFn:async W=>xe.post("/oos-investigations",W),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),s(!1),ue(),w.success("Case Opened","New OOS/OOT investigation case has been opened")},onError:W=>{const oe=an(W);w.error("Creation Failed",oe?.userMessage||"Failed to create case")}}),F=ot({mutationFn:async W=>xe.post(`/oos-investigations/${W}/start-phase1`,{}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("Phase 1 Started","Lab investigation has begun")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to start Phase 1")}}),Y=ot({mutationFn:async({id:W,proceedToPhase2:oe})=>xe.post(`/oos-investigations/${W}/complete-phase1`,{conclusion:"Phase 1 investigation completed",proceedToPhase2:oe}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("Phase 1 Completed","Lab investigation phase completed")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to complete Phase 1")}}),J=ot({mutationFn:async W=>xe.post(`/oos-investigations/${W}/start-phase2`,{}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("Phase 2 Started","Full investigation has begun")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to start Phase 2")}}),Z=ot({mutationFn:async W=>xe.post(`/oos-investigations/${W}/complete-phase2`,{conclusion:"Phase 2 investigation completed",rootCause:"Root cause identified during investigation"}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("Phase 2 Completed","Full investigation phase completed")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to complete Phase 2")}}),re=ot({mutationFn:async W=>xe.post(`/oos-investigations/${W}/propose-capa`,{rootCause:"Root cause identified",correctiveAction:"Corrective actions to be taken",preventiveAction:"Preventive measures to implement"}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("CAPA Proposed","Corrective and preventive actions submitted")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to propose CAPA")}}),de=ot({mutationFn:async W=>xe.post(`/oos-investigations/${W}/approve-capa`,{signatureMeaning:"I approve this CAPA for implementation"}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("CAPA Approved","CAPA has been approved for implementation")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to approve CAPA")}}),le=ot({mutationFn:async W=>xe.post(`/oos-investigations/${W}/start-implementation`,{}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("Implementation Started","CAPA implementation has begun")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to start implementation")}}),K=ot({mutationFn:async({id:W,closureType:oe})=>xe.post(`/oos-investigations/${W}/close`,{closureType:oe,finalConclusion:`Case closed as ${oe}`,signatureMeaning:`I confirm the closure of this OOS case as ${oe}`}),onSuccess:()=>{v.invalidateQueries({queryKey:["oos-cases"]}),v.invalidateQueries({queryKey:["oos-stats"]}),u&&ce(u.id),w.success("Case Closed","Investigation has been closed")},onError:W=>{const oe=an(W);w.error("Failed",oe?.userMessage||"Failed to close case")}}),ue=()=>{A({batchId:"",caseType:"OOS",priority:"MEDIUM",testName:"",testMethod:"",specMin:"",specMax:"",actualValue:"",unit:"",deviationPercent:"",initialDescription:"",dueDate:""})},ce=async W=>{try{const{data:oe}=await xe.get(`/oos-investigations/${W}`);d(oe),l(!0)}catch(oe){console.error("Failed to fetch case details:",oe)}},ye=()=>{ee.mutate(C)},Se=[{key:"search",label:"Search",type:"search",placeholder:"Search cases..."},{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},...yEe.map(W=>({value:W.value,label:W.label}))]},{key:"caseType",label:"Type",type:"select",options:[{value:"",label:"All Types"},...$M.map(W=>({value:W.value,label:W.label}))]},{key:"priority",label:"Priority",type:"select",options:[{value:"",label:"All Priorities"},...GM.map(W=>({value:W.value,label:W.label}))]}],V={open:U?.openCases||0,overdue:U?.overdue||0,closed:U?.recentClosures||0,oos:U?.byType?.find(W=>W.caseType==="OOS")?._count?.id||0,oot:U?.byType?.find(W=>W.caseType==="OOT")?._count?.id||0,ooe:U?.byType?.find(W=>W.caseType==="OOE")?._count?.id||0},X=W=>({LOW:"default",MEDIUM:"info",HIGH:"warning",CRITICAL:"danger"})[W]||"default",se=W=>({OOS:"danger",OOT:"warning",OOE:"info"})[W]||"default";return O?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"OOS/OOT Investigations"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage out-of-specification and out-of-trend investigations"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>s(!0),children:[e.jsx(cn,{size:16}),"Open New Case"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(6, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Open Cases",value:V.open,icon:e.jsx(Mc,{size:20}),color:"primary",onClick:()=>r({status:"OPEN"}),selected:t.status==="OPEN"}),e.jsx(nt,{title:"Overdue",value:V.overdue,icon:e.jsx(lz,{size:20}),color:"danger"}),e.jsx(nt,{title:"Closed (30d)",value:V.closed,icon:e.jsx(Ft,{size:20}),color:"success"}),e.jsx(nt,{title:"OOS Cases",value:V.oos,icon:e.jsx(Hr,{size:20}),color:"danger",onClick:()=>r({caseType:"OOS"}),selected:t.caseType==="OOS"}),e.jsx(nt,{title:"OOT Cases",value:V.oot,icon:e.jsx(fv,{size:20}),color:"warning",onClick:()=>r({caseType:"OOT"}),selected:t.caseType==="OOT"}),e.jsx(nt,{title:"OOE Cases",value:V.ooe,icon:e.jsx(Qt,{size:20}),color:"info",onClick:()=>r({caseType:"OOE"}),selected:t.caseType==="OOE"})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:e.jsx(cd,{widgets:Se,values:t,onChange:(W,oe)=>r(ge=>({...ge,[W]:oe})),onReset:()=>r({})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:["Investigation Cases (",Q?.length||0,")"]})}),Q?.length>0?e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Case #"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Batch"}),e.jsx("th",{children:"Test"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Opened"}),e.jsx("th",{style:{width:"120px",textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:Q.map(W=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{style:{fontWeight:500,fontFamily:"monospace",fontSize:"0.8125rem",color:"var(--danger)"},children:W.caseNumber})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${se(W.caseType)}`,style:{fontSize:"0.6875rem"},children:W.caseType})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500},children:W.batch?.batchNumber}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:W.batch?.product?.name})]}),e.jsxs("td",{children:[e.jsx("div",{children:W.testName}),W.actualValue&&W.specMin&&W.specMax&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[W.actualValue," ",W.unit," (Spec: ",W.specMin,"-",W.specMax,")"]})]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${X(W.priority)}`,style:{fontSize:"0.6875rem"},children:W.priority})}),e.jsx("td",{children:e.jsx(Pn,{status:W.status,size:"sm"})}),e.jsxs("td",{children:[e.jsx("div",{children:Ze(new Date(W.openedAt),"MMM dd, yyyy")}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[W.openedBy?.firstName," ",W.openedBy?.lastName]})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end",position:"relative"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>ce(W.id),title:"View Details",children:e.jsx(os,{size:14})}),e.jsxs("div",{style:{position:"relative"},ref:f===W.id?x:null,children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:oe=>{oe.stopPropagation(),p(f===W.id?null:W.id)},children:e.jsx(ez,{size:14})}),f===W.id&&e.jsxs("div",{className:"dropdown-menu",onClick:oe=>oe.stopPropagation(),children:[W.status==="OPEN"&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{F.mutate(W.id),p(null)},children:[e.jsx(yo,{size:14}),"Start Phase 1"]}),W.status==="PHASE_1_LAB_INVESTIGATION"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>{Y.mutate({id:W.id,proceedToPhase2:!1}),p(null)},children:[e.jsx(Ft,{size:14}),"Complete Phase 1"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>{Y.mutate({id:W.id,proceedToPhase2:!0}),p(null)},children:[e.jsx(lc,{size:14}),"Proceed to Phase 2"]})]}),W.status==="PHASE_1_COMPLETE"&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{J.mutate(W.id),p(null)},children:[e.jsx(yo,{size:14}),"Start Phase 2"]}),W.status==="PHASE_2_FULL_INVESTIGATION"&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{Z.mutate(W.id),p(null)},children:[e.jsx(Ft,{size:14}),"Complete Phase 2"]}),W.status==="PHASE_2_COMPLETE"&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{re.mutate(W.id),p(null)},children:[e.jsx(fv,{size:14}),"Propose CAPA"]}),W.status==="CAPA_PROPOSED"&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{de.mutate(W.id),p(null)},children:[e.jsx(Ft,{size:14}),"Approve CAPA"]}),W.status==="CAPA_APPROVED"&&e.jsxs("button",{className:"dropdown-item",onClick:()=>{le.mutate(W.id),p(null)},children:[e.jsx(yo,{size:14}),"Start Implementation"]}),W.status==="CAPA_IMPLEMENTING"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>{K.mutate({id:W.id,closureType:"CONFIRMED"}),p(null)},children:[e.jsx(Ft,{size:14}),"Close (Confirmed)"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>{K.mutate({id:W.id,closureType:"INVALIDATED"}),p(null)},children:[e.jsx(ri,{size:14}),"Close (Invalidated)"]})]})]})]})]})})]},W.id))})]}):e.jsx("div",{style:{padding:"2rem"},children:e.jsx(fn,{title:"No investigations found",message:"Open a new case to start an investigation",icon:"alert"})}),M>1&&e.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>i(W=>Math.max(1,W-1)),disabled:n===1,children:"Previous"}),e.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:["Page ",n," of ",M]}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>i(W=>Math.min(M,W+1)),disabled:n===M,children:"Next"})]})]}),f&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:999},onClick:()=>p(null)}),a&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"700px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Open New OOS/OOT Investigation"}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>s(!1),children:e.jsx(Dr,{size:18})})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Batch *"}),e.jsxs("select",{className:"form-select",value:C.batchId,onChange:W=>A({...C,batchId:W.target.value}),children:[e.jsx("option",{value:"",children:"Select Batch"}),$?.map(W=>e.jsxs("option",{value:W.id,children:[W.batchNumber," - ",W.product?.name]},W.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Case Type *"}),e.jsx("select",{className:"form-select",value:C.caseType,onChange:W=>A({...C,caseType:W.target.value}),children:$M.map(W=>e.jsx("option",{value:W.value,children:W.label},W.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Priority *"}),e.jsx("select",{className:"form-select",value:C.priority,onChange:W=>A({...C,priority:W.target.value}),children:GM.map(W=>e.jsx("option",{value:W.value,children:W.label},W.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Due Date"}),e.jsx("input",{type:"date",className:"form-input",value:C.dueDate,onChange:W=>A({...C,dueDate:W.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Test Name *"}),e.jsx("input",{type:"text",className:"form-input",value:C.testName,onChange:W=>A({...C,testName:W.target.value}),placeholder:"e.g., Assay, pH, Endotoxin"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Test Method"}),e.jsx("input",{type:"text",className:"form-input",value:C.testMethod,onChange:W=>A({...C,testMethod:W.target.value}),placeholder:"e.g., HPLC, USP Method"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Spec Min"}),e.jsx("input",{type:"number",className:"form-input",value:C.specMin,onChange:W=>A({...C,specMin:W.target.value}),placeholder:"Minimum specification"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Spec Max"}),e.jsx("input",{type:"number",className:"form-input",value:C.specMax,onChange:W=>A({...C,specMax:W.target.value}),placeholder:"Maximum specification"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Actual Value"}),e.jsx("input",{type:"number",className:"form-input",value:C.actualValue,onChange:W=>A({...C,actualValue:W.target.value}),placeholder:"Observed value"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Unit"}),e.jsx("input",{type:"text",className:"form-input",value:C.unit,onChange:W=>A({...C,unit:W.target.value}),placeholder:"e.g., %, mg/mL"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Initial Description *"}),e.jsx("textarea",{className:"form-textarea",rows:3,value:C.initialDescription,onChange:W=>A({...C,initialDescription:W.target.value}),placeholder:"Describe the deviation or issue observed..."})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:ye,disabled:!C.batchId||!C.testName||!C.initialDescription||ee.isPending,children:ee.isPending?"Creating...":"Open Case"})]})]})}),o&&u&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",style:{maxWidth:"800px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("div",{children:[e.jsx("h3",{style:{marginBottom:"0.25rem"},children:u.caseNumber}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("span",{className:`badge badge-${se(u.caseType)}`,children:u.caseType}),e.jsx("span",{className:`badge badge-${X(u.priority)}`,children:u.priority}),e.jsx(Pn,{status:u.status,size:"sm"})]})]}),e.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>l(!1),children:e.jsx(Dr,{size:18})})]}),e.jsxs("div",{className:"modal-body",style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)"},children:"Batch Information"}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Batch:"})," ",e.jsx("span",{style:{fontWeight:500},children:u.batch?.batchNumber})]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Product:"})," ",e.jsx("span",{children:u.batch?.product?.name})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)"},children:"Test Details"}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Test:"})," ",e.jsx("span",{style:{fontWeight:500},children:u.testName})]}),u.testMethod&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Method:"})," ",e.jsx("span",{children:u.testMethod})]}),u.actualValue&&e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Result:"})," ",e.jsxs("span",{style:{color:"var(--danger)",fontWeight:500},children:[u.actualValue," ",u.unit]}),u.specMin&&u.specMax&&e.jsxs("span",{style:{color:"var(--text-muted)"},children:[" (Spec: ",u.specMin,"-",u.specMax,")"]})]})]})]})]}),e.jsxs("div",{className:"card",style:{padding:"1rem",marginTop:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)"},children:"Initial Description"}),e.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:u.initialDescription})]}),(u.rootCause||u.correctiveAction||u.preventiveAction)&&e.jsxs("div",{className:"card",style:{padding:"1rem",marginTop:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)"},children:"CAPA Details"}),u.rootCause&&e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.8125rem",marginBottom:"0.25rem"},children:"Root Cause"}),e.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:u.rootCause})]}),u.correctiveAction&&e.jsxs("div",{style:{marginBottom:"0.75rem"},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.8125rem",marginBottom:"0.25rem"},children:"Corrective Action"}),e.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:u.correctiveAction})]}),u.preventiveAction&&e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.8125rem",marginBottom:"0.25rem"},children:"Preventive Action"}),e.jsx("p",{style:{fontSize:"0.875rem",margin:0},children:u.preventiveAction})]})]}),u.timeline&&u.timeline.length>0&&e.jsxs("div",{className:"card",style:{padding:"1rem",marginTop:"1rem"},children:[e.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-muted)"},children:"Timeline"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:u.timeline.map(W=>e.jsxs("div",{style:{display:"flex",gap:"0.75rem",fontSize:"0.875rem"},children:[e.jsx("div",{style:{color:"var(--text-muted)",minWidth:"120px"},children:Ze(new Date(W.createdAt),"MMM dd, HH:mm")}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:W.action}),W.description&&e.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]})]},W.id))})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>l(!1),children:"Close"}),u.status==="OPEN"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>F.mutate(u.id),children:[e.jsx(yo,{size:16}),"Start Phase 1"]}),u.status==="PHASE_1_LAB_INVESTIGATION"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>Y.mutate({id:u.id,proceedToPhase2:!0}),children:[e.jsx(lc,{size:16}),"Complete & Proceed to Phase 2"]}),u.status==="PHASE_1_COMPLETE"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>J.mutate(u.id),children:[e.jsx(yo,{size:16}),"Start Phase 2"]}),u.status==="PHASE_2_FULL_INVESTIGATION"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>Z.mutate(u.id),children:[e.jsx(Ft,{size:16}),"Complete Phase 2"]}),u.status==="PHASE_2_COMPLETE"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>re.mutate(u.id),children:[e.jsx(fv,{size:16}),"Propose CAPA"]}),u.status==="CAPA_PROPOSED"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>de.mutate(u.id),children:[e.jsx(Ft,{size:16}),"Approve CAPA"]}),u.status==="CAPA_APPROVED"&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>le.mutate(u.id),children:[e.jsx(yo,{size:16}),"Start Implementation"]}),u.status==="CAPA_IMPLEMENTING"&&e.jsxs("button",{className:"btn btn-success",onClick:()=>K.mutate({id:u.id,closureType:"CONFIRMED"}),children:[e.jsx(Ft,{size:16}),"Close Case"]})]})]})})]})}const bg=[{value:"email",label:"Email Only"},{value:"sms",label:"SMS Only"},{value:"whatsapp",label:"WhatsApp Only"},{value:"email,sms",label:"Email + SMS"},{value:"email,whatsapp",label:"Email + WhatsApp"},{value:"email,sms,whatsapp",label:"All Channels"}],vEe=[{id:"channels",label:"Channel Status",icon:zp},{id:"email",label:"Email Settings",icon:uc},{id:"events",label:"Event Routing",icon:xo}];function bEe(){const t=pr(),r=gn(),[n,i]=k.useState("channels"),[a,s]=k.useState({}),[o,l]=k.useState(""),[u,d]=k.useState(null),{data:f,isLoading:p}=Ve({queryKey:["notification-settings"],queryFn:async()=>{const{data:U}=await xe.get("/notification-settings");return U}}),{data:x}=Ve({queryKey:["notification-status"],queryFn:async()=>{const{data:U}=await xe.get("/notification-settings/status");return U}});k.useEffect(()=>{if(f){const U={};Object.entries(f).forEach(([$,ee])=>{U[ee.key]=ee.value}),s(U)}},[f]);const v=ot({mutationFn:async U=>{await xe.put("/notification-settings",U)},onSuccess:()=>{r.success("Settings Saved","Notification settings updated successfully"),t.invalidateQueries({queryKey:["notification-settings"]})},onError:()=>{r.error("Save Failed","Failed to save notification settings")}}),w=()=>{v.mutate(a)},C=async()=>{d("email");try{const{data:U}=await xe.get("/notification-settings/test/email");r.success("Email Sent",U.message||"Test email sent successfully")}catch(U){r.error("Email Failed",U.response?.data?.error||"Email test failed")}d(null)},A=async()=>{if(!o){r.error("Phone Required","Please enter a phone number");return}d("sms");try{const{data:U}=await xe.get(`/notification-settings/test/sms?to=${encodeURIComponent(o)}`);r.success("SMS Sent",U.message||"Test SMS sent successfully")}catch(U){r.error("SMS Failed",U.response?.data?.error||"SMS test failed")}d(null)},T=async()=>{if(!o){r.error("Phone Required","Please enter a phone number");return}d("whatsapp");try{const{data:U}=await xe.get(`/notification-settings/test/whatsapp?to=${encodeURIComponent(o)}`);r.success("WhatsApp Sent",U.message||"Test WhatsApp sent successfully")}catch(U){r.error("WhatsApp Failed",U.response?.data?.error||"WhatsApp test failed")}d(null)};if(p)return e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})});const O=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(uc,{size:20,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontWeight:600},children:"Email"})]}),x?.email.connected?e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Connected"]}):e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ri,{size:12})," Disconnected"]})]}),e.jsxs("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:["Provider: ",x?.email.provider||"Resend"]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:C,disabled:u==="email",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[u==="email"?e.jsx("div",{className:"spinner",style:{width:"14px",height:"14px"}}):e.jsx(Qi,{size:14}),"Send Test"]})]}),e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(vo,{size:20,style:{color:"var(--success)"}}),e.jsx("span",{style:{fontWeight:600},children:"SMS"})]}),x?.sms.connected?e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Connected"]}):e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ri,{size:12})," Disconnected"]})]}),e.jsxs("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:["Provider: ",x?.sms.provider||"Twilio"]}),x?.sms.phoneNumber&&e.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:["From: ",x.sms.phoneNumber]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:A,disabled:u==="sms"||!x?.sms.connected,style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[u==="sms"?e.jsx("div",{className:"spinner",style:{width:"14px",height:"14px"}}):e.jsx(Qi,{size:14}),"Send Test"]})]}),e.jsxs("div",{className:"card",style:{padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(e0,{size:20,style:{color:"#25D366"}}),e.jsx("span",{style:{fontWeight:600},children:"WhatsApp"})]}),x?.whatsapp.connected?e.jsxs("span",{className:"badge badge-success",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(Ft,{size:12})," Connected"]}):e.jsxs("span",{className:"badge badge-danger",style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx(ri,{size:12})," Disconnected"]})]}),e.jsxs("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:["Provider: ",x?.whatsapp.provider||"Twilio"]}),x?.whatsapp.phoneNumber&&e.jsxs("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:["From: ",x.whatsapp.phoneNumber]}),e.jsxs("button",{className:"btn btn-sm btn-outline",onClick:T,disabled:u==="whatsapp"||!x?.whatsapp.connected,style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[u==="whatsapp"?e.jsx("div",{className:"spinner",style:{width:"14px",height:"14px"}}):e.jsx(Qi,{size:14}),"Send Test"]})]})]}),e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Test Phone Number"})}),e.jsxs("div",{style:{padding:"1.25rem"},children:[e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:"Enter a phone number to test SMS and WhatsApp (include country code, e.g., +1234567890)"}),e.jsx("input",{type:"tel",className:"form-input",value:o,onChange:U=>l(U.target.value),placeholder:"+1234567890",style:{maxWidth:"300px"}})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Channel Enable/Disable"})}),e.jsx("div",{style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1.5rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.notification_email_enabled===!0||a.notification_email_enabled==="true",onChange:U=>s({...a,notification_email_enabled:U.target.checked}),style:{width:"18px",height:"18px"}}),e.jsx("span",{style:{fontWeight:500},children:"Enable Email Notifications"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.notification_sms_enabled===!0||a.notification_sms_enabled==="true",onChange:U=>s({...a,notification_sms_enabled:U.target.checked}),style:{width:"18px",height:"18px"}}),e.jsx("span",{style:{fontWeight:500},children:"Enable SMS Notifications"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:a.notification_whatsapp_enabled===!0||a.notification_whatsapp_enabled==="true",onChange:U=>s({...a,notification_whatsapp_enabled:U.target.checked}),style:{width:"18px",height:"18px"}}),e.jsx("span",{style:{fontWeight:500},children:"Enable WhatsApp Notifications"})]})]})})]})]}),D=()=>e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Email Configuration"})}),e.jsx("div",{style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sender Email Address"}),e.jsx("input",{type:"email",className:"form-input",value:a.notification_email_from_address||"",onChange:U=>s({...a,notification_email_from_address:U.target.value}),placeholder:"noreply@radiopharma.com"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:'The email address that will appear in the "From" field'})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sender Display Name"}),e.jsx("input",{type:"text",className:"form-input",value:a.notification_email_from_name||"",onChange:U=>s({...a,notification_email_from_name:U.target.value}),placeholder:"RadioPharma OMS"}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"The display name shown to email recipients"})]})]})})]}),M=()=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border)"},children:[e.jsx("h3",{style:{fontWeight:600,fontSize:"1rem",margin:0},children:"Event Channel Configuration"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)",margin:"0.25rem 0 0"},children:"Configure which channels to use for different notification types"})]}),e.jsx("div",{style:{padding:"1.25rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Order Notifications"}),e.jsx("select",{className:"form-select",value:a.notification_order_events||"email",onChange:U=>s({...a,notification_order_events:U.target.value}),children:bg.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Order status updates, confirmations"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Batch/Production Notifications"}),e.jsx("select",{className:"form-select",value:a.notification_batch_events||"email",onChange:U=>s({...a,notification_batch_events:U.target.value}),children:bg.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Production status, QC results, batch releases"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Delivery Notifications"}),e.jsx("select",{className:"form-select",value:a.notification_delivery_events||"email,sms",onChange:U=>s({...a,notification_delivery_events:U.target.value}),children:bg.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Shipment dispatched, delivery updates, ETA changes"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Approval Notifications"}),e.jsx("select",{className:"form-select",value:a.notification_approval_events||"email",onChange:U=>s({...a,notification_approval_events:U.target.value}),children:bg.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Pending approvals, approval/rejection outcomes"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Invoice Notifications"}),e.jsx("select",{className:"form-select",value:a.notification_invoice_events||"email",onChange:U=>s({...a,notification_invoice_events:U.target.value}),children:bg.map(U=>e.jsx("option",{value:U.value,children:U.label},U.value))}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Invoice generated, payment reminders, receipts"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Default Channel"}),e.jsxs("select",{className:"form-select",value:a.notification_default_channel||"email",onChange:U=>s({...a,notification_default_channel:U.target.value}),children:[e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"sms",children:"SMS"}),e.jsx("option",{value:"whatsapp",children:"WhatsApp"}),e.jsx("option",{value:"all",children:"All Channels"})]}),e.jsx("p",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Fallback channel for uncategorized notifications"})]})]})})]}),Q=()=>{switch(n){case"channels":return O();case"email":return D();case"events":return M();default:return null}};return e.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[e.jsxs("div",{style:{width:"240px",flexShrink:0},children:[e.jsxs(nr,{to:"/settings",className:"btn btn-secondary",style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem",width:"100%"},children:[e.jsx(sa,{size:16}),"Back to Settings"]}),e.jsxs("div",{className:"card",style:{overflow:"hidden"},children:[e.jsx("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(sh,{size:18,style:{color:"var(--primary)"}}),e.jsx("span",{style:{fontWeight:600,fontSize:"0.9375rem"},children:"Notification Settings"})]})}),e.jsx("div",{style:{padding:"0.5rem"},children:vEe.map(U=>{const $=U.icon,ee=n===U.id;return e.jsxs("button",{onClick:()=>i(U.id),style:{display:"flex",alignItems:"center",gap:"0.75rem",width:"100%",padding:"0.75rem 1rem",border:"none",borderRadius:"var(--radius-sm)",background:ee?"var(--primary)":"transparent",color:ee?"white":"var(--text-secondary)",cursor:"pointer",fontSize:"0.875rem",fontWeight:ee?500:400,textAlign:"left",transition:"all 0.15s ease"},children:[e.jsx($,{size:18}),U.label]},U.id)})})]})]}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"Notification Settings"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Configure email, SMS, and WhatsApp notification channels"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:w,disabled:v.isPending,children:[v.isPending?e.jsx("div",{className:"spinner",style:{width:"16px",height:"16px"}}):e.jsx(cc,{size:16}),"Save Changes"]})]}),Q()]})]})}const NC=[{value:"PASS_FAIL",label:"Pass/Fail"},{value:"NUMERIC",label:"Numeric"},{value:"TEXT",label:"Text"},{value:"OPTION_LIST",label:"Option List"}],jEe=["Appearance","Identity","Purity","Potency","Sterility","Endotoxin","pH","Radioactivity","Particle Size","Other"];function wEe(){const t=gn(),r=pr(),[n,i]=k.useState(!1),[a,s]=k.useState(null),[o,l]=k.useState(null),[u,d]=k.useState(""),[f,p]=k.useState(""),[x,v]=k.useState({code:"",nameEn:"",nameAr:"",descriptionEn:"",descriptionAr:"",resultType:"PASS_FAIL",unit:"",optionList:"",category:"",method:"",isActive:!0}),{data:w=[],isLoading:C}=Ve({queryKey:["qc-test-definitions"],queryFn:async()=>{const{data:J}=await xe.get("/qc/test-definitions");return J}}),A=ot({mutationFn:async J=>{const{data:Z}=await xe.post("/qc/test-definitions",J);return Z},onSuccess:()=>{r.invalidateQueries({queryKey:["qc-test-definitions"]}),t.success("Test Created","QC test definition has been added successfully"),M()},onError:J=>{t.error("Error",J.response?.data?.error||"Failed to create test definition")}}),T=ot({mutationFn:async({id:J,data:Z})=>{const{data:re}=await xe.put(`/qc/test-definitions/${J}`,Z);return re},onSuccess:()=>{r.invalidateQueries({queryKey:["qc-test-definitions"]}),t.success("Test Updated","QC test definition has been updated successfully"),M()},onError:J=>{t.error("Error",J.response?.data?.error||"Failed to update test definition")}}),O=ot({mutationFn:async J=>{await xe.delete(`/qc/test-definitions/${J}`)},onSuccess:()=>{r.invalidateQueries({queryKey:["qc-test-definitions"]}),t.success("Test Deleted","QC test definition has been removed"),l(null)},onError:J=>{t.error("Error",J.response?.data?.error||"Failed to delete test definition")}}),D=J=>{J?(s(J),v({code:J.code,nameEn:J.nameEn,nameAr:J.nameAr||"",descriptionEn:J.descriptionEn||"",descriptionAr:J.descriptionAr||"",resultType:J.resultType,unit:J.unit||"",optionList:J.optionList||"",category:J.category||"",method:J.method||"",isActive:J.isActive})):(s(null),v({code:"",nameEn:"",nameAr:"",descriptionEn:"",descriptionAr:"",resultType:"PASS_FAIL",unit:"",optionList:"",category:"",method:"",isActive:!0})),i(!0)},M=()=>{i(!1),s(null)},Q=J=>{J.preventDefault(),a?T.mutate({id:a.id,data:x}):A.mutate(x)},U=J=>{confirm(`Are you sure you want to delete "${J.nameEn}"?`)&&O.mutate(J.id)},$=w.filter(J=>{const Z=J.code.toLowerCase().includes(u.toLowerCase())||J.nameEn.toLowerCase().includes(u.toLowerCase()),re=!f||J.category===f;return Z&&re}),ee=[...new Set(w.map(J=>J.category).filter(Boolean))],F={total:w.length,active:w.filter(J=>J.isActive).length,inactive:w.filter(J=>!J.isActive).length,numeric:w.filter(J=>J.resultType==="NUMERIC").length},Y=J=>{switch(J){case"PASS_FAIL":return{bg:"rgba(34, 197, 94, 0.1)",color:"var(--success)"};case"NUMERIC":return{bg:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"};case"TEXT":return{bg:"rgba(234, 179, 8, 0.1)",color:"var(--warning)"};case"OPTION_LIST":return{bg:"rgba(168, 85, 247, 0.1)",color:"#a855f7"};default:return{bg:"rgba(100, 116, 139, 0.1)",color:"var(--text-muted)"}}};return C?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:"QC Test Definitions"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Manage catalog of quality control tests for radiopharmaceuticals"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>D(),children:[e.jsx(cn,{size:16})," Add Test"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Tests",value:F.total,icon:e.jsx(Bi,{size:20}),color:"primary",onClick:()=>p(""),active:!f}),e.jsx(nt,{title:"Active",value:F.active,icon:e.jsx(Ft,{size:20}),color:"success"}),e.jsx(nt,{title:"Inactive",value:F.inactive,icon:e.jsx(ri,{size:20}),color:"warning"}),e.jsx(nt,{title:"Numeric Tests",value:F.numeric,icon:e.jsx(Wl,{size:20}),color:"info"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:[e.jsxs("div",{style:{position:"relative",flex:1,minWidth:"200px"},children:[e.jsx(Gs,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search by code or name...",value:u,onChange:J=>d(J.target.value),style:{width:"100%",padding:"0.625rem 0.75rem 0.625rem 2.25rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",background:"var(--bg-primary)",fontSize:"0.875rem"}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Wo,{size:16,style:{color:"var(--text-muted)"}}),e.jsxs("select",{value:f,onChange:J=>p(J.target.value),style:{padding:"0.625rem 0.75rem",border:"1px solid var(--border)",borderRadius:"var(--radius)",background:"var(--bg-primary)",fontSize:"0.875rem",minWidth:"150px"},children:[e.jsx("option",{value:"",children:"All Categories"}),ee.map(J=>e.jsx("option",{value:J||"",children:J},J))]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[e.jsx("div",{style:{flex:1,minWidth:0},children:$.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",background:"var(--bg-primary)",borderRadius:"var(--radius)",border:"1px solid var(--border)"},children:[e.jsx(Bi,{size:48,style:{color:"var(--text-muted)",opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{color:"var(--text-muted)",margin:0},children:"No test definitions found. Add your first QC test to get started."})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:$.map(J=>{const Z=Y(J.resultType);return e.jsxs("div",{onClick:()=>l(J),style:{background:"var(--bg-primary)",border:o?.id===J.id?"2px solid var(--primary)":"1px solid var(--border)",borderRadius:"var(--radius)",padding:"1rem",cursor:"pointer",transition:"all 0.15s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"monospace",fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:J.code}),e.jsx("div",{style:{fontWeight:600,fontSize:"0.9375rem"},children:J.nameEn})]}),e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"9999px",fontSize:"0.6875rem",fontWeight:500,background:J.isActive?"rgba(34, 197, 94, 0.1)":"rgba(100, 116, 139, 0.1)",color:J.isActive?"var(--success)":"var(--text-muted)"},children:J.isActive?"Active":"Inactive"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"9999px",fontSize:"0.6875rem",background:Z.bg,color:Z.color},children:NC.find(re=>re.value===J.resultType)?.label}),J.category&&e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"9999px",fontSize:"0.6875rem",background:"var(--bg-secondary)",color:"var(--text-muted)"},children:J.category}),J.unit&&e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"9999px",fontSize:"0.6875rem",background:"var(--bg-secondary)",color:"var(--text-muted)"},children:J.unit})]})]},J.id)})})}),o&&e.jsxs("div",{style:{width:"320px",flexShrink:0,background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"1.25rem",height:"fit-content",position:"sticky",top:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"monospace",fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:o.code}),e.jsx("h3",{style:{margin:0,fontSize:"1.125rem",fontWeight:600},children:o.nameEn}),o.nameAr&&e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",direction:"rtl",marginTop:"0.25rem"},children:o.nameAr})]}),e.jsx("button",{onClick:()=>l(null),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem",color:"var(--text-muted)"},children:e.jsx(Dr,{size:18})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Status"}),e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:500,background:o.isActive?"rgba(34, 197, 94, 0.1)":"rgba(100, 116, 139, 0.1)",color:o.isActive?"var(--success)":"var(--text-muted)"},children:o.isActive?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Result Type"}),e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",background:Y(o.resultType).bg,color:Y(o.resultType).color},children:NC.find(J=>J.value===o.resultType)?.label})]}),o.category&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Category"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:o.category})]}),o.unit&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Unit"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:o.unit})]}),o.method&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Test Method"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:o.method})]}),o.optionList&&o.resultType==="OPTION_LIST"&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Options"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.375rem"},children:o.optionList.split(",").map((J,Z)=>e.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"9999px",fontSize:"0.6875rem",background:"var(--bg-secondary)",border:"1px solid var(--border)"},children:J.trim()},Z))})]}),o.descriptionEn&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:"0.375rem"},children:"Description"}),e.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",lineHeight:1.5},children:o.descriptionEn})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>D(o),children:[e.jsx(ma,{size:14})," Edit"]}),e.jsx("button",{className:"btn btn-secondary",style:{color:"var(--danger)"},onClick:()=>U(o),children:e.jsx(Gi,{size:14})})]})]})]})]}),n&&e.jsx("div",{className:"modal-overlay",onClick:M,children:e.jsxs("div",{className:"modal",style:{maxWidth:"40rem"},onClick:J=>J.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{fontWeight:600,margin:0},children:a?"Edit Test Definition":"Add Test Definition"}),e.jsx("button",{onClick:M,style:{background:"var(--bg-secondary)",border:"none",borderRadius:"var(--radius)",padding:"0.375rem",cursor:"pointer",fontSize:"1.25rem",lineHeight:1},children:""})]}),e.jsxs("form",{onSubmit:Q,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Code *"}),e.jsx("input",{type:"text",value:x.code,onChange:J=>v({...x,code:J.target.value.toUpperCase()}),className:"form-input",placeholder:"e.g., STERILITY",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsxs("select",{value:x.category,onChange:J=>v({...x,category:J.target.value}),className:"form-select",children:[e.jsx("option",{value:"",children:"Select Category"}),jEe.map(J=>e.jsx("option",{value:J,children:J},J))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (English) *"}),e.jsx("input",{type:"text",value:x.nameEn,onChange:J=>v({...x,nameEn:J.target.value}),className:"form-input",placeholder:"Sterility Test",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Name (Arabic)"}),e.jsx("input",{type:"text",value:x.nameAr,onChange:J=>v({...x,nameAr:J.target.value}),className:"form-input",dir:"rtl",placeholder:" "})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Description (English)"}),e.jsx("textarea",{value:x.descriptionEn,onChange:J=>v({...x,descriptionEn:J.target.value}),className:"form-input",rows:2,placeholder:"Detailed test description..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Result Type *"}),e.jsx("select",{value:x.resultType,onChange:J=>v({...x,resultType:J.target.value}),className:"form-select",required:!0,children:NC.map(J=>e.jsx("option",{value:J.value,children:J.label},J.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Unit"}),e.jsx("input",{type:"text",value:x.unit,onChange:J=>v({...x,unit:J.target.value}),className:"form-input",placeholder:"e.g., mCi, pH, %"})]}),x.resultType==="OPTION_LIST"&&e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Options (comma-separated)"}),e.jsx("input",{type:"text",value:x.optionList,onChange:J=>v({...x,optionList:J.target.value}),className:"form-input",placeholder:"Clear, Slightly Hazy, Hazy"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Test Method"}),e.jsx("input",{type:"text",value:x.method,onChange:J=>v({...x,method:J.target.value}),className:"form-input",placeholder:"USP <71> Sterility Testing"})]}),e.jsx("div",{className:"form-group",style:{gridColumn:"span 2"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:x.isActive,onChange:J=>v({...x,isActive:J.target.checked})}),e.jsx("span",{children:"Active"})]})})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",onClick:M,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:A.isPending||T.isPending,children:A.isPending||T.isPending?"Saving...":a?"Update Test":"Create Test"})]})]})]})})]})}const SEe=[{value:"PASS_FAIL_ONLY",label:"Pass/Fail Only"},{value:"MIN",label:"Minimum"},{value:"MAX",label:"Maximum"},{value:"RANGE",label:"Range"},{value:"EQUAL",label:"Equal To"},{value:"CUSTOM_TEXT",label:"Custom Text"}];function CEe(){const{productId:t}=fl(),r=Gr(),n=gn(),i=pr(),[a,s]=k.useState(null),[o,l]=k.useState(!1),[u,d]=k.useState([]),[f,p]=k.useState(null),{data:x}=Ve({queryKey:["product",t],queryFn:async()=>{const{data:re}=await xe.get(`/products/${t}`);return re},enabled:!!t}),{data:v=[],isLoading:w}=Ve({queryKey:["product-qc-templates",t],queryFn:async()=>{const{data:re}=await xe.get(`/products/${t}/qc-templates`);return re},enabled:!!t}),{data:C=[]}=Ve({queryKey:["qc-test-definitions-active"],queryFn:async()=>{const{data:re}=await xe.get("/qc/test-definitions");return re.filter(de=>de.isActive)}});k.useEffect(()=>{a&&d(a.templateLines||[])},[a]);const A=ot({mutationFn:async()=>{const{data:re}=await xe.post(`/products/${t}/qc-templates`,{notes:"",lines:[]});return re},onSuccess:re=>{i.invalidateQueries({queryKey:["product-qc-templates",t]}),s(re),d([]),n.success("Template Created","New draft template created")},onError:re=>{n.error("Error",re.response?.data?.error||"Failed to create template")}}),T=ot({mutationFn:async()=>{if(!a)return;const{data:re}=await xe.put(`/products/${t}/qc-templates/${a.id}`,{lines:u.map((de,le)=>({testDefinitionId:de.testDefinitionId,displayOrder:le,isRequired:de.isRequired,specRule:de.specRule,criteriaTextOverrideEn:de.criteriaTextOverrideEn,allowManualPassFail:de.allowManualPassFail,attachmentRequired:de.attachmentRequired}))});return re},onSuccess:()=>{i.invalidateQueries({queryKey:["product-qc-templates",t]}),n.success("Saved","Template changes saved")},onError:re=>{n.error("Error",re.response?.data?.error||"Failed to save")}}),O=ot({mutationFn:async()=>{if(!a)return;const{data:re}=await xe.post(`/products/${t}/qc-templates/${a.id}/activate`);return re},onSuccess:()=>{i.invalidateQueries({queryKey:["product-qc-templates",t]}),n.success("Activated","Template is now active")},onError:re=>{n.error("Error",re.response?.data?.error||"Failed to activate")}}),D=ot({mutationFn:async()=>{if(!a)return;const{data:re}=await xe.post(`/products/${t}/qc-templates/${a.id}/retire`);return re},onSuccess:()=>{i.invalidateQueries({queryKey:["product-qc-templates",t]}),n.success("Retired","Template has been retired")},onError:re=>{n.error("Error",re.response?.data?.error||"Failed to retire")}}),M=ot({mutationFn:async()=>{if(!a)return;const{data:re}=await xe.delete(`/products/${t}/qc-templates/${a.id}`);return re},onSuccess:()=>{i.invalidateQueries({queryKey:["product-qc-templates",t]}),s(null),n.success("Deleted","Template version has been deleted")},onError:re=>{n.error("Error",re.response?.data?.error||"Failed to delete template")}}),Q=()=>{if(!a)return;const re=a._count?.batchQcSessions||0;if(re>0){n.error("Cannot Delete",`This template is referenced by ${re} batch QC session(s). Consider retiring it instead.`);return}if(a.status==="ACTIVE"){n.error("Cannot Delete","Cannot delete an active template. Retire it first or activate a different version.");return}confirm(`Are you sure you want to delete version ${a.version}? This action cannot be undone.`)&&M.mutate()},U=re=>{d([...u,{testDefinitionId:re.id,testDefinition:re,displayOrder:u.length,isRequired:!0,allowManualPassFail:!1,attachmentRequired:!1,specRule:{ruleType:"PASS_FAIL_ONLY"}}]),l(!1)},$=re=>{d(u.filter((de,le)=>le!==re)),p(null)},ee=(re,de)=>{const le=[...u],K=de==="up"?re-1:re+1;[le[re],le[K]]=[le[K],le[re]],d(le)},F=(re,de)=>{d(u.map((le,K)=>K===re?{...le,...de}:le))},Y=re=>{const de=re.specRule;if(!de)return"-";const le=re.testDefinition?.unit?` ${re.testDefinition.unit}`:"";switch(de.ruleType){case"MIN":return`${de.minValue}${le}`;case"MAX":return`${de.maxValue}${le}`;case"RANGE":return`${de.minValue}${de.maxValue}${le}`;case"EQUAL":return`=${de.targetValue}${le}`;case"PASS_FAIL_ONLY":return"Pass/Fail";case"CUSTOM_TEXT":return de.textCriteriaEn||"-";default:return"-"}},J={total:v.length,active:v.filter(re=>re.status==="ACTIVE").length,draft:v.filter(re=>re.status==="DRAFT").length,retired:v.filter(re=>re.status==="RETIRED").length},Z=re=>{switch(re){case"ACTIVE":return{bg:"rgba(34, 197, 94, 0.1)",color:"var(--success)"};case"DRAFT":return{bg:"rgba(234, 179, 8, 0.1)",color:"var(--warning)"};case"RETIRED":return{bg:"rgba(100, 116, 139, 0.1)",color:"var(--text-muted)"};default:return{bg:"rgba(100, 116, 139, 0.1)",color:"var(--text-muted)"}}};return w?e.jsx("div",{className:"loading-overlay",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("button",{onClick:()=>r("/products"),style:{background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(sa,{size:18})}),e.jsxs("div",{children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.25rem"},children:["QC Template: ",x?.name||"Loading..."]}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:"Configure quality control tests for this product"})]})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>A.mutate(),disabled:A.isPending,children:[e.jsx(cn,{size:16})," New Version"]})]}),e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx(nt,{title:"Total Versions",value:J.total,icon:e.jsx(Ir,{size:20}),color:"primary"}),e.jsx(nt,{title:"Active",value:J.active,icon:e.jsx(Ft,{size:20}),color:"success"}),e.jsx(nt,{title:"Draft",value:J.draft,icon:e.jsx(ma,{size:20}),color:"warning"}),e.jsx(nt,{title:"Retired",value:J.retired,icon:e.jsx(Mp,{size:20}),color:"default"})]}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[e.jsx("div",{style:{width:"280px",flexShrink:0},children:e.jsxs("div",{style:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"1rem"},children:[e.jsx("h3",{style:{fontWeight:600,marginBottom:"1rem",fontSize:"0.9375rem"},children:"Template Versions"}),v.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem 1rem",color:"var(--text-muted)"},children:[e.jsx(Bi,{size:32,style:{opacity:.3,marginBottom:"0.5rem"}}),e.jsx("p",{style:{margin:0,fontSize:"0.875rem"},children:"No templates yet"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:v.map(re=>{const de=Z(re.status);return e.jsxs("button",{onClick:()=>s(re),style:{width:"100%",textAlign:"left",padding:"0.75rem",borderRadius:"var(--radius)",border:a?.id===re.id?"2px solid var(--primary)":"1px solid var(--border)",background:a?.id===re.id?"rgba(59, 130, 246, 0.05)":"var(--bg-primary)",cursor:"pointer",transition:"all 0.15s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{fontWeight:500},children:["Version ",re.version]}),e.jsx("span",{style:{fontSize:"0.6875rem",padding:"0.125rem 0.5rem",borderRadius:"9999px",background:de.bg,color:de.color},children:re.status})]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[re.templateLines?.length||0," tests",re._count?.batchQcSessions?`  ${re._count.batchQcSessions} batches`:""]})]},re.id)})})]})}),e.jsx("div",{style:{flex:1,minWidth:0},children:a?e.jsxs("div",{style:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1.25rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsxs("h3",{style:{margin:0,fontWeight:600,fontSize:"1.125rem"},children:["Version ",a.version]}),e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"9999px",background:Z(a.status).bg,color:Z(a.status).color},children:a.status})]}),a.effectiveFrom&&e.jsxs("p",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",margin:"0.25rem 0 0"},children:["Effective from: ",new Date(a.effectiveFrom).toLocaleDateString()]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[a.status==="DRAFT"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>T.mutate(),disabled:T.isPending,children:"Save Changes"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>O.mutate(),disabled:u.length===0||O.isPending,children:[e.jsx(yo,{size:14})," Activate"]})]}),a.status==="ACTIVE"&&e.jsxs("button",{className:"btn btn-secondary",onClick:()=>D.mutate(),disabled:D.isPending,children:[e.jsx(Mp,{size:14})," Retire"]}),(a.status==="DRAFT"||a.status==="RETIRED")&&e.jsxs("button",{className:"btn",style:{background:"rgba(239, 68, 68, 0.1)",color:"var(--error)",border:"1px solid var(--error)"},onClick:Q,disabled:M.isPending||(a._count?.batchQcSessions||0)>0,title:(a._count?.batchQcSessions||0)>0?"Cannot delete: template is used by batch QC sessions":"Delete this template version",children:[e.jsx(Gi,{size:14})," Delete"]})]})]}),a.status!=="DRAFT"&&e.jsxs("div",{style:{background:"rgba(234, 179, 8, 0.1)",color:"var(--warning)",padding:"0.75rem 1rem",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.8125rem"},children:["This template is ",a.status.toLowerCase(),". Create a new version to make changes."]}),e.jsx("div",{style:{border:"1px solid var(--border)",borderRadius:"var(--radius)",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.75rem 1rem",fontSize:"0.75rem",fontWeight:500,color:"var(--text-muted)",width:"40px"},children:"#"}),e.jsx("th",{style:{textAlign:"left",padding:"0.75rem 1rem",fontSize:"0.75rem",fontWeight:500,color:"var(--text-muted)"},children:"Test"}),e.jsx("th",{style:{textAlign:"left",padding:"0.75rem 1rem",fontSize:"0.75rem",fontWeight:500,color:"var(--text-muted)"},children:"Category"}),e.jsx("th",{style:{textAlign:"left",padding:"0.75rem 1rem",fontSize:"0.75rem",fontWeight:500,color:"var(--text-muted)"},children:"Result Type"}),e.jsx("th",{style:{textAlign:"left",padding:"0.75rem 1rem",fontSize:"0.75rem",fontWeight:500,color:"var(--text-muted)"},children:"Criteria"}),e.jsx("th",{style:{textAlign:"center",padding:"0.75rem 1rem",fontSize:"0.75rem",fontWeight:500,color:"var(--text-muted)"},children:"Required"}),e.jsx("th",{style:{width:"100px"}})]})}),e.jsxs("tbody",{children:[u.map((re,de)=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"0.75rem 1rem",color:"var(--text-muted)",fontSize:"0.8125rem"},children:de+1}),e.jsx("td",{style:{padding:"0.75rem 1rem",fontWeight:500},children:re.testDefinition?.nameEn||re.testDefinitionId}),e.jsx("td",{style:{padding:"0.75rem 1rem",color:"var(--text-muted)"},children:re.testDefinition?.category||"-"}),e.jsx("td",{style:{padding:"0.75rem 1rem"},children:e.jsx("span",{style:{fontSize:"0.6875rem",padding:"0.125rem 0.5rem",borderRadius:"9999px",background:"rgba(59, 130, 246, 0.1)",color:"var(--primary)"},children:re.testDefinition?.resultType})}),e.jsx("td",{style:{padding:"0.75rem 1rem"},children:Y(re)}),e.jsx("td",{style:{padding:"0.75rem 1rem",textAlign:"center"},children:re.isRequired?e.jsx(Ai,{size:16,style:{color:"var(--success)"}}):e.jsx(Dr,{size:16,style:{color:"var(--text-muted)"}})}),e.jsx("td",{style:{padding:"0.75rem 1rem"},children:a.status==="DRAFT"&&e.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>ee(de,"up"),disabled:de===0,style:{padding:"0.25rem",background:"none",border:"none",cursor:de===0?"not-allowed":"pointer",opacity:de===0?.3:1,borderRadius:"var(--radius)"},children:e.jsx(nh,{size:16})}),e.jsx("button",{onClick:()=>ee(de,"down"),disabled:de===u.length-1,style:{padding:"0.25rem",background:"none",border:"none",cursor:de===u.length-1?"not-allowed":"pointer",opacity:de===u.length-1?.3:1,borderRadius:"var(--radius)"},children:e.jsx(qo,{size:16})}),e.jsx("button",{onClick:()=>p(f===de?null:de),style:{padding:"0.25rem",background:f===de?"rgba(59, 130, 246, 0.1)":"none",border:"none",cursor:"pointer",borderRadius:"var(--radius)"},children:e.jsx(ma,{size:14})}),e.jsx("button",{onClick:()=>$(de),style:{padding:"0.25rem",background:"none",border:"none",cursor:"pointer",color:"var(--danger)",borderRadius:"var(--radius)"},children:e.jsx(Gi,{size:14})})]})})]},re.testDefinitionId+de),f===de&&a.status==="DRAFT"&&e.jsx("tr",{style:{background:"var(--bg-secondary)"},children:e.jsx("td",{colSpan:7,style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Rule Type"}),e.jsx("select",{value:re.specRule?.ruleType||"PASS_FAIL_ONLY",onChange:le=>F(de,{specRule:{...re.specRule,ruleType:le.target.value}}),className:"form-control",children:SEe.map(le=>e.jsx("option",{value:le.value,children:le.label},le.value))})]}),["MIN","RANGE"].includes(re.specRule?.ruleType||"")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Min Value"}),e.jsx("input",{type:"number",value:re.specRule?.minValue||"",onChange:le=>F(de,{specRule:{...re.specRule,ruleType:re.specRule?.ruleType||"MIN",minValue:parseFloat(le.target.value)}}),className:"form-control",placeholder:"0"})]}),["MAX","RANGE"].includes(re.specRule?.ruleType||"")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Max Value"}),e.jsx("input",{type:"number",value:re.specRule?.maxValue||"",onChange:le=>F(de,{specRule:{...re.specRule,ruleType:re.specRule?.ruleType||"MAX",maxValue:parseFloat(le.target.value)}}),className:"form-control",placeholder:"100"})]}),re.specRule?.ruleType==="EQUAL"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Target Value"}),e.jsx("input",{type:"number",value:re.specRule?.targetValue||"",onChange:le=>F(de,{specRule:{...re.specRule,ruleType:"EQUAL",targetValue:parseFloat(le.target.value)}}),className:"form-control",placeholder:"7.0"})]}),re.specRule?.ruleType==="CUSTOM_TEXT"&&e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Custom Criteria Text"}),e.jsx("input",{type:"text",value:re.specRule?.textCriteriaEn||"",onChange:le=>F(de,{specRule:{...re.specRule,ruleType:"CUSTOM_TEXT",textCriteriaEn:le.target.value}}),className:"form-control",placeholder:"Clear to slightly opalescent"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:re.isRequired,onChange:le=>F(de,{isRequired:le.target.checked})}),"Required"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:re.attachmentRequired,onChange:le=>F(de,{attachmentRequired:le.target.checked})}),"Attachment Required"]})]})]})})})]})),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:'No tests added yet. Click "Add Test" to add QC tests to this template.'})})]})]})}),a.status==="DRAFT"&&e.jsx("div",{style:{marginTop:"1rem"},children:o?e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{margin:0,fontWeight:500},children:"Select a Test to Add"}),e.jsx("button",{onClick:()=>l(!1),style:{background:"none",border:"none",cursor:"pointer",padding:"0.25rem"},children:e.jsx(Dr,{size:16})})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5rem",maxHeight:"15rem",overflowY:"auto"},children:C.filter(re=>!u.some(de=>de.testDefinitionId===re.id)).map(re=>e.jsxs("button",{onClick:()=>U(re),style:{textAlign:"left",padding:"0.5rem 0.75rem",borderRadius:"var(--radius)",border:"1px solid var(--border)",background:"var(--bg-primary)",cursor:"pointer",transition:"all 0.15s ease"},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"0.8125rem"},children:re.nameEn}),e.jsxs("div",{style:{fontSize:"0.6875rem",color:"var(--text-muted)"},children:[re.code," | ",re.resultType]})]},re.id))})]}):e.jsxs("button",{className:"btn btn-secondary",onClick:()=>l(!0),children:[e.jsx(cn,{size:16})," Add Test"]})})]}):e.jsxs("div",{style:{background:"var(--bg-primary)",border:"1px solid var(--border)",borderRadius:"var(--radius)",padding:"3rem",textAlign:"center",color:"var(--text-muted)"},children:[e.jsx(Bi,{size:48,style:{opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{margin:0},children:"Select a template version to edit, or create a new one"})]})})]})]})}const NEe={NOT_STARTED:{color:"gray",icon:Qt,label:"Not Started"},IN_PROGRESS:{color:"yellow",icon:yo,label:"In Progress"},WAITING_REVIEW:{color:"blue",icon:Qi,label:"Awaiting Review"},QC_PASSED:{color:"green",icon:Ft,label:"QC Passed"},QC_FAILED:{color:"red",icon:ri,label:"QC Failed"}};function AEe(){const{batchId:t}=fl(),r=Gr(),n=gn(),i=pr(),[a,s]=k.useState(null),[o,l]=k.useState(""),[u,d]=k.useState(!1),{data:f}=Ve({queryKey:["batch",t],queryFn:async()=>{const{data:Y}=await xe.get(`/batches/${t}`);return Y},enabled:!!t}),{data:p,isLoading:x,error:v}=Ve({queryKey:["batch-qc-session",t],queryFn:async()=>{const{data:Y}=await xe.get(`/batches/${t}/qc-session`);return Y},enabled:!!t,retry:!1}),w=ot({mutationFn:async()=>{const{data:Y}=await xe.post(`/batches/${t}/qc-session/generate`);return Y},onSuccess:()=>{i.invalidateQueries({queryKey:["batch-qc-session",t]}),n.success("Session Generated","QC session created from product template")},onError:Y=>{n.error("Error",Y.response?.data?.error||"Failed to generate QC session")}}),C=ot({mutationFn:async({resultId:Y,data:J})=>{const{data:Z}=await xe.put(`/batches/${t}/qc-session/results/${Y}`,J);return Z},onSuccess:()=>{i.invalidateQueries({queryKey:["batch-qc-session",t]}),s(null)},onError:Y=>{n.error("Error",Y.response?.data?.error||"Failed to save result")}}),A=ot({mutationFn:async()=>{const{data:Y}=await xe.post(`/batches/${t}/qc-session/submit`);return Y},onSuccess:()=>{i.invalidateQueries({queryKey:["batch-qc-session",t]}),n.success("Submitted","QC session submitted for review")},onError:Y=>{n.error("Error",Y.response?.data?.error||"Failed to submit session")}}),T=ot({mutationFn:async Y=>{const{data:J}=await xe.post(`/batches/${t}/qc-session/review`,{decision:Y,notes:o});return J},onSuccess:()=>{i.invalidateQueries({queryKey:["batch-qc-session",t]}),i.invalidateQueries({queryKey:["batch",t]}),d(!1),n.success("Reviewed","QC session review completed")},onError:Y=>{n.error("Error",Y.response?.data?.error||"Failed to complete review")}}),O=Y=>{const J=a===Y.id,Z=["QC_PASSED","QC_FAILED"].includes(p?.status||"");return!J||Z?e.jsxs("div",{onClick:()=>!Z&&s(Y.id),className:`cursor-pointer p-2 rounded hover:bg-hover min-w-[100px] ${Z?"":"border border-dashed border-default"}`,children:[Y.resultType==="PASS_FAIL"&&Y.passFailValue&&e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Y.passFailValue==="PASS"?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500"}`,children:Y.passFailValue}),Y.resultType==="NUMERIC"&&Y.numericValue!==null&&e.jsxs("span",{children:[Y.numericValue,Y.unit&&e.jsx("span",{className:"text-muted ml-1",children:Y.unit})]}),Y.resultType==="TEXT"&&Y.textValue&&e.jsx("span",{className:"text-sm",children:Y.textValue}),!Y.numericValue&&!Y.passFailValue&&!Y.textValue&&e.jsx("span",{className:"text-muted text-sm",children:"Click to enter"})]}):Y.resultType==="PASS_FAIL"?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>C.mutate({resultId:Y.id,data:{passFailValue:"PASS"}}),className:"btn btn-sm bg-green-500/10 text-green-500 hover:bg-green-500/20",children:"PASS"}),e.jsx("button",{onClick:()=>C.mutate({resultId:Y.id,data:{passFailValue:"FAIL"}}),className:"btn btn-sm bg-red-500/10 text-red-500 hover:bg-red-500/20",children:"FAIL"}),e.jsx("button",{onClick:()=>s(null),className:"btn btn-sm btn-secondary",children:"Cancel"})]}):Y.resultType==="NUMERIC"?e.jsxs("form",{onSubmit:re=>{re.preventDefault();const le=re.target.elements.namedItem("value");C.mutate({resultId:Y.id,data:{numericValue:parseFloat(le.value)}})},className:"flex gap-2",children:[e.jsx("input",{name:"value",type:"number",step:"any",defaultValue:Y.numericValue||"",className:"input w-24",autoFocus:!0}),Y.unit&&e.jsx("span",{className:"self-center text-muted",children:Y.unit}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>s(null),className:"btn btn-sm btn-secondary",children:"Cancel"})]}):Y.resultType==="TEXT"?e.jsxs("form",{onSubmit:re=>{re.preventDefault();const le=re.target.elements.namedItem("value");C.mutate({resultId:Y.id,data:{textValue:le.value}})},className:"flex gap-2",children:[e.jsx("input",{name:"value",type:"text",defaultValue:Y.textValue||"",className:"input w-48",autoFocus:!0}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>s(null),className:"btn btn-sm btn-secondary",children:"Cancel"})]}):null},D=Y=>{switch(Y){case"PASS":return e.jsx(Ai,{size:16,className:"text-green-500"});case"FAIL":return e.jsx(Dr,{size:16,className:"text-red-500"});default:return e.jsx(Qt,{size:16,className:"text-muted"})}},M=p?NEe[p.status]:null,Q=M?.icon,U=!p&&!x&&v,$=p?.status==="IN_PROGRESS"&&p.summary.completedTests===p.summary.totalTests,ee=p?.status==="WAITING_REVIEW",F=["QC_PASSED","QC_FAILED"].includes(p?.status||"");return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>r(`/batches/${t}`),className:"p-2 hover:bg-hover rounded-lg",children:e.jsx(sa,{size:20})}),e.jsx(Ad,{title:`QC Testing: ${f?.batchNumber||"Loading..."}`,subtitle:f?.product?.name||"",icon:e.jsx(Bi,{size:24})})]}),U?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(Bi,{size:48,className:"mx-auto mb-4 text-muted"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No QC Session"}),e.jsx("p",{className:"text-muted mb-6",children:"Generate a QC session from the product's active template to start testing."}),e.jsx("button",{onClick:()=>w.mutate(),className:"btn btn-primary",disabled:w.isPending,children:w.isPending?"Generating...":"Generate QC Session"})]}):x?e.jsx("div",{className:"card text-center py-12 text-muted",children:"Loading QC session..."}):p?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-muted mb-1",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[Q&&e.jsx(Q,{size:20,className:`text-${M?.color}-500`}),e.jsx("span",{className:`px-2 py-1 text-sm rounded-full bg-${M?.color}-500/10 text-${M?.color}-500`,children:M?.label})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-muted mb-1",children:"Progress"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-hover rounded-full h-2",children:e.jsx("div",{className:"bg-primary rounded-full h-2 transition-all",style:{width:`${p.summary.progress}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[p.summary.progress,"%"]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-muted mb-1",children:"Tests"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ai,{size:14,className:"text-green-500"}),e.jsx("span",{className:"text-green-500 font-medium",children:p.summary.passedTests})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Dr,{size:14,className:"text-red-500"}),e.jsx("span",{className:"text-red-500 font-medium",children:p.summary.failedTests})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qt,{size:14,className:"text-muted"}),e.jsx("span",{className:"text-muted font-medium",children:p.summary.totalTests-p.summary.completedTests})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"text-sm text-muted mb-1",children:"Actions"}),e.jsxs("div",{className:"flex gap-2",children:[$&&e.jsxs("button",{onClick:()=>A.mutate(),className:"btn btn-primary btn-sm flex items-center gap-1",disabled:A.isPending,children:[e.jsx(Qi,{size:14}),"Submit for Review"]}),ee&&e.jsxs("button",{onClick:()=>d(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[e.jsx(Ft,{size:14}),"Review"]}),F&&p.reviewedByUser&&e.jsxs("span",{className:"text-sm text-muted",children:["Reviewed by ",p.reviewedByUser.firstName," ",p.reviewedByUser.lastName]})]})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-hover",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-muted w-12",children:"#"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-muted",children:"Test"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-muted",children:"Criteria"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-muted",children:"Result"}),e.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-muted",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-muted",children:"Notes"})]})}),e.jsx("tbody",{children:p.results.map((Y,J)=>e.jsxs("tr",{className:`border-t border-default ${Y.status==="FAIL"?"bg-red-500/5":""}`,children:[e.jsx("td",{className:"py-3 px-4 text-muted",children:J+1}),e.jsxs("td",{className:"py-3 px-4",children:[e.jsx("div",{className:"font-medium",children:Y.testDefinition?.nameEn}),e.jsxs("div",{className:"text-xs text-muted",children:[Y.testDefinition?.code,Y.isRequired&&e.jsx("span",{className:"ml-2 text-red-500",children:"*Required"})]})]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"text-sm bg-hover px-2 py-1 rounded",children:Y.criteriaDisplayEn||"-"})}),e.jsx("td",{className:"py-3 px-4",children:O(Y)}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[D(Y.status),e.jsx("span",{className:`text-xs ${Y.status==="PASS"?"text-green-500":Y.status==="FAIL"?"text-red-500":"text-muted"}`,children:Y.status})]})}),e.jsxs("td",{className:"py-3 px-4",children:[Y.failReason&&e.jsxs("div",{className:"flex items-start gap-1 text-red-500 text-sm",children:[e.jsx(sn,{size:14,className:"mt-0.5 flex-shrink-0"}),e.jsx("span",{children:Y.failReason})]}),Y.enteredByUser&&e.jsxs("div",{className:"text-xs text-muted mt-1",children:["By ",Y.enteredByUser.firstName," ",Y.enteredByUser.lastName]}),Y.attachments.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-primary mt-1",children:[e.jsx(ah,{size:12}),Y.attachments.length," file(s)"]})]})]},Y.id))})]})})})]}):null,u&&e.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:e.jsxs("div",{className:"modal-content max-w-lg",onClick:Y=>Y.stopPropagation(),children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Review QC Session"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Passed Tests:"}),e.jsx("span",{className:"text-green-500 font-medium",children:p?.summary.passedTests})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Failed Tests:"}),e.jsx("span",{className:"text-red-500 font-medium",children:p?.summary.failedTests})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label",children:"Review Notes"}),e.jsx("textarea",{value:o,onChange:Y=>l(Y.target.value),className:"input w-full",rows:3,placeholder:"Add any notes about this review..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>T.mutate("REJECT"),className:"btn flex-1 bg-red-500/10 text-red-500 hover:bg-red-500/20",disabled:T.isPending,children:[e.jsx(Dr,{size:16,className:"mr-1"}),"Reject"]}),e.jsxs("button",{onClick:()=>T.mutate("APPROVE"),className:"btn btn-primary flex-1",disabled:T.isPending||(p?.summary.failedTests||0)>0,children:[e.jsx(Ai,{size:16,className:"mr-1"}),"Approve"]})]}),(p?.summary.failedTests||0)>0&&e.jsxs("p",{className:"text-red-500 text-sm mt-3 text-center",children:["Cannot approve: ",p?.summary.failedTests," test(s) failed"]})]})})]})}function EEe({children:t}){const{user:r,isAuthenticated:n,isLoading:i}=Il();return i?e.jsx("div",{className:"loading-overlay",style:{height:"100vh"},children:e.jsx("div",{className:"spinner"})}):n?r?.role!=="Customer"?e.jsx(Kf,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:t}):e.jsx(Kf,{to:"/login",replace:!0})}function _Ee({children:t}){const{user:r,isAuthenticated:n,isLoading:i}=Il();return i?e.jsx("div",{className:"loading-overlay",style:{height:"100vh"},children:e.jsx("div",{className:"spinner"})}):n?r?.role!=="Driver"?e.jsx(Kf,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:t}):e.jsx(Kf,{to:"/login",replace:!0})}function TEe({children:t}){const{user:r,isAuthenticated:n,isLoading:i}=Il();return i?e.jsx("div",{className:"loading-overlay",style:{height:"100vh"},children:e.jsx("div",{className:"spinner"})}):n?r?.role==="Customer"?e.jsx(Kf,{to:"/portal",replace:!0}):r?.role==="Driver"?e.jsx(Kf,{to:"/driver",replace:!0}):e.jsx(e.Fragment,{children:t}):e.jsx(Kf,{to:"/login",replace:!0})}function IEe(){const{checkAuth:t,isLoading:r}=Il();return k.useEffect(()=>{t()},[t]),r?e.jsx("div",{className:"loading-overlay",style:{height:"100vh"},children:e.jsx("div",{className:"spinner"})}):e.jsx(zX,{children:e.jsxs(Mx,{children:[e.jsx(Vt,{path:"/login",element:e.jsx(gne,{})}),e.jsx(Vt,{path:"/portal/*",element:e.jsx(EEe,{children:e.jsx(mne,{children:e.jsxs(Mx,{children:[e.jsx(Vt,{path:"/",element:e.jsx(nNe,{})}),e.jsx(Vt,{path:"/orders",element:e.jsx(iNe,{})}),e.jsx(Vt,{path:"/orders/new",element:e.jsx(aNe,{})}),e.jsx(Vt,{path:"/orders/:id/journey",element:e.jsx(oNe,{})}),e.jsx(Vt,{path:"/book-capacity",element:e.jsx(mNe,{})}),e.jsx(Vt,{path:"/invoices",element:e.jsx(sNe,{})}),e.jsx(Vt,{path:"/helpdesk",element:e.jsx(yNe,{})}),e.jsx(Vt,{path:"/helpdesk/new",element:e.jsx(bNe,{})}),e.jsx(Vt,{path:"/helpdesk/:id",element:e.jsx(wNe,{})}),e.jsx(Vt,{path:"/notifications",element:e.jsx(NNe,{})}),e.jsx(Vt,{path:"/profile",element:e.jsx(fNe,{})})]})})})}),e.jsx(Vt,{path:"/driver/*",element:e.jsx(_Ee,{children:e.jsx(pne,{children:e.jsxs(Mx,{children:[e.jsx(Vt,{path:"/",element:e.jsx(xAe,{})}),e.jsx(Vt,{path:"/shipments",element:e.jsx(vAe,{})}),e.jsx(Vt,{path:"/shipments/:id",element:e.jsx(bAe,{})})]})})})}),e.jsx(Vt,{path:"/*",element:e.jsx(TEe,{children:e.jsx(fne,{children:e.jsxs(Mx,{children:[e.jsx(Vt,{path:"/",element:e.jsx(E2e,{})}),e.jsx(Vt,{path:"/dashboard/qc",element:e.jsx(ENe,{})}),e.jsx(Vt,{path:"/dashboard/qp",element:e.jsx(_Ne,{})}),e.jsx(Vt,{path:"/dashboard/dispensing",element:e.jsx(TNe,{})}),e.jsx(Vt,{path:"/dashboard/logistics",element:e.jsx(INe,{})}),e.jsx(Vt,{path:"/customers",element:e.jsx(P2e,{})}),e.jsx(Vt,{path:"/customers/new",element:e.jsx(sP,{})}),e.jsx(Vt,{path:"/customers/:id/edit",element:e.jsx(sP,{})}),e.jsx(Vt,{path:"/products",element:e.jsx(vje,{})}),e.jsx(Vt,{path:"/materials",element:e.jsx(YAe,{})}),e.jsx(Vt,{path:"/materials/:id",element:e.jsx(ZAe,{})}),e.jsx(Vt,{path:"/recipes",element:e.jsx(tEe,{})}),e.jsx(Vt,{path:"/suppliers",element:e.jsx(nEe,{})}),e.jsx(Vt,{path:"/suppliers/:id",element:e.jsx(iEe,{})}),e.jsx(Vt,{path:"/purchase-orders",element:e.jsx(aEe,{})}),e.jsx(Vt,{path:"/purchase-orders/:id",element:e.jsx(oEe,{})}),e.jsx(Vt,{path:"/warehouses",element:e.jsx(lEe,{})}),e.jsx(Vt,{path:"/warehouses/:id",element:e.jsx(cEe,{})}),e.jsx(Vt,{path:"/grn",element:e.jsx(dEe,{})}),e.jsx(Vt,{path:"/grn/:id",element:e.jsx(hEe,{})}),e.jsx(Vt,{path:"/inventory",element:e.jsx(fEe,{})}),e.jsx(Vt,{path:"/manufacturing",element:e.jsx(gEe,{})}),e.jsx(Vt,{path:"/oos-investigations",element:e.jsx(xEe,{})}),e.jsx(Vt,{path:"/orders",element:e.jsx(bje,{})}),e.jsx(Vt,{path:"/orders/new",element:e.jsx(cP,{})}),e.jsx(Vt,{path:"/orders/:id",element:e.jsx(cP,{})}),e.jsx(Vt,{path:"/orders/:id/journey",element:e.jsx(XCe,{})}),e.jsx(Vt,{path:"/order-journey-diagram",element:e.jsx(rNe,{})}),e.jsx(Vt,{path:"/planner",element:e.jsx(wje,{})}),e.jsx(Vt,{path:"/production-schedule",element:e.jsx(Aje,{})}),e.jsx(Vt,{path:"/batches",element:e.jsx(F5e,{})}),e.jsx(Vt,{path:"/batches/:id/journey",element:e.jsx(tNe,{})}),e.jsx(Vt,{path:"/qc",element:e.jsx(q5e,{})}),e.jsx(Vt,{path:"/release",element:e.jsx(V5e,{})}),e.jsx(Vt,{path:"/shipments",element:e.jsx($5e,{})}),e.jsx(Vt,{path:"/shipments/:id",element:e.jsx(hAe,{})}),e.jsx(Vt,{path:"/drivers",element:e.jsx(dAe,{})}),e.jsx(Vt,{path:"/users",element:e.jsx(G5e,{})}),e.jsx(Vt,{path:"/reports",element:e.jsx(K5e,{})}),e.jsx(Vt,{path:"/enterprise-reports",element:e.jsx(Y5e,{})}),e.jsx(Vt,{path:"/audit",element:e.jsx(Z5e,{})}),e.jsx(Vt,{path:"/approvals",element:e.jsx(X5e,{})}),e.jsx(Vt,{path:"/dispensing",element:e.jsx(J5e,{})}),e.jsx(Vt,{path:"/availability",element:e.jsx(ewe,{})}),e.jsx(Vt,{path:"/reservations",element:e.jsx(rwe,{})}),e.jsx(Vt,{path:"/contracts",element:e.jsx(iwe,{})}),e.jsx(Vt,{path:"/invoices",element:e.jsx(YCe,{})}),e.jsx(Vt,{path:"/payments",element:e.jsx(ONe,{})}),e.jsx(Vt,{path:"/profile",element:e.jsx(yAe,{})}),e.jsx(Vt,{path:"/settings",element:e.jsx(ANe,{})}),e.jsx(Vt,{path:"/settings/attachments",element:e.jsx(kNe,{})}),e.jsx(Vt,{path:"/settings/notifications",element:e.jsx(bEe,{})}),e.jsx(Vt,{path:"/admin/demo",element:e.jsx(JNe,{})}),e.jsx(Vt,{path:"/admin/languages",element:e.jsx(DNe,{})}),e.jsx(Vt,{path:"/admin/exchange-rates",element:e.jsx(PNe,{})}),e.jsx(Vt,{path:"/admin/localization",element:e.jsx(zNe,{})}),e.jsx(Vt,{path:"/admin/translations",element:e.jsx(BNe,{})}),e.jsx(Vt,{path:"/admin/zatca",element:e.jsx(FNe,{})}),e.jsx(Vt,{path:"/admin/zatca/config",element:e.jsx(qNe,{})}),e.jsx(Vt,{path:"/admin/zatca/onboarding",element:e.jsx(UNe,{})}),e.jsx(Vt,{path:"/admin/notification-channels",element:e.jsx(GNe,{})}),e.jsx(Vt,{path:"/admin/notification-delivery-logs",element:e.jsx(QNe,{})}),e.jsx(Vt,{path:"/admin/announcements",element:e.jsx(XNe,{})}),e.jsx(Vt,{path:"/admin/announcements/new",element:e.jsx(yM,{})}),e.jsx(Vt,{path:"/admin/announcements/:id/edit",element:e.jsx(yM,{})}),e.jsx(Vt,{path:"/admin/helpdesk",element:e.jsx(nAe,{})}),e.jsx(Vt,{path:"/admin/helpdesk/tasks",element:e.jsx(sAe,{})}),e.jsx(Vt,{path:"/admin/helpdesk/tickets/:id",element:e.jsx(cAe,{})}),e.jsx(Vt,{path:"/admin/qc/test-definitions",element:e.jsx(wEe,{})}),e.jsx(Vt,{path:"/products/:productId/qc-template",element:e.jsx(CEe,{})}),e.jsx(Vt,{path:"/batches/:batchId/qc",element:e.jsx(AEe,{})}),e.jsx(Vt,{path:"/notifications",element:e.jsx(pAe,{})}),e.jsx(Vt,{path:"/me/notification-preferences",element:e.jsx(ZNe,{})}),e.jsx(Vt,{path:"/roles",element:e.jsx(gAe,{})})]})})})})]})})}Qee();const OEe=()=>{const t=localStorage.getItem("theme-storage");if(t)try{const{state:r}=JSON.parse(t),n=r?.theme||"light";if(n==="system"){const i=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-theme",i)}else document.documentElement.setAttribute("data-theme",n)}catch{document.documentElement.setAttribute("data-theme","light")}};OEe();const kEe=new TG({defaultOptions:{queries:{staleTime:300*1e3,retry:1}}});IV.createRoot(document.getElementById("root")).render(e.jsx(qf.StrictMode,{children:e.jsx(IG,{client:kEe,children:e.jsx(Y$,{children:e.jsx(IEe,{})})})}));export{zi as _,Rx as c,hc as g};
